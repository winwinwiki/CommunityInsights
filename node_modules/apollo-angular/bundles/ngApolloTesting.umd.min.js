!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("apollo-angular"),require("apollo-link"),require("apollo-cache-inmemory"),require("apollo-cache"),require("@angular/core"),require("graphql"),require("apollo-client")):"function"==typeof define&&define.amd?define("apollo-angular/testing",["exports","apollo-angular","apollo-link","apollo-cache-inmemory","apollo-cache","@angular/core","graphql","apollo-client"],o):o(((e=e||self)["apollo-angular"]=e["apollo-angular"]||{},e["apollo-angular"].testing={}),e["apollo-angular"],e.apolloLink.core,e.apollo.cache.inmemory,e.apolloCache,e.ng.core,e.graphql,e.apollo)}(this,(function(e,o,t,n,r,i,a,p){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function c(e,o,t,n){var r,i=arguments.length,a=i<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,o,t,n);else for(var p=e.length-1;p>=0;p--)(r=e[p])&&(a=(i<3?r(a):i>3?r(o,t,a):r(o,t))||a);return i>3&&a&&Object.defineProperty(o,t,a),a}function l(e,o){return function(t,n){o(t,n,e)}}var u=function(){},s=function(e){return e&&e.hasOwnProperty("graphQLErrors")},f=function(){function e(e,o){this.operation=e,this.observer=o}return e.prototype.flush=function(e){s(e)?this.observer.error(e):(this.observer.next(e),this.observer.complete())},e.prototype.networkError=function(e){var o=new p.ApolloError({networkError:e});this.flush(o)},e.prototype.graphqlErrors=function(e){this.flush({errors:e})},e}(),h=function(){function e(){this.open=[]}return e.prototype.handle=function(e){var o=this;return new t.Observable((function(t){var n=new f(e,t);o.open.push(n)}))},e.prototype._match=function(e){var o=this;return"string"==typeof e?this.open.filter((function(o){return o.operation.operationName===e})):"function"==typeof e?this.open.filter((function(o){return e(o.operation)})):this.isDocumentNode(e)?this.open.filter((function(o){return a.print(o.operation.query)===a.print(e)})):this.open.filter((function(t){return o.matchOp(e,t)}))},e.prototype.matchOp=function(e,o){var t=JSON.stringify(e.variables),n=JSON.stringify(e.extensions),r=this.compare(e.operationName,o.operation.operationName),i=this.compare(t,o.operation.variables),p=a.print(o.operation.query)===a.print(e.query),c=this.compare(n,o.operation.extensions);return r&&i&&p&&c},e.prototype.compare=function(e,o){var t,n="string"==typeof(t=o)?t:JSON.stringify(t);return!e||n===e},e.prototype.match=function(e){var o=this,t=this._match(e);return t.forEach((function(e){var t=o.open.indexOf(e);-1!==t&&o.open.splice(t,1)})),t},e.prototype.expectOne=function(e,o){o=o||this.descriptionFromMatcher(e);var t=this.match(e);if(t.length>1)throw new Error('Expected one matching operation for criteria "'+o+'", found '+t.length+" operations.");if(0===t.length)throw new Error('Expected one matching operation for criteria "'+o+'", found none.');return t[0]},e.prototype.expectNone=function(e,o){o=o||this.descriptionFromMatcher(e);var t=this.match(e);if(t.length>0)throw new Error('Expected zero matching operations for criteria "'+o+'", found '+t.length+".")},e.prototype.verify=function(){var e=this.open;if(e.length>0){var o=e.map((function(e){return e.operation.operationName})).join(", ");throw new Error("Expected no open operations, found "+e.length+": "+o)}},e.prototype.isDocumentNode=function(e){return!e.operationName},e.prototype.descriptionFromMatcher=function(e){return"string"==typeof e?"Match operationName: "+e:"object"==typeof e?this.isDocumentNode(e)?"Match DocumentNode":"Match operation: "+(e.operationName||"(any)")+", variables: "+(JSON.stringify(e.variables)||"(any)"):"Match by function: "+e.name},e=c([i.Injectable()],e)}(),y=new i.InjectionToken("apollo-angular/testing cache"),g=new i.InjectionToken("apollo-angular/testing named cache"),d=new i.InjectionToken("apollo-angular/testing named clients");var m=function(){function e(e,o,r,i,a){function p(e,r){return{link:new t.ApolloLink((function(t){return o.handle(function(e,o){return o.clientName=e,o}(e,t))})),cache:r||new n.InMemoryCache({addTypename:!1})}}e.create(p("default",i)),r&&r.length&&r.forEach((function(o){var t=a&&"object"==typeof a?a:{};e.createNamed(o,p(o,t[o]))}))}return e.ctorParameters=function(){return[{type:o.Apollo},{type:h},{type:Array,decorators:[{type:i.Optional},{type:i.Inject,args:[d]}]},{type:r.ApolloCache,decorators:[{type:i.Optional},{type:i.Inject,args:[y]}]},{type:void 0,decorators:[{type:i.Optional},{type:i.Inject,args:[g]}]}]},e=c([i.NgModule({imports:[o.ApolloModule],providers:[h,{provide:u,useExisting:h}]}),l(2,i.Optional()),l(2,i.Inject(d)),l(3,i.Optional()),l(3,i.Inject(y)),l(4,i.Optional()),l(4,i.Inject(g))],e)}(),v=function(){function e(){}return e.withClients=function(e){return{ngModule:m,providers:[{provide:d,useValue:e}]}},e=c([i.NgModule({imports:[m]})],e)}();e.APOLLO_TESTING_CACHE=y,e.APOLLO_TESTING_NAMED_CACHE=g,e.ApolloTestingController=u,e.ApolloTestingModule=v,e.TestOperation=f,e.ɵa=d,e.ɵb=m,e.ɵc=h,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngApolloTesting.umd.min.js.map
(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["main"],{

/***/ "./$$_lazy_route_resource lazy recursive":
/*!******************************************************!*\
  !*** ./$$_lazy_route_resource lazy namespace object ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncaught exception popping up in devtools
	return Promise.resolve().then(function() {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	});
}
webpackEmptyAsyncContext.keys = function() { return []; };
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
module.exports = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "./$$_lazy_route_resource lazy recursive";

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/about-page/about-page.component.html":
/*!********************************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/about-page/about-page.component.html ***!
  \********************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<p>\n    Food truck fixie locavore, accusamus mcsweeney's marfa nulla single-origin coffee squid.\n    Exercitation +1 labore velit, blog sartorial PBR leggings next level wes anderson artisan four loko farm-to-table craft beer twee. Qui photo booth letterpress, commodo enim craft beer mlkshk aliquip jean shorts ullamco ad vinyl cillum PBR. Homo nostrud organic, assumenda labore aesthetic magna delectus mollit. Keytar helvetica VHS salvia yr, vero magna velit sapiente labore stumptown. Vegan fanny pack odio cillum wes anderson 8-bit, sustainable jean shorts beard ut DIY ethical culpa terry richardson biodiesel. Art party scenester stumptown, tumblr butcher vero sint qui sapiente accusamus tattooed echo park.\n  </p>"

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/app.component.html":
/*!**************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/app.component.html ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<app-header></app-header>\r\n"

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/chart/chart.component.html":
/*!**********************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/chart/chart.component.html ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "\r\n<div class=\"card-box sweep-to-right line-chart\">\r\n    \r\n    <h4 class=\"header-title d-inline-block\">Topic sentiment for {{start}} - {{end}}: {{searchValue}}</h4>\r\n    <p class=\"m-0 p-0 text-muted mb-3 small\"><em>Select topic by clicking on a topic in the Sentiment Breakdown chart</em></p>\r\n    \r\n    <div *ngIf=\"empty\">\r\n        <div class=\"text-center mt-5 mx-auto p-4\">\r\n            <img class=\"mb-4 text-center pb-2 \" src=\"/assets/zero_page_icon.svg\">\r\n            <p id=\"emptySearch\"><i class=\"fas fa-exclamation-circle mx-2\"></i> Click on topics/hashtag to see the trends.</p>\r\n        </div>\r\n    </div>\r\n    <div class=\"row h-350\">\r\n        <div id=\"chart\"></div>\r\n    </div>\r\n</div>"

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/header/header.component.html":
/*!************************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/header/header.component.html ***!
  \************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"loading\">\r\n  Loading...\r\n</div>\r\n\r\n<div id=\"top-nav\" class=\"w-100 text-white\">\r\n  <div class=\"navbar p-mobile-0\">\r\n    <a href=\"http://www.newimpact.care\" class=\"p-0 m-0\">\r\n      <img class=\"logo\" src=\"/assets/logo.png\">\r\n    </a>\r\n  </div>\r\n  <div class=\"p-right-80 p-mobile-0\">\r\n  <div id=\"d-block\">\r\n    <div class=\"row\">\r\n      <div class=\"col d-md-flex place-date-choice\">\r\n        <div class=\"inner-wrapper mt-1\">\r\n          <span>See what people are saying in </span>\r\n          \r\n            <tag-input name=\"getloc\" class=\"d-inline-block locationData\" #getloc=\"ngModel\" [ngModel]=\"locText\" (onAdd)=\"onSelectedLocation($event)\"\r\n                     [placeholder]=\"'Select Place'\"\r\n                     [onTextChangeDebounce]=\"0\"\r\n                     [maxItems]=\"1\"\r\n                     [secondaryPlaceholder]=\"'Select Place'\"\r\n                     [onlyFromAutocomplete]=\"true\">\r\n            <tag-input-dropdown [showDropdownIfEmpty]=\"true\" [autocompleteItems]=\"loc\" displayBy=\"location\"\r\n            identifyBy=\"location\" zIndex=\"10000\">\r\n            </tag-input-dropdown>\r\n          </tag-input>\r\n          <span class=\"pr-2\">during</span>\r\n          <form class=\"form-inline d-inline-block dateinput\" >\r\n            <div class=\"form-group my-1\">\r\n              <div class=\"input-group\">\r\n                <input #myRangeInput myRangeInput=\"myRangeInput\"\r\n                       class=\"form-control form-control-sm\"\r\n                       placeholder=\"yyyy-mm-dd to yyyy-mm-dd \"\r\n                       (click)=\"d.toggle()\"\r\n                       name=\"dp\"\r\n                       [(value)]=\"text\"\r\n                       [footerTemplate]=\"footerTemplate\"\r\n                       ngbDatepicker\r\n                       [dayTemplate]=\"t\"\r\n                       [displayMonths]=\"2\"\r\n                       [maxDate]=\"maxDate\"\r\n                       [minDate]=\"minDate\"\r\n                       [outsideDays]=\"outsideDays\"\r\n                       [autoClose]=\"false\"\r\n                       #d=\"ngbDatepicker\">\r\n  \r\n                <ng-template #t let-date=\"date\" let-focused=\"focused\">\r\n                  <span class=\"custom-day\"\r\n                        [class.range]=\"isFrom(date) || isTo(date) || isInside(date) || isHovered(date)\"\r\n                        [class.faded]=\"isHovered(date) || isInside(date)\"\r\n                        (click)=\"onDateSelection(date)\"\r\n                        (mouseenter)=\"hoveredDate = date\"\r\n                        (mouseleave)=\"hoveredDate = null\">\r\n                    {{ date.day }}\r\n                  </span>\r\n                </ng-template>\r\n                <ng-template #footerTemplate>\r\n                  <hr class=\"my-0\">\r\n                  <button class=\"btn btn-primary btn-sm m-2 float-left\" (click)=\"getToday(today, '')\">Today</button>\r\n                  <button class=\"btn btn-secondary btn-sm m-2\" (click)=\"getWeek(today);\">Past 7 days</button>\r\n                  <button class=\"btn btn-secondary btn-sm m-2 float-right\" (click)=\"d.close()\">Cancel</button>\r\n                  <button class=\"btn btn-primary btn-sm m-2 float-right\" (click)=\"updateText(myRangeInput.value); updateLocation(getloc.value); d.close()\">Search</button>\r\n                  \r\n                </ng-template>\r\n                <div class=\"input-group-append\">\r\n                  <button class=\"btn btn-sm btn-outline-light\" (click)=\"d.toggle();  $event.stopPropagation();\" type=\"button\">\r\n                    <i class=\"far fa-calendar-alt\"></i>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </form>\r\n          <button type=\"button\" class=\"btn btn-sm ml-4 bg-light\" (click)=\"updateText(myRangeInput.value); updateLocation(getloc.value)\"><i class=\"fas fa-search text-dark\"></i></button>\r\n          <!--    <hr /><pre>From: {{ fromDate | json }}</pre><pre>To: {{ toDate | json }}</pre>-->\r\n\r\n        </div>\r\n       <!-- <div class=\"inner-wrapper mt-1\">\r\n        \r\n       </div> -->\r\n\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n</div>\r\n\r\n<div class=\"wrapper\">\r\n  <div class=\"main-tabs\">\r\n    <ngb-tabset [destroyOnHide]=\"false\">\r\n      <ngb-tab>\r\n        <ng-template ngbTabTitle><span class=\"tabIcons trending-icon\"></span><span class=\"tab-title text-dark\" (click)=\"updateText(myRangeInput.value); updateLocation(locations)\">Trending</span></ng-template>\r\n        <ng-template ngbTabContent>\r\n          <app-trending></app-trending>\r\n        </ng-template>\r\n      </ngb-tab>\r\n      <ngb-tab>\r\n        <ng-template ngbTabTitle><span class=\"tabIcons verbatim-icon\"></span><span class=\"tab-title text-dark\" (click)=\"updateText(myRangeInput.value); updateLocation(locations)\">Verbatim</span></ng-template>\r\n        <ng-template ngbTabContent>\r\n          <app-verbatim></app-verbatim>\r\n        </ng-template>\r\n      </ngb-tab>\r\n      <ngb-tab>\r\n        <ng-template ngbTabTitle><span class=\"tabIcons about-icon\"></span><span class=\"tab-title text-dark\">About This Tool</span></ng-template>\r\n        <ng-template ngbTabContent>\r\n          <app-about-page></app-about-page>\r\n        </ng-template>\r\n      </ngb-tab>\r\n    </ngb-tabset>\r\n\r\n  </div>\r\n</div>\r\n"

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/tree-map/tree-map.component.html":
/*!****************************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/tree-map/tree-map.component.html ***!
  \****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<ng-container *ngIf=\"load && !empty\">\r\n  <div class=\"text-center mt-5 mx-auto px-4 loader\">\r\n    <img src=\"/assets/loader.gif\">\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-container *ngIf=\"!load && !empty\">\r\n  <div class=\"card-box sweep-to-right\">\r\n    <div class=\"d-flex justify-content-between align-items-center\">\r\n      <h4 class=\"header-title d-inline-block\">Tree Map</h4>\r\n      <div>\r\n        <label for=\"frameworkOptions\">Select Framework:&nbsp;</label>\r\n        <select (change)=\"filterImpactArea($event.target.value)\">\r\n          <option *ngFor=\"let types of impactTypes\" [value]=\"types\">{{types}}</option>\r\n        </select>\r\n      </div>\r\n\r\n    </div>\r\n    <br/>\r\n    <div id=\"container\">\r\n      <div id=\"treemap\">\r\n      </div>\r\n      <div class=\"controls\">\r\n        <select [(ngModel)]=\"depthOption\" (change)=\"filterChanged($event.target.value)\">\r\n          <option *ngFor=\"let type of filterTypes\" [selected]=\"type.value\" [value]=\"type.value\">{{type.value}}</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n      \r\n  </div>\r\n</ng-container>\r\n\r\n \r\n\r\n"

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/trending/trending.component.html":
/*!****************************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/trending/trending.component.html ***!
  \****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "\r\n<ng-container *ngIf=\"!empty && !loading\">\r\n  <div class=\"row\">\r\n    <div class=\"col-xl-12\">\r\n      <div class=\"card-box sweep-to-right\" id=\"cloud\">\r\n        <h4 class=\"header-title mb-3 d-inline-block\">Trending Topics</h4>\r\n      \r\n        <div class=\"d-inline-block pull-right\">\r\n          <button type=\"button\" class=\"btn-sm btn rounded-0 m-0 switchView\" (click)= \"getTrendingTopics(); loading=true\" [ngClass]=\"[selectedTopics ? 'selected' : 'notSelected']\">Topics</button>\r\n          <button type=\"button\" class=\"btn-sm btn rounded-0 m-0 switchView\" (click)= \"getHashtags();  loading=true\" [ngClass]=\"[selectedTopics ? 'notSelected' : 'selected']\">Hashtags</button>\r\n        </div>\r\n        <div class=\"btn-group btn-group-vertical zoom-btn\" bis_skin_checked=\"1\">\r\n          <button type=\"button\" class=\"btn zoomIn zoom p-2 m-0 border rounded-top z-index-1\" [disabled]=\"hideZoomIn\" (click)=\"zoom('in')\"><i class=\"fas fa-search-plus text-muted\"></i></button>\r\n          <button type=\"button\" class=\"btn zoomOut zoom p-2 m-0 border rounded-bottom z-index-1\" [disabled]= \"hideZoomOut\" (click)=\"zoom('out')\"><i class=\"fas fa-search-minus text-muted\"></i></button>\r\n        </div>\r\n        <div id=\"trending-topics\" class=\"h-350 d-flex align-items-center\">\r\n          <div *ngIf=\"loading\" class=\"loader mx-auto\">\r\n            <img src=\"/assets/loader.gif\">\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n  </div>\r\n\r\n  <div class=\"row\">\r\n    <div class=\"col-xl-7\">\r\n      <div class=\"card-box sweep-to-right\" style=\"padding-bottom: 15px;\">\r\n        <div class=\"d-flex justify-content-between align-items-center\">\r\n          <h4 class=\"header-title mb-3 d-inline-block\">Topic Sentiment Breakdown</h4>\r\n          \r\n          <pagination-controls class=\"hide-page-numbers d-inline-block\" directionLinks=\"true\" (pageChange)=\"p = $event\"></pagination-controls>\r\n        </div>\r\n        <div class=\"row\">\r\n          <div class=\"col-xl-12\">\r\n            <table class=\"table table-hover m-0 table-centered nowrap w-100 sentiment-table\" role=\"grid\">\r\n              <thead>\r\n                <tr role=\"row\">\r\n                  <th class=\"sorting_asc col-3 w-25\" tabindex=\"0\">Count</th>\r\n                  <th class=\"sorting col-3 w-25\" tabindex=\"0\">Topic Name</th>\r\n                  <th class=\"sorting col-6 w-50\" tabindex=\"0\">Sentiment</th>\r\n                </tr>\r\n              </thead>\r\n\r\n              <tbody>\r\n                <ng-container *ngIf =\"selectedTopics\">\r\n                  <tr role=\"row\" class=\"odd\" *ngFor = \"let i = index ; let sentimentData of listTrendingTopics | paginate: { itemsPerPage: 8, currentPage: p }\" (click)=\"updateClicked(sentimentData.topic + ' topic'); setClickedRow(i)\"  [class.active]=\"i == selectedRow\" style=\"cursor: pointer;\">\r\n                    <td tabindex=\"0\" class=\"d-flex\">\r\n                      <!-- <i class=\"fas icon-sm pr-2 my-auto {{sentimentData.sentiment == -1 ? 'fa-arrow-circle-down' : sentimentData.sentiment == 0 ? 'fa-minus-circle' : 'fa-arrow-circle-up' }}\"></i> -->\r\n                      <b>{{sentimentData.counts}}</b>\r\n                    </td>\r\n                    <td>\r\n                      {{sentimentData.topic}}\r\n                    </td>\r\n                    <td>\r\n                      <div class=\"progress\">\r\n                        <div class=\"progress-bar bg-negative\" role=\"progressbar\" ngbTooltip=\"{{((sentimentData.negative / sentimentData.counts) *100).toFixed(2)}}\" [style.width.%]=\"(sentimentData.negative / sentimentData.counts) *100\" aria-valuenow=\"sentiment.negative\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\r\n                        <div class=\"progress-bar bg-neutral\" role=\"progressbar\" ngbTooltip=\"{{((sentimentData.neutral / sentimentData.counts) *100).toFixed(2)}}\" [style.width.%]=\" (sentimentData.neutral / sentimentData.counts) * 100\" aria-valuenow=\"sentiment.neutral\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\r\n                        <div class=\"progress-bar bg-positive\" role=\"progressbar\" ngbTooltip=\"{{((sentimentData.positive / sentimentData.counts) *100).toFixed(2)}}\" [style.width.%]=\"(sentimentData.positive / sentimentData.counts) * 100\" aria-valuenow=\"sentiment.positive\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\r\n                      </div>\r\n                    </td>\r\n    \r\n                  </tr>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"!selectedTopics\">\r\n                  <tr role=\"row\" class=\"odd\" *ngFor = \"let sentimentData of listHashtags | paginate: { itemsPerPage: 9, currentPage: p }\" (click)=\"updateClicked(sentimentData.hashtag + ' hashtag')\" style=\"cursor: pointer;\">\r\n                    <td tabindex=\"0\" class=\"d-flex\">\r\n                      <!-- <i class=\"fas icon-sm pr-2 my-auto {{sentimentData.sentiment == -1 ? 'fa-arrow-circle-down' : sentimentData.sentiment == 0 ? 'fa-minus-circle' : 'fa-arrow-circle-up' }}\"></i> -->\r\n                      <b>{{sentimentData.counts}}</b>\r\n                    </td>\r\n                    <td>\r\n                      {{sentimentData.hashtag}}\r\n                    </td>\r\n                    <td>\r\n                      <div class=\"progress\">\r\n                        <div class=\"progress-bar bg-negative\" role=\"progressbar\" ngbTooltip=\"{{((sentimentData.negative / sentimentData.counts) *100).toFixed(2)}}\" [style.width.%]=\"(sentimentData.negative/sentimentData.counts)*100\" aria-valuenow=\"sentiment.negative\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\r\n                        <div class=\"progress-bar bg-neutral\" role=\"progressbar\" ngbTooltip=\"{{((sentimentData.neutral / sentimentData.counts) *100).toFixed(2)}}\" [style.width.%]=\" (sentimentData.neutral / sentimentData.counts) * 100\" aria-valuenow=\"sentiment.neutral\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\r\n                        <div class=\"progress-bar bg-positive\" role=\"progressbar\" ngbTooltip=\"{{((sentimentData.positive / sentimentData.counts) *100).toFixed(2)}}\" [style.width.%]=\"(sentimentData.positive / sentimentData.counts) * 100\" aria-valuenow=\"sentiment.positive\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\r\n                      </div>\r\n                    </td>\r\n    \r\n                  </tr>\r\n                </ng-container>\r\n                \r\n              </tbody>\r\n            </table>\r\n            <div class=\"d-flex justify-content-center align-items-center small\">\r\n              <div class=\"box bg-negative mx-2\"></div><span class=\"mr-2\">Negative</span>\r\n              <div class=\"box bg-neutral mx-2\"> </div><span class=\"mr-2\">Neutral</span>\r\n              <div class=\"box bg-positive mx-2\"> </div><span class=\"mr-2\">Positive</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-xl-5\">\r\n      <app-chart></app-chart>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"row\">\r\n    <div class=\"col-xl-12\" >\r\n      <app-tree-map></app-tree-map>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-container *ngIf=\"empty && !loading\">\r\n  <div class=\"text-center mt-5 mx-auto p-4\">\r\n    <img class=\"mb-4 text-center pb-2 \" src=\"/assets/zero_page_icon.svg\">\r\n    <p id=\"emptySearch\"><i class=\"fas fa-exclamation-circle mx-2\"></i> No Data Found. Please Refine your Search</p>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-container *ngIf=\"loading\">\r\n  <div class=\"text-center mt-5 mx-auto px-4 loader\">\r\n    <img src=\"/assets/loader.gif\">\r\n  </div>\r\n</ng-container>"

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/verbatim/verbatim.component.html":
/*!****************************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/verbatim/verbatim.component.html ***!
  \****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<ng-container *ngIf=\"empty && !loading\">\r\n  <div class=\"text-center mt-5 mx-auto p-4\">\r\n    <img class=\"mb-4 text-center pb-2 \" src=\"/assets/zero_page_icon.svg\">\r\n    <p id=\"emptySearch\"><i class=\"fas fa-exclamation-circle mx-2\"></i> No Data Found. Please Refine your Search</p>\r\n  </div>\r\n</ng-container>\r\n<ng-container *ngIf=\"empty && loading\">\r\n  <div class=\"text-center mt-5 mx-auto px-4 loader\">\r\n    <img src=\"/assets/loader.gif\">\r\n  </div>\r\n</ng-container>\r\n\r\n\r\n<ng-container *ngIf=\"!empty\">\r\n  <div class=\"page-wrapper chiller-theme\" [ngClass]=\"[isOn === true ? 'toggled' : 'toggle']\">\r\n    <a id=\"show-sidebar\" class=\"btn btn-sm btn-dark\" href=\"#\">\r\n      <i class=\"fas fa-bars\" (click)=\"isOn ? isOn = false : isOn = true\"></i>\r\n    </a>\r\n    <nav id=\"sidebar\" class=\"sidebar-wrapper\">\r\n      <div class=\"sidebar-content\">\r\n        <div class=\"sidebar-brand\">\r\n          <a href=\"#\">Filter Data</a>\r\n          <div id=\"close-sidebar\" (click)=\"isOn=false\">\r\n            <i class=\"far fa-times-circle\"></i>\r\n          </div>\r\n        </div>\r\n        <!-- sidebar-header  -->\r\n        <div class=\"sidebar-search\">\r\n          <div>\r\n            <div class=\"input-group\">\r\n              <input type=\"text\" class=\"form-control search-menu\" placeholder=\"Search Filter Criteria\">\r\n              <div class=\"input-group-append\">\r\n                <span class=\"input-group-text\">\r\n                  <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <!-- sidebar-search  -->\r\n        <div class=\"sidebar-menu\">\r\n          <ul>\r\n            <ngb-accordion>\r\n              <ngb-panel title=\"Impact\" class=\"sidebar-dropdown\">\r\n                <ng-template ngbPanelContent>\r\n                  <div class=\"d-flex align-items-center justify-content-between\">\r\n                    <input type=\"checkbox\" id=\"impact-1\" name=\"impact-1\" value=\"Impact Area Name 1\">\r\n                    <label for=\"impact-1\" class=\"my-0 px-2\"> Impact Area Name 1</label><br>\r\n                    <span class=\"badge badge-pill badge-warning\">1</span>\r\n                  </div>\r\n  \r\n                  <div class=\"d-flex align-items-center justify-content-between\">\r\n                    <input type=\"checkbox\" id=\"impact-2\" name=\"impact-2\" value=\"Impact Area Name 2\">\r\n                    <label for=\"impact-2\" class=\"my-0 px-2\"> Impact Area Name 2</label><br>\r\n                    <span class=\"badge badge-pill badge-warning\">20</span>\r\n                  </div>\r\n  \r\n                  <div class=\"d-flex align-items-center justify-content-between\">\r\n                    <input type=\"checkbox\" id=\"impact-3\" name=\"impact-3\" value=\"Impact Area Name 3\">\r\n                    <label for=\"impact-3\" class=\"my-0 px-2\"> Impact Area Name 3</label><br>\r\n                    <span class=\"badge badge-pill badge-warning\">100</span>\r\n                  </div>\r\n                  <!--use loop here to populate impact areas as checkboxes, note: here each checkbox will have a different id-->\r\n                </ng-template>\r\n              </ngb-panel>\r\n              <ngb-panel title=\"Source\" class=\"sidebar-dropdown\">\r\n                <span _ngcontent-pbe-c111=\"\" class=\"badge badge-pill badge-warning\">New</span>\r\n                <ng-template ngbPanelContent>\r\n                  Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia\r\n                  aute.\r\n                </ng-template>\r\n              </ngb-panel>\r\n              <ngb-panel title=\"Type\" class=\"sidebar-dropdown\">\r\n                \r\n                <ng-template ngbPanelContent>\r\n                  <span _ngcontent-pbe-c111=\"\" class=\"badge badge-pill badge-warning\">New</span>\r\n                  Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia\r\n                  aute.\r\n                </ng-template>\r\n              </ngb-panel>\r\n              <ngb-panel title=\"Sentiment\" class=\"sidebar-dropdown\">\r\n                <ng-template ngbPanelContent>\r\n                  Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia\r\n                  aute.\r\n                </ng-template>\r\n              </ngb-panel>\r\n            </ngb-accordion>\r\n          </ul>\r\n        </div>\r\n        <!-- sidebar-menu  -->\r\n      </div>\r\n      <!-- sidebar-content  -->\r\n    </nav>\r\n    <!-- sidebar-wrapper  -->\r\n    <main class=\"page-content\">\r\n      \r\n      <div class=\"container-fluid\">\r\n        <div class=\"d-flex py-2 justify-content-end\">\r\n          <button type=\"button\" class=\"btn btn-sm viewType mx-2 px-2 py-1\" (click)= \"flatView = true\" [ngClass]=\"[flatView ? 'selected' : 'notSelected']\"><i class=\"fas fa-list\"></i></button>\r\n          <button type=\"button\" class=\"btn btn-sm viewType mx-2 px-2 py-1\" (click)=\"flatView = flase\" [ngClass]=\"[!flatView ? 'selected' : 'notSelected']\"><i class=\"fas fa-indent\"></i></button>\r\n        </div>\r\n        <div class=\"d-flex justify-content-end\">\r\n          <div>\r\n            <pagination-controls class=\"hide-page-numbers d-inline-block\" directionLinks=\"true\" (pageChange)=\"p = $event\"></pagination-controls>\r\n          </div>\r\n        </div>\r\n        <ng-container *ngIf=\"!flatView\">\r\n          <div *ngFor=\"let key of keys\">\r\n            <div class=\"card sub-details\">\r\n              <div class=\"p-3\">\r\n                <div class=\"row\">\r\n                  <span class=\"col-sm-12 location col-md-2\">\r\n                    {{items.get(key).region}}  {{items.get(key).post_id}}\r\n                  </span>\r\n                  <span class=\"col-sm-4 col-md-3 date\">\r\n                    {{items.get(key).created_time}}\r\n                  </span>\r\n                  <span class=\"col-md-4 col-sm-4 sources\">\r\n                    From  {{items.get(key).platform_name}}\r\n                  </span>\r\n                  <span class=\"col-sm-4 col-md-3 metadata text-right\">\r\n                    {{items.get(key).topics}}\r\n                  </span>\r\n                </div>\r\n                <div class=\"row d-flex align-items-center px-0 mx-0\">\r\n                  <span class=\"mr-2 smiley text-center\">\r\n                    <i class=\"far {{items.get(key).sentiment == -1 ? 'fa-frown' : items.get(key).sentiment == 0 ? 'fa-meh' : 'fa-smile' }}\"></i>\r\n        \r\n                  </span>\r\n                  <span class=\"mx-2 icon-comment text-center\">\r\n                    <i class=\"far fa-file-alt\"></i>\r\n                  </span>\r\n                  <p class=\"col-10 inline-block my-0\" ngbTooltip=\"{{items.get(key).content}}\">\r\n                    {{items.get(key).content}}\r\n                  </p>\r\n                </div>\r\n                <!-- <div class=\"row topics col-12 d-flex justify-content-center mt-3\">\r\n                    <span class=\"pink\">\r\n                      {{discourse.level0}}\r\n                    </span>\r\n                    <span class=\"blue\">\r\n                      {{discourse.level1}}\r\n                    </span>\r\n                    <span class=\"red\">\r\n                      {{discourse.level2}}\r\n                    </span>\r\n                  \r\n                </div> -->\r\n              </div>\r\n            </div>\r\n\r\n\r\n            <ng-container *ngIf=\"items.get(key).comments.length > 0\">\r\n              <div *ngFor =\"let comment of items.get(key).comments\" class=\"card sub-details threaded\">\r\n                <div class=\"p-3\">\r\n                  <div class=\"row\">\r\n                    <span class=\"col-sm-12 location col-md-2\">\r\n                      {{comment.region}}\r\n                    </span>\r\n                    <span class=\"col-sm-4 col-md-3 date\">\r\n                      {{comment.created_time}}\r\n                    </span>\r\n                    <span class=\"col-md-4 col-sm-4 sources\">\r\n                      From  {{comment.platform_name}}\r\n                    </span>\r\n                    <span class=\"col-sm-4 col-md-3 metadata text-right\">\r\n                      {{comment.topics}}\r\n                    </span>\r\n                  </div>\r\n                  <div class=\"row d-flex align-items-center px-0 mx-0\">\r\n                    <span class=\"mr-2 smiley text-center\">\r\n                      <i class=\"far {{comment.sentiment == -1 ? 'fa-frown' : comment.sentiment == 0 ? 'fa-meh' : 'fa-smile' }}\"></i>\r\n          \r\n                    </span>\r\n                    <span class=\"mx-2 icon-comment text-center\">\r\n                      <i class=\"far fa-file-alt\"></i>\r\n                    </span>\r\n                    <p class=\"col-10 inline-block my-0\" ngbTooltip=\"{{comment.content}}\">\r\n                      {{comment.content}}\r\n                    </p>\r\n                  </div>\r\n                  <!-- <div class=\"row topics col-12 d-flex justify-content-center mt-3\">\r\n                      <span class=\"pink\">\r\n                        {{discourse.level0}}\r\n                      </span>\r\n                      <span class=\"blue\">\r\n                        {{discourse.level1}}\r\n                      </span>\r\n                      <span class=\"red\">\r\n                        {{discourse.level2}}\r\n                      </span>\r\n                    \r\n                  </div> -->\r\n                </div>\r\n              </div>\r\n\r\n            </ng-container>\r\n          </div>\r\n        </ng-container>\r\n\r\n        <ng-container *ngIf=\"flatView\">\r\n          <div *ngFor = \"let discourse of discourseDetails | paginate: { itemsPerPage: 8, currentPage: p }\">\r\n            <div class=\"card sub-details\">\r\n              <div class=\"p-3\">\r\n                <div class=\"row\">\r\n                  <span class=\"col-sm-12 location col-md-2\">\r\n                    {{discourse.region}}\r\n                  </span>\r\n                  <span class=\"col-sm-4 col-md-3 date\">\r\n                    {{discourse.created_time}}\r\n                  </span>\r\n                  <span class=\"col-md-4 col-sm-4 sources\">\r\n                    From {{discourse.platform_desc}}\r\n                  </span>\r\n                  <span class=\"col-sm-4 col-md-3 metadata text-right\">\r\n                    Traffic (What text?)\r\n                  </span>\r\n                </div>\r\n                <div class=\"row d-flex align-items-center px-0 mx-0\">\r\n                  <span class=\"mr-2 smiley text-center\">\r\n                    <i class=\"far {{discourse.sentiment == -1 ? 'fa-frown' : discourse.sentiment == 0 ? 'fa-meh' : 'fa-smile' }}\"></i>\r\n        \r\n                  </span>\r\n                  <span class=\"mx-2 icon-comment text-center\">\r\n                    <i class=\"far fa-comment-dots {{isPost == 1 ? 'fa-file-alt' : 'fa-comment-dots' }}\"></i>\r\n                  </span>\r\n                  <p class=\"col-10 inline-block my-0\" ngbTooltip=\"{{discourse.comment}}\">\r\n                    {{discourse.comment}} \r\n                  </p>\r\n                </div>\r\n                <div class=\"row topics col-12 d-flex justify-content-center mt-3\">\r\n                    <span class=\"pink\">\r\n                      {{discourse.level0}}\r\n                    </span>\r\n                    <span class=\"blue\">\r\n                      {{discourse.level1}}\r\n                    </span>\r\n                    <span class=\"red\">\r\n                      {{discourse.level2}}\r\n                    </span>\r\n                  \r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </ng-container>\r\n   \r\n      </div>\r\n  \r\n    </main>\r\n    <!-- page-content\" -->\r\n  </div>\r\n</ng-container>\r\n\r\n"

/***/ }),

/***/ "./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "./src/app/about-page/about-page.component.css":
/*!*****************************************************!*\
  !*** ./src/app/about-page/about-page.component.css ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2Fib3V0LXBhZ2UvYWJvdXQtcGFnZS5jb21wb25lbnQuY3NzIn0= */"

/***/ }),

/***/ "./src/app/about-page/about-page.component.ts":
/*!****************************************************!*\
  !*** ./src/app/about-page/about-page.component.ts ***!
  \****************************************************/
/*! exports provided: AboutPageComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AboutPageComponent", function() { return AboutPageComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");


var AboutPageComponent = /** @class */ (function () {
    function AboutPageComponent() {
    }
    AboutPageComponent.prototype.ngOnInit = function () {
    };
    AboutPageComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-about-page',
            template: __webpack_require__(/*! raw-loader!./about-page.component.html */ "./node_modules/raw-loader/index.js!./src/app/about-page/about-page.component.html"),
            styles: [__webpack_require__(/*! ./about-page.component.css */ "./src/app/about-page/about-page.component.css")]
        })
    ], AboutPageComponent);
    return AboutPageComponent;
}());



/***/ }),

/***/ "./src/app/app.component.css":
/*!***********************************!*\
  !*** ./src/app/app.component.css ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FwcC5jb21wb25lbnQuY3NzIn0= */"

/***/ }),

/***/ "./src/app/app.component.ts":
/*!**********************************!*\
  !*** ./src/app/app.component.ts ***!
  \**********************************/
/*! exports provided: AppComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppComponent", function() { return AppComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");


var AppComponent = /** @class */ (function () {
    function AppComponent() {
        this.title = 'NewImpact';
    }
    AppComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-root',
            template: __webpack_require__(/*! raw-loader!./app.component.html */ "./node_modules/raw-loader/index.js!./src/app/app.component.html"),
            styles: [__webpack_require__(/*! ./app.component.css */ "./src/app/app.component.css")]
        })
    ], AppComponent);
    return AppComponent;
}());



/***/ }),

/***/ "./src/app/app.module.ts":
/*!*******************************!*\
  !*** ./src/app/app.module.ts ***!
  \*******************************/
/*! exports provided: AppModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppModule", function() { return AppModule; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm5/platform-browser.js");
/* harmony import */ var _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/platform-browser/animations */ "./node_modules/@angular/platform-browser/fesm5/animations.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _ngb_date_fr_parser_formatter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ngb-date-fr-parser-formatter */ "./src/app/ngb-date-fr-parser-formatter.ts");
/* harmony import */ var _ngb_UTC_string_adapter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ngb-UTC-string-adapter */ "./src/app/ngb-UTC-string-adapter.ts");
/* harmony import */ var _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ng-bootstrap/ng-bootstrap */ "./node_modules/@ng-bootstrap/ng-bootstrap/fesm5/ng-bootstrap.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm5/router.js");
/* harmony import */ var _app_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./app.component */ "./src/app/app.component.ts");
/* harmony import */ var _header_header_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./header/header.component */ "./src/app/header/header.component.ts");
/* harmony import */ var _trending_trending_component__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./trending/trending.component */ "./src/app/trending/trending.component.ts");
/* harmony import */ var _verbatim_verbatim_component__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./verbatim/verbatim.component */ "./src/app/verbatim/verbatim.component.ts");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @angular/forms */ "./node_modules/@angular/forms/fesm5/forms.js");
/* harmony import */ var _chart_chart_component__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./chart/chart.component */ "./src/app/chart/chart.component.ts");
/* harmony import */ var _tree_map_tree_map_component__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./tree-map/tree-map.component */ "./src/app/tree-map/tree-map.component.ts");
/* harmony import */ var ngx_chips__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ngx-chips */ "./node_modules/ngx-chips/fesm5/ngx-chips.js");
/* harmony import */ var _graphql_module__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./graphql.module */ "./src/app/graphql.module.ts");
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @angular/common/http */ "./node_modules/@angular/common/fesm5/http.js");
/* harmony import */ var ngx_pagination__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ngx-pagination */ "./node_modules/ngx-pagination/dist/ngx-pagination.js");
/* harmony import */ var _about_page_about_page_component__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./about-page/about-page.component */ "./src/app/about-page/about-page.component.ts");




















var AppModule = /** @class */ (function () {
    function AppModule() {
    }
    AppModule = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_3__["NgModule"])({
            declarations: [
                _app_component__WEBPACK_IMPORTED_MODULE_8__["AppComponent"],
                _header_header_component__WEBPACK_IMPORTED_MODULE_9__["HeaderComponent"],
                _trending_trending_component__WEBPACK_IMPORTED_MODULE_10__["TrendingComponent"],
                _verbatim_verbatim_component__WEBPACK_IMPORTED_MODULE_11__["VerbatimComponent"],
                _chart_chart_component__WEBPACK_IMPORTED_MODULE_13__["ChartComponent"],
                _tree_map_tree_map_component__WEBPACK_IMPORTED_MODULE_14__["TreeMapComponent"],
                _about_page_about_page_component__WEBPACK_IMPORTED_MODULE_19__["AboutPageComponent"]
            ],
            imports: [
                _angular_platform_browser__WEBPACK_IMPORTED_MODULE_1__["BrowserModule"],
                _angular_forms__WEBPACK_IMPORTED_MODULE_12__["FormsModule"],
                _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_2__["BrowserAnimationsModule"],
                _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_6__["NgbModule"],
                _angular_forms__WEBPACK_IMPORTED_MODULE_12__["ReactiveFormsModule"],
                ngx_chips__WEBPACK_IMPORTED_MODULE_15__["TagInputModule"],
                _graphql_module__WEBPACK_IMPORTED_MODULE_16__["GraphQLModule"],
                _angular_common_http__WEBPACK_IMPORTED_MODULE_17__["HttpClientModule"],
                ngx_pagination__WEBPACK_IMPORTED_MODULE_18__["NgxPaginationModule"],
                _angular_router__WEBPACK_IMPORTED_MODULE_7__["RouterModule"].forRoot([
                    { path: 'verbatim', component: _verbatim_verbatim_component__WEBPACK_IMPORTED_MODULE_11__["VerbatimComponent"] },
                    { path: 'about', component: _about_page_about_page_component__WEBPACK_IMPORTED_MODULE_19__["AboutPageComponent"] },
                    { path: '', component: _trending_trending_component__WEBPACK_IMPORTED_MODULE_10__["TrendingComponent"] },
                ])
            ],
            exports: [],
            providers: [
                {
                    provide: _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_6__["NgbDateParserFormatter"],
                    useClass: _ngb_date_fr_parser_formatter__WEBPACK_IMPORTED_MODULE_4__["NgbDateFRParserFormatter"]
                },
                {
                    provide: _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_6__["NgbDateAdapter"],
                    useClass: _ngb_UTC_string_adapter__WEBPACK_IMPORTED_MODULE_5__["NgbUTCStringAdapter"]
                },
            ],
            bootstrap: [_app_component__WEBPACK_IMPORTED_MODULE_8__["AppComponent"]]
        })
    ], AppModule);
    return AppModule;
}());



/***/ }),

/***/ "./src/app/chart/chart.component.css":
/*!*******************************************!*\
  !*** ./src/app/chart/chart.component.css ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "\r\n\r\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NoYXJ0L2NoYXJ0LmNvbXBvbmVudC5jc3MifQ== */"

/***/ }),

/***/ "./src/app/chart/chart.component.ts":
/*!******************************************!*\
  !*** ./src/app/chart/chart.component.ts ***!
  \******************************************/
/*! exports provided: ChartComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChartComponent", function() { return ChartComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _data_transfer_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! .././data-transfer.service */ "./src/app/data-transfer.service.ts");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm5/index.js");
/* harmony import */ var apollo_angular__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! apollo-angular */ "./node_modules/apollo-angular/fesm5/ngApollo.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! graphql-tag */ "./node_modules/graphql-tag/src/index.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(graphql_tag__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @aws-amplify/pubsub */ "./node_modules/@aws-amplify/pubsub/lib-esm/index.js");
/* harmony import */ var _aws_exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../aws-exports */ "./src/aws-exports.js");
/* harmony import */ var aws_amplify__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! aws-amplify */ "./node_modules/aws-amplify/lib-esm/index.js");
/* harmony import */ var _d3plus_full__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./../d3plus.full */ "./src/app/d3plus.full.js");
/* harmony import */ var _d3plus_full__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_d3plus_full__WEBPACK_IMPORTED_MODULE_9__);








aws_amplify__WEBPACK_IMPORTED_MODULE_8__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_7__["default"]);
_aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_6__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_7__["default"]);


var ChartComponent = /** @class */ (function () {
    function ChartComponent(data, apollo) {
        this.data = data;
        this.apollo = apollo;
        this.text = '';
        this.dates = [];
        this.start = String;
        this.end = String;
        this.empty = true;
        this.topicsChart = [];
        this.hashtagChart = [];
        this.location = '';
        this.regiondata = [];
        this.changedObjtext = '';
        this.changedObjLocation = '';
        this.changeObjselectedData = '';
    }
    ChartComponent.prototype.plotChart = function (chartData) {
        chartData.sort(function (a, b) { return (a.date > b.date) ? 1 : -1; });
        if (document.getElementById("chart") != null) {
            document.getElementById('chart').innerHTML = '';
        }
        function legendtext(d) {
            if (d === -1)
                return "Negative";
            if (d === 0)
                return "Neutral";
            if (d === 1)
                return "Positive";
        }
        function assignColor(d) {
            if (d === -1)
                return "#676767";
            if (d === 0)
                return "#ffc000";
            if (d === 1)
                return "#2aa7d7";
            return "grey";
        }
        new _d3plus_full__WEBPACK_IMPORTED_MODULE_9__["LinePlot"]()
            .config({
            data: chartData,
            groupBy: "sentiment",
            x: "date",
            y: "counts",
            lineMarkers: true,
            lineMarkerConfig: {
                fill: function (d) {
                    return assignColor(parseInt(d.group));
                }
            },
            legendConfig: {
                label: function (d) {
                    return legendtext(d.sentiment);
                }
            },
            shapeConfig: {
                Line: {
                    stroke: function (d) {
                        return assignColor(d.sentiment);
                    }
                }
            },
            xConfig: {
                title: "Date",
            },
            yConfig: {
                title: "Count",
            },
            legendTooltip: {
                tbody: []
            },
            tooltipConfig: {
                title: function (d) {
                    var a = d.sentiment === -1 ? 'Negative' : d.sentiment === 0 ? 'Neutral' : 'Positive';
                    return "Sentiment Count - " + d["counts"] + ' ' + a;
                },
                tbody: [
                    ["Date: ", function (d) { return d["date"]; }]
                ]
            },
            timeline: "date",
            select: "#chart",
        })
            .render();
        this.empty = false;
    };
    ChartComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.empty = true;
        this.subscription = Object(rxjs__WEBPACK_IMPORTED_MODULE_3__["combineLatest"])(this.data.share, this.data.locationshare, this.data.sharedData).subscribe(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 3), text = _b[0], location = _b[1], selectedData = _b[2];
            if (_this.changedObjtext != text || _this.changedObjLocation != location[0] || _this.changeObjselectedData != selectedData) {
                _this.changedObjtext = text;
                _this.changedObjLocation = location[0];
                _this.changeObjselectedData = selectedData;
                _this.dates = text.split(' to ');
                _this.start = _this.dates[0];
                _this.end = _this.dates[1];
                _this.regiondata = location[0].split(' - ');
                _this.region = _this.regiondata[0];
                _this.parent_region = _this.regiondata[1];
                _this.selectedData = selectedData.split(' ');
                _this.searchValue = _this.selectedData[0];
                _this.type = _this.selectedData[1];
                _this.type === 'topic' ? _this.getTopicsChart() : _this.getHashtagsChart();
            }
        });
    };
    ChartComponent.prototype.getTopicsChart = function () {
        var _this = this;
        if (document.getElementById("chart") != null) {
            document.getElementById('chart').innerHTML = '';
        }
        this.apollo
            .query({
            query: graphql_tag__WEBPACK_IMPORTED_MODULE_5___default()(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n      query discourseTrendingTopics($start: String!, $end: String!, $region: String!, $parent: String!, $topic:String!) {\n        discourseTrendingTopics(start: $start, end: $end, region: $region, parent: $parent topic: $topic){\n            counts\n            sentiment\t\n            topic\n            date\n          }\n        }\n      "], ["\n      query discourseTrendingTopics($start: String!, $end: String!, $region: String!, $parent: String!, $topic:String!) {\n        discourseTrendingTopics(start: $start, end: $end, region: $region, parent: $parent topic: $topic){\n            counts\n            sentiment\t\n            topic\n            date\n          }\n        }\n      "]))),
            variables: {
                start: this.start,
                end: this.end,
                region: this.region,
                parent: this.parent_region,
                topic: this.searchValue
            }
        })
            .subscribe(function (_a) {
            var data = _a.data, loading = _a.loading;
            _this.topicsChart = data && data.discourseTrendingTopics;
            document.getElementById("chart") ? _this.plotChart(_this.topicsChart) : '';
        }, function (error) {
            console.log("error is: ", error);
        });
    };
    ChartComponent.prototype.getHashtagsChart = function () {
        var _this = this;
        if (document.getElementById("chart") != null) {
            document.getElementById('chart').innerHTML = '';
        }
        this.apollo
            .query({
            query: graphql_tag__WEBPACK_IMPORTED_MODULE_5___default()(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n      query hashtagMaster($start: String!, $end: String!, $region: String!, $parent: String!, $topic:String!) {\n        hashtagMaster(start: $start, end: $end, region: $region, parent: $parent, topic: $topic){\n            counts\n            sentiment\n            topic\n            date\n          }\n        }\n      "], ["\n      query hashtagMaster($start: String!, $end: String!, $region: String!, $parent: String!, $topic:String!) {\n        hashtagMaster(start: $start, end: $end, region: $region, parent: $parent, topic: $topic){\n            counts\n            sentiment\n            topic\n            date\n          }\n        }\n      "]))),
            variables: {
                start: this.start,
                end: this.end,
                region: this.region,
                parent: this.parent_region,
                topic: this.searchValue
            }
        })
            .subscribe(function (_a) {
            var data = _a.data, loading = _a.loading;
            _this.hashtagChart = data && data.hashtagMaster;
            document.getElementById("chart") ? _this.plotChart(_this.hashtagChart) : '';
        }, function (error) {
            console.log("error is: ", error);
        });
    };
    ChartComponent.prototype.ngOnDestroy = function () {
        this.subscription.unsubscribe();
    };
    ChartComponent.ctorParameters = function () { return [
        { type: _data_transfer_service__WEBPACK_IMPORTED_MODULE_2__["DataTransferService"] },
        { type: apollo_angular__WEBPACK_IMPORTED_MODULE_4__["Apollo"] }
    ]; };
    ChartComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-chart',
            template: __webpack_require__(/*! raw-loader!./chart.component.html */ "./node_modules/raw-loader/index.js!./src/app/chart/chart.component.html"),
            styles: [__webpack_require__(/*! ./chart.component.css */ "./src/app/chart/chart.component.css")]
        })
    ], ChartComponent);
    return ChartComponent;
}());

var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/app/d3plus.full.js":
/*!********************************!*\
  !*** ./src/app/d3plus.full.js ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*
  d3plus-plot v0.8.38
  A reusable javascript x/y plot built on D3.
  Copyright (c) 2020 D3plus - https://d3plus.org
  @license MIT
*/
(function(t){ true?!(__WEBPACK_AMD_DEFINE_FACTORY__ = (t),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :
				__WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)):undefined})(function(){"use strict";var t=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function e(t,e){return e={exports:{}},t(e,e.exports),e.exports}var n=function(t){return t&&t.Math==Math&&t};var c=n(typeof globalThis=="object"&&globalThis)||n(typeof window=="object"&&window)||n(typeof self=="object"&&self)||n(typeof t=="object"&&t)||Function("return this")();var i=function(t){try{return!!t()}catch(t){return true}};var d=!i(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7});var a={}.propertyIsEnumerable;var r=Object.getOwnPropertyDescriptor;var o=r&&!a.call({1:2},1);var s=o?function t(e){var n=r(this,e);return!!n&&n.enumerable}:a;var g={f:s};var l=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}};var u={}.toString;var h=function(t){return u.call(t).slice(8,-1)};var f="".split;var b=i(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return h(t)=="String"?f.call(t,""):Object(t)}:Object;var p=function(t){if(t==undefined)throw TypeError("Can't call method on "+t);return t};var v=function(t){return b(p(t))};var m=function(t){return typeof t==="object"?t!==null:typeof t==="function"};var _=function(t,e){if(!m(t))return t;var n,i;if(e&&typeof(n=t.toString)=="function"&&!m(i=n.call(t)))return i;if(typeof(n=t.valueOf)=="function"&&!m(i=n.call(t)))return i;if(!e&&typeof(n=t.toString)=="function"&&!m(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")};var y={}.hasOwnProperty;var w=function(t,e){return y.call(t,e)};var x=c.document;var k=m(x)&&m(x.createElement);var S=function(t){return k?x.createElement(t):{}};var C=!d&&!i(function(){return Object.defineProperty(S("div"),"a",{get:function(){return 7}}).a!=7});var A=Object.getOwnPropertyDescriptor;var E=d?A:function t(e,n){e=v(e);n=_(n,true);if(C)try{return A(e,n)}catch(t){}if(w(e,n))return l(!g.f.call(e,n),e[n])};var M={f:E};var R=function(t){if(!m(t)){throw TypeError(String(t)+" is not an object")}return t};var T=Object.defineProperty;var B=d?T:function t(e,n,i){R(e);n=_(n,true);R(i);if(C)try{return T(e,n,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");if("value"in i)e[n]=i.value;return e};var O={f:B};var P=d?function(t,e,n){return O.f(t,e,l(1,n))}:function(t,e,n){t[e]=n;return t};var D=function(e,n){try{P(c,e,n)}catch(t){c[e]=n}return n};var N="__core-js_shared__";var z=c[N]||D(N,{});var F=z;var L=e(function(t){(t.exports=function(t,e){return F[t]||(F[t]=e!==undefined?e:{})})("versions",[]).push({version:"3.4.7",mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})});var j=Function.toString;var I=L("inspectSource",function(t){return j.call(t)});var H=c.WeakMap;var V=typeof H==="function"&&/native code/.test(I(H));var U=0;var G=Math.random();var W=function(t){return"Symbol("+String(t===undefined?"":t)+")_"+(++U+G).toString(36)};var K=L("keys");var q=function(t){return K[t]||(K[t]=W(t))};var Y={};var X=c.WeakMap;var Z,J,$;var Q=function(t){return $(t)?J(t):Z(t,{})};var tt=function(n){return function(t){var e;if(!m(t)||(e=J(t)).type!==n){throw TypeError("Incompatible receiver, "+n+" required")}return e}};if(V){var et=new X;var nt=et.get;var it=et.has;var at=et.set;Z=function(t,e){at.call(et,t,e);return e};J=function(t){return nt.call(et,t)||{}};$=function(t){return it.call(et,t)}}else{var rt=q("state");Y[rt]=true;Z=function(t,e){P(t,rt,e);return e};J=function(t){return w(t,rt)?t[rt]:{}};$=function(t){return w(t,rt)}}var ot={set:Z,get:J,has:$,enforce:Q,getterFor:tt};var st=e(function(t){var e=ot.get;var s=ot.enforce;var l=String(String).split("String");(t.exports=function(t,e,n,i){var a=i?!!i.unsafe:false;var r=i?!!i.enumerable:false;var o=i?!!i.noTargetGet:false;if(typeof n=="function"){if(typeof e=="string"&&!w(n,"name"))P(n,"name",e);s(n).source=l.join(typeof e=="string"?e:"")}if(t===c){if(r)t[e]=n;else D(e,n);return}else if(!a){delete t[e]}else if(!o&&t[e]){r=true}if(r)t[e]=n;else P(t,e,n)})(Function.prototype,"toString",function t(){return typeof this=="function"&&e(this).source||I(this)})});var lt=c;var ut=function(t){return typeof t=="function"?t:undefined};var ht=function(t,e){return arguments.length<2?ut(lt[t])||ut(c[t]):lt[t]&&lt[t][e]||c[t]&&c[t][e]};var ct=Math.ceil;var ft=Math.floor;var dt=function(t){return isNaN(t=+t)?0:(t>0?ft:ct)(t)};var gt=Math.min;var pt=function(t){return t>0?gt(dt(t),9007199254740991):0};var vt=Math.max;var mt=Math.min;var _t=function(t,e){var n=dt(t);return n<0?vt(n+e,0):mt(n,e)};var yt=function(s){return function(t,e,n){var i=v(t);var a=pt(i.length);var r=_t(n,a);var o;if(s&&e!=e)while(a>r){o=i[r++];if(o!=o)return true}else for(;a>r;r++){if((s||r in i)&&i[r]===e)return s||r||0}return!s&&-1}};var bt={includes:yt(true),indexOf:yt(false)};var wt=bt.indexOf;var xt=function(t,e){var n=v(t);var i=0;var a=[];var r;for(r in n)!w(Y,r)&&w(n,r)&&a.push(r);while(e.length>i)if(w(n,r=e[i++])){~wt(a,r)||a.push(r)}return a};var kt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var St=kt.concat("length","prototype");var Ct=Object.getOwnPropertyNames||function t(e){return xt(e,St)};var At={f:Ct};var Et=Object.getOwnPropertySymbols;var Mt={f:Et};var Rt=ht("Reflect","ownKeys")||function t(e){var n=At.f(R(e));var i=Mt.f;return i?n.concat(i(e)):n};var Tt=function(t,e){var n=Rt(e);var i=O.f;var a=M.f;for(var r=0;r<n.length;r++){var o=n[r];if(!w(t,o))i(t,o,a(e,o))}};var Bt=/#|\.prototype\./;var Ot=function(t,e){var n=Dt[Pt(t)];return n==zt?true:n==Nt?false:typeof e=="function"?i(e):!!e};var Pt=Ot.normalize=function(t){return String(t).replace(Bt,".").toLowerCase()};var Dt=Ot.data={};var Nt=Ot.NATIVE="N";var zt=Ot.POLYFILL="P";var Ft=Ot;var Lt=M.f;var jt=function(t,e){var n=t.target;var i=t.global;var a=t.stat;var r,o,s,l,u,h;if(i){o=c}else if(a){o=c[n]||D(n,{})}else{o=(c[n]||{}).prototype}if(o)for(s in e){u=e[s];if(t.noTargetGet){h=Lt(o,s);l=h&&h.value}else l=o[s];r=Ft(i?s:n+(a?".":"#")+s,t.forced);if(!r&&l!==undefined){if(typeof u===typeof l)continue;Tt(u,l)}if(t.sham||l&&l.sham){P(u,"sham",true)}st(o,s,u,t)}};var It=function(t){if(typeof t!="function"){throw TypeError(String(t)+" is not a function")}return t};var Ht=function(i,a,t){It(i);if(a===undefined)return i;switch(t){case 0:return function(){return i.call(a)};case 1:return function(t){return i.call(a,t)};case 2:return function(t,e){return i.call(a,t,e)};case 3:return function(t,e,n){return i.call(a,t,e,n)}}return function(){return i.apply(a,arguments)}};var Vt=function(t){return Object(p(t))};var Ut=Array.isArray||function t(e){return h(e)=="Array"};var Gt=!!Object.getOwnPropertySymbols&&!i(function(){return!String(Symbol())});var Wt=Gt&&!Symbol.sham&&typeof Symbol()=="symbol";var Kt=L("wks");var qt=c.Symbol;var Yt=Wt?qt:W;var Xt=function(t){if(!w(Kt,t)){if(Gt&&w(qt,t))Kt[t]=qt[t];else Kt[t]=Yt("Symbol."+t)}return Kt[t]};var Zt=Xt("species");var Jt=function(t,e){var n;if(Ut(t)){n=t.constructor;if(typeof n=="function"&&(n===Array||Ut(n.prototype)))n=undefined;else if(m(n)){n=n[Zt];if(n===null)n=undefined}}return new(n===undefined?Array:n)(e===0?0:e)};var $t=[].push;var Qt=function(d){var g=d==1;var p=d==2;var v=d==3;var m=d==4;var _=d==6;var y=d==5||_;return function(t,e,n,i){var a=Vt(t);var r=b(a);var o=Ht(e,n,3);var s=pt(r.length);var l=0;var u=i||Jt;var h=g?u(t,s):p?u(t,0):undefined;var c,f;for(;s>l;l++)if(y||l in r){c=r[l];f=o(c,l,a);if(d){if(g)h[l]=f;else if(f)switch(d){case 3:return true;case 5:return c;case 6:return l;case 2:$t.call(h,c)}else if(m)return false}}return _?-1:v||m?m:h}};var te={forEach:Qt(0),map:Qt(1),filter:Qt(2),some:Qt(3),every:Qt(4),find:Qt(5),findIndex:Qt(6)};var ee=Object.keys||function t(e){return xt(e,kt)};var ne=d?Object.defineProperties:function t(e,n){R(e);var i=ee(n);var a=i.length;var r=0;var o;while(a>r)O.f(e,o=i[r++],n[o]);return e};var ie=ht("document","documentElement");var ae=q("IE_PROTO");var re="prototype";var oe=function(){};var se=function(){var t=S("iframe");var e=kt.length;var n="<";var i="script";var a=">";var r="java"+i+":";var o;t.style.display="none";ie.appendChild(t);t.src=String(r);o=t.contentWindow.document;o.open();o.write(n+i+a+"document.F=Object"+n+"/"+i+a);o.close();se=o.F;while(e--)delete se[re][kt[e]];return se()};var le=Object.create||function t(e,n){var i;if(e!==null){oe[re]=R(e);i=new oe;oe[re]=null;i[ae]=e}else i=se();return n===undefined?i:ne(i,n)};Y[ae]=true;var ue=Xt("unscopables");var he=Array.prototype;if(he[ue]==undefined){P(he,ue,le(null))}var ce=function(t){he[ue][t]=true};var fe=te.find;var de="find";var ge=true;if(de in[])Array(1)[de](function(){ge=false});jt({target:"Array",proto:true,forced:ge},{find:function t(e){return fe(this,e,arguments.length>1?arguments[1]:undefined)}});ce(de);var pe=bt.includes;jt({target:"Array",proto:true},{includes:function t(e){return pe(this,e,arguments.length>1?arguments[1]:undefined)}});ce("includes");var ve=Object.assign;var me=Object.defineProperty;var _e=!ve||i(function(){if(d&&ve({b:1},ve(me({},"a",{enumerable:true,get:function(){me(this,"b",{value:3,enumerable:false})}}),{b:2})).b!==1)return true;var t={};var e={};var n=Symbol();var i="abcdefghijklmnopqrst";t[n]=7;i.split("").forEach(function(t){e[t]=t});return ve({},t)[n]!=7||ee(ve({},e)).join("")!=i})?function t(e,n){var i=Vt(e);var a=arguments.length;var r=1;var o=Mt.f;var s=g.f;while(a>r){var l=b(arguments[r++]);var u=o?ee(l).concat(o(l)):ee(l);var h=u.length;var c=0;var f;while(h>c){f=u[c++];if(!d||s.call(l,f))i[f]=l[f]}}return i}:ve;jt({target:"Object",stat:true,forced:Object.assign!==_e},{assign:_e});var ye=Xt("match");var be=function(t){var e;return m(t)&&((e=t[ye])!==undefined?!!e:h(t)=="RegExp")};var we=function(t){if(be(t)){throw TypeError("The method doesn't accept regular expressions")}return t};var xe=Xt("match");var ke=function(e){var n=/./;try{"/./"[e](n)}catch(t){try{n[xe]=false;return"/./"[e](n)}catch(t){}}return false};jt({target:"String",proto:true,forced:!ke("includes")},{includes:function t(e){return!!~String(p(this)).indexOf(we(e),arguments.length>1?arguments[1]:undefined)}});var Se=M.f;var Ce="".startsWith;var Ae=Math.min;var Ee=ke("startsWith");var Me=!Ee&&!!function(){var t=Se(String.prototype,"startsWith");return t&&!t.writable}();jt({target:"String",proto:true,forced:!Me&&!Ee},{startsWith:function t(e){var n=String(p(this));we(e);var i=pt(Ae(arguments.length>1?arguments[1]:undefined,n.length));var a=String(e);return Ce?Ce.call(n,a,i):n.slice(i,i+a.length)===a}});if(typeof window!=="undefined"){(function(){var i=function(t,e){var n=t.nodeType;if(n===3){e.push(t.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"))}else if(n===1){e.push("<",t.tagName);if(t.hasAttributes()){[].forEach.call(t.attributes,function(t){e.push(" ",t.item.name,"='",t.item.value,"'")})}if(t.hasChildNodes()){e.push(">");[].forEach.call(t.childNodes,function(t){i(t,e)});e.push("</",t.tagName,">")}else{e.push("/>")}}else if(n==8){e.push("\x3c!--",t.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var t=[];var e=this.firstChild;while(e){i(e,t);e=e.nextSibling}return t.join("")},set:function(t){while(this.firstChild){this.removeChild(this.firstChild)}try{var e=new DOMParser;e.async=false;var n="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+t+"</svg>";var i=e.parseFromString(n,"text/xml").documentElement;var a=i.firstChild;while(a){this.appendChild(this.ownerDocument.importNode(a,true));a=a.nextSibling}}catch(t){}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}})})()}});(function(t,e){ true?e(exports):undefined})(this,function(t){function ie(t){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){ie=function(t){return typeof t}}else{ie=function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return ie(t)}function n(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function e(t,e,n){if(e)i(t.prototype,e);if(n)i(t,n);return t}function ae(t,e,n){if(e in t){Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true})}else{t[e]=n}return t}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);if(t)i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable});n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};if(t%2){a(Object(n),true).forEach(function(t){ae(e,t,n[t])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(n))}else{a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}}return e}function o(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)s(t,e)}function re(t){re=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return re(t)}function s(t,e){s=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return s(t,e)}function l(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function u(t,e){if(e&&(typeof e==="object"||typeof e==="function")){return e}return l(t)}function h(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=re(t);if(t===null)break}return t}function oe(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){oe=Reflect.get}else{oe=function t(e,n,i){var a=h(e,n);if(!a)return;var r=Object.getOwnPropertyDescriptor(a,n);if(r.get){return r.get.call(i)}return r.value}}return oe(t,e,n||t)}function se(t,e){return c(t)||f(t,e)||d()}function c(t){if(Array.isArray(t))return t}function f(t,e){if(!(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")){return}var n=[];var i=true;var a=false;var r=undefined;try{for(var o=t[Symbol.iterator](),s;!(i=(s=o.next()).done);i=true){n.push(s.value);if(e&&n.length===e)break}}catch(t){a=true;r=t}finally{try{if(!i&&o["return"]!=null)o["return"]()}finally{if(a)throw r}}return n}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function g(e,n){if(n===void 0)return function(t){return t[e]};return function(t){return t[e]===void 0?n:t[e]}}function p(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){p=function t(e){return ie(e)}}else{p=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return p(t)}function v(t){return t&&p(t)==="object"&&(typeof window==="undefined"||t!==window&&t!==window.document&&!(t instanceof Element))&&!Array.isArray(t)?true:false}function m(t){if(typeof window==="undefined")return true;else return t!==window&&t!==document}function gt(){var i=arguments;var a=arguments.length<=0?undefined:arguments[0];var t=function t(e){var n=e<0||i.length<=e?undefined:i[e];Object.keys(n).forEach(function(t){var e=n[t];if(v(e)&&m(e)){if(a.hasOwnProperty(t)&&v(a[t]))a[t]=gt({},a[t],e);else a[t]=gt({},e)}else if(Array.isArray(e))a[t]=e.slice();else a[t]=e})};for(var e=1;e<arguments.length;e++){t(e)}return a}function _(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};for(var n in e){if({}.hasOwnProperty.call(e,n))t.attr(n,e[n])}}var y={language:"Afar",location:null,id:4096,tag:"aa",version:"Release 10"};var b={language:"Afrikaans",location:null,id:54,tag:"af",version:"Release 7"};var w={language:"Aghem",location:null,id:4096,tag:"agq",version:"Release 10"};var x={language:"Akan",location:null,id:4096,tag:"ak",version:"Release 10"};var k={language:"Albanian",location:null,id:28,tag:"sq",version:"Release 7"};var S={language:"Alsatian",location:null,id:132,tag:"gsw",version:"Release 7"};var C={language:"Amharic",location:null,id:94,tag:"am",version:"Release 7"};var A={language:"Arabic",location:null,id:1,tag:"ar",version:"Release 7"};var E={language:"Armenian",location:null,id:43,tag:"hy",version:"Release 7"};var M={language:"Assamese",location:null,id:77,tag:"as",version:"Release 7"};var R={language:"Asturian",location:null,id:4096,tag:"ast",version:"Release 10"};var T={language:"Asu",location:null,id:4096,tag:"asa",version:"Release 10"};var B={language:"Azerbaijani (Latin)",location:null,id:44,tag:"az",version:"Release 7"};var O={language:"Bafia",location:null,id:4096,tag:"ksf",version:"Release 10"};var P={language:"Bamanankan",location:null,id:4096,tag:"bm",version:"Release 10"};var D={language:"Bangla",location:null,id:69,tag:"bn",version:"Release 7"};var N={language:"Basaa",location:null,id:4096,tag:"bas",version:"Release 10"};var z={language:"Bashkir",location:null,id:109,tag:"ba",version:"Release 7"};var F={language:"Basque",location:null,id:45,tag:"eu",version:"Release 7"};var L={language:"Belarusian",location:null,id:35,tag:"be",version:"Release 7"};var j={language:"Bemba",location:null,id:4096,tag:"bem",version:"Release 10"};var I={language:"Bena",location:null,id:4096,tag:"bez",version:"Release 10"};var H={language:"Blin",location:null,id:4096,tag:"byn",version:"Release 10"};var V={language:"Bodo",location:null,id:4096,tag:"brx",version:"Release 10"};var U={language:"Bosnian (Latin)",location:null,id:30746,tag:"bs",version:"Release 7"};var G={language:"Breton",location:null,id:126,tag:"br",version:"Release 7"};var W={language:"Bulgarian",location:null,id:2,tag:"bg",version:"Release 7"};var K={language:"Burmese",location:null,id:85,tag:"my",version:"Release 8.1"};var q={language:"Catalan",location:null,id:3,tag:"ca",version:"Release 7"};var Y={language:"Central Kurdish",location:null,id:146,tag:"ku",version:"Release 8"};var X={language:"Cherokee",location:null,id:92,tag:"chr",version:"Release 8"};var Z={language:"Chiga",location:null,id:4096,tag:"cgg",version:"Release 10"};var J={language:"Chinese (Simplified)",location:null,id:30724,tag:"zh",version:"Windows 7"};var Q={language:"Congo Swahili",location:null,id:4096,tag:"swc",version:"Release 10"};var tt={language:"Cornish",location:null,id:4096,tag:"kw",version:"Release 10"};var et={language:"Corsican",location:null,id:131,tag:"co",version:"Release 7"};var nt={language:"Czech",location:null,id:5,tag:"cs",version:"Release 7"};var it={language:"Danish",location:null,id:6,tag:"da",version:"Release 7"};var at={language:"Dari",location:null,id:140,tag:"prs",version:"Release 7"};var rt={language:"Divehi",location:null,id:101,tag:"dv",version:"Release 7"};var ot={language:"Duala",location:null,id:4096,tag:"dua",version:"Release 10"};var st={language:"Dutch",location:null,id:19,tag:"nl",version:"Release 7"};var lt={language:"Dzongkha",location:null,id:4096,tag:"dz",version:"Release 10"};var ut={language:"Embu",location:null,id:4096,tag:"ebu",version:"Release 10"};var ht={language:"English",location:null,id:9,tag:"en",version:"Release 7"};var ct={language:"Esperanto",location:null,id:4096,tag:"eo",version:"Release 10"};var ft={language:"Estonian",location:null,id:37,tag:"et",version:"Release 7"};var dt={language:"Ewe",location:null,id:4096,tag:"ee",version:"Release 10"};var pt={language:"Ewondo",location:null,id:4096,tag:"ewo",version:"Release 10"};var vt={language:"Faroese",location:null,id:56,tag:"fo",version:"Release 7"};var mt={language:"Filipino",location:null,id:100,tag:"fil",version:"Release 7"};var _t={language:"Finnish",location:null,id:11,tag:"fi",version:"Release 7"};var yt={language:"French",location:null,id:12,tag:"fr",version:"Release 7"};var bt={language:"Frisian",location:null,id:98,tag:"fy",version:"Release 7"};var wt={language:"Friulian",location:null,id:4096,tag:"fur",version:"Release 10"};var xt={language:"Fulah",location:null,id:103,tag:"ff",version:"Release 8"};var kt={language:"Galician",location:null,id:86,tag:"gl",version:"Release 7"};var St={language:"Ganda",location:null,id:4096,tag:"lg",version:"Release 10"};var Ct={language:"Georgian",location:null,id:55,tag:"ka",version:"Release 7"};var At={language:"German",location:null,id:7,tag:"de",version:"Release 7"};var Et={language:"Greek",location:null,id:8,tag:"el",version:"Release 7"};var Mt={language:"Greenlandic",location:null,id:111,tag:"kl",version:"Release 7"};var Rt={language:"Guarani",location:null,id:116,tag:"gn",version:"Release 8.1"};var Tt={language:"Gujarati",location:null,id:71,tag:"gu",version:"Release 7"};var Bt={language:"Gusii",location:null,id:4096,tag:"guz",version:"Release 10"};var Ot={language:"Hausa (Latin)",location:null,id:104,tag:"ha",version:"Release 7"};var Pt={language:"Hawaiian",location:null,id:117,tag:"haw",version:"Release 8"};var Dt={language:"Hebrew",location:null,id:13,tag:"he",version:"Release 7"};var Nt={language:"Hindi",location:null,id:57,tag:"hi",version:"Release 7"};var zt={language:"Hungarian",location:null,id:14,tag:"hu",version:"Release 7"};var Ft={language:"Icelandic",location:null,id:15,tag:"is",version:"Release 7"};var Lt={language:"Igbo",location:null,id:112,tag:"ig",version:"Release 7"};var jt={language:"Indonesian",location:null,id:33,tag:"id",version:"Release 7"};var It={language:"Interlingua",location:null,id:4096,tag:"ia",version:"Release 10"};var Ht={language:"Inuktitut (Latin)",location:null,id:93,tag:"iu",version:"Release 7"};var Vt={language:"Irish",location:null,id:60,tag:"ga",version:"Windows 7"};var Ut={language:"Italian",location:null,id:16,tag:"it",version:"Release 7"};var Gt={language:"Japanese",location:null,id:17,tag:"ja",version:"Release 7"};var Wt={language:"Javanese",location:null,id:4096,tag:"jv",version:"Release 8.1"};var Kt={language:"Jola-Fonyi",location:null,id:4096,tag:"dyo",version:"Release 10"};var qt={language:"Kabuverdianu",location:null,id:4096,tag:"kea",version:"Release 10"};var Yt={language:"Kabyle",location:null,id:4096,tag:"kab",version:"Release 10"};var Xt={language:"Kako",location:null,id:4096,tag:"kkj",version:"Release 10"};var Zt={language:"Kalenjin",location:null,id:4096,tag:"kln",version:"Release 10"};var Jt={language:"Kamba",location:null,id:4096,tag:"kam",version:"Release 10"};var $t={language:"Kannada",location:null,id:75,tag:"kn",version:"Release 7"};var Qt={language:"Kashmiri",location:null,id:96,tag:"ks",version:"Release 10"};var te={language:"Kazakh",location:null,id:63,tag:"kk",version:"Release 7"};var ee={language:"Khmer",location:null,id:83,tag:"km",version:"Release 7"};var ne={language:"K'iche",location:null,id:134,tag:"quc",version:"Release 10"};var le={language:"Kikuyu",location:null,id:4096,tag:"ki",version:"Release 10"};var ue={language:"Kinyarwanda",location:null,id:135,tag:"rw",version:"Release 7"};var he={language:"Kiswahili",location:null,id:65,tag:"sw",version:"Release 7"};var ce={language:"Konkani",location:null,id:87,tag:"kok",version:"Release 7"};var fe={language:"Korean",location:null,id:18,tag:"ko",version:"Release 7"};var de={language:"Koyra Chiini",location:null,id:4096,tag:"khq",version:"Release 10"};var ge={language:"Koyraboro Senni",location:null,id:4096,tag:"ses",version:"Release 10"};var pe={language:"Kwasio",location:null,id:4096,tag:"nmg",version:"Release 10"};var ve={language:"Kyrgyz",location:null,id:64,tag:"ky",version:"Release 7"};var me={language:"Lakota",location:null,id:4096,tag:"lkt",version:"Release 10"};var _e={language:"Langi",location:null,id:4096,tag:"lag",version:"Release 10"};var ye={language:"Lao",location:null,id:84,tag:"lo",version:"Release 7"};var be={language:"Latvian",location:null,id:38,tag:"lv",version:"Release 7"};var we={language:"Lingala",location:null,id:4096,tag:"ln",version:"Release 10"};var xe={language:"Lithuanian",location:null,id:39,tag:"lt",version:"Release 7"};var ke={language:"Low German",location:null,id:4096,tag:"nds",version:"Release 10.2"};var Se={language:"Lower Sorbian",location:null,id:31790,tag:"dsb",version:"Windows 7"};var Ce={language:"Luba-Katanga",location:null,id:4096,tag:"lu",version:"Release 10"};var Ae={language:"Luo",location:null,id:4096,tag:"luo",version:"Release 10"};var Ee={language:"Luxembourgish",location:null,id:110,tag:"lb",version:"Release 7"};var Me={language:"Luyia",location:null,id:4096,tag:"luy",version:"Release 10"};var Re={language:"Macedonian",location:null,id:47,tag:"mk",version:"Release 7"};var Te={language:"Machame",location:null,id:4096,tag:"jmc",version:"Release 10"};var Be={language:"Makhuwa-Meetto",location:null,id:4096,tag:"mgh",version:"Release 10"};var Oe={language:"Makonde",location:null,id:4096,tag:"kde",version:"Release 10"};var Pe={language:"Malagasy",location:null,id:4096,tag:"mg",version:"Release 8.1"};var De={language:"Malay",location:null,id:62,tag:"ms",version:"Release 7"};var Ne={language:"Malayalam",location:null,id:76,tag:"ml",version:"Release 7"};var ze={language:"Maltese",location:null,id:58,tag:"mt",version:"Release 7"};var Fe={language:"Manx",location:null,id:4096,tag:"gv",version:"Release 10"};var Le={language:"Maori",location:null,id:129,tag:"mi",version:"Release 7"};var je={language:"Mapudungun",location:null,id:122,tag:"arn",version:"Release 7"};var Ie={language:"Marathi",location:null,id:78,tag:"mr",version:"Release 7"};var He={language:"Masai",location:null,id:4096,tag:"mas",version:"Release 10"};var Ve={language:"Meru",location:null,id:4096,tag:"mer",version:"Release 10"};var Ue={language:"Meta'",location:null,id:4096,tag:"mgo",version:"Release 10"};var Ge={language:"Mohawk",location:null,id:124,tag:"moh",version:"Release 7"};var We={language:"Mongolian (Cyrillic)",location:null,id:80,tag:"mn",version:"Release 7"};var Ke={language:"Morisyen",location:null,id:4096,tag:"mfe",version:"Release 10"};var qe={language:"Mundang",location:null,id:4096,tag:"mua",version:"Release 10"};var Ye={language:"N'ko",location:null,id:4096,tag:"nqo",version:"Release 8.1"};var Xe={language:"Nama",location:null,id:4096,tag:"naq",version:"Release 10"};var Ze={language:"Nepali",location:null,id:97,tag:"ne",version:"Release 7"};var Je={language:"Ngiemboon",location:null,id:4096,tag:"nnh",version:"Release 10"};var $e={language:"Ngomba",location:null,id:4096,tag:"jgo",version:"Release 10"};var Qe={language:"North Ndebele",location:null,id:4096,tag:"nd",version:"Release 10"};var tn={language:"Norwegian (Bokmal)",location:null,id:20,tag:"no",version:"Release 7"};var en={language:"Norwegian (Bokmal)",location:null,id:31764,tag:"nb",version:"Release 7"};var nn={language:"Norwegian (Nynorsk)",location:null,id:30740,tag:"nn",version:"Release 7"};var an={language:"Nuer",location:null,id:4096,tag:"nus",version:"Release 10"};var rn={language:"Nyankole",location:null,id:4096,tag:"nyn",version:"Release 10"};var on={language:"Occitan",location:null,id:130,tag:"oc",version:"Release 7"};var sn={language:"Odia",location:null,id:72,tag:"or",version:"Release 7"};var ln={language:"Oromo",location:null,id:114,tag:"om",version:"Release 8.1"};var un={language:"Ossetian",location:null,id:4096,tag:"os",version:"Release 10"};var hn={language:"Pashto",location:null,id:99,tag:"ps",version:"Release 7"};var cn={language:"Persian",location:null,id:41,tag:"fa",version:"Release 7"};var fn={language:"Polish",location:null,id:21,tag:"pl",version:"Release 7"};var dn={language:"Portuguese",location:null,id:22,tag:"pt",version:"Release 7"};var gn={language:"Punjabi",location:null,id:70,tag:"pa",version:"Release 7"};var pn={language:"Quechua",location:null,id:107,tag:"quz",version:"Release 7"};var vn={language:"Ripuarian",location:null,id:4096,tag:"ksh",version:"Release 10"};var mn={language:"Romanian",location:null,id:24,tag:"ro",version:"Release 7"};var _n={language:"Romansh",location:null,id:23,tag:"rm",version:"Release 7"};var yn={language:"Rombo",location:null,id:4096,tag:"rof",version:"Release 10"};var bn={language:"Rundi",location:null,id:4096,tag:"rn",version:"Release 10"};var wn={language:"Russian",location:null,id:25,tag:"ru",version:"Release 7"};var xn={language:"Rwa",location:null,id:4096,tag:"rwk",version:"Release 10"};var kn={language:"Saho",location:null,id:4096,tag:"ssy",version:"Release 10"};var Sn={language:"Sakha",location:null,id:133,tag:"sah",version:"Release 7"};var Cn={language:"Samburu",location:null,id:4096,tag:"saq",version:"Release 10"};var An={language:"Sami (Inari)",location:null,id:28731,tag:"smn",version:"Windows 7"};var En={language:"Sami (Lule)",location:null,id:31803,tag:"smj",version:"Windows 7"};var Mn={language:"Sami (Northern)",location:null,id:59,tag:"se",version:"Release 7"};var Rn={language:"Sami (Skolt)",location:null,id:29755,tag:"sms",version:"Windows 7"};var Tn={language:"Sami (Southern)",location:null,id:30779,tag:"sma",version:"Windows 7"};var Bn={language:"Sango",location:null,id:4096,tag:"sg",version:"Release 10"};var On={language:"Sangu",location:null,id:4096,tag:"sbp",version:"Release 10"};var Pn={language:"Sanskrit",location:null,id:79,tag:"sa",version:"Release 7"};var Dn={language:"Scottish Gaelic",location:null,id:145,tag:"gd",version:"Windows 7"};var Nn={language:"Sena",location:null,id:4096,tag:"seh",version:"Release 10"};var zn={language:"Serbian (Latin)",location:null,id:31770,tag:"sr",version:"Release 7"};var Fn={language:"Sesotho sa Leboa",location:null,id:108,tag:"nso",version:"Release 7"};var Ln={language:"Setswana",location:null,id:50,tag:"tn",version:"Release 7"};var jn={language:"Shambala",location:null,id:4096,tag:"ksb",version:"Release 10"};var In={language:"Shona",location:null,id:4096,tag:"sn",version:"Release 8.1"};var Hn={language:"Sindhi",location:null,id:89,tag:"sd",version:"Release 8"};var Vn={language:"Sinhala",location:null,id:91,tag:"si",version:"Release 7"};var Un={language:"Slovak",location:null,id:27,tag:"sk",version:"Release 7"};var Gn={language:"Slovenian",location:null,id:36,tag:"sl",version:"Release 7"};var Wn={language:"Soga",location:null,id:4096,tag:"xog",version:"Release 10"};var Kn={language:"Somali",location:null,id:119,tag:"so",version:"Release 8.1"};var qn={language:"Sotho",location:null,id:48,tag:"st",version:"Release 8.1"};var Yn={language:"South Ndebele",location:null,id:4096,tag:"nr",version:"Release 10"};var Xn={language:"Spanish",location:null,id:10,tag:"es",version:"Release 7"};var Zn={language:"Standard Moroccan ",location:null,id:4096,tag:"zgh",version:"Release 8.1"};var Jn={language:"Swati",location:null,id:4096,tag:"ss",version:"Release 10"};var $n={language:"Swedish",location:null,id:29,tag:"sv",version:"Release 7"};var Qn={language:"Syriac",location:null,id:90,tag:"syr",version:"Release 7"};var ti={language:"Tachelhit",location:null,id:4096,tag:"shi",version:"Release 10"};var ei={language:"Taita",location:null,id:4096,tag:"dav",version:"Release 10"};var ni={language:"Tajik (Cyrillic)",location:null,id:40,tag:"tg",version:"Release 7"};var ii={language:"Tamazight (Latin)",location:null,id:95,tag:"tzm",version:"Release 7"};var ai={language:"Tamil",location:null,id:73,tag:"ta",version:"Release 7"};var ri={language:"Tasawaq",location:null,id:4096,tag:"twq",version:"Release 10"};var oi={language:"Tatar",location:null,id:68,tag:"tt",version:"Release 7"};var si={language:"Telugu",location:null,id:74,tag:"te",version:"Release 7"};var li={language:"Teso",location:null,id:4096,tag:"teo",version:"Release 10"};var ui={language:"Thai",location:null,id:30,tag:"th",version:"Release 7"};var hi={language:"Tibetan",location:null,id:81,tag:"bo",version:"Release 7"};var ci={language:"Tigre",location:null,id:4096,tag:"tig",version:"Release 10"};var fi={language:"Tigrinya",location:null,id:115,tag:"ti",version:"Release 8"};var di={language:"Tongan",location:null,id:4096,tag:"to",version:"Release 10"};var gi={language:"Tsonga",location:null,id:49,tag:"ts",version:"Release 8.1"};var pi={language:"Turkish",location:null,id:31,tag:"tr",version:"Release 7"};var vi={language:"Turkmen",location:null,id:66,tag:"tk",version:"Release 7"};var mi={language:"Ukrainian",location:null,id:34,tag:"uk",version:"Release 7"};var _i={language:"Upper Sorbian",location:null,id:46,tag:"hsb",version:"Release 7"};var yi={language:"Urdu",location:null,id:32,tag:"ur",version:"Release 7"};var bi={language:"Uyghur",location:null,id:128,tag:"ug",version:"Release 7"};var wi={language:"Uzbek (Latin)",location:null,id:67,tag:"uz",version:"Release 7"};var xi={language:"Vai",location:null,id:4096,tag:"vai",version:"Release 10"};var ki={language:"Venda",location:null,id:51,tag:"ve",version:"Release 10"};var Si={language:"Vietnamese",location:null,id:42,tag:"vi",version:"Release 7"};var Ci={language:"Volapk",location:null,id:4096,tag:"vo",version:"Release 10"};var Ai={language:"Vunjo",location:null,id:4096,tag:"vun",version:"Release 10"};var Ei={language:"Walser",location:null,id:4096,tag:"wae",version:"Release 10"};var Mi={language:"Welsh",location:null,id:82,tag:"cy",version:"Release 7"};var Ri={language:"Wolaytta",location:null,id:4096,tag:"wal",version:"Release 10"};var Ti={language:"Wolof",location:null,id:136,tag:"wo",version:"Release 7"};var Bi={language:"Xhosa",location:null,id:52,tag:"xh",version:"Release 7"};var Oi={language:"Yangben",location:null,id:4096,tag:"yav",version:"Release 10"};var Pi={language:"Yi",location:null,id:120,tag:"ii",version:"Release 7"};var Di={language:"Yoruba",location:null,id:106,tag:"yo",version:"Release 7"};var Ni={language:"Zarma",location:null,id:4096,tag:"dje",version:"Release 10"};var zi={language:"Zulu",location:null,id:53,tag:"zu",version:"Release 7"};var Fi={aa:y,"aa-dj":{language:"Afar",location:"Djibouti",id:4096,tag:"aa-DJ",version:"Release 10"},"aa-er":{language:"Afar",location:"Eritrea",id:4096,tag:"aa-ER",version:"Release 10"},"aa-et":{language:"Afar",location:"Ethiopia",id:4096,tag:"aa-ET",version:"Release 10"},af:b,"af-na":{language:"Afrikaans",location:"Namibia",id:4096,tag:"af-NA",version:"Release 10"},"af-za":{language:"Afrikaans",location:"South Africa",id:1078,tag:"af-ZA",version:"Release B"},agq:w,"agq-cm":{language:"Aghem",location:"Cameroon",id:4096,tag:"agq-CM",version:"Release 10"},ak:x,"ak-gh":{language:"Akan",location:"Ghana",id:4096,tag:"ak-GH",version:"Release 10"},sq:k,"sq-al":{language:"Albanian",location:"Albania",id:1052,tag:"sq-AL",version:"Release B"},"sq-mk":{language:"Albanian",location:"North Macedonia",id:4096,tag:"sq-MK",version:"Release 10"},gsw:S,"gsw-fr":{language:"Alsatian",location:"France",id:1156,tag:"gsw-FR",version:"Release V"},"gsw-li":{language:"Alsatian",location:"Liechtenstein",id:4096,tag:"gsw-LI",version:"Release 10"},"gsw-ch":{language:"Alsatian",location:"Switzerland",id:4096,tag:"gsw-CH",version:"Release 10"},am:C,"am-et":{language:"Amharic",location:"Ethiopia",id:1118,tag:"am-ET",version:"Release V"},ar:A,"ar-dz":{language:"Arabic",location:"Algeria",id:5121,tag:"ar-DZ",version:"Release B"},"ar-bh":{language:"Arabic",location:"Bahrain",id:15361,tag:"ar-BH",version:"Release B"},"ar-td":{language:"Arabic",location:"Chad",id:4096,tag:"ar-TD",version:"Release 10"},"ar-km":{language:"Arabic",location:"Comoros",id:4096,tag:"ar-KM",version:"Release 10"},"ar-dj":{language:"Arabic",location:"Djibouti",id:4096,tag:"ar-DJ",version:"Release 10"},"ar-eg":{language:"Arabic",location:"Egypt",id:3073,tag:"ar-EG",version:"Release B"},"ar-er":{language:"Arabic",location:"Eritrea",id:4096,tag:"ar-ER",version:"Release 10"},"ar-iq":{language:"Arabic",location:"Iraq",id:2049,tag:"ar-IQ",version:"Release B"},"ar-il":{language:"Arabic",location:"Israel",id:4096,tag:"ar-IL",version:"Release 10"},"ar-jo":{language:"Arabic",location:"Jordan",id:11265,tag:"ar-JO",version:"Release B"},"ar-kw":{language:"Arabic",location:"Kuwait",id:13313,tag:"ar-KW",version:"Release B"},"ar-lb":{language:"Arabic",location:"Lebanon",id:12289,tag:"ar-LB",version:"Release B"},"ar-ly":{language:"Arabic",location:"Libya",id:4097,tag:"ar-LY",version:"Release B"},"ar-mr":{language:"Arabic",location:"Mauritania",id:4096,tag:"ar-MR",version:"Release 10"},"ar-ma":{language:"Arabic",location:"Morocco",id:6145,tag:"ar-MA",version:"Release B"},"ar-om":{language:"Arabic",location:"Oman",id:8193,tag:"ar-OM",version:"Release B"},"ar-ps":{language:"Arabic",location:"Palestinian Authority",id:4096,tag:"ar-PS",version:"Release 10"},"ar-qa":{language:"Arabic",location:"Qatar",id:16385,tag:"ar-QA",version:"Release B"},"ar-sa":{language:"Arabic",location:"Saudi Arabia",id:1025,tag:"ar-SA",version:"Release B"},"ar-so":{language:"Arabic",location:"Somalia",id:4096,tag:"ar-SO",version:"Release 10"},"ar-ss":{language:"Arabic",location:"South Sudan",id:4096,tag:"ar-SS",version:"Release 10"},"ar-sd":{language:"Arabic",location:"Sudan",id:4096,tag:"ar-SD",version:"Release 10"},"ar-sy":{language:"Arabic",location:"Syria",id:10241,tag:"ar-SY",version:"Release B"},"ar-tn":{language:"Arabic",location:"Tunisia",id:7169,tag:"ar-TN",version:"Release B"},"ar-ae":{language:"Arabic",location:"U.A.E.",id:14337,tag:"ar-AE",version:"Release B"},"ar-001":{language:"Arabic",location:"World",id:4096,tag:"ar-001",version:"Release 10"},"ar-ye":{language:"Arabic",location:"Yemen",id:9217,tag:"ar-YE",version:"Release B"},hy:E,"hy-am":{language:"Armenian",location:"Armenia",id:1067,tag:"hy-AM",version:"Release C"},as:M,"as-in":{language:"Assamese",location:"India",id:1101,tag:"as-IN",version:"Release V"},ast:R,"ast-es":{language:"Asturian",location:"Spain",id:4096,tag:"ast-ES",version:"Release 10"},asa:T,"asa-tz":{language:"Asu",location:"Tanzania",id:4096,tag:"asa-TZ",version:"Release 10"},"az-cyrl":{language:"Azerbaijani (Cyrillic)",location:null,id:29740,tag:"az-Cyrl",version:"Windows 7"},"az-cyrl-az":{language:"Azerbaijani (Cyrillic)",location:"Azerbaijan",id:2092,tag:"az-Cyrl-AZ",version:"Release C"},az:B,"az-latn":{language:"Azerbaijani (Latin)",location:null,id:30764,tag:"az-Latn",version:"Windows 7"},"az-latn-az":{language:"Azerbaijani (Latin)",location:"Azerbaijan",id:1068,tag:"az-Latn-AZ",version:"Release C"},ksf:O,"ksf-cm":{language:"Bafia",location:"Cameroon",id:4096,tag:"ksf-CM",version:"Release 10"},bm:P,"bm-latn-ml":{language:"Bamanankan (Latin)",location:"Mali",id:4096,tag:"bm-Latn-ML",version:"Release 10"},bn:D,"bn-bd":{language:"Bangla",location:"Bangladesh",id:2117,tag:"bn-BD",version:"Release V"},"bn-in":{language:"Bangla",location:"India",id:1093,tag:"bn-IN",version:"Release E1"},bas:N,"bas-cm":{language:"Basaa",location:"Cameroon",id:4096,tag:"bas-CM",version:"Release 10"},ba:z,"ba-ru":{language:"Bashkir",location:"Russia",id:1133,tag:"ba-RU",version:"Release V"},eu:F,"eu-es":{language:"Basque",location:"Spain",id:1069,tag:"eu-ES",version:"Release B"},be:L,"be-by":{language:"Belarusian",location:"Belarus",id:1059,tag:"be-BY",version:"Release B"},bem:j,"bem-zm":{language:"Bemba",location:"Zambia",id:4096,tag:"bem-ZM",version:"Release 10"},bez:I,"bez-tz":{language:"Bena",location:"Tanzania",id:4096,tag:"bez-TZ",version:"Release 10"},byn:H,"byn-er":{language:"Blin",location:"Eritrea",id:4096,tag:"byn-ER",version:"Release 10"},brx:V,"brx-in":{language:"Bodo",location:"India",id:4096,tag:"brx-IN",version:"Release 10"},"bs-cyrl":{language:"Bosnian (Cyrillic)",location:null,id:25626,tag:"bs-Cyrl",version:"Windows 7"},"bs-cyrl-ba":{language:"Bosnian (Cyrillic)",location:"Bosnia and Herzegovina",id:8218,tag:"bs-Cyrl-BA",version:"Release E1"},"bs-latn":{language:"Bosnian (Latin)",location:null,id:26650,tag:"bs-Latn",version:"Windows 7"},bs:U,"bs-latn-ba":{language:"Bosnian (Latin)",location:"Bosnia and Herzegovina",id:5146,tag:"bs-Latn-BA",version:"Release E1"},br:G,"br-fr":{language:"Breton",location:"France",id:1150,tag:"br-FR",version:"Release V"},bg:W,"bg-bg":{language:"Bulgarian",location:"Bulgaria",id:1026,tag:"bg-BG",version:"Release B"},my:K,"my-mm":{language:"Burmese",location:"Myanmar",id:1109,tag:"my-MM",version:"Release 8.1"},ca:q,"ca-ad":{language:"Catalan",location:"Andorra",id:4096,tag:"ca-AD",version:"Release 10"},"ca-fr":{language:"Catalan",location:"France",id:4096,tag:"ca-FR",version:"Release 10"},"ca-it":{language:"Catalan",location:"Italy",id:4096,tag:"ca-IT",version:"Release 10"},"ca-es":{language:"Catalan",location:"Spain",id:1027,tag:"ca-ES",version:"Release B"},"tzm-latn-":{language:"Central Atlas Tamazight ",location:"Morocco",id:4096,tag:"tzm-Latn-",version:"Release 10"},ku:Y,"ku-arab":{language:"Central Kurdish",location:null,id:31890,tag:"ku-Arab",version:"Release 8"},"ku-arab-iq":{language:"Central Kurdish",location:"Iraq",id:1170,tag:"ku-Arab-IQ",version:"Release 8"},"cd-ru":{language:"Chechen",location:"Russia",id:4096,tag:"cd-RU",version:"Release 10.1"},chr:X,"chr-cher":{language:"Cherokee",location:null,id:31836,tag:"chr-Cher",version:"Release 8"},"chr-cher-us":{language:"Cherokee",location:"United States",id:1116,tag:"chr-Cher-US",version:"Release 8"},cgg:Z,"cgg-ug":{language:"Chiga",location:"Uganda",id:4096,tag:"cgg-UG",version:"Release 10"},"zh-hans":{language:"Chinese (Simplified)",location:null,id:4,tag:"zh-Hans",version:"Release A"},zh:J,"zh-cn":{language:"Chinese (Simplified)",location:"People's Republic of China",id:2052,tag:"zh-CN",version:"Release A"},"zh-sg":{language:"Chinese (Simplified)",location:"Singapore",id:4100,tag:"zh-SG",version:"Release A"},"zh-hant":{language:"Chinese (Traditional)",location:null,id:31748,tag:"zh-Hant",version:"Release A"},"zh-hk":{language:"Chinese (Traditional)",location:"Hong Kong S.A.R.",id:3076,tag:"zh-HK",version:"Release A"},"zh-mo":{language:"Chinese (Traditional)",location:"Macao S.A.R.",id:5124,tag:"zh-MO",version:"Release D"},"zh-tw":{language:"Chinese (Traditional)",location:"Taiwan",id:1028,tag:"zh-TW",version:"Release A"},"cu-ru":{language:"Church Slavic",location:"Russia",id:4096,tag:"cu-RU",version:"Release 10.1"},swc:Q,"swc-cd":{language:"Congo Swahili",location:"Congo DRC",id:4096,tag:"swc-CD",version:"Release 10"},kw:tt,"kw-gb":{language:"Cornish",location:"United Kingdom",id:4096,tag:"kw-GB",version:"Release 10"},co:et,"co-fr":{language:"Corsican",location:"France",id:1155,tag:"co-FR",version:"Release V"},"hr,":{language:"Croatian",location:null,id:26,tag:"hr,",version:"Release 7"},"hr-hr":{language:"Croatian",location:"Croatia",id:1050,tag:"hr-HR",version:"Release A"},"hr-ba":{language:"Croatian (Latin)",location:"Bosnia and Herzegovina",id:4122,tag:"hr-BA",version:"Release E1"},cs:nt,"cs-cz":{language:"Czech",location:"Czech Republic",id:1029,tag:"cs-CZ",version:"Release A"},da:it,"da-dk":{language:"Danish",location:"Denmark",id:1030,tag:"da-DK",version:"Release A"},"da-gl":{language:"Danish",location:"Greenland",id:4096,tag:"da-GL",version:"Release 10"},prs:at,"prs-af":{language:"Dari",location:"Afghanistan",id:1164,tag:"prs-AF",version:"Release V"},dv:rt,"dv-mv":{language:"Divehi",location:"Maldives",id:1125,tag:"dv-MV",version:"ReleaseD"},dua:ot,"dua-cm":{language:"Duala",location:"Cameroon",id:4096,tag:"dua-CM",version:"Release 10"},nl:st,"nl-aw":{language:"Dutch",location:"Aruba",id:4096,tag:"nl-AW",version:"Release 10"},"nl-be":{language:"Dutch",location:"Belgium",id:2067,tag:"nl-BE",version:"Release A"},"nl-bq":{language:"Dutch",location:"Bonaire, Sint Eustatius and Saba",id:4096,tag:"nl-BQ",version:"Release 10"},"nl-cw":{language:"Dutch",location:"Curaao",id:4096,tag:"nl-CW",version:"Release 10"},"nl-nl":{language:"Dutch",location:"Netherlands",id:1043,tag:"nl-NL",version:"Release A"},"nl-sx":{language:"Dutch",location:"Sint Maarten",id:4096,tag:"nl-SX",version:"Release 10"},"nl-sr":{language:"Dutch",location:"Suriname",id:4096,tag:"nl-SR",version:"Release 10"},dz:lt,"dz-bt":{language:"Dzongkha",location:"Bhutan",id:3153,tag:"dz-BT",version:"Release 10"},ebu:ut,"ebu-ke":{language:"Embu",location:"Kenya",id:4096,tag:"ebu-KE",version:"Release 10"},en:ht,"en-as":{language:"English",location:"American Samoa",id:4096,tag:"en-AS",version:"Release 10"},"en-ai":{language:"English",location:"Anguilla",id:4096,tag:"en-AI",version:"Release 10"},"en-ag":{language:"English",location:"Antigua and Barbuda",id:4096,tag:"en-AG",version:"Release 10"},"en-au":{language:"English",location:"Australia",id:3081,tag:"en-AU",version:"Release A"},"en-at":{language:"English",location:"Austria",id:4096,tag:"en-AT",version:"Release 10.1"},"en-bs":{language:"English",location:"Bahamas",id:4096,tag:"en-BS",version:"Release 10"},"en-bb":{language:"English",location:"Barbados",id:4096,tag:"en-BB",version:"Release 10"},"en-be":{language:"English",location:"Belgium",id:4096,tag:"en-BE",version:"Release 10"},"en-bz":{language:"English",location:"Belize",id:10249,tag:"en-BZ",version:"Release B"},"en-bm":{language:"English",location:"Bermuda",id:4096,tag:"en-BM",version:"Release 10"},"en-bw":{language:"English",location:"Botswana",id:4096,tag:"en-BW",version:"Release 10"},"en-io":{language:"English",location:"British Indian Ocean Territory",id:4096,tag:"en-IO",version:"Release 10"},"en-vg":{language:"English",location:"British Virgin Islands",id:4096,tag:"en-VG",version:"Release 10"},"en-bi":{language:"English",location:"Burundi",id:4096,tag:"en-BI",version:"Release 10.1"},"en-cm":{language:"English",location:"Cameroon",id:4096,tag:"en-CM",version:"Release 10"},"en-ca":{language:"English",location:"Canada",id:4105,tag:"en-CA",version:"Release A"},"en-029":{language:"English",location:"Caribbean",id:9225,tag:"en-029",version:"Release B"},"en-ky":{language:"English",location:"Cayman Islands",id:4096,tag:"en-KY",version:"Release 10"},"en-cx":{language:"English",location:"Christmas Island",id:4096,tag:"en-CX",version:"Release 10"},"en-cc":{language:"English",location:"Cocos [Keeling] Islands",id:4096,tag:"en-CC",version:"Release 10"},"en-ck":{language:"English",location:"Cook Islands",id:4096,tag:"en-CK",version:"Release 10"},"en-cy":{language:"English",location:"Cyprus",id:4096,tag:"en-CY",version:"Release 10.1"},"en-dk":{language:"English",location:"Denmark",id:4096,tag:"en-DK",version:"Release 10.1"},"en-dm":{language:"English",location:"Dominica",id:4096,tag:"en-DM",version:"Release 10"},"en-er":{language:"English",location:"Eritrea",id:4096,tag:"en-ER",version:"Release 10"},"en-150":{language:"English",location:"Europe",id:4096,tag:"en-150",version:"Release 10"},"en-fk":{language:"English",location:"Falkland Islands",id:4096,tag:"en-FK",version:"Release 10"},"en-fi":{language:"English",location:"Finland",id:4096,tag:"en-FI",version:"Release 10.1"},"en-fj":{language:"English",location:"Fiji",id:4096,tag:"en-FJ",version:"Release 10"},"en-gm":{language:"English",location:"Gambia",id:4096,tag:"en-GM",version:"Release 10"},"en-de":{language:"English",location:"Germany",id:4096,tag:"en-DE",version:"Release 10.1"},"en-gh":{language:"English",location:"Ghana",id:4096,tag:"en-GH",version:"Release 10"},"en-gi":{language:"English",location:"Gibraltar",id:4096,tag:"en-GI",version:"Release 10"},"en-gd":{language:"English",location:"Grenada",id:4096,tag:"en-GD",version:"Release 10"},"en-gu":{language:"English",location:"Guam",id:4096,tag:"en-GU",version:"Release 10"},"en-gg":{language:"English",location:"Guernsey",id:4096,tag:"en-GG",version:"Release 10"},"en-gy":{language:"English",location:"Guyana",id:4096,tag:"en-GY",version:"Release 10"},"en-hk":{language:"English",location:"Hong Kong",id:15369,tag:"en-HK",version:"Release 8.1"},"en-in":{language:"English",location:"India",id:16393,tag:"en-IN",version:"Release V"},"en-ie":{language:"English",location:"Ireland",id:6153,tag:"en-IE",version:"Release A"},"en-im":{language:"English",location:"Isle of Man",id:4096,tag:"en-IM",version:"Release 10"},"en-il":{language:"English",location:"Israel",id:4096,tag:"en-IL",version:"Release 10.1"},"en-jm":{language:"English",location:"Jamaica",id:8201,tag:"en-JM",version:"Release B"},"en-je":{language:"English",location:"Jersey",id:4096,tag:"en-JE",version:"Release 10"},"en-ke":{language:"English",location:"Kenya",id:4096,tag:"en-KE",version:"Release 10"},"en-ki":{language:"English",location:"Kiribati",id:4096,tag:"en-KI",version:"Release 10"},"en-ls":{language:"English",location:"Lesotho",id:4096,tag:"en-LS",version:"Release 10"},"en-lr":{language:"English",location:"Liberia",id:4096,tag:"en-LR",version:"Release 10"},"en-mo":{language:"English",location:"Macao SAR",id:4096,tag:"en-MO",version:"Release 10"},"en-mg":{language:"English",location:"Madagascar",id:4096,tag:"en-MG",version:"Release 10"},"en-mw":{language:"English",location:"Malawi",id:4096,tag:"en-MW",version:"Release 10"},"en-my":{language:"English",location:"Malaysia",id:17417,tag:"en-MY",version:"Release V"},"en-mt":{language:"English",location:"Malta",id:4096,tag:"en-MT",version:"Release 10"},"en-mh":{language:"English",location:"Marshall Islands",id:4096,tag:"en-MH",version:"Release 10"},"en-mu":{language:"English",location:"Mauritius",id:4096,tag:"en-MU",version:"Release 10"},"en-fm":{language:"English",location:"Micronesia",id:4096,tag:"en-FM",version:"Release 10"},"en-ms":{language:"English",location:"Montserrat",id:4096,tag:"en-MS",version:"Release 10"},"en-na":{language:"English",location:"Namibia",id:4096,tag:"en-NA",version:"Release 10"},"en-nr":{language:"English",location:"Nauru",id:4096,tag:"en-NR",version:"Release 10"},"en-nl":{language:"English",location:"Netherlands",id:4096,tag:"en-NL",version:"Release 10.1"},"en-nz":{language:"English",location:"New Zealand",id:5129,tag:"en-NZ",version:"Release A"},"en-ng":{language:"English",location:"Nigeria",id:4096,tag:"en-NG",version:"Release 10"},"en-nu":{language:"English",location:"Niue",id:4096,tag:"en-NU",version:"Release 10"},"en-nf":{language:"English",location:"Norfolk Island",id:4096,tag:"en-NF",version:"Release 10"},"en-mp":{language:"English",location:"Northern Mariana Islands",id:4096,tag:"en-MP",version:"Release 10"},"en-pk":{language:"English",location:"Pakistan",id:4096,tag:"en-PK",version:"Release 10"},"en-pw":{language:"English",location:"Palau",id:4096,tag:"en-PW",version:"Release 10"},"en-pg":{language:"English",location:"Papua New Guinea",id:4096,tag:"en-PG",version:"Release 10"},"en-pn":{language:"English",location:"Pitcairn Islands",id:4096,tag:"en-PN",version:"Release 10"},"en-pr":{language:"English",location:"Puerto Rico",id:4096,tag:"en-PR",version:"Release 10"},"en-ph":{language:"English",location:"Republic of the Philippines",id:13321,tag:"en-PH",version:"Release C"},"en-rw":{language:"English",location:"Rwanda",id:4096,tag:"en-RW",version:"Release 10"},"en-kn":{language:"English",location:"Saint Kitts and Nevis",id:4096,tag:"en-KN",version:"Release 10"},"en-lc":{language:"English",location:"Saint Lucia",id:4096,tag:"en-LC",version:"Release 10"},"en-vc":{language:"English",location:"Saint Vincent and the Grenadines",id:4096,tag:"en-VC",version:"Release 10"},"en-ws":{language:"English",location:"Samoa",id:4096,tag:"en-WS",version:"Release 10"},"en-sc":{language:"English",location:"Seychelles",id:4096,tag:"en-SC",version:"Release 10"},"en-sl":{language:"English",location:"Sierra Leone",id:4096,tag:"en-SL",version:"Release 10"},"en-sg":{language:"English",location:"Singapore",id:18441,tag:"en-SG",version:"Release V"},"en-sx":{language:"English",location:"Sint Maarten",id:4096,tag:"en-SX",version:"Release 10"},"en-si":{language:"English",location:"Slovenia",id:4096,tag:"en-SI",version:"Release 10.1"},"en-sb":{language:"English",location:"Solomon Islands",id:4096,tag:"en-SB",version:"Release 10"},"en-za":{language:"English",location:"South Africa",id:7177,tag:"en-ZA",version:"Release B"},"en-ss":{language:"English",location:"South Sudan",id:4096,tag:"en-SS",version:"Release 10"},"en-sh":{language:"English",location:"St Helena, Ascension, Tristan da ",id:4096,tag:"en-SH",version:"Release 10"},"en-sd":{language:"English",location:"Sudan",id:4096,tag:"en-SD",version:"Release 10"},"en-sz":{language:"English",location:"Swaziland",id:4096,tag:"en-SZ",version:"Release 10"},"en-se":{language:"English",location:"Sweden",id:4096,tag:"en-SE",version:"Release 10.1"},"en-ch":{language:"English",location:"Switzerland",id:4096,tag:"en-CH",version:"Release 10.1"},"en-tz":{language:"English",location:"Tanzania",id:4096,tag:"en-TZ",version:"Release 10"},"en-tk":{language:"English",location:"Tokelau",id:4096,tag:"en-TK",version:"Release 10"},"en-to":{language:"English",location:"Tonga",id:4096,tag:"en-TO",version:"Release 10"},"en-tt":{language:"English",location:"Trinidad and Tobago",id:11273,tag:"en-TT",version:"Release B"},"en-tc":{language:"English",location:"Turks and Caicos Islands",id:4096,tag:"en-TC",version:"Release 10"},"en-tv":{language:"English",location:"Tuvalu",id:4096,tag:"en-TV",version:"Release 10"},"en-ug":{language:"English",location:"Uganda",id:4096,tag:"en-UG",version:"Release 10"},"en-gb":{language:"English",location:"United Kingdom",id:2057,tag:"en-GB",version:"Release A"},"en-us":{language:"English",location:"United States",id:1033,tag:"en-US",version:"Release A"},"en-um":{language:"English",location:"US Minor Outlying Islands",id:4096,tag:"en-UM",version:"Release 10"},"en-vi":{language:"English",location:"US Virgin Islands",id:4096,tag:"en-VI",version:"Release 10"},"en-vu":{language:"English",location:"Vanuatu",id:4096,tag:"en-VU",version:"Release 10"},"en-001":{language:"English",location:"World",id:4096,tag:"en-001",version:"Release 10"},"en-zm":{language:"English",location:"Zambia",id:4096,tag:"en-ZM",version:"Release 10"},"en-zw":{language:"English",location:"Zimbabwe",id:12297,tag:"en-ZW",version:"Release C"},eo:ct,"eo-001":{language:"Esperanto",location:"World",id:4096,tag:"eo-001",version:"Release 10"},et:ft,"et-ee":{language:"Estonian",location:"Estonia",id:1061,tag:"et-EE",version:"Release B"},ee:dt,"ee-gh":{language:"Ewe",location:"Ghana",id:4096,tag:"ee-GH",version:"Release 10"},"ee-tg":{language:"Ewe",location:"Togo",id:4096,tag:"ee-TG",version:"Release 10"},ewo:pt,"ewo-cm":{language:"Ewondo",location:"Cameroon",id:4096,tag:"ewo-CM",version:"Release 10"},fo:vt,"fo-dk":{language:"Faroese",location:"Denmark",id:4096,tag:"fo-DK",version:"Release 10.1"},"fo-fo":{language:"Faroese",location:"Faroe Islands",id:1080,tag:"fo-FO",version:"Release B"},fil:mt,"fil-ph":{language:"Filipino",location:"Philippines",id:1124,tag:"fil-PH",version:"Release E2"},fi:_t,"fi-fi":{language:"Finnish",location:"Finland",id:1035,tag:"fi-FI",version:"Release A"},fr:yt,"fr-dz":{language:"French",location:"Algeria",id:4096,tag:"fr-DZ",version:"Release 10"},"fr-be":{language:"French",location:"Belgium",id:2060,tag:"fr-BE",version:"Release A"},"fr-bj":{language:"French",location:"Benin",id:4096,tag:"fr-BJ",version:"Release 10"},"fr-bf":{language:"French",location:"Burkina Faso",id:4096,tag:"fr-BF",version:"Release 10"},"fr-bi":{language:"French",location:"Burundi",id:4096,tag:"fr-BI",version:"Release 10"},"fr-cm":{language:"French",location:"Cameroon",id:11276,tag:"fr-CM",version:"Release 8.1"},"fr-ca":{language:"French",location:"Canada",id:3084,tag:"fr-CA",version:"Release A"},"fr-cf":{language:"French",location:"Central African Republic",id:4096,tag:"fr-CF",version:"Release 10"},"fr-td":{language:"French",location:"Chad",id:4096,tag:"fr-TD",version:"Release 10"},"fr-km":{language:"French",location:"Comoros",id:4096,tag:"fr-KM",version:"Release 10"},"fr-cg":{language:"French",location:"Congo",id:4096,tag:"fr-CG",version:"Release 10"},"fr-cd":{language:"French",location:"Congo, DRC",id:9228,tag:"fr-CD",version:"Release 8.1"},"fr-ci":{language:"French",location:"Cte d'Ivoire",id:12300,tag:"fr-CI",version:"Release 8.1"},"fr-dj":{language:"French",location:"Djibouti",id:4096,tag:"fr-DJ",version:"Release 10"},"fr-gq":{language:"French",location:"Equatorial Guinea",id:4096,tag:"fr-GQ",version:"Release 10"},"fr-fr":{language:"French",location:"France",id:1036,tag:"fr-FR",version:"Release A"},"fr-gf":{language:"French",location:"French Guiana",id:4096,tag:"fr-GF",version:"Release 10"},"fr-pf":{language:"French",location:"French Polynesia",id:4096,tag:"fr-PF",version:"Release 10"},"fr-ga":{language:"French",location:"Gabon",id:4096,tag:"fr-GA",version:"Release 10"},"fr-gp":{language:"French",location:"Guadeloupe",id:4096,tag:"fr-GP",version:"Release 10"},"fr-gn":{language:"French",location:"Guinea",id:4096,tag:"fr-GN",version:"Release 10"},"fr-ht":{language:"French",location:"Haiti",id:15372,tag:"fr-HT",version:"Release 8.1"},"fr-lu":{language:"French",location:"Luxembourg",id:5132,tag:"fr-LU",version:"Release A"},"fr-mg":{language:"French",location:"Madagascar",id:4096,tag:"fr-MG",version:"Release 10"},"fr-ml":{language:"French",location:"Mali",id:13324,tag:"fr-ML",version:"Release 8.1"},"fr-mq":{language:"French",location:"Martinique",id:4096,tag:"fr-MQ",version:"Release 10"},"fr-mr":{language:"French",location:"Mauritania",id:4096,tag:"fr-MR",version:"Release 10"},"fr-mu":{language:"French",location:"Mauritius",id:4096,tag:"fr-MU",version:"Release 10"},"fr-yt":{language:"French",location:"Mayotte",id:4096,tag:"fr-YT",version:"Release 10"},"fr-ma":{language:"French",location:"Morocco",id:14348,tag:"fr-MA",version:"Release 8.1"},"fr-nc":{language:"French",location:"New Caledonia",id:4096,tag:"fr-NC",version:"Release 10"},"fr-ne":{language:"French",location:"Niger",id:4096,tag:"fr-NE",version:"Release 10"},"fr-mc":{language:"French",location:"Principality of Monaco",id:6156,tag:"fr-MC",version:"Release A"},"fr-re":{language:"French",location:"Reunion",id:8204,tag:"fr-RE",version:"Release 8.1"},"fr-rw":{language:"French",location:"Rwanda",id:4096,tag:"fr-RW",version:"Release 10"},"fr-bl":{language:"French",location:"Saint Barthlemy",id:4096,tag:"fr-BL",version:"Release 10"},"fr-mf":{language:"French",location:"Saint Martin",id:4096,tag:"fr-MF",version:"Release 10"},"fr-pm":{language:"French",location:"Saint Pierre and Miquelon",id:4096,tag:"fr-PM",version:"Release 10"},"fr-sn":{language:"French",location:"Senegal",id:10252,tag:"fr-SN",version:"Release 8.1"},"fr-sc":{language:"French",location:"Seychelles",id:4096,tag:"fr-SC",version:"Release 10"},"fr-ch":{language:"French",location:"Switzerland",id:4108,tag:"fr-CH",version:"Release A"},"fr-sy":{language:"French",location:"Syria",id:4096,tag:"fr-SY",version:"Release 10"},"fr-tg":{language:"French",location:"Togo",id:4096,tag:"fr-TG",version:"Release 10"},"fr-tn":{language:"French",location:"Tunisia",id:4096,tag:"fr-TN",version:"Release 10"},"fr-vu":{language:"French",location:"Vanuatu",id:4096,tag:"fr-VU",version:"Release 10"},"fr-wf":{language:"French",location:"Wallis and Futuna",id:4096,tag:"fr-WF",version:"Release 10"},fy:bt,"fy-nl":{language:"Frisian",location:"Netherlands",id:1122,tag:"fy-NL",version:"Release E2"},fur:wt,"fur-it":{language:"Friulian",location:"Italy",id:4096,tag:"fur-IT",version:"Release 10"},ff:xt,"ff-latn":{language:"Fulah (Latin)",location:null,id:31847,tag:"ff-Latn",version:"Release 8"},"ff-latn-bf":{language:"Fulah (Latin)",location:"Burkina Faso",id:4096,tag:"ff-Latn-BF",version:"Release 10.4"},"ff-cm":{language:"Fulah",location:"Cameroon",id:4096,tag:"ff-CM",version:"Release 10"},"ff-latn-cm":{language:"Fulah (Latin)",location:"Cameroon",id:4096,tag:"ff-Latn-CM",version:"Release 10.4"},"ff-latn-gm":{language:"Fulah (Latin)",location:"Gambia",id:4096,tag:"ff-Latn-GM",version:"Release 10.4"},"ff-latn-gh":{language:"Fulah (Latin)",location:"Ghana",id:4096,tag:"ff-Latn-GH",version:"Release 10.4"},"ff-gn":{language:"Fulah",location:"Guinea",id:4096,tag:"ff-GN",version:"Release 10"},"ff-latn-gn":{language:"Fulah (Latin)",location:"Guinea",id:4096,tag:"ff-Latn-GN",version:"Release 10.4"},"ff-latn-gw":{language:"Fulah (Latin)",location:"Guinea-Bissau",id:4096,tag:"ff-Latn-GW",version:"Release 10.4"},"ff-latn-lr":{language:"Fulah (Latin)",location:"Liberia",id:4096,tag:"ff-Latn-LR",version:"Release 10.4"},"ff-mr":{language:"Fulah",location:"Mauritania",id:4096,tag:"ff-MR",version:"Release 10"},"ff-latn-mr":{language:"Fulah (Latin)",location:"Mauritania",id:4096,tag:"ff-Latn-MR",version:"Release 10.4"},"ff-latn-ne":{language:"Fulah (Latin)",location:"Niger",id:4096,tag:"ff-Latn-NE",version:"Release 10.4"},"ff-ng":{language:"Fulah",location:"Nigeria",id:4096,tag:"ff-NG",version:"Release 10"},"ff-latn-ng":{language:"Fulah (Latin)",location:"Nigeria",id:4096,tag:"ff-Latn-NG",version:"Release 10.4"},"ff-latn-sn":{language:"Fulah",location:"Senegal",id:2151,tag:"ff-Latn-SN",version:"Release 8"},"ff-latn-sl":{language:"Fulah (Latin)",location:"Sierra Leone",id:4096,tag:"ff-Latn-SL",version:"Release 10.4"},gl:kt,"gl-es":{language:"Galician",location:"Spain",id:1110,tag:"gl-ES",version:"Release D"},lg:St,"lg-ug":{language:"Ganda",location:"Uganda",id:4096,tag:"lg-UG",version:"Release 10"},ka:Ct,"ka-ge":{language:"Georgian",location:"Georgia",id:1079,tag:"ka-GE",version:"Release C"},de:At,"de-at":{language:"German",location:"Austria",id:3079,tag:"de-AT",version:"Release A"},"de-be":{language:"German",location:"Belgium",id:4096,tag:"de-BE",version:"Release 10"},"de-de":{language:"German",location:"Germany",id:1031,tag:"de-DE",version:"Release A"},"de-it":{language:"German",location:"Italy",id:4096,tag:"de-IT",version:"Release 10.2"},"de-li":{language:"German",location:"Liechtenstein",id:5127,tag:"de-LI",version:"Release B"},"de-lu":{language:"German",location:"Luxembourg",id:4103,tag:"de-LU",version:"Release B"},"de-ch":{language:"German",location:"Switzerland",id:2055,tag:"de-CH",version:"Release A"},el:Et,"el-cy":{language:"Greek",location:"Cyprus",id:4096,tag:"el-CY",version:"Release 10"},"el-gr":{language:"Greek",location:"Greece",id:1032,tag:"el-GR",version:"Release A"},kl:Mt,"kl-gl":{language:"Greenlandic",location:"Greenland",id:1135,tag:"kl-GL",version:"Release V"},gn:Rt,"gn-py":{language:"Guarani",location:"Paraguay",id:1140,tag:"gn-PY",version:"Release 8.1"},gu:Tt,"gu-in":{language:"Gujarati",location:"India",id:1095,tag:"gu-IN",version:"Release D"},guz:Bt,"guz-ke":{language:"Gusii",location:"Kenya",id:4096,tag:"guz-KE",version:"Release 10"},ha:Ot,"ha-latn":{language:"Hausa (Latin)",location:null,id:31848,tag:"ha-Latn",version:"Windows 7"},"ha-latn-gh":{language:"Hausa (Latin)",location:"Ghana",id:4096,tag:"ha-Latn-GH",version:"Release 10"},"ha-latn-ne":{language:"Hausa (Latin)",location:"Niger",id:4096,tag:"ha-Latn-NE",version:"Release 10"},"ha-latn-ng":{language:"Hausa (Latin)",location:"Nigeria",id:1128,tag:"ha-Latn-NG",version:"Release V"},haw:Pt,"haw-us":{language:"Hawaiian",location:"United States",id:1141,tag:"haw-US",version:"Release 8"},he:Dt,"he-il":{language:"Hebrew",location:"Israel",id:1037,tag:"he-IL",version:"Release B"},hi:Nt,"hi-in":{language:"Hindi",location:"India",id:1081,tag:"hi-IN",version:"Release C"},hu:zt,"hu-hu":{language:"Hungarian",location:"Hungary",id:1038,tag:"hu-HU",version:"Release A"},is:Ft,"is-is":{language:"Icelandic",location:"Iceland",id:1039,tag:"is-IS",version:"Release A"},ig:Lt,"ig-ng":{language:"Igbo",location:"Nigeria",id:1136,tag:"ig-NG",version:"Release V"},id:jt,"id-id":{language:"Indonesian",location:"Indonesia",id:1057,tag:"id-ID",version:"Release B"},ia:It,"ia-fr":{language:"Interlingua",location:"France",id:4096,tag:"ia-FR",version:"Release 10"},"ia-001":{language:"Interlingua",location:"World",id:4096,tag:"ia-001",version:"Release 10"},iu:Ht,"iu-latn":{language:"Inuktitut (Latin)",location:null,id:31837,tag:"iu-Latn",version:"Windows 7"},"iu-latn-ca":{language:"Inuktitut (Latin)",location:"Canada",id:2141,tag:"iu-Latn-CA",version:"Release E2"},"iu-cans":{language:"Inuktitut (Syllabics)",location:null,id:30813,tag:"iu-Cans",version:"Windows 7"},"iu-cans-ca":{language:"Inuktitut (Syllabics)",location:"Canada",id:1117,tag:"iu-Cans-CA",version:"Release V"},ga:Vt,"ga-ie":{language:"Irish",location:"Ireland",id:2108,tag:"ga-IE",version:"Release E2"},it:Ut,"it-it":{language:"Italian",location:"Italy",id:1040,tag:"it-IT",version:"Release A"},"it-sm":{language:"Italian",location:"San Marino",id:4096,tag:"it-SM",version:"Release 10"},"it-ch":{language:"Italian",location:"Switzerland",id:2064,tag:"it-CH",version:"Release A"},"it-va":{language:"Italian",location:"Vatican City",id:4096,tag:"it-VA",version:"Release 10.3"},ja:Gt,"ja-jp":{language:"Japanese",location:"Japan",id:1041,tag:"ja-JP",version:"Release A"},jv:Wt,"jv-latn":{language:"Javanese",location:"Latin",id:4096,tag:"jv-Latn",version:"Release 8.1"},"jv-latn-id":{language:"Javanese",location:"Latin, Indonesia",id:4096,tag:"jv-Latn-ID",version:"Release 8.1"},dyo:Kt,"dyo-sn":{language:"Jola-Fonyi",location:"Senegal",id:4096,tag:"dyo-SN",version:"Release 10"},kea:qt,"kea-cv":{language:"Kabuverdianu",location:"Cabo Verde",id:4096,tag:"kea-CV",version:"Release 10"},kab:Yt,"kab-dz":{language:"Kabyle",location:"Algeria",id:4096,tag:"kab-DZ",version:"Release 10"},kkj:Xt,"kkj-cm":{language:"Kako",location:"Cameroon",id:4096,tag:"kkj-CM",version:"Release 10"},kln:Zt,"kln-ke":{language:"Kalenjin",location:"Kenya",id:4096,tag:"kln-KE",version:"Release 10"},kam:Jt,"kam-ke":{language:"Kamba",location:"Kenya",id:4096,tag:"kam-KE",version:"Release 10"},kn:$t,"kn-in":{language:"Kannada",location:"India",id:1099,tag:"kn-IN",version:"Release D"},ks:Qt,"ks-arab":{language:"Kashmiri",location:"Perso-Arabic",id:1120,tag:"ks-Arab",version:"Release 10"},"ks-arab-in":{language:"Kashmiri",location:"Perso-Arabic",id:4096,tag:"ks-Arab-IN",version:"Release 10"},kk:te,"kk-kz":{language:"Kazakh",location:"Kazakhstan",id:1087,tag:"kk-KZ",version:"Release C"},km:ee,"km-kh":{language:"Khmer",location:"Cambodia",id:1107,tag:"km-KH",version:"Release V"},quc:ne,"quc-latn-gt":{language:"K'iche",location:"Guatemala",id:1158,tag:"quc-Latn-GT",version:"Release 10"},ki:le,"ki-ke":{language:"Kikuyu",location:"Kenya",id:4096,tag:"ki-KE",version:"Release 10"},rw:ue,"rw-rw":{language:"Kinyarwanda",location:"Rwanda",id:1159,tag:"rw-RW",version:"Release V"},sw:he,"sw-ke":{language:"Kiswahili",location:"Kenya",id:1089,tag:"sw-KE",version:"Release C"},"sw-tz":{language:"Kiswahili",location:"Tanzania",id:4096,tag:"sw-TZ",version:"Release 10"},"sw-ug":{language:"Kiswahili",location:"Uganda",id:4096,tag:"sw-UG",version:"Release 10"},kok:ce,"kok-in":{language:"Konkani",location:"India",id:1111,tag:"kok-IN",version:"Release C"},ko:fe,"ko-kr":{language:"Korean",location:"Korea",id:1042,tag:"ko-KR",version:"Release A"},"ko-kp":{language:"Korean",location:"North Korea",id:4096,tag:"ko-KP",version:"Release 10.1"},khq:de,"khq-ml":{language:"Koyra Chiini",location:"Mali",id:4096,tag:"khq-ML",version:"Release 10"},ses:ge,"ses-ml":{language:"Koyraboro Senni",location:"Mali",id:4096,tag:"ses-ML",version:"Release 10"},nmg:pe,"nmg-cm":{language:"Kwasio",location:"Cameroon",id:4096,tag:"nmg-CM",version:"Release 10"},ky:ve,"ky-kg":{language:"Kyrgyz",location:"Kyrgyzstan",id:1088,tag:"ky-KG",version:"Release D"},"ku-arab-ir":{language:"Kurdish",location:"Perso-Arabic, Iran",id:4096,tag:"ku-Arab-IR",version:"Release 10.1"},lkt:me,"lkt-us":{language:"Lakota",location:"United States",id:4096,tag:"lkt-US",version:"Release 10"},lag:_e,"lag-tz":{language:"Langi",location:"Tanzania",id:4096,tag:"lag-TZ",version:"Release 10"},lo:ye,"lo-la":{language:"Lao",location:"Lao P.D.R.",id:1108,tag:"lo-LA",version:"Release V"},lv:be,"lv-lv":{language:"Latvian",location:"Latvia",id:1062,tag:"lv-LV",version:"Release B"},ln:we,"ln-ao":{language:"Lingala",location:"Angola",id:4096,tag:"ln-AO",version:"Release 10"},"ln-cf":{language:"Lingala",location:"Central African Republic",id:4096,tag:"ln-CF",version:"Release 10"},"ln-cg":{language:"Lingala",location:"Congo",id:4096,tag:"ln-CG",version:"Release 10"},"ln-cd":{language:"Lingala",location:"Congo DRC",id:4096,tag:"ln-CD",version:"Release 10"},lt:xe,"lt-lt":{language:"Lithuanian",location:"Lithuania",id:1063,tag:"lt-LT",version:"Release B"},nds:ke,"nds-de":{language:"Low German ",location:"Germany",id:4096,tag:"nds-DE",version:"Release 10.2"},"nds-nl":{language:"Low German",location:"Netherlands",id:4096,tag:"nds-NL",version:"Release 10.2"},dsb:Se,"dsb-de":{language:"Lower Sorbian",location:"Germany",id:2094,tag:"dsb-DE",version:"Release V"},lu:Ce,"lu-cd":{language:"Luba-Katanga",location:"Congo DRC",id:4096,tag:"lu-CD",version:"Release 10"},luo:Ae,"luo-ke":{language:"Luo",location:"Kenya",id:4096,tag:"luo-KE",version:"Release 10"},lb:Ee,"lb-lu":{language:"Luxembourgish",location:"Luxembourg",id:1134,tag:"lb-LU",version:"Release E2"},luy:Me,"luy-ke":{language:"Luyia",location:"Kenya",id:4096,tag:"luy-KE",version:"Release 10"},mk:Re,"mk-mk":{language:"Macedonian",location:"North Macedonia ",id:1071,tag:"mk-MK",version:"Release C"},jmc:Te,"jmc-tz":{language:"Machame",location:"Tanzania",id:4096,tag:"jmc-TZ",version:"Release 10"},mgh:Be,"mgh-mz":{language:"Makhuwa-Meetto",location:"Mozambique",id:4096,tag:"mgh-MZ",version:"Release 10"},kde:Oe,"kde-tz":{language:"Makonde",location:"Tanzania",id:4096,tag:"kde-TZ",version:"Release 10"},mg:Pe,"mg-mg":{language:"Malagasy",location:"Madagascar",id:4096,tag:"mg-MG",version:"Release 8.1"},ms:De,"ms-bn":{language:"Malay",location:"Brunei Darussalam",id:2110,tag:"ms-BN",version:"Release C"},"ms-my":{language:"Malay",location:"Malaysia",id:1086,tag:"ms-MY",version:"Release C"},ml:Ne,"ml-in":{language:"Malayalam",location:"India",id:1100,tag:"ml-IN",version:"Release E1"},mt:ze,"mt-mt":{language:"Maltese",location:"Malta",id:1082,tag:"mt-MT",version:"Release E1"},gv:Fe,"gv-im":{language:"Manx",location:"Isle of Man",id:4096,tag:"gv-IM",version:"Release 10"},mi:Le,"mi-nz":{language:"Maori",location:"New Zealand",id:1153,tag:"mi-NZ",version:"Release E1"},arn:je,"arn-cl":{language:"Mapudungun",location:"Chile",id:1146,tag:"arn-CL",version:"Release E2"},mr:Ie,"mr-in":{language:"Marathi",location:"India",id:1102,tag:"mr-IN",version:"Release C"},mas:He,"mas-ke":{language:"Masai",location:"Kenya",id:4096,tag:"mas-KE",version:"Release 10"},"mas-tz":{language:"Masai",location:"Tanzania",id:4096,tag:"mas-TZ",version:"Release 10"},"mzn-ir":{language:"Mazanderani",location:"Iran",id:4096,tag:"mzn-IR",version:"Release 10.1"},mer:Ve,"mer-ke":{language:"Meru",location:"Kenya",id:4096,tag:"mer-KE",version:"Release 10"},mgo:Ue,"mgo-cm":{language:"Meta'",location:"Cameroon",id:4096,tag:"mgo-CM",version:"Release 10"},moh:Ge,"moh-ca":{language:"Mohawk",location:"Canada",id:1148,tag:"moh-CA",version:"Release E2"},mn:We,"mn-cyrl":{language:"Mongolian (Cyrillic)",location:null,id:30800,tag:"mn-Cyrl",version:"Windows 7"},"mn-mn":{language:"Mongolian (Cyrillic)",location:"Mongolia",id:1104,tag:"mn-MN",version:"Release D"},"mn-mong":{language:"Mongolian (Traditional ",location:null,id:31824,tag:"mn-Mong",version:"Windows 7"},"mn-mong-":{language:"Mongolian (Traditional ",location:"Mongolia",id:3152,tag:"mn-Mong-",version:"Windows 7"},mfe:Ke,"mfe-mu":{language:"Morisyen",location:"Mauritius",id:4096,tag:"mfe-MU",version:"Release 10"},mua:qe,"mua-cm":{language:"Mundang",location:"Cameroon",id:4096,tag:"mua-CM",version:"Release 10"},nqo:Ye,"nqo-gn":{language:"N'ko",location:"Guinea",id:4096,tag:"nqo-GN",version:"Release 8.1"},naq:Xe,"naq-na":{language:"Nama",location:"Namibia",id:4096,tag:"naq-NA",version:"Release 10"},ne:Ze,"ne-in":{language:"Nepali",location:"India",id:2145,tag:"ne-IN",version:"Release 8.1"},"ne-np":{language:"Nepali",location:"Nepal",id:1121,tag:"ne-NP",version:"Release E2"},nnh:Je,"nnh-cm":{language:"Ngiemboon",location:"Cameroon",id:4096,tag:"nnh-CM",version:"Release 10"},jgo:$e,"jgo-cm":{language:"Ngomba",location:"Cameroon",id:4096,tag:"jgo-CM",version:"Release 10"},"lrc-iq":{language:"Northern Luri",location:"Iraq",id:4096,tag:"lrc-IQ",version:"Release 10.1"},"lrc-ir":{language:"Northern Luri",location:"Iran",id:4096,tag:"lrc-IR",version:"Release 10.1"},nd:Qe,"nd-zw":{language:"North Ndebele",location:"Zimbabwe",id:4096,tag:"nd-ZW",version:"Release 10"},no:tn,nb:en,"nb-no":{language:"Norwegian (Bokmal)",location:"Norway",id:1044,tag:"nb-NO",version:"Release A"},nn:nn,"nn-no":{language:"Norwegian (Nynorsk)",location:"Norway",id:2068,tag:"nn-NO",version:"Release A"},"nb-sj":{language:"Norwegian Bokml",location:"Svalbard and Jan Mayen",id:4096,tag:"nb-SJ",version:"Release 10"},nus:an,"nus-sd":{language:"Nuer",location:"Sudan",id:4096,tag:"nus-SD",version:"Release 10"},"nus-ss":{language:"Nuer",location:"South Sudan",id:4096,tag:"nus-SS",version:"Release 10.1"},nyn:rn,"nyn-ug":{language:"Nyankole",location:"Uganda",id:4096,tag:"nyn-UG",version:"Release 10"},oc:on,"oc-fr":{language:"Occitan",location:"France",id:1154,tag:"oc-FR",version:"Release V"},or:sn,"or-in":{language:"Odia",location:"India",id:1096,tag:"or-IN",version:"Release V"},om:ln,"om-et":{language:"Oromo",location:"Ethiopia",id:1138,tag:"om-ET",version:"Release 8.1"},"om-ke":{language:"Oromo",location:"Kenya",id:4096,tag:"om-KE",version:"Release 10"},os:un,"os-ge":{language:"Ossetian",location:"Cyrillic, Georgia",id:4096,tag:"os-GE",version:"Release 10"},"os-ru":{language:"Ossetian",location:"Cyrillic, Russia",id:4096,tag:"os-RU",version:"Release 10"},ps:hn,"ps-af":{language:"Pashto",location:"Afghanistan",id:1123,tag:"ps-AF",version:"Release E2"},fa:cn,"fa-af":{language:"Persian",location:"Afghanistan",id:4096,tag:"fa-AF",version:"Release 10"},"fa-ir":{language:"Persian",location:"Iran",id:1065,tag:"fa-IR",version:"Release B"},pl:fn,"pl-pl":{language:"Polish",location:"Poland",id:1045,tag:"pl-PL",version:"Release A"},pt:dn,"pt-ao":{language:"Portuguese",location:"Angola",id:4096,tag:"pt-AO",version:"Release 8.1"},"pt-br":{language:"Portuguese",location:"Brazil",id:1046,tag:"pt-BR",version:"ReleaseA"},"pt-cv":{language:"Portuguese",location:"Cabo Verde",id:4096,tag:"pt-CV",version:"Release 10"},"pt-gq":{language:"Portuguese",location:"Equatorial Guinea",id:4096,tag:"pt-GQ",version:"Release 10.2"},"pt-gw":{language:"Portuguese",location:"Guinea-Bissau",id:4096,tag:"pt-GW",version:"Release 10"},"pt-lu":{language:"Portuguese",location:"Luxembourg",id:4096,tag:"pt-LU",version:"Release 10.2"},"pt-mo":{language:"Portuguese",location:"Macao SAR",id:4096,tag:"pt-MO",version:"Release 10"},"pt-mz":{language:"Portuguese",location:"Mozambique",id:4096,tag:"pt-MZ",version:"Release 10"},"pt-pt":{language:"Portuguese",location:"Portugal",id:2070,tag:"pt-PT",version:"Release A"},"pt-st":{language:"Portuguese",location:"So Tom and Prncipe",id:4096,tag:"pt-ST",version:"Release 10"},"pt-ch":{language:"Portuguese",location:"Switzerland",id:4096,tag:"pt-CH",version:"Release 10.2"},"pt-tl":{language:"Portuguese",location:"Timor-Leste",id:4096,tag:"pt-TL",version:"Release 10"},"prg-001":{language:"Prussian",location:null,id:4096,tag:"prg-001",version:"Release 10.1"},"qps-ploca":{language:"Pseudo Language",location:"Pseudo locale for east Asian/complex ",id:1534,tag:"qps-ploca",version:"Release 7"},"qps-ploc":{language:"Pseudo Language",location:"Pseudo locale used for localization ",id:1281,tag:"qps-ploc",version:"Release 7"},"qps-plocm":{language:"Pseudo Language",location:"Pseudo locale used for localization ",id:2559,tag:"qps-plocm",version:"Release 7"},pa:gn,"pa-arab":{language:"Punjabi",location:null,id:31814,tag:"pa-Arab",version:"Release 8"},"pa-in":{language:"Punjabi",location:"India",id:1094,tag:"pa-IN",version:"Release D"},"pa-arab-pk":{language:"Punjabi",location:"Islamic Republic of Pakistan",id:2118,tag:"pa-Arab-PK",version:"Release 8"},quz:pn,"quz-bo":{language:"Quechua",location:"Bolivia",id:1131,tag:"quz-BO",version:"Release E1"},"quz-ec":{language:"Quechua",location:"Ecuador",id:2155,tag:"quz-EC",version:"Release E1"},"quz-pe":{language:"Quechua",location:"Peru",id:3179,tag:"quz-PE",version:"Release E1"},ksh:vn,"ksh-de":{language:"Ripuarian",location:"Germany",id:4096,tag:"ksh-DE",version:"Release 10"},ro:mn,"ro-md":{language:"Romanian",location:"Moldova",id:2072,tag:"ro-MD",version:"Release 8.1"},"ro-ro":{language:"Romanian",location:"Romania",id:1048,tag:"ro-RO",version:"Release A"},rm:_n,"rm-ch":{language:"Romansh",location:"Switzerland",id:1047,tag:"rm-CH",version:"Release E2"},rof:yn,"rof-tz":{language:"Rombo",location:"Tanzania",id:4096,tag:"rof-TZ",version:"Release 10"},rn:bn,"rn-bi":{language:"Rundi",location:"Burundi",id:4096,tag:"rn-BI",version:"Release 10"},ru:wn,"ru-by":{language:"Russian",location:"Belarus",id:4096,tag:"ru-BY",version:"Release 10"},"ru-kz":{language:"Russian",location:"Kazakhstan",id:4096,tag:"ru-KZ",version:"Release 10"},"ru-kg":{language:"Russian",location:"Kyrgyzstan",id:4096,tag:"ru-KG",version:"Release 10"},"ru-md":{language:"Russian",location:"Moldova",id:2073,tag:"ru-MD",version:"Release 10"},"ru-ru":{language:"Russian",location:"Russia",id:1049,tag:"ru-RU",version:"Release A"},"ru-ua":{language:"Russian",location:"Ukraine",id:4096,tag:"ru-UA",version:"Release 10"},rwk:xn,"rwk-tz":{language:"Rwa",location:"Tanzania",id:4096,tag:"rwk-TZ",version:"Release 10"},ssy:kn,"ssy-er":{language:"Saho",location:"Eritrea",id:4096,tag:"ssy-ER",version:"Release 10"},sah:Sn,"sah-ru":{language:"Sakha",location:"Russia",id:1157,tag:"sah-RU",version:"Release V"},saq:Cn,"saq-ke":{language:"Samburu",location:"Kenya",id:4096,tag:"saq-KE",version:"Release 10"},smn:An,"smn-fi":{language:"Sami (Inari)",location:"Finland",id:9275,tag:"smn-FI",version:"Release E1"},smj:En,"smj-no":{language:"Sami (Lule)",location:"Norway",id:4155,tag:"smj-NO",version:"Release E1"},"smj-se":{language:"Sami (Lule)",location:"Sweden",id:5179,tag:"smj-SE",version:"Release E1"},se:Mn,"se-fi":{language:"Sami (Northern)",location:"Finland",id:3131,tag:"se-FI",version:"Release E1"},"se-no":{language:"Sami (Northern)",location:"Norway",id:1083,tag:"se-NO",version:"Release E1"},"se-se":{language:"Sami (Northern)",location:"Sweden",id:2107,tag:"se-SE",version:"Release E1"},sms:Rn,"sms-fi":{language:"Sami (Skolt)",location:"Finland",id:8251,tag:"sms-FI",version:"Release E1"},sma:Tn,"sma-no":{language:"Sami (Southern)",location:"Norway",id:6203,tag:"sma-NO",version:"Release E1"},"sma-se":{language:"Sami (Southern)",location:"Sweden",id:7227,tag:"sma-SE",version:"Release E1"},sg:Bn,"sg-cf":{language:"Sango",location:"Central African Republic",id:4096,tag:"sg-CF",version:"Release 10"},sbp:On,"sbp-tz":{language:"Sangu",location:"Tanzania",id:4096,tag:"sbp-TZ",version:"Release 10"},sa:Pn,"sa-in":{language:"Sanskrit",location:"India",id:1103,tag:"sa-IN",version:"Release C"},gd:Dn,"gd-gb":{language:"Scottish Gaelic",location:"United Kingdom",id:1169,tag:"gd-GB",version:"Release 7"},seh:Nn,"seh-mz":{language:"Sena",location:"Mozambique",id:4096,tag:"seh-MZ",version:"Release 10"},"sr-cyrl":{language:"Serbian (Cyrillic)",location:null,id:27674,tag:"sr-Cyrl",version:"Windows 7"},"sr-cyrl-ba":{language:"Serbian (Cyrillic)",location:"Bosnia and Herzegovina",id:7194,tag:"sr-Cyrl-BA",version:"Release E1"},"sr-cyrl-me":{language:"Serbian (Cyrillic)",location:"Montenegro",id:12314,tag:"sr-Cyrl-ME",version:"Release 7"},"sr-cyrl-rs":{language:"Serbian (Cyrillic)",location:"Serbia",id:10266,tag:"sr-Cyrl-RS",version:"Release 7"},"sr-cyrl-cs":{language:"Serbian (Cyrillic)",location:"Serbia and Montenegro (Former)",id:3098,tag:"sr-Cyrl-CS",version:"Release B"},"sr-latn":{language:"Serbian (Latin)",location:null,id:28698,tag:"sr-Latn",version:"Windows 7"},sr:zn,"sr-latn-ba":{language:"Serbian (Latin)",location:"Bosnia and Herzegovina",id:6170,tag:"sr-Latn-BA",version:"Release E1"},"sr-latn-me":{language:"Serbian (Latin)",location:"Montenegro",id:11290,tag:"sr-Latn-ME",version:"Release 7"},"sr-latn-rs":{language:"Serbian (Latin)",location:"Serbia",id:9242,tag:"sr-Latn-RS",version:"Release 7"},"sr-latn-cs":{language:"Serbian (Latin)",location:"Serbia and Montenegro (Former)",id:2074,tag:"sr-Latn-CS",version:"Release B"},nso:Fn,"nso-za":{language:"Sesotho sa Leboa",location:"South Africa",id:1132,tag:"nso-ZA",version:"Release E1"},tn:Ln,"tn-bw":{language:"Setswana",location:"Botswana",id:2098,tag:"tn-BW",version:"Release 8"},"tn-za":{language:"Setswana",location:"South Africa",id:1074,tag:"tn-ZA",version:"Release E1"},ksb:jn,"ksb-tz":{language:"Shambala",location:"Tanzania",id:4096,tag:"ksb-TZ",version:"Release 10"},sn:In,"sn-latn":{language:"Shona",location:"Latin",id:4096,tag:"sn-Latn",version:"Release 8.1"},"sn-latn-zw":{language:"Shona",location:"Zimbabwe",id:4096,tag:"sn-Latn-ZW",version:"Release 8.1"},sd:Hn,"sd-arab":{language:"Sindhi",location:null,id:31833,tag:"sd-Arab",version:"Release 8"},"sd-arab-pk":{language:"Sindhi",location:"Islamic Republic of Pakistan",id:2137,tag:"sd-Arab-PK",version:"Release 8"},si:Vn,"si-lk":{language:"Sinhala",location:"Sri Lanka",id:1115,tag:"si-LK",version:"Release V"},sk:Un,"sk-sk":{language:"Slovak",location:"Slovakia",id:1051,tag:"sk-SK",version:"Release A"},sl:Gn,"sl-si":{language:"Slovenian",location:"Slovenia",id:1060,tag:"sl-SI",version:"Release A"},xog:Wn,"xog-ug":{language:"Soga",location:"Uganda",id:4096,tag:"xog-UG",version:"Release 10"},so:Kn,"so-dj":{language:"Somali",location:"Djibouti",id:4096,tag:"so-DJ",version:"Release 10"},"so-et":{language:"Somali",location:"Ethiopia",id:4096,tag:"so-ET",version:"Release 10"},"so-ke":{language:"Somali",location:"Kenya",id:4096,tag:"so-KE",version:"Release 10"},"so-so":{language:"Somali",location:"Somalia",id:1143,tag:"so-SO",version:"Release 8.1"},st:qn,"st-za":{language:"Sotho",location:"South Africa",id:1072,tag:"st-ZA",version:"Release 8.1"},nr:Yn,"nr-za":{language:"South Ndebele",location:"South Africa",id:4096,tag:"nr-ZA",version:"Release 10"},"st-ls":{language:"Southern Sotho",location:"Lesotho",id:4096,tag:"st-LS",version:"Release 10"},es:Xn,"es-ar":{language:"Spanish",location:"Argentina",id:11274,tag:"es-AR",version:"Release B"},"es-bz":{language:"Spanish",location:"Belize",id:4096,tag:"es-BZ",version:"Release 10.3"},"es-ve":{language:"Spanish",location:"Bolivarian Republic of Venezuela",id:8202,tag:"es-VE",version:"Release B"},"es-bo":{language:"Spanish",location:"Bolivia",id:16394,tag:"es-BO",version:"Release B"},"es-br":{language:"Spanish",location:"Brazil",id:4096,tag:"es-BR",version:"Release 10.2"},"es-cl":{language:"Spanish",location:"Chile",id:13322,tag:"es-CL",version:"Release B"},"es-co":{language:"Spanish",location:"Colombia",id:9226,tag:"es-CO",version:"Release B"},"es-cr":{language:"Spanish",location:"Costa Rica",id:5130,tag:"es-CR",version:"Release B"},"es-cu":{language:"Spanish",location:"Cuba",id:23562,tag:"es-CU",version:"Release 10"},"es-do":{language:"Spanish",location:"Dominican Republic",id:7178,tag:"es-DO",version:"Release B"},"es-ec":{language:"Spanish",location:"Ecuador",id:12298,tag:"es-EC",version:"Release B"},"es-sv":{language:"Spanish",location:"El Salvador",id:17418,tag:"es-SV",version:"Release B"},"es-gq":{language:"Spanish",location:"Equatorial Guinea",id:4096,tag:"es-GQ",version:"Release 10"},"es-gt":{language:"Spanish",location:"Guatemala",id:4106,tag:"es-GT",version:"Release B"},"es-hn":{language:"Spanish",location:"Honduras",id:18442,tag:"es-HN",version:"Release B"},"es-419":{language:"Spanish",location:"Latin America",id:22538,tag:"es-419",version:"Release 8.1"},"es-mx":{language:"Spanish",location:"Mexico",id:2058,tag:"es-MX",version:"Release A"},"es-ni":{language:"Spanish",location:"Nicaragua",id:19466,tag:"es-NI",version:"Release B"},"es-pa":{language:"Spanish",location:"Panama",id:6154,tag:"es-PA",version:"Release B"},"es-py":{language:"Spanish",location:"Paraguay",id:15370,tag:"es-PY",version:"Release B"},"es-pe":{language:"Spanish",location:"Peru",id:10250,tag:"es-PE",version:"Release B"},"es-ph":{language:"Spanish",location:"Philippines",id:4096,tag:"es-PH",version:"Release 10"},"es-pr":{language:"Spanish",location:"Puerto Rico",id:20490,tag:"es-PR",version:"Release B"},"es-es_tradnl":{language:"Spanish",location:"Spain",id:1034,tag:"es-ES_tradnl",version:"Release A"},"es-es":{language:"Spanish",location:"Spain",id:3082,tag:"es-ES",version:"Release A"},"es-us":{language:"Spanish",location:"United States",id:21514,tag:"es-US",version:"Release V"},"es-uy":{language:"Spanish",location:"Uruguay",id:14346,tag:"es-UY",version:"Release B"},zgh:Zn,"zgh-tfng-ma":{language:"Standard Moroccan ",location:"Morocco",id:4096,tag:"zgh-Tfng-MA",version:"Release 8.1"},"zgh-tfng":{language:"Standard Moroccan ",location:"Tifinagh",id:4096,tag:"zgh-Tfng",version:"Release 8.1"},ss:Jn,"ss-za":{language:"Swati",location:"South Africa",id:4096,tag:"ss-ZA",version:"Release 10"},"ss-sz":{language:"Swati",location:"Swaziland",id:4096,tag:"ss-SZ",version:"Release 10"},sv:$n,"sv-ax":{language:"Swedish",location:"land Islands",id:4096,tag:"sv-AX",version:"Release 10"},"sv-fi":{language:"Swedish",location:"Finland",id:2077,tag:"sv-FI",version:"ReleaseB"},"sv-se":{language:"Swedish",location:"Sweden",id:1053,tag:"sv-SE",version:"Release A"},syr:Qn,"syr-sy":{language:"Syriac",location:"Syria",id:1114,tag:"syr-SY",version:"Release D"},shi:ti,"shi-tfng":{language:"Tachelhit",location:"Tifinagh",id:4096,tag:"shi-Tfng",version:"Release 10"},"shi-tfng-ma":{language:"Tachelhit",location:"Tifinagh, Morocco",id:4096,tag:"shi-Tfng-MA",version:"Release 10"},"shi-latn":{language:"Tachelhit (Latin)",location:null,id:4096,tag:"shi-Latn",version:"Release 10"},"shi-latn-ma":{language:"Tachelhit (Latin)",location:"Morocco",id:4096,tag:"shi-Latn-MA",version:"Release 10"},dav:ei,"dav-ke":{language:"Taita",location:"Kenya",id:4096,tag:"dav-KE",version:"Release 10"},tg:ni,"tg-cyrl":{language:"Tajik (Cyrillic)",location:null,id:31784,tag:"tg-Cyrl",version:"Windows 7"},"tg-cyrl-tj":{language:"Tajik (Cyrillic)",location:"Tajikistan",id:1064,tag:"tg-Cyrl-TJ",version:"Release V"},tzm:ii,"tzm-latn":{language:"Tamazight (Latin)",location:null,id:31839,tag:"tzm-Latn",version:"Windows 7"},"tzm-latn-dz":{language:"Tamazight (Latin)",location:"Algeria",id:2143,tag:"tzm-Latn-DZ",version:"Release V"},ta:ai,"ta-in":{language:"Tamil",location:"India",id:1097,tag:"ta-IN",version:"Release C"},"ta-my":{language:"Tamil",location:"Malaysia",id:4096,tag:"ta-MY",version:"Release 10"},"ta-sg":{language:"Tamil",location:"Singapore",id:4096,tag:"ta-SG",version:"Release 10"},"ta-lk":{language:"Tamil",location:"Sri Lanka",id:2121,tag:"ta-LK",version:"Release 8"},twq:ri,"twq-ne":{language:"Tasawaq",location:"Niger",id:4096,tag:"twq-NE",version:"Release 10"},tt:oi,"tt-ru":{language:"Tatar",location:"Russia",id:1092,tag:"tt-RU",version:"Release D"},te:si,"te-in":{language:"Telugu",location:"India",id:1098,tag:"te-IN",version:"Release D"},teo:li,"teo-ke":{language:"Teso",location:"Kenya",id:4096,tag:"teo-KE",version:"Release 10"},"teo-ug":{language:"Teso",location:"Uganda",id:4096,tag:"teo-UG",version:"Release 10"},th:ui,"th-th":{language:"Thai",location:"Thailand",id:1054,tag:"th-TH",version:"Release B"},bo:hi,"bo-in":{language:"Tibetan",location:"India",id:4096,tag:"bo-IN",version:"Release 10"},"bo-cn":{language:"Tibetan",location:"People's Republic of China",id:1105,tag:"bo-CN",version:"Release V"},tig:ci,"tig-er":{language:"Tigre",location:"Eritrea",id:4096,tag:"tig-ER",version:"Release 10"},ti:fi,"ti-er":{language:"Tigrinya",location:"Eritrea",id:2163,tag:"ti-ER",version:"Release 8"},"ti-et":{language:"Tigrinya",location:"Ethiopia",id:1139,tag:"ti-ET",version:"Release 8"},to:di,"to-to":{language:"Tongan",location:"Tonga",id:4096,tag:"to-TO",version:"Release 10"},ts:gi,"ts-za":{language:"Tsonga",location:"South Africa",id:1073,tag:"ts-ZA",version:"Release 8.1"},tr:pi,"tr-cy":{language:"Turkish",location:"Cyprus",id:4096,tag:"tr-CY",version:"Release 10"},"tr-tr":{language:"Turkish",location:"Turkey",id:1055,tag:"tr-TR",version:"Release A"},tk:vi,"tk-tm":{language:"Turkmen",location:"Turkmenistan",id:1090,tag:"tk-TM",version:"Release V"},uk:mi,"uk-ua":{language:"Ukrainian",location:"Ukraine",id:1058,tag:"uk-UA",version:"Release B"},hsb:_i,"hsb-de":{language:"Upper Sorbian",location:"Germany",id:1070,tag:"hsb-DE",version:"Release V"},ur:yi,"ur-in":{language:"Urdu",location:"India",id:2080,tag:"ur-IN",version:"Release 8.1"},"ur-pk":{language:"Urdu",location:"Islamic Republic of Pakistan",id:1056,tag:"ur-PK",version:"Release C"},ug:bi,"ug-cn":{language:"Uyghur",location:"People's Republic of China",id:1152,tag:"ug-CN",version:"Release V"},"uz-arab":{language:"Uzbek",location:"Perso-Arabic",id:4096,tag:"uz-Arab",version:"Release 10"},"uz-arab-af":{language:"Uzbek",location:"Perso-Arabic, Afghanistan",id:4096,tag:"uz-Arab-AF",version:"Release 10"},"uz-cyrl":{language:"Uzbek (Cyrillic)",location:null,id:30787,tag:"uz-Cyrl",version:"Windows 7"},"uz-cyrl-uz":{language:"Uzbek (Cyrillic)",location:"Uzbekistan",id:2115,tag:"uz-Cyrl-UZ",version:"Release C"},uz:wi,"uz-latn":{language:"Uzbek (Latin)",location:null,id:31811,tag:"uz-Latn",version:"Windows 7"},"uz-latn-uz":{language:"Uzbek (Latin)",location:"Uzbekistan",id:1091,tag:"uz-Latn-UZ",version:"Release C"},vai:xi,"vai-vaii":{language:"Vai",location:null,id:4096,tag:"vai-Vaii",version:"Release 10"},"vai-vaii-lr":{language:"Vai",location:"Liberia",id:4096,tag:"vai-Vaii-LR",version:"Release 10"},"vai-latn-lr":{language:"Vai (Latin)",location:"Liberia",id:4096,tag:"vai-Latn-LR",version:"Release 10"},"vai-latn":{language:"Vai (Latin)",location:null,id:4096,tag:"vai-Latn",version:"Release 10"},"ca-es-":{language:"Valencian",location:"Spain",id:2051,tag:"ca-ES-",version:"Release 8"},ve:ki,"ve-za":{language:"Venda",location:"South Africa",id:1075,tag:"ve-ZA",version:"Release 10"},vi:Si,"vi-vn":{language:"Vietnamese",location:"Vietnam",id:1066,tag:"vi-VN",version:"Release B"},vo:Ci,"vo-001":{language:"Volapk",location:"World",id:4096,tag:"vo-001",version:"Release 10"},vun:Ai,"vun-tz":{language:"Vunjo",location:"Tanzania",id:4096,tag:"vun-TZ",version:"Release 10"},wae:Ei,"wae-ch":{language:"Walser",location:"Switzerland",id:4096,tag:"wae-CH",version:"Release 10"},cy:Mi,"cy-gb":{language:"Welsh",location:"United Kingdom",id:1106,tag:"cy-GB",version:"ReleaseE1"},wal:Ri,"wal-et":{language:"Wolaytta",location:"Ethiopia",id:4096,tag:"wal-ET",version:"Release 10"},wo:Ti,"wo-sn":{language:"Wolof",location:"Senegal",id:1160,tag:"wo-SN",version:"Release V"},xh:Bi,"xh-za":{language:"Xhosa",location:"South Africa",id:1076,tag:"xh-ZA",version:"Release E1"},yav:Oi,"yav-cm":{language:"Yangben",location:"Cameroon",id:4096,tag:"yav-CM",version:"Release 10"},ii:Pi,"ii-cn":{language:"Yi",location:"People's Republic of China",id:1144,tag:"ii-CN",version:"Release V"},yo:Di,"yo-bj":{language:"Yoruba",location:"Benin",id:4096,tag:"yo-BJ",version:"Release 10"},"yo-ng":{language:"Yoruba",location:"Nigeria",id:1130,tag:"yo-NG",version:"Release V"},dje:Ni,"dje-ne":{language:"Zarma",location:"Niger",id:4096,tag:"dje-NE",version:"Release 10"},zu:zi,"zu-za":{language:"Zulu",location:"South Africa",id:1077,tag:"zu-ZA",version:"Release E1"}};var Li={name:"Abkhazian",names:["Abkhazian"],"iso639-2":"abk","iso639-1":"ab"};var ji={name:"Achinese",names:["Achinese"],"iso639-2":"ace","iso639-1":null};var Ii={name:"Acoli",names:["Acoli"],"iso639-2":"ach","iso639-1":null};var Hi={name:"Adangme",names:["Adangme"],"iso639-2":"ada","iso639-1":null};var Vi={name:"Adygei",names:["Adyghe","Adygei"],"iso639-2":"ady","iso639-1":null};var Ui={name:"Adyghe",names:["Adyghe","Adygei"],"iso639-2":"ady","iso639-1":null};var Gi={name:"Afar",names:["Afar"],"iso639-2":"aar","iso639-1":"aa"};var Wi={name:"Afrihili",names:["Afrihili"],"iso639-2":"afh","iso639-1":null};var Ki={name:"Afrikaans",names:["Afrikaans"],"iso639-2":"afr","iso639-1":"af"};var qi={name:"Ainu",names:["Ainu"],"iso639-2":"ain","iso639-1":null};var Yi={name:"Akan",names:["Akan"],"iso639-2":"aka","iso639-1":"ak"};var Xi={name:"Akkadian",names:["Akkadian"],"iso639-2":"akk","iso639-1":null};var Zi={name:"Albanian",names:["Albanian"],"iso639-2":"alb/sqi","iso639-1":"sq"};var Ji={name:"Alemannic",names:["Swiss German","Alemannic","Alsatian"],"iso639-2":"gsw","iso639-1":null};var $i={name:"Aleut",names:["Aleut"],"iso639-2":"ale","iso639-1":null};var Qi={name:"Alsatian",names:["Swiss German","Alemannic","Alsatian"],"iso639-2":"gsw","iso639-1":null};var ta={name:"Amharic",names:["Amharic"],"iso639-2":"amh","iso639-1":"am"};var ea={name:"Angika",names:["Angika"],"iso639-2":"anp","iso639-1":null};var na={name:"Arabic",names:["Arabic"],"iso639-2":"ara","iso639-1":"ar"};var ia={name:"Aragonese",names:["Aragonese"],"iso639-2":"arg","iso639-1":"an"};var aa={name:"Arapaho",names:["Arapaho"],"iso639-2":"arp","iso639-1":null};var ra={name:"Arawak",names:["Arawak"],"iso639-2":"arw","iso639-1":null};var oa={name:"Armenian",names:["Armenian"],"iso639-2":"arm/hye","iso639-1":"hy"};var sa={name:"Aromanian",names:["Aromanian","Arumanian","Macedo-Romanian"],"iso639-2":"rup","iso639-1":null};var la={name:"Arumanian",names:["Aromanian","Arumanian","Macedo-Romanian"],"iso639-2":"rup","iso639-1":null};var ua={name:"Assamese",names:["Assamese"],"iso639-2":"asm","iso639-1":"as"};var ha={name:"Asturian",names:["Asturian","Bable","Leonese","Asturleonese"],"iso639-2":"ast","iso639-1":null};var ca={name:"Asturleonese",names:["Asturian","Bable","Leonese","Asturleonese"],"iso639-2":"ast","iso639-1":null};var fa={name:"Avaric",names:["Avaric"],"iso639-2":"ava","iso639-1":"av"};var da={name:"Avestan",names:["Avestan"],"iso639-2":"ave","iso639-1":"ae"};var ga={name:"Awadhi",names:["Awadhi"],"iso639-2":"awa","iso639-1":null};var pa={name:"Aymara",names:["Aymara"],"iso639-2":"aym","iso639-1":"ay"};var va={name:"Azerbaijani",names:["Azerbaijani"],"iso639-2":"aze","iso639-1":"az"};var ma={name:"Bable",names:["Asturian","Bable","Leonese","Asturleonese"],"iso639-2":"ast","iso639-1":null};var _a={name:"Balinese",names:["Balinese"],"iso639-2":"ban","iso639-1":null};var ya={name:"Baluchi",names:["Baluchi"],"iso639-2":"bal","iso639-1":null};var ba={name:"Bambara",names:["Bambara"],"iso639-2":"bam","iso639-1":"bm"};var wa={name:"Basa",names:["Basa"],"iso639-2":"bas","iso639-1":null};var xa={name:"Bashkir",names:["Bashkir"],"iso639-2":"bak","iso639-1":"ba"};var ka={name:"Basque",names:["Basque"],"iso639-2":"baq/eus","iso639-1":"eu"};var Sa={name:"Bedawiyet",names:["Beja","Bedawiyet"],"iso639-2":"bej","iso639-1":null};var Ca={name:"Beja",names:["Beja","Bedawiyet"],"iso639-2":"bej","iso639-1":null};var Aa={name:"Belarusian",names:["Belarusian"],"iso639-2":"bel","iso639-1":"be"};var Ea={name:"Bemba",names:["Bemba"],"iso639-2":"bem","iso639-1":null};var Ma={name:"Bengali",names:["Bengali"],"iso639-2":"ben","iso639-1":"bn"};var Ra={name:"Bhojpuri",names:["Bhojpuri"],"iso639-2":"bho","iso639-1":null};var Ta={name:"Bikol",names:["Bikol"],"iso639-2":"bik","iso639-1":null};var Ba={name:"Bilin",names:["Blin","Bilin"],"iso639-2":"byn","iso639-1":null};var Oa={name:"Bini",names:["Bini","Edo"],"iso639-2":"bin","iso639-1":null};var Pa={name:"Bislama",names:["Bislama"],"iso639-2":"bis","iso639-1":"bi"};var Da={name:"Blin",names:["Blin","Bilin"],"iso639-2":"byn","iso639-1":null};var Na={name:"Bliss",names:["Blissymbols","Blissymbolics","Bliss"],"iso639-2":"zbl","iso639-1":null};var za={name:"Blissymbolics",names:["Blissymbols","Blissymbolics","Bliss"],"iso639-2":"zbl","iso639-1":null};var Fa={name:"Blissymbols",names:["Blissymbols","Blissymbolics","Bliss"],"iso639-2":"zbl","iso639-1":null};var La={name:"Bosnian",names:["Bosnian"],"iso639-2":"bos","iso639-1":"bs"};var ja={name:"Braj",names:["Braj"],"iso639-2":"bra","iso639-1":null};var Ia={name:"Breton",names:["Breton"],"iso639-2":"bre","iso639-1":"br"};var Ha={name:"Buginese",names:["Buginese"],"iso639-2":"bug","iso639-1":null};var Va={name:"Bulgarian",names:["Bulgarian"],"iso639-2":"bul","iso639-1":"bg"};var Ua={name:"Buriat",names:["Buriat"],"iso639-2":"bua","iso639-1":null};var Ga={name:"Burmese",names:["Burmese"],"iso639-2":"bur/mya","iso639-1":"my"};var Wa={name:"Caddo",names:["Caddo"],"iso639-2":"cad","iso639-1":null};var Ka={name:"Castilian",names:["Spanish","Castilian"],"iso639-2":"spa","iso639-1":"es"};var qa={name:"Catalan",names:["Catalan","Valencian"],"iso639-2":"cat","iso639-1":"ca"};var Ya={name:"Cebuano",names:["Cebuano"],"iso639-2":"ceb","iso639-1":null};var Xa={name:"Chagatai",names:["Chagatai"],"iso639-2":"chg","iso639-1":null};var Za={name:"Chamorro",names:["Chamorro"],"iso639-2":"cha","iso639-1":"ch"};var Ja={name:"Chechen",names:["Chechen"],"iso639-2":"che","iso639-1":"ce"};var $a={name:"Cherokee",names:["Cherokee"],"iso639-2":"chr","iso639-1":null};var Qa={name:"Chewa",names:["Chichewa","Chewa","Nyanja"],"iso639-2":"nya","iso639-1":"ny"};var tr={name:"Cheyenne",names:["Cheyenne"],"iso639-2":"chy","iso639-1":null};var er={name:"Chibcha",names:["Chibcha"],"iso639-2":"chb","iso639-1":null};var nr={name:"Chichewa",names:["Chichewa","Chewa","Nyanja"],"iso639-2":"nya","iso639-1":"ny"};var ir={name:"Chinese",names:["Chinese"],"iso639-2":"chi/zho","iso639-1":"zh"};var ar={name:"Chipewyan",names:["Chipewyan","Dene Suline"],"iso639-2":"chp","iso639-1":null};var rr={name:"Choctaw",names:["Choctaw"],"iso639-2":"cho","iso639-1":null};var or={name:"Chuang",names:["Zhuang","Chuang"],"iso639-2":"zha","iso639-1":"za"};var sr={name:"Chuukese",names:["Chuukese"],"iso639-2":"chk","iso639-1":null};var lr={name:"Chuvash",names:["Chuvash"],"iso639-2":"chv","iso639-1":"cv"};var ur={name:"Coptic",names:["Coptic"],"iso639-2":"cop","iso639-1":null};var hr={name:"Cornish",names:["Cornish"],"iso639-2":"cor","iso639-1":"kw"};var cr={name:"Corsican",names:["Corsican"],"iso639-2":"cos","iso639-1":"co"};var fr={name:"Cree",names:["Cree"],"iso639-2":"cre","iso639-1":"cr"};var dr={name:"Creek",names:["Creek"],"iso639-2":"mus","iso639-1":null};var gr={name:"Croatian",names:["Croatian"],"iso639-2":"hrv","iso639-1":"hr"};var pr={name:"Czech",names:["Czech"],"iso639-2":"cze/ces","iso639-1":"cs"};var vr={name:"Dakota",names:["Dakota"],"iso639-2":"dak","iso639-1":null};var mr={name:"Danish",names:["Danish"],"iso639-2":"dan","iso639-1":"da"};var _r={name:"Dargwa",names:["Dargwa"],"iso639-2":"dar","iso639-1":null};var yr={name:"Delaware",names:["Delaware"],"iso639-2":"del","iso639-1":null};var br={name:"Dhivehi",names:["Divehi","Dhivehi","Maldivian"],"iso639-2":"div","iso639-1":"dv"};var wr={name:"Dimili",names:["Zaza","Dimili","Dimli","Kirdki","Kirmanjki","Zazaki"],"iso639-2":"zza","iso639-1":null};var xr={name:"Dimli",names:["Zaza","Dimili","Dimli","Kirdki","Kirmanjki","Zazaki"],"iso639-2":"zza","iso639-1":null};var kr={name:"Dinka",names:["Dinka"],"iso639-2":"din","iso639-1":null};var Sr={name:"Divehi",names:["Divehi","Dhivehi","Maldivian"],"iso639-2":"div","iso639-1":"dv"};var Cr={name:"Dogri",names:["Dogri"],"iso639-2":"doi","iso639-1":null};var Ar={name:"Dogrib",names:["Dogrib"],"iso639-2":"dgr","iso639-1":null};var Er={name:"Duala",names:["Duala"],"iso639-2":"dua","iso639-1":null};var Mr={name:"Dutch",names:["Dutch","Flemish"],"iso639-2":"dut/nld","iso639-1":"nl"};var Rr={name:"Dyula",names:["Dyula"],"iso639-2":"dyu","iso639-1":null};var Tr={name:"Dzongkha",names:["Dzongkha"],"iso639-2":"dzo","iso639-1":"dz"};var Br={name:"Edo",names:["Bini","Edo"],"iso639-2":"bin","iso639-1":null};var Or={name:"Efik",names:["Efik"],"iso639-2":"efi","iso639-1":null};var Pr={name:"Ekajuk",names:["Ekajuk"],"iso639-2":"eka","iso639-1":null};var Dr={name:"Elamite",names:["Elamite"],"iso639-2":"elx","iso639-1":null};var Nr={name:"English",names:["English"],"iso639-2":"eng","iso639-1":"en"};var zr={name:"Erzya",names:["Erzya"],"iso639-2":"myv","iso639-1":null};var Fr={name:"Esperanto",names:["Esperanto"],"iso639-2":"epo","iso639-1":"eo"};var Lr={name:"Estonian",names:["Estonian"],"iso639-2":"est","iso639-1":"et"};var jr={name:"Ewe",names:["Ewe"],"iso639-2":"ewe","iso639-1":"ee"};var Ir={name:"Ewondo",names:["Ewondo"],"iso639-2":"ewo","iso639-1":null};var Hr={name:"Fang",names:["Fang"],"iso639-2":"fan","iso639-1":null};var Vr={name:"Fanti",names:["Fanti"],"iso639-2":"fat","iso639-1":null};var Ur={name:"Faroese",names:["Faroese"],"iso639-2":"fao","iso639-1":"fo"};var Gr={name:"Fijian",names:["Fijian"],"iso639-2":"fij","iso639-1":"fj"};var Wr={name:"Filipino",names:["Filipino","Pilipino"],"iso639-2":"fil","iso639-1":null};var Kr={name:"Finnish",names:["Finnish"],"iso639-2":"fin","iso639-1":"fi"};var qr={name:"Flemish",names:["Dutch","Flemish"],"iso639-2":"dut/nld","iso639-1":"nl"};var Yr={name:"Fon",names:["Fon"],"iso639-2":"fon","iso639-1":null};var Xr={name:"French",names:["French"],"iso639-2":"fre/fra","iso639-1":"fr"};var Zr={name:"Friulian",names:["Friulian"],"iso639-2":"fur","iso639-1":null};var Jr={name:"Fulah",names:["Fulah"],"iso639-2":"ful","iso639-1":"ff"};var $r={name:"Ga",names:["Ga"],"iso639-2":"gaa","iso639-1":null};var Qr={name:"Gaelic",names:["Gaelic","Scottish Gaelic"],"iso639-2":"gla","iso639-1":"gd"};var to={name:"Galician",names:["Galician"],"iso639-2":"glg","iso639-1":"gl"};var eo={name:"Ganda",names:["Ganda"],"iso639-2":"lug","iso639-1":"lg"};var no={name:"Gayo",names:["Gayo"],"iso639-2":"gay","iso639-1":null};var io={name:"Gbaya",names:["Gbaya"],"iso639-2":"gba","iso639-1":null};var ao={name:"Geez",names:["Geez"],"iso639-2":"gez","iso639-1":null};var ro={name:"Georgian",names:["Georgian"],"iso639-2":"geo/kat","iso639-1":"ka"};var oo={name:"German",names:["German"],"iso639-2":"ger/deu","iso639-1":"de"};var so={name:"Gikuyu",names:["Kikuyu","Gikuyu"],"iso639-2":"kik","iso639-1":"ki"};var lo={name:"Gilbertese",names:["Gilbertese"],"iso639-2":"gil","iso639-1":null};var uo={name:"Gondi",names:["Gondi"],"iso639-2":"gon","iso639-1":null};var ho={name:"Gorontalo",names:["Gorontalo"],"iso639-2":"gor","iso639-1":null};var co={name:"Gothic",names:["Gothic"],"iso639-2":"got","iso639-1":null};var fo={name:"Grebo",names:["Grebo"],"iso639-2":"grb","iso639-1":null};var go={name:"Greenlandic",names:["Kalaallisut","Greenlandic"],"iso639-2":"kal","iso639-1":"kl"};var po={name:"Guarani",names:["Guarani"],"iso639-2":"grn","iso639-1":"gn"};var vo={name:"Gujarati",names:["Gujarati"],"iso639-2":"guj","iso639-1":"gu"};var mo={name:"Haida",names:["Haida"],"iso639-2":"hai","iso639-1":null};var _o={name:"Haitian",names:["Haitian","Haitian Creole"],"iso639-2":"hat","iso639-1":"ht"};var yo={name:"Hausa",names:["Hausa"],"iso639-2":"hau","iso639-1":"ha"};var bo={name:"Hawaiian",names:["Hawaiian"],"iso639-2":"haw","iso639-1":null};var wo={name:"Hebrew",names:["Hebrew"],"iso639-2":"heb","iso639-1":"he"};var xo={name:"Herero",names:["Herero"],"iso639-2":"her","iso639-1":"hz"};var ko={name:"Hiligaynon",names:["Hiligaynon"],"iso639-2":"hil","iso639-1":null};var So={name:"Hindi",names:["Hindi"],"iso639-2":"hin","iso639-1":"hi"};var Co={name:"Hittite",names:["Hittite"],"iso639-2":"hit","iso639-1":null};var Ao={name:"Hmong",names:["Hmong","Mong"],"iso639-2":"hmn","iso639-1":null};var Eo={name:"Hungarian",names:["Hungarian"],"iso639-2":"hun","iso639-1":"hu"};var Mo={name:"Hupa",names:["Hupa"],"iso639-2":"hup","iso639-1":null};var Ro={name:"Iban",names:["Iban"],"iso639-2":"iba","iso639-1":null};var To={name:"Icelandic",names:["Icelandic"],"iso639-2":"ice/isl","iso639-1":"is"};var Bo={name:"Ido",names:["Ido"],"iso639-2":"ido","iso639-1":"io"};var Oo={name:"Igbo",names:["Igbo"],"iso639-2":"ibo","iso639-1":"ig"};var Po={name:"Iloko",names:["Iloko"],"iso639-2":"ilo","iso639-1":null};var Do={name:"Indonesian",names:["Indonesian"],"iso639-2":"ind","iso639-1":"id"};var No={name:"Ingush",names:["Ingush"],"iso639-2":"inh","iso639-1":null};var zo={name:"Interlingue",names:["Interlingue","Occidental"],"iso639-2":"ile","iso639-1":"ie"};var Fo={name:"Inuktitut",names:["Inuktitut"],"iso639-2":"iku","iso639-1":"iu"};var Lo={name:"Inupiaq",names:["Inupiaq"],"iso639-2":"ipk","iso639-1":"ik"};var jo={name:"Irish",names:["Irish"],"iso639-2":"gle","iso639-1":"ga"};var Io={name:"Italian",names:["Italian"],"iso639-2":"ita","iso639-1":"it"};var Ho={name:"Japanese",names:["Japanese"],"iso639-2":"jpn","iso639-1":"ja"};var Vo={name:"Javanese",names:["Javanese"],"iso639-2":"jav","iso639-1":"jv"};var Uo={name:"Jingpho",names:["Kachin","Jingpho"],"iso639-2":"kac","iso639-1":null};var Go={name:"Kabardian",names:["Kabardian"],"iso639-2":"kbd","iso639-1":null};var Wo={name:"Kabyle",names:["Kabyle"],"iso639-2":"kab","iso639-1":null};var Ko={name:"Kachin",names:["Kachin","Jingpho"],"iso639-2":"kac","iso639-1":null};var qo={name:"Kalaallisut",names:["Kalaallisut","Greenlandic"],"iso639-2":"kal","iso639-1":"kl"};var Yo={name:"Kalmyk",names:["Kalmyk","Oirat"],"iso639-2":"xal","iso639-1":null};var Xo={name:"Kamba",names:["Kamba"],"iso639-2":"kam","iso639-1":null};var Zo={name:"Kannada",names:["Kannada"],"iso639-2":"kan","iso639-1":"kn"};var Jo={name:"Kanuri",names:["Kanuri"],"iso639-2":"kau","iso639-1":"kr"};var $o={name:"Kapampangan",names:["Pampanga","Kapampangan"],"iso639-2":"pam","iso639-1":null};var Qo={name:"Karelian",names:["Karelian"],"iso639-2":"krl","iso639-1":null};var ts={name:"Kashmiri",names:["Kashmiri"],"iso639-2":"kas","iso639-1":"ks"};var es={name:"Kashubian",names:["Kashubian"],"iso639-2":"csb","iso639-1":null};var ns={name:"Kawi",names:["Kawi"],"iso639-2":"kaw","iso639-1":null};var is={name:"Kazakh",names:["Kazakh"],"iso639-2":"kaz","iso639-1":"kk"};var as={name:"Khasi",names:["Khasi"],"iso639-2":"kha","iso639-1":null};var rs={name:"Khotanese",names:["Khotanese","Sakan"],"iso639-2":"kho","iso639-1":null};var os={name:"Kikuyu",names:["Kikuyu","Gikuyu"],"iso639-2":"kik","iso639-1":"ki"};var ss={name:"Kimbundu",names:["Kimbundu"],"iso639-2":"kmb","iso639-1":null};var ls={name:"Kinyarwanda",names:["Kinyarwanda"],"iso639-2":"kin","iso639-1":"rw"};var us={name:"Kirdki",names:["Zaza","Dimili","Dimli","Kirdki","Kirmanjki","Zazaki"],"iso639-2":"zza","iso639-1":null};var hs={name:"Kirghiz",names:["Kirghiz","Kyrgyz"],"iso639-2":"kir","iso639-1":"ky"};var cs={name:"Kirmanjki",names:["Zaza","Dimili","Dimli","Kirdki","Kirmanjki","Zazaki"],"iso639-2":"zza","iso639-1":null};var fs={name:"Klingon",names:["Klingon","tlhIngan-Hol"],"iso639-2":"tlh","iso639-1":null};var ds={name:"Komi",names:["Komi"],"iso639-2":"kom","iso639-1":"kv"};var gs={name:"Kongo",names:["Kongo"],"iso639-2":"kon","iso639-1":"kg"};var ps={name:"Konkani",names:["Konkani"],"iso639-2":"kok","iso639-1":null};var vs={name:"Korean",names:["Korean"],"iso639-2":"kor","iso639-1":"ko"};var ms={name:"Kosraean",names:["Kosraean"],"iso639-2":"kos","iso639-1":null};var _s={name:"Kpelle",names:["Kpelle"],"iso639-2":"kpe","iso639-1":null};var ys={name:"Kuanyama",names:["Kuanyama","Kwanyama"],"iso639-2":"kua","iso639-1":"kj"};var bs={name:"Kumyk",names:["Kumyk"],"iso639-2":"kum","iso639-1":null};var ws={name:"Kurdish",names:["Kurdish"],"iso639-2":"kur","iso639-1":"ku"};var xs={name:"Kurukh",names:["Kurukh"],"iso639-2":"kru","iso639-1":null};var ks={name:"Kutenai",names:["Kutenai"],"iso639-2":"kut","iso639-1":null};var Ss={name:"Kwanyama",names:["Kuanyama","Kwanyama"],"iso639-2":"kua","iso639-1":"kj"};var Cs={name:"Kyrgyz",names:["Kirghiz","Kyrgyz"],"iso639-2":"kir","iso639-1":"ky"};var As={name:"Ladino",names:["Ladino"],"iso639-2":"lad","iso639-1":null};var Es={name:"Lahnda",names:["Lahnda"],"iso639-2":"lah","iso639-1":null};var Ms={name:"Lamba",names:["Lamba"],"iso639-2":"lam","iso639-1":null};var Rs={name:"Lao",names:["Lao"],"iso639-2":"lao","iso639-1":"lo"};var Ts={name:"Latin",names:["Latin"],"iso639-2":"lat","iso639-1":"la"};var Bs={name:"Latvian",names:["Latvian"],"iso639-2":"lav","iso639-1":"lv"};var Os={name:"Leonese",names:["Asturian","Bable","Leonese","Asturleonese"],"iso639-2":"ast","iso639-1":null};var Ps={name:"Letzeburgesch",names:["Luxembourgish","Letzeburgesch"],"iso639-2":"ltz","iso639-1":"lb"};var Ds={name:"Lezghian",names:["Lezghian"],"iso639-2":"lez","iso639-1":null};var Ns={name:"Limburgan",names:["Limburgan","Limburger","Limburgish"],"iso639-2":"lim","iso639-1":"li"};var zs={name:"Limburger",names:["Limburgan","Limburger","Limburgish"],"iso639-2":"lim","iso639-1":"li"};var Fs={name:"Limburgish",names:["Limburgan","Limburger","Limburgish"],"iso639-2":"lim","iso639-1":"li"};var Ls={name:"Lingala",names:["Lingala"],"iso639-2":"lin","iso639-1":"ln"};var js={name:"Lithuanian",names:["Lithuanian"],"iso639-2":"lit","iso639-1":"lt"};var Is={name:"Lojban",names:["Lojban"],"iso639-2":"jbo","iso639-1":null};var Hs={name:"Lozi",names:["Lozi"],"iso639-2":"loz","iso639-1":null};var Vs={name:"Luiseno",names:["Luiseno"],"iso639-2":"lui","iso639-1":null};var Us={name:"Lunda",names:["Lunda"],"iso639-2":"lun","iso639-1":null};var Gs={name:"Lushai",names:["Lushai"],"iso639-2":"lus","iso639-1":null};var Ws={name:"Luxembourgish",names:["Luxembourgish","Letzeburgesch"],"iso639-2":"ltz","iso639-1":"lb"};var Ks={name:"Macedonian",names:["Macedonian"],"iso639-2":"mac/mkd","iso639-1":"mk"};var qs={name:"Madurese",names:["Madurese"],"iso639-2":"mad","iso639-1":null};var Ys={name:"Magahi",names:["Magahi"],"iso639-2":"mag","iso639-1":null};var Xs={name:"Maithili",names:["Maithili"],"iso639-2":"mai","iso639-1":null};var Zs={name:"Makasar",names:["Makasar"],"iso639-2":"mak","iso639-1":null};var Js={name:"Malagasy",names:["Malagasy"],"iso639-2":"mlg","iso639-1":"mg"};var $s={name:"Malay",names:["Malay"],"iso639-2":"may/msa","iso639-1":"ms"};var Qs={name:"Malayalam",names:["Malayalam"],"iso639-2":"mal","iso639-1":"ml"};var tl={name:"Maldivian",names:["Divehi","Dhivehi","Maldivian"],"iso639-2":"div","iso639-1":"dv"};var el={name:"Maltese",names:["Maltese"],"iso639-2":"mlt","iso639-1":"mt"};var nl={name:"Manchu",names:["Manchu"],"iso639-2":"mnc","iso639-1":null};var il={name:"Mandar",names:["Mandar"],"iso639-2":"mdr","iso639-1":null};var al={name:"Mandingo",names:["Mandingo"],"iso639-2":"man","iso639-1":null};var rl={name:"Manipuri",names:["Manipuri"],"iso639-2":"mni","iso639-1":null};var ol={name:"Manx",names:["Manx"],"iso639-2":"glv","iso639-1":"gv"};var sl={name:"Maori",names:["Maori"],"iso639-2":"mao/mri","iso639-1":"mi"};var ll={name:"Mapuche",names:["Mapudungun","Mapuche"],"iso639-2":"arn","iso639-1":null};var ul={name:"Mapudungun",names:["Mapudungun","Mapuche"],"iso639-2":"arn","iso639-1":null};var hl={name:"Marathi",names:["Marathi"],"iso639-2":"mar","iso639-1":"mr"};var cl={name:"Mari",names:["Mari"],"iso639-2":"chm","iso639-1":null};var fl={name:"Marshallese",names:["Marshallese"],"iso639-2":"mah","iso639-1":"mh"};var dl={name:"Marwari",names:["Marwari"],"iso639-2":"mwr","iso639-1":null};var gl={name:"Masai",names:["Masai"],"iso639-2":"mas","iso639-1":null};var pl={name:"Mende",names:["Mende"],"iso639-2":"men","iso639-1":null};var vl={name:"Micmac",names:["Mi'kmaq","Micmac"],"iso639-2":"mic","iso639-1":null};var ml={name:"Minangkabau",names:["Minangkabau"],"iso639-2":"min","iso639-1":null};var _l={name:"Mirandese",names:["Mirandese"],"iso639-2":"mwl","iso639-1":null};var yl={name:"Mohawk",names:["Mohawk"],"iso639-2":"moh","iso639-1":null};var bl={name:"Moksha",names:["Moksha"],"iso639-2":"mdf","iso639-1":null};var wl={name:"Moldavian",names:["Romanian","Moldavian","Moldovan"],"iso639-2":"rum/ron","iso639-1":"ro"};var xl={name:"Moldovan",names:["Romanian","Moldavian","Moldovan"],"iso639-2":"rum/ron","iso639-1":"ro"};var kl={name:"Mong",names:["Hmong","Mong"],"iso639-2":"hmn","iso639-1":null};var Sl={name:"Mongo",names:["Mongo"],"iso639-2":"lol","iso639-1":null};var Cl={name:"Mongolian",names:["Mongolian"],"iso639-2":"mon","iso639-1":"mn"};var Al={name:"Montenegrin",names:["Montenegrin"],"iso639-2":"cnr","iso639-1":null};var El={name:"Mossi",names:["Mossi"],"iso639-2":"mos","iso639-1":null};var Ml={name:"Nauru",names:["Nauru"],"iso639-2":"nau","iso639-1":"na"};var Rl={name:"Navaho",names:["Navajo","Navaho"],"iso639-2":"nav","iso639-1":"nv"};var Tl={name:"Navajo",names:["Navajo","Navaho"],"iso639-2":"nav","iso639-1":"nv"};var Bl={name:"Ndonga",names:["Ndonga"],"iso639-2":"ndo","iso639-1":"ng"};var Ol={name:"Neapolitan",names:["Neapolitan"],"iso639-2":"nap","iso639-1":null};var Pl={name:"Nepali",names:["Nepali"],"iso639-2":"nep","iso639-1":"ne"};var Dl={name:"Newari",names:["Nepal Bhasa","Newari"],"iso639-2":"new","iso639-1":null};var Nl={name:"Nias",names:["Nias"],"iso639-2":"nia","iso639-1":null};var zl={name:"Niuean",names:["Niuean"],"iso639-2":"niu","iso639-1":null};var Fl={name:"Nogai",names:["Nogai"],"iso639-2":"nog","iso639-1":null};var Ll={name:"Norwegian",names:["Norwegian"],"iso639-2":"nor","iso639-1":"no"};var jl={name:"Nuosu",names:["Sichuan Yi","Nuosu"],"iso639-2":"iii","iso639-1":"ii"};var Il={name:"Nyamwezi",names:["Nyamwezi"],"iso639-2":"nym","iso639-1":null};var Hl={name:"Nyanja",names:["Chichewa","Chewa","Nyanja"],"iso639-2":"nya","iso639-1":"ny"};var Vl={name:"Nyankole",names:["Nyankole"],"iso639-2":"nyn","iso639-1":null};var Ul={name:"Nyoro",names:["Nyoro"],"iso639-2":"nyo","iso639-1":null};var Gl={name:"Nzima",names:["Nzima"],"iso639-2":"nzi","iso639-1":null};var Wl={name:"Occidental",names:["Interlingue","Occidental"],"iso639-2":"ile","iso639-1":"ie"};var Kl={name:"Oirat",names:["Kalmyk","Oirat"],"iso639-2":"xal","iso639-1":null};var ql={name:"Ojibwa",names:["Ojibwa"],"iso639-2":"oji","iso639-1":"oj"};var Yl={name:"Oriya",names:["Oriya"],"iso639-2":"ori","iso639-1":"or"};var Xl={name:"Oromo",names:["Oromo"],"iso639-2":"orm","iso639-1":"om"};var Zl={name:"Osage",names:["Osage"],"iso639-2":"osa","iso639-1":null};var Jl={name:"Ossetian",names:["Ossetian","Ossetic"],"iso639-2":"oss","iso639-1":"os"};var $l={name:"Ossetic",names:["Ossetian","Ossetic"],"iso639-2":"oss","iso639-1":"os"};var Ql={name:"Pahlavi",names:["Pahlavi"],"iso639-2":"pal","iso639-1":null};var tu={name:"Palauan",names:["Palauan"],"iso639-2":"pau","iso639-1":null};var eu={name:"Pali",names:["Pali"],"iso639-2":"pli","iso639-1":"pi"};var nu={name:"Pampanga",names:["Pampanga","Kapampangan"],"iso639-2":"pam","iso639-1":null};var iu={name:"Pangasinan",names:["Pangasinan"],"iso639-2":"pag","iso639-1":null};var au={name:"Panjabi",names:["Panjabi","Punjabi"],"iso639-2":"pan","iso639-1":"pa"};var ru={name:"Papiamento",names:["Papiamento"],"iso639-2":"pap","iso639-1":null};var ou={name:"Pashto",names:["Pushto","Pashto"],"iso639-2":"pus","iso639-1":"ps"};var su={name:"Pedi",names:["Pedi","Sepedi","Northern Sotho"],"iso639-2":"nso","iso639-1":null};var lu={name:"Persian",names:["Persian"],"iso639-2":"per/fas","iso639-1":"fa"};var uu={name:"Phoenician",names:["Phoenician"],"iso639-2":"phn","iso639-1":null};var hu={name:"Pilipino",names:["Filipino","Pilipino"],"iso639-2":"fil","iso639-1":null};var cu={name:"Pohnpeian",names:["Pohnpeian"],"iso639-2":"pon","iso639-1":null};var fu={name:"Polish",names:["Polish"],"iso639-2":"pol","iso639-1":"pl"};var du={name:"Portuguese",names:["Portuguese"],"iso639-2":"por","iso639-1":"pt"};var gu={name:"Punjabi",names:["Panjabi","Punjabi"],"iso639-2":"pan","iso639-1":"pa"};var pu={name:"Pushto",names:["Pushto","Pashto"],"iso639-2":"pus","iso639-1":"ps"};var vu={name:"Quechua",names:["Quechua"],"iso639-2":"que","iso639-1":"qu"};var mu={name:"Rajasthani",names:["Rajasthani"],"iso639-2":"raj","iso639-1":null};var _u={name:"Rapanui",names:["Rapanui"],"iso639-2":"rap","iso639-1":null};var yu={name:"Rarotongan",names:["Rarotongan","Cook Islands Maori"],"iso639-2":"rar","iso639-1":null};var bu={name:"Romanian",names:["Romanian","Moldavian","Moldovan"],"iso639-2":"rum/ron","iso639-1":"ro"};var wu={name:"Romansh",names:["Romansh"],"iso639-2":"roh","iso639-1":"rm"};var xu={name:"Romany",names:["Romany"],"iso639-2":"rom","iso639-1":null};var ku={name:"Rundi",names:["Rundi"],"iso639-2":"run","iso639-1":"rn"};var Su={name:"Russian",names:["Russian"],"iso639-2":"rus","iso639-1":"ru"};var Cu={name:"Sakan",names:["Khotanese","Sakan"],"iso639-2":"kho","iso639-1":null};var Au={name:"Samoan",names:["Samoan"],"iso639-2":"smo","iso639-1":"sm"};var Eu={name:"Sandawe",names:["Sandawe"],"iso639-2":"sad","iso639-1":null};var Mu={name:"Sango",names:["Sango"],"iso639-2":"sag","iso639-1":"sg"};var Ru={name:"Sanskrit",names:["Sanskrit"],"iso639-2":"san","iso639-1":"sa"};var Tu={name:"Santali",names:["Santali"],"iso639-2":"sat","iso639-1":null};var Bu={name:"Sardinian",names:["Sardinian"],"iso639-2":"srd","iso639-1":"sc"};var Ou={name:"Sasak",names:["Sasak"],"iso639-2":"sas","iso639-1":null};var Pu={name:"Scots",names:["Scots"],"iso639-2":"sco","iso639-1":null};var Du={name:"Selkup",names:["Selkup"],"iso639-2":"sel","iso639-1":null};var Nu={name:"Sepedi",names:["Pedi","Sepedi","Northern Sotho"],"iso639-2":"nso","iso639-1":null};var zu={name:"Serbian",names:["Serbian"],"iso639-2":"srp","iso639-1":"sr"};var Fu={name:"Serer",names:["Serer"],"iso639-2":"srr","iso639-1":null};var Lu={name:"Shan",names:["Shan"],"iso639-2":"shn","iso639-1":null};var ju={name:"Shona",names:["Shona"],"iso639-2":"sna","iso639-1":"sn"};var Iu={name:"Sicilian",names:["Sicilian"],"iso639-2":"scn","iso639-1":null};var Hu={name:"Sidamo",names:["Sidamo"],"iso639-2":"sid","iso639-1":null};var Vu={name:"Siksika",names:["Siksika"],"iso639-2":"bla","iso639-1":null};var Uu={name:"Sindhi",names:["Sindhi"],"iso639-2":"snd","iso639-1":"sd"};var Gu={name:"Sinhala",names:["Sinhala","Sinhalese"],"iso639-2":"sin","iso639-1":"si"};var Wu={name:"Sinhalese",names:["Sinhala","Sinhalese"],"iso639-2":"sin","iso639-1":"si"};var Ku={name:"Slovak",names:["Slovak"],"iso639-2":"slo/slk","iso639-1":"sk"};var qu={name:"Slovenian",names:["Slovenian"],"iso639-2":"slv","iso639-1":"sl"};var Yu={name:"Sogdian",names:["Sogdian"],"iso639-2":"sog","iso639-1":null};var Xu={name:"Somali",names:["Somali"],"iso639-2":"som","iso639-1":"so"};var Zu={name:"Soninke",names:["Soninke"],"iso639-2":"snk","iso639-1":null};var Ju={name:"Spanish",names:["Spanish","Castilian"],"iso639-2":"spa","iso639-1":"es"};var $u={name:"Sukuma",names:["Sukuma"],"iso639-2":"suk","iso639-1":null};var Qu={name:"Sumerian",names:["Sumerian"],"iso639-2":"sux","iso639-1":null};var th={name:"Sundanese",names:["Sundanese"],"iso639-2":"sun","iso639-1":"su"};var eh={name:"Susu",names:["Susu"],"iso639-2":"sus","iso639-1":null};var nh={name:"Swahili",names:["Swahili"],"iso639-2":"swa","iso639-1":"sw"};var ih={name:"Swati",names:["Swati"],"iso639-2":"ssw","iso639-1":"ss"};var ah={name:"Swedish",names:["Swedish"],"iso639-2":"swe","iso639-1":"sv"};var rh={name:"Syriac",names:["Syriac"],"iso639-2":"syr","iso639-1":null};var oh={name:"Tagalog",names:["Tagalog"],"iso639-2":"tgl","iso639-1":"tl"};var sh={name:"Tahitian",names:["Tahitian"],"iso639-2":"tah","iso639-1":"ty"};var lh={name:"Tajik",names:["Tajik"],"iso639-2":"tgk","iso639-1":"tg"};var uh={name:"Tamashek",names:["Tamashek"],"iso639-2":"tmh","iso639-1":null};var hh={name:"Tamil",names:["Tamil"],"iso639-2":"tam","iso639-1":"ta"};var ch={name:"Tatar",names:["Tatar"],"iso639-2":"tat","iso639-1":"tt"};var fh={name:"Telugu",names:["Telugu"],"iso639-2":"tel","iso639-1":"te"};var dh={name:"Tereno",names:["Tereno"],"iso639-2":"ter","iso639-1":null};var gh={name:"Tetum",names:["Tetum"],"iso639-2":"tet","iso639-1":null};var ph={name:"Thai",names:["Thai"],"iso639-2":"tha","iso639-1":"th"};var vh={name:"Tibetan",names:["Tibetan"],"iso639-2":"tib/bod","iso639-1":"bo"};var mh={name:"Tigre",names:["Tigre"],"iso639-2":"tig","iso639-1":null};var _h={name:"Tigrinya",names:["Tigrinya"],"iso639-2":"tir","iso639-1":"ti"};var yh={name:"Timne",names:["Timne"],"iso639-2":"tem","iso639-1":null};var bh={name:"Tiv",names:["Tiv"],"iso639-2":"tiv","iso639-1":null};var wh={name:"Tlingit",names:["Tlingit"],"iso639-2":"tli","iso639-1":null};var xh={name:"Tokelau",names:["Tokelau"],"iso639-2":"tkl","iso639-1":null};var kh={name:"Tsimshian",names:["Tsimshian"],"iso639-2":"tsi","iso639-1":null};var Sh={name:"Tsonga",names:["Tsonga"],"iso639-2":"tso","iso639-1":"ts"};var Ch={name:"Tswana",names:["Tswana"],"iso639-2":"tsn","iso639-1":"tn"};var Ah={name:"Tumbuka",names:["Tumbuka"],"iso639-2":"tum","iso639-1":null};var Eh={name:"Turkish",names:["Turkish"],"iso639-2":"tur","iso639-1":"tr"};var Mh={name:"Turkmen",names:["Turkmen"],"iso639-2":"tuk","iso639-1":"tk"};var Rh={name:"Tuvalu",names:["Tuvalu"],"iso639-2":"tvl","iso639-1":null};var Th={name:"Tuvinian",names:["Tuvinian"],"iso639-2":"tyv","iso639-1":null};var Bh={name:"Twi",names:["Twi"],"iso639-2":"twi","iso639-1":"tw"};var Oh={name:"Udmurt",names:["Udmurt"],"iso639-2":"udm","iso639-1":null};var Ph={name:"Ugaritic",names:["Ugaritic"],"iso639-2":"uga","iso639-1":null};var Dh={name:"Uighur",names:["Uighur","Uyghur"],"iso639-2":"uig","iso639-1":"ug"};var Nh={name:"Ukrainian",names:["Ukrainian"],"iso639-2":"ukr","iso639-1":"uk"};var zh={name:"Umbundu",names:["Umbundu"],"iso639-2":"umb","iso639-1":null};var Fh={name:"Undetermined",names:["Undetermined"],"iso639-2":"und","iso639-1":null};var Lh={name:"Urdu",names:["Urdu"],"iso639-2":"urd","iso639-1":"ur"};var jh={name:"Uyghur",names:["Uighur","Uyghur"],"iso639-2":"uig","iso639-1":"ug"};var Ih={name:"Uzbek",names:["Uzbek"],"iso639-2":"uzb","iso639-1":"uz"};var Hh={name:"Vai",names:["Vai"],"iso639-2":"vai","iso639-1":null};var Vh={name:"Valencian",names:["Catalan","Valencian"],"iso639-2":"cat","iso639-1":"ca"};var Uh={name:"Venda",names:["Venda"],"iso639-2":"ven","iso639-1":"ve"};var Gh={name:"Vietnamese",names:["Vietnamese"],"iso639-2":"vie","iso639-1":"vi"};var Wh={name:"Votic",names:["Votic"],"iso639-2":"vot","iso639-1":null};var Kh={name:"Walloon",names:["Walloon"],"iso639-2":"wln","iso639-1":"wa"};var qh={name:"Waray",names:["Waray"],"iso639-2":"war","iso639-1":null};var Yh={name:"Washo",names:["Washo"],"iso639-2":"was","iso639-1":null};var Xh={name:"Welsh",names:["Welsh"],"iso639-2":"wel/cym","iso639-1":"cy"};var Zh={name:"Wolaitta",names:["Wolaitta","Wolaytta"],"iso639-2":"wal","iso639-1":null};var Jh={name:"Wolaytta",names:["Wolaitta","Wolaytta"],"iso639-2":"wal","iso639-1":null};var $h={name:"Wolof",names:["Wolof"],"iso639-2":"wol","iso639-1":"wo"};var Qh={name:"Xhosa",names:["Xhosa"],"iso639-2":"xho","iso639-1":"xh"};var tc={name:"Yakut",names:["Yakut"],"iso639-2":"sah","iso639-1":null};var ec={name:"Yao",names:["Yao"],"iso639-2":"yao","iso639-1":null};var nc={name:"Yapese",names:["Yapese"],"iso639-2":"yap","iso639-1":null};var ic={name:"Yiddish",names:["Yiddish"],"iso639-2":"yid","iso639-1":"yi"};var ac={name:"Yoruba",names:["Yoruba"],"iso639-2":"yor","iso639-1":"yo"};var rc={name:"Zapotec",names:["Zapotec"],"iso639-2":"zap","iso639-1":null};var oc={name:"Zaza",names:["Zaza","Dimili","Dimli","Kirdki","Kirmanjki","Zazaki"],"iso639-2":"zza","iso639-1":null};var sc={name:"Zazaki",names:["Zaza","Dimili","Dimli","Kirdki","Kirmanjki","Zazaki"],"iso639-2":"zza","iso639-1":null};var lc={name:"Zenaga",names:["Zenaga"],"iso639-2":"zen","iso639-1":null};var uc={name:"Zhuang",names:["Zhuang","Chuang"],"iso639-2":"zha","iso639-1":"za"};var hc={name:"Zulu",names:["Zulu"],"iso639-2":"zul","iso639-1":"zu"};var cc={name:"Zuni",names:["Zuni"],"iso639-2":"zun","iso639-1":null};var fc={Abkhazian:Li,Achinese:ji,Acoli:Ii,Adangme:Hi,Adygei:Vi,Adyghe:Ui,Afar:Gi,Afrihili:Wi,Afrikaans:Ki,"Afro-Asiatic languages":{name:"Afro-Asiatic languages",names:["Afro-Asiatic languages"],"iso639-2":"afa","iso639-1":null},Ainu:qi,Akan:Yi,Akkadian:Xi,Albanian:Zi,Alemannic:Ji,Aleut:$i,"Algonquian languages":{name:"Algonquian languages",names:["Algonquian languages"],"iso639-2":"alg","iso639-1":null},Alsatian:Qi,"Altaic languages":{name:"Altaic languages",names:["Altaic languages"],"iso639-2":"tut","iso639-1":null},Amharic:ta,Angika:ea,"Apache languages":{name:"Apache languages",names:["Apache languages"],"iso639-2":"apa","iso639-1":null},Arabic:na,Aragonese:ia,Arapaho:aa,Arawak:ra,Armenian:oa,Aromanian:sa,"Artificial languages":{name:"Artificial languages",names:["Artificial languages"],"iso639-2":"art","iso639-1":null},Arumanian:la,Assamese:ua,Asturian:ha,Asturleonese:ca,"Athapascan languages":{name:"Athapascan languages",names:["Athapascan languages"],"iso639-2":"ath","iso639-1":null},"Australian languages":{name:"Australian languages",names:["Australian languages"],"iso639-2":"aus","iso639-1":null},"Austronesian languages":{name:"Austronesian languages",names:["Austronesian languages"],"iso639-2":"map","iso639-1":null},Avaric:fa,Avestan:da,Awadhi:ga,Aymara:pa,Azerbaijani:va,Bable:ma,Balinese:_a,"Baltic languages":{name:"Baltic languages",names:["Baltic languages"],"iso639-2":"bat","iso639-1":null},Baluchi:ya,Bambara:ba,"Bamileke languages":{name:"Bamileke languages",names:["Bamileke languages"],"iso639-2":"bai","iso639-1":null},"Banda languages":{name:"Banda languages",names:["Banda languages"],"iso639-2":"bad","iso639-1":null},"Bantu languages":{name:"Bantu languages",names:["Bantu languages"],"iso639-2":"bnt","iso639-1":null},Basa:wa,Bashkir:xa,Basque:ka,"Batak languages":{name:"Batak languages",names:["Batak languages"],"iso639-2":"btk","iso639-1":null},Bedawiyet:Sa,Beja:Ca,Belarusian:Aa,Bemba:Ea,Bengali:Ma,"Berber languages":{name:"Berber languages",names:["Berber languages"],"iso639-2":"ber","iso639-1":null},Bhojpuri:Ra,"Bihari languages":{name:"Bihari languages",names:["Bihari languages"],"iso639-2":"bih","iso639-1":"bh"},Bikol:Ta,Bilin:Ba,Bini:Oa,Bislama:Pa,Blin:Da,Bliss:Na,Blissymbolics:za,Blissymbols:Fa,"Bokml, Norwegian":{name:"Bokml, Norwegian",names:["Bokml, Norwegian","Norwegian Bokml"],"iso639-2":"nob","iso639-1":"nb"},Bosnian:La,Braj:ja,Breton:Ia,Buginese:Ha,Bulgarian:Va,Buriat:Ua,Burmese:Ga,Caddo:Wa,Castilian:Ka,Catalan:qa,"Caucasian languages":{name:"Caucasian languages",names:["Caucasian languages"],"iso639-2":"cau","iso639-1":null},Cebuano:Ya,"Celtic languages":{name:"Celtic languages",names:["Celtic languages"],"iso639-2":"cel","iso639-1":null},"Central American Indian languages":{name:"Central American Indian languages",names:["Central American Indian languages"],"iso639-2":"cai","iso639-1":null},"Central Khmer":{name:"Central Khmer",names:["Central Khmer"],"iso639-2":"khm","iso639-1":"km"},Chagatai:Xa,"Chamic languages":{name:"Chamic languages",names:["Chamic languages"],"iso639-2":"cmc","iso639-1":null},Chamorro:Za,Chechen:Ja,Cherokee:$a,Chewa:Qa,Cheyenne:tr,Chibcha:er,Chichewa:nr,Chinese:ir,"Chinook jargon":{name:"Chinook jargon",names:["Chinook jargon"],"iso639-2":"chn","iso639-1":null},Chipewyan:ar,Choctaw:rr,Chuang:or,"Church Slavic":{name:"Church Slavic",names:["Church Slavic","Old Slavonic","Church Slavonic","Old Bulgarian","Old Church Slavonic"],"iso639-2":"chu","iso639-1":"cu"},"Church Slavonic":{name:"Church Slavonic",names:["Church Slavic","Old Slavonic","Church Slavonic","Old Bulgarian","Old Church Slavonic"],"iso639-2":"chu","iso639-1":"cu"},Chuukese:sr,Chuvash:lr,"Classical Nepal Bhasa":{name:"Classical Nepal Bhasa",names:["Classical Newari","Old Newari","Classical Nepal Bhasa"],"iso639-2":"nwc","iso639-1":null},"Classical Newari":{name:"Classical Newari",names:["Classical Newari","Old Newari","Classical Nepal Bhasa"],"iso639-2":"nwc","iso639-1":null},"Classical Syriac":{name:"Classical Syriac",names:["Classical Syriac"],"iso639-2":"syc","iso639-1":null},"Cook Islands Maori":{name:"Cook Islands Maori",names:["Rarotongan","Cook Islands Maori"],"iso639-2":"rar","iso639-1":null},Coptic:ur,Cornish:hr,Corsican:cr,Cree:fr,Creek:dr,"Creoles and pidgins":{name:"Creoles and pidgins",names:["Creoles and pidgins"],"iso639-2":"crp","iso639-1":null},"Creoles and pidgins, English based":{name:"Creoles and pidgins, English based",names:["Creoles and pidgins, English based"],"iso639-2":"cpe","iso639-1":null},"Creoles and pidgins, French-based":{name:"Creoles and pidgins, French-based",names:["Creoles and pidgins, French-based"],"iso639-2":"cpf","iso639-1":null},"Creoles and pidgins, Portuguese-based":{name:"Creoles and pidgins, Portuguese-based",names:["Creoles and pidgins, Portuguese-based"],"iso639-2":"cpp","iso639-1":null},"Crimean Tatar":{name:"Crimean Tatar",names:["Crimean Tatar","Crimean Turkish"],"iso639-2":"crh","iso639-1":null},"Crimean Turkish":{name:"Crimean Turkish",names:["Crimean Tatar","Crimean Turkish"],"iso639-2":"crh","iso639-1":null},Croatian:gr,"Cushitic languages":{name:"Cushitic languages",names:["Cushitic languages"],"iso639-2":"cus","iso639-1":null},Czech:pr,Dakota:vr,Danish:mr,Dargwa:_r,Delaware:yr,"Dene Suline":{name:"Dene Suline",names:["Chipewyan","Dene Suline"],"iso639-2":"chp","iso639-1":null},Dhivehi:br,Dimili:wr,Dimli:xr,Dinka:kr,Divehi:Sr,Dogri:Cr,Dogrib:Ar,"Dravidian languages":{name:"Dravidian languages",names:["Dravidian languages"],"iso639-2":"dra","iso639-1":null},Duala:Er,Dutch:Mr,"Dutch, Middle (ca.1050-1350)":{name:"Dutch, Middle (ca.1050-1350)",names:["Dutch, Middle (ca.1050-1350)"],"iso639-2":"dum","iso639-1":null},Dyula:Rr,Dzongkha:Tr,"Eastern Frisian":{name:"Eastern Frisian",names:["Eastern Frisian"],"iso639-2":"frs","iso639-1":null},Edo:Br,Efik:Or,"Egyptian (Ancient)":{name:"Egyptian (Ancient)",names:["Egyptian (Ancient)"],"iso639-2":"egy","iso639-1":null},Ekajuk:Pr,Elamite:Dr,English:Nr,"English, Middle (1100-1500)":{name:"English, Middle (1100-1500)",names:["English, Middle (1100-1500)"],"iso639-2":"enm","iso639-1":null},"English, Old (ca.450-1100)":{name:"English, Old (ca.450-1100)",names:["English, Old (ca.450-1100)"],"iso639-2":"ang","iso639-1":null},Erzya:zr,Esperanto:Fr,Estonian:Lr,Ewe:jr,Ewondo:Ir,Fang:Hr,Fanti:Vr,Faroese:Ur,Fijian:Gr,Filipino:Wr,Finnish:Kr,"Finno-Ugrian languages":{name:"Finno-Ugrian languages",names:["Finno-Ugrian languages"],"iso639-2":"fiu","iso639-1":null},Flemish:qr,Fon:Yr,French:Xr,"French, Middle (ca.1400-1600)":{name:"French, Middle (ca.1400-1600)",names:["French, Middle (ca.1400-1600)"],"iso639-2":"frm","iso639-1":null},"French, Old (842-ca.1400)":{name:"French, Old (842-ca.1400)",names:["French, Old (842-ca.1400)"],"iso639-2":"fro","iso639-1":null},Friulian:Zr,Fulah:Jr,Ga:$r,Gaelic:Qr,"Galibi Carib":{name:"Galibi Carib",names:["Galibi Carib"],"iso639-2":"car","iso639-1":null},Galician:to,Ganda:eo,Gayo:no,Gbaya:io,Geez:ao,Georgian:ro,German:oo,"German, Low":{name:"German, Low",names:["Low German","Low Saxon","German, Low","Saxon, Low"],"iso639-2":"nds","iso639-1":null},"German, Middle High (ca.1050-1500)":{name:"German, Middle High (ca.1050-1500)",names:["German, Middle High (ca.1050-1500)"],"iso639-2":"gmh","iso639-1":null},"German, Old High (ca.750-1050)":{name:"German, Old High (ca.750-1050)",names:["German, Old High (ca.750-1050)"],"iso639-2":"goh","iso639-1":null},"Germanic languages":{name:"Germanic languages",names:["Germanic languages"],"iso639-2":"gem","iso639-1":null},Gikuyu:so,Gilbertese:lo,Gondi:uo,Gorontalo:ho,Gothic:co,Grebo:fo,"Greek, Ancient (to 1453)":{name:"Greek, Ancient (to 1453)",names:["Greek, Ancient (to 1453)"],"iso639-2":"grc","iso639-1":null},"Greek, Modern (1453-)":{name:"Greek, Modern (1453-)",names:["Greek, Modern (1453-)"],"iso639-2":"gre/ell","iso639-1":"el"},Greenlandic:go,Guarani:po,Gujarati:vo,"Gwich'in":{name:"Gwich'in",names:["Gwich'in"],"iso639-2":"gwi","iso639-1":null},Haida:mo,Haitian:_o,"Haitian Creole":{name:"Haitian Creole",names:["Haitian","Haitian Creole"],"iso639-2":"hat","iso639-1":"ht"},Hausa:yo,Hawaiian:bo,Hebrew:wo,Herero:xo,Hiligaynon:ko,"Himachali languages":{name:"Himachali languages",names:["Himachali languages","Western Pahari languages"],"iso639-2":"him","iso639-1":null},Hindi:So,"Hiri Motu":{name:"Hiri Motu",names:["Hiri Motu"],"iso639-2":"hmo","iso639-1":"ho"},Hittite:Co,Hmong:Ao,Hungarian:Eo,Hupa:Mo,Iban:Ro,Icelandic:To,Ido:Bo,Igbo:Oo,"Ijo languages":{name:"Ijo languages",names:["Ijo languages"],"iso639-2":"ijo","iso639-1":null},Iloko:Po,"Imperial Aramaic (700-300 BCE)":{name:"Imperial Aramaic (700-300 BCE)",names:["Official Aramaic (700-300 BCE)","Imperial Aramaic (700-300 BCE)"],"iso639-2":"arc","iso639-1":null},"Inari Sami":{name:"Inari Sami",names:["Inari Sami"],"iso639-2":"smn","iso639-1":null},"Indic languages":{name:"Indic languages",names:["Indic languages"],"iso639-2":"inc","iso639-1":null},"Indo-European languages":{name:"Indo-European languages",names:["Indo-European languages"],"iso639-2":"ine","iso639-1":null},Indonesian:Do,Ingush:No,"Interlingua (International Auxiliary Language Association)":{name:"Interlingua (International Auxiliary Language Association)",names:["Interlingua (International Auxiliary Language Association)"],"iso639-2":"ina","iso639-1":"ia"},Interlingue:zo,Inuktitut:Fo,Inupiaq:Lo,"Iranian languages":{name:"Iranian languages",names:["Iranian languages"],"iso639-2":"ira","iso639-1":null},Irish:jo,"Irish, Middle (900-1200)":{name:"Irish, Middle (900-1200)",names:["Irish, Middle (900-1200)"],"iso639-2":"mga","iso639-1":null},"Irish, Old (to 900)":{name:"Irish, Old (to 900)",names:["Irish, Old (to 900)"],"iso639-2":"sga","iso639-1":null},"Iroquoian languages":{name:"Iroquoian languages",names:["Iroquoian languages"],"iso639-2":"iro","iso639-1":null},Italian:Io,Japanese:Ho,Javanese:Vo,Jingpho:Uo,"Judeo-Arabic":{name:"Judeo-Arabic",names:["Judeo-Arabic"],"iso639-2":"jrb","iso639-1":null},"Judeo-Persian":{name:"Judeo-Persian",names:["Judeo-Persian"],"iso639-2":"jpr","iso639-1":null},Kabardian:Go,Kabyle:Wo,Kachin:Ko,Kalaallisut:qo,Kalmyk:Yo,Kamba:Xo,Kannada:Zo,Kanuri:Jo,Kapampangan:$o,"Kara-Kalpak":{name:"Kara-Kalpak",names:["Kara-Kalpak"],"iso639-2":"kaa","iso639-1":null},"Karachay-Balkar":{name:"Karachay-Balkar",names:["Karachay-Balkar"],"iso639-2":"krc","iso639-1":null},Karelian:Qo,"Karen languages":{name:"Karen languages",names:["Karen languages"],"iso639-2":"kar","iso639-1":null},Kashmiri:ts,Kashubian:es,Kawi:ns,Kazakh:is,Khasi:as,"Khoisan languages":{name:"Khoisan languages",names:["Khoisan languages"],"iso639-2":"khi","iso639-1":null},Khotanese:rs,Kikuyu:os,Kimbundu:ss,Kinyarwanda:ls,Kirdki:us,Kirghiz:hs,Kirmanjki:cs,Klingon:fs,Komi:ds,Kongo:gs,Konkani:ps,Korean:vs,Kosraean:ms,Kpelle:_s,"Kru languages":{name:"Kru languages",names:["Kru languages"],"iso639-2":"kro","iso639-1":null},Kuanyama:ys,Kumyk:bs,Kurdish:ws,Kurukh:xs,Kutenai:ks,Kwanyama:Ss,Kyrgyz:Cs,Ladino:As,Lahnda:Es,Lamba:Ms,"Land Dayak languages":{name:"Land Dayak languages",names:["Land Dayak languages"],"iso639-2":"day","iso639-1":null},Lao:Rs,Latin:Ts,Latvian:Bs,Leonese:Os,Letzeburgesch:Ps,Lezghian:Ds,Limburgan:Ns,Limburger:zs,Limburgish:Fs,Lingala:Ls,Lithuanian:js,Lojban:Is,"Low German":{name:"Low German",names:["Low German","Low Saxon","German, Low","Saxon, Low"],"iso639-2":"nds","iso639-1":null},"Low Saxon":{name:"Low Saxon",names:["Low German","Low Saxon","German, Low","Saxon, Low"],"iso639-2":"nds","iso639-1":null},"Lower Sorbian":{name:"Lower Sorbian",names:["Lower Sorbian"],"iso639-2":"dsb","iso639-1":null},Lozi:Hs,"Luba-Katanga":{name:"Luba-Katanga",names:["Luba-Katanga"],"iso639-2":"lub","iso639-1":"lu"},"Luba-Lulua":{name:"Luba-Lulua",names:["Luba-Lulua"],"iso639-2":"lua","iso639-1":null},Luiseno:Vs,"Lule Sami":{name:"Lule Sami",names:["Lule Sami"],"iso639-2":"smj","iso639-1":null},Lunda:Us,"Luo (Kenya and Tanzania)":{name:"Luo (Kenya and Tanzania)",names:["Luo (Kenya and Tanzania)"],"iso639-2":"luo","iso639-1":null},Lushai:Gs,Luxembourgish:Ws,"Macedo-Romanian":{name:"Macedo-Romanian",names:["Aromanian","Arumanian","Macedo-Romanian"],"iso639-2":"rup","iso639-1":null},Macedonian:Ks,Madurese:qs,Magahi:Ys,Maithili:Xs,Makasar:Zs,Malagasy:Js,Malay:$s,Malayalam:Qs,Maldivian:tl,Maltese:el,Manchu:nl,Mandar:il,Mandingo:al,Manipuri:rl,"Manobo languages":{name:"Manobo languages",names:["Manobo languages"],"iso639-2":"mno","iso639-1":null},Manx:ol,Maori:sl,Mapuche:ll,Mapudungun:ul,Marathi:hl,Mari:cl,Marshallese:fl,Marwari:dl,Masai:gl,"Mayan languages":{name:"Mayan languages",names:["Mayan languages"],"iso639-2":"myn","iso639-1":null},Mende:pl,"Mi'kmaq":{name:"Mi'kmaq",names:["Mi'kmaq","Micmac"],"iso639-2":"mic","iso639-1":null},Micmac:vl,Minangkabau:ml,Mirandese:_l,Mohawk:yl,Moksha:bl,Moldavian:wl,Moldovan:xl,"Mon-Khmer languages":{name:"Mon-Khmer languages",names:["Mon-Khmer languages"],"iso639-2":"mkh","iso639-1":null},Mong:kl,Mongo:Sl,Mongolian:Cl,Montenegrin:Al,Mossi:El,"Multiple languages":{name:"Multiple languages",names:["Multiple languages"],"iso639-2":"mul","iso639-1":null},"Munda languages":{name:"Munda languages",names:["Munda languages"],"iso639-2":"mun","iso639-1":null},"N'Ko":{name:"N'Ko",names:["N'Ko"],"iso639-2":"nqo","iso639-1":null},"Nahuatl languages":{name:"Nahuatl languages",names:["Nahuatl languages"],"iso639-2":"nah","iso639-1":null},Nauru:Ml,Navaho:Rl,Navajo:Tl,"Ndebele, North":{name:"Ndebele, North",names:["Ndebele, North","North Ndebele"],"iso639-2":"nde","iso639-1":"nd"},"Ndebele, South":{name:"Ndebele, South",names:["Ndebele, South","South Ndebele"],"iso639-2":"nbl","iso639-1":"nr"},Ndonga:Bl,Neapolitan:Ol,"Nepal Bhasa":{name:"Nepal Bhasa",names:["Nepal Bhasa","Newari"],"iso639-2":"new","iso639-1":null},Nepali:Pl,Newari:Dl,Nias:Nl,"Niger-Kordofanian languages":{name:"Niger-Kordofanian languages",names:["Niger-Kordofanian languages"],"iso639-2":"nic","iso639-1":null},"Nilo-Saharan languages":{name:"Nilo-Saharan languages",names:["Nilo-Saharan languages"],"iso639-2":"ssa","iso639-1":null},Niuean:zl,"No linguistic content":{name:"No linguistic content",names:["No linguistic content","Not applicable"],"iso639-2":"zxx","iso639-1":null},Nogai:Fl,"Norse, Old":{name:"Norse, Old",names:["Norse, Old"],"iso639-2":"non","iso639-1":null},"North American Indian languages":{name:"North American Indian languages",names:["North American Indian languages"],"iso639-2":"nai","iso639-1":null},"North Ndebele":{name:"North Ndebele",names:["Ndebele, North","North Ndebele"],"iso639-2":"nde","iso639-1":"nd"},"Northern Frisian":{name:"Northern Frisian",names:["Northern Frisian"],"iso639-2":"frr","iso639-1":null},"Northern Sami":{name:"Northern Sami",names:["Northern Sami"],"iso639-2":"sme","iso639-1":"se"},"Northern Sotho":{name:"Northern Sotho",names:["Pedi","Sepedi","Northern Sotho"],"iso639-2":"nso","iso639-1":null},Norwegian:Ll,"Norwegian Bokml":{name:"Norwegian Bokml",names:["Bokml, Norwegian","Norwegian Bokml"],"iso639-2":"nob","iso639-1":"nb"},"Norwegian Nynorsk":{name:"Norwegian Nynorsk",names:["Norwegian Nynorsk","Nynorsk, Norwegian"],"iso639-2":"nno","iso639-1":"nn"},"Not applicable":{name:"Not applicable",names:["No linguistic content","Not applicable"],"iso639-2":"zxx","iso639-1":null},"Nubian languages":{name:"Nubian languages",names:["Nubian languages"],"iso639-2":"nub","iso639-1":null},Nuosu:jl,Nyamwezi:Il,Nyanja:Hl,Nyankole:Vl,"Nynorsk, Norwegian":{name:"Nynorsk, Norwegian",names:["Norwegian Nynorsk","Nynorsk, Norwegian"],"iso639-2":"nno","iso639-1":"nn"},Nyoro:Ul,Nzima:Gl,Occidental:Wl,"Occitan (post 1500)":{name:"Occitan (post 1500)",names:["Occitan (post 1500)"],"iso639-2":"oci","iso639-1":"oc"},"Occitan, Old (to 1500)":{name:"Occitan, Old (to 1500)",names:["Provenal, Old (to 1500)","Occitan, Old (to 1500)"],"iso639-2":"pro","iso639-1":null},"Official Aramaic (700-300 BCE)":{name:"Official Aramaic (700-300 BCE)",names:["Official Aramaic (700-300 BCE)","Imperial Aramaic (700-300 BCE)"],"iso639-2":"arc","iso639-1":null},Oirat:Kl,Ojibwa:ql,"Old Bulgarian":{name:"Old Bulgarian",names:["Church Slavic","Old Slavonic","Church Slavonic","Old Bulgarian","Old Church Slavonic"],"iso639-2":"chu","iso639-1":"cu"},"Old Church Slavonic":{name:"Old Church Slavonic",names:["Church Slavic","Old Slavonic","Church Slavonic","Old Bulgarian","Old Church Slavonic"],"iso639-2":"chu","iso639-1":"cu"},"Old Newari":{name:"Old Newari",names:["Classical Newari","Old Newari","Classical Nepal Bhasa"],"iso639-2":"nwc","iso639-1":null},"Old Slavonic":{name:"Old Slavonic",names:["Church Slavic","Old Slavonic","Church Slavonic","Old Bulgarian","Old Church Slavonic"],"iso639-2":"chu","iso639-1":"cu"},Oriya:Yl,Oromo:Xl,Osage:Zl,Ossetian:Jl,Ossetic:$l,"Otomian languages":{name:"Otomian languages",names:["Otomian languages"],"iso639-2":"oto","iso639-1":null},Pahlavi:Ql,Palauan:tu,Pali:eu,Pampanga:nu,Pangasinan:iu,Panjabi:au,Papiamento:ru,"Papuan languages":{name:"Papuan languages",names:["Papuan languages"],"iso639-2":"paa","iso639-1":null},Pashto:ou,Pedi:su,Persian:lu,"Persian, Old (ca.600-400 B.C.)":{name:"Persian, Old (ca.600-400 B.C.)",names:["Persian, Old (ca.600-400 B.C.)"],"iso639-2":"peo","iso639-1":null},"Philippine languages":{name:"Philippine languages",names:["Philippine languages"],"iso639-2":"phi","iso639-1":null},Phoenician:uu,Pilipino:hu,Pohnpeian:cu,Polish:fu,Portuguese:du,"Prakrit languages":{name:"Prakrit languages",names:["Prakrit languages"],"iso639-2":"pra","iso639-1":null},"Provenal, Old (to 1500)":{name:"Provenal, Old (to 1500)",names:["Provenal, Old (to 1500)","Occitan, Old (to 1500)"],"iso639-2":"pro","iso639-1":null},Punjabi:gu,Pushto:pu,Quechua:vu,Rajasthani:mu,Rapanui:_u,Rarotongan:yu,"Reserved for local use":{name:"Reserved for local use",names:["Reserved for local use"],"iso639-2":"qaa-qtz","iso639-1":null},"Romance languages":{name:"Romance languages",names:["Romance languages"],"iso639-2":"roa","iso639-1":null},Romanian:bu,Romansh:wu,Romany:xu,Rundi:ku,Russian:Su,Sakan:Cu,"Salishan languages":{name:"Salishan languages",names:["Salishan languages"],"iso639-2":"sal","iso639-1":null},"Samaritan Aramaic":{name:"Samaritan Aramaic",names:["Samaritan Aramaic"],"iso639-2":"sam","iso639-1":null},"Sami languages":{name:"Sami languages",names:["Sami languages"],"iso639-2":"smi","iso639-1":null},Samoan:Au,Sandawe:Eu,Sango:Mu,Sanskrit:Ru,Santali:Tu,Sardinian:Bu,Sasak:Ou,"Saxon, Low":{name:"Saxon, Low",names:["Low German","Low Saxon","German, Low","Saxon, Low"],"iso639-2":"nds","iso639-1":null},Scots:Pu,"Scottish Gaelic":{name:"Scottish Gaelic",names:["Gaelic","Scottish Gaelic"],"iso639-2":"gla","iso639-1":"gd"},Selkup:Du,"Semitic languages":{name:"Semitic languages",names:["Semitic languages"],"iso639-2":"sem","iso639-1":null},Sepedi:Nu,Serbian:zu,Serer:Fu,Shan:Lu,Shona:ju,"Sichuan Yi":{name:"Sichuan Yi",names:["Sichuan Yi","Nuosu"],"iso639-2":"iii","iso639-1":"ii"},Sicilian:Iu,Sidamo:Hu,"Sign Languages":{name:"Sign Languages",names:["Sign Languages"],"iso639-2":"sgn","iso639-1":null},Siksika:Vu,Sindhi:Uu,Sinhala:Gu,Sinhalese:Wu,"Sino-Tibetan languages":{name:"Sino-Tibetan languages",names:["Sino-Tibetan languages"],"iso639-2":"sit","iso639-1":null},"Siouan languages":{name:"Siouan languages",names:["Siouan languages"],"iso639-2":"sio","iso639-1":null},"Skolt Sami":{name:"Skolt Sami",names:["Skolt Sami"],"iso639-2":"sms","iso639-1":null},"Slave (Athapascan)":{name:"Slave (Athapascan)",names:["Slave (Athapascan)"],"iso639-2":"den","iso639-1":null},"Slavic languages":{name:"Slavic languages",names:["Slavic languages"],"iso639-2":"sla","iso639-1":null},Slovak:Ku,Slovenian:qu,Sogdian:Yu,Somali:Xu,"Songhai languages":{name:"Songhai languages",names:["Songhai languages"],"iso639-2":"son","iso639-1":null},Soninke:Zu,"Sorbian languages":{name:"Sorbian languages",names:["Sorbian languages"],"iso639-2":"wen","iso639-1":null},"Sotho, Northern":{name:"Sotho, Northern",names:["Pedi","Sepedi","Northern Sotho"],"iso639-2":"nso","iso639-1":null},"Sotho, Southern":{name:"Sotho, Southern",names:["Sotho, Southern"],"iso639-2":"sot","iso639-1":"st"},"South American Indian languages":{name:"South American Indian languages",names:["South American Indian languages"],"iso639-2":"sai","iso639-1":null},"South Ndebele":{name:"South Ndebele",names:["Ndebele, South","South Ndebele"],"iso639-2":"nbl","iso639-1":"nr"},"Southern Altai":{name:"Southern Altai",names:["Southern Altai"],"iso639-2":"alt","iso639-1":null},"Southern Sami":{name:"Southern Sami",names:["Southern Sami"],"iso639-2":"sma","iso639-1":null},Spanish:Ju,"Sranan Tongo":{name:"Sranan Tongo",names:["Sranan Tongo"],"iso639-2":"srn","iso639-1":null},"Standard Moroccan Tamazight":{name:"Standard Moroccan Tamazight",names:["Standard Moroccan Tamazight"],"iso639-2":"zgh","iso639-1":null},Sukuma:$u,Sumerian:Qu,Sundanese:th,Susu:eh,Swahili:nh,Swati:ih,Swedish:ah,"Swiss German":{name:"Swiss German",names:["Swiss German","Alemannic","Alsatian"],"iso639-2":"gsw","iso639-1":null},Syriac:rh,Tagalog:oh,Tahitian:sh,"Tai languages":{name:"Tai languages",names:["Tai languages"],"iso639-2":"tai","iso639-1":null},Tajik:lh,Tamashek:uh,Tamil:hh,Tatar:ch,Telugu:fh,Tereno:dh,Tetum:gh,Thai:ph,Tibetan:vh,Tigre:mh,Tigrinya:_h,Timne:yh,Tiv:bh,"tlhIngan-Hol":{name:"tlhIngan-Hol",names:["Klingon","tlhIngan-Hol"],"iso639-2":"tlh","iso639-1":null},Tlingit:wh,"Tok Pisin":{name:"Tok Pisin",names:["Tok Pisin"],"iso639-2":"tpi","iso639-1":null},Tokelau:xh,"Tonga (Nyasa)":{name:"Tonga (Nyasa)",names:["Tonga (Nyasa)"],"iso639-2":"tog","iso639-1":null},"Tonga (Tonga Islands)":{name:"Tonga (Tonga Islands)",names:["Tonga (Tonga Islands)"],"iso639-2":"ton","iso639-1":"to"},Tsimshian:kh,Tsonga:Sh,Tswana:Ch,Tumbuka:Ah,"Tupi languages":{name:"Tupi languages",names:["Tupi languages"],"iso639-2":"tup","iso639-1":null},Turkish:Eh,"Turkish, Ottoman (1500-1928)":{name:"Turkish, Ottoman (1500-1928)",names:["Turkish, Ottoman (1500-1928)"],"iso639-2":"ota","iso639-1":null},Turkmen:Mh,Tuvalu:Rh,Tuvinian:Th,Twi:Bh,Udmurt:Oh,Ugaritic:Ph,Uighur:Dh,Ukrainian:Nh,Umbundu:zh,"Uncoded languages":{name:"Uncoded languages",names:["Uncoded languages"],"iso639-2":"mis","iso639-1":null},Undetermined:Fh,"Upper Sorbian":{name:"Upper Sorbian",names:["Upper Sorbian"],"iso639-2":"hsb","iso639-1":null},Urdu:Lh,Uyghur:jh,Uzbek:Ih,Vai:Hh,Valencian:Vh,Venda:Uh,Vietnamese:Gh,"Volapk":{name:"Volapk",names:["Volapk"],"iso639-2":"vol","iso639-1":"vo"},Votic:Wh,"Wakashan languages":{name:"Wakashan languages",names:["Wakashan languages"],"iso639-2":"wak","iso639-1":null},Walloon:Kh,Waray:qh,Washo:Yh,Welsh:Xh,"Western Frisian":{name:"Western Frisian",names:["Western Frisian"],"iso639-2":"fry","iso639-1":"fy"},"Western Pahari languages":{name:"Western Pahari languages",names:["Himachali languages","Western Pahari languages"],"iso639-2":"him","iso639-1":null},Wolaitta:Zh,Wolaytta:Jh,Wolof:$h,Xhosa:Qh,Yakut:tc,Yao:ec,Yapese:nc,Yiddish:ic,Yoruba:ac,"Yupik languages":{name:"Yupik languages",names:["Yupik languages"],"iso639-2":"ypk","iso639-1":null},"Zande languages":{name:"Zande languages",names:["Zande languages"],"iso639-2":"znd","iso639-1":null},Zapotec:rc,Zaza:oc,Zazaki:sc,Zenaga:lc,Zhuang:uc,Zulu:hc,Zuni:cc};function dc(t,e,n){if(e in t){Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true})}else{t[e]=n}return t}var gc=[];var pc=Object.keys(fc);Object.keys(Fi).map(function(t){var e=Fi[t];var n=pc.find(function(t){return t.toLowerCase()===e.language.toLowerCase()});if(e.location&&n){var i;gc.push((i={},dc(i,"name",e.language),dc(i,"location",e.location),dc(i,"tag",e.tag),dc(i,"lcid",e.id),dc(i,"iso639-2",fc[n]["iso639-2"]),dc(i,"iso639-1",fc[n]["iso639-1"]),i))}});var vc={ar:"ar-SA",ca:"ca-ES",da:"da-DK",en:"en-US",ko:"ko-KR",pa:"pa-IN",pt:"pt-BR",sv:"sv-SE"};function mc(e){if(typeof e!=="string"||e.length===5)return e;if(vc[e])return vc[e];var t=gc.filter(function(t){return t["iso639-1"]===e});if(!t.length)return e;else if(t.length===1)return t[0].tag;else if(t.find(function(t){return t.tag==="".concat(e,"-").concat(e.toUpperCase())}))return"".concat(e,"-").concat(e.toUpperCase());else return t[0].tag}function _c(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}function yc(){return"".concat(_c()).concat(_c(),"-").concat(_c(),"-").concat(_c(),"-").concat(_c(),"-").concat(_c()).concat(_c()).concat(_c())}var bc="D3PLUS-COMMON-RESET";var wc={and:"y",Back:"Atrs","Click to Expand":"Clic para Ampliar","Click to Hide":"Clic para Ocultar","Click to Highlight":"Clic para Resaltar","Click to Reset":"Clic para Restablecer",Download:"Descargar","Loading Visualization":"Cargando Visualizacin","No Data Available":"Datos No Disponibles","Powered by D3plus":"Funciona con D3plus",Share:"Porcentaje","Shift+Click to Hide":"Mays+Clic para Ocultar",Total:"Total",Values:"Valores"};var xc={"es-ES":wc};function kc(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function Sc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function Cc(t,e,n){if(e)Sc(t.prototype,e);if(n)Sc(t,n);return t}function Ac(t,e){if(v(t)){for(var n in t){if({}.hasOwnProperty.call(t,n)&&!n.startsWith("_")){var i=e&&v(e)?e[n]:undefined;if(t[n]===bc){if(i)t[n]=i;else delete t[n]}else if(v(t[n])){Ac(t[n],i)}}}}}function Ec(t){var e=[];do{e=e.concat(Object.getOwnPropertyNames(t));t=Object.getPrototypeOf(t)}while(t&&t!==Object.prototype);return e.filter(function(t){return t.indexOf("_")!==0&&!["config","constructor","render"].includes(t)})}var Mc=function(){function t(){var i=this;kc(this,t);this._locale="en-US";this._on={};this._translate=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:i._locale;var n=xc[e];return n&&n[t]?n[t]:t};this._uuid=yc()}Cc(t,[{key:"config",value:function n(t){var i=this;if(!this._configDefault){var n={};Ec(this.__proto__).forEach(function(t){var e=i[t]();n[t]=v(e)?gt({},e):e});this._configDefault=n}if(arguments.length){for(var e in t){if({}.hasOwnProperty.call(t,e)&&e in this){var a=t[e];if(a===bc){if(e==="on")this._on=this._configDefault[e];else this[e](this._configDefault[e])}else{Ac(a,this._configDefault[e]);this[e](a)}}}return this}else{var r={};Ec(this.__proto__).forEach(function(t){r[t]=i[t]()});return r}}},{key:"locale",value:function t(e){return arguments.length?(this._locale=mc(e),this):this._locale}},{key:"on",value:function t(e,n){return arguments.length===2?(this._on[e]=n,this):arguments.length?typeof e==="string"?this._on[e]:(this._on=Object.assign({},this._on,e),this):this._on}},{key:"translate",value:function t(e){return arguments.length?(this._translate=e,this):this._translate}},{key:"shapeConfig",value:function t(e){return arguments.length?(this._shapeConfig=gt(this._shapeConfig,e),this):this._shapeConfig}}]);return t}();function Rc(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!t||!(t instanceof Array)||!t.length)return undefined;return t.reduce(function(t,e){return Math.abs(e-n)<Math.abs(t-n)?e:t})}function Tc(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){Tc=function t(e){return ie(e)}}else{Tc=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return Tc(t)}function Bc(){var r=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._shapeConfig;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"shape";var e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var n={duration:this._duration,on:{}};var o=function t(a){return function(t,e,n){var i;while(t.__d3plus__){if(i)t.__d3plusParent__=i;i=t;e=t.i;t=t.data||t.feature}return a.bind(r)(t,e,n||i)}};var s=function t(e,n){for(var i in n){if({}.hasOwnProperty.call(n,i)&&!i.includes(".")||i.includes(".".concat(a))){e.on[i]=o(n[i])}}};var l=function e(t){return t.map(function(t){if(t instanceof Array)return e(t);else if(Tc(t)==="object")return i({},t);else if(typeof t==="function")return o(t);else return t})};var i=function t(e,n){for(var i in n){if({}.hasOwnProperty.call(n,i)){if(i==="on")s(e,n[i]);else if(typeof n[i]==="function"){e[i]=o(n[i])}else if(n[i]instanceof Array){e[i]=l(n[i])}else if(Tc(n[i])==="object"){e[i]={on:{}};t(e[i],n[i])}else e[i]=n[i]}}};i(n,t);if(this._on)s(n,this._on);if(e&&t[e]){i(n,t[e]);if(t[e].on)s(n,t[e].on)}return n}function Oc(e){return function t(){return e}}var Pc="http://www.w3.org/1999/xhtml";var Dc={svg:"http://www.w3.org/2000/svg",xhtml:Pc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Nc(t){var e=t+="",n=e.indexOf(":");if(n>=0&&(e=t.slice(0,n))!=="xmlns")t=t.slice(n+1);return Dc.hasOwnProperty(e)?{space:Dc[e],local:t}:t}function zc(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===Pc&&t.documentElement.namespaceURI===Pc?t.createElement(n):t.createElementNS(e,n)}}function Fc(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Lc(t){var e=Nc(t);return(e.local?Fc:zc)(e)}function jc(){}function Ic(t){return t==null?jc:function(){return this.querySelector(t)}}function Hc(t){if(typeof t!=="function")t=Ic(t);for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a){for(var r=e[a],o=r.length,s=i[a]=new Array(o),l,u,h=0;h<o;++h){if((l=r[h])&&(u=t.call(l,l.__data__,h,r))){if("__data__"in l)u.__data__=l.__data__;s[h]=u}}}return new xd(i,this._parents)}function Vc(){return[]}function Uc(t){return t==null?Vc:function(){return this.querySelectorAll(t)}}function Gc(t){if(typeof t!=="function")t=Uc(t);for(var e=this._groups,n=e.length,i=[],a=[],r=0;r<n;++r){for(var o=e[r],s=o.length,l,u=0;u<s;++u){if(l=o[u]){i.push(t.call(l,l.__data__,u,o));a.push(l)}}}return new xd(i,a)}function Wc(t){return function(){return this.matches(t)}}function Kc(t){if(typeof t!=="function")t=Wc(t);for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a){for(var r=e[a],o=r.length,s=i[a]=[],l,u=0;u<o;++u){if((l=r[u])&&t.call(l,l.__data__,u,r)){s.push(l)}}}return new xd(i,this._parents)}function qc(t){return new Array(t.length)}function Yc(){return new xd(this._enter||this._groups.map(qc),this._parents)}function Xc(t,e){this.ownerDocument=t.ownerDocument;this.namespaceURI=t.namespaceURI;this._next=null;this._parent=t;this.__data__=e}Xc.prototype={constructor:Xc,appendChild:function t(e){return this._parent.insertBefore(e,this._next)},insertBefore:function t(e,n){return this._parent.insertBefore(e,n)},querySelector:function t(e){return this._parent.querySelector(e)},querySelectorAll:function t(e){return this._parent.querySelectorAll(e)}};function Zc(t){return function(){return t}}var Jc="$";function $c(t,e,n,i,a,r){var o=0,s,l=e.length,u=r.length;for(;o<u;++o){if(s=e[o]){s.__data__=r[o];i[o]=s}else{n[o]=new Xc(t,r[o])}}for(;o<l;++o){if(s=e[o]){a[o]=s}}}function Qc(t,e,n,i,a,r,o){var s,l,u={},h=e.length,c=r.length,f=new Array(h),d;for(s=0;s<h;++s){if(l=e[s]){f[s]=d=Jc+o.call(l,l.__data__,s,e);if(d in u){a[s]=l}else{u[d]=l}}}for(s=0;s<c;++s){d=Jc+o.call(t,r[s],s,r);if(l=u[d]){i[s]=l;l.__data__=r[s];u[d]=null}else{n[s]=new Xc(t,r[s])}}for(s=0;s<h;++s){if((l=e[s])&&u[f[s]]===l){a[s]=l}}}function tf(t,e){if(!t){d=new Array(this.size()),u=-1;this.each(function(t){d[++u]=t});return d}var n=e?Qc:$c,i=this._parents,a=this._groups;if(typeof t!=="function")t=Zc(t);for(var r=a.length,o=new Array(r),s=new Array(r),l=new Array(r),u=0;u<r;++u){var h=i[u],c=a[u],f=c.length,d=t.call(h,h&&h.__data__,u,i),g=d.length,p=s[u]=new Array(g),v=o[u]=new Array(g),m=l[u]=new Array(f);n(h,c,p,v,m,d,e);for(var _=0,y=0,b,w;_<g;++_){if(b=p[_]){if(_>=y)y=_+1;while(!(w=v[y])&&++y<g){}b._next=w||null}}}o=new xd(o,i);o._enter=s;o._exit=l;return o}function ef(){return new xd(this._exit||this._groups.map(qc),this._parents)}function nf(t,e,n){var i=this.enter(),a=this,r=this.exit();i=typeof t==="function"?t(i):i.append(t+"");if(e!=null)a=e(a);if(n==null)r.remove();else n(r);return i&&a?i.merge(a).order():a}function af(t){for(var e=this._groups,n=t._groups,i=e.length,a=n.length,r=Math.min(i,a),o=new Array(i),s=0;s<r;++s){for(var l=e[s],u=n[s],h=l.length,c=o[s]=new Array(h),f,d=0;d<h;++d){if(f=l[d]||u[d]){c[d]=f}}}for(;s<i;++s){o[s]=e[s]}return new xd(o,this._parents)}function rf(){for(var t=this._groups,e=-1,n=t.length;++e<n;){for(var i=t[e],a=i.length-1,r=i[a],o;--a>=0;){if(o=i[a]){if(r&&o.compareDocumentPosition(r)^4)r.parentNode.insertBefore(o,r);r=o}}}return this}function of(n){if(!n)n=sf;function t(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}for(var e=this._groups,i=e.length,a=new Array(i),r=0;r<i;++r){for(var o=e[r],s=o.length,l=a[r]=new Array(s),u,h=0;h<s;++h){if(u=o[h]){l[h]=u}}l.sort(t)}return new xd(a,this._parents).order()}function sf(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function lf(){var t=arguments[0];arguments[0]=this;t.apply(null,arguments);return this}function uf(){var t=new Array(this.size()),e=-1;this.each(function(){t[++e]=this});return t}function hf(){for(var t=this._groups,e=0,n=t.length;e<n;++e){for(var i=t[e],a=0,r=i.length;a<r;++a){var o=i[a];if(o)return o}}return null}function cf(){var t=0;this.each(function(){++t});return t}function ff(){return!this.node()}function df(t){for(var e=this._groups,n=0,i=e.length;n<i;++n){for(var a=e[n],r=0,o=a.length,s;r<o;++r){if(s=a[r])t.call(s,s.__data__,r,a)}}return this}function gf(t){return function(){this.removeAttribute(t)}}function pf(t){return function(){this.removeAttributeNS(t.space,t.local)}}function vf(t,e){return function(){this.setAttribute(t,e)}}function mf(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _f(e,n){return function(){var t=n.apply(this,arguments);if(t==null)this.removeAttribute(e);else this.setAttribute(e,t)}}function yf(e,n){return function(){var t=n.apply(this,arguments);if(t==null)this.removeAttributeNS(e.space,e.local);else this.setAttributeNS(e.space,e.local,t)}}function bf(t,e){var n=Nc(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?pf:gf:typeof e==="function"?n.local?yf:_f:n.local?mf:vf)(n,e))}function wf(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function xf(t){return function(){this.style.removeProperty(t)}}function kf(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Sf(e,n,i){return function(){var t=n.apply(this,arguments);if(t==null)this.style.removeProperty(e);else this.style.setProperty(e,t,i)}}function Cf(t,e,n){return arguments.length>1?this.each((e==null?xf:typeof e==="function"?Sf:kf)(t,e,n==null?"":n)):Af(this.node(),t)}function Af(t,e){return t.style.getPropertyValue(e)||wf(t).getComputedStyle(t,null).getPropertyValue(e)}function Ef(t){return function(){delete this[t]}}function Mf(t,e){return function(){this[t]=e}}function Rf(e,n){return function(){var t=n.apply(this,arguments);if(t==null)delete this[e];else this[e]=t}}function Tf(t,e){return arguments.length>1?this.each((e==null?Ef:typeof e==="function"?Rf:Mf)(t,e)):this.node()[t]}function Bf(t){return t.trim().split(/^|\s+/)}function Of(t){return t.classList||new Pf(t)}function Pf(t){this._node=t;this._names=Bf(t.getAttribute("class")||"")}Pf.prototype={add:function t(e){var n=this._names.indexOf(e);if(n<0){this._names.push(e);this._node.setAttribute("class",this._names.join(" "))}},remove:function t(e){var n=this._names.indexOf(e);if(n>=0){this._names.splice(n,1);this._node.setAttribute("class",this._names.join(" "))}},contains:function t(e){return this._names.indexOf(e)>=0}};function Df(t,e){var n=Of(t),i=-1,a=e.length;while(++i<a){n.add(e[i])}}function Nf(t,e){var n=Of(t),i=-1,a=e.length;while(++i<a){n.remove(e[i])}}function zf(t){return function(){Df(this,t)}}function Ff(t){return function(){Nf(this,t)}}function Lf(t,e){return function(){(e.apply(this,arguments)?Df:Nf)(this,t)}}function jf(t,e){var n=Bf(t+"");if(arguments.length<2){var i=Of(this.node()),a=-1,r=n.length;while(++a<r){if(!i.contains(n[a]))return false}return true}return this.each((typeof e==="function"?Lf:e?zf:Ff)(n,e))}function If(){this.textContent=""}function Hf(t){return function(){this.textContent=t}}function Vf(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function Uf(t){return arguments.length?this.each(t==null?If:(typeof t==="function"?Vf:Hf)(t)):this.node().textContent}function Gf(){this.innerHTML=""}function Wf(t){return function(){this.innerHTML=t}}function Kf(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function qf(t){return arguments.length?this.each(t==null?Gf:(typeof t==="function"?Kf:Wf)(t)):this.node().innerHTML}function Yf(){if(this.nextSibling)this.parentNode.appendChild(this)}function Xf(){return this.each(Yf)}function Zf(){if(this.previousSibling)this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Jf(){return this.each(Zf)}function $f(t){var e=typeof t==="function"?t:Lc(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Qf(){return null}function td(t,e){var n=typeof t==="function"?t:Lc(t),i=e==null?Qf:typeof e==="function"?e:Ic(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function ed(){var t=this.parentNode;if(t)t.removeChild(this)}function nd(){return this.each(ed)}function id(){var t=this.cloneNode(false),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ad(){var t=this.cloneNode(true),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rd(t){return this.select(t?ad:id)}function od(t){return arguments.length?this.property("__data__",t):this.node().__data__}var sd={};var ld=null;if(typeof document!=="undefined"){var ud=document.documentElement;if(!("onmouseenter"in ud)){sd={mouseenter:"mouseover",mouseleave:"mouseout"}}}function hd(n,t,e){n=cd(n,t,e);return function(t){var e=t.relatedTarget;if(!e||e!==this&&!(e.compareDocumentPosition(this)&8)){n.call(this,t)}}}function cd(n,i,a){return function(t){var e=ld;ld=t;try{n.call(this,this.__data__,i,a)}finally{ld=e}}}function fd(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0)e=t.slice(n+1),t=t.slice(0,n);return{type:t,name:e}})}function dd(r){return function(){var t=this.__on;if(!t)return;for(var e=0,n=-1,i=t.length,a;e<i;++e){if(a=t[e],(!r.type||a.type===r.type)&&a.name===r.name){this.removeEventListener(a.type,a.listener,a.capture)}else{t[++n]=a}}if(++n)t.length=n;else delete this.__on}}function gd(l,u,h){var c=sd.hasOwnProperty(l.type)?hd:cd;return function(t,e,n){var i=this.__on,a,r=c(u,e,n);if(i)for(var o=0,s=i.length;o<s;++o){if((a=i[o]).type===l.type&&a.name===l.name){this.removeEventListener(a.type,a.listener,a.capture);this.addEventListener(a.type,a.listener=r,a.capture=h);a.value=u;return}}this.addEventListener(l.type,r,h);a={type:l.type,name:l.name,value:u,listener:r,capture:h};if(!i)this.__on=[a];else i.push(a)}}function pd(t,e,n){var i=fd(t+""),a,r=i.length,o;if(arguments.length<2){var s=this.node().__on;if(s)for(var l=0,u=s.length,h;l<u;++l){for(a=0,h=s[l];a<r;++a){if((o=i[a]).type===h.type&&o.name===h.name){return h.value}}}return}s=e?gd:dd;if(n==null)n=false;for(a=0;a<r;++a){this.each(s(i[a],e,n))}return this}function vd(t,e,n,i){var a=ld;t.sourceEvent=ld;ld=t;try{return e.apply(n,i)}finally{ld=a}}function md(t,e,n){var i=wf(t),a=i.CustomEvent;if(typeof a==="function"){a=new a(e,n)}else{a=i.document.createEvent("Event");if(n)a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail;else a.initEvent(e,false,false)}t.dispatchEvent(a)}function _d(t,e){return function(){return md(this,t,e)}}function yd(t,e){return function(){return md(this,t,e.apply(this,arguments))}}function bd(t,e){return this.each((typeof e==="function"?yd:_d)(t,e))}var wd=[null];function xd(t,e){this._groups=t;this._parents=e}function kd(){return new xd([[document.documentElement]],wd)}xd.prototype=kd.prototype={constructor:xd,select:Hc,selectAll:Gc,filter:Kc,data:tf,enter:Yc,exit:ef,join:nf,merge:af,order:rf,sort:of,call:lf,nodes:uf,node:hf,size:cf,empty:ff,each:df,attr:bf,style:Cf,property:Tf,classed:jf,text:Uf,html:qf,raise:Xf,lower:Jf,append:$f,insert:td,remove:nd,clone:rd,datum:od,on:pd,dispatch:bd};function Sd(t){return typeof t==="string"?new xd([[document.querySelector(t)]],[document.documentElement]):new xd([[t]],wd)}function Cd(){var t=ld,e;while(e=t.sourceEvent){t=e}return t}function Ad(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();i.x=e.clientX,i.y=e.clientY;i=i.matrixTransform(t.getScreenCTM().inverse());return[i.x,i.y]}var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}function Ed(t){var e=Cd();if(e.changedTouches)e=e.changedTouches[0];return Ad(t,e)}function Md(t){return typeof t==="string"?new xd([document.querySelectorAll(t)],[document.documentElement]):new xd([t==null?[]:t],wd)}function Rd(t,e,n){if(arguments.length<3)n=e,e=Cd().changedTouches;for(var i=0,a=e?e.length:0,r;i<a;++i){if((r=e[i]).identifier===n){return Ad(t,r)}}return null}var Td={value:function t(){}};function Bd(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Od(n)}function Od(t){this._=t}function Pd(t,i){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0)e=t.slice(n+1),t=t.slice(0,n);if(t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})}Od.prototype=Bd.prototype={constructor:Od,on:function t(e,n){var i=this._,a=Pd(e+"",i),r,o=-1,s=a.length;if(arguments.length<2){while(++o<s){if((r=(e=a[o]).type)&&(r=Dd(i[r],e.name)))return r}return}if(n!=null&&typeof n!=="function")throw new Error("invalid callback: "+n);while(++o<s){if(r=(e=a[o]).type)i[r]=Nd(i[r],e.name,n);else if(n==null)for(r in i){i[r]=Nd(i[r],e.name,null)}}return this},copy:function t(){var t={},e=this._;for(var n in e){t[n]=e[n].slice()}return new Od(t)},call:function t(e,n){if((r=arguments.length-2)>0)for(var i=new Array(r),a=0,r,o;a<r;++a){i[a]=arguments[a+2]}if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],a=0,r=o.length;a<r;++a){o[a].value.apply(n,i)}},apply:function t(e,n,i){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],r=0,o=a.length;r<o;++r){a[r].value.apply(n,i)}}};function Dd(t,e){for(var n=0,i=t.length,a;n<i;++n){if((a=t[n]).name===e){return a.value}}}function Nd(t,e,n){for(var i=0,a=t.length;i<a;++i){if(t[i].name===e){t[i]=Td,t=t.slice(0,i).concat(t.slice(i+1));break}}if(n!=null)t.push({name:e,value:n});return t}var zd=0,Fd=0,Ld=0,jd=1e3,Id,Hd,Vd=0,Ud=0,Gd=0,Wd=(typeof performance==="undefined"?"undefined":ie(performance))==="object"&&performance.now?performance:Date,Kd=(typeof window==="undefined"?"undefined":ie(window))==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function qd(){return Ud||(Kd(Yd),Ud=Wd.now()+Gd)}function Yd(){Ud=0}function Xd(){this._call=this._time=this._next=null}Xd.prototype=Zd.prototype={constructor:Xd,restart:function t(e,n,i){if(typeof e!=="function")throw new TypeError("callback is not a function");i=(i==null?qd():+i)+(n==null?0:+n);if(!this._next&&Hd!==this){if(Hd)Hd._next=this;else Id=this;Hd=this}this._call=e;this._time=i;eg()},stop:function t(){if(this._call){this._call=null;this._time=Infinity;eg()}}};function Zd(t,e,n){var i=new Xd;i.restart(t,e,n);return i}function Jd(){qd();++zd;var t=Id,e;while(t){if((e=Ud-t._time)>=0)t._call.call(null,e);t=t._next}--zd}function $d(){Ud=(Vd=Wd.now())+Gd;zd=Fd=0;try{Jd()}finally{zd=0;tg();Ud=0}}function Qd(){var t=Wd.now(),e=t-Vd;if(e>jd)Gd-=e,Vd=t}function tg(){var t,e=Id,n,i=Infinity;while(e){if(e._call){if(i>e._time)i=e._time;t=e,e=e._next}else{n=e._next,e._next=null;e=t?t._next=n:Id=n}}Hd=t;eg(i)}function eg(t){if(zd)return;if(Fd)Fd=clearTimeout(Fd);var e=t-Ud;if(e>24){if(t<Infinity)Fd=setTimeout($d,t-Wd.now()-Gd);if(Ld)Ld=clearInterval(Ld)}else{if(!Ld)Vd=Wd.now(),Ld=setInterval(Qd,jd);zd=1,Kd($d)}}function ng(e,n,t){var i=new Xd;n=n==null?0:+n;i.restart(function(t){i.stop();e(t+n)},n,t);return i}var ig=Bd("start","end","cancel","interrupt");var ag=[];var rg=0;var og=1;var sg=2;var lg=3;var ug=4;var hg=5;var cg=6;function fg(t,e,n,i,a,r){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;vg(t,n,{name:e,index:i,group:a,on:ig,tween:ag,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:rg})}function dg(t,e){var n=pg(t,e);if(n.state>rg)throw new Error("too late; already scheduled");return n}function gg(t,e){var n=pg(t,e);if(n.state>lg)throw new Error("too late; already running");return n}function pg(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function vg(r,o,s){var l=r.__transition,u;l[o]=s;s.timer=Zd(t,0,s.time);function t(t){s.state=og;s.timer.restart(h,s.delay,s.time);if(s.delay<=t)h(t-s.delay)}function h(t){var e,n,i,a;if(s.state!==og)return f();for(e in l){a=l[e];if(a.name!==s.name)continue;if(a.state===lg)return ng(h);if(a.state===ug){a.state=cg;a.timer.stop();a.on.call("interrupt",r,r.__data__,a.index,a.group);delete l[e]}else if(+e<o){a.state=cg;a.timer.stop();a.on.call("cancel",r,r.__data__,a.index,a.group);delete l[e]}}ng(function(){if(s.state===lg){s.state=ug;s.timer.restart(c,s.delay,s.time);c(t)}});s.state=sg;s.on.call("start",r,r.__data__,s.index,s.group);if(s.state!==sg)return;s.state=lg;u=new Array(i=s.tween.length);for(e=0,n=-1;e<i;++e){if(a=s.tween[e].value.call(r,r.__data__,s.index,s.group)){u[++n]=a}}u.length=n+1}function c(t){var e=t<s.duration?s.ease.call(null,t/s.duration):(s.timer.restart(f),s.state=hg,1),n=-1,i=u.length;while(++n<i){u[n].call(r,e)}if(s.state===hg){s.on.call("end",r,r.__data__,s.index,s.group);f()}}function f(){s.state=cg;s.timer.stop();delete l[o];for(var t in l){return}delete r.__transition}}function mg(t,e){var n=t.__transition,i,a,r=true,o;if(!n)return;e=e==null?null:e+"";for(o in n){if((i=n[o]).name!==e){r=false;continue}a=i.state>sg&&i.state<hg;i.state=cg;i.timer.stop();i.on.call(a?"interrupt":"cancel",t,t.__data__,i.index,i.group);delete n[o]}if(r)delete t.__transition}function _g(t){return this.each(function(){mg(this,t)})}function yg(t,e,n){t.prototype=e.prototype=n;n.constructor=t}function bg(t,e){var n=Object.create(t.prototype);for(var i in e){n[i]=e[i]}return n}function wg(){}var xg=.7;var kg=1/xg;var Sg="\\s*([+-]?\\d+)\\s*",Cg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ag="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Eg=/^#([0-9a-f]{3,8})$/,Mg=new RegExp("^rgb\\("+[Sg,Sg,Sg]+"\\)$"),Rg=new RegExp("^rgb\\("+[Ag,Ag,Ag]+"\\)$"),Tg=new RegExp("^rgba\\("+[Sg,Sg,Sg,Cg]+"\\)$"),Bg=new RegExp("^rgba\\("+[Ag,Ag,Ag,Cg]+"\\)$"),Og=new RegExp("^hsl\\("+[Cg,Ag,Ag]+"\\)$"),Pg=new RegExp("^hsla\\("+[Cg,Ag,Ag,Cg]+"\\)$");var Dg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yg(wg,Lg,{copy:function t(e){return Object.assign(new this.constructor,this,e)},displayable:function t(){return this.rgb().displayable()},hex:Ng,formatHex:Ng,formatHsl:zg,formatRgb:Fg,toString:Fg});function Ng(){return this.rgb().formatHex()}function zg(){return Yg(this).formatHsl()}function Fg(){return this.rgb().formatRgb()}function Lg(t){var e,n;t=(t+"").trim().toLowerCase();return(e=Eg.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?jg(e):n===3?new Ug(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?new Ug(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?new Ug(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Mg.exec(t))?new Ug(e[1],e[2],e[3],1):(e=Rg.exec(t))?new Ug(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Tg.exec(t))?Ig(e[1],e[2],e[3],e[4]):(e=Bg.exec(t))?Ig(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Og.exec(t))?qg(e[1],e[2]/100,e[3]/100,1):(e=Pg.exec(t))?qg(e[1],e[2]/100,e[3]/100,e[4]):Dg.hasOwnProperty(t)?jg(Dg[t]):t==="transparent"?new Ug(NaN,NaN,NaN,0):null}function jg(t){return new Ug(t>>16&255,t>>8&255,t&255,1)}function Ig(t,e,n,i){if(i<=0)t=e=n=NaN;return new Ug(t,e,n,i)}function Hg(t){if(!(t instanceof wg))t=Lg(t);if(!t)return new Ug;t=t.rgb();return new Ug(t.r,t.g,t.b,t.opacity)}function Vg(t,e,n,i){return arguments.length===1?Hg(t):new Ug(t,e,n,i==null?1:i)}function Ug(t,e,n,i){this.r=+t;this.g=+e;this.b=+n;this.opacity=+i}yg(Ug,Vg,bg(wg,{brighter:function t(e){e=e==null?kg:Math.pow(kg,e);return new Ug(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function t(e){e=e==null?xg:Math.pow(xg,e);return new Ug(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function t(){return this},displayable:function t(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gg,formatHex:Gg,formatRgb:Wg,toString:Wg}));function Gg(){return"#"+Kg(this.r)+Kg(this.g)+Kg(this.b)}function Wg(){var t=this.opacity;t=isNaN(t)?1:Math.max(0,Math.min(1,t));return(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function Kg(t){t=Math.max(0,Math.min(255,Math.round(t)||0));return(t<16?"0":"")+t.toString(16)}function qg(t,e,n,i){if(i<=0)t=e=n=NaN;else if(n<=0||n>=1)t=e=NaN;else if(e<=0)t=NaN;return new Zg(t,e,n,i)}function Yg(t){if(t instanceof Zg)return new Zg(t.h,t.s,t.l,t.opacity);if(!(t instanceof wg))t=Lg(t);if(!t)return new Zg;if(t instanceof Zg)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,a=Math.min(e,n,i),r=Math.max(e,n,i),o=NaN,s=r-a,l=(r+a)/2;if(s){if(e===r)o=(n-i)/s+(n<i)*6;else if(n===r)o=(i-e)/s+2;else o=(e-n)/s+4;s/=l<.5?r+a:2-r-a;o*=60}else{s=l>0&&l<1?0:o}return new Zg(o,s,l,t.opacity)}function Xg(t,e,n,i){return arguments.length===1?Yg(t):new Zg(t,e,n,i==null?1:i)}function Zg(t,e,n,i){this.h=+t;this.s=+e;this.l=+n;this.opacity=+i}yg(Zg,Xg,bg(wg,{brighter:function t(e){e=e==null?kg:Math.pow(kg,e);return new Zg(this.h,this.s,this.l*e,this.opacity)},darker:function t(e){e=e==null?xg:Math.pow(xg,e);return new Zg(this.h,this.s,this.l*e,this.opacity)},rgb:function t(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,a=i+(i<.5?i:1-i)*n,r=2*i-a;return new Ug(Jg(e>=240?e-240:e+120,r,a),Jg(e,r,a),Jg(e<120?e+240:e-120,r,a),this.opacity)},displayable:function t(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function t(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Jg(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function $g(t){return function(){return t}}function Qg(e,n){return function(t){return e+t*n}}function tp(e,n,i){return e=Math.pow(e,i),n=Math.pow(n,i)-e,i=1/i,function(t){return Math.pow(e+t*n,i)}}function ep(n){return(n=+n)===1?np:function(t,e){return e-t?tp(t,e,n):$g(isNaN(t)?e:t)}}function np(t,e){var n=e-t;return n?Qg(t,n):$g(isNaN(t)?e:t)}var ip=function t(e){var o=ep(e);function n(e,t){var n=o((e=Vg(e)).r,(t=Vg(t)).r),i=o(e.g,t.g),a=o(e.b,t.b),r=np(e.opacity,t.opacity);return function(t){e.r=n(t);e.g=i(t);e.b=a(t);e.opacity=r(t);return e+""}}n.gamma=t;return n}(1);function ap(e,n){if(!n)n=[];var i=e?Math.min(n.length,e.length):0,a=n.slice(),r;return function(t){for(r=0;r<i;++r){a[r]=e[r]*(1-t)+n[r]*t}return a}}function rp(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function op(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,a=new Array(i),r=new Array(n),o;for(o=0;o<i;++o){a[o]=pp(t[o],e[o])}for(;o<n;++o){r[o]=e[o]}return function(t){for(o=0;o<i;++o){r[o]=a[o](t)}return r}}function sp(e,n){var i=new Date;return e=+e,n=+n,function(t){return i.setTime(e*(1-t)+n*t),i}}function lp(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}function up(t,e){var n={},i={},a;if(t===null||ie(t)!=="object")t={};if(e===null||ie(e)!=="object")e={};for(a in e){if(a in t){n[a]=pp(t[a],e[a])}else{i[a]=e[a]}}return function(t){for(a in n){i[a]=n[a](t)}return i}}var hp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cp=new RegExp(hp.source,"g");function fp(t){return function(){return t}}function dp(e){return function(t){return e(t)+""}}function gp(t,i){var e=hp.lastIndex=cp.lastIndex=0,n,a,r,o=-1,s=[],l=[];t=t+"",i=i+"";while((n=hp.exec(t))&&(a=cp.exec(i))){if((r=a.index)>e){r=i.slice(e,r);if(s[o])s[o]+=r;else s[++o]=r}if((n=n[0])===(a=a[0])){if(s[o])s[o]+=a;else s[++o]=a}else{s[++o]=null;l.push({i:o,x:lp(n,a)})}e=cp.lastIndex}if(e<i.length){r=i.slice(e);if(s[o])s[o]+=r;else s[++o]=r}return s.length<2?l[0]?dp(l[0].x):fp(i):(i=l.length,function(t){for(var e=0,n;e<i;++e){s[(n=l[e]).i]=n.x(t)}return s.join("")})}function pp(t,e){var n=ie(e),i;return e==null||n==="boolean"?$g(e):(n==="number"?lp:n==="string"?(i=Lg(e))?(e=i,ip):gp:e instanceof Lg?ip:e instanceof Date?sp:rp(e)?ap:Array.isArray(e)?op:typeof e.valueOf!=="function"&&typeof e.toString!=="function"||isNaN(e)?up:lp)(t,e)}function vp(e,n){return e=+e,n=+n,function(t){return Math.round(e*(1-t)+n*t)}}var mp=180/Math.PI;var _p={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function yp(t,e,n,i,a,r){var o,s,l;if(o=Math.sqrt(t*t+e*e))t/=o,e/=o;if(l=t*n+e*i)n-=t*l,i-=e*l;if(s=Math.sqrt(n*n+i*i))n/=s,i/=s,l/=s;if(t*i<e*n)t=-t,e=-e,l=-l,o=-o;return{translateX:a,translateY:r,rotate:Math.atan2(e,t)*mp,skewX:Math.atan(l)*mp,scaleX:o,scaleY:s}}var bp,wp,xp,kp;function Sp(t){if(t==="none")return _p;if(!bp)bp=document.createElement("DIV"),wp=document.documentElement,xp=document.defaultView;bp.style.transform=t;t=xp.getComputedStyle(wp.appendChild(bp),null).getPropertyValue("transform");wp.removeChild(bp);t=t.slice(7,-1).split(",");return yp(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5])}function Cp(t){if(t==null)return _p;if(!kp)kp=document.createElementNS("http://www.w3.org/2000/svg","g");kp.setAttribute("transform",t);if(!(t=kp.transform.baseVal.consolidate()))return _p;t=t.matrix;return yp(t.a,t.b,t.c,t.d,t.e,t.f)}function Ap(n,s,l,a){function u(t){return t.length?t.pop()+" ":""}function i(t,e,n,i,a,r){if(t!==n||e!==i){var o=a.push("translate(",null,s,null,l);r.push({i:o-4,x:lp(t,n)},{i:o-2,x:lp(e,i)})}else if(n||i){a.push("translate("+n+s+i+l)}}function o(t,e,n,i){if(t!==e){if(t-e>180)e+=360;else if(e-t>180)t+=360;i.push({i:n.push(u(n)+"rotate(",null,a)-2,x:lp(t,e)})}else if(e){n.push(u(n)+"rotate("+e+a)}}function h(t,e,n,i){if(t!==e){i.push({i:n.push(u(n)+"skewX(",null,a)-2,x:lp(t,e)})}else if(e){n.push(u(n)+"skewX("+e+a)}}function c(t,e,n,i,a,r){if(t!==n||e!==i){var o=a.push(u(a)+"scale(",null,",",null,")");r.push({i:o-4,x:lp(t,n)},{i:o-2,x:lp(e,i)})}else if(n!==1||i!==1){a.push(u(a)+"scale("+n+","+i+")")}}return function(t,e){var a=[],r=[];t=n(t),e=n(e);i(t.translateX,t.translateY,e.translateX,e.translateY,a,r);o(t.rotate,e.rotate,a,r);h(t.skewX,e.skewX,a,r);c(t.scaleX,t.scaleY,e.scaleX,e.scaleY,a,r);t=e=null;return function(t){var e=-1,n=r.length,i;while(++e<n){a[(i=r[e]).i]=i.x(t)}return a.join("")}}}var Ep=Ap(Sp,"px, ","px)","deg)");var Mp=Ap(Cp,", ",")",")");var Rp=Math.SQRT2,Tp=2,Bp=4,Op=1e-12;function Pp(t){return((t=Math.exp(t))+1/t)/2}function Dp(t){return((t=Math.exp(t))-1/t)/2}function Np(t){return((t=Math.exp(2*t))-1)/(t+1)}function zp(t,e){var r=t[0],o=t[1],s=t[2],n=e[0],i=e[1],a=e[2],l=n-r,u=i-o,h=l*l+u*u,c,f;if(h<Op){f=Math.log(a/s)/Rp;c=function t(e){return[r+e*l,o+e*u,s*Math.exp(Rp*e*f)]}}else{var d=Math.sqrt(h),g=(a*a-s*s+Bp*h)/(2*s*Tp*d),p=(a*a-s*s-Bp*h)/(2*a*Tp*d),v=Math.log(Math.sqrt(g*g+1)-g),m=Math.log(Math.sqrt(p*p+1)-p);f=(m-v)/Rp;c=function t(e){var n=e*f,i=Pp(v),a=s/(Tp*d)*(i*Np(Rp*n+v)-Dp(v));return[r+a*l,o+a*u,s*i/Pp(Rp*n+v)]}}c.duration=f*1e3;return c}function Fp(a,r){var o,s;return function(){var t=gg(this,a),e=t.tween;if(e!==o){s=o=e;for(var n=0,i=s.length;n<i;++n){if(s[n].name===r){s=s.slice();s.splice(n,1);break}}}t.tween=s}}function Lp(r,o,s){var l,u;if(typeof s!=="function")throw new Error;return function(){var t=gg(this,r),e=t.tween;if(e!==l){u=(l=e).slice();for(var n={name:o,value:s},i=0,a=u.length;i<a;++i){if(u[i].name===o){u[i]=n;break}}if(i===a)u.push(n)}t.tween=u}}function jp(t,e){var n=this._id;t+="";if(arguments.length<2){var i=pg(this.node(),n).tween;for(var a=0,r=i.length,o;a<r;++a){if((o=i[a]).name===t){return o.value}}return null}return this.each((e==null?Fp:Lp)(n,t,e))}function Ip(t,e,n){var i=t._id;t.each(function(){var t=gg(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)});return function(t){return pg(t,i).value[e]}}function Hp(t,e){var n;return(typeof e==="number"?lp:e instanceof Lg?ip:(n=Lg(e))?(e=n,ip):gp)(t,e)}function Vp(t){return function(){this.removeAttribute(t)}}function Up(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Gp(e,n,i){var a,r=i+"",o;return function(){var t=this.getAttribute(e);return t===r?null:t===a?o:o=n(a=t,i)}}function Wp(e,n,i){var a,r=i+"",o;return function(){var t=this.getAttributeNS(e.space,e.local);return t===r?null:t===a?o:o=n(a=t,i)}}function Kp(i,a,r){var o,s,l;return function(){var t,e=r(this),n;if(e==null)return void this.removeAttribute(i);t=this.getAttribute(i);n=e+"";return t===n?null:t===o&&n===s?l:(s=n,l=a(o=t,e))}}function qp(i,a,r){var o,s,l;return function(){var t,e=r(this),n;if(e==null)return void this.removeAttributeNS(i.space,i.local);t=this.getAttributeNS(i.space,i.local);n=e+"";return t===n?null:t===o&&n===s?l:(s=n,l=a(o=t,e))}}function Yp(t,e){var n=Nc(t),i=n==="transform"?Mp:Hp;return this.attrTween(t,typeof e==="function"?(n.local?qp:Kp)(n,i,Ip(this,"attr."+t,e)):e==null?(n.local?Up:Vp)(n):(n.local?Wp:Gp)(n,i,e))}function Xp(e,n){return function(t){this.setAttribute(e,n.call(this,t))}}function Zp(e,n){return function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}}function Jp(e,n){var i,a;function t(){var t=n.apply(this,arguments);if(t!==a)i=(a=t)&&Zp(e,t);return i}t._value=n;return t}function $p(e,n){var i,a;function t(){var t=n.apply(this,arguments);if(t!==a)i=(a=t)&&Xp(e,t);return i}t._value=n;return t}function Qp(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!=="function")throw new Error;var i=Nc(t);return this.tween(n,(i.local?Jp:$p)(i,e))}function tv(t,e){return function(){dg(this,t).delay=+e.apply(this,arguments)}}function ev(t,e){return e=+e,function(){dg(this,t).delay=e}}function nv(t){var e=this._id;return arguments.length?this.each((typeof t==="function"?tv:ev)(e,t)):pg(this.node(),e).delay}function iv(t,e){return function(){gg(this,t).duration=+e.apply(this,arguments)}}function av(t,e){return e=+e,function(){gg(this,t).duration=e}}function rv(t){var e=this._id;return arguments.length?this.each((typeof t==="function"?iv:av)(e,t)):pg(this.node(),e).duration}function ov(t,e){if(typeof e!=="function")throw new Error;return function(){gg(this,t).ease=e}}function sv(t){var e=this._id;return arguments.length?this.each(ov(e,t)):pg(this.node(),e).ease}function lv(t){if(typeof t!=="function")t=Wc(t);for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a){for(var r=e[a],o=r.length,s=i[a]=[],l,u=0;u<o;++u){if((l=r[u])&&t.call(l,l.__data__,u,r)){s.push(l)}}}return new Fv(i,this._parents,this._name,this._id)}function uv(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,a=n.length,r=Math.min(i,a),o=new Array(i),s=0;s<r;++s){for(var l=e[s],u=n[s],h=l.length,c=o[s]=new Array(h),f,d=0;d<h;++d){if(f=l[d]||u[d]){c[d]=f}}}for(;s<i;++s){o[s]=e[s]}return new Fv(o,this._parents,this._name,this._id)}function hv(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");if(e>=0)t=t.slice(0,e);return!t||t==="start"})}function cv(n,i,a){var r,o,s=hv(i)?dg:gg;return function(){var t=s(this,n),e=t.on;if(e!==r)(o=(r=e).copy()).on(i,a);t.on=o}}function fv(t,e){var n=this._id;return arguments.length<2?pg(this.node(),n).on.on(t):this.each(cv(n,t,e))}function dv(n){return function(){var t=this.parentNode;for(var e in this.__transition){if(+e!==n)return}if(t)t.removeChild(this)}}function gv(){return this.on("end.remove",dv(this._id))}function pv(t){var e=this._name,n=this._id;if(typeof t!=="function")t=Ic(t);for(var i=this._groups,a=i.length,r=new Array(a),o=0;o<a;++o){for(var s=i[o],l=s.length,u=r[o]=new Array(l),h,c,f=0;f<l;++f){if((h=s[f])&&(c=t.call(h,h.__data__,f,s))){if("__data__"in h)c.__data__=h.__data__;u[f]=c;fg(u[f],e,n,f,u,pg(h,n))}}}return new Fv(r,this._parents,e,n)}function vv(t){var e=this._name,n=this._id;if(typeof t!=="function")t=Uc(t);for(var i=this._groups,a=i.length,r=[],o=[],s=0;s<a;++s){for(var l=i[s],u=l.length,h,c=0;c<u;++c){if(h=l[c]){for(var f=t.call(h,h.__data__,c,l),d,g=pg(h,n),p=0,v=f.length;p<v;++p){if(d=f[p]){fg(d,e,n,p,f,g)}}r.push(f);o.push(h)}}}return new Fv(r,o,e,n)}var mv=kd.prototype.constructor;function _v(){return new mv(this._groups,this._parents)}function yv(n,i){var a,r,o;return function(){var t=Af(this,n),e=(this.style.removeProperty(n),Af(this,n));return t===e?null:t===a&&e===r?o:o=i(a=t,r=e)}}function bv(t){return function(){this.style.removeProperty(t)}}function wv(e,n,i){var a,r=i+"",o;return function(){var t=Af(this,e);return t===r?null:t===a?o:o=n(a=t,i)}}function xv(i,a,r){var o,s,l;return function(){var t=Af(this,i),e=r(this),n=e+"";if(e==null)n=e=(this.style.removeProperty(i),Af(this,i));return t===n?null:t===o&&n===s?l:(s=n,l=a(o=t,e))}}function kv(i,a){var r,o,s,l="style."+a,u="end."+l,h;return function(){var t=gg(this,i),e=t.on,n=t.value[l]==null?h||(h=bv(a)):undefined;if(e!==r||s!==n)(o=(r=e).copy()).on(u,s=n);t.on=o}}function Sv(t,e,n){var i=(t+="")==="transform"?Ep:Hp;return e==null?this.styleTween(t,yv(t,i)).on("end.style."+t,bv(t)):typeof e==="function"?this.styleTween(t,xv(t,i,Ip(this,"style."+t,e))).each(kv(this._id,t)):this.styleTween(t,wv(t,i,e),n).on("end.style."+t,null)}function Cv(e,n,i){return function(t){this.style.setProperty(e,n.call(this,t),i)}}function Av(e,n,i){var a,r;function t(){var t=n.apply(this,arguments);if(t!==r)a=(r=t)&&Cv(e,t,i);return a}t._value=n;return t}function Ev(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!=="function")throw new Error;return this.tween(i,Av(t,e,n==null?"":n))}function Mv(t){return function(){this.textContent=t}}function Rv(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function Tv(t){return this.tween("text",typeof t==="function"?Rv(Ip(this,"text",t)):Mv(t==null?"":t+""))}function Bv(e){return function(t){this.textContent=e.call(this,t)}}function Ov(e){var n,i;function t(){var t=e.apply(this,arguments);if(t!==i)n=(i=t)&&Bv(t);return n}t._value=e;return t}function Pv(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!=="function")throw new Error;return this.tween(e,Ov(t))}function Dv(){var t=this._name,e=this._id,n=jv();for(var i=this._groups,a=i.length,r=0;r<a;++r){for(var o=i[r],s=o.length,l,u=0;u<s;++u){if(l=o[u]){var h=pg(l,e);fg(l,t,n,u,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}}}return new Fv(i,this._parents,t,n)}function Nv(){var a,r,o=this,s=o._id,l=o.size();return new Promise(function(e,t){var n={value:t},i={value:function t(){if(--l===0)e()}};o.each(function(){var t=gg(this,s),e=t.on;if(e!==a){r=(a=e).copy();r._.cancel.push(n);r._.interrupt.push(n);r._.end.push(i)}t.on=r})})}var zv=0;function Fv(t,e,n,i){this._groups=t;this._parents=e;this._name=n;this._id=i}function Lv(t){return kd().transition(t)}function jv(){return++zv}var Iv=kd.prototype;Fv.prototype=Lv.prototype={constructor:Fv,select:pv,selectAll:vv,filter:lv,merge:uv,selection:_v,transition:Dv,call:Iv.call,nodes:Iv.nodes,node:Iv.node,size:Iv.size,empty:Iv.empty,each:Iv.each,on:fv,attr:Yp,attrTween:Qp,style:Sv,styleTween:Ev,text:Tv,textTween:Pv,remove:gv,tween:jp,delay:nv,duration:rv,ease:sv,end:Nv};function Hv(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Vv={time:null,delay:0,duration:250,ease:Hv};function Uv(t,e){var n;while(!(n=t.__transition)||!(n=n[e])){if(!(t=t.parentNode)){return Vv.time=qd(),Vv}}return n}function Gv(t){var e,n;if(t instanceof Fv){e=t._id,t=t._name}else{e=jv(),(n=Vv).time=qd(),t=t==null?null:t+""}for(var i=this._groups,a=i.length,r=0;r<a;++r){for(var o=i[r],s=o.length,l,u=0;u<s;++u){if(l=o[u]){fg(l,t,e,u,o,n||Uv(l,e))}}}return new Fv(i,this._parents,t,e)}kd.prototype.interrupt=_g;kd.prototype.transition=Gv;function Wv(t,e){e=Object.assign({},{condition:true,enter:{},exit:{},parent:Sd("body"),transition:Lv().duration(0),update:{}},e);var n=/\.([^#]+)/g.exec(t),i=/#([^\.]+)/g.exec(t),a=/^([^.^#]+)/g.exec(t)[1];var r=e.parent.selectAll(t.includes(":")?t.split(":")[1]:t).data(e.condition?[null]:[]);var o=r.enter().append(a).call(_,e.enter);if(i)o.attr("id",i[1]);if(n)o.attr("class",n[1]);r.exit().transition(e.transition).call(_,e.exit).remove();var s=o.merge(r);s.transition(e.transition).call(_,e.update);return s}function Kv(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function qv(o){if(o.length===1)o=Yv(o);return{left:function t(e,n,i,a){if(i==null)i=0;if(a==null)a=e.length;while(i<a){var r=i+a>>>1;if(o(e[r],n)<0)i=r+1;else a=r}return i},right:function t(e,n,i,a){if(i==null)i=0;if(a==null)a=e.length;while(i<a){var r=i+a>>>1;if(o(e[r],n)>0)a=r;else i=r+1}return i}}}function Yv(n){return function(t,e){return Kv(n(t),e)}}var Xv=qv(Kv);var Zv=Xv.right;function Jv(t){return t===null?NaN:+t}function $v(t,e){var n=t.length,i=0,a=-1,r=0,o,s,l=0;if(e==null){while(++a<n){if(!isNaN(o=Jv(t[a]))){s=o-r;r+=s/++i;l+=s*(o-r)}}}else{while(++a<n){if(!isNaN(o=Jv(e(t[a],a,t)))){s=o-r;r+=s/++i;l+=s*(o-r)}}}if(i>1)return l/(i-1)}function Qv(t,e){var n=$v(t,e);return n?Math.sqrt(n):n}function tm(t,e){var n=t.length,i=-1,a,r,o;if(e==null){while(++i<n){if((a=t[i])!=null&&a>=a){r=o=a;while(++i<n){if((a=t[i])!=null){if(r>a)r=a;if(o<a)o=a}}}}}else{while(++i<n){if((a=e(t[i],i,t))!=null&&a>=a){r=o=a;while(++i<n){if((a=e(t[i],i,t))!=null){if(r>a)r=a;if(o<a)o=a}}}}}return[r,o]}function em(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;var i=-1,a=Math.max(0,Math.ceil((e-t)/n))|0,r=new Array(a);while(++i<a){r[i]=t+i*n}return r}var nm=Math.sqrt(50),im=Math.sqrt(10),am=Math.sqrt(2);function rm(t,e,n){var i,a=-1,r,o,s;e=+e,t=+t,n=+n;if(t===e&&n>0)return[t];if(i=e<t)r=t,t=e,e=r;if((s=om(t,e,n))===0||!isFinite(s))return[];if(s>0){t=Math.ceil(t/s);e=Math.floor(e/s);o=new Array(r=Math.ceil(e-t+1));while(++a<r){o[a]=(t+a)*s}}else{t=Math.floor(t*s);e=Math.ceil(e*s);o=new Array(r=Math.ceil(t-e+1));while(++a<r){o[a]=(t-a)/s}}if(i)o.reverse();return o}function om(t,e,n){var i=(e-t)/Math.max(0,n),a=Math.floor(Math.log(i)/Math.LN10),r=i/Math.pow(10,a);return a>=0?(r>=nm?10:r>=im?5:r>=am?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(r>=nm?10:r>=im?5:r>=am?2:1)}function sm(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),r=i/a;if(r>=nm)a*=10;else if(r>=im)a*=5;else if(r>=am)a*=2;return e<t?-a:a}function lm(t,e,n){if(n==null)n=Jv;if(!(i=t.length))return;if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,a=(i-1)*e,r=Math.floor(a),o=+n(t[r],r,t),s=+n(t[r+1],r+1,t);return o+(s-o)*(a-r)}function um(t,e){var n=t.length,i=-1,a,r;if(e==null){while(++i<n){if((a=t[i])!=null&&a>=a){r=a;while(++i<n){if((a=t[i])!=null&&a>r){r=a}}}}}else{while(++i<n){if((a=e(t[i],i,t))!=null&&a>=a){r=a;while(++i<n){if((a=e(t[i],i,t))!=null&&a>r){r=a}}}}}return r}function hm(t,e){var n=t.length,i=n,a=-1,r,o=0;if(e==null){while(++a<n){if(!isNaN(r=Jv(t[a])))o+=r;else--i}}else{while(++a<n){if(!isNaN(r=Jv(e(t[a],a,t))))o+=r;else--i}}if(i)return o/i}function cm(t){var e=t.length,n,i=-1,a=0,r,o;while(++i<e){a+=t[i].length}r=new Array(a);while(--e>=0){o=t[e];n=o.length;while(--n>=0){r[--a]=o[n]}}return r}function fm(t,e){var n=t.length,i=-1,a,r;if(e==null){while(++i<n){if((a=t[i])!=null&&a>=a){r=a;while(++i<n){if((a=t[i])!=null&&r>a){r=a}}}}}else{while(++i<n){if((a=e(t[i],i,t))!=null&&a>=a){r=a;while(++i<n){if((a=e(t[i],i,t))!=null&&r>a){r=a}}}}}return r}function dm(t,e){var n=t.length,i=-1,a,r=0;if(e==null){while(++i<n){if(a=+t[i])r+=a}}else{while(++i<n){if(a=+e(t[i],i,t))r+=a}}return r}var gm="$";function pm(){}pm.prototype=vm.prototype={constructor:pm,has:function t(e){return gm+e in this},get:function t(e){return this[gm+e]},set:function t(e,n){this[gm+e]=n;return this},remove:function t(e){var n=gm+e;return n in this&&delete this[n]},clear:function t(){for(var e in this){if(e[0]===gm)delete this[e]}},keys:function t(){var t=[];for(var e in this){if(e[0]===gm)t.push(e.slice(1))}return t},values:function t(){var t=[];for(var e in this){if(e[0]===gm)t.push(this[e])}return t},entries:function t(){var t=[];for(var e in this){if(e[0]===gm)t.push({key:e.slice(1),value:this[e]})}return t},size:function t(){var t=0;for(var e in this){if(e[0]===gm)++t}return t},empty:function t(){for(var e in this){if(e[0]===gm)return false}return true},each:function t(e){for(var n in this){if(n[0]===gm)e(this[n],n.slice(1),this)}}};function vm(t,e){var n=new pm;if(t instanceof pm)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i=-1,a=t.length,r;if(e==null)while(++i<a){n.set(i,t[i])}else while(++i<a){n.set(e(r=t[i],i,t),r)}}else if(t)for(var o in t){n.set(o,t[o])}return n}function mm(){var f=[],r=[],d,g,n;function p(t,n,i,a){if(n>=f.length){if(d!=null)t.sort(d);return g!=null?g(t):t}var e=-1,r=t.length,o=f[n++],s,l,u=vm(),h,c=i();while(++e<r){if(h=u.get(s=o(l=t[e])+"")){h.push(l)}else{u.set(s,[l])}}u.each(function(t,e){a(c,e,p(t,n,i,a))});return c}function o(t,n){if(++n>f.length)return t;var i,a=r[n-1];if(g!=null&&n>=f.length)i=t.entries();else i=[],t.each(function(t,e){i.push({key:e,values:o(t,n)})});return a!=null?i.sort(function(t,e){return a(t.key,e.key)}):i}return n={object:function t(e){return p(e,0,_m,ym)},map:function t(e){return p(e,0,bm,wm)},entries:function t(e){return o(p(e,0,bm,wm),0)},key:function t(e){f.push(e);return n},sortKeys:function t(e){r[f.length-1]=e;return n},sortValues:function t(e){d=e;return n},rollup:function t(e){g=e;return n}}}function _m(){return{}}function ym(t,e,n){t[e]=n}function bm(){return vm()}function wm(t,e,n){t.set(e,n)}function xm(){}var km=vm.prototype;xm.prototype=Sm.prototype={constructor:xm,has:km.has,add:function t(e){e+="";this[gm+e]=e;return this},remove:km.remove,clear:km.clear,values:km.keys,size:km.size,empty:km.empty,each:km.each};function Sm(t,e){var n=new xm;if(t instanceof xm)t.each(function(t){n.add(t)});else if(t){var i=-1,a=t.length;if(e==null)while(++i<a){n.add(t[i])}else while(++i<a){n.add(e(t[i],i,t))}}return n}function Cm(t){var e=[];for(var n in t){e.push(n)}return e}function Am(t){return t.filter(function(t,e,n){return n.indexOf(t)===e})}function Em(a){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var t=Am(cm(a.map(function(t){return Cm(t)}))),o={};t.forEach(function(e){var t=a.map(function(t){return t[e]});var n;if(r[e])n=r[e](t);else{var i=t.map(function(t){return t||t===false?t.constructor:t}).filter(function(t){return t!==void 0});if(!i.length)n=undefined;else if(i.indexOf(Array)>=0){n=cm(t.map(function(t){return t instanceof Array?t:[t]}));n=Am(n);if(n.length===1)n=n[0]}else if(i.indexOf(String)>=0){n=Am(t);if(n.length===1)n=n[0]}else if(i.indexOf(Number)>=0)n=dm(t);else if(i.indexOf(Object)>=0){n=Am(t.filter(function(t){return t}));if(n.length===1)n=n[0];else n=Em(n)}else{n=Am(t.filter(function(t){return t!==void 0}));if(n.length===1)n=n[0]}}o[e]=n});return o}function Mm(t){var a;if(typeof t==="number")a=[t];else a=t.split(/\s+/);if(a.length===1)a=[a[0],a[0],a[0],a[0]];else if(a.length===2)a=a.concat(a);else if(a.length===3)a.push(a[1]);return["top","right","bottom","left"].reduce(function(t,e,n){var i=parseFloat(a[n]);t[e]=i||0;return t},{})}function Rm(){if("-webkit-transform"in document.body.style)return"-webkit-";else if("-moz-transform"in document.body.style)return"-moz-";else if("-ms-transform"in document.body.style)return"-ms-";else if("-o-transform"in document.body.style)return"-o-";else return""}function Tm(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};for(var n in e){if({}.hasOwnProperty.call(e,n))t.style(n,e[n])}}function Bm(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Om(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t);break}return this}var Pm=Array.prototype;var Dm=Pm.map;var Nm=Pm.slice;var zm={name:"implicit"};function Fm(){var r=vm(),o=[],i=[],a=zm;function s(t){var e=t+"",n=r.get(e);if(!n){if(a!==zm)return a;r.set(e,n=o.push(t))}return i[(n-1)%i.length]}s.domain=function(t){if(!arguments.length)return o.slice();o=[],r=vm();var e=-1,n=t.length,i,a;while(++e<n){if(!r.has(a=(i=t[e])+""))r.set(a,o.push(i))}return s};s.range=function(t){return arguments.length?(i=Nm.call(t),s):i.slice()};s.unknown=function(t){return arguments.length?(a=t,s):a};s.copy=function(){return Fm(o,i).unknown(a)};Bm.apply(s,arguments);return s}function Lm(){var t=Fm().unknown(undefined),r=t.domain,o=t.range,s=[0,1],l,u,h=false,c=0,f=0,d=.5;delete t.unknown;function e(){var t=r().length,e=s[1]<s[0],n=s[e-0],i=s[1-e];l=(i-n)/Math.max(1,t-c+f*2);if(h)l=Math.floor(l);n+=(i-n-l*(t-c))*d;u=l*(1-c);if(h)n=Math.round(n),u=Math.round(u);var a=em(t).map(function(t){return n+l*t});return o(e?a.reverse():a)}t.domain=function(t){return arguments.length?(r(t),e()):r()};t.range=function(t){return arguments.length?(s=[+t[0],+t[1]],e()):s.slice()};t.rangeRound=function(t){return s=[+t[0],+t[1]],h=true,e()};t.bandwidth=function(){return u};t.step=function(){return l};t.round=function(t){return arguments.length?(h=!!t,e()):h};t.padding=function(t){return arguments.length?(c=Math.min(1,f=+t),e()):c};t.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),e()):c};t.paddingOuter=function(t){return arguments.length?(f=+t,e()):f};t.align=function(t){return arguments.length?(d=Math.max(0,Math.min(1,t)),e()):d};t.copy=function(){return Lm(r(),s).round(h).paddingInner(c).paddingOuter(f).align(d)};return Bm.apply(e(),arguments)}function jm(t){var e=t.copy;t.padding=t.paddingOuter;delete t.paddingInner;delete t.paddingOuter;t.copy=function(){return jm(e())};return t}function Im(){return jm(Lm.apply(null,arguments).paddingInner(1))}function Hm(t){return function(){return t}}function Vm(t){return+t}var Um=[0,1];function Gm(t){return t}function Wm(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:Hm(isNaN(n)?NaN:.5)}function Km(t){var e=t[0],n=t[t.length-1],i;if(e>n)i=e,e=n,n=i;return function(t){return Math.max(e,Math.min(n,t))}}function qm(t,e,n){var i=t[0],a=t[1],r=e[0],o=e[1];if(a<i)i=Wm(a,i),r=n(o,r);else i=Wm(i,a),r=n(r,o);return function(t){return r(i(t))}}function Ym(n,t,e){var i=Math.min(n.length,t.length)-1,a=new Array(i),r=new Array(i),o=-1;if(n[i]<n[0]){n=n.slice().reverse();t=t.slice().reverse()}while(++o<i){a[o]=Wm(n[o],n[o+1]);r[o]=e(t[o],t[o+1])}return function(t){var e=Zv(n,t,1,i)-1;return r[e](a[e](t))}}function Xm(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Zm(){var e=Um,n=Um,i=pp,a,r,o,s=Gm,l,u,h;function c(){l=Math.min(e.length,n.length)>2?Ym:qm;u=h=null;return f}function f(t){return isNaN(t=+t)?o:(u||(u=l(e.map(a),n,i)))(a(s(t)))}f.invert=function(t){return s(r((h||(h=l(n,e.map(a),lp)))(t)))};f.domain=function(t){return arguments.length?(e=Dm.call(t,Vm),s===Gm||(s=Km(e)),c()):e.slice()};f.range=function(t){return arguments.length?(n=Nm.call(t),c()):n.slice()};f.rangeRound=function(t){return n=Nm.call(t),i=vp,c()};f.clamp=function(t){return arguments.length?(s=t?Km(e):Gm,f):s!==Gm};f.interpolate=function(t){return arguments.length?(i=t,c()):i};f.unknown=function(t){return arguments.length?(o=t,f):o};return function(t,e){a=t,r=e;return c()}}function Jm(t,e){return Zm()(t,e)}function $m(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Qm(t){return t=$m(Math.abs(t)),t?t[1]:NaN}function t_(s,l){return function(t,e){var n=t.length,i=[],a=0,r=s[0],o=0;while(n>0&&r>0){if(o+r+1>e)r=Math.max(1,e-o);i.push(t.substring(n-=r,n+r));if((o+=r+1)>e)break;r=s[a=(a+1)%s.length]}return i.reverse().join(l)}}function e_(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}var n_=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i_(t){if(!(e=n_.exec(t)))throw new Error("invalid format: "+t);var e;return new a_({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}i_.prototype=a_.prototype;function a_(t){this.fill=t.fill===undefined?" ":t.fill+"";this.align=t.align===undefined?">":t.align+"";this.sign=t.sign===undefined?"-":t.sign+"";this.symbol=t.symbol===undefined?"":t.symbol+"";this.zero=!!t.zero;this.width=t.width===undefined?undefined:+t.width;this.comma=!!t.comma;this.precision=t.precision===undefined?undefined:+t.precision;this.trim=!!t.trim;this.type=t.type===undefined?"":t.type+""}a_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function r_(t){t:for(var e=t.length,n=1,i=-1,a;n<e;++n){switch(t[n]){case".":i=a=n;break;case"0":if(i===0)i=n;a=n;break;default:if(i>0){if(!+t[n])break t;i=0}break}}return i>0?t.slice(0,i)+t.slice(a+1):t}var o_;function s_(t,e){var n=$m(t,e);if(!n)return t+"";var i=n[0],a=n[1],r=a-(o_=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=i.length;return r===o?i:r>o?i+new Array(r-o+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+$m(t,Math.max(0,e+r-1))[0]}function l_(t,e){var n=$m(t,e);if(!n)return t+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}var u_={"%":function t(e,n){return(e*100).toFixed(n)},b:function t(e){return Math.round(e).toString(2)},c:function t(e){return e+""},d:function t(e){return Math.round(e).toString(10)},e:function t(e,n){return e.toExponential(n)},f:function t(e,n){return e.toFixed(n)},g:function t(e,n){return e.toPrecision(n)},o:function t(e){return Math.round(e).toString(8)},p:function t(e,n){return l_(e*100,n)},r:l_,s:s_,X:function t(e){return Math.round(e).toString(16).toUpperCase()},x:function t(e){return Math.round(e).toString(16)}};function h_(t){return t}var c_=Array.prototype.map,f_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function d_(t){var x=t.grouping===undefined||t.thousands===undefined?h_:t_(c_.call(t.grouping,Number),t.thousands+""),i=t.currency===undefined?"":t.currency[0]+"",a=t.currency===undefined?"":t.currency[1]+"",k=t.decimal===undefined?".":t.decimal+"",S=t.numerals===undefined?h_:e_(c_.call(t.numerals,String)),r=t.percent===undefined?"%":t.percent+"",C=t.minus===undefined?"-":t.minus+"",A=t.nan===undefined?"NaN":t.nan+"";function o(t){t=i_(t);var u=t.fill,h=t.align,c=t.sign,e=t.symbol,f=t.zero,d=t.width,g=t.comma,p=t.precision,v=t.trim,m=t.type;if(m==="n")g=true,m="g";else if(!u_[m])p===undefined&&(p=12),v=true,m="g";if(f||u==="0"&&h==="=")f=true,u="0",h="=";var _=e==="$"?i:e==="#"&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",y=e==="$"?a:/[%p]/.test(m)?r:"";var b=u_[m],w=/[defgprs%]/.test(m);p=p===undefined?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p));function n(t){var e=_,n=y,i,a,r;if(m==="c"){n=b(t)+n;t=""}else{t=+t;var o=t<0;t=isNaN(t)?A:b(Math.abs(t),p);if(v)t=r_(t);if(o&&+t===0)o=false;e=(o?c==="("?c:C:c==="-"||c==="("?"":c)+e;n=(m==="s"?f_[8+o_/3]:"")+n+(o&&c==="("?")":"");if(w){i=-1,a=t.length;while(++i<a){if(r=t.charCodeAt(i),48>r||r>57){n=(r===46?k+t.slice(i+1):t.slice(i))+n;t=t.slice(0,i);break}}}}if(g&&!f)t=x(t,Infinity);var s=e.length+t.length+n.length,l=s<d?new Array(d-s+1).join(u):"";if(g&&f)t=x(l+t,l.length?d-n.length:Infinity),l="";switch(h){case"<":t=e+t+n+l;break;case"=":t=e+l+t+n;break;case"^":t=l.slice(0,s=l.length>>1)+e+t+n+l.slice(s);break;default:t=l+e+t+n;break}return S(t)}n.toString=function(){return t+""};return n}function e(t,e){var n=o((t=i_(t),t.type="f",t)),i=Math.max(-8,Math.min(8,Math.floor(Qm(e)/3)))*3,a=Math.pow(10,-i),r=f_[8+i/3];return function(t){return n(a*t)+r}}return{format:o,formatPrefix:e}}var g_;var p_;var v_;m_({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function m_(t){g_=d_(t);p_=g_.format;v_=g_.formatPrefix;return g_}function __(t){return Math.max(0,-Qm(Math.abs(t)))}function y_(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qm(e)/3)))*3-Qm(Math.abs(t)))}function b_(t,e){t=Math.abs(t),e=Math.abs(e)-t;return Math.max(0,Qm(e)-Qm(t))+1}function w_(t,e,n,i){var a=sm(t,e,n),r;i=i_(i==null?",f":i);switch(i.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));if(i.precision==null&&!isNaN(r=y_(a,o)))i.precision=r;return v_(i,o)}case"":case"e":case"g":case"p":case"r":{if(i.precision==null&&!isNaN(r=b_(a,Math.max(Math.abs(t),Math.abs(e)))))i.precision=r-(i.type==="e");break}case"f":case"%":{if(i.precision==null&&!isNaN(r=__(a)))i.precision=r-(i.type==="%")*2;break}}return p_(i)}function x_(s){var l=s.domain;s.ticks=function(t){var e=l();return rm(e[0],e[e.length-1],t==null?10:t)};s.tickFormat=function(t,e){var n=l();return w_(n[0],n[n.length-1],t==null?10:t,e)};s.nice=function(t){if(t==null)t=10;var e=l(),n=0,i=e.length-1,a=e[n],r=e[i],o;if(r<a){o=a,a=r,r=o;o=n,n=i,i=o}o=om(a,r,t);if(o>0){a=Math.floor(a/o)*o;r=Math.ceil(r/o)*o;o=om(a,r,t)}else if(o<0){a=Math.ceil(a*o)/o;r=Math.floor(r*o)/o;o=om(a,r,t)}if(o>0){e[n]=Math.floor(a/o)*o;e[i]=Math.ceil(r/o)*o;l(e)}else if(o<0){e[n]=Math.ceil(a*o)/o;e[i]=Math.floor(r*o)/o;l(e)}return s};return s}function k_(){var t=Jm(Gm,Gm);t.copy=function(){return Xm(t,k_())};Bm.apply(t,arguments);return x_(t)}function S_(e){var n;function i(t){return isNaN(t=+t)?n:t}i.invert=i;i.domain=i.range=function(t){return arguments.length?(e=Dm.call(t,Vm),i):e.slice()};i.unknown=function(t){return arguments.length?(n=t,i):n};i.copy=function(){return S_(e).unknown(n)};e=arguments.length?Dm.call(e,Vm):[0,1];return x_(i)}function C_(t,e){t=t.slice();var n=0,i=t.length-1,a=t[n],r=t[i],o;if(r<a){o=n,n=i,i=o;o=a,a=r,r=o}t[n]=e.floor(a);t[i]=e.ceil(r);return t}function A_(t){return Math.log(t)}function E_(t){return Math.exp(t)}function M_(t){return-Math.log(-t)}function R_(t){return-Math.exp(-t)}function T_(t){return isFinite(t)?+("1e"+t):t<0?0:t}function B_(e){return e===10?T_:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function O_(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function P_(e){return function(t){return-e(-t)}}function D_(t){var e=t(A_,E_),f=e.domain,d=10,g,p;function n(){g=O_(d),p=B_(d);if(f()[0]<0){g=P_(g),p=P_(p);t(M_,R_)}else{t(A_,E_)}return e}e.base=function(t){return arguments.length?(d=+t,n()):d};e.domain=function(t){return arguments.length?(f(t),n()):f()};e.ticks=function(t){var e=f(),n=e[0],i=e[e.length-1],a;if(a=i<n)r=n,n=i,i=r;var r=g(n),o=g(i),s,l,u,h=t==null?10:+t,c=[];if(!(d%1)&&o-r<h){r=Math.round(r)-1,o=Math.round(o)+1;if(n>0)for(;r<o;++r){for(l=1,s=p(r);l<d;++l){u=s*l;if(u<n)continue;if(u>i)break;c.push(u)}}else for(;r<o;++r){for(l=d-1,s=p(r);l>=1;--l){u=s*l;if(u<n)continue;if(u>i)break;c.push(u)}}}else{c=rm(r,o,Math.min(o-r,h)).map(p)}return a?c.reverse():c};e.tickFormat=function(t,n){if(n==null)n=d===10?".0e":",";if(typeof n!=="function")n=p_(n);if(t===Infinity)return n;if(t==null)t=10;var i=Math.max(1,d*t/e.ticks().length);return function(t){var e=t/p(Math.round(g(t)));if(e*d<d-.5)e*=d;return e<=i?n(t):""}};e.nice=function(){return f(C_(f(),{floor:function t(e){return p(Math.floor(g(e)))},ceil:function t(e){return p(Math.ceil(g(e)))}}))};return e}function N_(){var t=D_(Zm()).domain([1,10]);t.copy=function(){return Xm(t,N_()).base(t.base())};Bm.apply(t,arguments);return t}function z_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function F_(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function L_(e){var n=1,t=e(z_(n),F_(n));t.constant=function(t){return arguments.length?e(z_(n=+t),F_(n)):n};return x_(t)}function j_(){var t=L_(Zm());t.copy=function(){return Xm(t,j_()).constant(t.constant())};return Bm.apply(t,arguments)}function I_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function H_(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function V_(t){return t<0?-t*t:t*t}function U_(t){var e=t(Gm,Gm),n=1;function i(){return n===1?t(Gm,Gm):n===.5?t(H_,V_):t(I_(n),I_(1/n))}e.exponent=function(t){return arguments.length?(n=+t,i()):n};return x_(e)}function G_(){var t=U_(Zm());t.copy=function(){return Xm(t,G_()).exponent(t.exponent())};Bm.apply(t,arguments);return t}function W_(){return G_.apply(null,arguments).exponent(.5)}function K_(){var a=[],n=[],i=[],e;function r(){var t=0,e=Math.max(1,n.length);i=new Array(e-1);while(++t<e){i[t-1]=lm(a,t/e)}return o}function o(t){return isNaN(t=+t)?e:n[Zv(i,t)]}o.invertExtent=function(t){var e=n.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:a[0],e<i.length?i[e]:a[a.length-1]]};o.domain=function(t){if(!arguments.length)return a.slice();a=[];for(var e=0,n=t.length,i;e<n;++e){if(i=t[e],i!=null&&!isNaN(i=+i))a.push(i)}a.sort(Kv);return r()};o.range=function(t){return arguments.length?(n=Nm.call(t),r()):n.slice()};o.unknown=function(t){return arguments.length?(e=t,o):e};o.quantiles=function(){return i.slice()};o.copy=function(){return K_().domain(a).range(n).unknown(e)};return Bm.apply(o,arguments)}function q_(){var n=0,i=1,a=1,r=[.5],o=[0,1],e;function s(t){return t<=t?o[Zv(r,t,0,a)]:e}function l(){var t=-1;r=new Array(a);while(++t<a){r[t]=((t+1)*i-(t-a)*n)/(a+1)}return s}s.domain=function(t){return arguments.length?(n=+t[0],i=+t[1],l()):[n,i]};s.range=function(t){return arguments.length?(a=(o=Nm.call(t)).length-1,l()):o.slice()};s.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,r[0]]:e>=a?[r[a-1],i]:[r[e-1],r[e]]};s.unknown=function(t){return arguments.length?(e=t,s):s};s.thresholds=function(){return r.slice()};s.copy=function(){return q_().domain([n,i]).range(o).unknown(e)};return Bm.apply(x_(s),arguments)}function Y_(){var n=[.5],i=[0,1],e,a=1;function r(t){return t<=t?i[Zv(n,t,0,a)]:e}r.domain=function(t){return arguments.length?(n=Nm.call(t),a=Math.min(n.length,i.length-1),r):n.slice()};r.range=function(t){return arguments.length?(i=Nm.call(t),a=Math.min(n.length,i.length-1),r):i.slice()};r.invertExtent=function(t){var e=i.indexOf(t);return[n[e-1],n[e]]};r.unknown=function(t){return arguments.length?(e=t,r):e};r.copy=function(){return Y_().domain(n).range(i).unknown(e)};return Bm.apply(r,arguments)}var X_=new Date,Z_=new Date;function J_(r,o,n,i){function s(t){return r(t=arguments.length===0?new Date:new Date(+t)),t}s.floor=function(t){return r(t=new Date(+t)),t};s.ceil=function(t){return r(t=new Date(t-1)),o(t,1),r(t),t};s.round=function(t){var e=s(t),n=s.ceil(t);return t-e<n-t?e:n};s.offset=function(t,e){return o(t=new Date(+t),e==null?1:Math.floor(e)),t};s.range=function(t,e,n){var i=[],a;t=s.ceil(t);n=n==null?1:Math.floor(n);if(!(t<e)||!(n>0))return i;do{i.push(a=new Date(+t)),o(t,n),r(t)}while(a<t&&t<e);return i};s.filter=function(n){return J_(function(t){if(t>=t)while(r(t),!n(t)){t.setTime(t-1)}},function(t,e){if(t>=t){if(e<0)while(++e<=0){while(o(t,-1),!n(t)){}}else while(--e>=0){while(o(t,+1),!n(t)){}}}})};if(n){s.count=function(t,e){X_.setTime(+t),Z_.setTime(+e);r(X_),r(Z_);return Math.floor(n(X_,Z_))};s.every=function(e){e=Math.floor(e);return!isFinite(e)||!(e>0)?null:!(e>1)?s:s.filter(i?function(t){return i(t)%e===0}:function(t){return s.count(0,t)%e===0})}}return s}var $_=J_(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});$_.every=function(n){n=Math.floor(n);if(!isFinite(n)||!(n>0))return null;if(!(n>1))return $_;return J_(function(t){t.setTime(Math.floor(t/n)*n)},function(t,e){t.setTime(+t+e*n)},function(t,e){return(e-t)/n})};var Q_=1e3;var ty=6e4;var ey=36e5;var ny=864e5;var iy=6048e5;var ay=J_(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*Q_)},function(t,e){return(e-t)/Q_},function(t){return t.getUTCSeconds()});var ry=J_(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Q_)},function(t,e){t.setTime(+t+e*ty)},function(t,e){return(e-t)/ty},function(t){return t.getMinutes()});var oy=J_(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Q_-t.getMinutes()*ty)},function(t,e){t.setTime(+t+e*ey)},function(t,e){return(e-t)/ey},function(t){return t.getHours()});var sy=J_(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ty)/ny},function(t){return t.getDate()-1});function ly(e){return J_(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7);t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e*7)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ty)/iy})}var uy=ly(0);var hy=ly(1);var cy=ly(2);var fy=ly(3);var dy=ly(4);var gy=ly(5);var py=ly(6);var vy=J_(function(t){t.setDate(1);t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});var my=J_(function(t){t.setMonth(0,1);t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});my.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:J_(function(t){t.setFullYear(Math.floor(t.getFullYear()/n)*n);t.setMonth(0,1);t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e*n)})};var _y=J_(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*ty)},function(t,e){return(e-t)/ty},function(t){return t.getUTCMinutes()});var yy=J_(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*ey)},function(t,e){return(e-t)/ey},function(t){return t.getUTCHours()});var by=J_(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/ny},function(t){return t.getUTCDate()-1});function wy(e){return J_(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7);t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e*7)},function(t,e){return(e-t)/iy})}var xy=wy(0);var ky=wy(1);var Sy=wy(2);var Cy=wy(3);var Ay=wy(4);var Ey=wy(5);var My=wy(6);var Ry=J_(function(t){t.setUTCDate(1);t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()});var Ty=J_(function(t){t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Ty.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:J_(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/n)*n);t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e*n)})};function By(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);e.setFullYear(t.y);return e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Oy(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));e.setUTCFullYear(t.y);return e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Py(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Dy(t){var i=t.dateTime,a=t.date,r=t.time,e=t.periods,n=t.days,o=t.shortDays,s=t.months,l=t.shortMonths;var u=Hy(e),h=Vy(e),c=Hy(n),f=Vy(n),d=Hy(o),g=Vy(o),p=Hy(s),v=Vy(s),m=Hy(l),_=Vy(l);var y={a:P,A:D,b:N,B:z,c:null,d:ub,e:ub,f:gb,H:hb,I:cb,j:fb,L:db,m:pb,M:vb,p:F,q:L,Q:Gb,s:Wb,S:mb,u:_b,U:yb,V:bb,w:wb,W:xb,x:null,X:null,y:kb,Y:Sb,Z:Cb,"%":Ub};var b={a:j,A:I,b:H,B:V,c:null,d:Ab,e:Ab,f:Bb,H:Eb,I:Mb,j:Rb,L:Tb,m:Ob,M:Pb,p:U,q:G,Q:Gb,s:Wb,S:Db,u:Nb,U:zb,V:Fb,w:Lb,W:jb,x:null,X:null,y:Ib,Y:Hb,Z:Vb,"%":Ub};var w={a:A,A:E,b:M,B:R,c:T,d:Qy,e:Qy,f:rb,H:eb,I:eb,j:tb,L:ab,m:$y,M:nb,p:C,q:Jy,Q:sb,s:lb,S:ib,u:Gy,U:Wy,V:Ky,w:Uy,W:qy,x:B,X:O,y:Xy,Y:Yy,Z:Zy,"%":ob};y.x=x(a,y);y.X=x(r,y);y.c=x(i,y);b.x=x(a,b);b.X=x(r,b);b.c=x(i,b);function x(l,u){return function(t){var e=[],n=-1,i=0,a=l.length,r,o,s;if(!(t instanceof Date))t=new Date(+t);while(++n<a){if(l.charCodeAt(n)===37){e.push(l.slice(i,n));if((o=Ny[r=l.charAt(++n)])!=null)r=l.charAt(++n);else o=r==="e"?" ":"0";if(s=u[r])r=s(t,o);e.push(r);i=n+1}}e.push(l.slice(i,n));return e.join("")}}function k(r,o){return function(t){var e=Py(1900,undefined,1),n=S(e,r,t+="",0),i,a;if(n!=t.length)return null;if("Q"in e)return new Date(e.Q);if("s"in e)return new Date(e.s*1e3+("L"in e?e.L:0));if(o&&!("Z"in e))e.Z=0;if("p"in e)e.H=e.H%12+e.p*12;if(e.m===undefined)e.m="q"in e?e.q:0;if("V"in e){if(e.V<1||e.V>53)return null;if(!("w"in e))e.w=1;if("Z"in e){i=Oy(Py(e.y,0,1)),a=i.getUTCDay();i=a>4||a===0?ky.ceil(i):ky(i);i=by.offset(i,(e.V-1)*7);e.y=i.getUTCFullYear();e.m=i.getUTCMonth();e.d=i.getUTCDate()+(e.w+6)%7}else{i=By(Py(e.y,0,1)),a=i.getDay();i=a>4||a===0?hy.ceil(i):hy(i);i=sy.offset(i,(e.V-1)*7);e.y=i.getFullYear();e.m=i.getMonth();e.d=i.getDate()+(e.w+6)%7}}else if("W"in e||"U"in e){if(!("w"in e))e.w="u"in e?e.u%7:"W"in e?1:0;a="Z"in e?Oy(Py(e.y,0,1)).getUTCDay():By(Py(e.y,0,1)).getDay();e.m=0;e.d="W"in e?(e.w+6)%7+e.W*7-(a+5)%7:e.w+e.U*7-(a+6)%7}if("Z"in e){e.H+=e.Z/100|0;e.M+=e.Z%100;return Oy(e)}return By(e)}}function S(t,e,n,i){var a=0,r=e.length,o=n.length,s,l;while(a<r){if(i>=o)return-1;s=e.charCodeAt(a++);if(s===37){s=e.charAt(a++);l=w[s in Ny?e.charAt(a++):s];if(!l||(i=l(t,n,i))<0)return-1}else if(s!=n.charCodeAt(i++)){return-1}}return i}function C(t,e,n){var i=u.exec(e.slice(n));return i?(t.p=h[i[0].toLowerCase()],n+i[0].length):-1}function A(t,e,n){var i=d.exec(e.slice(n));return i?(t.w=g[i[0].toLowerCase()],n+i[0].length):-1}function E(t,e,n){var i=c.exec(e.slice(n));return i?(t.w=f[i[0].toLowerCase()],n+i[0].length):-1}function M(t,e,n){var i=m.exec(e.slice(n));return i?(t.m=_[i[0].toLowerCase()],n+i[0].length):-1}function R(t,e,n){var i=p.exec(e.slice(n));return i?(t.m=v[i[0].toLowerCase()],n+i[0].length):-1}function T(t,e,n){return S(t,i,e,n)}function B(t,e,n){return S(t,a,e,n)}function O(t,e,n){return S(t,r,e,n)}function P(t){return o[t.getDay()]}function D(t){return n[t.getDay()]}function N(t){return l[t.getMonth()]}function z(t){return s[t.getMonth()]}function F(t){return e[+(t.getHours()>=12)]}function L(t){return 1+~~(t.getMonth()/3)}function j(t){return o[t.getUTCDay()]}function I(t){return n[t.getUTCDay()]}function H(t){return l[t.getUTCMonth()]}function V(t){return s[t.getUTCMonth()]}function U(t){return e[+(t.getUTCHours()>=12)]}function G(t){return 1+~~(t.getUTCMonth()/3)}return{format:function t(e){var n=x(e+="",y);n.toString=function(){return e};return n},parse:function t(e){var n=k(e+="",false);n.toString=function(){return e};return n},utcFormat:function t(e){var n=x(e+="",b);n.toString=function(){return e};return n},utcParse:function t(e){var n=k(e+="",true);n.toString=function(){return e};return n}}}var Ny={"-":"",_:" ",0:"0"},zy=/^\s*\d+/,Fy=/^%/,Ly=/[\\^$*+?|[\]().{}]/g;function jy(t,e,n){var i=t<0?"-":"",a=(i?-t:t)+"",r=a.length;return i+(r<n?new Array(n-r+1).join(e)+a:a)}function Iy(t){return t.replace(Ly,"\\$&")}function Hy(t){return new RegExp("^(?:"+t.map(Iy).join("|")+")","i")}function Vy(t){var e={},n=-1,i=t.length;while(++n<i){e[t[n].toLowerCase()]=n}return e}function Uy(t,e,n){var i=zy.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Gy(t,e,n){var i=zy.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function Wy(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function Ky(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function qy(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function Yy(t,e,n){var i=zy.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Xy(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Zy(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function Jy(t,e,n){var i=zy.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function $y(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Qy(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function tb(t,e,n){var i=zy.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function eb(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function nb(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function ib(t,e,n){var i=zy.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function ab(t,e,n){var i=zy.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function rb(t,e,n){var i=zy.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function ob(t,e,n){var i=Fy.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function sb(t,e,n){var i=zy.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function lb(t,e,n){var i=zy.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function ub(t,e){return jy(t.getDate(),e,2)}function hb(t,e){return jy(t.getHours(),e,2)}function cb(t,e){return jy(t.getHours()%12||12,e,2)}function fb(t,e){return jy(1+sy.count(my(t),t),e,3)}function db(t,e){return jy(t.getMilliseconds(),e,3)}function gb(t,e){return db(t,e)+"000"}function pb(t,e){return jy(t.getMonth()+1,e,2)}function vb(t,e){return jy(t.getMinutes(),e,2)}function mb(t,e){return jy(t.getSeconds(),e,2)}function _b(t){var e=t.getDay();return e===0?7:e}function yb(t,e){return jy(uy.count(my(t)-1,t),e,2)}function bb(t,e){var n=t.getDay();t=n>=4||n===0?dy(t):dy.ceil(t);return jy(dy.count(my(t),t)+(my(t).getDay()===4),e,2)}function wb(t){return t.getDay()}function xb(t,e){return jy(hy.count(my(t)-1,t),e,2)}function kb(t,e){return jy(t.getFullYear()%100,e,2)}function Sb(t,e){return jy(t.getFullYear()%1e4,e,4)}function Cb(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+jy(e/60|0,"0",2)+jy(e%60,"0",2)}function Ab(t,e){return jy(t.getUTCDate(),e,2)}function Eb(t,e){return jy(t.getUTCHours(),e,2)}function Mb(t,e){return jy(t.getUTCHours()%12||12,e,2)}function Rb(t,e){return jy(1+by.count(Ty(t),t),e,3)}function Tb(t,e){return jy(t.getUTCMilliseconds(),e,3)}function Bb(t,e){return Tb(t,e)+"000"}function Ob(t,e){return jy(t.getUTCMonth()+1,e,2)}function Pb(t,e){return jy(t.getUTCMinutes(),e,2)}function Db(t,e){return jy(t.getUTCSeconds(),e,2)}function Nb(t){var e=t.getUTCDay();return e===0?7:e}function zb(t,e){return jy(xy.count(Ty(t)-1,t),e,2)}function Fb(t,e){var n=t.getUTCDay();t=n>=4||n===0?Ay(t):Ay.ceil(t);return jy(Ay.count(Ty(t),t)+(Ty(t).getUTCDay()===4),e,2)}function Lb(t){return t.getUTCDay()}function jb(t,e){return jy(ky.count(Ty(t)-1,t),e,2)}function Ib(t,e){return jy(t.getUTCFullYear()%100,e,2)}function Hb(t,e){return jy(t.getUTCFullYear()%1e4,e,4)}function Vb(){return"+0000"}function Ub(){return"%"}function Gb(t){return+t}function Wb(t){return Math.floor(+t/1e3)}var Kb;var qb;var Yb;var Xb;var Zb;Jb({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Jb(t){Kb=Dy(t);qb=Kb.format;Yb=Kb.parse;Xb=Kb.utcFormat;Zb=Kb.utcParse;return Kb}var $b=1e3,Qb=$b*60,tw=Qb*60,ew=tw*24,nw=ew*7,iw=ew*30,aw=ew*365;function rw(t){return new Date(t)}function ow(t){return t instanceof Date?+t:+new Date(+t)}function sw(o,e,n,i,a,r,s,l,u){var h=Jm(Gm,Gm),c=h.invert,f=h.domain;var d=u(".%L"),g=u(":%S"),p=u("%I:%M"),v=u("%I %p"),m=u("%a %d"),_=u("%b %d"),y=u("%B"),b=u("%Y");var w=[[s,1,$b],[s,5,5*$b],[s,15,15*$b],[s,30,30*$b],[r,1,Qb],[r,5,5*Qb],[r,15,15*Qb],[r,30,30*Qb],[a,1,tw],[a,3,3*tw],[a,6,6*tw],[a,12,12*tw],[i,1,ew],[i,2,2*ew],[n,1,nw],[e,1,iw],[e,3,3*iw],[o,1,aw]];function x(t){return(s(t)<t?d:r(t)<t?g:a(t)<t?p:i(t)<t?v:e(t)<t?n(t)<t?m:_:o(t)<t?y:b)(t)}function k(t,e,n,i){if(t==null)t=10;if(typeof t==="number"){var a=Math.abs(n-e)/t,r=qv(function(t){return t[2]}).right(w,a);if(r===w.length){i=sm(e/aw,n/aw,t);t=o}else if(r){r=w[a/w[r-1][2]<w[r][2]/a?r-1:r];i=r[1];t=r[0]}else{i=Math.max(sm(e,n,t),1);t=l}}return i==null?t:t.every(i)}h.invert=function(t){return new Date(c(t))};h.domain=function(t){return arguments.length?f(Dm.call(t,ow)):f().map(rw)};h.ticks=function(t,e){var n=f(),i=n[0],a=n[n.length-1],r=a<i,o;if(r)o=i,i=a,a=o;o=k(t,i,a,e);o=o?o.range(i,a+1):[];return r?o.reverse():o};h.tickFormat=function(t,e){return e==null?x:u(e)};h.nice=function(t,e){var n=f();return(t=k(t,n[0],n[n.length-1],e))?f(C_(n,t)):h};h.copy=function(){return Xm(h,sw(o,e,n,i,a,r,s,l,u))};return h}function lw(){return Bm.apply(sw(my,vy,uy,sy,oy,ry,ay,$_,qb).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function uw(){return Bm.apply(sw(Ty,Ry,xy,by,yy,_y,ay,$_,Xb).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function hw(){var e=0,n=1,i,a,r,o,s=Gm,l=false,u;function h(t){return isNaN(t=+t)?u:s(r===0?.5:(t=(o(t)-i)*r,l?Math.max(0,Math.min(1,t)):t))}h.domain=function(t){return arguments.length?(i=o(e=+t[0]),a=o(n=+t[1]),r=i===a?0:1/(a-i),h):[e,n]};h.clamp=function(t){return arguments.length?(l=!!t,h):l};h.interpolator=function(t){return arguments.length?(s=t,h):s};h.unknown=function(t){return arguments.length?(u=t,h):u};return function(t){o=t,i=t(e),a=t(n),r=i===a?0:1/(a-i);return h}}function cw(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function fw(){var t=x_(hw()(Gm));t.copy=function(){return cw(t,fw())};return Om.apply(t,arguments)}function dw(){var t=D_(hw()).domain([1,10]);t.copy=function(){return cw(t,dw()).base(t.base())};return Om.apply(t,arguments)}function gw(){var t=L_(hw());t.copy=function(){return cw(t,gw()).constant(t.constant())};return Om.apply(t,arguments)}function pw(){var t=U_(hw());t.copy=function(){return cw(t,pw()).exponent(t.exponent())};return Om.apply(t,arguments)}function vw(){return pw.apply(null,arguments).exponent(.5)}function mw(){var a=[],e=Gm;function r(t){if(!isNaN(t=+t))return e((Zv(a,t)-1)/(a.length-1))}r.domain=function(t){if(!arguments.length)return a.slice();a=[];for(var e=0,n=t.length,i;e<n;++e){if(i=t[e],i!=null&&!isNaN(i=+i))a.push(i)}a.sort(Kv);return r};r.interpolator=function(t){return arguments.length?(e=t,r):e};r.copy=function(){return mw(e).domain(a)};return Om.apply(r,arguments)}function _w(){var e=0,n=.5,i=1,a,r,o,s,l,u=Gm,h,c=false,f;function d(t){return isNaN(t=+t)?f:(t=.5+((t=+h(t))-r)*(t<r?s:l),u(c?Math.max(0,Math.min(1,t)):t))}d.domain=function(t){return arguments.length?(a=h(e=+t[0]),r=h(n=+t[1]),o=h(i=+t[2]),s=a===r?0:.5/(r-a),l=r===o?0:.5/(o-r),d):[e,n,i]};d.clamp=function(t){return arguments.length?(c=!!t,d):c};d.interpolator=function(t){return arguments.length?(u=t,d):u};d.unknown=function(t){return arguments.length?(f=t,d):f};return function(t){h=t,a=t(e),r=t(n),o=t(i),s=a===r?0:.5/(r-a),l=r===o?0:.5/(o-r);return d}}function yw(){var t=x_(_w()(Gm));t.copy=function(){return cw(t,yw())};return Om.apply(t,arguments)}function bw(){var t=D_(_w()).domain([.1,1,10]);t.copy=function(){return cw(t,bw()).base(t.base())};return Om.apply(t,arguments)}function ww(){var t=L_(_w());t.copy=function(){return cw(t,ww()).constant(t.constant())};return Om.apply(t,arguments)}function xw(){var t=U_(_w());t.copy=function(){return cw(t,xw()).exponent(t.exponent())};return Om.apply(t,arguments)}function kw(){return xw.apply(null,arguments).exponent(.5)}var Sw=Object.freeze({__proto__:null,scaleBand:Lm,scalePoint:Im,scaleIdentity:S_,scaleLinear:k_,scaleLog:N_,scaleSymlog:j_,scaleOrdinal:Fm,scaleImplicit:zm,scalePow:G_,scaleSqrt:W_,scaleQuantile:K_,scaleQuantize:q_,scaleThreshold:Y_,scaleTime:lw,scaleUtc:uw,scaleSequential:fw,scaleSequentialLog:dw,scaleSequentialPow:pw,scaleSequentialSqrt:vw,scaleSequentialSymlog:gw,scaleSequentialQuantile:mw,scaleDiverging:yw,scaleDivergingLog:bw,scaleDivergingPow:xw,scaleDivergingSqrt:kw,scaleDivergingSymlog:ww,tickFormat:w_});var Cw=Math.PI,Aw=2*Cw,Ew=1e-6,Mw=Aw-Ew;function Rw(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function Tw(){return new Rw}Rw.prototype=Tw.prototype={constructor:Rw,moveTo:function t(e,n){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+n)},closePath:function t(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function t(e,n){this._+="L"+(this._x1=+e)+","+(this._y1=+n)},quadraticCurveTo:function t(e,n,i,a){this._+="Q"+ +e+","+ +n+","+(this._x1=+i)+","+(this._y1=+a)},bezierCurveTo:function t(e,n,i,a,r,o){this._+="C"+ +e+","+ +n+","+ +i+","+ +a+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function t(e,n,i,a,r){e=+e,n=+n,i=+i,a=+a,r=+r;var o=this._x1,s=this._y1,l=i-e,u=a-n,h=o-e,c=s-n,f=h*h+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null){this._+="M"+(this._x1=e)+","+(this._y1=n)}else if(!(f>Ew));else if(!(Math.abs(c*l-u*h)>Ew)||!r){this._+="L"+(this._x1=e)+","+(this._y1=n)}else{var d=i-o,g=a-s,p=l*l+u*u,v=d*d+g*g,m=Math.sqrt(p),_=Math.sqrt(f),y=r*Math.tan((Cw-Math.acos((p+f-v)/(2*m*_)))/2),b=y/_,w=y/m;if(Math.abs(b-1)>Ew){this._+="L"+(e+b*h)+","+(n+b*c)}this._+="A"+r+","+r+",0,0,"+ +(c*d>h*g)+","+(this._x1=e+w*l)+","+(this._y1=n+w*u)}},arc:function t(e,n,i,a,r,o){e=+e,n=+n,i=+i,o=!!o;var s=i*Math.cos(a),l=i*Math.sin(a),u=e+s,h=n+l,c=1^o,f=o?a-r:r-a;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null){this._+="M"+u+","+h}else if(Math.abs(this._x1-u)>Ew||Math.abs(this._y1-h)>Ew){this._+="L"+u+","+h}if(!i)return;if(f<0)f=f%Aw+Aw;if(f>Mw){this._+="A"+i+","+i+",0,1,"+c+","+(e-s)+","+(n-l)+"A"+i+","+i+",0,1,"+c+","+(this._x1=u)+","+(this._y1=h)}else if(f>Ew){this._+="A"+i+","+i+",0,"+ +(f>=Cw)+","+c+","+(this._x1=e+i*Math.cos(r))+","+(this._y1=n+i*Math.sin(r))}},rect:function t(e,n,i,a){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+n)+"h"+ +i+"v"+ +a+"h"+-i+"Z"},toString:function t(){return this._}};function Bw(e){return function t(){return e}}var Ow=Math.abs;var Pw=Math.atan2;var Dw=Math.cos;var Nw=Math.max;var zw=Math.min;var Fw=Math.sin;var Lw=Math.sqrt;var jw=1e-12;var Iw=Math.PI;var Hw=Iw/2;var Vw=2*Iw;function Uw(t){return t>1?0:t<-1?Iw:Math.acos(t)}function Gw(t){return t>=1?Hw:t<=-1?-Hw:Math.asin(t)}function Ww(t){return t.innerRadius}function Kw(t){return t.outerRadius}function qw(t){return t.startAngle}function Yw(t){return t.endAngle}function Xw(t){return t&&t.padAngle}function Zw(t,e,n,i,a,r,o,s){var l=n-t,u=i-e,h=o-a,c=s-r,f=c*l-h*u;if(f*f<jw)return;f=(h*(e-r)-c*(t-a))/f;return[t+f*l,e+f*u]}function Jw(t,e,n,i,a,r,o){var s=t-n,l=e-i,u=(o?r:-r)/Lw(s*s+l*l),h=u*l,c=-u*s,f=t+h,d=e+c,g=n+h,p=i+c,v=(f+g)/2,m=(d+p)/2,_=g-f,y=p-d,b=_*_+y*y,w=a-r,x=f*p-g*d,k=(y<0?-1:1)*Lw(Nw(0,w*w*b-x*x)),S=(x*y-_*k)/b,C=(-x*_-y*k)/b,A=(x*y+_*k)/b,E=(-x*_+y*k)/b,M=S-v,R=C-m,T=A-v,B=E-m;if(M*M+R*R>T*T+B*B)S=A,C=E;return{cx:S,cy:C,x01:-h,y01:-c,x11:S*(a/w-1),y11:C*(a/w-1)}}function $w(){var L=Ww,j=Kw,I=Bw(0),H=null,V=qw,U=Yw,G=Xw,W=null;function e(){var t,e,n=+L.apply(this,arguments),i=+j.apply(this,arguments),a=V.apply(this,arguments)-Hw,r=U.apply(this,arguments)-Hw,o=Ow(r-a),s=r>a;if(!W)W=t=Tw();if(i<n)e=i,i=n,n=e;if(!(i>jw))W.moveTo(0,0);else if(o>Vw-jw){W.moveTo(i*Dw(a),i*Fw(a));W.arc(0,0,i,a,r,!s);if(n>jw){W.moveTo(n*Dw(r),n*Fw(r));W.arc(0,0,n,r,a,s)}}else{var l=a,u=r,h=a,c=r,f=o,d=o,g=G.apply(this,arguments)/2,p=g>jw&&(H?+H.apply(this,arguments):Lw(n*n+i*i)),v=zw(Ow(i-n)/2,+I.apply(this,arguments)),m=v,_=v,y,b;if(p>jw){var w=Gw(p/n*Fw(g)),x=Gw(p/i*Fw(g));if((f-=w*2)>jw)w*=s?1:-1,h+=w,c-=w;else f=0,h=c=(a+r)/2;if((d-=x*2)>jw)x*=s?1:-1,l+=x,u-=x;else d=0,l=u=(a+r)/2}var k=i*Dw(l),S=i*Fw(l),C=n*Dw(c),A=n*Fw(c);if(v>jw){var E=i*Dw(u),M=i*Fw(u),R=n*Dw(h),T=n*Fw(h),B;if(o<Iw&&(B=Zw(k,S,R,T,E,M,C,A))){var O=k-B[0],P=S-B[1],D=E-B[0],N=M-B[1],z=1/Fw(Uw((O*D+P*N)/(Lw(O*O+P*P)*Lw(D*D+N*N)))/2),F=Lw(B[0]*B[0]+B[1]*B[1]);m=zw(v,(n-F)/(z-1));_=zw(v,(i-F)/(z+1))}}if(!(d>jw))W.moveTo(k,S);else if(_>jw){y=Jw(R,T,k,S,i,_,s);b=Jw(E,M,C,A,i,_,s);W.moveTo(y.cx+y.x01,y.cy+y.y01);if(_<v)W.arc(y.cx,y.cy,_,Pw(y.y01,y.x01),Pw(b.y01,b.x01),!s);else{W.arc(y.cx,y.cy,_,Pw(y.y01,y.x01),Pw(y.y11,y.x11),!s);W.arc(0,0,i,Pw(y.cy+y.y11,y.cx+y.x11),Pw(b.cy+b.y11,b.cx+b.x11),!s);W.arc(b.cx,b.cy,_,Pw(b.y11,b.x11),Pw(b.y01,b.x01),!s)}}else W.moveTo(k,S),W.arc(0,0,i,l,u,!s);if(!(n>jw)||!(f>jw))W.lineTo(C,A);else if(m>jw){y=Jw(C,A,E,M,n,-m,s);b=Jw(k,S,R,T,n,-m,s);W.lineTo(y.cx+y.x01,y.cy+y.y01);if(m<v)W.arc(y.cx,y.cy,m,Pw(y.y01,y.x01),Pw(b.y01,b.x01),!s);else{W.arc(y.cx,y.cy,m,Pw(y.y01,y.x01),Pw(y.y11,y.x11),!s);W.arc(0,0,n,Pw(y.cy+y.y11,y.cx+y.x11),Pw(b.cy+b.y11,b.cx+b.x11),s);W.arc(b.cx,b.cy,m,Pw(b.y11,b.x11),Pw(b.y01,b.x01),!s)}}else W.arc(0,0,n,c,h,s)}W.closePath();if(t)return W=null,t+""||null}e.centroid=function(){var t=(+L.apply(this,arguments)+ +j.apply(this,arguments))/2,e=(+V.apply(this,arguments)+ +U.apply(this,arguments))/2-Iw/2;return[Dw(e)*t,Fw(e)*t]};e.innerRadius=function(t){return arguments.length?(L=typeof t==="function"?t:Bw(+t),e):L};e.outerRadius=function(t){return arguments.length?(j=typeof t==="function"?t:Bw(+t),e):j};e.cornerRadius=function(t){return arguments.length?(I=typeof t==="function"?t:Bw(+t),e):I};e.padRadius=function(t){return arguments.length?(H=t==null?null:typeof t==="function"?t:Bw(+t),e):H};e.startAngle=function(t){return arguments.length?(V=typeof t==="function"?t:Bw(+t),e):V};e.endAngle=function(t){return arguments.length?(U=typeof t==="function"?t:Bw(+t),e):U};e.padAngle=function(t){return arguments.length?(G=typeof t==="function"?t:Bw(+t),e):G};e.context=function(t){return arguments.length?(W=t==null?null:t,e):W};return e}function Qw(t){this._context=t}Qw.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._point=0},lineEnd:function t(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function t(e,n){e=+e,n=+n;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function tx(t){return new Qw(t)}function ex(t){return t[0]}function nx(t){return t[1]}function ix(){var o=ex,s=nx,l=Bw(true),u=null,h=tx,c=null;function e(t){var e,n=t.length,i,a=false,r;if(u==null)c=h(r=Tw());for(e=0;e<=n;++e){if(!(e<n&&l(i=t[e],e,t))===a){if(a=!a)c.lineStart();else c.lineEnd()}if(a)c.point(+o(i,e,t),+s(i,e,t))}if(r)return c=null,r+""||null}e.x=function(t){return arguments.length?(o=typeof t==="function"?t:Bw(+t),e):o};e.y=function(t){return arguments.length?(s=typeof t==="function"?t:Bw(+t),e):s};e.defined=function(t){return arguments.length?(l=typeof t==="function"?t:Bw(!!t),e):l};e.curve=function(t){return arguments.length?(h=t,u!=null&&(c=h(u)),e):h};e.context=function(t){return arguments.length?(t==null?u=c=null:c=h(u=t),e):u};return e}function ax(){var h=ex,c=null,f=Bw(0),d=nx,g=Bw(true),p=null,v=tx,m=null;function e(t){var e,n,i,a=t.length,r,o=false,s,l=new Array(a),u=new Array(a);if(p==null)m=v(s=Tw());for(e=0;e<=a;++e){if(!(e<a&&g(r=t[e],e,t))===o){if(o=!o){n=e;m.areaStart();m.lineStart()}else{m.lineEnd();m.lineStart();for(i=e-1;i>=n;--i){m.point(l[i],u[i])}m.lineEnd();m.areaEnd()}}if(o){l[e]=+h(r,e,t),u[e]=+f(r,e,t);m.point(c?+c(r,e,t):l[e],d?+d(r,e,t):u[e])}}if(s)return m=null,s+""||null}function t(){return ix().defined(g).curve(v).context(p)}e.x=function(t){return arguments.length?(h=typeof t==="function"?t:Bw(+t),c=null,e):h};e.x0=function(t){return arguments.length?(h=typeof t==="function"?t:Bw(+t),e):h};e.x1=function(t){return arguments.length?(c=t==null?null:typeof t==="function"?t:Bw(+t),e):c};e.y=function(t){return arguments.length?(f=typeof t==="function"?t:Bw(+t),d=null,e):f};e.y0=function(t){return arguments.length?(f=typeof t==="function"?t:Bw(+t),e):f};e.y1=function(t){return arguments.length?(d=t==null?null:typeof t==="function"?t:Bw(+t),e):d};e.lineX0=e.lineY0=function(){return t().x(h).y(f)};e.lineY1=function(){return t().x(h).y(d)};e.lineX1=function(){return t().x(c).y(f)};e.defined=function(t){return arguments.length?(g=typeof t==="function"?t:Bw(!!t),e):g};e.curve=function(t){return arguments.length?(v=t,p!=null&&(m=v(p)),e):v};e.context=function(t){return arguments.length?(t==null?p=m=null:m=v(p=t),e):p};return e}function rx(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function ox(t){return t}function sx(){var g=ox,p=rx,v=null,m=Bw(0),_=Bw(Vw),y=Bw(0);function e(n){var t,e=n.length,i,a,r=0,o=new Array(e),s=new Array(e),l=+m.apply(this,arguments),u=Math.min(Vw,Math.max(-Vw,_.apply(this,arguments)-l)),h,c=Math.min(Math.abs(u)/e,y.apply(this,arguments)),f=c*(u<0?-1:1),d;for(t=0;t<e;++t){if((d=s[o[t]=t]=+g(n[t],t,n))>0){r+=d}}if(p!=null)o.sort(function(t,e){return p(s[t],s[e])});else if(v!=null)o.sort(function(t,e){return v(n[t],n[e])});for(t=0,a=r?(u-e*f)/r:0;t<e;++t,l=h){i=o[t],d=s[i],h=l+(d>0?d*a:0)+f,s[i]={data:n[i],index:t,value:d,startAngle:l,endAngle:h,padAngle:c}}return s}e.value=function(t){return arguments.length?(g=typeof t==="function"?t:Bw(+t),e):g};e.sortValues=function(t){return arguments.length?(p=t,v=null,e):p};e.sort=function(t){return arguments.length?(v=t,p=null,e):v};e.startAngle=function(t){return arguments.length?(m=typeof t==="function"?t:Bw(+t),e):m};e.endAngle=function(t){return arguments.length?(_=typeof t==="function"?t:Bw(+t),e):_};e.padAngle=function(t){return arguments.length?(y=typeof t==="function"?t:Bw(+t),e):y};return e}var lx=hx(tx);function ux(t){this._curve=t}ux.prototype={areaStart:function t(){this._curve.areaStart()},areaEnd:function t(){this._curve.areaEnd()},lineStart:function t(){this._curve.lineStart()},lineEnd:function t(){this._curve.lineEnd()},point:function t(e,n){this._curve.point(n*Math.sin(e),n*-Math.cos(e))}};function hx(e){function t(t){return new ux(e(t))}t._curve=e;return t}function cx(t){var e=t.curve;t.angle=t.x,delete t.x;t.radius=t.y,delete t.y;t.curve=function(t){return arguments.length?e(hx(t)):e()._curve};return t}function fx(){return cx(ix().curve(lx))}function dx(){var t=ax().curve(lx),e=t.curve,n=t.lineX0,i=t.lineX1,a=t.lineY0,r=t.lineY1;t.angle=t.x,delete t.x;t.startAngle=t.x0,delete t.x0;t.endAngle=t.x1,delete t.x1;t.radius=t.y,delete t.y;t.innerRadius=t.y0,delete t.y0;t.outerRadius=t.y1,delete t.y1;t.lineStartAngle=function(){return cx(n())},delete t.lineX0;t.lineEndAngle=function(){return cx(i())},delete t.lineX1;t.lineInnerRadius=function(){return cx(a())},delete t.lineY0;t.lineOuterRadius=function(){return cx(r())},delete t.lineY1;t.curve=function(t){return arguments.length?e(hx(t)):e()._curve};return t}function gx(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}var px=Array.prototype.slice;function vx(t){return t.source}function mx(t){return t.target}function _x(a){var r=vx,o=mx,s=ex,l=nx,u=null;function e(){var t,e=px.call(arguments),n=r.apply(this,e),i=o.apply(this,e);if(!u)u=t=Tw();a(u,+s.apply(this,(e[0]=n,e)),+l.apply(this,e),+s.apply(this,(e[0]=i,e)),+l.apply(this,e));if(t)return u=null,t+""||null}e.source=function(t){return arguments.length?(r=t,e):r};e.target=function(t){return arguments.length?(o=t,e):o};e.x=function(t){return arguments.length?(s=typeof t==="function"?t:Bw(+t),e):s};e.y=function(t){return arguments.length?(l=typeof t==="function"?t:Bw(+t),e):l};e.context=function(t){return arguments.length?(u=t==null?null:t,e):u};return e}function yx(t,e,n,i,a){t.moveTo(e,n);t.bezierCurveTo(e=(e+i)/2,n,e,a,i,a)}function bx(t,e,n,i,a){t.moveTo(e,n);t.bezierCurveTo(e,n=(n+a)/2,i,n,i,a)}function wx(t,e,n,i,a){var r=gx(e,n),o=gx(e,n=(n+a)/2),s=gx(i,n),l=gx(i,a);t.moveTo(r[0],r[1]);t.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}function xx(){return _x(yx)}function kx(){return _x(bx)}function Sx(){var t=_x(wx);t.angle=t.x,delete t.x;t.radius=t.y,delete t.y;return t}var Cx={draw:function t(e,n){var i=Math.sqrt(n/Iw);e.moveTo(i,0);e.arc(0,0,i,0,Vw)}};var Ax={draw:function t(e,n){var i=Math.sqrt(n/5)/2;e.moveTo(-3*i,-i);e.lineTo(-i,-i);e.lineTo(-i,-3*i);e.lineTo(i,-3*i);e.lineTo(i,-i);e.lineTo(3*i,-i);e.lineTo(3*i,i);e.lineTo(i,i);e.lineTo(i,3*i);e.lineTo(-i,3*i);e.lineTo(-i,i);e.lineTo(-3*i,i);e.closePath()}};var Ex=Math.sqrt(1/3),Mx=Ex*2;var Rx={draw:function t(e,n){var i=Math.sqrt(n/Mx),a=i*Ex;e.moveTo(0,-i);e.lineTo(a,0);e.lineTo(0,i);e.lineTo(-a,0);e.closePath()}};var Tx=.8908130915292852,Bx=Math.sin(Iw/10)/Math.sin(7*Iw/10),Ox=Math.sin(Vw/10)*Bx,Px=-Math.cos(Vw/10)*Bx;var Dx={draw:function t(e,n){var i=Math.sqrt(n*Tx),a=Ox*i,r=Px*i;e.moveTo(0,-i);e.lineTo(a,r);for(var o=1;o<5;++o){var s=Vw*o/5,l=Math.cos(s),u=Math.sin(s);e.lineTo(u*i,-l*i);e.lineTo(l*a-u*r,u*a+l*r)}e.closePath()}};var Nx={draw:function t(e,n){var i=Math.sqrt(n),a=-i/2;e.rect(a,a,i,i)}};var zx=Math.sqrt(3);var Fx={draw:function t(e,n){var i=-Math.sqrt(n/(zx*3));e.moveTo(0,i*2);e.lineTo(-zx*i,-i);e.lineTo(zx*i,-i);e.closePath()}};var Lx=-.5,jx=Math.sqrt(3)/2,Ix=1/Math.sqrt(12),Hx=(Ix/2+1)*3;var Vx={draw:function t(e,n){var i=Math.sqrt(n/Hx),a=i/2,r=i*Ix,o=a,s=i*Ix+i,l=-o,u=s;e.moveTo(a,r);e.lineTo(o,s);e.lineTo(l,u);e.lineTo(Lx*a-jx*r,jx*a+Lx*r);e.lineTo(Lx*o-jx*s,jx*o+Lx*s);e.lineTo(Lx*l-jx*u,jx*l+Lx*u);e.lineTo(Lx*a+jx*r,Lx*r-jx*a);e.lineTo(Lx*o+jx*s,Lx*s-jx*o);e.lineTo(Lx*l+jx*u,Lx*u-jx*l);e.closePath()}};var Ux=[Cx,Ax,Rx,Nx,Dx,Fx,Vx];function Gx(){var e=Bw(Cx),n=Bw(64),i=null;function a(){var t;if(!i)i=t=Tw();e.apply(this,arguments).draw(i,+n.apply(this,arguments));if(t)return i=null,t+""||null}a.type=function(t){return arguments.length?(e=typeof t==="function"?t:Bw(t),a):e};a.size=function(t){return arguments.length?(n=typeof t==="function"?t:Bw(+t),a):n};a.context=function(t){return arguments.length?(i=t==null?null:t,a):i};return a}function Wx(){}function Kx(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function qx(t){this._context=t}qx.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function t(){switch(this._point){case 3:Kx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function t(e,n){e=+e,n=+n;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Kx(this,e,n);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=n}};function Yx(t){return new qx(t)}function Xx(t){this._context=t}Xx.prototype={areaStart:Wx,areaEnd:Wx,lineStart:function t(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function t(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function t(e,n){e=+e,n=+n;switch(this._point){case 0:this._point=1;this._x2=e,this._y2=n;break;case 1:this._point=2;this._x3=e,this._y3=n;break;case 2:this._point=3;this._x4=e,this._y4=n;this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+n)/6);break;default:Kx(this,e,n);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=n}};function Zx(t){return new Xx(t)}function Jx(t){this._context=t}Jx.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function t(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function t(e,n){e=+e,n=+n;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(i,a):this._context.moveTo(i,a);break;case 3:this._point=4;default:Kx(this,e,n);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=n}};function $x(t){return new Jx(t)}function Qx(t,e){this._basis=new qx(t);this._beta=e}Qx.prototype={lineStart:function t(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function t(){var e=this._x,n=this._y,i=e.length-1;if(i>0){var a=e[0],r=n[0],o=e[i]-a,s=n[i]-r,l=-1,u;while(++l<=i){u=l/i;this._basis.point(this._beta*e[l]+(1-this._beta)*(a+u*o),this._beta*n[l]+(1-this._beta)*(r+u*s))}}this._x=this._y=null;this._basis.lineEnd()},point:function t(e,n){this._x.push(+e);this._y.push(+n)}};var tk=function e(n){function t(t){return n===1?new qx(t):new Qx(t,n)}t.beta=function(t){return e(+t)};return t}(.85);function ek(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function nk(t,e){this._context=t;this._k=(1-e)/6}nk.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function t(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ek(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function t(e,n){e=+e,n=+n;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;this._x1=e,this._y1=n;break;case 2:this._point=3;default:ek(this,e,n);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=n}};var ik=function e(n){function t(t){return new nk(t,n)}t.tension=function(t){return e(+t)};return t}(0);function ak(t,e){this._context=t;this._k=(1-e)/6}ak.prototype={areaStart:Wx,areaEnd:Wx,lineStart:function t(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function t(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function t(e,n){e=+e,n=+n;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=n;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=n);break;case 2:this._point=3;this._x5=e,this._y5=n;break;default:ek(this,e,n);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=n}};var rk=function e(n){function t(t){return new ak(t,n)}t.tension=function(t){return e(+t)};return t}(0);function ok(t,e){this._context=t;this._k=(1-e)/6}ok.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function t(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function t(e,n){e=+e,n=+n;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ek(this,e,n);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=n}};var sk=function e(n){function t(t){return new ok(t,n)}t.tension=function(t){return e(+t)};return t}(0);function lk(t,e,n){var i=t._x1,a=t._y1,r=t._x2,o=t._y2;if(t._l01_a>jw){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l;a=(a*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>jw){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,h=3*t._l23_a*(t._l23_a+t._l12_a);r=(r*u+t._x1*t._l23_2a-e*t._l12_2a)/h;o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/h}t._context.bezierCurveTo(i,a,r,o,t._x2,t._y2)}function uk(t,e){this._context=t;this._alpha=e}uk.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function t(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function t(e,n){e=+e,n=+n;if(this._point){var i=this._x2-e,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+a*a,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3;default:lk(this,e,n);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=n}};var hk=function e(n){function t(t){return n?new uk(t,n):new nk(t,0)}t.alpha=function(t){return e(+t)};return t}(.5);function ck(t,e){this._context=t;this._alpha=e}ck.prototype={areaStart:Wx,areaEnd:Wx,lineStart:function t(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function t(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function t(e,n){e=+e,n=+n;if(this._point){var i=this._x2-e,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+a*a,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=n;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=n);break;case 2:this._point=3;this._x5=e,this._y5=n;break;default:lk(this,e,n);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=n}};var fk=function e(n){function t(t){return n?new ck(t,n):new ak(t,0)}t.alpha=function(t){return e(+t)};return t}(.5);function dk(t,e){this._context=t;this._alpha=e}dk.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function t(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function t(e,n){e=+e,n=+n;if(this._point){var i=this._x2-e,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+a*a,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:lk(this,e,n);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=n}};var gk=function e(n){function t(t){return n?new dk(t,n):new ok(t,0)}t.alpha=function(t){return e(+t)};return t}(.5);function pk(t){this._context=t}pk.prototype={areaStart:Wx,areaEnd:Wx,lineStart:function t(){this._point=0},lineEnd:function t(){if(this._point)this._context.closePath()},point:function t(e,n){e=+e,n=+n;if(this._point)this._context.lineTo(e,n);else this._point=1,this._context.moveTo(e,n)}};function vk(t){return new pk(t)}function mk(t){return t<0?-1:1}function _k(t,e,n){var i=t._x1-t._x0,a=e-t._x1,r=(t._y1-t._y0)/(i||a<0&&-0),o=(n-t._y1)/(a||i<0&&-0),s=(r*a+o*i)/(i+a);return(mk(r)+mk(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(s))||0}function yk(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function bk(t,e,n){var i=t._x0,a=t._y0,r=t._x1,o=t._y1,s=(r-i)/3;t._context.bezierCurveTo(i+s,a+s*e,r-s,o-s*n,r,o)}function wk(t){this._context=t}wk.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function t(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:bk(this,this._t0,yk(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function t(e,n){var i=NaN;e=+e,n=+n;if(e===this._x1&&n===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3;bk(this,yk(this,i=_k(this,e,n)),i);break;default:bk(this,this._t0,i=_k(this,e,n));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=n;this._t0=i}};function xk(t){this._context=new kk(t)}(xk.prototype=Object.create(wk.prototype)).point=function(t,e){wk.prototype.point.call(this,e,t)};function kk(t){this._context=t}kk.prototype={moveTo:function t(e,n){this._context.moveTo(n,e)},closePath:function t(){this._context.closePath()},lineTo:function t(e,n){this._context.lineTo(n,e)},bezierCurveTo:function t(e,n,i,a,r,o){this._context.bezierCurveTo(n,e,a,i,o,r)}};function Sk(t){return new wk(t)}function Ck(t){return new xk(t)}function Ak(t){this._context=t}Ak.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x=[];this._y=[]},lineEnd:function t(){var e=this._x,n=this._y,i=e.length;if(i){this._line?this._context.lineTo(e[0],n[0]):this._context.moveTo(e[0],n[0]);if(i===2){this._context.lineTo(e[1],n[1])}else{var a=Ek(e),r=Ek(n);for(var o=0,s=1;s<i;++o,++s){this._context.bezierCurveTo(a[0][o],r[0][o],a[1][o],r[1][o],e[s],n[s])}}}if(this._line||this._line!==0&&i===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function t(e,n){this._x.push(+e);this._y.push(+n)}};function Ek(t){var e,n=t.length-1,i,a=new Array(n),r=new Array(n),o=new Array(n);a[0]=0,r[0]=2,o[0]=t[0]+2*t[1];for(e=1;e<n-1;++e){a[e]=1,r[e]=4,o[e]=4*t[e]+2*t[e+1]}a[n-1]=2,r[n-1]=7,o[n-1]=8*t[n-1]+t[n];for(e=1;e<n;++e){i=a[e]/r[e-1],r[e]-=i,o[e]-=i*o[e-1]}a[n-1]=o[n-1]/r[n-1];for(e=n-2;e>=0;--e){a[e]=(o[e]-a[e+1])/r[e]}r[n-1]=(t[n]+a[n-1])/2;for(e=0;e<n-1;++e){r[e]=2*t[e+1]-a[e+1]}return[a,r]}function Mk(t){return new Ak(t)}function Rk(t,e){this._context=t;this._t=e}Rk.prototype={areaStart:function t(){this._line=0},areaEnd:function t(){this._line=NaN},lineStart:function t(){this._x=this._y=NaN;this._point=0},lineEnd:function t(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function t(e,n){e=+e,n=+n;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,n);this._context.lineTo(e,n)}else{var i=this._x*(1-this._t)+e*this._t;this._context.lineTo(i,this._y);this._context.lineTo(i,n)}break}}this._x=e,this._y=n}};function Tk(t){return new Rk(t,.5)}function Bk(t){return new Rk(t,0)}function Ok(t){return new Rk(t,1)}function Pk(t,e){if(!((o=t.length)>1))return;for(var n=1,i,a,r=t[e[0]],o,s=r.length;n<o;++n){a=r,r=t[e[n]];for(i=0;i<s;++i){r[i][1]+=r[i][0]=isNaN(a[i][1])?a[i][0]:a[i][1]}}}function Dk(t){var e=t.length,n=new Array(e);while(--e>=0){n[e]=e}return n}function Nk(t,e){return t[e]}function zk(){var c=Bw([]),f=Dk,d=Pk,g=Nk;function e(t){var e=c.apply(this,arguments),n,i=t.length,a=e.length,r=new Array(a),o;for(n=0;n<a;++n){for(var s=e[n],l=r[n]=new Array(i),u=0,h;u<i;++u){l[u]=h=[0,+g(t[u],s,u,t)];h.data=t[u]}l.key=s}for(n=0,o=f(r);n<a;++n){r[o[n]].index=n}d(r,o);return r}e.keys=function(t){return arguments.length?(c=typeof t==="function"?t:Bw(px.call(t)),e):c};e.value=function(t){return arguments.length?(g=typeof t==="function"?t:Bw(+t),e):g};e.order=function(t){return arguments.length?(f=t==null?Dk:typeof t==="function"?t:Bw(px.call(t)),e):f};e.offset=function(t){return arguments.length?(d=t==null?Pk:t,e):d};return e}function Fk(t,e){if(!((i=t.length)>0))return;for(var n,i,a=0,r=t[0].length,o;a<r;++a){for(o=n=0;n<i;++n){o+=t[n][a][1]||0}if(o)for(n=0;n<i;++n){t[n][a][1]/=o}}Pk(t,e)}function Lk(t,e){if(!((l=t.length)>0))return;for(var n,i=0,a,r,o,s,l,u=t[e[0]].length;i<u;++i){for(o=s=0,n=0;n<l;++n){if((r=(a=t[e[n]][i])[1]-a[0])>0){a[0]=o,a[1]=o+=r}else if(r<0){a[1]=s,a[0]=s+=r}else{a[0]=0,a[1]=r}}}}function jk(t,e){if(!((a=t.length)>0))return;for(var n=0,i=t[e[0]],a,r=i.length;n<r;++n){for(var o=0,s=0;o<a;++o){s+=t[o][n][1]||0}i[n][1]+=i[n][0]=-s/2}Pk(t,e)}function Ik(t,e){if(!((o=t.length)>0)||!((r=(a=t[e[0]]).length)>0))return;for(var n=0,i=1,a,r,o;i<r;++i){for(var s=0,l=0,u=0;s<o;++s){var h=t[e[s]],c=h[i][1]||0,f=h[i-1][1]||0,d=(c-f)/2;for(var g=0;g<s;++g){var p=t[e[g]],v=p[i][1]||0,m=p[i-1][1]||0;d+=v-m}l+=c,u+=d*c}a[i-1][1]+=a[i-1][0]=n;if(l)n-=u/l}a[i-1][1]+=a[i-1][0]=n;Pk(t,e)}function Hk(t){var n=t.map(Vk);return Dk(t).sort(function(t,e){return n[t]-n[e]})}function Vk(t){var e=-1,n=0,i=t.length,a,r=-Infinity;while(++e<i){if((a=+t[e][1])>r)r=a,n=e}return n}function Uk(t){var n=t.map(Gk);return Dk(t).sort(function(t,e){return n[t]-n[e]})}function Gk(t){var e=0,n=-1,i=t.length,a;while(++n<i){if(a=+t[n][1])e+=a}return e}function Wk(t){return Uk(t).reverse()}function Kk(t){var e=t.length,n,i,a=t.map(Gk),r=Hk(t),o=0,s=0,l=[],u=[];for(n=0;n<e;++n){i=r[n];if(o<s){o+=a[i];l.push(i)}else{s+=a[i];u.push(i)}}return u.reverse().concat(l)}function qk(t){return Dk(t).reverse()}var Yk=Object.freeze({__proto__:null,arc:$w,area:ax,line:ix,pie:sx,areaRadial:dx,radialArea:dx,lineRadial:fx,radialLine:fx,pointRadial:gx,linkHorizontal:xx,linkVertical:kx,linkRadial:Sx,symbol:Gx,symbols:Ux,symbolCircle:Cx,symbolCross:Ax,symbolDiamond:Rx,symbolSquare:Nx,symbolStar:Dx,symbolTriangle:Fx,symbolWye:Vx,curveBasisClosed:Zx,curveBasisOpen:$x,curveBasis:Yx,curveBundle:tk,curveCardinalClosed:rk,curveCardinalOpen:sk,curveCardinal:ik,curveCatmullRomClosed:fk,curveCatmullRomOpen:gk,curveCatmullRom:hk,curveLinearClosed:vk,curveLinear:tx,curveMonotoneX:Sk,curveMonotoneY:Ck,curveNatural:Mk,curveStep:Tk,curveStepAfter:Ok,curveStepBefore:Bk,stack:zk,stackOffsetExpand:Fk,stackOffsetDiverging:Lk,stackOffsetNone:Pk,stackOffsetSilhouette:jk,stackOffsetWiggle:Ik,stackOrderAppearance:Hk,stackOrderAscending:Uk,stackOrderDescending:Wk,stackOrderInsideOut:Kk,stackOrderNone:Dk,stackOrderReverse:qk});function Xk(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Zk(t){return t=Xk(Math.abs(t)),t?t[1]:NaN}function Jk(s,l){return function(t,e){var n=t.length,i=[],a=0,r=s[0],o=0;while(n>0&&r>0){if(o+r+1>e)r=Math.max(1,e-o);i.push(t.substring(n-=r,n+r));if((o+=r+1)>e)break;r=s[a=(a+1)%s.length]}return i.reverse().join(l)}}function $k(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}var Qk=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tS(t){if(!(e=Qk.exec(t)))throw new Error("invalid format: "+t);var e;return new eS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}tS.prototype=eS.prototype;function eS(t){this.fill=t.fill===undefined?" ":t.fill+"";this.align=t.align===undefined?">":t.align+"";this.sign=t.sign===undefined?"-":t.sign+"";this.symbol=t.symbol===undefined?"":t.symbol+"";this.zero=!!t.zero;this.width=t.width===undefined?undefined:+t.width;this.comma=!!t.comma;this.precision=t.precision===undefined?undefined:+t.precision;this.trim=!!t.trim;this.type=t.type===undefined?"":t.type+""}eS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function nS(t){t:for(var e=t.length,n=1,i=-1,a;n<e;++n){switch(t[n]){case".":i=a=n;break;case"0":if(i===0)i=n;a=n;break;default:if(!+t[n])break t;if(i>0)i=0;break}}return i>0?t.slice(0,i)+t.slice(a+1):t}var iS;function aS(t,e){var n=Xk(t,e);if(!n)return t+"";var i=n[0],a=n[1],r=a-(iS=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=i.length;return r===o?i:r>o?i+new Array(r-o+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+Xk(t,Math.max(0,e+r-1))[0]}function rS(t,e){var n=Xk(t,e);if(!n)return t+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}var oS={"%":function t(e,n){return(e*100).toFixed(n)},b:function t(e){return Math.round(e).toString(2)},c:function t(e){return e+""},d:function t(e){return Math.round(e).toString(10)},e:function t(e,n){return e.toExponential(n)},f:function t(e,n){return e.toFixed(n)},g:function t(e,n){return e.toPrecision(n)},o:function t(e){return Math.round(e).toString(8)},p:function t(e,n){return rS(e*100,n)},r:rS,s:aS,X:function t(e){return Math.round(e).toString(16).toUpperCase()},x:function t(e){return Math.round(e).toString(16)}};function sS(t){return t}var lS=Array.prototype.map,uS=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function hS(t){var x=t.grouping===undefined||t.thousands===undefined?sS:Jk(lS.call(t.grouping,Number),t.thousands+""),i=t.currency===undefined?"":t.currency[0]+"",a=t.currency===undefined?"":t.currency[1]+"",k=t.decimal===undefined?".":t.decimal+"",S=t.numerals===undefined?sS:$k(lS.call(t.numerals,String)),r=t.percent===undefined?"%":t.percent+"",C=t.minus===undefined?"-":t.minus+"",A=t.nan===undefined?"NaN":t.nan+"";function o(t){t=tS(t);var u=t.fill,h=t.align,c=t.sign,e=t.symbol,f=t.zero,d=t.width,g=t.comma,p=t.precision,v=t.trim,m=t.type;if(m==="n")g=true,m="g";else if(!oS[m])p===undefined&&(p=12),v=true,m="g";if(f||u==="0"&&h==="=")f=true,u="0",h="=";var _=e==="$"?i:e==="#"&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",y=e==="$"?a:/[%p]/.test(m)?r:"";var b=oS[m],w=/[defgprs%]/.test(m);p=p===undefined?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p));function n(t){var e=_,n=y,i,a,r;if(m==="c"){n=b(t)+n;t=""}else{t=+t;var o=t<0||1/t<0;t=isNaN(t)?A:b(Math.abs(t),p);if(v)t=nS(t);if(o&&+t===0&&c!=="+")o=false;e=(o?c==="("?c:C:c==="-"||c==="("?"":c)+e;n=(m==="s"?uS[8+iS/3]:"")+n+(o&&c==="("?")":"");if(w){i=-1,a=t.length;while(++i<a){if(r=t.charCodeAt(i),48>r||r>57){n=(r===46?k+t.slice(i+1):t.slice(i))+n;t=t.slice(0,i);break}}}}if(g&&!f)t=x(t,Infinity);var s=e.length+t.length+n.length,l=s<d?new Array(d-s+1).join(u):"";if(g&&f)t=x(l+t,l.length?d-n.length:Infinity),l="";switch(h){case"<":t=e+t+n+l;break;case"=":t=e+l+t+n;break;case"^":t=l.slice(0,s=l.length>>1)+e+t+n+l.slice(s);break;default:t=l+e+t+n;break}return S(t)}n.toString=function(){return t+""};return n}function e(t,e){var n=o((t=tS(t),t.type="f",t)),i=Math.max(-8,Math.min(8,Math.floor(Zk(e)/3)))*3,a=Math.pow(10,-i),r=uS[8+i/3];return function(t){return n(a*t)+r}}return{format:o,formatPrefix:e}}var cS={"en-GB":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","M","B","t","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:",",decimal:"."},currency:["",""]},"en-US":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","M","B","t","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:",",decimal:"."},currency:["$",""]},"es-CL":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","M","MM","B","T","Q","Z","Y"],grouping:[3],delimiters:{thousands:".",decimal:","},currency:["$",""]},"es-MX":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","M","MM","B","T","Q","Z","Y"],grouping:[3],delimiters:{thousands:",",decimal:"."},currency:["$",""]},"es-ES":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","mm","b","t","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:".",decimal:","},currency:["",""]},"et-EE":{separator:" ",suffixes:["y","z","a","f","p","n","","m","","tuhat","miljonit","miljardit","triljonit","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:" ",decimal:","},currency:["","eurot"]},"fr-FR":{suffixes:["y","z","a","f","p","n","","m","","k","m","b","t","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:" ",decimal:","},currency:["",""]}};function fS(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){fS=function t(e){return ie(e)}}else{fS=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return fS(t)}var dS=function t(e,n){return parseFloat(Math.round(e*Math.pow(10,n))/Math.pow(10,n)).toFixed(n)};function gS(t,e,n){var i=0;if(t){if(t<0)t*=-1;i=1+Math.floor(1e-12+Math.log(t)/Math.LN10);i=Math.max(-24,Math.min(24,Math.floor((i-1)/3)*3))}var a=n[8+i/3];return{number:dS(a.scale(t),e),symbol:a.symbol}}function pS(t,e){var n=Math.pow(10,Math.abs(8-e)*3);return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function vS(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"en-US";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;if(isFinite(t))t*=1;else return"N/A";var i=t<0;var a=t.toString().split(".")[0].replace("-","").length,r=fS(e)==="object"?e:cS[e]||cS["en-US"],o=r.suffixes.map(pS);var s=r.delimiters.decimal||".",l=r.separator||"",u=r.delimiters.thousands||",";var h=hS({currency:r.currency||["$",""],decimal:s,grouping:r.grouping||[3],thousands:u});var c;if(n)c=h.format(n)(t);else if(t===0)c="0";else if(a>=3){var f=gS(h.format(".3r")(t),2,o);var d=parseFloat(f.number).toString().replace(".",s);var g=f.symbol;c="".concat(d).concat(l).concat(g)}else if(a===3)c=h.format(",f")(t);else if(t<1&&t>-1)c=h.format(".2g")(t);else c=h.format(".3g")(t);return"".concat(i&&c.charAt(0)!=="-"?"-":"").concat(c).replace(/(\.[0]*[1-9]*)[0]*$/g,"$1").replace(/\.[0]*$/g,"")}function mS(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function _S(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function yS(t,e,n){if(e)_S(t.prototype,e);if(n)_S(t,n);return t}var bS=function(){function l(){mS(this,l);this._duration=600;this._height=g("height");this._id=g("id");this._opacity=Oc(1);this._pointerEvents=Oc("auto");this._select;this._url=g("url");this._width=g("width");this._x=g("x",0);this._y=g("y",0)}yS(l,[{key:"render",value:function t(e){var n=this;if(this._select===void 0)this.select(Sd("body").append("svg").style("width","".concat(window.innerWidth,"px")).style("height","".concat(window.innerHeight,"px")).style("display","block").node());var i=this._select.selectAll(".d3plus-Image").data(this._data,this._id);var a=i.enter().append("image").attr("class","d3plus-Image").attr("opacity",0).attr("width",0).attr("height",0).attr("x",function(t,e){return n._x(t,e)+n._width(t,e)/2}).attr("y",function(t,e){return n._y(t,e)+n._height(t,e)/2});var r=Lv().duration(this._duration),o=this,s=a.merge(i);s.attr("xlink:href",this._url).style("pointer-events",this._pointerEvents).transition(r).attr("opacity",this._opacity).attr("width",function(t,e){return n._width(t,e)}).attr("height",function(t,e){return n._height(t,e)}).attr("x",function(t,e){return n._x(t,e)}).attr("y",function(t,e){return n._y(t,e)}).each(function(t,e){var n=Sd(this),i=o._url(t,e);var a=i.indexOf("http://")===0||i.indexOf("https://")===0;if(!a||i.indexOf(window.location.hostname)===0){var r=new l;r.src=i;r.crossOrigin="Anonymous";r.onload=function(){var t=document.createElement("canvas");t.width=this.width;t.height=this.height;var e=t.getContext("2d");e.drawImage(this,0,0);n.attr("xlink:href",t.toDataURL("image/png"))}}});i.exit().transition(r).attr("width",function(t,e){return n._width(t,e)}).attr("height",function(t,e){return n._height(t,e)}).attr("x",function(t,e){return n._x(t,e)}).attr("y",function(t,e){return n._y(t,e)}).attr("opacity",0).remove();if(e)setTimeout(e,this._duration+100);return this}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"height",value:function t(e){return arguments.length?(this._height=typeof e==="function"?e:Oc(e),this):this._height}},{key:"id",value:function t(e){return arguments.length?(this._id=e,this):this._id}},{key:"opacity",value:function t(e){return arguments.length?(this._opacity=typeof e==="function"?e:Oc(e),this):this._opacity}},{key:"pointerEvents",value:function t(e){return arguments.length?(this._pointerEvents=typeof e==="function"?e:Oc(e),this):this._pointerEvents}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"url",value:function t(e){return arguments.length?(this._url=e,this):this._url}},{key:"width",value:function t(e){return arguments.length?(this._width=typeof e==="function"?e:Oc(e),this):this._width}},{key:"x",value:function t(e){return arguments.length?(this._x=typeof e==="function"?e:Oc(e),this):this._x}},{key:"y",value:function t(e){return arguments.length?(this._y=typeof e==="function"?e:Oc(e),this):this._y}}]);return l}();var wS={dark:"#444444",light:"#f7f7f7",missing:"#cccccc",off:"#b22200",on:"#224f20",scale:Fm().range(["#b22200","#282f6b","#eace3f","#b35c1e","#224f20","#5f487c","#759143","#419391","#993c88","#e89c89","#ffee8d","#afd5e8","#f7ba77","#a5c697","#c5b5e5","#d1d392","#bbefd0","#e099cf"])};function xS(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return t in e?e[t]:t in wS?wS[t]:wS.missing}function kS(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if([null,void 0].indexOf(t)>=0)return xS("missing",e);else if(t===true)return xS("on",e);else if(t===false)return xS("off",e);var n=Lg(t);if(!n)return xS("scale",e)(t);return t.toString()}function SS(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};t=Vg(t);var n=(t.r*299+t.g*587+t.b*114)/1e3;return n>=128?xS("dark",e):xS("light",e)}function CS(t){t=Xg(t);if(t.l>.45){if(t.s>.8)t.s=.8;t.l=.45}return t.toString()}function AS(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:.5;t=Xg(t);e*=1-t.l;t.l+=e;t.s-=e;return t.toString()}function ES(t){if(t.replace(/\s+/g,"")==="")return t;var e=(new DOMParser).parseFromString(t.replace(/<[^>]+>/g,""),"text/html");return e.documentElement?e.documentElement.textContent:t}function MS(t,e){e=Object.assign({"font-size":10,"font-family":"sans-serif","font-style":"normal","font-weight":400,"font-variant":"normal"},e);var n=document.createElement("canvas").getContext("2d");var i=[];i.push(e["font-style"]);i.push(e["font-variant"]);i.push(e["font-weight"]);i.push(typeof e["font-size"]==="string"?e["font-size"]:"".concat(e["font-size"],"px"));i.push(e["font-family"]);n.font=i.join(" ");if(t instanceof Array)return t.map(function(t){return n.measureText(ES(t)).width});return n.measureText(ES(t)).width}function RS(t){return t.toString().replace(/^\s+|\s+$/g,"")}function TS(t){return t.toString().replace(/\s+$/,"")}var BS="abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890",OS={},PS=32;var DS,NS,zS,FS;var LS=function t(e){if(!DS){DS=MS(BS,{"font-family":"DejaVuSans","font-size":PS});NS=MS(BS,{"font-family":"-apple-system","font-size":PS});zS=MS(BS,{"font-family":"monospace","font-size":PS});FS=MS(BS,{"font-family":"sans-serif","font-size":PS})}if(!(e instanceof Array))e=e.split(",");e=e.map(function(t){return RS(t)});for(var n=0;n<e.length;n++){var i=e[n];if(OS[i]||["-apple-system","monospace","sans-serif","DejaVuSans"].includes(i))return i;else if(OS[i]===false)continue;var a=MS(BS,{"font-family":i,"font-size":PS});OS[i]=a!==zS;if(OS[i])OS[i]=a!==FS;if(NS&&OS[i])OS[i]=a!==NS;if(DS&&OS[i])OS[i]=a!==DS;if(OS[i])return i}return false};var jS=function(){return Sd("html").attr("dir")==="rtl"||Sd("body").attr("dir")==="rtl"||Sd("html").style("direction")==="rtl"||Sd("body").style("direction")==="rtl"};function IS(t){if(t===void 0)t="undefined";else if(!(typeof t==="string"||t instanceof String))t=JSON.stringify(t);return t}var HS=[[/[\300-\305]/g,"A"],[/[\340-\345]/g,"a"],[/[\306]/g,"AE"],[/[\346]/g,"ae"],[/[\337]/g,"B"],[/[\307]/g,"C"],[/[\347]/g,"c"],[/[\320\336\376]/g,"D"],[/[\360]/g,"d"],[/[\310-\313]/g,"E"],[/[\350-\353]/g,"e"],[/[\314-\317]/g,"I"],[/[\354-\357]/g,"i"],[/[\321]/g,"N"],[/[\361]/g,"n"],[/[\322-\326\330]/g,"O"],[/[\362-\366\370]/g,"o"],[/[\331-\334]/g,"U"],[/[\371-\374]/g,"u"],[/[\327]/g,"x"],[/[\335]/g,"Y"],[/[\375\377]/g,"y"]];function VS(t){return"".concat(t).replace(/[^A-Za-z0-9\-_]/g,function(t){if(t===" ")return"-";var e=false;for(var n=0;n<HS.length;n++){if(new RegExp(HS[n][0]).test(t)){e=HS[n][1];break}}return e||""})}var US=["u0903","u093B","u093E","u093F","u0940","u0949","u094A","u094B","u094C","u094E","u094F","u0982","u0983","u09BE","u09BF","u09C0","u09C7","u09C8","u09CB","u09CC","u09D7","u0A03","u0A3E","u0A3F","u0A40","u0A83","u0ABE","u0ABF","u0AC0","u0AC9","u0ACB","u0ACC","u0B02","u0B03","u0B3E","u0B40","u0B47","u0B48","u0B4B","u0B4C","u0B57","u0BBE","u0BBF","u0BC1","u0BC2","u0BC6","u0BC7","u0BC8","u0BCA","u0BCB","u0BCC","u0BD7","u0C01","u0C02","u0C03","u0C41","u0C42","u0C43","u0C44","u0C82","u0C83","u0CBE","u0CC0","u0CC1","u0CC2","u0CC3","u0CC4","u0CC7","u0CC8","u0CCA","u0CCB","u0CD5","u0CD6","u0D02","u0D03","u0D3E","u0D3F","u0D40","u0D46","u0D47","u0D48","u0D4A","u0D4B","u0D4C","u0D57","u0D82","u0D83","u0DCF","u0DD0","u0DD1","u0DD8","u0DD9","u0DDA","u0DDB","u0DDC","u0DDD","u0DDE","u0DDF","u0DF2","u0DF3","u0F3E","u0F3F","u0F7F","u102B","u102C","u1031","u1038","u103B","u103C","u1056","u1057","u1062","u1063","u1064","u1067","u1068","u1069","u106A","u106B","u106C","u106D","u1083","u1084","u1087","u1088","u1089","u108A","u108B","u108C","u108F","u109A","u109B","u109C","u17B6","u17BE","u17BF","u17C0","u17C1","u17C2","u17C3","u17C4","u17C5","u17C7","u17C8","u1923","u1924","u1925","u1926","u1929","u192A","u192B","u1930","u1931","u1933","u1934","u1935","u1936","u1937","u1938","u1A19","u1A1A","u1A55","u1A57","u1A61","u1A63","u1A64","u1A6D","u1A6E","u1A6F","u1A70","u1A71","u1A72","u1B04","u1B35","u1B3B","u1B3D","u1B3E","u1B3F","u1B40","u1B41","u1B43","u1B44","u1B82","u1BA1","u1BA6","u1BA7","u1BAA","u1BE7","u1BEA","u1BEB","u1BEC","u1BEE","u1BF2","u1BF3","u1C24","u1C25","u1C26","u1C27","u1C28","u1C29","u1C2A","u1C2B","u1C34","u1C35","u1CE1","u1CF2","u1CF3","u302E","u302F","uA823","uA824","uA827","uA880","uA881","uA8B4","uA8B5","uA8B6","uA8B7","uA8B8","uA8B9","uA8BA","uA8BB","uA8BC","uA8BD","uA8BE","uA8BF","uA8C0","uA8C1","uA8C2","uA8C3","uA952","uA953","uA983","uA9B4","uA9B5","uA9BA","uA9BB","uA9BD","uA9BE","uA9BF","uA9C0","uAA2F","uAA30","uAA33","uAA34","uAA4D","uAA7B","uAA7D","uAAEB","uAAEE","uAAEF","uAAF5","uABE3","uABE4","uABE6","uABE7","uABE9","uABEA","uABEC"];var GS=["u0300","u0301","u0302","u0303","u0304","u0305","u0306","u0307","u0308","u0309","u030A","u030B","u030C","u030D","u030E","u030F","u0310","u0311","u0312","u0313","u0314","u0315","u0316","u0317","u0318","u0319","u031A","u031B","u031C","u031D","u031E","u031F","u0320","u0321","u0322","u0323","u0324","u0325","u0326","u0327","u0328","u0329","u032A","u032B","u032C","u032D","u032E","u032F","u0330","u0331","u0332","u0333","u0334","u0335","u0336","u0337","u0338","u0339","u033A","u033B","u033C","u033D","u033E","u033F","u0340","u0341","u0342","u0343","u0344","u0345","u0346","u0347","u0348","u0349","u034A","u034B","u034C","u034D","u034E","u034F","u0350","u0351","u0352","u0353","u0354","u0355","u0356","u0357","u0358","u0359","u035A","u035B","u035C","u035D","u035E","u035F","u0360","u0361","u0362","u0363","u0364","u0365","u0366","u0367","u0368","u0369","u036A","u036B","u036C","u036D","u036E","u036F","u0483","u0484","u0485","u0486","u0487","u0591","u0592","u0593","u0594","u0595","u0596","u0597","u0598","u0599","u059A","u059B","u059C","u059D","u059E","u059F","u05A0","u05A1","u05A2","u05A3","u05A4","u05A5","u05A6","u05A7","u05A8","u05A9","u05AA","u05AB","u05AC","u05AD","u05AE","u05AF","u05B0","u05B1","u05B2","u05B3","u05B4","u05B5","u05B6","u05B7","u05B8","u05B9","u05BA","u05BB","u05BC","u05BD","u05BF","u05C1","u05C2","u05C4","u05C5","u05C7","u0610","u0611","u0612","u0613","u0614","u0615","u0616","u0617","u0618","u0619","u061A","u064B","u064C","u064D","u064E","u064F","u0650","u0651","u0652","u0653","u0654","u0655","u0656","u0657","u0658","u0659","u065A","u065B","u065C","u065D","u065E","u065F","u0670","u06D6","u06D7","u06D8","u06D9","u06DA","u06DB","u06DC","u06DF","u06E0","u06E1","u06E2","u06E3","u06E4","u06E7","u06E8","u06EA","u06EB","u06EC","u06ED","u0711","u0730","u0731","u0732","u0733","u0734","u0735","u0736","u0737","u0738","u0739","u073A","u073B","u073C","u073D","u073E","u073F","u0740","u0741","u0742","u0743","u0744","u0745","u0746","u0747","u0748","u0749","u074A","u07A6","u07A7","u07A8","u07A9","u07AA","u07AB","u07AC","u07AD","u07AE","u07AF","u07B0","u07EB","u07EC","u07ED","u07EE","u07EF","u07F0","u07F1","u07F2","u07F3","u0816","u0817","u0818","u0819","u081B","u081C","u081D","u081E","u081F","u0820","u0821","u0822","u0823","u0825","u0826","u0827","u0829","u082A","u082B","u082C","u082D","u0859","u085A","u085B","u08E3","u08E4","u08E5","u08E6","u08E7","u08E8","u08E9","u08EA","u08EB","u08EC","u08ED","u08EE","u08EF","u08F0","u08F1","u08F2","u08F3","u08F4","u08F5","u08F6","u08F7","u08F8","u08F9","u08FA","u08FB","u08FC","u08FD","u08FE","u08FF","u0900","u0901","u0902","u093A","u093C","u0941","u0942","u0943","u0944","u0945","u0946","u0947","u0948","u094D","u0951","u0952","u0953","u0954","u0955","u0956","u0957","u0962","u0963","u0981","u09BC","u09C1","u09C2","u09C3","u09C4","u09CD","u09E2","u09E3","u0A01","u0A02","u0A3C","u0A41","u0A42","u0A47","u0A48","u0A4B","u0A4C","u0A4D","u0A51","u0A70","u0A71","u0A75","u0A81","u0A82","u0ABC","u0AC1","u0AC2","u0AC3","u0AC4","u0AC5","u0AC7","u0AC8","u0ACD","u0AE2","u0AE3","u0B01","u0B3C","u0B3F","u0B41","u0B42","u0B43","u0B44","u0B4D","u0B56","u0B62","u0B63","u0B82","u0BC0","u0BCD","u0C00","u0C3E","u0C3F","u0C40","u0C46","u0C47","u0C48","u0C4A","u0C4B","u0C4C","u0C4D","u0C55","u0C56","u0C62","u0C63","u0C81","u0CBC","u0CBF","u0CC6","u0CCC","u0CCD","u0CE2","u0CE3","u0D01","u0D41","u0D42","u0D43","u0D44","u0D4D","u0D62","u0D63","u0DCA","u0DD2","u0DD3","u0DD4","u0DD6","u0E31","u0E34","u0E35","u0E36","u0E37","u0E38","u0E39","u0E3A","u0E47","u0E48","u0E49","u0E4A","u0E4B","u0E4C","u0E4D","u0E4E","u0EB1","u0EB4","u0EB5","u0EB6","u0EB7","u0EB8","u0EB9","u0EBB","u0EBC","u0EC8","u0EC9","u0ECA","u0ECB","u0ECC","u0ECD","u0F18","u0F19","u0F35","u0F37","u0F39","u0F71","u0F72","u0F73","u0F74","u0F75","u0F76","u0F77","u0F78","u0F79","u0F7A","u0F7B","u0F7C","u0F7D","u0F7E","u0F80","u0F81","u0F82","u0F83","u0F84","u0F86","u0F87","u0F8D","u0F8E","u0F8F","u0F90","u0F91","u0F92","u0F93","u0F94","u0F95","u0F96","u0F97","u0F99","u0F9A","u0F9B","u0F9C","u0F9D","u0F9E","u0F9F","u0FA0","u0FA1","u0FA2","u0FA3","u0FA4","u0FA5","u0FA6","u0FA7","u0FA8","u0FA9","u0FAA","u0FAB","u0FAC","u0FAD","u0FAE","u0FAF","u0FB0","u0FB1","u0FB2","u0FB3","u0FB4","u0FB5","u0FB6","u0FB7","u0FB8","u0FB9","u0FBA","u0FBB","u0FBC","u0FC6","u102D","u102E","u102F","u1030","u1032","u1033","u1034","u1035","u1036","u1037","u1039","u103A","u103D","u103E","u1058","u1059","u105E","u105F","u1060","u1071","u1072","u1073","u1074","u1082","u1085","u1086","u108D","u109D","u135D","u135E","u135F","u1712","u1713","u1714","u1732","u1733","u1734","u1752","u1753","u1772","u1773","u17B4","u17B5","u17B7","u17B8","u17B9","u17BA","u17BB","u17BC","u17BD","u17C6","u17C9","u17CA","u17CB","u17CC","u17CD","u17CE","u17CF","u17D0","u17D1","u17D2","u17D3","u17DD","u180B","u180C","u180D","u18A9","u1920","u1921","u1922","u1927","u1928","u1932","u1939","u193A","u193B","u1A17","u1A18","u1A1B","u1A56","u1A58","u1A59","u1A5A","u1A5B","u1A5C","u1A5D","u1A5E","u1A60","u1A62","u1A65","u1A66","u1A67","u1A68","u1A69","u1A6A","u1A6B","u1A6C","u1A73","u1A74","u1A75","u1A76","u1A77","u1A78","u1A79","u1A7A","u1A7B","u1A7C","u1A7F","u1AB0","u1AB1","u1AB2","u1AB3","u1AB4","u1AB5","u1AB6","u1AB7","u1AB8","u1AB9","u1ABA","u1ABB","u1ABC","u1ABD","u1B00","u1B01","u1B02","u1B03","u1B34","u1B36","u1B37","u1B38","u1B39","u1B3A","u1B3C","u1B42","u1B6B","u1B6C","u1B6D","u1B6E","u1B6F","u1B70","u1B71","u1B72","u1B73","u1B80","u1B81","u1BA2","u1BA3","u1BA4","u1BA5","u1BA8","u1BA9","u1BAB","u1BAC","u1BAD","u1BE6","u1BE8","u1BE9","u1BED","u1BEF","u1BF0","u1BF1","u1C2C","u1C2D","u1C2E","u1C2F","u1C30","u1C31","u1C32","u1C33","u1C36","u1C37","u1CD0","u1CD1","u1CD2","u1CD4","u1CD5","u1CD6","u1CD7","u1CD8","u1CD9","u1CDA","u1CDB","u1CDC","u1CDD","u1CDE","u1CDF","u1CE0","u1CE2","u1CE3","u1CE4","u1CE5","u1CE6","u1CE7","u1CE8","u1CED","u1CF4","u1CF8","u1CF9","u1DC0","u1DC1","u1DC2","u1DC3","u1DC4","u1DC5","u1DC6","u1DC7","u1DC8","u1DC9","u1DCA","u1DCB","u1DCC","u1DCD","u1DCE","u1DCF","u1DD0","u1DD1","u1DD2","u1DD3","u1DD4","u1DD5","u1DD6","u1DD7","u1DD8","u1DD9","u1DDA","u1DDB","u1DDC","u1DDD","u1DDE","u1DDF","u1DE0","u1DE1","u1DE2","u1DE3","u1DE4","u1DE5","u1DE6","u1DE7","u1DE8","u1DE9","u1DEA","u1DEB","u1DEC","u1DED","u1DEE","u1DEF","u1DF0","u1DF1","u1DF2","u1DF3","u1DF4","u1DF5","u1DFC","u1DFD","u1DFE","u1DFF","u20D0","u20D1","u20D2","u20D3","u20D4","u20D5","u20D6","u20D7","u20D8","u20D9","u20DA","u20DB","u20DC","u20E1","u20E5","u20E6","u20E7","u20E8","u20E9","u20EA","u20EB","u20EC","u20ED","u20EE","u20EF","u20F0","u2CEF","u2CF0","u2CF1","u2D7F","u2DE0","u2DE1","u2DE2","u2DE3","u2DE4","u2DE5","u2DE6","u2DE7","u2DE8","u2DE9","u2DEA","u2DEB","u2DEC","u2DED","u2DEE","u2DEF","u2DF0","u2DF1","u2DF2","u2DF3","u2DF4","u2DF5","u2DF6","u2DF7","u2DF8","u2DF9","u2DFA","u2DFB","u2DFC","u2DFD","u2DFE","u2DFF","u302A","u302B","u302C","u302D","u3099","u309A","uA66F","uA674","uA675","uA676","uA677","uA678","uA679","uA67A","uA67B","uA67C","uA67D","uA69E","uA69F","uA6F0","uA6F1","uA802","uA806","uA80B","uA825","uA826","uA8C4","uA8E0","uA8E1","uA8E2","uA8E3","uA8E4","uA8E5","uA8E6","uA8E7","uA8E8","uA8E9","uA8EA","uA8EB","uA8EC","uA8ED","uA8EE","uA8EF","uA8F0","uA8F1","uA926","uA927","uA928","uA929","uA92A","uA92B","uA92C","uA92D","uA947","uA948","uA949","uA94A","uA94B","uA94C","uA94D","uA94E","uA94F","uA950","uA951","uA980","uA981","uA982","uA9B3","uA9B6","uA9B7","uA9B8","uA9B9","uA9BC","uA9E5","uAA29","uAA2A","uAA2B","uAA2C","uAA2D","uAA2E","uAA31","uAA32","uAA35","uAA36","uAA43","uAA4C","uAA7C","uAAB0","uAAB2","uAAB3","uAAB4","uAAB7","uAAB8","uAABE","uAABF","uAAC1","uAAEC","uAAED","uAAF6","uABE5","uABE8","uABED","uFB1E","uFE00","uFE01","uFE02","uFE03","uFE04","uFE05","uFE06","uFE07","uFE08","uFE09","uFE0A","uFE0B","uFE0C","uFE0D","uFE0E","uFE0F","uFE20","uFE21","uFE22","uFE23","uFE24","uFE25","uFE26","uFE27","uFE28","uFE29","uFE2A","uFE2B","uFE2C","uFE2D","uFE2E","uFE2F"];var WS=US.concat(GS);var KS=["-",";",":","&","|","u0E2F","u0EAF","u0EC6","u0ECC","u104A","u104B","u104C","u104D","u104E","u104F","u2013","u2014","u2027","u3000","u3001","u3002","uFF0C","uFF5E"];var qS=["'","<","(","{","[","u00AB","u300A","u3008"];var YS=["'",">",")","}","]",".","!","?","/","u00BB","u300B","u3009"].concat(KS);var XS="---";var ZS="------";var JS="-";var $S="----";var QS=XS+JS+ZS+$S;var tC=new RegExp("(\\".concat(KS.join("|\\"),")*[^\\s|\\").concat(KS.join("|\\"),"]*(\\").concat(KS.join("|\\"),")*"),"g");var eC=new RegExp("[".concat(QS,"]"));var nC=new RegExp("(\\".concat(qS.join("|\\"),")*[").concat(QS,"](\\").concat(YS.join("|\\"),"|\\").concat(WS.join("|\\"),")*|[a-z0-9]+"),"gi");function iC(t){if(!eC.test(t))return IS(t).match(tC).filter(function(t){return t.length});return cm(IS(t).match(tC).map(function(t){if(eC.test(t))return t.match(nC);return[t]}))}function aC(){var d="sans-serif",g=10,p=400,v=200,m,_=null,y=false,b=iC,w=200;function e(t){t=IS(t);if(m===void 0)m=Math.ceil(g*1.4);var e=b(t);var n={"font-family":d,"font-size":g,"font-weight":p,"line-height":m};var i=1,a="",r=false,o=0;var s=[],l=MS(e,n),u=MS(" ",n);for(var h=0;h<e.length;h++){var c=e[h];var f=l[e.indexOf(c)];c+=t.slice(a.length+c.length).match("^( |\n)*","g")[0];if(a.slice(-1)==="\n"||o+f>w){if(!h&&!y){r=true;break}if(s.length>=i)s[i-1]=TS(s[i-1]);i++;if(m*i>v||f>w&&!y||_&&i>_){r=true;break}o=0;s.push(c)}else if(!h)s[0]=c;else s[i-1]+=c;a+=c;o+=f;o+=c.match(/[\s]*$/g)[0].length*u}return{lines:s,sentence:t,truncated:r,widths:MS(s,n),words:e}}e.fontFamily=function(t){return arguments.length?(d=t,e):d};e.fontSize=function(t){return arguments.length?(g=t,e):g};e.fontWeight=function(t){return arguments.length?(p=t,e):p};e.height=function(t){return arguments.length?(v=t,e):v};e.lineHeight=function(t){return arguments.length?(m=t,e):m};e.maxLines=function(t){return arguments.length?(_=t,e):_};e.overflow=function(t){return arguments.length?(y=t,e):y};e.split=function(t){return arguments.length?(b=t,e):b};e.width=function(t){return arguments.length?(w=t,e):w};return e}function rC(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){rC=function t(e){return ie(e)}}else{rC=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return rC(t)}function oC(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function sC(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function lC(t,e,n){if(e)sC(t.prototype,e);if(n)sC(t,n);return t}function uC(t,e){if(e&&(rC(e)==="object"||typeof e==="function")){return e}return hC(t)}function hC(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function cC(t){cC=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return cC(t)}function fC(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)dC(t,e)}function dC(t,e){dC=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return dC(t,e)}var gC={i:"font-style: italic;",em:"font-style: italic;",b:"font-weight: bold;",strong:"font-weight: bold;"};var pC=function(t){fC(e,t);function e(){var n;oC(this,e);n=uC(this,cC(e).call(this));n._ariaHidden=Oc("false");n._delay=0;n._duration=0;n._ellipsis=function(t,e){return e?"".concat(t.replace(/\.|,$/g,""),"..."):""};n._fontColor=Oc("black");n._fontFamily=Oc(["Roboto","Helvetica Neue","HelveticaNeue","Helvetica","Arial","sans-serif"]);n._fontMax=Oc(50);n._fontMin=Oc(8);n._fontOpacity=Oc(1);n._fontResize=Oc(false);n._fontSize=Oc(10);n._fontWeight=Oc(400);n._height=g("height",200);n._html=gC;n._id=function(t,e){return t.id||"".concat(e)};n._lineHeight=function(t,e){return n._fontSize(t,e)*1.2};n._maxLines=Oc(null);n._on={};n._overflow=Oc(false);n._padding=Oc(0);n._pointerEvents=Oc("auto");n._rotate=Oc(0);n._rotateAnchor=function(t){return[t.w/2,t.h/2]};n._split=iC;n._text=g("text");n._textAnchor=Oc("start");n._verticalAlign=Oc("top");n._width=g("width",200);n._x=g("x",0);n._y=g("y",0);return n}lC(e,[{key:"render",value:function t(e){var P=this;if(this._select===void 0)this.select(Sd("body").append("svg").style("width","".concat(window.innerWidth,"px")).style("height","".concat(window.innerHeight,"px")).node());var D=this;var n=this._select.selectAll(".d3plus-textBox").data(this._data.reduce(function(t,e,n){var i=P._text(e,n);if(i===void 0)return t;i=RS(i);var a=P._fontResize(e,n);var r=P._lineHeight(e,n)/P._fontSize(e,n);var o=a?P._fontMax(e,n):P._fontSize(e,n),s=a?o*r:P._lineHeight(e,n),l=1,u=[],h,c;var f={"font-family":LS(P._fontFamily(e,n)),"font-size":o,"font-weight":P._fontWeight(e,n),"line-height":s};var d=Mm(P._padding(e,n));var g=P._height(e,n)-(d.top+d.bottom),p=P._width(e,n)-(d.left+d.right);var v=aC().fontFamily(f["font-family"]).fontSize(o).fontWeight(f["font-weight"]).lineHeight(s).maxLines(P._maxLines(e,n)).height(g).overflow(P._overflow(e,n)).width(p).split(P._split);var m=P._fontMax(e,n),_=P._fontMin(e,n),y=P._verticalAlign(e,n),b=P._split(i,n);function w(){var t=function t(){if(l<1)u=[D._ellipsis("",l)];else u[l-1]=D._ellipsis(u[l-1],l)};o=um([o,_]);o=fm([o,m]);if(a){s=o*r;v.fontSize(o).lineHeight(s);f["font-size"]=o;f["line-height"]=s}c=v(i);u=c.lines.filter(function(t){return t!==""});l=u.length;if(c.truncated){if(a){o--;if(o<_){o=_;t();return}else w()}else t()}}if(p>_&&(g>s||a&&g>_*r)){if(a){h=MS(b,f);var x=1.165+p/g*.1,k=p*g,S=um(h),C=dm(h,function(t){return t*s})*x;if(S>p||C>k){var A=Math.sqrt(k/C),E=p/S;var M=fm([A,E]);o=Math.floor(o*M)}var R=Math.floor(g*.8);if(o>R)o=R}w()}if(u.length){var T=l*s;var B=P._rotate(e,n);var O=B===0?y==="top"?0:y==="middle"?g/2-T/2:g-T:0;O-=s*.1;t.push({aH:P._ariaHidden(e,n),data:e,i:n,lines:u,fC:P._fontColor(e,n),fF:f["font-family"],fO:P._fontOpacity(e,n),fW:f["font-weight"],id:P._id(e,n),tA:P._textAnchor(e,n),vA:P._verticalAlign(e,n),widths:c.widths,fS:o,lH:s,w:p,h:g,r:B,x:P._x(e,n)+d.left,y:P._y(e,n)+O+d.top})}return t},[]),function(t){return P._id(t.data,t.i)});var a=Lv().duration(this._duration);if(this._duration===0){n.exit().remove()}else{n.exit().transition().delay(this._duration).remove();n.exit().selectAll("text").transition(a).attr("opacity",0).style("opacity",0)}function i(t){t.attr("transform",function(t,e){var n=D._rotateAnchor(t,e);return"translate(".concat(t.x,", ").concat(t.y,") rotate(").concat(t.r,", ").concat(n[0],", ").concat(n[1],")")})}var r=n.enter().append("g").attr("class","d3plus-textBox").attr("id",function(t){return"d3plus-textBox-".concat(VS(t.id))}).call(i).merge(n);var o=jS();r.style("pointer-events",function(t){return P._pointerEvents(t.data,t.i)}).each(function(n){function t(t){t[D._html?"html":"text"](function(t){return TS(t).replace(/&([^\;&]*)/g,function(t,e){return e==="amp"?t:"&amp;".concat(e)}).replace(/<([^A-z^/]+)/g,function(t,e){return"&lt;".concat(e)}).replace(/<$/g,"&lt;").replace(/(<[^>^\/]+>)([^<^>]+)$/g,function(t,e,n){return"".concat(e).concat(n).concat(e.replace("<","</"))}).replace(/^([^<^>]+)(<\/[^>]+>)/g,function(t,e,n){return"".concat(n.replace("</","<")).concat(e).concat(n)}).replace(/<([A-z]+)[^>]*>([^<^>]+)<\/[^>]+>/g,function(t,e,n){var i=D._html[e]?'<tspan style="'.concat(D._html[e],'">'):"";return"".concat(i.length?i:"").concat(n).concat(i.length?"</tspan>":"")})})}function e(t){t.attr("aria-hidden",n.aH).attr("dir",o?"rtl":"ltr").attr("fill",n.fC).attr("text-anchor",n.tA).attr("font-family",n.fF).style("font-family",n.fF).attr("font-size","".concat(n.fS,"px")).style("font-size","".concat(n.fS,"px")).attr("font-weight",n.fW).style("font-weight",n.fW).attr("x","".concat(n.tA==="middle"?n.w/2:o?n.tA==="start"?n.w:0:n.tA==="end"?n.w:2*Math.sin(Math.PI*n.r/180),"px")).attr("y",function(t,e){return n.r===0||n.vA==="top"?"".concat((e+1)*n.lH-(n.lH-n.fS),"px"):n.vA==="middle"?"".concat((n.h+n.fS)/2-(n.lH-n.fS)+(e-n.lines.length/2+.5)*n.lH,"px"):"".concat(n.h-2*(n.lH-n.fS)-(n.lines.length-(e+1))*n.lH+2*Math.cos(Math.PI*n.r/180),"px")})}var i=Sd(this).selectAll("text").data(n.lines);if(D._duration===0){i.call(t).call(e);i.exit().remove();i.enter().append("text").attr("dominant-baseline","alphabetic").style("baseline-shift","0%").attr("unicode-bidi","bidi-override").call(t).call(e).attr("opacity",n.fO).style("opacity",n.fO)}else{i.call(t).transition(a).call(e);i.exit().transition(a).attr("opacity",0).remove();i.enter().append("text").attr("dominant-baseline","alphabetic").style("baseline-shift","0%").attr("opacity",0).style("opacity",0).call(t).call(e).merge(i).transition(a).delay(D._delay).call(e).attr("opacity",n.fO).style("opacity",n.fO)}}).transition(a).call(i);var s=Object.keys(this._on),l=s.reduce(function(t,n){t[n]=function(t,e){return P._on[n](t.data,e)};return t},{});for(var u=0;u<s.length;u++){r.on(s[u],l[s[u]])}if(e)setTimeout(e,this._duration+100);return this}},{key:"ariaHidden",value:function t(e){return e!==undefined?(this._ariaHidden=typeof e==="function"?e:Oc(e),this):this._ariaHidden}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"delay",value:function t(e){return arguments.length?(this._delay=e,this):this._delay}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"ellipsis",value:function t(e){return arguments.length?(this._ellipsis=typeof e==="function"?e:Oc(e),this):this._ellipsis}},{key:"fontColor",value:function t(e){return arguments.length?(this._fontColor=typeof e==="function"?e:Oc(e),this):this._fontColor}},{key:"fontFamily",value:function t(e){return arguments.length?(this._fontFamily=typeof e==="function"?e:Oc(e),this):this._fontFamily}},{key:"fontMax",value:function t(e){return arguments.length?(this._fontMax=typeof e==="function"?e:Oc(e),this):this._fontMax}},{key:"fontMin",value:function t(e){return arguments.length?(this._fontMin=typeof e==="function"?e:Oc(e),this):this._fontMin}},{key:"fontOpacity",value:function t(e){return arguments.length?(this._fontOpacity=typeof e==="function"?e:Oc(e),this):this._fontOpacity}},{key:"fontResize",value:function t(e){return arguments.length?(this._fontResize=typeof e==="function"?e:Oc(e),this):this._fontResize}},{key:"fontSize",value:function t(e){return arguments.length?(this._fontSize=typeof e==="function"?e:Oc(e),this):this._fontSize}},{key:"fontWeight",value:function t(e){return arguments.length?(this._fontWeight=typeof e==="function"?e:Oc(e),this):this._fontWeight}},{key:"height",value:function t(e){return arguments.length?(this._height=typeof e==="function"?e:Oc(e),this):this._height}},{key:"html",value:function t(e){return arguments.length?(this._html=typeof e==="boolean"?e?gC:false:e,this):this._html}},{key:"id",value:function t(e){return arguments.length?(this._id=typeof e==="function"?e:Oc(e),this):this._id}},{key:"lineHeight",value:function t(e){return arguments.length?(this._lineHeight=typeof e==="function"?e:Oc(e),this):this._lineHeight}},{key:"maxLines",value:function t(e){return arguments.length?(this._maxLines=typeof e==="function"?e:Oc(e),this):this._maxLines}},{key:"overflow",value:function t(e){return arguments.length?(this._overflow=typeof e==="function"?e:Oc(e),this):this._overflow}},{key:"padding",value:function t(e){return arguments.length?(this._padding=typeof e==="function"?e:Oc(e),this):this._padding}},{key:"pointerEvents",value:function t(e){return arguments.length?(this._pointerEvents=typeof e==="function"?e:Oc(e),this):this._pointerEvents}},{key:"rotate",value:function t(e){return arguments.length?(this._rotate=typeof e==="function"?e:Oc(e),this):this._rotate}},{key:"rotateAnchor",value:function t(e){return arguments.length?(this._rotateAnchor=typeof e==="function"?e:Oc(e),this):this._rotateAnchor}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"split",value:function t(e){return arguments.length?(this._split=e,this):this._split}},{key:"text",value:function t(e){return arguments.length?(this._text=typeof e==="function"?e:Oc(e),this):this._text}},{key:"textAnchor",value:function t(e){return arguments.length?(this._textAnchor=typeof e==="function"?e:Oc(e),this):this._textAnchor}},{key:"verticalAlign",value:function t(e){return arguments.length?(this._verticalAlign=typeof e==="function"?e:Oc(e),this):this._verticalAlign}},{key:"width",value:function t(e){return arguments.length?(this._width=typeof e==="function"?e:Oc(e),this):this._width}},{key:"x",value:function t(e){return arguments.length?(this._x=typeof e==="function"?e:Oc(e),this):this._x}},{key:"y",value:function t(e){return arguments.length?(this._y=typeof e==="function"?e:Oc(e),this):this._y}}]);return e}(Mc);var vC=function(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i};var mC=function(t,e){return Math.sqrt(vC(t,e))};function _C(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){_C=function t(e){return ie(e)}}else{_C=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return _C(t)}function yC(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function bC(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function wC(t,e,n){if(e)bC(t.prototype,e);if(n)bC(t,n);return t}function xC(t,e){if(e&&(_C(e)==="object"||typeof e==="function")){return e}return kC(t)}function kC(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function SC(t){SC=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return SC(t)}function CC(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)AC(t,e)}function AC(t,e){AC=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return AC(t,e)}var EC=function(t){CC(e,t);function e(){var a;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"g";yC(this,e);a=xC(this,SC(e).call(this));a._activeOpacity=.25;a._activeStyle={stroke:function t(e,n){var i=a._fill(e,n);if(["transparent","none"].includes(i))i=a._stroke(e,n);return Lg(i).darker(1)},"stroke-width":function t(e,n){var i=a._strokeWidth(e,n)||1;return i*3}};a._ariaLabel=Oc("");a._backgroundImage=Oc(false);a._backgroundImageClass=new bS;a._data=[];a._duration=600;a._fill=Oc("black");a._fillOpacity=Oc(1);a._hoverOpacity=.5;a._hoverStyle={stroke:function t(e,n){var i=a._fill(e,n);if(["transparent","none"].includes(i))i=a._stroke(e,n);return Lg(i).darker(.5)},"stroke-width":function t(e,n){var i=a._strokeWidth(e,n)||1;return i*2}};a._id=function(t,e){return t.id!==void 0?t.id:e};a._label=Oc(false);a._labelClass=new pC;a._labelConfig={fontColor:function t(e,n){return SS(a._fill(e,n))},fontSize:12,padding:5};a._name="Shape";a._opacity=Oc(1);a._pointerEvents=Oc("visiblePainted");a._role=Oc("presentation");a._rotate=Oc(0);a._rx=Oc(0);a._ry=Oc(0);a._scale=Oc(1);a._shapeRendering=Oc("geometricPrecision");a._stroke=function(t,e){return Lg(a._fill(t,e)).darker(1)};a._strokeDasharray=Oc("0");a._strokeLinecap=Oc("butt");a._strokeOpacity=Oc(1);a._strokeWidth=Oc(0);a._tagName=t;a._textAnchor=Oc("start");a._vectorEffect=Oc("non-scaling-stroke");a._verticalAlign=Oc("top");a._x=g("x",0);a._y=g("y",0);return a}wC(e,[{key:"_aes",value:function t(){return{}}},{key:"_applyEvents",value:function t(e){var r=this;var o=Object.keys(this._on);var n=function t(a){e.on(o[a],function(t,e){if(!r._on[o[a]])return;if(t.i!==void 0)e=t.i;if(t.nested&&t.values){var n=Ed(r._select.node()),i=t.values.map(function(t){return mC(n,[r._x(t,e),r._y(t,e)])});t=t.values[i.indexOf(fm(i))]}r._on[o[a]].bind(r)(t,e)})};for(var i=0;i<o.length;i++){n(i)}}},{key:"_updateStyle",value:function t(e,n){var i=this;if(e.size()&&e.node().tagName==="g")e=e.selectAll("*");function a(t,e){return typeof this!=="function"?this:t.nested&&t.key&&t.values?this(t.values[0],i._data.indexOf(t.values[0])):this(t,e)}var r={};for(var o in n){if({}.hasOwnProperty.call(n,o)){r[o]=a.bind(n[o])}}e.transition().duration(0).call(_,r)}},{key:"_applyStyle",value:function t(e){var n=this;if(e.size()&&e.node().tagName==="g")e=e.selectAll("*");function i(t,e){return typeof this!=="function"?this:t.nested&&t.key&&t.values?this(t.values[0],n._data.indexOf(t.values[0])):this(t,e)}e.attr("fill",i.bind(this._fill)).attr("fill-opacity",i.bind(this._fillOpacity)).attr("rx",i.bind(this._rx)).attr("ry",i.bind(this._ry)).attr("stroke",i.bind(this._stroke)).attr("stroke-dasharray",i.bind(this._strokeDasharray)).attr("stroke-linecap",i.bind(this._strokeLinecap)).attr("stroke-opacity",i.bind(this._strokeOpacity)).attr("stroke-width",i.bind(this._strokeWidth)).attr("vector-effect",i.bind(this._vectorEffect))}},{key:"_applyTransform",value:function t(e){var n=this;e.attr("transform",function(t,e){return"\n        translate(".concat(t.__d3plusShape__?t.translate?t.translate:"".concat(n._x(t.data,t.i),",").concat(n._y(t.data,t.i)):"".concat(n._x(t,e),",").concat(n._y(t,e)),")\n        scale(").concat(t.__d3plusShape__?t.scale||n._scale(t.data,t.i):n._scale(t,e),")\n        rotate(").concat(t.__d3plusShape__?t.rotate?t.rotate:n._rotate(t.data||t,t.i):n._rotate(t.data||t,t.i),")")})}},{key:"_nestWrapper",value:function t(n){return function(t,e){return n(t.__d3plusShape__?t.data:t,t.__d3plusShape__?t.i:e)}}},{key:"_renderActive",value:function t(){var a=this;this._group.selectAll(".d3plus-Shape, .d3plus-Image, .d3plus-textBox").each(function(t,e){if(!t)t={};if(!t.parentNode)t.parentNode=this.parentNode;var n=t.parentNode;if(Sd(this).classed("d3plus-textBox"))t=t.data;if(t.__d3plusShape__||t.__d3plus__){while(t&&(t.__d3plusShape__||t.__d3plus__)){e=t.i;t=t.data}}else e=a._data.indexOf(t);var i=!a._active||typeof a._active!=="function"||!a._active(t,e)?n:a._activeGroup.node();if(i!==this.parentNode){i.appendChild(this);if(this.className.baseVal.includes("d3plus-Shape")){if(n===i)Sd(this).call(a._applyStyle.bind(a));else Sd(this).call(a._updateStyle.bind(a,Sd(this),a._activeStyle))}}});this._group.selectAll("g.d3plus-".concat(this._name,"-shape, g.d3plus-").concat(this._name,"-image, g.d3plus-").concat(this._name,"-text")).attr("opacity",this._hover?this._hoverOpacity:this._active?this._activeOpacity:1)}},{key:"_renderHover",value:function t(){var a=this;this._group.selectAll("g.d3plus-".concat(this._name,"-shape, g.d3plus-").concat(this._name,"-image, g.d3plus-").concat(this._name,"-text, g.d3plus-").concat(this._name,"-hover")).selectAll(".d3plus-Shape, .d3plus-Image, .d3plus-textBox").each(function(t,e){if(!t)t={};if(!t.parentNode)t.parentNode=this.parentNode;var n=t.parentNode;if(Sd(this).classed("d3plus-textBox"))t=t.data;if(t.__d3plusShape__||t.__d3plus__){while(t&&(t.__d3plusShape__||t.__d3plus__)){e=t.i;t=t.data}}else e=a._data.indexOf(t);var i=!a._hover||typeof a._hover!=="function"||!a._hover(t,e)?n:a._hoverGroup.node();if(i!==this.parentNode)i.appendChild(this);if(this.className.baseVal.includes("d3plus-Shape")){if(n===i)Sd(this).call(a._applyStyle.bind(a));else Sd(this).call(a._updateStyle.bind(a,Sd(this),a._hoverStyle))}});this._group.selectAll("g.d3plus-".concat(this._name,"-shape, g.d3plus-").concat(this._name,"-image, g.d3plus-").concat(this._name,"-text")).attr("opacity",this._hover?this._hoverOpacity:this._active?this._activeOpacity:1)}},{key:"_renderImage",value:function t(){var u=this;var h=[];this._update.merge(this._enter).data().forEach(function(t,e){var n=u._aes(t,e);if(n.r||n.width&&n.height){var i=t;if(t.nested&&t.key&&t.values){i=t.values[0];e=u._data.indexOf(i)}var a=n.r?n.r*2:n.height,r=u._backgroundImage(i,e),o=n.r?n.r*2:n.width;if(r){var s=i.__d3plusShape__?i.translate?i.translate[0]:u._x(i.data,i.i):u._x(i,e),l=i.__d3plusShape__?i.translate?i.translate[1]:u._y(i.data,i.i):u._y(i,e);if(n.x)s+=n.x;if(n.y)l+=n.y;if(i.__d3plusShape__){i=i.data;e=i.i}h.push({__d3plus__:true,data:i,height:a,i:e,id:u._id(i,e),url:r,width:o,x:s+-o/2,y:l+-a/2})}}});this._backgroundImageClass.data(h).duration(this._duration).opacity(this._nestWrapper(this._opacity)).pointerEvents("none").select(Wv("g.d3plus-".concat(this._name,"-image"),{parent:this._group,update:{opacity:this._active?this._activeOpacity:1}}).node()).render()}},{key:"_renderLabels",value:function t(){var f=this;var d=[];this._update.merge(this._enter).data().forEach(function(t,e){var n=t;if(t.nested&&t.key&&t.values){n=t.values[0];e=f._data.indexOf(n)}var i=f._label(n,e);if(f._labelBounds&&i!==false&&i!==undefined&&i!==null){var a=f._labelBounds(n,e,f._aes(t,e));if(a){if(i.constructor!==Array)i=[i];var r=n.__d3plusShape__?n.translate?n.translate[0]:f._x(n.data,n.i):f._x(n,e),o=n.__d3plusShape__?n.translate?n.translate[1]:f._y(n.data,n.i):f._y(n,e);if(n.__d3plusShape__){n=n.data;e=n.i}for(var s=0;s<i.length;s++){var l=a.constructor===Array?a[s]:Object.assign({},a);var u=f._rotate(n,e);var h=n.labelConfig&&n.labelConfig.rotate?n.labelConfig.rotate:a.angle!==undefined?a.angle:0;h+=u;var c=u!==0?[l.x*-1||0,l.y*-1||0]:[l.width/2,l.height/2];d.push({__d3plus__:true,data:n,height:l.height,l:s,id:"".concat(f._id(n,e),"_").concat(s),r:h,rotateAnchor:c,text:i[s],width:l.width,x:r+l.x,y:o+l.y})}}}});this._labelClass.data(d).duration(this._duration).fontOpacity(this._nestWrapper(this._opacity)).pointerEvents("none").rotate(function(t){return t.__d3plus__?t.r:t.data.r}).rotateAnchor(function(t){return t.__d3plus__?t.rotateAnchor:t.data.rotateAnchor}).select(Wv("g.d3plus-".concat(this._name,"-text"),{parent:this._group,update:{opacity:this._active?this._activeOpacity:1}}).node()).config(Bc.bind(this)(this._labelConfig)).render()}},{key:"render",value:function t(e){var n=this;if(this._select===void 0){this.select(Sd("body").append("svg").style("width","".concat(window.innerWidth,"px")).style("height","".concat(window.innerHeight,"px")).style("display","block").node())}this._transition=Lv().duration(this._duration);var i=this._data,a=this._id;if(this._dataFilter){i=this._dataFilter(i);if(i.key)a=i.key}if(this._sort){i=i.sort(function(t,e){while(t.__d3plusShape__||t.__d3plus__){t=t.data}while(e.__d3plusShape__||e.__d3plus__){e=e.data}return n._sort(t,e)})}Md("g.d3plus-".concat(this._name,"-hover > *, g.d3plus-").concat(this._name,"-active > *")).each(function(t){if(t&&t.parentNode)t.parentNode.appendChild(this);else this.parentNode.removeChild(this)});this._group=Wv("g.d3plus-".concat(this._name,"-group"),{parent:this._select});var r=this._update=Wv("g.d3plus-".concat(this._name,"-shape"),{parent:this._group,update:{opacity:this._active?this._activeOpacity:1}}).selectAll(".d3plus-".concat(this._name)).data(i,a);r.order();if(this._duration){r.transition(this._transition).call(this._applyTransform.bind(this))}else{r.call(this._applyTransform.bind(this))}var o=this._enter=r.enter().append(this._tagName).attr("class",function(t,e){return"d3plus-Shape d3plus-".concat(n._name," d3plus-id-").concat(VS(n._nestWrapper(n._id)(t,e)))}).call(this._applyTransform.bind(this)).attr("aria-label",this._ariaLabel).attr("role",this._role).attr("opacity",this._nestWrapper(this._opacity));var s=o.merge(r);var l=s.attr("shape-rendering",this._nestWrapper(this._shapeRendering));if(this._duration){l=l.attr("pointer-events","none").transition(this._transition).transition().delay(100).attr("pointer-events",this._pointerEvents)}l.attr("opacity",this._nestWrapper(this._opacity));var u=this._exit=r.exit();if(this._duration)u.transition().delay(this._duration).remove();else u.remove();this._renderImage();this._renderLabels();this._hoverGroup=Wv("g.d3plus-".concat(this._name,"-hover"),{parent:this._group});this._activeGroup=Wv("g.d3plus-".concat(this._name,"-active"),{parent:this._group});var h=this._group.selectAll(".d3plus-HitArea").data(this._hitArea&&Object.keys(this._on).length?i:[],a);h.order().call(this._applyTransform.bind(this));var c=this._name==="Line";c&&this._path.curve(Yk["curve".concat(this._curve.charAt(0).toUpperCase()).concat(this._curve.slice(1))]).defined(this._defined).x(this._x).y(this._y);var f=h.enter().append(c?"path":"rect").attr("class",function(t,e){return"d3plus-HitArea d3plus-id-".concat(VS(n._nestWrapper(n._id)(t,e)))}).attr("fill","black").attr("stroke","black").attr("pointer-events","painted").attr("opacity",0).call(this._applyTransform.bind(this));var d=this;var g=h.merge(f).each(function(t){var e=d._data.indexOf(t);var n=d._hitArea(t,e,d._aes(t,e));return n&&!(d._name==="Line"&&parseFloat(d._strokeWidth(t,e))>10)?Sd(this).call(_,n):Sd(this).remove()});h.exit().remove();this._applyEvents(this._hitArea?g:s);setTimeout(function(){if(n._active)n._renderActive();else if(n._hover)n._renderHover();if(e)e()},this._duration+100);return this}},{key:"active",value:function t(e){if(!arguments.length||e===undefined)return this._active;this._active=e;if(this._group){this._renderActive()}return this}},{key:"activeOpacity",value:function t(e){return arguments.length?(this._activeOpacity=e,this):this._activeOpacity}},{key:"activeStyle",value:function t(e){return arguments.length?(this._activeStyle=gt({},this._activeStyle,e),this):this._activeStyle}},{key:"ariaLabel",value:function t(e){return e!==undefined?(this._ariaLabel=typeof e==="function"?e:Oc(e),this):this._ariaLabel}},{key:"backgroundImage",value:function t(e){return arguments.length?(this._backgroundImage=typeof e==="function"?e:Oc(e),this):this._backgroundImage}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"fill",value:function t(e){return arguments.length?(this._fill=typeof e==="function"?e:Oc(e),this):this._fill}},{key:"fillOpacity",value:function t(e){return arguments.length?(this._fillOpacity=typeof e==="function"?e:Oc(e),this):this._fillOpacity}},{key:"hover",value:function t(e){if(!arguments.length||e===void 0)return this._hover;this._hover=e;if(this._group){this._renderHover()}return this}},{key:"hoverStyle",value:function t(e){return arguments.length?(this._hoverStyle=gt({},this._hoverStyle,e),this):this._hoverStyle}},{key:"hoverOpacity",value:function t(e){return arguments.length?(this._hoverOpacity=e,this):this._hoverOpacity}},{key:"hitArea",value:function t(e){return arguments.length?(this._hitArea=typeof e==="function"?e:Oc(e),this):this._hitArea}},{key:"id",value:function t(e){return arguments.length?(this._id=e,this):this._id}},{key:"label",value:function t(e){return arguments.length?(this._label=typeof e==="function"?e:Oc(e),this):this._label}},{key:"labelBounds",value:function t(e){return arguments.length?(this._labelBounds=typeof e==="function"?e:Oc(e),this):this._labelBounds}},{key:"labelConfig",value:function t(e){return arguments.length?(this._labelConfig=gt(this._labelConfig,e),this):this._labelConfig}},{key:"opacity",value:function t(e){return arguments.length?(this._opacity=typeof e==="function"?e:Oc(e),this):this._opacity}},{key:"pointerEvents",value:function t(e){return arguments.length?(this._pointerEvents=typeof e==="function"?e:Oc(e),this):this._pointerEvents}},{key:"role",value:function t(e){return e!==undefined?(this._role=typeof e==="function"?e:Oc(e),this):this._role}},{key:"rotate",value:function t(e){return arguments.length?(this._rotate=typeof e==="function"?e:Oc(e),this):this._rotate}},{key:"rx",value:function t(e){return arguments.length?(this._rx=typeof e==="function"?e:Oc(e),this):this._rx}},{key:"ry",value:function t(e){return arguments.length?(this._ry=typeof e==="function"?e:Oc(e),this):this._ry}},{key:"scale",value:function t(e){return arguments.length?(this._scale=typeof e==="function"?e:Oc(e),this):this._scale}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"shapeRendering",value:function t(e){return arguments.length?(this._shapeRendering=typeof e==="function"?e:Oc(e),this):this._shapeRendering}},{key:"sort",value:function t(e){return arguments.length?(this._sort=e,this):this._sort}},{key:"stroke",value:function t(e){return arguments.length?(this._stroke=typeof e==="function"?e:Oc(e),this):this._stroke}},{key:"strokeDasharray",value:function t(e){return arguments.length?(this._strokeDasharray=typeof e==="function"?e:Oc(e),this):this._strokeDasharray}},{key:"strokeLinecap",value:function t(e){return arguments.length?(this._strokeLinecap=typeof e==="function"?e:Oc(e),this):this._strokeLinecap}},{key:"strokeOpacity",value:function t(e){return arguments.length?(this._strokeOpacity=typeof e==="function"?e:Oc(e),this):this._strokeOpacity}},{key:"strokeWidth",value:function t(e){return arguments.length?(this._strokeWidth=typeof e==="function"?e:Oc(e),this):this._strokeWidth}},{key:"textAnchor",value:function t(e){return arguments.length?(this._textAnchor=typeof e==="function"?e:Oc(e),this):this._textAnchor}},{key:"vectorEffect",value:function t(e){return arguments.length?(this._vectorEffect=typeof e==="function"?e:Oc(e),this):this._vectorEffect}},{key:"verticalAlign",value:function t(e){return arguments.length?(this._verticalAlign=typeof e==="function"?e:Oc(e),this):this._verticalAlign}},{key:"x",value:function t(e){return arguments.length?(this._x=typeof e==="function"?e:Oc(e),this):this._x}},{key:"y",value:function t(e){return arguments.length?(this._y=typeof e==="function"?e:Oc(e),this):this._y}}]);return e}(Mc);function MC(t,e){var a=[];var r=[];function o(t,e){if(t.length===1){a.push(t[0]);r.push(t[0])}else{var n=Array(t.length-1);for(var i=0;i<n.length;i++){if(i===0){a.push(t[0])}if(i===n.length-1){r.push(t[i+1])}n[i]=[(1-e)*t[i][0]+e*t[i+1][0],(1-e)*t[i][1]+e*t[i+1][1]]}o(n,e)}}if(t.length){o(t,e)}return{left:a,right:r.reverse()}}function RC(t){var e={};if(t.length===4){e.x2=t[2][0];e.y2=t[2][1]}if(t.length>=3){e.x1=t[1][0];e.y1=t[1][1]}e.x=t[t.length-1][0];e.y=t[t.length-1][1];if(t.length===4){e.type="C"}else if(t.length===3){e.type="Q"}else{e.type="L"}return e}function TC(t,e){e=e||2;var n=[];var i=t;var a=1/e;for(var r=0;r<e-1;r++){var o=a/(1-a*r);var s=MC(i,o);n.push(s.left);i=s.right}n.push(i);return n}function BC(t,e,n){var i=[[t.x,t.y]];if(e.x1!=null){i.push([e.x1,e.y1])}if(e.x2!=null){i.push([e.x2,e.y2])}i.push([e.x,e.y]);return TC(i,n).map(RC)}var OC=/[MLCSTQAHVmlcstqahv]|-?[\d.e+-]+/g;var PC={M:["x","y"],L:["x","y"],H:["x"],V:["y"],C:["x1","y1","x2","y2","x","y"],S:["x2","y2","x","y"],Q:["x1","y1","x","y"],T:["x","y"],A:["rx","ry","xAxisRotation","largeArcFlag","sweepFlag","x","y"]};Object.keys(PC).forEach(function(t){PC[t.toLowerCase()]=PC[t]});function DC(t,e){var n=Array(t);for(var i=0;i<t;i++){n[i]=e}return n}function NC(e){return"".concat(e.type).concat(PC[e.type].map(function(t){return e[t]}).join(","))}function zC(i,a){var r={x1:"x",y1:"y",x2:"x",y2:"y"};var o=["xAxisRotation","largeArcFlag","sweepFlag"];if(i.type!==a.type&&a.type.toUpperCase()!=="M"){var s={};Object.keys(a).forEach(function(t){var e=a[t];var n=i[t];if(n===undefined){if(o.includes(t)){n=e}else{if(n===undefined&&r[t]){n=i[r[t]]}if(n===undefined){n=0}}}s[t]=n});s.type=a.type;i=s}return i}function FC(t,e,n){var i=[];if(e.type==="L"||e.type==="Q"||e.type==="C"){i=i.concat(BC(t,e,n))}else{var a=Object.assign({},t);if(a.type==="M"){a.type="L"}i=i.concat(DC(n-1).map(function(){return a}));i.push(e)}return i}function LC(r,t,o){var e=r.length-1;var n=t.length-1;var s=e/n;var i=DC(n).reduce(function(t,e,n){var i=Math.floor(s*n);if(o&&i<r.length-1&&o(r[i],r[i+1])){var a=s*n%1<.5;if(t[i]){if(a){if(i>0){i-=1}else if(i<r.length-1){i+=1}}else if(i<r.length-1){i+=1}else if(i>0){i-=1}}}t[i]=(t[i]||0)+1;return t},[]);var a=i.reduce(function(t,e,n){if(n===r.length-1){var i=DC(e,Object.assign({},r[r.length-1]));if(i[0].type==="M"){i.forEach(function(t){t.type="L"})}return t.concat(i)}return t.concat(FC(r[n],r[n+1],e))},[]);a.unshift(r[0]);return a}function jC(t){var e=(t||"").match(OC)||[];var n=[];var i;var a;for(var r=0;r<e.length;++r){i=PC[e[r]];if(i){a={type:e[r]};for(var o=0;o<i.length;++o){a[i[o]]=+e[r+o+1]}r+=i.length;n.push(a)}}return n}function IC(t,y,e){var b=jC(t);var w=jC(y);if(!b.length&&!w.length){return function t(){return""}}if(!b.length){b.push(w[0])}else if(!w.length){w.push(b[0])}var n=Math.abs(w.length-b.length);if(n!==0){if(w.length>b.length){b=LC(b,w,e)}else if(w.length<b.length){w=LC(w,b,e)}}b=b.map(function(t,e){return zC(t,w[e])});var x=b.map(function(t){return r({},t)});var k=(t==null||t[t.length-1]==="Z")&&(y==null||y[y.length-1]==="Z");return function t(e){if(e===1){return y==null?"":y}if(e>0){for(var n=0;n<x.length;++n){var i=b[n];var a=w[n];var r=x[n];var o=true;var s=false;var l=undefined;try{for(var u=PC[r.type][Symbol.iterator](),h;!(o=(h=u.next()).done);o=true){var c=h.value;r[c]=(1-e)*i[c]+e*a[c];if(c==="largeArcFlag"||c==="sweepFlag"){r[c]=Math.round(r[c])}}}catch(t){s=true;l=t}finally{try{if(!o&&u["return"]!=null){u["return"]()}}finally{if(s){throw l}}}}}var f="";var d=true;var g=false;var p=undefined;try{for(var v=x[Symbol.iterator](),m;!(d=(m=v.next()).done);d=true){var _=m.value;f+=NC(_)}}catch(t){g=true;p=t}finally{try{if(!d&&v["return"]!=null){v["return"]()}}finally{if(g){throw p}}}if(k){f+="Z"}return f}}function HC(t){var e=-1,n=t.length,i,a=t[n-1],r=0;while(++e<n){i=a;a=t[e];r+=i[1]*a[0]-i[0]*a[1]}return r/2}function VC(t){var e=-1,n=t.length,i=0,a=0,r,o=t[n-1],s,l=0;while(++e<n){r=o;o=t[e];l+=s=r[0]*o[1]-o[0]*r[1];i+=(r[0]+o[0])*s;a+=(r[1]+o[1])*s}return l*=3,[i/l,a/l]}function UC(t,e){var n=t.length,i=t[n-1],a=e[0],r=e[1],o=i[0],s=i[1],l,u,h=false;for(var c=0;c<n;++c){i=t[c],l=i[0],u=i[1];if(u>r!==s>r&&a<(o-l)*(r-u)/(s-u)+l)h=!h;o=l,s=u}return h}function GC(t,e,n,i){var a=1e-9;var r=t[0]-e[0],o=n[0]-i[0],s=t[1]-e[1],l=n[1]-i[1];var u=r*l-s*o;if(Math.abs(u)<a)return null;var h=t[0]*e[1]-t[1]*e[0],c=n[0]*i[1]-n[1]*i[0];var f=(h*o-c*r)/u,d=(h*l-c*s)/u;return[f,d]}function WC(t,e){return YC(t)||qC(t,e)||KC()}function KC(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function qC(t,e){if(!(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")){return}var n=[];var i=true;var a=false;var r=undefined;try{for(var o=t[Symbol.iterator](),s;!(i=(s=o.next()).done);i=true){n.push(s.value);if(e&&n.length===e)break}}catch(t){a=true;r=t}finally{try{if(!i&&o["return"]!=null)o["return"]()}finally{if(a)throw r}}return n}function YC(t){if(Array.isArray(t))return t}function XC(t,e,n){var i=1e-9,a=WC(n,2),r=a[0],o=a[1];return!(r<Math.min(t[0],e[0])-i||r>Math.max(t[0],e[0])+i||o<Math.min(t[1],e[1])-i||o>Math.max(t[1],e[1])+i)}function ZC(t,e,n,i){var a=GC(t,e,n,i);if(!a)return false;return XC(t,e,a)&&XC(n,i,a)}function JC(t,e){var n=-1;var i=t.length;var a=e.length;var r=t[i-1];while(++n<i){var o=r;r=t[n];var s=-1;var l=e[a-1];while(++s<a){var u=l;l=e[s];if(ZC(o,r,u,l))return false}}return UC(e,t[0])}function $C(t,e){return eA(t)||tA(t,e)||QC()}function QC(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function tA(t,e){if(!(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")){return}var n=[];var i=true;var a=false;var r=undefined;try{for(var o=t[Symbol.iterator](),s;!(i=(s=o.next()).done);i=true){n.push(s.value);if(e&&n.length===e)break}}catch(t){a=true;r=t}finally{try{if(!i&&o["return"]!=null)o["return"]()}finally{if(a)throw r}}return n}function eA(t){if(Array.isArray(t))return t}function nA(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var i=1e-9;e=[e[0]+i*Math.cos(n),e[1]+i*Math.sin(n)];var a=e,r=$C(a,2),o=r[0],s=r[1];var l=[o+Math.cos(n),s+Math.sin(n)];var u=0;if(Math.abs(l[0]-o)<i)u=1;var h=-1;var c=t.length;var f=t[c-1];var d=Number.MAX_VALUE;var g=Number.MAX_VALUE;var p=null;var v=null;while(++h<c){var m=f;f=t[h];var _=GC(e,l,m,f);if(_&&XC(m,f,_)){var y=vC(e,_);if(_[u]<e[u]){if(y<d){d=y;p=_}}else if(_[u]>e[u]){if(y<g){g=y;v=_}}}}return[p,v]}function iA(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[0,0];var i=Math.cos(e),a=Math.sin(e),r=t[0]-n[0],o=t[1]-n[1];return[i*r-a*o+n[0],a*r+i*o+n[1]]}var aA=function(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[0,0];return t.map(function(t){return iA(t,e,n)})};function rA(t,e,n){var i=e[0],a=e[1];var r=n[0]-i,o=n[1]-a;if(r!==0||o!==0){var s=((t[0]-i)*r+(t[1]-a)*o)/(r*r+o*o);if(s>1){i=n[0];a=n[1]}else if(s>0){i+=r*s;a+=o*s}}r=t[0]-i;o=t[1]-a;return r*r+o*o}function oA(t,e){var n,i=t[0];var a=[i];for(var r=1,o=t.length;r<o;r++){n=t[r];if(vC(n,i)>e){a.push(n);i=n}}if(i!==n)a.push(n);return a}function sA(t,e,n,i,a){var r,o=i;for(var s=e+1;s<n;s++){var l=rA(t[s],t[e],t[n]);if(l>o){r=s;o=l}}if(o>i){if(r-e>1)sA(t,e,r,i,a);a.push(t[r]);if(n-r>1)sA(t,r,n,i,a)}}function lA(t,e){var n=t.length-1;var i=[t[0]];sA(t,0,n,e,i);i.push(t[n]);return i}var uA=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(t.length<=2)return t;var i=e*e;t=n?t:oA(t,i);t=lA(t,i);return t};function hA(t,e){return dA(t)||fA(t,e)||cA()}function cA(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function fA(t,e){if(!(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")){return}var n=[];var i=true;var a=false;var r=undefined;try{for(var o=t[Symbol.iterator](),s;!(i=(s=o.next()).done);i=true){n.push(s.value);if(e&&n.length===e)break}}catch(t){a=true;r=t}finally{try{if(!i&&o["return"]!=null)o["return"]()}finally{if(a)throw r}}return n}function dA(t){if(Array.isArray(t))return t}var gA=.5;var pA=5;var vA={};function mA(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(t.length<3){if(e.verbose)console.error("polygon has to have at least 3 points",t);return null}var n=[];e=Object.assign({angle:em(-90,90+pA,pA),cache:true,maxAspectRatio:15,minAspectRatio:1,minHeight:0,minWidth:0,nTries:20,tolerance:.02,verbose:false},e);var i=e.angle instanceof Array?e.angle:typeof e.angle==="number"?[e.angle]:typeof e.angle==="string"&&!isNaN(e.angle)?[Number(e.angle)]:[];var a=e.aspectRatio instanceof Array?e.aspectRatio:typeof e.aspectRatio==="number"?[e.aspectRatio]:typeof e.aspectRatio==="string"&&!isNaN(e.aspectRatio)?[Number(e.aspectRatio)]:[];var r=e.origin&&e.origin instanceof Array?e.origin[0]instanceof Array?e.origin:[e.origin]:[];var o;if(e.cache){o=cm(t).join(",");o+="-".concat(e.minAspectRatio);o+="-".concat(e.maxAspectRatio);o+="-".concat(e.minHeight);o+="-".concat(e.minWidth);o+="-".concat(i.join(","));o+="-".concat(r.join(","));if(vA[o])return vA[o]}var s=Math.abs(HC(t));if(s===0){if(e.verbose)console.error("polygon has 0 area",t);return null}var l=tm(t,function(t){return t[0]}),u=hA(l,2),h=u[0],c=u[1];var f=tm(t,function(t){return t[1]}),d=hA(f,2),g=d[0],p=d[1];var v=Math.min(c-h,p-g)*e.tolerance;if(v>0)t=uA(t,v);if(e.events)n.push({type:"simplify",poly:t});var m=tm(t,function(t){return t[0]});var _=hA(m,2);h=_[0];c=_[1];var y=tm(t,function(t){return t[1]});var b=hA(y,2);g=b[0];p=b[1];var w=c-h,x=p-g;var k=Math.min(w,x)/50;if(!r.length){var S=VC(t);if(!isFinite(S[0])){if(e.verbose)console.error("cannot find centroid",t);return null}if(UC(t,S))r.push(S);var C=e.nTries;while(C){var A=Math.random()*w+h;var E=Math.random()*x+g;var M=[A,E];if(UC(t,M)){r.push(M)}C--}}if(e.events)n.push({type:"origins",points:r});var R=0;var T=null;for(var B=0;B<i.length;B++){var O=i[B];var P=-O*Math.PI/180;if(e.events)n.push({type:"angle",angle:O});for(var D=0;D<r.length;D++){var N=r[D];var z=nA(t,N,P),F=hA(z,2),L=F[0],j=F[1];var I=nA(t,N,P+Math.PI/2),H=hA(I,2),V=H[0],U=H[1];var G=[];if(L&&j)G.push([(L[0]+j[0])/2,(L[1]+j[1])/2]);if(V&&U)G.push([(V[0]+U[0])/2,(V[1]+U[1])/2]);if(e.events)n.push({type:"modifOrigin",idx:D,p1W:L,p2W:j,p1H:V,p2H:U,modifOrigins:G});for(var W=0;W<G.length;W++){var K=G[W];if(e.events)n.push({type:"origin",cx:K[0],cy:K[1]});var q=nA(t,K,P),Y=hA(q,2),X=Y[0],Z=Y[1];if(X===null||Z===null)continue;var J=Math.min(vC(K,X),vC(K,Z));var $=2*Math.sqrt(J);var Q=nA(t,K,P+Math.PI/2),tt=hA(Q,2),et=tt[0],nt=tt[1];if(et===null||nt===null)continue;var it=Math.min(vC(K,et),vC(K,nt));var at=2*Math.sqrt(it);if($*at<R)continue;var rt=a;if(!rt.length){var ot=Math.max(e.minAspectRatio,e.minWidth/at,R/(at*at));var st=Math.min(e.maxAspectRatio,$/e.minHeight,$*$/R);rt=em(ot,st+gA,gA)}for(var lt=0;lt<rt.length;lt++){var ut=rt[lt];var ht=Math.max(e.minWidth,Math.sqrt(R*ut));var ct=Math.min($,at*ut);if(ct*at<R)continue;if(e.events&&ct-ht>=k)n.push({type:"aRatio",aRatio:ut});while(ct-ht>=k){var ft=(ht+ct)/2;var dt=ft/ut;var gt=hA(K,2),pt=gt[0],vt=gt[1];var mt=[[pt-ft/2,vt-dt/2],[pt+ft/2,vt-dt/2],[pt+ft/2,vt+dt/2],[pt-ft/2,vt+dt/2]];mt=aA(mt,P,K);var _t=JC(mt,t);if(_t){R=ft*dt;mt.push(mt[0]);T={area:R,cx:pt,cy:vt,width:ft,height:dt,angle:-O,points:mt};ht=ft}else{ct=ft}if(e.events)n.push({type:"rectangle",areaFraction:ft*dt/s,cx:pt,cy:vt,width:ft,height:dt,angle:O,insidePoly:_t})}}}}}if(e.cache){vA[o]=T}return e.events?Object.assign(T||{},{events:n}):T}function _A(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){_A=function t(e){return ie(e)}}else{_A=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return _A(t)}function yA(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function bA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function wA(t,e,n){if(e)bA(t.prototype,e);if(n)bA(t,n);return t}function xA(t,e){if(e&&(_A(e)==="object"||typeof e==="function")){return e}return kA(t)}function kA(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function SA(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){SA=Reflect.get}else{SA=function t(e,n,i){var a=CA(e,n);if(!a)return;var r=Object.getOwnPropertyDescriptor(a,n);if(r.get){return r.get.call(i)}return r.value}}return SA(t,e,n||t)}function CA(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=AA(t);if(t===null)break}return t}function AA(t){AA=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return AA(t)}function EA(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)MA(t,e)}function MA(t,e){MA=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return MA(t,e)}var RA=function(t){EA(r,t);function r(){var a;yA(this,r);a=xA(this,AA(r).call(this));a._curve="linear";a._defined=function(){return true};a._labelBounds=function(t,e,n){var i=mA(n.points);if(!i)return null;return{angle:i.angle,width:i.width,height:i.height,x:i.cx-i.width/2-a._x(t,e),y:i.cy-i.height/2-a._y(t,e)}};a._labelConfig=Object.assign(a._labelConfig,{textAnchor:"middle",verticalAlign:"middle"});a._name="Area";a._x=g("x");a._x0=g("x");a._x1=null;a._y=Oc(0);a._y0=Oc(0);a._y1=g("y");return a}wA(r,[{key:"_aes",value:function t(e){var n=this;var i=e.values.slice().sort(function(t,e){return n._y1?n._x(t)-n._x(e):n._y(t)-n._y(e)});var a=i.map(function(t,e){return[n._x0(t,e),n._y0(t,e)]});var r=i.reverse().map(function(t,e){return n._y1?[n._x(t,e),n._y1(t,e)]:[n._x1(t,e),n._y(t,e)]});var o=a.concat(r);if(a[0][1]>r[0][1])o=o.reverse();o.push(o[0]);return{points:o}}},{key:"_dataFilter",value:function t(i){var a=this;var e=mm().key(this._id).entries(i).map(function(t){t.data=Em(t.values);t.i=i.indexOf(t.values[0]);var e=tm(t.values.map(a._x).concat(t.values.map(a._x0)).concat(a._x1?t.values.map(a._x1):[]));t.xR=e;t.width=e[1]-e[0];t.x=e[0]+t.width/2;var n=tm(t.values.map(a._y).concat(t.values.map(a._y0)).concat(a._y1?t.values.map(a._y1):[]));t.yR=n;t.height=n[1]-n[0];t.y=n[0]+t.height/2;t.nested=true;t.translate=[t.x,t.y];t.__d3plusShape__=true;return t});e.key=function(t){return t.key};return e}},{key:"render",value:function t(e){var n=this;SA(AA(r.prototype),"render",this).call(this,e);var i=this._path=ax().defined(this._defined).curve(Yk["curve".concat(this._curve.charAt(0).toUpperCase()).concat(this._curve.slice(1))]).x(this._x).x0(this._x0).x1(this._x1).y(this._y).y0(this._y0).y1(this._y1);var a=ax().defined(function(t){return t}).curve(Yk["curve".concat(this._curve.charAt(0).toUpperCase()).concat(this._curve.slice(1))]).x(this._x).y(this._y).x0(function(t,e){return n._x1?n._x0(t,e)+(n._x1(t,e)-n._x0(t,e))/2:n._x0(t,e)}).x1(function(t,e){return n._x1?n._x0(t,e)+(n._x1(t,e)-n._x0(t,e))/2:n._x0(t,e)}).y0(function(t,e){return n._y1?n._y0(t,e)+(n._y1(t,e)-n._y0(t,e))/2:n._y0(t,e)}).y1(function(t,e){return n._y1?n._y0(t,e)+(n._y1(t,e)-n._y0(t,e))/2:n._y0(t,e)});this._enter.append("path").attr("transform",function(t){return"translate(".concat(-t.xR[0]-t.width/2,", ").concat(-t.yR[0]-t.height/2,")")}).attr("d",function(t){return a(t.values)}).call(this._applyStyle.bind(this)).transition(this._transition).attrTween("d",function(t){return IC(Sd(this).attr("d"),i(t.values))});this._update.select("path").transition(this._transition).attr("transform",function(t){return"translate(".concat(-t.xR[0]-t.width/2,", ").concat(-t.yR[0]-t.height/2,")")}).attrTween("d",function(t){return IC(Sd(this).attr("d"),i(t.values))}).call(this._applyStyle.bind(this));this._exit.select("path").transition(this._transition).attrTween("d",function(t){return IC(Sd(this).attr("d"),a(t.values))});return this}},{key:"curve",value:function t(e){return arguments.length?(this._curve=e,this):this._curve}},{key:"defined",value:function t(e){return arguments.length?(this._defined=e,this):this._defined}},{key:"x",value:function t(e){if(!arguments.length)return this._x;this._x=typeof e==="function"?e:Oc(e);this._x0=this._x;return this}},{key:"x0",value:function t(e){if(!arguments.length)return this._x0;this._x0=typeof e==="function"?e:Oc(e);this._x=this._x0;return this}},{key:"x1",value:function t(e){return arguments.length?(this._x1=typeof e==="function"||e===null?e:Oc(e),this):this._x1}},{key:"y",value:function t(e){if(!arguments.length)return this._y;this._y=typeof e==="function"?e:Oc(e);this._y0=this._y;return this}},{key:"y0",value:function t(e){if(!arguments.length)return this._y0;this._y0=typeof e==="function"?e:Oc(e);this._y=this._y0;return this}},{key:"y1",value:function t(e){return arguments.length?(this._y1=typeof e==="function"||e===null?e:Oc(e),this):this._y1}}]);return r}(EC);function TA(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){TA=function t(e){return ie(e)}}else{TA=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return TA(t)}function BA(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function OA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function PA(t,e,n){if(e)OA(t.prototype,e);if(n)OA(t,n);return t}function DA(t,e){if(e&&(TA(e)==="object"||typeof e==="function")){return e}return NA(t)}function NA(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function zA(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){zA=Reflect.get}else{zA=function t(e,n,i){var a=FA(e,n);if(!a)return;var r=Object.getOwnPropertyDescriptor(a,n);if(r.get){return r.get.call(i)}return r.value}}return zA(t,e,n||t)}function FA(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=LA(t);if(t===null)break}return t}function LA(t){LA=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return LA(t)}function jA(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)IA(t,e)}function IA(t,e){IA=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return IA(t,e)}var HA=function(t){jA(r,t);function r(){var i;BA(this,r);i=DA(this,LA(r).call(this,"rect"));i._name="Bar";i._height=Oc(10);i._labelBounds=function(t,e,n){return{width:n.width,height:n.height,x:i._x1!==null?i._getX(t,e):-n.width/2,y:i._x1===null?i._getY(t,e):-n.height/2}};i._width=Oc(10);i._x=g("x");i._x0=g("x");i._x1=null;i._y=Oc(0);i._y0=Oc(0);i._y1=g("y");return i}PA(r,[{key:"render",value:function t(e){var n=this;zA(LA(r.prototype),"render",this).call(this,e);var i=this._enter.attr("width",function(t,e){return n._x1===null?n._getWidth(t,e):0}).attr("height",function(t,e){return n._x1!==null?n._getHeight(t,e):0}).attr("x",function(t,e){return n._x1===null?-n._getWidth(t,e)/2:0}).attr("y",function(t,e){return n._x1!==null?-n._getHeight(t,e)/2:0}).call(this._applyStyle.bind(this));var a=this._update;if(this._duration){i=i.transition(this._transition);a=a.transition(this._transition);this._exit.transition(this._transition).attr("width",function(t,e){return n._x1===null?n._getWidth(t,e):0}).attr("height",function(t,e){return n._x1!==null?n._getHeight(t,e):0}).attr("x",function(t,e){return n._x1===null?-n._getWidth(t,e)/2:0}).attr("y",function(t,e){return n._x1!==null?-n._getHeight(t,e)/2:0})}i.call(this._applyPosition.bind(this));a.call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));return this}},{key:"_aes",value:function t(e,n){return{height:this._getHeight(e,n),width:this._getWidth(e,n)}}},{key:"_applyPosition",value:function t(e){var n=this;e.attr("width",function(t,e){return n._getWidth(t,e)}).attr("height",function(t,e){return n._getHeight(t,e)}).attr("x",function(t,e){return n._x1!==null?n._getX(t,e):-n._getWidth(t,e)/2}).attr("y",function(t,e){return n._x1===null?n._getY(t,e):-n._getHeight(t,e)/2})}},{key:"_getHeight",value:function t(e,n){if(this._x1!==null)return this._height(e,n);return Math.abs(this._y1(e,n)-this._y(e,n))}},{key:"_getWidth",value:function t(e,n){if(this._x1===null)return this._width(e,n);return Math.abs(this._x1(e,n)-this._x(e,n))}},{key:"_getX",value:function t(e,n){var i=this._x1===null?this._x(e,n):this._x1(e,n)-this._x(e,n);if(i<0)return i;else return 0}},{key:"_getY",value:function t(e,n){var i=this._x1!==null?this._y(e,n):this._y1(e,n)-this._y(e,n);if(i<0)return i;else return 0}},{key:"height",value:function t(e){return arguments.length?(this._height=typeof e==="function"?e:Oc(e),this):this._height}},{key:"width",value:function t(e){return arguments.length?(this._width=typeof e==="function"?e:Oc(e),this):this._width}},{key:"x0",value:function t(e){if(!arguments.length)return this._x0;this._x0=typeof e==="function"?e:Oc(e);this._x=this._x0;return this}},{key:"x1",value:function t(e){return arguments.length?(this._x1=typeof e==="function"||e===null?e:Oc(e),this):this._x1}},{key:"y0",value:function t(e){if(!arguments.length)return this._y0;this._y0=typeof e==="function"?e:Oc(e);this._y=this._y0;return this}},{key:"y1",value:function t(e){return arguments.length?(this._y1=typeof e==="function"||e===null?e:Oc(e),this):this._y1}}]);return r}(EC);function VA(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){VA=function t(e){return ie(e)}}else{VA=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return VA(t)}function UA(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function GA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function WA(t,e,n){if(e)GA(t.prototype,e);if(n)GA(t,n);return t}function KA(t,e){if(e&&(VA(e)==="object"||typeof e==="function")){return e}return qA(t)}function qA(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function YA(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){YA=Reflect.get}else{YA=function t(e,n,i){var a=XA(e,n);if(!a)return;var r=Object.getOwnPropertyDescriptor(a,n);if(r.get){return r.get.call(i)}return r.value}}return YA(t,e,n||t)}function XA(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=ZA(t);if(t===null)break}return t}function ZA(t){ZA=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return ZA(t)}function JA(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)$A(t,e)}function $A(t,e){$A=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return $A(t,e)}var QA=function(t){JA(a,t);function a(){var t;UA(this,a);t=KA(this,ZA(a).call(this,"circle"));t._labelBounds=function(t,e,n){return{width:n.r*1.5,height:n.r*1.5,x:-n.r*.75,y:-n.r*.75}};t._labelConfig=gt(t._labelConfig,{textAnchor:"middle",verticalAlign:"middle"});t._name="Circle";t._r=g("r");return t}WA(a,[{key:"_applyPosition",value:function t(e){var n=this;e.attr("r",function(t,e){return n._r(t,e)}).attr("x",function(t,e){return-n._r(t,e)/2}).attr("y",function(t,e){return-n._r(t,e)/2})}},{key:"render",value:function t(e){YA(ZA(a.prototype),"render",this).call(this,e);var n=this._enter.call(this._applyStyle.bind(this));var i=this._update;if(this._duration){n.attr("r",0).attr("x",0).attr("y",0).transition(this._transition).call(this._applyPosition.bind(this));i=i.transition(this._transition);this._exit.transition(this._transition).attr("r",0).attr("x",0).attr("y",0)}else{n.call(this._applyPosition.bind(this))}i.call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));return this}},{key:"_aes",value:function t(e,n){return{r:this._r(e,n)}}},{key:"r",value:function t(e){return arguments.length?(this._r=typeof e==="function"?e:Oc(e),this):this._r}}]);return a}(EC);function tE(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){tE=function t(e){return ie(e)}}else{tE=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return tE(t)}function eE(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function nE(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function iE(t,e,n){if(e)nE(t.prototype,e);if(n)nE(t,n);return t}function aE(t,e){if(e&&(tE(e)==="object"||typeof e==="function")){return e}return rE(t)}function rE(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function oE(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){oE=Reflect.get}else{oE=function t(e,n,i){var a=sE(e,n);if(!a)return;var r=Object.getOwnPropertyDescriptor(a,n);if(r.get){return r.get.call(i)}return r.value}}return oE(t,e,n||t)}function sE(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=lE(t);if(t===null)break}return t}function lE(t){lE=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return lE(t)}function uE(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)hE(t,e)}function hE(t,e){hE=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return hE(t,e)}var cE=function(t){uE(a,t);function a(){var t;eE(this,a);t=aE(this,lE(a).call(this,"rect"));t._height=g("height");t._labelBounds=function(t,e,n){return{width:n.width,height:n.height,x:-n.width/2,y:-n.height/2}};t._name="Rect";t._width=g("width");return t}iE(a,[{key:"render",value:function t(e){oE(lE(a.prototype),"render",this).call(this,e);var n=this._enter.attr("width",0).attr("height",0).attr("x",0).attr("y",0).call(this._applyStyle.bind(this));var i=this._update;if(this._duration){n=n.transition(this._transition);i=i.transition(this._transition);this._exit.transition(this._transition).attr("width",0).attr("height",0).attr("x",0).attr("y",0)}n.call(this._applyPosition.bind(this));i.call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));return this}},{key:"_aes",value:function t(e,n){return{width:this._width(e,n),height:this._height(e,n)}}},{key:"_applyPosition",value:function t(e){var n=this;e.attr("width",function(t,e){return n._width(t,e)}).attr("height",function(t,e){return n._height(t,e)}).attr("x",function(t,e){return-n._width(t,e)/2}).attr("y",function(t,e){return-n._height(t,e)/2})}},{key:"height",value:function t(e){return arguments.length?(this._height=typeof e==="function"?e:Oc(e),this):this._height}},{key:"width",value:function t(e){return arguments.length?(this._width=typeof e==="function"?e:Oc(e),this):this._width}}]);return a}(EC);function fE(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){fE=function t(e){return ie(e)}}else{fE=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return fE(t)}function dE(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function gE(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function pE(t,e,n){if(e)gE(t.prototype,e);if(n)gE(t,n);return t}function vE(t,e){if(e&&(fE(e)==="object"||typeof e==="function")){return e}return mE(t)}function mE(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function _E(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){_E=Reflect.get}else{_E=function t(e,n,i){var a=yE(e,n);if(!a)return;var r=Object.getOwnPropertyDescriptor(a,n);if(r.get){return r.get.call(i)}return r.value}}return _E(t,e,n||t)}function yE(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=bE(t);if(t===null)break}return t}function bE(t){bE=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return bE(t)}function wE(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)xE(t,e)}function xE(t,e){xE=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return xE(t,e)}var kE=function(t){wE(s,t);function s(){var n;dE(this,s);n=vE(this,bE(s).call(this));n._curve="linear";n._defined=function(t){return t};n._fill=Oc("none");n._hitArea=Oc({d:function t(e){return n._path(e.values)},fill:"none","stroke-width":10,transform:null});n._name="Line";n._path=ix();n._stroke=Oc("black");n._strokeWidth=Oc(1);return n}pE(s,[{key:"_dataFilter",value:function t(i){var a=this;var e=mm().key(this._id).entries(i).map(function(t){t.data=Em(t.values);t.i=i.indexOf(t.values[0]);var e=tm(t.values,a._x);t.xR=e;t.width=e[1]-e[0];t.x=e[0]+t.width/2;var n=tm(t.values,a._y);t.yR=n;t.height=n[1]-n[0];t.y=n[0]+t.height/2;t.nested=true;t.translate=[t.x,t.y];t.__d3plusShape__=true;return t});e.key=function(t){return t.key};return e}},{key:"render",value:function t(e){var n=this;_E(bE(s.prototype),"render",this).call(this,e);var o=this;function i(t){t.initialLength=this.getTotalLength();var e=o._strokeDasharray(t.values[0],o._data.indexOf(t.values[0])).split(" ").map(Number);if(e.length===1&&e[0]===0)e=[t.initialLength];else if(e.length===1)e.push(e[0]);else if(e.length%2)e=e.concat(e);var n=[];var i=0;while(i<t.initialLength){for(var a=0;a<e.length;a++){var r=e[a];i+=r;n.push(r);if(i>=t.initialLength)break}}if(n.length>1&&n.length%2)n.pop();n[n.length-1]+=t.initialLength-dm(n);if(n.length%2===0)n.push(0);t.initialStrokeArray=n.join(" ")}this._path.curve(Yk["curve".concat(this._curve.charAt(0).toUpperCase()).concat(this._curve.slice(1))]).defined(this._defined).x(this._x).y(this._y);var a=this._enter.append("path").attr("transform",function(t){return"translate(".concat(-t.xR[0]-t.width/2,", ").concat(-t.yR[0]-t.height/2,")")}).attr("d",function(t){return n._path(t.values)}).call(this._applyStyle.bind(this));var r=this._update.select("path").attr("stroke-dasharray",function(t){return o._strokeDasharray(t.values[0],o._data.indexOf(t.values[0]))});if(this._duration){a.each(i).attr("stroke-dasharray",function(t){return"".concat(t.initialStrokeArray," ").concat(t.initialLength)}).attr("stroke-dashoffset",function(t){return t.initialLength}).transition(this._transition).attr("stroke-dashoffset",0);r=r.transition(this._transition).attrTween("d",function(t){return IC(Sd(this).attr("d"),o._path(t.values))});this._exit.selectAll("path").each(i).attr("stroke-dasharray",function(t){return"".concat(t.initialStrokeArray," ").concat(t.initialLength)}).transition(this._transition).attr("stroke-dashoffset",function(t){return-t.initialLength})}else{r=r.attr("d",function(t){return o._path(t.values)})}r.attr("transform",function(t){return"translate(".concat(-t.xR[0]-t.width/2,", ").concat(-t.yR[0]-t.height/2,")")}).call(this._applyStyle.bind(this));return this}},{key:"_aes",value:function t(e,n){var i=this;return{points:e.values.map(function(t){return[i._x(t,n),i._y(t,n)]})}}},{key:"curve",value:function t(e){return arguments.length?(this._curve=e,this):this._curve}},{key:"defined",value:function t(e){return arguments.length?(this._defined=e,this):this._defined}}]);return s}(EC);function SE(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){SE=function t(e){return ie(e)}}else{SE=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return SE(t)}function CE(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function AE(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function EE(t,e,n){if(e)AE(t.prototype,e);if(n)AE(t,n);return t}function ME(t,e){if(e&&(SE(e)==="object"||typeof e==="function")){return e}return RE(t)}function RE(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function TE(t){TE=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return TE(t)}function BE(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)OE(t,e)}function OE(t,e){OE=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return OE(t,e)}var PE={Circle:QA,Rect:cE};var DE=function(t){BE(e,t);function e(){var t;CE(this,e);t=ME(this,TE(e).call(this));t._endpoint=g("endpoint","Rect");t._endpointConfig={Circle:{r:g("r",5)}};t._length=g("length",25);t._lineConfig={};t._orient=g("orient","top");t._x=g("x",0);t._y=g("y",0);return t}EE(e,[{key:"render",value:function t(e){var s=this;if(this._select===void 0){this.select(Sd("body").append("svg").style("width","".concat(window.innerWidth,"px")).style("height","".concat(window.innerHeight,"px")).style("display","block").node())}var l=[];this._data.forEach(function(t,e){var n=s._orient(t,e);var i=s._x(t,e);var a=s._y(t,e);var r=i;if(n==="left")r-=s._length(t,e);else if(n==="right")r+=s._length(t,e);var o=a;if(n==="top")o-=s._length(t,e);else if(n==="bottom")o+=s._length(t,e);l.push({__d3plus__:true,data:t,i:e,id:e,x:i,y:a});l.push({__d3plus__:true,data:t,i:e,id:e,x:r,y:o})});this._line=(new kE).data(l).select(Wv("g.d3plus-Whisker",{parent:this._select}).node()).config(Bc.bind(this)(this._lineConfig,"shape")).render(e);var n=this._data.map(function(t,e){var n={};n.__d3plus__=true;n.data=t;n.i=e;n.endpoint=s._endpoint(t,e);n.length=s._length(t,e);n.orient=s._orient(t,e);var i=s._x(t,e);if(n.orient==="left")i-=n.length;else if(n.orient==="right")i+=n.length;var a=s._y(t,e);if(n.orient==="top")a-=n.length;else if(n.orient==="bottom")a+=n.length;n.x=i;n.y=a;return n});this._whiskerEndpoint=[];mm().key(function(t){return t.endpoint}).entries(n).forEach(function(t){var e=t.key;s._whiskerEndpoint.push((new PE[e]).data(t.values).select(Wv("g.d3plus-Whisker-Endpoint-".concat(e),{parent:s._select}).node()).config({height:function t(e){return e.orient==="top"||e.orient==="bottom"?5:20},width:function t(e){return e.orient==="top"||e.orient==="bottom"?20:5}}).config(Bc.bind(s)(s._endpointConfig,"shape",e)).render())});return this}},{key:"active",value:function t(e){if(this._line)this._line.active(e);if(this._whiskerEndpoint)this._whiskerEndpoint.forEach(function(t){return t.active(e)})}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"endpoint",value:function t(e){return arguments.length?(this._endpoint=typeof e==="function"?e:Oc(e),this):this._endpoint}},{key:"endpointConfig",value:function t(e){return arguments.length?(this._endpointConfig=gt(this._endpointConfig,e),this):this._endpointConfig}},{key:"hover",value:function t(e){if(this._line)this._line.hover(e);if(this._whiskerEndpoint)this._whiskerEndpoint.forEach(function(t){return t.hover(e)})}},{key:"length",value:function t(e){return arguments.length?(this._length=typeof e==="function"?e:Oc(e),this):this._length}},{key:"lineConfig",value:function t(e){return arguments.length?(this._lineConfig=gt(this._lineConfig,e),this):this._lineConfig}},{key:"orient",value:function t(e){return arguments.length?(this._orient=typeof e==="function"?e:Oc(e),this):this._orient}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"x",value:function t(e){return arguments.length?(this._x=typeof e==="function"?e:Oc(e),this):this._x}},{key:"y",value:function t(e){return arguments.length?(this._y=typeof e==="function"?e:Oc(e),this):this._y}}]);return e}(Mc);function NE(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){NE=function t(e){return ie(e)}}else{NE=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return NE(t)}function zE(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function FE(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function LE(t,e,n){if(e)FE(t.prototype,e);if(n)FE(t,n);return t}function jE(t,e){if(e&&(NE(e)==="object"||typeof e==="function")){return e}return IE(t)}function IE(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function HE(t){HE=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return HE(t)}function VE(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)UE(t,e)}function UE(t,e){UE=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return UE(t,e)}var GE={Circle:QA,Rect:cE};var WE=function(t){VE(e,t);function e(){var i;zE(this,e);i=jE(this,HE(e).call(this));i._medianConfig={fill:Oc("black")};i._orient=g("orient","vertical");i._outlier=g("outlier","Circle");i._outlierConfig={Circle:{r:g("r",5)},Rect:{height:function t(e,n){return i._orient(e,n)==="vertical"?5:20},width:function t(e,n){return i._orient(e,n)==="vertical"?20:5}}};i._rectConfig={fill:Oc("white"),stroke:Oc("black"),strokeWidth:Oc(1)};i._rectWidth=Oc(50);i._whiskerConfig={};i._whiskerMode=["tukey","tukey"];i._x=g("x",250);i._y=g("y",250);return i}LE(e,[{key:"render",value:function t(){var r=this;if(this._select===void 0){this.select(Sd("body").append("svg").style("width","".concat(window.innerWidth,"px")).style("height","".concat(window.innerHeight,"px")).style("display","block").node())}var o=[];var e=mm().key(function(t,e){return r._orient(t,e)==="vertical"?r._x(t,e):r._y(t,e)}).entries(this._data).map(function(a){a.data=Em(a.values);a.i=r._data.indexOf(a.values[0]);a.orient=r._orient(a.data,a.i);var t=a.values.map(a.orient==="vertical"?r._y:r._x);t.sort(function(t,e){return t-e});a.first=lm(t,.25);a.median=lm(t,.5);a.third=lm(t,.75);var e=r._whiskerMode;if(e[0]==="tukey"){a.lowerLimit=a.first-(a.third-a.first)*1.5;if(a.lowerLimit<fm(t))a.lowerLimit=fm(t)}else if(e[0]==="extent")a.lowerLimit=fm(t);else if(typeof e[0]==="number")a.lowerLimit=lm(t,e[0]);if(e[1]==="tukey"){a.upperLimit=a.third+(a.third-a.first)*1.5;if(a.upperLimit>um(t))a.upperLimit=um(t)}else if(e[1]==="extent")a.upperLimit=um(t);else if(typeof e[1]==="number")a.upperLimit=lm(t,e[1]);var n=a.third-a.first;if(a.orient==="vertical"){a.height=n;a.width=r._rectWidth(a.data,a.i);a.x=r._x(a.data,a.i);a.y=a.first+n/2}else if(a.orient==="horizontal"){a.height=r._rectWidth(a.data,a.i);a.width=n;a.x=a.first+n/2;a.y=r._y(a.data,a.i)}a.values.forEach(function(t,e){var n=a.orient==="vertical"?r._y(t,e):r._x(t,e);if(n<a.lowerLimit||n>a.upperLimit){var i={};i.__d3plus__=true;i.data=t;i.i=e;i.outlier=r._outlier(t,e);if(a.orient==="vertical"){i.x=a.x;i.y=n;o.push(i)}else if(a.orient==="horizontal"){i.y=a.y;i.x=n;o.push(i)}}});a.__d3plus__=true;return a});this._box=(new cE).data(e).x(function(t){return t.x}).y(function(t){return t.y}).select(Wv("g.d3plus-Box",{parent:this._select}).node()).config(Bc.bind(this)(this._rectConfig,"shape")).render();this._median=(new cE).data(e).x(function(t){return t.orient==="vertical"?t.x:t.median}).y(function(t){return t.orient==="vertical"?t.median:t.y}).height(function(t){return t.orient==="vertical"?1:t.height}).width(function(t){return t.orient==="vertical"?t.width:1}).select(Wv("g.d3plus-Box-Median",{parent:this._select}).node()).config(Bc.bind(this)(this._medianConfig,"shape")).render();var h=[];e.forEach(function(t,e){var n=t.x;var i=t.y;var a=t.first-t.lowerLimit;var r=t.upperLimit-t.third;if(t.orient==="vertical"){var o=i-t.height/2;var s=i+t.height/2;h.push({__d3plus__:true,data:t,i:e,x:n,y:o,length:a,orient:"top"},{__d3plus__:true,data:t,i:e,x:n,y:s,length:r,orient:"bottom"})}else if(t.orient==="horizontal"){var l=n+t.width/2;var u=n-t.width/2;h.push({__d3plus__:true,data:t,i:e,x:l,y:i,length:r,orient:"right"},{__d3plus__:true,data:t,i:e,x:u,y:i,length:a,orient:"left"})}});this._whisker=(new DE).data(h).select(Wv("g.d3plus-Box-Whisker",{parent:this._select}).node()).config(Bc.bind(this)(this._whiskerConfig,"shape")).render();this._whiskerEndpoint=[];mm().key(function(t){return t.outlier}).entries(o).forEach(function(t){var e=t.key;r._whiskerEndpoint.push((new GE[e]).data(t.values).select(Wv("g.d3plus-Box-Outlier-".concat(e),{parent:r._select}).node()).config(Bc.bind(r)(r._outlierConfig,"shape",e)).render())});return this}},{key:"active",value:function t(e){if(this._box)this._box.active(e);if(this._median)this._median.active(e);if(this._whisker)this._whisker.active(e);if(this._whiskerEndpoint)this._whiskerEndpoint.forEach(function(t){return t.active(e)})}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"hover",value:function t(e){if(this._box)this._box.hover(e);if(this._median)this._median.hover(e);if(this._whisker)this._whisker.hover(e);if(this._whiskerEndpoint)this._whiskerEndpoint.forEach(function(t){return t.hover(e)})}},{key:"medianConfig",value:function t(e){return arguments.length?(this._medianConfig=gt(this._medianConfig,e),this):this._medianConfig}},{key:"orient",value:function t(e){return arguments.length?(this._orient=typeof e==="function"?e:Oc(e),this):this._orient}},{key:"outlier",value:function t(e){return arguments.length?(this._outlier=typeof e==="function"?e:Oc(e),this):this._outlier}},{key:"outlierConfig",value:function t(e){return arguments.length?(this._outlierConfig=gt(this._outlierConfig,e),this):this._outlierConfig}},{key:"rectConfig",value:function t(e){return arguments.length?(this._rectConfig=gt(this._rectConfig,e),this):this._rectConfig}},{key:"rectWidth",value:function t(e){return arguments.length?(this._rectWidth=typeof e==="function"?e:Oc(e),this):this._rectWidth}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"whiskerConfig",value:function t(e){return arguments.length?(this._whiskerConfig=gt(this._whiskerConfig,e),this):this._whiskerConfig}},{key:"whiskerMode",value:function t(e){return arguments.length?(this._whiskerMode=e instanceof Array?e:[e,e],this):this._whiskerMode}},{key:"x",value:function t(e){return arguments.length?(this._x=typeof e==="function"?e:g(e),this):this._x}},{key:"y",value:function t(e){return arguments.length?(this._y=typeof e==="function"?e:g(e),this):this._y}}]);return e}(Mc);var KE=Math.PI;var qE=function(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"circle";if(t<0)t=KE*2+t;if(n==="square"){var i=45*(KE/180);var a=0,r=0;if(t<KE/2){var o=Math.tan(t);a+=t<i?e:e/o;r+=t<i?o*e:e}else if(t<=KE){var s=Math.tan(KE-t);a-=t<KE-i?e/s:e;r+=t<KE-i?e:s*e}else if(t<i+KE){a-=e;r-=Math.tan(t-KE)*e}else if(t<3*KE/2){a-=e/Math.tan(t-KE);r-=e}else if(t<2*KE-i){a+=e/Math.tan(2*KE-t);r-=e}else{a+=e;r-=Math.tan(2*KE-t)*e}return[a,r]}else if(n==="circle"){return[e*Math.cos(t),e*Math.sin(t)]}else return null};var YE=Math.PI;var XE=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;var n=[],i=/([MLA])([^MLAZ]+)/gi;var a=i.exec(t);while(a!==null){if(["M","L"].includes(a[1]))n.push(a[2].split(",").map(Number));else if(a[1]==="A"){var r=a[2].split(",").map(Number);var o=r.slice(r.length-2,r.length),s=n[n.length-1],l=r[0],u=mC(s,o);var h=Math.acos((l*l+l*l-u*u)/(2*l*l));if(r[2])h=YE*2-h;var c=h/(h/(YE*2)*(l*YE*2)/e);var f=Math.atan2(-s[1],-s[0])-YE;var d=c;while(d<h){n.push(qE(r[4]?f+d:f-d,l));d+=c}n.push(o)}a=i.exec(t)}return n};function ZE(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){ZE=function t(e){return ie(e)}}else{ZE=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return ZE(t)}function JE(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function $E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function QE(t,e,n){if(e)$E(t.prototype,e);if(n)$E(t,n);return t}function tM(t,e){if(e&&(ZE(e)==="object"||typeof e==="function")){return e}return eM(t)}function eM(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function nM(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){nM=Reflect.get}else{nM=function t(e,n,i){var a=iM(e,n);if(!a)return;var r=Object.getOwnPropertyDescriptor(a,n);if(r.get){return r.get.call(i)}return r.value}}return nM(t,e,n||t)}function iM(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=aM(t);if(t===null)break}return t}function aM(t){aM=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return aM(t)}function rM(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)oM(t,e)}function oM(t,e){oM=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return oM(t,e)}var sM=function(t){rM(r,t);function r(){var a;JE(this,r);a=tM(this,aM(r).call(this,"path"));a._d=g("path");a._labelBounds=function(t,e,n){var i=mA(n.points,{angle:a._labelConfig.rotate?a._labelConfig.rotate(t,e):0});return i?{angle:i.angle,width:i.width,height:i.height,x:i.cx-i.width/2,y:i.cy-i.height/2}:false};a._name="Path";a._labelConfig=Object.assign(a._labelConfig,{textAnchor:"middle",verticalAlign:"middle"});return a}QE(r,[{key:"_aes",value:function t(e,n){return{points:XE(this._d(e,n))}}},{key:"render",value:function t(e){nM(aM(r.prototype),"render",this).call(this,e);var n=this._enter.attr("d",this._d).call(this._applyStyle.bind(this));var i=this._update;if(this._duration){n.attr("opacity",0).transition(this._transition).attr("opacity",1);i=i.transition(this._transition);this._exit.transition(this._transition).attr("opacity",0)}i.call(this._applyStyle.bind(this)).attr("d",this._d);return this}},{key:"d",value:function t(e){return arguments.length?(this._d=typeof e==="function"?e:Oc(e),this):this._d}}]);return r}(EC);var lM=Object.freeze({__proto__:null,Image:bS,Shape:EC,Area:RA,Bar:HA,Box:WE,Circle:QA,Line:kE,Path:sM,Rect:cE,Whisker:DE,largestRect:mA,lineIntersection:GC,path2polygon:XE,pointDistance:mC,pointDistanceSquared:vC,pointRotate:iA,polygonInside:JC,polygonRayCast:nA,polygonRotate:aA,segmentBoxContains:XC,segmentsIntersect:ZC,shapeEdgePoint:qE,simplify:uA});function uM(t){if(t.constructor===Date)return t;else if(t.constructor===Number&&"".concat(t).length>5&&t%1===0)return new Date(t);var e="".concat(t);var n=new RegExp(/^\d{1,2}[./-]\d{1,2}[./-](-*\d{1,4})$/g).exec(e),i=new RegExp(/^[A-z]{1,3} [A-z]{1,3} \d{1,2} (-*\d{1,4}) \d{1,2}:\d{1,2}:\d{1,2} [A-z]{1,3}-*\d{1,4} \([A-z]{1,3}\)/g).exec(e);if(n){var a=n[1];if(a.indexOf("-")===0)e=e.replace(a,a.substr(1));var r=new Date(e);r.setFullYear(a);return r}else if(i){var o=i[1];if(o.indexOf("-")===0)e=e.replace(o,o.substr(1));var s=new Date(e);s.setFullYear(o);return s}else if(!e.includes("/")&&!e.includes(" ")&&(!e.includes("-")||!e.indexOf("-"))){var l=new Date("".concat(e,"/01/01"));l.setFullYear(t);return l}else return new Date(e)}var hM={"de-DE":{dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},"en-GB":{dateTime:"%a %e %b %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"en-US":{dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"es-ES":{dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],shortDays:["dom","lun","mar","mi","jue","vie","sb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},"es-MX":{dateTime:"%x, %X",date:"%d/%m/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],shortDays:["dom","lun","mar","mi","jue","vie","sb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},"fr-FR":{dateTime:"%A, le %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],months:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],shortMonths:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."]},"it-IT":{dateTime:"%A %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato"],shortDays:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],shortMonths:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"]},"pt-BR":{dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}};function cM(t,e,n){if(e in t){Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true})}else{t[e]=n}return t}function fM(t){return pM(t)||gM(t)||dM()}function dM(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function gM(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function pM(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++){n[e]=t[e]}return n}}function vM(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){vM=function t(e){return ie(e)}}else{vM=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return vM(t)}function mM(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function _M(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function yM(t,e,n){if(e)_M(t.prototype,e);if(n)_M(t,n);return t}function bM(t,e){if(e&&(vM(e)==="object"||typeof e==="function")){return e}return wM(t)}function wM(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function xM(t){xM=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return xM(t)}function kM(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)SM(t,e)}function SM(t,e){SM=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return SM(t,e)}var CM=function(t){kM(e,t);function e(){var n;mM(this,e);n=bM(this,xM(e).call(this));n._align="middle";n._barConfig={stroke:"#000","stroke-width":1};n._domain=[0,10];n._duration=600;n._gridConfig={stroke:"#ccc","stroke-width":1};n._gridLog=false;n._height=400;n._labelOffset=true;n.orient("bottom");n._outerBounds={width:0,height:0,x:0,y:0};n._padding=5;n._paddingInner=.1;n._paddingOuter=.1;n._rotateLabels=false;n._scale="linear";n._scalePadding=.5;n._shape="Line";n._shapeConfig={fill:"#000",height:function t(e){return e.tick?8:0},label:function t(e){return e.text},labelBounds:function t(e){return e.labelBounds},labelConfig:{fontColor:"#000",fontFamily:(new pC).fontFamily(),fontResize:false,fontSize:Oc(10),padding:0,textAnchor:function t(){var e=jS();return n._orient==="left"?e?"start":"end":n._orient==="right"?e?"end":"start":n._rotateLabels?n._orient==="bottom"?"end":"start":"middle"},verticalAlign:function t(){return n._orient==="bottom"?"top":n._orient==="top"?"bottom":"middle"}},r:function t(e){return e.tick?4:0},stroke:"#000",strokeWidth:1,width:function t(e){return e.tick?8:0}};n._tickSize=5;n._tickSpecifier=undefined;n._tickSuffix="normal";n._tickUnit=0;n._timeLocale=undefined;n._titleClass=new pC;n._titleConfig={fontSize:12,textAnchor:"middle"};n._width=400;return n}yM(e,[{key:"_barPosition",value:function t(e){var n=this._position,i=n.height,a=n.x,r=n.y,o=n.opposite,s=this._getDomain(),l=this._margin[o],u=["top","left"].includes(this._orient)?this._outerBounds[r]+this._outerBounds[i]-l:this._outerBounds[r]+l;var h=this._scale==="band"?this._d3Scale.step()-this._d3Scale.bandwidth():this._scale==="point"?this._d3Scale.step()*this._d3Scale.padding():0;var c=this._scale==="band"?this._d3Scale.step():this._scale==="point"?this._d3Scale.step()*this._d3Scale.padding():0;e.call(_,this._barConfig).attr("".concat(a,"1"),this._getPosition(s[0])-h).attr("".concat(a,"2"),this._getPosition(s[s.length-1])+c).attr("".concat(r,"1"),u).attr("".concat(r,"2"),u)}},{key:"_getDomain",value:function t(){var e=[];if(this._d3ScaleNegative)e=this._d3ScaleNegative.domain();if(this._d3Scale)e=e.concat(this._d3Scale.domain());var n=["band","ordinal","point"].includes(this._scale)?e:tm(e);return e[0]>e[1]?n.reverse():n}},{key:"_getPosition",value:function t(e){return e<0&&this._d3ScaleNegative?this._d3ScaleNegative(e):this._d3Scale(e)}},{key:"_getRange",value:function t(){var e=[];if(this._d3ScaleNegative)e=this._d3ScaleNegative.range();if(this._d3Scale)e=e.concat(this._d3Scale.range());return e[0]>e[1]?tm(e).reverse():tm(e)}},{key:"_getTicks",value:function t(){var e=W_().domain([10,400]).range([10,50]);var n=[];if(this._d3ScaleNegative){var i=this._d3ScaleNegative.range();var a=i[1]-i[0];n=this._d3ScaleNegative.ticks(Math.floor(a/e(a)))}if(this._d3Scale){var r=this._d3Scale.range();var o=r[1]-r[0];n=n.concat(this._d3Scale.ticks(Math.floor(o/e(o))))}return n}},{key:"_gridPosition",value:function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=this._position,a=i.height,r=i.x,o=i.y,s=i.opposite,l=this._margin[s],u=["top","left"].includes(this._orient)?this._outerBounds[o]+this._outerBounds[a]-l:this._outerBounds[o]+l,h=n?this._lastScale||this._getPosition.bind(this):this._getPosition.bind(this),c=["top","left"].includes(this._orient)?l:-l,f=this._scale==="band"?this._d3Scale.bandwidth()/2:0,d=function t(e){return h(e.id)+f};e.call(_,this._gridConfig).attr("".concat(r,"1"),d).attr("".concat(r,"2"),d).attr("".concat(o,"1"),u).attr("".concat(o,"2"),n?u:u+c)}},{key:"render",value:function t(e){var d=this,n;if(this._select===void 0){this.select(Sd("body").append("svg").attr("width","".concat(this._width,"px")).attr("height","".concat(this._height,"px")).node())}var i=this._timeLocale||hM[this._locale]||hM["en-US"];Jb(i).format();var s=qb("%a %d"),l=qb("%I %p"),u=qb(".%L"),h=qb("%I:%M"),c=qb("%b"),f=qb(":%S"),g=qb("%b %d"),p=qb("%Y");var a=this._position,r=a.width,v=a.height,m=a.x,_=a.y,y=a.horizontal,b=a.opposite,o="d3plus-Axis-clip-".concat(this._uuid),w=["top","left"].includes(this._orient),x=this._padding,k=this._select,C=[x,this["_".concat(r)]-x],S=Lv().duration(this._duration);var A=this._shape==="Circle"?this._shapeConfig.r:this._shape==="Rect"?this._shapeConfig[r]:this._shapeConfig.strokeWidth;var E=typeof A!=="function"?function(){return A}:A;var M=this._margin={top:0,right:0,bottom:0,left:0};var R,T,B;var O=this._tickFormat?this._tickFormat:function(t){if(d._scale==="time"){return(ay(t)<t?u:ry(t)<t?f:oy(t)<t?h:sy(t)<t?l:vy(t)<t?uy(t)<t?s:g:my(t)<t?c:p)(t)}else if(["band","ordinal","point"].includes(d._scale)){return t}if(isNaN(t)){return t}else if(d._scale==="linear"&&d._tickSuffix==="smallest"){var e=vM(d._locale)==="object"?d._locale:cS[d._locale];var n=e.separator,i=e.suffixes;var a=t>=1e3?i[d._tickUnit+8]:"";var r=t/Math.pow(10,3*d._tickUnit);var o=vS(r,e,",.".concat(r.toString().length,"r"));return"".concat(o).concat(n).concat(a)}else{return vS(t,d._locale)}};function P(){var a=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._range;T=t?t.slice():[undefined,undefined];var e=C[0],n=C[1];if(this._range){if(this._range[0]!==undefined)e=this._range[0];if(this._range[this._range.length-1]!==undefined)n=this._range[this._range.length-1]}if(T[0]===undefined||T[0]<e)T[0]=e;if(T[1]===undefined||T[1]>n)T[1]=n;var i=n-e;if(this._scale==="ordinal"&&this._domain.length>T.length){if(t===this._range){var r=this._domain.length+1;T=em(r).map(function(t){return T[0]+i*(t/(r-1))}).slice(1,r);T=T.map(function(t){return t-T[0]/2})}else{var o=this._domain.length;var s=T[1]-T[0];T=em(o).map(function(t){return T[0]+s*(t/(o-1))})}}else if(t===this._range){var l=W_().domain([10,400]).range([10,50]);var u=this._scale==="time"?this._domain.map(uM):this._domain;var h=rm(u[0],u[1],Math.floor(i/l(i)));B=(this._ticks?this._scale==="time"?this._ticks.map(uM):this._ticks:h).slice();R=(this._labels?this._scale==="time"?this._labels.map(uM):this._labels:h).slice();var c=R.length;if(c){var f=Math.ceil(i/c/2);T=[T[0]+f,T[1]-f]}}var d="scale".concat(this._scale.charAt(0).toUpperCase()).concat(this._scale.slice(1));this._d3Scale=Sw[d]().domain(this._scale==="time"?this._domain.map(uM):this._domain).range(T);if(this._d3Scale.padding)this._d3Scale.padding(this._scalePadding);if(this._d3Scale.paddingInner)this._d3Scale.paddingInner(this._paddingInner);if(this._d3Scale.paddingOuter)this._d3Scale.paddingOuter(this._paddingOuter);this._d3ScaleNegative=null;if(this._scale==="log"){var g=this._d3Scale.domain();if(g[0]===0){g[0]=Math.abs(g[g.length-1])<=1?1e-6:1;if(g[g.length-1]<0)g[0]*=-1}else if(g[g.length-1]===0){g[g.length-1]=Math.abs(g[0])<=1?1e-6:1;if(g[0]<0)g[g.length-1]*=-1}var p=this._d3Scale.range();if(g[0]<0&&g[g.length-1]<0){this._d3ScaleNegative=this._d3Scale.copy().domain(g).range(p);this._d3Scale=null}else if(g[0]>0&&g[g.length-1]>0){this._d3Scale.domain(g).range(p)}else{var v=N_().domain([1,g[g[1]>0?1:0]]).range([0,1]);var m=v(Math.abs(g[g[1]<0?1:0]));var _=m/(m+1)*(p[1]-p[0]);if(g[0]>0)_=p[1]-p[0]-_;this._d3ScaleNegative=this._d3Scale.copy();(g[0]<0?this._d3Scale:this._d3ScaleNegative).domain([Math.sign(g[1]),g[1]]).range([p[0]+_,p[1]]);(g[0]<0?this._d3ScaleNegative:this._d3Scale).domain([g[0],Math.sign(g[0])]).range([p[0],p[0]+_])}}B=(this._ticks?this._scale==="time"?this._ticks.map(uM):this._ticks:(this._d3Scale?this._d3Scale.ticks:this._d3ScaleNegative.ticks)?this._getTicks():this._domain).slice();R=(this._labels?this._scale==="time"?this._labels.map(uM):this._labels:(this._d3Scale?this._d3Scale.ticks:this._d3ScaleNegative.ticks)?this._getTicks():B).slice();if(this._scale==="log"){var y=R.filter(function(t){return Math.abs(t).toString().charAt(0)==="1"&&(a._d3Scale?t!==-1:t!==1)});if(y.length>2){R=y;B=y}else if(R.length>=10){R=R.filter(function(t){return t%5===0||O(t).substr(-1)==="1"})}}if(this._scale==="time"){B=B.map(Number);R=R.map(Number)}B=B.sort(function(t,e){return a._getPosition(t)-a._getPosition(e)});R=R.sort(function(t,e){return a._getPosition(t)-a._getPosition(e)});if(this._scale==="linear"&&this._tickSuffix==="smallest"){var b=R.filter(function(t){return t>=1e3});if(b.length>0){var w=Math.min.apply(Math,fM(b));var x=1;while(x&&x<7){var k=Math.pow(10,3*x);if(w/k>=1){this._tickUnit=x;x+=1}else{break}}}}var S=[];this._availableTicks=B;B.forEach(function(t,e){var n=E({id:t,tick:true},e);if(a._shape==="Circle")n*=2;var i=a._getPosition(t);if(!S.length||Math.abs(Rc(i,S)-i)>n*2)S.push(i);else S.push(false)});B=B.filter(function(t,e){return S[e]!==false});this._visibleTicks=B}P.bind(this)();function D(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=t.i,i=t.position;if(this._scale==="band"){return this._d3Scale.bandwidth()}else{var a=n-e<0?U.length===1||!this._range?C[0]:(i-U[n+e].position)/2-i:i-(i-U[n-e].position)/2;var r=Math.abs(i-a);var o=n+e>U.length-1?U.length===1||!this._range?C[1]:(i-U[n-e].position)/2-i:i-(i-U[n+e].position)/2;var s=Math.abs(i-o);return fm([r,s])*2}}if(this._title){var N=this._titleConfig,z=N.fontFamily,F=N.fontSize,L=N.lineHeight;var j=aC().fontFamily(typeof z==="function"?z():z).fontSize(typeof F==="function"?F():F).lineHeight(typeof L==="function"?L():L).width(T[T.length-1]-T[0]-x*2).height(this["_".concat(v)]-this._tickSize-x*2);var I=j(this._title).lines.length;M[this._orient]=I*j.lineHeight()+x}var H=this._shape==="Circle"?typeof this._shapeConfig.r==="function"?this._shapeConfig.r({tick:true}):this._shapeConfig.r:this._shape==="Rect"?typeof this._shapeConfig[v]==="function"?this._shapeConfig[v]({tick:true}):this._shapeConfig[v]:this._tickSize,V=E({tick:true});if(typeof H==="function")H=um(B.map(H));if(this._shape==="Rect")H/=2;if(typeof V==="function")V=um(B.map(V));if(this._shape!=="Circle")V/=2;var U=R.map(function(t,e){var n=d._shapeConfig.labelConfig.fontFamily(t,e),i=d._shapeConfig.labelConfig.fontSize(t,e),a=d._getPosition(t);var r=d._shapeConfig.lineHeight?d._shapeConfig.lineHeight(t,e):i*1.4;return{d:t,i:e,fF:n,fS:i,lineHeight:r,position:a}});function G(t){var e=t.d,n=t.i,i=t.fF,a=t.fS,r=t.rotate,o=t.space;var s=r?"width":"height",l=r?"height":"width";var u=fm([this._maxSize,this._width]);var h=fm([this._maxSize,this._height]);var c=aC().fontFamily(i).fontSize(a).lineHeight(this._shapeConfig.lineHeight?this._shapeConfig.lineHeight(e,n):undefined)[l](y?o:u-H-x-this._margin.left-this._margin.right)[s](y?h-H-x-this._margin.top-this._margin.bottom:o);var f=c(O(e));f.lines=f.lines.filter(function(t){return t!==""});f.width=f.lines.length?Math.ceil(um(f.widths))+a/4:0;if(f.width%2)f.width++;f.height=f.lines.length?Math.ceil(f.lines.length*c.lineHeight())+a/4:0;if(f.height%2)f.height++;return f}U=U.map(function(t){t.rotate=d._labelRotation;t.space=D.bind(d)(t);var e=G.bind(d)(t);return Object.assign(e,t)});this._rotateLabels=y&&this._labelRotation===undefined?U.some(function(t){return t.truncated}):this._labelRotation;if(this._rotateLabels){U=U.map(function(t){t.rotate=true;var e=G.bind(d)(t);return Object.assign(t,e)})}var W=[0,0];for(var K=0;K<2;K++){var q=U[K?U.length-1:0];if(!q)break;var Y=q.height,X=q.position,Z=q.rotate,J=q.width;var $=K?C[1]:C[0];var Q=(Z||!y?Y:J)/2;var tt=K?X+Q-$:X-Q-$;W[K]=tt}var et=T[0];var nt=T[T.length-1];var it=[et-W[0],nt-W[1]];if(this._range){if(this._range[0]!==undefined)it[0]=this._range[0];if(this._range[this._range.length-1]!==undefined)it[1]=this._range[this._range.length-1]}if(it[0]!==et||it[1]!==nt){P.bind(this)(it);U=R.map(function(t,e){var n=d._shapeConfig.labelConfig.fontFamily(t,e),i=d._shapeConfig.labelConfig.fontSize(t,e),a=d._getPosition(t);var r=d._shapeConfig.lineHeight?d._shapeConfig.lineHeight(t,e):i*1.4;return{d:t,i:e,fF:n,fS:i,lineHeight:r,position:a}});U=U.map(function(t){t.rotate=d._rotateLabels;t.space=D.bind(d)(t);var e=G.bind(d)(t);return Object.assign(e,t)})}var at=um(U,function(t){return t.height})||0;this._rotateLabels=y&&this._labelRotation===undefined?U.some(function(t){var e=t.i,n=t.height,i=t.position,a=t.truncated;var r=U[e-1];return a||e&&r.position+r.height/2>i-n/2}):this._labelRotation;if(this._rotateLabels){var rt=0;U=U.map(function(t){t.space=D.bind(d)(t,2);var e=G.bind(d)(t);t=Object.assign(t,e);var n=U[t.i-1];if(!n){rt=1}else if(n.position+n.height/2>t.position){if(rt){t.offset=n.width;rt=0}else rt=1}return t})}var ot=this._labelOffset?um(U,function(t){return t.offset||0}):0;U.forEach(function(t){return t.offset=t.offset?ot:0});var st=this._shape==="Line"?0:H;var lt=this._outerBounds=(n={},cM(n,v,(um(U,function(t){return Math.ceil(t[t.rotate||!y?"width":"height"]+t.offset)})||0)+(U.length?x:0)),cM(n,r,C[C.length-1]-C[0]),cM(n,m,C[0]),n);lt[v]=um([this._minSize,lt[v]]);M[this._orient]+=H;M[b]=this._gridSize!==undefined?um([this._gridSize,st]):this["_".concat(v)]-M[this._orient]-lt[v]-x;lt[v]+=M[b]+M[this._orient];lt[_]=this._align==="start"?this._padding:this._align==="end"?this["_".concat(v)]-lt[v]-this._padding:this["_".concat(v)]/2-lt[v]/2;var ut=Wv("g#d3plus-Axis-".concat(this._uuid),{parent:k});this._group=ut;var ht=Wv("g.grid",{parent:ut}).selectAll("line").data((this._gridSize!==0?this._grid||this._scale==="log"&&!this._gridLog?R:B:[]).map(function(t){return{id:t}}),function(t){return t.id});ht.exit().transition(S).attr("opacity",0).call(this._gridPosition.bind(this)).remove();ht.enter().append("line").attr("opacity",0).attr("clip-path","url(#".concat(o,")")).call(this._gridPosition.bind(this),true).merge(ht).transition(S).attr("opacity",1).call(this._gridPosition.bind(this));var ct=R.filter(function(t,e){return U[e].lines.length&&!B.includes(t)});var ft=U.some(function(t){return t.rotate});var dt=B.concat(ct).map(function(e){var t;var n=U.find(function(t){return t.d===e});var i=d._getPosition(e);var a=n?n.space:0;var r=n?n.lines.length:1;var o=n?n.lineHeight:1;var s=n&&d._labelOffset?n.offset:0;var l=y?a:lt.width-M[d._position.opposite]-H-M[d._orient]+x;var u=M[b],h=(H+s)*(w?-1:1),c=w?lt[_]+lt[v]-u:lt[_]+u;var f=(t={id:e,labelBounds:ft&&n?{x:-n.width/2+n.fS/4,y:d._orient==="bottom"?h+x+(n.width-o*r)/2:h-x*2-(n.width+o*r)/2,width:n.width,height:n.height}:{x:y?-a/2:d._orient==="left"?-l-x+h:h+x,y:y?d._orient==="bottom"?h+x:h-x-at:-a/2,width:y?a:l,height:y?at:a},rotate:n?n.rotate:false,size:R.includes(e)?h:0,text:R.includes(e)?O(e):false,tick:B.includes(e)},cM(t,m,i+(d._scale==="band"?d._d3Scale.bandwidth()/2:0)),cM(t,_,c),t);return f});if(this._shape==="Line"){dt=dt.concat(dt.map(function(t){var e=Object.assign({},t);e[_]+=t.size;return e}))}(new lM[this._shape]).data(dt).duration(this._duration).labelConfig({ellipsis:function t(e){return e&&e.length?"".concat(e,"..."):""},rotate:function t(e){return e.rotate?-90:0}}).select(Wv("g.ticks",{parent:ut}).node()).config(this._shapeConfig).render();var gt=ut.selectAll("line.bar").data([null]);gt.enter().append("line").attr("class","bar").attr("opacity",0).call(this._barPosition.bind(this)).merge(gt).transition(S).attr("opacity",1).call(this._barPosition.bind(this));this._titleClass.data(this._title?[{text:this._title}]:[]).duration(this._duration).height(M[this._orient]).rotate(this._orient==="left"?-90:this._orient==="right"?90:0).select(Wv("g.d3plus-Axis-title",{parent:ut}).node()).text(function(t){return t.text}).verticalAlign("middle").width(T[T.length-1]-T[0]).x(y?T[0]:this._orient==="left"?lt.x+M.left/2-(T[T.length-1]-T[0])/2:lt.x+lt.width-M.right/2-(T[T.length-1]-T[0])/2).y(y?this._orient==="bottom"?lt.y+lt.height-M.bottom:lt.y:T[0]+(T[T.length-1]-T[0])/2-M[this._orient]/2).config(this._titleConfig).render();this._lastScale=this._getPosition.bind(this);if(e)setTimeout(e,this._duration+100);return this}},{key:"align",value:function t(e){return arguments.length?(this._align=e,this):this._align}},{key:"barConfig",value:function t(e){return arguments.length?(this._barConfig=Object.assign(this._barConfig,e),this):this._barConfig}},{key:"domain",value:function t(e){return arguments.length?(this._domain=e,this):this._domain}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"grid",value:function t(e){return arguments.length?(this._grid=e,this):this._grid}},{key:"gridConfig",value:function t(e){return arguments.length?(this._gridConfig=Object.assign(this._gridConfig,e),this):this._gridConfig}},{key:"gridLog",value:function t(e){return arguments.length?(this._gridLog=e,this):this._gridLog}},{key:"gridSize",value:function t(e){return arguments.length?(this._gridSize=e,this):this._gridSize}},{key:"height",value:function t(e){return arguments.length?(this._height=e,this):this._height}},{key:"labels",value:function t(e){return arguments.length?(this._labels=e,this):this._labels}},{key:"labelOffset",value:function t(e){return arguments.length?(this._labelOffset=e,this):this._labelOffset}},{key:"labelRotation",value:function t(e){return arguments.length?(this._labelRotation=e,this):this._labelRotation}},{key:"maxSize",value:function t(e){return arguments.length?(this._maxSize=e,this):this._maxSize}},{key:"minSize",value:function t(e){return arguments.length?(this._minSize=e,this):this._minSize}},{key:"orient",value:function t(e){if(arguments.length){var n=["top","bottom"].includes(e),i={top:"bottom",right:"left",bottom:"top",left:"right"};this._position={horizontal:n,width:n?"width":"height",height:n?"height":"width",x:n?"x":"y",y:n?"y":"x",opposite:i[e]};return this._orient=e,this}return this._orient}},{key:"outerBounds",value:function t(){return this._outerBounds}},{key:"padding",value:function t(e){return arguments.length?(this._padding=e,this):this._padding}},{key:"paddingInner",value:function t(e){return arguments.length?(this._paddingInner=e,this):this._paddingInner}},{key:"paddingOuter",value:function t(e){return arguments.length?(this._paddingOuter=e,this):this._paddingOuter}},{key:"range",value:function t(e){return arguments.length?(this._range=e,this):this._range}},{key:"scale",value:function t(e){return arguments.length?(this._scale=e,this):this._scale}},{key:"scalePadding",value:function t(e){return arguments.length?(this._scalePadding=e,this):this._scalePadding}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"shape",value:function t(e){return arguments.length?(this._shape=e,this):this._shape}},{key:"shapeConfig",value:function t(e){return arguments.length?(this._shapeConfig=gt(this._shapeConfig,e),this):this._shapeConfig}},{key:"tickFormat",value:function t(e){return arguments.length?(this._tickFormat=e,this):this._tickFormat}},{key:"ticks",value:function t(e){return arguments.length?(this._ticks=e,this):this._ticks}},{key:"tickSize",value:function t(e){return arguments.length?(this._tickSize=e,this):this._tickSize}},{key:"tickSpecifier",value:function t(e){return arguments.length?(this._tickSpecifier=e,this):this._tickSpecifier}},{key:"tickSuffix",value:function t(e){return arguments.length?(this._tickSuffix=e,this):this._tickSuffix}},{key:"timeLocale",value:function t(e){return arguments.length?(this._timeLocale=e,this):this._timeLocale}},{key:"title",value:function t(e){return arguments.length?(this._title=e,this):this._title}},{key:"titleConfig",value:function t(e){return arguments.length?(this._titleConfig=Object.assign(this._titleConfig,e),this):this._titleConfig}},{key:"width",value:function t(e){return arguments.length?(this._width=e,this):this._width}}]);return e}(Mc);function AM(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){AM=function t(e){return ie(e)}}else{AM=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return AM(t)}function EM(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function MM(t,e){if(e&&(AM(e)==="object"||typeof e==="function")){return e}return RM(t)}function RM(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function TM(t){TM=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return TM(t)}function BM(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)OM(t,e)}function OM(t,e){OM=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return OM(t,e)}var PM=function(t){BM(e,t);function e(){var t;EM(this,e);t=MM(this,TM(e).call(this));t.orient("bottom");return t}return e}(CM);function DM(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){DM=function t(e){return ie(e)}}else{DM=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return DM(t)}function NM(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function zM(t,e){if(e&&(DM(e)==="object"||typeof e==="function")){return e}return FM(t)}function FM(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function LM(t){LM=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return LM(t)}function jM(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)IM(t,e)}function IM(t,e){IM=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return IM(t,e)}var HM=function(t){jM(e,t);function e(){var t;NM(this,e);t=zM(this,LM(e).call(this));t.orient("left");return t}return e}(CM);function VM(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){VM=function t(e){return ie(e)}}else{VM=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return VM(t)}function UM(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function GM(t,e){if(e&&(VM(e)==="object"||typeof e==="function")){return e}return WM(t)}function WM(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function KM(t){KM=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return KM(t)}function qM(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)YM(t,e)}function YM(t,e){YM=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return YM(t,e)}var XM=function(t){qM(e,t);function e(){var t;UM(this,e);t=GM(this,KM(e).call(this));t.orient("right");return t}return e}(CM);function ZM(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){ZM=function t(e){return ie(e)}}else{ZM=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return ZM(t)}function JM(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function $M(t,e){if(e&&(ZM(e)==="object"||typeof e==="function")){return e}return QM(t)}function QM(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function tR(t){tR=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return tR(t)}function eR(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)nR(t,e)}function nR(t,e){nR=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return nR(t,e)}var iR=function(t){eR(e,t);function e(){var t;JM(this,e);t=$M(this,tR(e).call(this));t.orient("top");return t}return e}(CM);var aR=function(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"data";return t.reduce(function(t,e){var n=[];if(Array.isArray(e)){n=e}else{if(e[i]){n=e[i]}else{console.warn('d3plus-viz: Please implement a "dataFormat" callback to concat the arrays manually (consider using the d3plus.dataConcat method in your callback). Currently unable to concatenate (using key: "'.concat(i,'") the following response:'),e)}}return t.concat(n)},[])};var rR=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"data";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"headers";return t[e].map(function(i){return t[n].reduce(function(t,e,n){return t[e]=i[n],t},{})})};function oR(a,t){var r,o=Bd("beforesend","progress","load","error"),s,l=vm(),u=new XMLHttpRequest,h=null,c=null,i,f,d=0;if(typeof XDomainRequest!=="undefined"&&!("withCredentials"in u)&&/^(http(s)?:)?\/\//.test(a))u=new XDomainRequest;"onload"in u?u.onload=u.onerror=u.ontimeout=e:u.onreadystatechange=function(t){u.readyState>3&&e(t)};function e(t){var e=u.status,n;if(!e&&lR(u)||e>=200&&e<300||e===304){if(i){try{n=i.call(r,u)}catch(t){o.call("error",r,t);return}}else{n=u}o.call("load",r,n)}else{o.call("error",r,t)}}u.onprogress=function(t){o.call("progress",r,t)};r={header:function t(e,n){e=(e+"").toLowerCase();if(arguments.length<2)return l.get(e);if(n==null)l.remove(e);else l.set(e,n+"");return r},mimeType:function t(e){if(!arguments.length)return s;s=e==null?null:e+"";return r},responseType:function t(e){if(!arguments.length)return f;f=e;return r},timeout:function t(e){if(!arguments.length)return d;d=+e;return r},user:function t(e){return arguments.length<1?h:(h=e==null?null:e+"",r)},password:function t(e){return arguments.length<1?c:(c=e==null?null:e+"",r)},response:function t(e){i=e;return r},get:function t(e,n){return r.send("GET",e,n)},post:function t(e,n){return r.send("POST",e,n)},send:function t(e,n,i){u.open(e,a,true,h,c);if(s!=null&&!l.has("accept"))l.set("accept",s+",*/*");if(u.setRequestHeader)l.each(function(t,e){u.setRequestHeader(e,t)});if(s!=null&&u.overrideMimeType)u.overrideMimeType(s);if(f!=null)u.responseType=f;if(d>0)u.timeout=d;if(i==null&&typeof n==="function")i=n,n=null;if(i!=null&&i.length===1)i=sR(i);if(i!=null)r.on("error",i).on("load",function(t){i(null,t)});o.call("beforesend",r,u);u.send(n==null?null:n);return r},abort:function t(){u.abort();return r},on:function t(){var e=o.on.apply(o,arguments);return e===o?r:e}};if(t!=null){if(typeof t!=="function")throw new Error("invalid callback: "+t);return r.get(t)}return r}function sR(n){return function(t,e){n(t==null?e:null)}}function lR(t){var e=t.responseType;return e&&e!=="text"?t.response:t.responseText}function uR(i,a){return function(t,e){var n=oR(t).mimeType(i).response(a);if(e!=null){if(typeof e!=="function")throw new Error("invalid callback: "+e);return n.get(e)}return n}}var hR=uR("application/json",function(t){return JSON.parse(t.responseText)});var cR=uR("text/plain",function(t){return t.responseText});var fR={},dR={},gR=34,pR=10,vR=13;function mR(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function _R(n,i){var a=mR(n);return function(t,e){return i(a(t),e,n)}}function yR(t){var n=Object.create(null),i=[];t.forEach(function(t){for(var e in t){if(!(e in n)){i.push(n[e]=e)}}});return i}function bR(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function wR(t){return t<0?"-"+bR(-t,6):t>9999?"+"+bR(t,6):bR(t,4)}function xR(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":wR(t.getUTCFullYear())+"-"+bR(t.getUTCMonth()+1,2)+"-"+bR(t.getUTCDate(),2)+(a?"T"+bR(e,2)+":"+bR(n,2)+":"+bR(i,2)+"."+bR(a,3)+"Z":i?"T"+bR(e,2)+":"+bR(n,2)+":"+bR(i,2)+"Z":n||e?"T"+bR(e,2)+":"+bR(n,2)+"Z":"")}function kR(i){var e=new RegExp('["'+i+"\n\r]"),c=i.charCodeAt(0);function t(t,n){var i,a,e=r(t,function(t,e){if(i)return i(t,e-1);a=t,i=n?_R(t,n):mR(t)});e.columns=a||[];return e}function r(i,t){var e=[],a=i.length,r=0,n=0,o,s=a<=0,l=false;if(i.charCodeAt(a-1)===pR)--a;if(i.charCodeAt(a-1)===vR)--a;function u(){if(s)return dR;if(l)return l=false,fR;var t,e=r,n;if(i.charCodeAt(e)===gR){while(r++<a&&i.charCodeAt(r)!==gR||i.charCodeAt(++r)===gR){}if((t=r)>=a)s=true;else if((n=i.charCodeAt(r++))===pR)l=true;else if(n===vR){l=true;if(i.charCodeAt(r)===pR)++r}return i.slice(e+1,t-1).replace(/""/g,'"')}while(r<a){if((n=i.charCodeAt(t=r++))===pR)l=true;else if(n===vR){l=true;if(i.charCodeAt(r)===pR)++r}else if(n!==c)continue;return i.slice(e,t)}return s=true,i.slice(e,a)}while((o=u())!==dR){var h=[];while(o!==fR&&o!==dR){h.push(o),o=u()}if(t&&(h=t(h,n++))==null)continue;e.push(h)}return e}function n(t,n){return t.map(function(e){return n.map(function(t){return u(e[t])}).join(i)})}function a(t,e){if(e==null)e=yR(t);return[e.map(u).join(i)].concat(n(t,e)).join("\n")}function o(t,e){if(e==null)e=yR(t);return n(t,e).join("\n")}function s(t){return t.map(l).join("\n")}function l(t){return t.map(u).join(i)}function u(t){return t==null?"":t instanceof Date?xR(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:t,parseRows:r,format:a,formatBody:o,formatRows:s,formatRow:l,formatValue:u}}var SR=kR(",");var CR=SR.parse;var AR=kR("\t");var ER=AR.parse;function MR(a,r){return function(t,e,n){if(arguments.length<3)n=e,e=null;var i=oR(t).mimeType(a);i.row=function(t){return arguments.length?i.response(RR(r,e=t)):e};i.row(e);return n?i.get(n):i}}function RR(e,n){return function(t){return e(t.responseText,n)}}var TR=MR("text/csv",CR);var BR=MR("text/tab-separated-values",ER);function OR(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){OR=function t(e){return ie(e)}}else{OR=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return OR(t)}function PR(r,o,s,l){var u=this;var h;var c=function t(e){var n=e.slice(e.length-4);switch(n){case".csv":return TR;case".tsv":return BR;case".txt":return cR;default:return hR}};var f=function t(e,n,i){if(n!==hR&&!e&&i&&i instanceof Array){i.forEach(function(t){for(var e in t){if(!isNaN(t[e]))t[e]=parseFloat(t[e]);else if(t[e].toLowerCase()==="false")t[e]=false;else if(t[e].toLowerCase()==="true")t[e]=true;else if(t[e].toLowerCase()==="null")t[e]=null;else if(t[e].toLowerCase()==="undefined")t[e]=undefined}})}return i};var d=function t(e){return e.reduce(function(t,e){return e?t+1:t},0)};var g=function t(e,n){return n.indexOf(e)};if(!(r instanceof Array))r=[r];var n=function t(e){return typeof e==="string"||OR(e)==="object"&&e.url&&e.headers};var t=r.find(n);var p=new Array(r.length);var v=[];if(t){r.forEach(function(t,e){if(n(t))v.push(t);else p[e]=t})}else{p[0]=r}var m=d(p);v.forEach(function(t){var e={},n=t;if(OR(t)==="object"){n=t.url;e=t.headers}h=c(n);var i=h(n);for(var a in e){if({}.hasOwnProperty.call(e,a)){i.header(a,e[a])}}i.get(function(t,e){e=t?[]:e;if(e&&!(e instanceof Array)&&e.data&&e.headers)e=rR(e);e=f(t,h,e);p[g(n,r)]=e;if(d(p)-m===v.length){e=d(p)===1?p[0]:p;if(o){e=o(d(p)===1?p[0]:p)}else if(s==="data"){e=aR(p,"data")}if(s&&"_".concat(s)in u)u["_".concat(s)]=e;if(u._cache)u._lrucache.set(n,e);if(l)l(t,e)}})});if(v.length===0){p=p.map(function(t){if(t&&!(t instanceof Array)&&t.data&&t.headers)t=rR(t);return t});var e=d(p)===1?p[0]:p;if(o){e=o(d(p)===1?p[0]:p)}else if(s==="data"){e=aR(p,"data")}if(s&&"_".concat(s)in this)this["_".concat(s)]=e;if(this._cache)this._lrucache.set(s,e);if(l)l(null,e)}}function DR(){ld.preventDefault();ld.stopImmediatePropagation()}function NR(t){var e=t.document.documentElement,n=Sd(t).on("dragstart.drag",DR,true);if("onselectstart"in e){n.on("selectstart.drag",DR,true)}else{e.__noselect=e.style.MozUserSelect;e.style.MozUserSelect="none"}}function zR(t,e){var n=t.document.documentElement,i=Sd(t).on("dragstart.drag",null);if(e){i.on("click.drag",DR,true);setTimeout(function(){i.on("click.drag",null)},0)}if("onselectstart"in n){i.on("selectstart.drag",null)}else{n.style.MozUserSelect=n.__noselect;delete n.__noselect}}function FR(t){return function(){return t}}function LR(t,e,n){this.target=t;this.type=e;this.selection=n}function jR(){ld.stopImmediatePropagation()}function IR(){ld.preventDefault();ld.stopImmediatePropagation()}var HR={name:"drag"},VR={name:"space"},UR={name:"handle"},GR={name:"center"};function WR(t){return[+t[0],+t[1]]}function KR(t){return[WR(t[0]),WR(t[1])]}function qR(e){return function(t){return Rd(t,ld.touches,e)}}var YR={name:"x",handles:["w","e"].map(nT),input:function t(e,n){return e==null?null:[[+e[0],n[0][1]],[+e[1],n[1][1]]]},output:function t(e){return e&&[e[0][0],e[1][0]]}};var XR={name:"y",handles:["n","s"].map(nT),input:function t(e,n){return e==null?null:[[n[0][0],+e[0]],[n[1][0],+e[1]]]},output:function t(e){return e&&[e[0][1],e[1][1]]}};var ZR={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(nT),input:function t(e){return e==null?null:KR(e)},output:function t(e){return e}};var JR={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var $R={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"};var QR={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"};var tT={overlay:+1,selection:+1,n:null,e:+1,s:null,w:-1,nw:-1,ne:+1,se:+1,sw:-1};var eT={overlay:+1,selection:+1,n:-1,e:null,s:+1,w:null,nw:-1,ne:-1,se:+1,sw:+1};function nT(t){return{type:t}}function iT(){return!ld.ctrlKey&&!ld.button}function aT(){var t=this.ownerSVGElement||this;if(t.hasAttribute("viewBox")){t=t.viewBox.baseVal;return[[t.x,t.y],[t.x+t.width,t.y+t.height]]}return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function rT(){return navigator.maxTouchPoints||"ontouchstart"in this}function oT(t){while(!t.__brush){if(!(t=t.parentNode))return}return t.__brush}function sT(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function lT(){return hT(YR)}function uT(){return hT(ZR)}function hT(L){var e=aT,j=iT,i=rT,I=true,n=Bd("start","brush","end"),a=6,H;function r(t){var e=t.property("__brush",h).selectAll(".overlay").data([nT("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",JR.overlay).merge(e).each(function(){var t=oT(this).extent;Sd(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])});t.selectAll(".selection").data([nT("selection")]).enter().append("rect").attr("class","selection").attr("cursor",JR.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var n=t.selectAll(".handle").data(L.handles,function(t){return t.type});n.exit().remove();n.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return JR[t.type]});t.each(V).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",s).filter(i).on("touchstart.brush",s).on("touchmove.brush",l).on("touchend.brush touchcancel.brush",u).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}r.move=function(t,s){if(t.selection){t.on("start.brush",function(){U(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){U(this,arguments).end()}).tween("brush",function(){var e=this,n=e.__brush,i=U(e,arguments),t=n.selection,a=L.input(typeof s==="function"?s.apply(this,arguments):s,n.extent),r=pp(t,a);function o(t){n.selection=t===1&&a===null?null:r(t);V.call(e);i.brush()}return t!==null&&a!==null?o:o(1)})}else{t.each(function(){var t=this,e=arguments,n=t.__brush,i=L.input(typeof s==="function"?s.apply(t,e):s,n.extent),a=U(t,e).beforestart();mg(t);n.selection=i===null?null:i;V.call(t);a.start().brush().end()})}};r.clear=function(t){r.move(t,null)};function V(){var t=Sd(this),e=oT(this).selection;if(e){t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]);t.selectAll(".handle").style("display",null).attr("x",function(t){return t.type[t.type.length-1]==="e"?e[1][0]-a/2:e[0][0]-a/2}).attr("y",function(t){return t.type[0]==="s"?e[1][1]-a/2:e[0][1]-a/2}).attr("width",function(t){return t.type==="n"||t.type==="s"?e[1][0]-e[0][0]+a:a}).attr("height",function(t){return t.type==="e"||t.type==="w"?e[1][1]-e[0][1]+a:a})}else{t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}}function U(t,e,n){return!n&&t.__brush.emitter||new o(t,e)}function o(t,e){this.that=t;this.args=e;this.state=t.__brush;this.active=0}o.prototype={beforestart:function t(){if(++this.active===1)this.state.emitter=this,this.starting=true;return this},start:function t(){if(this.starting)this.starting=false,this.emit("start");else this.emit("brush");return this},brush:function t(){this.emit("brush");return this},end:function t(){if(--this.active===0)delete this.state.emitter,this.emit("end");return this},emit:function t(e){vd(new LR(r,e,L.output(this.state.selection)),n.apply,n,[e,this.that,this.args])}};function s(){if(H&&!ld.touches)return;if(!j.apply(this,arguments))return;var e=this,n=ld.target.__data__.type,i=(I&&ld.metaKey?n="overlay":n)==="selection"?HR:I&&ld.altKey?GR:UR,a=L===XR?null:tT[n],r=L===YR?null:eT[n],o=oT(e),t=o.extent,s=o.selection,l=t[0][0],u,h,c=t[0][1],f,d,g=t[1][0],p,v,m=t[1][1],_,y,b=0,w=0,x,k=a&&r&&I&&ld.shiftKey,S,C,A=ld.touches?qR(ld.changedTouches[0].identifier):Ed,E=A(e),M=E,R=U(e,arguments,true).beforestart();if(n==="overlay"){if(s)x=true;o.selection=s=[[u=L===XR?l:E[0],f=L===YR?c:E[1]],[p=L===XR?g:u,_=L===YR?m:f]]}else{u=s[0][0];f=s[0][1];p=s[1][0];_=s[1][1]}h=u;d=f;v=p;y=_;var T=Sd(e).attr("pointer-events","none");var B=T.selectAll(".overlay").attr("cursor",JR[n]);if(ld.touches){R.moved=P;R.ended=N}else{var O=Sd(ld.view).on("mousemove.brush",P,true).on("mouseup.brush",N,true);if(I)O.on("keydown.brush",z,true).on("keyup.brush",F,true);NR(ld.view)}jR();mg(e);V.call(e);R.start();function P(){var t=A(e);if(k&&!S&&!C){if(Math.abs(t[0]-M[0])>Math.abs(t[1]-M[1]))C=true;else S=true}M=t;x=true;IR();D()}function D(){var t;b=M[0]-E[0];w=M[1]-E[1];switch(i){case VR:case HR:{if(a)b=Math.max(l-u,Math.min(g-p,b)),h=u+b,v=p+b;if(r)w=Math.max(c-f,Math.min(m-_,w)),d=f+w,y=_+w;break}case UR:{if(a<0)b=Math.max(l-u,Math.min(g-u,b)),h=u+b,v=p;else if(a>0)b=Math.max(l-p,Math.min(g-p,b)),h=u,v=p+b;if(r<0)w=Math.max(c-f,Math.min(m-f,w)),d=f+w,y=_;else if(r>0)w=Math.max(c-_,Math.min(m-_,w)),d=f,y=_+w;break}case GR:{if(a)h=Math.max(l,Math.min(g,u-b*a)),v=Math.max(l,Math.min(g,p+b*a));if(r)d=Math.max(c,Math.min(m,f-w*r)),y=Math.max(c,Math.min(m,_+w*r));break}}if(v<h){a*=-1;t=u,u=p,p=t;t=h,h=v,v=t;if(n in $R)B.attr("cursor",JR[n=$R[n]])}if(y<d){r*=-1;t=f,f=_,_=t;t=d,d=y,y=t;if(n in QR)B.attr("cursor",JR[n=QR[n]])}if(o.selection)s=o.selection;if(S)h=s[0][0],v=s[1][0];if(C)d=s[0][1],y=s[1][1];if(s[0][0]!==h||s[0][1]!==d||s[1][0]!==v||s[1][1]!==y){o.selection=[[h,d],[v,y]];V.call(e);R.brush()}}function N(){jR();if(ld.touches){if(ld.touches.length)return;if(H)clearTimeout(H);H=setTimeout(function(){H=null},500)}else{zR(ld.view,x);O.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null)}T.attr("pointer-events","all");B.attr("cursor",JR.overlay);if(o.selection)s=o.selection;if(sT(s))o.selection=null,V.call(e);R.end()}function z(){switch(ld.keyCode){case 16:{k=a&&r;break}case 18:{if(i===UR){if(a)p=v-b*a,u=h+b*a;if(r)_=y-w*r,f=d+w*r;i=GR;D()}break}case 32:{if(i===UR||i===GR){if(a<0)p=v-b;else if(a>0)u=h-b;if(r<0)_=y-w;else if(r>0)f=d-w;i=VR;B.attr("cursor",JR.selection);D()}break}default:return}IR()}function F(){switch(ld.keyCode){case 16:{if(k){S=C=k=false;D()}break}case 18:{if(i===GR){if(a<0)p=v;else if(a>0)u=h;if(r<0)_=y;else if(r>0)f=d;i=UR;D()}break}case 32:{if(i===VR){if(ld.altKey){if(a)p=v-b*a,u=h+b*a;if(r)_=y-w*r,f=d+w*r;i=GR}else{if(a<0)p=v;else if(a>0)u=h;if(r<0)_=y;else if(r>0)f=d;i=UR}B.attr("cursor",JR[n]);D()}break}default:return}IR()}}function l(){U(this,arguments).moved()}function u(){U(this,arguments).ended()}function h(){var t=this.__brush||{selection:null};t.extent=KR(e.apply(this,arguments));t.dim=L;return t}r.extent=function(t){return arguments.length?(e=typeof t==="function"?t:FR(KR(t)),r):e};r.filter=function(t){return arguments.length?(j=typeof t==="function"?t:FR(!!t),r):j};r.touchable=function(t){return arguments.length?(i=typeof t==="function"?t:FR(!!t),r):i};r.handleSize=function(t){return arguments.length?(a=+t,r):a};r.keyModifiers=function(t){return arguments.length?(I=!!t,r):I};r.on=function(){var t=n.on.apply(n,arguments);return t===n?r:t};return r}var cT=[].slice;var fT={};function dT(t){this._size=t;this._call=this._error=null;this._tasks=[];this._data=[];this._waiting=this._active=this._ended=this._start=0}dT.prototype=yT.prototype={constructor:dT,defer:function t(e){if(typeof e!=="function")throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(this._error!=null)return this;var n=cT.call(arguments,1);n.push(e);++this._waiting,this._tasks.push(n);gT(this);return this},abort:function t(){if(this._error==null)mT(this,new Error("abort"));return this},await:function t(n){if(typeof n!=="function")throw new Error("invalid callback");if(this._call)throw new Error("multiple await");this._call=function(t,e){n.apply(null,[t].concat(e))};_T(this);return this},awaitAll:function t(e){if(typeof e!=="function")throw new Error("invalid callback");if(this._call)throw new Error("multiple await");this._call=e;_T(this);return this}};function gT(e){if(!e._start){try{pT(e)}catch(t){if(e._tasks[e._ended+e._active-1])mT(e,t);else if(!e._data)throw t}}}function pT(t){while(t._start=t._waiting&&t._active<t._size){var e=t._ended+t._active,n=t._tasks[e],i=n.length-1,a=n[i];n[i]=vT(t,e);--t._waiting,++t._active;n=a.apply(null,n);if(!t._tasks[e])continue;t._tasks[e]=n||fT}}function vT(n,i){return function(t,e){if(!n._tasks[i])return;--n._active,++n._ended;n._tasks[i]=null;if(n._error!=null)return;if(t!=null){mT(n,t)}else{n._data[i]=e;if(n._waiting)gT(n);else _T(n)}}}function mT(t,e){var n=t._tasks.length,i;t._error=e;t._data=undefined;t._waiting=NaN;while(--n>=0){if(i=t._tasks[n]){t._tasks[n]=null;if(i.abort){try{i.abort()}catch(e){}}}}t._active=NaN;_T(t)}function _T(t){if(!t._active&&t._call){var e=t._data;t._data=undefined;t._call(t._error,e)}}function yT(t){if(t==null)t=Infinity;else if(!((t=+t)>=1))throw new Error("invalid concurrency");return new dT(t)}function bT(t){return function(){return t}}function wT(t,e,n){this.target=t;this.type=e;this.transform=n}function xT(t,e,n){this.k=t;this.x=e;this.y=n}xT.prototype={constructor:xT,scale:function t(e){return e===1?this:new xT(this.k*e,this.x,this.y)},translate:function t(e,n){return e===0&n===0?this:new xT(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function t(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function t(e){return e*this.k+this.x},applyY:function t(e){return e*this.k+this.y},invert:function t(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function t(e){return(e-this.x)/this.k},invertY:function t(e){return(e-this.y)/this.k},rescaleX:function t(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function t(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function t(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var kT=new xT(1,0,0);ST.prototype=xT.prototype;function ST(t){while(!t.__zoom){if(!(t=t.parentNode))return kT}return t.__zoom}function CT(){ld.stopImmediatePropagation()}function AT(){ld.preventDefault();ld.stopImmediatePropagation()}function ET(){return!ld.ctrlKey&&!ld.button}function MT(){var t=this;if(t instanceof SVGElement){t=t.ownerSVGElement||t;if(t.hasAttribute("viewBox")){t=t.viewBox.baseVal;return[[t.x,t.y],[t.x+t.width,t.y+t.height]]}return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}return[[0,0],[t.clientWidth,t.clientHeight]]}function RT(){return this.__zoom||kT}function TT(){return-ld.deltaY*(ld.deltaMode===1?.05:ld.deltaMode?1:.002)}function BT(){return navigator.maxTouchPoints||"ontouchstart"in this}function OT(t,e,n){var i=t.invertX(e[0][0])-n[0][0],a=t.invertX(e[1][0])-n[1][0],r=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a),o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o))}function PT(){var s=ET,c=MT,d=OT,r=TT,e=BT,o=[0,Infinity],g=[[-Infinity,-Infinity],[Infinity,Infinity]],l=250,f=zp,n=Bd("start","zoom","end"),p,u,h=500,v=150,m=0;function _(t){t.property("__zoom",RT).on("wheel.zoom",a).on("mousedown.zoom",S).on("dblclick.zoom",C).filter(e).on("touchstart.zoom",A).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(t,e,n){var i=t.selection?t.selection():t;i.property("__zoom",RT);if(t!==i){x(t,e,n)}else{i.interrupt().each(function(){k(this,arguments).start().zoom(null,typeof e==="function"?e.apply(this,arguments):e).end()})}};_.scaleBy=function(t,n,e){_.scaleTo(t,function(){var t=this.__zoom.k,e=typeof n==="function"?n.apply(this,arguments):n;return t*e},e)};_.scaleTo=function(t,r,o){_.transform(t,function(){var t=c.apply(this,arguments),e=this.__zoom,n=o==null?w(t):typeof o==="function"?o.apply(this,arguments):o,i=e.invert(n),a=typeof r==="function"?r.apply(this,arguments):r;return d(b(y(e,a),n,i),t,g)},o)};_.translateBy=function(t,e,n){_.transform(t,function(){return d(this.__zoom.translate(typeof e==="function"?e.apply(this,arguments):e,typeof n==="function"?n.apply(this,arguments):n),c.apply(this,arguments),g)})};_.translateTo=function(t,i,a,r){_.transform(t,function(){var t=c.apply(this,arguments),e=this.__zoom,n=r==null?w(t):typeof r==="function"?r.apply(this,arguments):r;return d(kT.translate(n[0],n[1]).scale(e.k).translate(typeof i==="function"?-i.apply(this,arguments):-i,typeof a==="function"?-a.apply(this,arguments):-a),t,g)},r)};function y(t,e){e=Math.max(o[0],Math.min(o[1],e));return e===t.k?t:new xT(e,t.x,t.y)}function b(t,e,n){var i=e[0]-n[0]*t.k,a=e[1]-n[1]*t.k;return i===t.x&&a===t.y?t:new xT(t.k,i,a)}function w(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function x(t,u,h){t.on("start.zoom",function(){k(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).end()}).tween("zoom",function(){var t=this,e=arguments,i=k(t,e),n=c.apply(t,e),a=h==null?w(n):typeof h==="function"?h.apply(t,e):h,r=Math.max(n[1][0]-n[0][0],n[1][1]-n[0][1]),o=t.__zoom,s=typeof u==="function"?u.apply(t,e):u,l=f(o.invert(a).concat(r/o.k),s.invert(a).concat(r/s.k));return function(t){if(t===1)t=s;else{var e=l(t),n=r/e[2];t=new xT(n,a[0]-e[0]*n,a[1]-e[1]*n)}i.zoom(null,t)}})}function k(t,e,n){return!n&&t.__zooming||new i(t,e)}function i(t,e){this.that=t;this.args=e;this.active=0;this.extent=c.apply(t,e);this.taps=0}i.prototype={start:function t(){if(++this.active===1){this.that.__zooming=this;this.emit("start")}return this},zoom:function t(e,n){if(this.mouse&&e!=="mouse")this.mouse[1]=n.invert(this.mouse[0]);if(this.touch0&&e!=="touch")this.touch0[1]=n.invert(this.touch0[0]);if(this.touch1&&e!=="touch")this.touch1[1]=n.invert(this.touch1[0]);this.that.__zoom=n;this.emit("zoom");return this},end:function t(){if(--this.active===0){delete this.that.__zooming;this.emit("end")}return this},emit:function t(e){vd(new wT(_,e,this.that.__zoom),n.apply,n,[e,this.that,this.args])}};function a(){if(!s.apply(this,arguments))return;var t=k(this,arguments),e=this.__zoom,n=Math.max(o[0],Math.min(o[1],e.k*Math.pow(2,r.apply(this,arguments)))),i=Ed(this);if(t.wheel){if(t.mouse[0][0]!==i[0]||t.mouse[0][1]!==i[1]){t.mouse[1]=e.invert(t.mouse[0]=i)}clearTimeout(t.wheel)}else if(e.k===n)return;else{t.mouse=[i,e.invert(i)];mg(this);t.start()}AT();t.wheel=setTimeout(a,v);t.zoom("mouse",d(b(y(e,n),t.mouse[0],t.mouse[1]),t.extent,g));function a(){t.wheel=null;t.end()}}function S(){if(u||!s.apply(this,arguments))return;var n=k(this,arguments,true),t=Sd(ld.view).on("mousemove.zoom",r,true).on("mouseup.zoom",o,true),e=Ed(this),i=ld.clientX,a=ld.clientY;NR(ld.view);CT();n.mouse=[e,this.__zoom.invert(e)];mg(this);n.start();function r(){AT();if(!n.moved){var t=ld.clientX-i,e=ld.clientY-a;n.moved=t*t+e*e>m}n.zoom("mouse",d(b(n.that.__zoom,n.mouse[0]=Ed(n.that),n.mouse[1]),n.extent,g))}function o(){t.on("mousemove.zoom mouseup.zoom",null);zR(ld.view,n.moved);AT();n.end()}}function C(){if(!s.apply(this,arguments))return;var t=this.__zoom,e=Ed(this),n=t.invert(e),i=t.k*(ld.shiftKey?.5:2),a=d(b(y(t,i),e,n),c.apply(this,arguments),g);AT();if(l>0)Sd(this).transition().duration(l).call(x,a,e);else Sd(this).call(_.transform,a)}function A(){if(!s.apply(this,arguments))return;var t=ld.touches,e=t.length,n=k(this,arguments,ld.changedTouches.length===e),i,a,r,o;CT();for(a=0;a<e;++a){r=t[a],o=Rd(this,t,r.identifier);o=[o,this.__zoom.invert(o),r.identifier];if(!n.touch0)n.touch0=o,i=true,n.taps=1+!!p;else if(!n.touch1&&n.touch0[2]!==o[2])n.touch1=o,n.taps=0}if(p)p=clearTimeout(p);if(i){if(n.taps<2)p=setTimeout(function(){p=null},h);mg(this);n.start()}}function E(){if(!this.__zooming)return;var t=k(this,arguments),e=ld.changedTouches,n=e.length,i,a,r,o;AT();if(p)p=clearTimeout(p);t.taps=0;for(i=0;i<n;++i){a=e[i],r=Rd(this,e,a.identifier);if(t.touch0&&t.touch0[2]===a.identifier)t.touch0[0]=r;else if(t.touch1&&t.touch1[2]===a.identifier)t.touch1[0]=r}a=t.that.__zoom;if(t.touch1){var s=t.touch0[0],l=t.touch0[1],u=t.touch1[0],h=t.touch1[1],c=(c=u[0]-s[0])*c+(c=u[1]-s[1])*c,f=(f=h[0]-l[0])*f+(f=h[1]-l[1])*f;a=y(a,Math.sqrt(c/f));r=[(s[0]+u[0])/2,(s[1]+u[1])/2];o=[(l[0]+h[0])/2,(l[1]+h[1])/2]}else if(t.touch0)r=t.touch0[0],o=t.touch0[1];else return;t.zoom("touch",d(b(a,r,o),t.extent,g))}function M(){if(!this.__zooming)return;var t=k(this,arguments),e=ld.changedTouches,n=e.length,i,a;CT();if(u)clearTimeout(u);u=setTimeout(function(){u=null},h);for(i=0;i<n;++i){a=e[i];if(t.touch0&&t.touch0[2]===a.identifier)delete t.touch0;else if(t.touch1&&t.touch1[2]===a.identifier)delete t.touch1}if(t.touch1&&!t.touch0)t.touch0=t.touch1,delete t.touch1;if(t.touch0)t.touch0[1]=this.__zoom.invert(t.touch0[0]);else{t.end();if(t.taps===2){var r=Sd(this).on("dblclick.zoom");if(r)r.apply(this,arguments)}}}_.wheelDelta=function(t){return arguments.length?(r=typeof t==="function"?t:bT(+t),_):r};_.filter=function(t){return arguments.length?(s=typeof t==="function"?t:bT(!!t),_):s};_.touchable=function(t){return arguments.length?(e=typeof t==="function"?t:bT(!!t),_):e};_.extent=function(t){return arguments.length?(c=typeof t==="function"?t:bT([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),_):c};_.scaleExtent=function(t){return arguments.length?(o[0]=+t[0],o[1]=+t[1],_):[o[0],o[1]]};_.translateExtent=function(t){return arguments.length?(g[0][0]=+t[0][0],g[1][0]=+t[1][0],g[0][1]=+t[0][1],g[1][1]=+t[1][1],_):[[g[0][0],g[0][1]],[g[1][0],g[1][1]]]};_.constrain=function(t){return arguments.length?(d=t,_):d};_.duration=function(t){return arguments.length?(l=+t,_):l};_.interpolate=function(t){return arguments.length?(f=t,_):f};_.on=function(){var t=n.on.apply(n,arguments);return t===n?_:t};_.clickDistance=function(t){return arguments.length?(m=(t=+t)*t,_):Math.sqrt(m)};return _}var DT=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function NT(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function zT(t,e){return e={exports:{}},t(e,e.exports),e.exports}var FT=zT(function(n){(function(t,e){{n.exports=e()}})((typeof window==="undefined"?"undefined":ie(window))==="object"?window:DT,function(){var a=void 0;function e(t){if(!(this instanceof e))return new e(t);this._LRUCacheState=new n(t)}var t=e.prototype;t.get=function(t){var e=this._LRUCacheState;var n=e.hash[t];if(!n)return;o(e.linkedList,n);return e.data[t]};t.set=function(t,e){var n=this._LRUCacheState;var i=n.hash[t];if(e===a)return this;if(!i){n.hash[t]=new r(t);n.linkedList.length+=1;i=n.hash[t]}o(n.linkedList,i);n.data[t]=e;if(n.linkedList.length>n.capacity)this.remove(n.linkedList.end.key);return this};t.update=function(t,e){if(this.has(t))this.set(t,e(this.get(t)));return this};t.remove=function(t){var e=this._LRUCacheState;var n=e.hash[t];if(!n)return this;if(n===e.linkedList.head)e.linkedList.head=n.p;if(n===e.linkedList.end)e.linkedList.end=n.n;s(n.n,n.p);delete e.hash[t];delete e.data[t];e.linkedList.length-=1;return this};t.removeAll=function(){this._LRUCacheState=new n(this._LRUCacheState.capacity);return this};t.info=function(){var t=this._LRUCacheState;return{capacity:t.capacity,length:t.linkedList.length}};t.keys=function(){var t=[];var e=this._LRUCacheState.linkedList.head;while(e){t.push(e.key);e=e.p}return t};t.has=function(t){return!!this._LRUCacheState.hash[t]};t.staleKey=function(){return this._LRUCacheState.linkedList.end&&this._LRUCacheState.linkedList.end.key};t.popStale=function(){var t=this.staleKey();if(!t)return null;var e=[t,this._LRUCacheState.data[t]];this.remove(t);return e};function n(t){this.capacity=t>0?+t:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE;this.data=Object.create?Object.create(null):{};this.hash=Object.create?Object.create(null):{};this.linkedList=new i}function i(){this.length=0;this.head=null;this.end=null}function r(t){this.key=t;this.p=null;this.n=null}function o(t,e){if(e===t.head)return;if(!t.end){t.end=e}else if(t.end===e){t.end=e.n}s(e.n,e.p);s(e,t.head);t.head=e;t.head.n=null}function s(t,e){if(t===e)return;if(t)t.p=e;if(e)e.n=t}return e})});var LT={"en-GB":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","M","B","t","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:",",decimal:"."},currency:["",""]},"en-US":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","M","B","t","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:",",decimal:"."},currency:["$",""]},"es-CL":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","M","MM","B","T","Q","Z","Y"],grouping:[3],delimiters:{thousands:".",decimal:","},currency:["$",""]},"es-MX":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","M","MM","B","T","Q","Z","Y"],grouping:[3],delimiters:{thousands:",",decimal:"."},currency:["$",""]},"es-ES":{separator:"",suffixes:["y","z","a","f","p","n","","m","","k","mm","b","t","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:".",decimal:","},currency:["",""]},"et-EE":{separator:" ",suffixes:["y","z","a","f","p","n","","m","","tuhat","miljonit","miljardit","triljonit","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:" ",decimal:","},currency:["","eurot"]},"fr-FR":{suffixes:["y","z","a","f","p","n","","m","","k","m","b","t","q","Q","Z","Y"],grouping:[3],delimiters:{thousands:" ",decimal:","},currency:["",""]}};function jT(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){jT=function t(e){return ie(e)}}else{jT=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return jT(t)}var IT=function t(e,n){return parseFloat(Math.round(e*Math.pow(10,n))/Math.pow(10,n)).toFixed(n)};function HT(t,e,n){var i=0;if(t){if(t<0)t*=-1;i=1+Math.floor(1e-12+Math.log(t)/Math.LN10);i=Math.max(-24,Math.min(24,Math.floor((i-1)/3)*3))}var a=n[8+i/3];return{number:IT(a.scale(t),e),symbol:a.symbol}}function VT(t,e){var n=Math.pow(10,Math.abs(8-e)*3);return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function UT(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"en-US";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;if(isFinite(t))t*=1;else return"N/A";var i=t<0;var a=t.toString().split(".")[0].replace("-","").length,r=jT(e)==="object"?e:LT[e]||LT["en-US"],o=r.suffixes.map(VT);var s=r.delimiters.decimal||".",l=r.separator||"",u=r.delimiters.thousands||",";var h=d_({currency:r.currency||["$",""],decimal:s,grouping:r.grouping||[3],thousands:u});var c;if(n)c=h.format(n)(t);else if(t===0)c="0";else if(a>=3){var f=HT(h.format(".3r")(t),2,o);var d=parseFloat(f.number).toString().replace(".",s);var g=f.symbol;c="".concat(d).concat(l).concat(g)}else if(a===3)c=h.format(",f")(t);else if(t<1&&t>-1)c=h.format(".2g")(t);else c=h.format(".3g")(t);return"".concat(i&&c.charAt(0)!=="-"?"-":"").concat(c).replace(/(\.[1-9]*)[0]*$/g,"$1").replace(/[.]$/g,"")}function GT(t){if(t.constructor===Date)return t;else if(t.constructor===Number&&"".concat(t).length>5&&t%1===0)return new Date(t);var e="".concat(t);var n=new RegExp(/^\d{1,2}[./-]\d{1,2}[./-](-*\d{1,4})$/g).exec(e),i=new RegExp(/^[A-z]{1,3} [A-z]{1,3} \d{1,2} (-*\d{1,4}) \d{1,2}:\d{1,2}:\d{1,2} [A-z]{1,3}-*\d{1,4} \([A-z]{1,3}\)/g).exec(e);if(n){var a=n[1];if(a.indexOf("-")===0)e=e.replace(a,a.substr(1));var r=new Date(e);r.setFullYear(a);return r}else if(i){var o=i[1];if(o.indexOf("-")===0)e=e.replace(o,o.substr(1));var s=new Date(e);s.setFullYear(o);return s}else if(!e.includes("/")&&!e.includes(" ")&&(!e.includes("-")||!e.indexOf("-"))){var l=new Date("".concat(e,"/01/01"));l.setFullYear(t);return l}else return new Date(e)}function WT(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){WT=function t(e){return ie(e)}}else{WT=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return WT(t)}function KT(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function qT(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function YT(t,e,n){if(e)qT(t.prototype,e);if(n)qT(t,n);return t}function XT(t,e){if(e&&(WT(e)==="object"||typeof e==="function")){return e}return ZT(t)}function ZT(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function JT(t){JT=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return JT(t)}function $T(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)QT(t,e)}function QT(t,e){QT=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return QT(t,e)}var tB=function(t){$T(e,t);function e(){var t;KT(this,e);t=XT(this,JT(e).call(this));t._buttonStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"14px",margin:"0 5px"};t._data=[];t._text=g("text");t._value=g("value");return t}YT(e,[{key:"render",value:function t(){var n=this;if(this._container===void 0)this.container(Sd("body").append("div").node());var e=this._container.selectAll("div#d3plus-Form-".concat(this._uuid)).data([0]);var i=this._container.node().tagName.toLowerCase()==="foreignobject";e=e.enter().append(i?"xhtml:div":"div").attr("id","d3plus-Form-".concat(this._uuid)).attr("class","d3plus-Form d3plus-Form-Button").merge(e);var a=e.selectAll("button").data(this._data,function(t,e){return n._value(t,e)});a.exit().remove();a=a.enter().append("button").attr("class","d3plus-Button").attr("type","button").merge(a).call(Tm,this._buttonStyle).html(function(t,e){return n._text(t,e)});for(var r in this._on){if({}.hasOwnProperty.call(this._on,r))a.on(r,this._on[r])}return this}},{key:"buttonStyle",value:function t(e){return arguments.length?(this._buttonStyle=e,this):this._buttonStyle}},{key:"container",value:function t(e){return arguments.length?(this._container=Sd(e),this):this._container}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"text",value:function t(e){return arguments.length?(this._text=typeof e==="function"?e:Oc(e),this):this._text}},{key:"value",value:function t(e){return arguments.length?(this._value=e,this):this._value}}]);return e}(Mc);function eB(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){eB=function t(e){return ie(e)}}else{eB=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return eB(t)}function nB(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function iB(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function aB(t,e,n){if(e)iB(t.prototype,e);if(n)iB(t,n);return t}function rB(t,e){if(e&&(eB(e)==="object"||typeof e==="function")){return e}return oB(t)}function oB(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function sB(t){sB=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return sB(t)}function lB(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)uB(t,e)}function uB(t,e){uB=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return uB(t,e)}var hB=function(t){lB(e,t);function e(){var t;nB(this,e);t=rB(this,sB(e).call(this));t._labelStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"14px","padding-right":"5px"};t._legendStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"14px","padding-right":"5px"};t._options=[];t._radioStyle={"margin-right":"10px"};t._text=g("text");t._value=g("value");return t}aB(e,[{key:"render",value:function t(){var n=this;if(this._container===void 0)this.container(Sd("body").append("div").node());var r=this;var e=this._container.selectAll("div#d3plus-Form-".concat(this._uuid)).data([0]);var i=this._container.node().tagName.toLowerCase()==="foreignobject";e=e.enter().append(i?"xhtml:div":"div").attr("id","d3plus-Form-".concat(this._uuid)).attr("class","d3plus-Form d3plus-Form-Radio").merge(e);var o=e.selectAll("label").data(this._options,function(t,e){return n._value(t,e)});o.exit().each(function(){Sd(this.nextSibling).remove()}).remove();o=o.enter().append("label").attr("class","d3plus-Label").attr("for",function(t,e){return"".concat(n._uuid,"-").concat(n._value(t,e))}).each(function(t,e){var n=document.createElement("input");n.setAttribute("type","radio");n.setAttribute("name","d3plus-Radio-".concat(r._uuid));n.setAttribute("id","".concat(r._uuid,"-").concat(r._value(t,e)));n.setAttribute("value",r._value(t,e));this.parentNode.insertBefore(n,this.nextSibling)}).merge(o).call(Tm,this._labelStyle).html(function(t,e){return n._text(t,e)}).each(function(t,e){var n=r._checked===void 0?!e:"".concat(r._value(t,e))==="".concat(r._checked);Sd(this).classed("active",n).style("cursor",n?"default":"pointer");var i=Sd(this.nextSibling).property("checked",n).call(Tm,r._radioStyle).style("cursor",n?"default":"pointer").on("change.d3plus",function(){r.checked(this.value);o.each(function(t,e){var n="".concat(r._value(t,e))==="".concat(r._checked);Sd(this).classed("active",n).style("cursor",n?"default":"pointer");Sd(this.nextSibling).style("cursor",n?"default":"pointer")})});for(var a in r._on){if({}.hasOwnProperty.call(r._on,a))i.on(a,r._on[a])}});var a=e.selectAll("legend#d3plus-Legend-".concat(this._uuid)).data(this._legend?[0]:[]);a.exit().remove();a.enter().insert("legend",".d3plus-Label").attr("id","d3plus-Legend-".concat(this._uuid)).attr("class","d3plus-Legend").merge(a).call(Tm,this._legendStyle).html(this._legend);return this}},{key:"checked",value:function t(e){return arguments.length?(this._checked=e,this):this._checked}},{key:"container",value:function t(e){return arguments.length?(this._container=Sd(e),this):this._container}},{key:"labelStyle",value:function t(e){return arguments.length?(this._labelStyle=e,this):this._labelStyle}},{key:"legend",value:function t(e){return arguments.length?(this._legend=e,this):this._legend}},{key:"legendStyle",value:function t(e){return arguments.length?(this._legendStyle=e,this):this._legendStyle}},{key:"options",value:function t(e){return arguments.length?(this._options=e,this):this._options}},{key:"radioStyle",value:function t(e){return arguments.length?(this._radioStyle=e,this):this._radioStyle}},{key:"text",value:function t(e){return arguments.length?(this._text=typeof e==="function"?e:Oc(e),this):this._text}},{key:"value",value:function t(e){return arguments.length?(this._value=e,this):this._value}}]);return e}(Mc);function cB(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){cB=function t(e){return ie(e)}}else{cB=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return cB(t)}function fB(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function dB(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function gB(t,e,n){if(e)dB(t.prototype,e);if(n)dB(t,n);return t}function pB(t,e){if(e&&(cB(e)==="object"||typeof e==="function")){return e}return vB(t)}function vB(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function mB(t){mB=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return mB(t)}function _B(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)yB(t,e)}function yB(t,e){yB=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return yB(t,e)}var bB=function(t){_B(e,t);function e(){var t;fB(this,e);t=pB(this,mB(e).call(this));t._labelStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"14px","margin-right":"5px"};t._options=[];t._optionStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"14px"};t._selectStyle={background:"#fafafa",border:"1px solid #ccc","border-radius":"0","font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"14px",outline:"0",padding:"3px 5px 4px"};t._text=g("text");t._value=g("value");return t}gB(e,[{key:"render",value:function t(){var n=this;if(this._container===void 0)this.container(r("body").append("div").node());var e=this;var i=this._container.selectAll("div#d3plus-Form-".concat(this._uuid)).data([0]);var a=this._container.node().tagName.toLowerCase()==="foreignobject";i=i.enter().append(a?"xhtml:div":"div").attr("id","d3plus-Form-".concat(this._uuid)).attr("class","d3plus-Form d3plus-Form-Select").merge(i);var r=i.selectAll("select#d3plus-Select-".concat(this._uuid)).data([0]);r=r.enter().append("select").attr("id","d3plus-Select-".concat(this._uuid)).attr("class","d3plus-Select").merge(r).call(Tm,this._selectStyle).on("change.d3plus",function(){e.selected(this.value)});for(var o in this._on){if({}.hasOwnProperty.call(this._on,o))r.on(o,this._on[o])}var s=r.selectAll("option").data(this._options,function(t,e){return n._value(t,e)});s.exit().remove();s.enter().append("option").attr("class","d3plus-Option").merge(s).call(Tm,this._optionStyle).attr("value",function(t,e){return n._value(t,e)}).html(function(t,e){return n._text(t,e)}).property("selected",function(t,e){return n._selected===void 0?!e:"".concat(n._value(t,e))==="".concat(n._selected)});var l=i.selectAll("label#d3plus-Label-".concat(this._uuid)).data(this._label?[0]:[]);l.exit().remove();l.enter().insert("label","#d3plus-Select-".concat(this._uuid)).attr("id","d3plus-Label-".concat(this._uuid)).attr("class","d3plus-Label").attr("for","d3plus-Select-".concat(this._uuid)).merge(l).call(Tm,this._labelStyle).html(this._label);return this}},{key:"container",value:function t(e){return arguments.length?(this._container=Sd(e),this):this._container}},{key:"label",value:function t(e){return arguments.length?(this._label=e,this):this._label}},{key:"labelStyle",value:function t(e){return arguments.length?(this._labelStyle=e,this):this._labelStyle}},{key:"options",value:function t(e){return arguments.length?(this._options=e,this):this._options}},{key:"optionStyle",value:function t(e){return arguments.length?(this._optionStyle=e,this):this._optionStyle}},{key:"selected",value:function t(e){return arguments.length?(this._selected=e,this):this._selected}},{key:"selectStyle",value:function t(e){return arguments.length?(this._selectStyle=e,this):this._selectStyle}},{key:"text",value:function t(e){return arguments.length?(this._text=typeof e==="function"?e:Oc(e),this):this._text}},{key:"value",value:function t(e){return arguments.length?(this._value=e,this):this._value}}]);return e}(Mc);function wB(t){return t.slice().sort(function(t,e){return t-e})}function xB(t){var e,n=0;for(var i=0;i<t.length;i++){if(i===0||t[i]!==e){e=t[i];n++}}return n}function kB(t,e){var n=[];for(var i=0;i<t;i++){var a=[];for(var r=0;r<e;r++){a.push(0)}n.push(a)}return n}function SB(t,e,n,i){var a;if(t>0){var r=(n[e]-n[t-1])/(e-t+1);a=i[e]-i[t-1]-(e-t+1)*r*r}else a=i[e]-n[e]*n[e]/(e+1);if(a<0)return 0;return a}function CB(t,e,n,i,a,r,o){if(t>e)return;var s=Math.floor((t+e)/2);i[n][s]=i[n-1][s-1];a[n][s]=s;var l=n;if(t>n)l=Math.max(l,a[n][t-1]||0);l=Math.max(l,a[n-1][s]||0);var u=s-1;if(e<i.length-1)u=Math.min(u,a[n][e+1]||0);for(var h=u;h>=l;--h){var c=SB(h,s,r,o);if(c+i[n-1][l-1]>=i[n][s])break;var f=SB(l,s,r,o);var d=f+i[n-1][l-1];if(d<i[n][s]){i[n][s]=d;a[n][s]=l}l++;var g=c+i[n-1][h-1];if(g<i[n][s]){i[n][s]=g;a[n][s]=h}}CB(t,s-1,n,i,a,r,o);CB(s+1,e,n,i,a,r,o)}function AB(t,e,n){var i=e[0]?e[0].length:0;var a=t[Math.floor(i/2)];var r=[];var o=[];for(var s=0,l=void 0;s<i;++s){l=t[s]-a;if(s===0){r.push(l);o.push(l*l)}else{r.push(r[s-1]+l);o.push(o[s-1]+l*l)}e[0][s]=SB(0,s,r,o);n[0][s]=0}for(var u=1;u<e.length;++u){var h=i-1;if(u<e.length-1)h=u;CB(h,i-1,u,e,n,r,o)}}function EB(t,e){if(e>t.length){throw new Error("Cannot generate more classes than there are data values")}var n=wB(t);var i=xB(n);if(i===1){return[n]}var a=kB(e,n.length),r=kB(e,n.length);AB(n,r,a);var o=a[0]?a[0].length-1:0;var s=[];for(var l=a.length-1;l>=0;l--){var u=a[l][o];s[l]=n.slice(u,o+1);if(l>0)o=u-1}return s}function MB(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){MB=function t(e){return ie(e)}}else{MB=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return MB(t)}function RB(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function TB(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function BB(t,e,n){if(e)TB(t.prototype,e);if(n)TB(t,n);return t}function OB(t,e){if(e&&(MB(e)==="object"||typeof e==="function")){return e}return PB(t)}function PB(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function DB(t){DB=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return DB(t)}function NB(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)zB(t,e)}function zB(t,e){zB=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return zB(t,e)}var FB=function(t){NB(e,t);function e(){var s;RB(this,e);s=OB(this,DB(e).call(this));s._align="center";s._data=[];s._direction="row";s._duration=600;s._height=200;s._id=g("id");s._label=g("id");s._lineData=[];s._outerBounds={width:0,height:0,x:0,y:0};s._padding=5;s._shape=Oc("Rect");s._shapes=[];s._shapeConfig={duration:s._duration,fill:g("color"),height:Oc(10),hitArea:function t(e,n){var i=s._lineData[n],a=um([i.height,i.shapeHeight]);return{width:i.width+i.shapeWidth,height:a,x:-i.shapeWidth/2,y:-a/2}},labelBounds:function t(e,n){var i=s._lineData[n];var a=i.shapeWidth;if(i.shape==="Circle")a-=i.shapeR;var r=um([i.shapeHeight,i.height]);return{width:i.width,height:r,x:a,y:-r/2}},labelConfig:{fontColor:Oc("#444"),fontFamily:(new pC).fontFamily(),fontResize:false,fontSize:Oc(10),verticalAlign:"middle"},opacity:1,r:Oc(5),width:Oc(10),x:function t(e,n){var i=s._lineData[n];var a=i.y;var r=s._align==="left"||s._align==="right"&&s._direction==="column"?0:s._align==="center"?(s._outerBounds.width-s._rowWidth(s._lineData.filter(function(t){return a===t.y})))/2:s._outerBounds.width-s._rowWidth(s._lineData.filter(function(t){return a===t.y}));var o=s._lineData.slice(0,n).filter(function(t){return a===t.y});return s._rowWidth(o)+s._padding*(o.length?i.sentence?2:1:0)+s._outerBounds.x+i.shapeWidth/2+r},y:function t(e,n){var i=s._lineData[n];return i.y+s._titleHeight+s._outerBounds.y+um(s._lineData.filter(function(t){return i.y===t.y}).map(function(t){return t.height}).concat(s._data.map(function(t,e){return s._fetchConfig("height",t,e)})))/2}};s._titleClass=new pC;s._titleConfig={};s._verticalAlign="middle";s._width=400;return s}BB(e,[{key:"_fetchConfig",value:function t(e,n,i){var a=this._shapeConfig[e]||this._shapeConfig.labelConfig[e];if(!a&&e==="lineHeight")return this._fetchConfig("fontSize",n,i)*1.4;return typeof a==="function"?a(n,i):a}},{key:"_rowHeight",value:function t(e){return um(e.map(function(t){return t.height}).concat(e.map(function(t){return t.shapeHeight})))+this._padding}},{key:"_rowWidth",value:function t(i){var a=this;return dm(i.map(function(t,e){var n=a._padding*(e===i.length-1?0:t.width?2:1);return t.shapeWidth+t.width+n}))}},{key:"render",value:function t(e){var c=this;if(this._select===void 0)this.select(Sd("body").append("svg").attr("width","".concat(this._width,"px")).attr("height","".concat(this._height,"px")).node());this._group=Wv("g.d3plus-Legend",{parent:this._select});var f=this._height;this._titleHeight=0;this._titleWidth=0;if(this._title){var n=this._titleConfig.fontFamily||this._titleClass.fontFamily()(),i=this._titleConfig.fontSize||this._titleClass.fontSize()();var a=a=this._titleConfig.lineHeight||this._titleClass.lineHeight();a=a?a():i*1.4;var r=aC().fontFamily(n).fontSize(i).lineHeight(a).width(this._width).height(this._height)(this._title);this._titleHeight=a+r.lines.length+this._padding;this._titleWidth=um(r.widths);f-=this._titleHeight}this._lineData=this._data.map(function(t,e){var n=c._label(t,e);var i=c._shape(t,e);var a=c._fetchConfig("r",t,e);var r={data:t,i:e,id:c._id(t,e),shape:i,shapeR:a,shapeWidth:i==="Circle"?a*2:c._fetchConfig("width",t,e),shapeHeight:i==="Circle"?a*2:c._fetchConfig("height",t,e),y:0};if(!n){r.sentence=false;r.words=[];r.height=0;r.width=0;return r}var o=c._fetchConfig("fontFamily",t,e),s=c._fetchConfig("lineHeight",t,e),l=c._fetchConfig("fontSize",t,e);var u=f-(c._data.length+1)*c._padding,h=c._width;r=Object.assign(r,aC().fontFamily(o).fontSize(l).lineHeight(s).width(h).height(u)(n));r.width=Math.ceil(um(r.lines.map(function(t){return MS(t,{"font-family":o,"font-size":l})})))+l*.75;r.height=Math.ceil(r.lines.length*(s+1));r.og={height:r.height,width:r.width};r.f=o;r.s=l;r.lh=s;return r});var o;var l=this._width-this._padding*2;o=this._rowWidth(this._lineData);if(this._direction==="column"||o>l){var u=1,h=[];var d=um(this._lineData.map(function(t){return t.words.length}));this._wrapLines=function(){var e=this;u++;if(u>d)return;var o=u===1?this._lineData.slice():this._lineData.filter(function(t){return t.width+t.shapeWidth+e._padding*(t.width?2:1)>l&&t.words.length>=u}).sort(function(t,e){return e.sentence.length-t.sentence.length});if(o.length&&f>o[0].height*u){var s=false;var t=function t(e){var n=o[e];var i=n.og.height*u,a=n.og.width*(1.5*(1/u));var r=aC().fontFamily(n.f).fontSize(n.s).lineHeight(n.lh).width(a).height(i)(n.sentence);if(!r.truncated){n.width=Math.ceil(um(r.lines.map(function(t){return MS(t,{"font-family":n.f,"font-size":n.s})})))+n.s;n.height=r.lines.length*(n.lh+1)}else{s=true;return"break"}};for(var n=0;n<o.length;n++){var i=t(n);if(i==="break")break}if(!s)this._wrapRows()}else{h=[];return}};this._wrapRows=function(){h=[];var t=1,e=0;for(var n=0;n<this._lineData.length;n++){var i=this._lineData[n],a=i.width+this._padding*(i.width?2:1)+i.shapeWidth;if(dm(h.map(function(t){return um(t,function(t){return um([t.height,t.shapeHeight])})}))>f){h=[];break}if(a>l){h=[];this._wrapLines();break}else if(e+a<l){e+=a}else if(this._direction!=="column"){e=a;t++}if(!h[t-1])h[t-1]=[];h[t-1].push(i);if(this._direction==="column"){e=0;t++}}};this._wrapRows();if(!h.length||dm(h,this._rowHeight.bind(this))+this._padding>f){o=dm(this._lineData.map(function(t){return t.shapeWidth+c._padding}))-this._padding;for(var s=0;s<this._lineData.length;s++){this._lineData[s].width=0;this._lineData[s].height=0}this._wrapRows()}if(h.length&&dm(h,this._rowHeight.bind(this))+this._padding<f){h.forEach(function(t,e){t.forEach(function(t){if(e){t.y=dm(h.slice(0,e),c._rowHeight.bind(c))}})});o=um(h,this._rowWidth.bind(this))}}var g=um(this._lineData,function(t,e){return um([t.height,c._fetchConfig("height",t.data,e)])+t.y})+this._titleHeight,p=um([o,this._titleWidth]);this._outerBounds.width=p;this._outerBounds.height=g;var v=this._padding,m=this._padding;if(this._align==="center")v=(this._width-p)/2;else if(this._align==="right")v=this._width-this._padding-p;if(this._verticalAlign==="middle")m=(this._height-g)/2;else if(this._verticalAlign==="bottom")m=this._height-this._padding-g;this._outerBounds.x=v;this._outerBounds.y=m;this._titleClass.data(this._title?[{text:this._title}]:[]).duration(this._duration).select(this._group.node()).textAnchor({left:"start",center:"middle",right:"end"}[this._align]).width(this._width-this._padding*2).x(this._padding).y(this._outerBounds.y).config(this._titleConfig).render();this._shapes=[];var _=Bc.bind(this)(this._shapeConfig,"legend"),y={id:function t(e){return e.id},label:function t(e){return e.label},lineHeight:function t(e){return e.lH}};var b=this._data.map(function(t,e){var n={__d3plus__:true,data:t,i:e,id:c._id(t,e),label:c._lineData[e].width?c._label(t,e):false,lH:c._fetchConfig("lineHeight",t,e),shape:c._shape(t,e)};return n});this._shapes=[];["Circle","Rect"].forEach(function(e){c._shapes.push((new lM[e]).data(b.filter(function(t){return t.shape===e})).duration(c._duration).labelConfig({padding:0}).select(c._group.node()).verticalAlign("top").config(gt({},_,y)).render())});if(e)setTimeout(e,this._duration+100);return this}},{key:"active",value:function t(e){this._shapes.forEach(function(t){return t.active(e)});return this}},{key:"align",value:function t(e){return arguments.length?(this._align=e,this):this._align}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"direction",value:function t(e){return arguments.length?(this._direction=e,this):this._direction}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"height",value:function t(e){return arguments.length?(this._height=e,this):this._height}},{key:"hover",value:function t(e){this._shapes.forEach(function(t){return t.hover(e)});return this}},{key:"id",value:function t(e){return arguments.length?(this._id=e,this):this._id}},{key:"label",value:function t(e){return arguments.length?(this._label=typeof e==="function"?e:Oc(e),this):this._label}},{key:"outerBounds",value:function t(){return this._outerBounds}},{key:"padding",value:function t(e){return arguments.length?(this._padding=e,this):this._padding}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"shape",value:function t(e){return arguments.length?(this._shape=typeof e==="function"?e:Oc(e),this):this._shape}},{key:"shapeConfig",value:function t(e){return arguments.length?(this._shapeConfig=gt(this._shapeConfig,e),this):this._shapeConfig}},{key:"title",value:function t(e){return arguments.length?(this._title=e,this):this._title}},{key:"titleConfig",value:function t(e){return arguments.length?(this._titleConfig=gt(this._titleConfig,e),this):this._titleConfig}},{key:"verticalAlign",value:function t(e){return arguments.length?(this._verticalAlign=e,this):this._verticalAlign}},{key:"width",value:function t(e){return arguments.length?(this._width=e,this):this._width}}]);return e}(Mc);function LB(t){if(t.constructor===Date)return t;else if(t.constructor===Number&&"".concat(t).length>5&&t%1===0)return new Date(t);var e="".concat(t);var n=new RegExp(/^\d{1,2}[./-]\d{1,2}[./-](-*\d{1,4})$/g).exec(e),i=new RegExp(/^[A-z]{1,3} [A-z]{1,3} \d{1,2} (-*\d{1,4}) \d{1,2}:\d{1,2}:\d{1,2} [A-z]{1,3}-*\d{1,4} \([A-z]{1,3}\)/g).exec(e);if(n){var a=n[1];if(a.indexOf("-")===0)e=e.replace(a,a.substr(1));var r=new Date(e);r.setFullYear(a);return r}else if(i){var o=i[1];if(o.indexOf("-")===0)e=e.replace(o,o.substr(1));var s=new Date(e);s.setFullYear(o);return s}else if(!e.includes("/")&&!e.includes(" ")&&(!e.includes("-")||!e.indexOf("-"))){var l=new Date("".concat(e,"/01/01"));l.setFullYear(t);return l}else return new Date(e)}var jB={"de-DE":{dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},"en-GB":{dateTime:"%a %e %b %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"en-US":{dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"es-ES":{dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],shortDays:["dom","lun","mar","mi","jue","vie","sb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},"es-MX":{dateTime:"%x, %X",date:"%d/%m/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],shortDays:["dom","lun","mar","mi","jue","vie","sb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},"fr-FR":{dateTime:"%A, le %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],months:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],shortMonths:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."]},"it-IT":{dateTime:"%A %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato"],shortDays:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],shortMonths:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"]},"pt-BR":{dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}};function IB(t,e,n){if(e in t){Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true})}else{t[e]=n}return t}function HB(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){HB=function t(e){return ie(e)}}else{HB=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return HB(t)}function VB(t){return WB(t)||GB(t)||UB()}function UB(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function GB(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function WB(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++){n[e]=t[e]}return n}}function KB(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function qB(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function YB(t,e,n){if(e)qB(t.prototype,e);if(n)qB(t,n);return t}function XB(t,e){if(e&&(HB(e)==="object"||typeof e==="function")){return e}return ZB(t)}function ZB(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function JB(t){JB=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return JB(t)}function $B(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)QB(t,e)}function QB(t,e){QB=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return QB(t,e)}var tO=function(t){$B(e,t);function e(){var n;KB(this,e);n=XB(this,JB(e).call(this));n._align="middle";n._barConfig={stroke:"#000","stroke-width":1};n._domain=[0,10];n._duration=600;n._gridConfig={stroke:"#ccc","stroke-width":1};n._gridLog=false;n._height=400;n._labelOffset=true;n.orient("bottom");n._outerBounds={width:0,height:0,x:0,y:0};n._padding=5;n._paddingInner=.1;n._paddingOuter=.1;n._rotateLabels=false;n._scale="linear";n._scalePadding=.5;n._shape="Line";n._shapeConfig={fill:"#000",height:function t(e){return e.tick?8:0},label:function t(e){return e.text},labelBounds:function t(e){return e.labelBounds},labelConfig:{fontColor:"#000",fontFamily:(new pC).fontFamily(),fontResize:false,fontSize:Oc(10),padding:0,textAnchor:function t(){var e=jS();return n._orient==="left"?e?"start":"end":n._orient==="right"?e?"end":"start":n._rotateLabels?n._orient==="bottom"?"end":"start":"middle"},verticalAlign:function t(){return n._orient==="bottom"?"top":n._orient==="top"?"bottom":"middle"}},r:function t(e){return e.tick?4:0},stroke:"#000",strokeWidth:1,width:function t(e){return e.tick?8:0}};n._tickSize=5;n._tickSpecifier=undefined;n._tickSuffix="normal";n._tickUnit=0;n._timeLocale=undefined;n._titleClass=new pC;n._titleConfig={fontSize:12,textAnchor:"middle"};n._width=400;return n}YB(e,[{key:"_barPosition",value:function t(e){var n=this._position,i=n.height,a=n.x,r=n.y,o=n.opposite,s=this._getDomain(),l=this._margin[o],u=["top","left"].includes(this._orient)?this._outerBounds[r]+this._outerBounds[i]-l:this._outerBounds[r]+l;var h=this._scale==="band"?this._d3Scale.step()-this._d3Scale.bandwidth():this._scale==="point"?this._d3Scale.step()*this._d3Scale.padding():0;var c=this._scale==="band"?this._d3Scale.step():this._scale==="point"?this._d3Scale.step()*this._d3Scale.padding():0;e.call(_,this._barConfig).attr("".concat(a,"1"),this._getPosition(s[0])-h).attr("".concat(a,"2"),this._getPosition(s[s.length-1])+c).attr("".concat(r,"1"),u).attr("".concat(r,"2"),u)}},{key:"_getDomain",value:function t(){var e=[];if(this._d3ScaleNegative)e=this._d3ScaleNegative.domain();if(this._d3Scale)e=e.concat(this._d3Scale.domain());var n=["band","ordinal","point"].includes(this._scale)?e:tm(e);return e[0]>e[1]?n.reverse():n}},{key:"_getPosition",value:function t(e){return e<0&&this._d3ScaleNegative?this._d3ScaleNegative(e):this._d3Scale(e)}},{key:"_getRange",value:function t(){var e=[];if(this._d3ScaleNegative)e=this._d3ScaleNegative.range();if(this._d3Scale)e=e.concat(this._d3Scale.range());return e[0]>e[1]?tm(e).reverse():tm(e)}},{key:"_getTicks",value:function t(){var e=W_().domain([10,400]).range([10,50]);var n=[];if(this._d3ScaleNegative){var i=this._d3ScaleNegative.range();var a=i[1]-i[0];n=this._d3ScaleNegative.ticks(Math.floor(a/e(a)))}if(this._d3Scale){var r=this._d3Scale.range();var o=r[1]-r[0];n=n.concat(this._d3Scale.ticks(Math.floor(o/e(o))))}return n}},{key:"_gridPosition",value:function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=this._position,a=i.height,r=i.x,o=i.y,s=i.opposite,l=this._margin[s],u=["top","left"].includes(this._orient)?this._outerBounds[o]+this._outerBounds[a]-l:this._outerBounds[o]+l,h=n?this._lastScale||this._getPosition.bind(this):this._getPosition.bind(this),c=["top","left"].includes(this._orient)?l:-l,f=this._scale==="band"?this._d3Scale.bandwidth()/2:0,d=function t(e){return h(e.id)+f};e.call(_,this._gridConfig).attr("".concat(r,"1"),d).attr("".concat(r,"2"),d).attr("".concat(o,"1"),u).attr("".concat(o,"2"),n?u:u+c)}},{key:"render",value:function t(e){var d=this,n;if(this._select===void 0){this.select(Sd("body").append("svg").attr("width","".concat(this._width,"px")).attr("height","".concat(this._height,"px")).node())}var i=this._timeLocale||jB[this._locale]||jB["en-US"];Jb(i).format();var c=qb("%a %d"),f=qb("%I %p"),g=qb(".%L"),p=qb("%I:%M"),v=qb("%b"),m=qb(":%S"),_=qb("%b %d"),y=qb("%Y");var a=this._position,r=a.width,b=a.height,w=a.x,x=a.y,k=a.horizontal,S=a.opposite,o="d3plus-Axis-clip-".concat(this._uuid),C=["top","left"].includes(this._orient),A=this._padding,s=this._select,E=[A,this["_".concat(r)]-A],l=Lv().duration(this._duration);var u=this._shape==="Circle"?this._shapeConfig.r:this._shape==="Rect"?this._shapeConfig[r]:this._shapeConfig.strokeWidth;var M=typeof u!=="function"?function(){return u}:u;var R=this._margin={top:0,right:0,bottom:0,left:0};var T,B,O;function h(){var a=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._range;B=t?t.slice():[undefined,undefined];var e=E[0],n=E[1];if(this._range){if(this._range[0]!==undefined)e=this._range[0];if(this._range[this._range.length-1]!==undefined)n=this._range[this._range.length-1]}if(B[0]===undefined||B[0]<e)B[0]=e;if(B[1]===undefined||B[1]>n)B[1]=n;var i=n-e;if(this._scale==="ordinal"&&this._domain.length>B.length){if(t===this._range){var r=this._domain.length+1;B=em(r).map(function(t){return B[0]+i*(t/(r-1))}).slice(1,r);B=B.map(function(t){return t-B[0]/2})}else{var o=this._domain.length;var s=B[1]-B[0];B=em(o).map(function(t){return B[0]+s*(t/(o-1))})}}else if(t===this._range){var l=W_().domain([10,400]).range([10,50]);var u=this._scale==="time"?this._domain.map(LB):this._domain;var h=rm(u[0],u[1],Math.floor(i/l(i)));O=(this._ticks?this._scale==="time"?this._ticks.map(LB):this._ticks:h).slice();T=(this._labels?this._scale==="time"?this._labels.map(LB):this._labels:h).slice();var c=T.length;if(c){var f=Math.ceil(i/c/2);B=[B[0]+f,B[1]-f]}}this._d3Scale=Sw["scale".concat(this._scale.charAt(0).toUpperCase()).concat(this._scale.slice(1))]().domain(this._scale==="time"?this._domain.map(LB):this._domain);if(this._d3Scale.round)this._d3Scale.round(true);if(this._d3Scale.padding)this._d3Scale.padding(this._scalePadding);if(this._d3Scale.paddingInner)this._d3Scale.paddingInner(this._paddingInner);if(this._d3Scale.paddingOuter)this._d3Scale.paddingOuter(this._paddingOuter);if(this._d3Scale.rangeRound)this._d3Scale.rangeRound(B);else this._d3Scale.range(B);this._d3ScaleNegative=null;if(this._scale==="log"){var d=this._d3Scale.domain();if(d[0]===0)d[0]=1;if(d[d.length-1]===0)d[d.length-1]=-1;var g=this._d3Scale.range();if(d[0]<0&&d[d.length-1]<0){this._d3ScaleNegative=this._d3Scale.copy().domain(d).range(g);this._d3Scale=null}else if(d[0]>0&&d[d.length-1]>0){this._d3Scale.domain(d).range(g)}else{var p=N_().domain([1,d[d[1]>0?1:0]]).range([0,1]);var v=p(Math.abs(d[d[1]<0?1:0]));var m=v/(v+1)*(g[1]-g[0]);if(d[0]>0)m=g[1]-g[0]-m;this._d3ScaleNegative=this._d3Scale.copy();(d[0]<0?this._d3Scale:this._d3ScaleNegative).domain([Math.sign(d[1]),d[1]]).range([g[0]+m,g[1]]);(d[0]<0?this._d3ScaleNegative:this._d3Scale).domain([d[0],Math.sign(d[0])]).range([g[0],g[0]+m])}}O=(this._ticks?this._scale==="time"?this._ticks.map(LB):this._ticks:(this._d3Scale?this._d3Scale.ticks:this._d3ScaleNegative.ticks)?this._getTicks():this._domain).slice();T=(this._labels?this._scale==="time"?this._labels.map(LB):this._labels:(this._d3Scale?this._d3Scale.ticks:this._d3ScaleNegative.ticks)?this._getTicks():O).slice();if(this._scale==="log"){T=T.filter(function(t){return Math.abs(t).toString().charAt(0)==="1"&&(a._d3Scale?t!==-1:t!==1)})}else if(this._scale==="time"){O=O.map(Number);T=T.map(Number)}O=O.sort(function(t,e){return a._getPosition(t)-a._getPosition(e)});T=T.sort(function(t,e){return a._getPosition(t)-a._getPosition(e)});if(this._scale==="linear"&&this._tickSuffix==="smallest"){var _=T.filter(function(t){return t>=1e3});if(_.length>0){var y=Math.min.apply(Math,VB(_));var b=1;while(b&&b<7){var w=Math.pow(10,3*b);if(y/w>=1){this._tickUnit=b;b+=1}else{break}}}}var x=[];this._availableTicks=O;O.forEach(function(t,e){var n=M({id:t,tick:true},e);if(a._shape==="Circle")n*=2;var i=a._getPosition(t);if(!x.length||Math.abs(Rc(i,x)-i)>n*2)x.push(i);else x.push(false)});O=O.filter(function(t,e){return x[e]!==false});this._visibleTicks=O}h.bind(this)();function P(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=t.i,i=t.position;if(this._scale==="band"){return this._d3Scale.bandwidth()}else{var a=n-e<0?U.length===1||!this._range?E[0]:(i-U[n+e].position)/2-i:i-(i-U[n-e].position)/2;var r=Math.abs(i-a);var o=n+e>U.length-1?U.length===1||!this._range?E[1]:(i-U[n-e].position)/2-i:i-(i-U[n+e].position)/2;var s=Math.abs(i-o);return fm([r,s])*2}}var D=this._tickFormat?this._tickFormat:function(t){if(d._scale==="log"){var e=Math.round(Math.log(Math.abs(t))/Math.LN10);var n=Math.abs(t).toString().charAt(0);var i="10 ".concat("".concat(e).split("").map(function(t){return""[t]}).join(""));if(n!=="1")i="".concat(n," x ").concat(i);return t<0?"-".concat(i):i}else if(d._scale==="time"){return(ay(t)<t?g:ry(t)<t?m:oy(t)<t?p:sy(t)<t?f:vy(t)<t?uy(t)<t?c:_:my(t)<t?v:y)(t)}else if(["band","ordinal","point"].includes(d._scale)){return t}var a=d._d3Scale.tickFormat?d._d3Scale.tickFormat(T.length-1)(t):t;a=typeof a==="string"?a.replace(/[^\d\.\-\+]/g,"")*1:a;if(isNaN(a)){return a}else if(d._scale==="linear"&&d._tickSuffix==="smallest"){var r=HB(d._locale)==="object"?d._locale:LT[d._locale];var o=r.separator,s=r.suffixes;var l=a>=1e3?s[d._tickUnit+8]:"";var u=a/Math.pow(10,3*d._tickUnit);var h=UT(u,r,",.".concat(u.toString().length,"r"));return"".concat(h).concat(o).concat(l)}else{return UT(a,d._locale)}};if(this._title){var N=this._titleConfig,z=N.fontFamily,F=N.fontSize,L=N.lineHeight;var j=aC().fontFamily(typeof z==="function"?z():z).fontSize(typeof F==="function"?F():F).lineHeight(typeof L==="function"?L():L).width(B[B.length-1]-B[0]-A*2).height(this["_".concat(b)]-this._tickSize-A*2);var I=j(this._title).lines.length;R[this._orient]=I*j.lineHeight()+A}var H=this._shape==="Circle"?typeof this._shapeConfig.r==="function"?this._shapeConfig.r({tick:true}):this._shapeConfig.r:this._shape==="Rect"?typeof this._shapeConfig[b]==="function"?this._shapeConfig[b]({tick:true}):this._shapeConfig[b]:this._tickSize,V=M({tick:true});if(typeof H==="function")H=um(O.map(H));if(this._shape==="Rect")H/=2;if(typeof V==="function")V=um(O.map(V));if(this._shape!=="Circle")V/=2;var U=T.map(function(t,e){var n=d._shapeConfig.labelConfig.fontFamily(t,e),i=d._shapeConfig.labelConfig.fontSize(t,e),a=d._getPosition(t);var r=d._shapeConfig.lineHeight?d._shapeConfig.lineHeight(t,e):i*1.4;return{d:t,i:e,fF:n,fS:i,lineHeight:r,position:a}});function G(t){var e=t.d,n=t.i,i=t.fF,a=t.fS,r=t.rotate,o=t.space;var s=r?"width":"height",l=r?"height":"width";var u=fm([this._maxSize,this._width]);var h=fm([this._maxSize,this._height]);var c=aC().fontFamily(i).fontSize(a).lineHeight(this._shapeConfig.lineHeight?this._shapeConfig.lineHeight(e,n):undefined)[l](k?o:u-H-A-this._margin.left-this._margin.right)[s](k?h-H-A-this._margin.top-this._margin.bottom:o);var f=c(D(e));f.lines=f.lines.filter(function(t){return t!==""});f.width=f.lines.length?Math.ceil(um(f.widths))+a/4:0;if(f.width%2)f.width++;f.height=f.lines.length?Math.ceil(f.lines.length*c.lineHeight())+a/4:0;if(f.height%2)f.height++;return f}U=U.map(function(t){t.rotate=d._labelRotation;t.space=P.bind(d)(t);var e=G.bind(d)(t);return Object.assign(e,t)});this._rotateLabels=k&&this._labelRotation===undefined?U.some(function(t){return t.truncated}):this._labelRotation;if(this._rotateLabels){U=U.map(function(t){t.rotate=true;var e=G.bind(d)(t);return Object.assign(t,e)})}var W=[0,0];for(var K=0;K<2;K++){var q=U[K?U.length-1:0];if(!q)break;var Y=q.height,X=q.position,Z=q.rotate,J=q.width;var $=K?E[1]:E[0];var Q=(Z||!k?Y:J)/2;var tt=K?X+Q-$:X-Q-$;W[K]=tt}var et=B[0];var nt=B[B.length-1];var it=[et-W[0],nt-W[1]];if(this._range){if(this._range[0]!==undefined)it[0]=this._range[0];if(this._range[this._range.length-1]!==undefined)it[1]=this._range[this._range.length-1]}if(it[0]!==et||it[1]!==nt){h.bind(this)(it);U=T.map(function(t,e){var n=d._shapeConfig.labelConfig.fontFamily(t,e),i=d._shapeConfig.labelConfig.fontSize(t,e),a=d._getPosition(t);var r=d._shapeConfig.lineHeight?d._shapeConfig.lineHeight(t,e):i*1.4;return{d:t,i:e,fF:n,fS:i,lineHeight:r,position:a}});U=U.map(function(t){t.rotate=d._rotateLabels;t.space=P.bind(d)(t);var e=G.bind(d)(t);return Object.assign(e,t)})}var at=um(U,function(t){return t.height})||0;this._rotateLabels=k&&this._labelRotation===undefined?U.some(function(t){var e=t.i,n=t.height,i=t.position,a=t.truncated;var r=U[e-1];return a||e&&r.position+r.height/2>i-n/2}):this._labelRotation;if(this._rotateLabels){var rt=0;U=U.map(function(t){t.space=P.bind(d)(t,2);var e=G.bind(d)(t);t=Object.assign(t,e);var n=U[t.i-1];if(!n){rt=1}else if(n.position+n.height/2>t.position){if(rt){t.offset=n.width;rt=0}else rt=1}return t})}var ot=this._labelOffset?um(U,function(t){return t.offset||0}):0;U.forEach(function(t){return t.offset=t.offset?ot:0});var st=this._shape==="Line"?0:H;var lt=this._outerBounds=(n={},IB(n,b,(um(U,function(t){return Math.ceil(t[t.rotate||!k?"width":"height"]+t.offset)})||0)+(U.length?A:0)),IB(n,r,E[E.length-1]-E[0]),IB(n,w,E[0]),n);lt[b]=um([this._minSize,lt[b]]);R[this._orient]+=H;R[S]=this._gridSize!==undefined?um([this._gridSize,st]):this["_".concat(b)]-R[this._orient]-lt[b]-A;lt[b]+=R[S]+R[this._orient];lt[x]=this._align==="start"?this._padding:this._align==="end"?this["_".concat(b)]-lt[b]-this._padding:this["_".concat(b)]/2-lt[b]/2;var ut=Wv("g#d3plus-Axis-".concat(this._uuid),{parent:s});this._group=ut;var ht=Wv("g.grid",{parent:ut}).selectAll("line").data((this._gridSize!==0?this._grid||this._scale==="log"&&!this._gridLog?T:O:[]).map(function(t){return{id:t}}),function(t){return t.id});ht.exit().transition(l).attr("opacity",0).call(this._gridPosition.bind(this)).remove();ht.enter().append("line").attr("opacity",0).attr("clip-path","url(#".concat(o,")")).call(this._gridPosition.bind(this),true).merge(ht).transition(l).attr("opacity",1).call(this._gridPosition.bind(this));var ct=T.filter(function(t,e){return U[e].lines.length&&!O.includes(t)});var ft=U.some(function(t){return t.rotate});var dt=O.concat(ct).map(function(e){var t;var n=U.find(function(t){return t.d===e});var i=d._getPosition(e);var a=n?n.space:0;var r=n?n.lines.length:1;var o=n?n.lineHeight:1;var s=n&&d._labelOffset?n.offset:0;var l=k?a:lt.width-R[d._position.opposite]-H-R[d._orient]+A;var u=R[S],h=(H+s)*(C?-1:1),c=C?lt[x]+lt[b]-u:lt[x]+u;var f=(t={id:e,labelBounds:ft&&n?{x:-n.width/2+n.fS/4,y:d._orient==="bottom"?h+A+(n.width-o*r)/2:h-A*2-(n.width+o*r)/2,width:n.width,height:n.height}:{x:k?-a/2:d._orient==="left"?-l-A+h:h+A,y:k?d._orient==="bottom"?h+A:h-A-at:-a/2,width:k?a:l,height:k?at:a},rotate:n?n.rotate:false,size:T.includes(e)?h:0,text:T.includes(e)?D(e):false,tick:O.includes(e)},IB(t,w,i+(d._scale==="band"?d._d3Scale.bandwidth()/2:0)),IB(t,x,c),t);return f});if(this._shape==="Line"){dt=dt.concat(dt.map(function(t){var e=Object.assign({},t);e[x]+=t.size;return e}))}(new lM[this._shape]).data(dt).duration(this._duration).labelConfig({ellipsis:function t(e){return e&&e.length?"".concat(e,"..."):""},rotate:function t(e){return e.rotate?-90:0}}).select(Wv("g.ticks",{parent:ut}).node()).config(this._shapeConfig).render();var gt=ut.selectAll("line.bar").data([null]);gt.enter().append("line").attr("class","bar").attr("opacity",0).call(this._barPosition.bind(this)).merge(gt).transition(l).attr("opacity",1).call(this._barPosition.bind(this));this._titleClass.data(this._title?[{text:this._title}]:[]).duration(this._duration).height(R[this._orient]).rotate(this._orient==="left"?-90:this._orient==="right"?90:0).select(Wv("g.d3plus-Axis-title",{parent:ut}).node()).text(function(t){return t.text}).verticalAlign("middle").width(B[B.length-1]-B[0]).x(k?B[0]:this._orient==="left"?lt.x+R.left/2-(B[B.length-1]-B[0])/2:lt.x+lt.width-R.right/2-(B[B.length-1]-B[0])/2).y(k?this._orient==="bottom"?lt.y+lt.height-R.bottom:lt.y:B[0]+(B[B.length-1]-B[0])/2-R[this._orient]/2).config(this._titleConfig).render();this._lastScale=this._getPosition.bind(this);if(e)setTimeout(e,this._duration+100);return this}},{key:"align",value:function t(e){return arguments.length?(this._align=e,this):this._align}},{key:"barConfig",value:function t(e){return arguments.length?(this._barConfig=Object.assign(this._barConfig,e),this):this._barConfig}},{key:"domain",value:function t(e){return arguments.length?(this._domain=e,this):this._domain}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"grid",value:function t(e){return arguments.length?(this._grid=e,this):this._grid}},{key:"gridConfig",value:function t(e){return arguments.length?(this._gridConfig=Object.assign(this._gridConfig,e),this):this._gridConfig}},{key:"gridLog",value:function t(e){return arguments.length?(this._gridLog=e,this):this._gridLog}},{key:"gridSize",value:function t(e){return arguments.length?(this._gridSize=e,this):this._gridSize}},{key:"height",value:function t(e){return arguments.length?(this._height=e,this):this._height}},{key:"labels",value:function t(e){return arguments.length?(this._labels=e,this):this._labels}},{key:"labelOffset",value:function t(e){return arguments.length?(this._labelOffset=e,this):this._labelOffset}},{key:"labelRotation",value:function t(e){return arguments.length?(this._labelRotation=e,this):this._labelRotation}},{key:"maxSize",value:function t(e){return arguments.length?(this._maxSize=e,this):this._maxSize}},{key:"minSize",value:function t(e){return arguments.length?(this._minSize=e,this):this._minSize}},{key:"orient",value:function t(e){if(arguments.length){var n=["top","bottom"].includes(e),i={top:"bottom",right:"left",bottom:"top",left:"right"};this._position={horizontal:n,width:n?"width":"height",height:n?"height":"width",x:n?"x":"y",y:n?"y":"x",opposite:i[e]};return this._orient=e,this}return this._orient}},{key:"outerBounds",value:function t(){return this._outerBounds}},{key:"padding",value:function t(e){return arguments.length?(this._padding=e,this):this._padding}},{key:"paddingInner",value:function t(e){return arguments.length?(this._paddingInner=e,this):this._paddingInner}},{key:"paddingOuter",value:function t(e){return arguments.length?(this._paddingOuter=e,this):this._paddingOuter}},{key:"range",value:function t(e){return arguments.length?(this._range=e,this):this._range}},{key:"scale",value:function t(e){return arguments.length?(this._scale=e,this):this._scale}},{key:"scalePadding",value:function t(e){return arguments.length?(this._scalePadding=e,this):this._scalePadding}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"shape",value:function t(e){return arguments.length?(this._shape=e,this):this._shape}},{key:"shapeConfig",value:function t(e){return arguments.length?(this._shapeConfig=gt(this._shapeConfig,e),this):this._shapeConfig}},{key:"tickFormat",value:function t(e){return arguments.length?(this._tickFormat=e,this):this._tickFormat}},{key:"ticks",value:function t(e){return arguments.length?(this._ticks=e,this):this._ticks}},{key:"tickSize",value:function t(e){return arguments.length?(this._tickSize=e,this):this._tickSize}},{key:"tickSpecifier",value:function t(e){return arguments.length?(this._tickSpecifier=e,this):this._tickSpecifier}},{key:"tickSuffix",value:function t(e){return arguments.length?(this._tickSuffix=e,this):this._tickSuffix}},{key:"timeLocale",value:function t(e){return arguments.length?(this._timeLocale=e,this):this._timeLocale}},{key:"title",value:function t(e){return arguments.length?(this._title=e,this):this._title}},{key:"titleConfig",value:function t(e){return arguments.length?(this._titleConfig=Object.assign(this._titleConfig,e),this):this._titleConfig}},{key:"width",value:function t(e){return arguments.length?(this._width=e,this):this._width}}]);return e}(Mc);function eO(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){eO=function t(e){return ie(e)}}else{eO=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return eO(t)}function nO(t,e,n){if(e in t){Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true})}else{t[e]=n}return t}function iO(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function aO(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function rO(t,e,n){if(e)aO(t.prototype,e);if(n)aO(t,n);return t}function oO(t,e){if(e&&(eO(e)==="object"||typeof e==="function")){return e}return sO(t)}function sO(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function lO(t){lO=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return lO(t)}function uO(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)hO(t,e)}function hO(t,e){hO=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return hO(t,e)}var cO=function(t){uO(e,t);function e(){var t;iO(this,e);t=oO(this,lO(e).call(this));t._axisClass=new tO;t._axisConfig={gridSize:0,shapeConfig:{labelConfig:{fontColor:"#222"}},titleConfig:{fontSize:12}};t._axisTest=new tO;t._align="middle";t._buckets=5;t._bucketAxis=false;t._colorMax="#0C8040";t._colorMid="#f7f7f7";t._colorMin="#b22200";t._data=[];t._duration=600;t._height=200;t._labelClass=new pC;t._legendClass=new FB;t._legendConfig={shapeConfig:{labelConfig:{fontColor:"#222"},stroke:"#444",strokeWidth:1}};t._midpoint=0;t._orient="bottom";t._outerBounds={width:0,height:0,x:0,y:0};t._padding=5;t._rectClass=new cE;t._rectConfig={stroke:"#444",strokeWidth:1};t._scale="linear";t._size=10;t._value=g("value");t._width=400;return t}rO(e,[{key:"render",value:function t(e){var n=this;if(this._select===void 0)this.select(Sd("body").append("svg").attr("width","".concat(this._width,"px")).attr("height","".concat(this._height,"px")).node());var i=["bottom","top"].includes(this._orient);var a=i?"height":"width",r=i?"width":"height",o=i?"x":"y",s=i?"y":"x";this._group=Wv("g.d3plus-ColorScale",{parent:this._select});var l=tm(this._data,this._value);var u=l[0]<this._midpoint;var h=l[1]>this._midpoint;var c=u&&h;var f=this._color,d,g;if(f&&!(f instanceof Array)){f=em(0,this._buckets,1).map(function(t){return AS(f,(t+1)/n._buckets)}).reverse()}if(this._scale==="jenks"){var p=this._data.map(this._value).filter(function(t){return t!==null&&typeof t==="number"});var v=fm([f?f.length:this._buckets,p.length]);var m=EB(p,v);g=cm(m.map(function(t,e){return e===m.length-1?[t[0],t[t.length-1]]:[t[0]]}));var _=new Set(g);if(g.length!==_.size){d=Array.from(_)}if(!f){if(c){f=[this._colorMin,this._colorMid,this._colorMax];var y=g.slice(0,v).filter(function(t,e){return t<n._midpoint&&g[e+1]<=n._midpoint});var b=g.slice(0,v).filter(function(t,e){return t<=n._midpoint&&g[e+1]>n._midpoint});var w=g.slice(0,v).filter(function(t,e){return t>n._midpoint&&g[e+1]>n._midpoint});var x=y.map(function(t,e){return!e?f[0]:AS(f[0],e/y.length)});var k=b.map(function(){return f[1]});var S=w.map(function(t,e){return e===w.length-1?f[2]:AS(f[2],1-(e+1)/w.length)});f=x.concat(k).concat(S)}else{f=em(0,this._buckets,1).map(function(t){return AS(n._colorMax,t/n._buckets)}).reverse()}}if(p.length<=v){f=f.slice(v-p.length)}this._colorScale=Y_().domain(g).range(["black"].concat(f).concat(f[f.length-1]))}else{var C;if(c&&!f){var A=Math.floor(this._buckets/2);var E=em(0,A,1).map(function(t){return!t?n._colorMin:AS(n._colorMin,t/A)});var M=(this._buckets%2?[0]:[]).map(function(){return n._colorMid});var R=em(0,A,1).map(function(t){return!t?n._colorMax:AS(n._colorMax,t/A)}).reverse();f=E.concat(M).concat(R);var T=(f.length-1)/2;C=[l[0],this._midpoint,l[1]];C=em(l[0],this._midpoint,-(l[0]-this._midpoint)/T).concat(em(this._midpoint,l[1],(l[1]-this._midpoint)/T)).concat([l[1]])}else{if(!f){if(this._scale==="buckets"){f=em(0,this._buckets,1).map(function(t){return AS(u?n._colorMin:n._colorMax,t/n._buckets)});if(h)f=f.reverse()}else{f=u?[this._colorMin,AS(this._colorMin,.8)]:[AS(this._colorMax,.8),this._colorMax]}}var B=(l[1]-l[0])/(f.length-1);C=em(l[0],l[1]+B/2,B)}if(this._scale==="buckets"){g=C.concat([C[C.length-1]])}if(this._scale==="log"){var O=C.filter(function(t){return t<0});if(O.length){var P=O[0];var D=O.map(function(t){return-Math.pow(Math.abs(P),t/P)});O.forEach(function(t,e){C[C.indexOf(t)]=D[e]})}var N=C.filter(function(t){return t>0});if(N.length){var z=N[N.length-1];var F=N.map(function(t){return Math.pow(z,t/z)});N.forEach(function(t,e){C[C.indexOf(t)]=F[e]})}if(C.includes(0))C[C.indexOf(0)]=1}this._colorScale=k_().domain(C).range(f)}var L=this._bucketAxis||!["buckets","jenks"].includes(this._scale);var j=Lv().duration(this._duration);var I={enter:{opacity:0},exit:{opacity:0},parent:this._group,transition:j,update:{opacity:1}};var H=Wv("g.d3plus-ColorScale-labels",Object.assign({condition:L},I));var V=Wv("g.d3plus-ColorScale-Rect",Object.assign({condition:L},I));var U=Wv("g.d3plus-ColorScale-legend",Object.assign({condition:!L},I));if(L){var G;var W={x:0,y:0};var K=gt({domain:i?l:l.reverse(),duration:this._duration,height:this._height,labels:d||g,orient:this._orient,padding:this._padding,scale:this._scale==="log"?"log":"linear",ticks:g,width:this._width},this._axisConfig);var q=gt({height:this["_".concat(a)]/2,width:this["_".concat(r)]/2},this._labelConfig||this._axisConfig.titleConfig);this._labelClass.config(q);var Y=[];if(i&&this._labelMin){var X={"font-family":this._labelClass.fontFamily()(this._labelMin),"font-size":this._labelClass.fontSize()(this._labelMin),"font-weight":this._labelClass.fontWeight()(this._labelMin)};if(X["font-family"]instanceof Array)X["font-family"]=X["font-family"][0];var Z=MS(this._labelMin,X);if(Z&&Z<this["_".concat(r)]/2){Y.push(this._labelMin);Z+=this._padding;if(i)W.x+=Z;K[r]-=Z}}if(i&&this._labelMax){var J={"font-family":this._labelClass.fontFamily()(this._labelMax),"font-size":this._labelClass.fontSize()(this._labelMax),"font-weight":this._labelClass.fontWeight()(this._labelMax)};if(J["font-family"]instanceof Array)J["font-family"]=J["font-family"][0];var $=MS(this._labelMax,J);if($&&$<this["_".concat(r)]/2){Y.push(this._labelMax);$+=this._padding;if(!i)W.y+=$;K[r]-=$}}this._axisTest.select(Wv("g.d3plus-ColorScale-axisTest",{enter:{opacity:0},parent:this._group}).node()).config(K).duration(0).render();var Q=this._axisTest.outerBounds();this._outerBounds[r]=this["_".concat(r)]-this._padding*2;this._outerBounds[a]=Q[a]+this._size;this._outerBounds[o]=this._padding;this._outerBounds[s]=this._padding;if(this._align==="middle")this._outerBounds[s]=(this["_".concat(a)]-this._outerBounds[a])/2;else if(this._align==="end")this._outerBounds[s]=this["_".concat(a)]-this._padding-this._outerBounds[a];var tt=this._outerBounds[s]+(["bottom","right"].includes(this._orient)?this._size:0)-(K.padding||this._axisClass.padding());var et="translate(".concat(W.x+(i?0:tt),", ").concat(W.y+(i?tt:0),")");this._axisClass.select(Wv("g.d3plus-ColorScale-axis",gt(I,{condition:true,enter:{transform:et},update:{transform:et}})).node()).config(K).align("start").render();var nt=this._axisTest._getPosition.bind(this._axisTest);var it=this._axisTest._getRange();var at=this._group.selectAll("defs").data([0]);var rt=at.enter().append("defs");rt.append("linearGradient").attr("id","gradient-".concat(this._uuid));at=rt.merge(at);at.select("linearGradient").attr("".concat(o,"1"),i?"0%":"100%").attr("".concat(o,"2"),i?"100%":"0%").attr("".concat(s,"1"),"0%").attr("".concat(s,"2"),"0%");var ot=at.select("linearGradient").selectAll("stop").data(i?f:f);var st=this._colorScale.domain();var lt=k_().domain(it).range(i?[0,100]:[100,0]);ot.enter().append("stop").merge(ot).attr("offset",function(t,e){return"".concat(lt(nt(st[e])),"%")}).attr("stop-color",String);var ut=function t(e,n){var i=Math.abs(nt(g[n+1])-nt(e));return i||2};var ht=gt((G={duration:this._duration,fill:g?function(t){return n._colorScale(t)}:"url(#gradient-".concat(this._uuid,")")},nO(G,o,g?function(t,e){return nt(t)+ut(t,e)/2-(["left","right"].includes(n._orient)?ut(t,e):0)}:it[0]+(it[1]-it[0])/2+W[o]),nO(G,s,this._outerBounds[s]+(["top","left"].includes(this._orient)?Q[a]:0)+this._size/2+W[s]),nO(G,r,g?ut:it[1]-it[0]),nO(G,a,this._size),G),this._rectConfig);this._rectClass.data(g?g.slice(0,g.length-1):[0]).id(function(t,e){return e}).select(V.node()).config(ht).render();q.height=this._outerBounds[a];q.width=this._outerBounds[r];this._labelClass.config(q).data(Y).select(H.node()).x(function(t){return t===n._labelMax?ht.x+ht.width/2+n._padding:n._outerBounds.x}).y(function(t){return ht.y-n._labelClass.fontSize()(t)/2}).text(function(t){return t}).rotate(i?0:this._orient==="right"?90:-90).render()}else{Wv("g.d3plus-ColorScale-axis",Object.assign({condition:L},I));var ct=this._axisConfig.tickFormat?this._axisConfig.tickFormat:UT;var ft=g.reduce(function(t,e,n){if(n!==g.length-1){var i=g[n+1];t.push({color:f[n],id:e===i?"".concat(ct(e),"+"):"".concat(ct(e)," - ").concat(ct(i))})}return t},[]);var dt=gt({align:i?"center":{start:"left",middle:"center",end:"right"}[this._align],direction:i?"row":"column",duration:this._duration,height:this._height,padding:this._padding,shapeConfig:gt({duration:this._duration},this._axisConfig.shapeConfig||{}),title:this._axisConfig.title,titleConfig:this._axisConfig.titleConfig||{},width:this._width,verticalAlign:i?{start:"top",middle:"middle",end:"bottom"}[this._align]:"middle"},this._legendConfig);this._legendClass.data(ft).select(U.node()).config(dt).render();this._outerBounds=this._legendClass.outerBounds()}if(e)setTimeout(e,this._duration+100);return this}},{key:"axisConfig",value:function t(e){return arguments.length?(this._axisConfig=gt(this._axisConfig,e),this):this._axisConfig}},{key:"align",value:function t(e){return arguments.length?(this._align=e,this):this._align}},{key:"buckets",value:function t(e){return arguments.length?(this._buckets=e,this):this._buckets}},{key:"bucketAxis",value:function t(e){return arguments.length?(this._bucketAxis=e,this):this._bucketAxis}},{key:"color",value:function t(e){return arguments.length?(this._color=e,this):this._color}},{key:"colorMax",value:function t(e){return arguments.length?(this._colorMax=e,this):this._colorMax}},{key:"colorMid",value:function t(e){return arguments.length?(this._colorMid=e,this):this._colorMid}},{key:"colorMin",value:function t(e){return arguments.length?(this._colorMin=e,this):this._colorMin}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"height",value:function t(e){return arguments.length?(this._height=e,this):this._height}},{key:"labelConfig",value:function t(e){return arguments.length?(this._labelConfig=e,this):this._labelConfig}},{key:"labelMin",value:function t(e){return arguments.length?(this._labelMin=e,this):this._labelMin}},{key:"labelMax",value:function t(e){return arguments.length?(this._labelMax=e,this):this._labelMax}},{key:"legendConfig",value:function t(e){return arguments.length?(this._legendConfig=gt(this._legendConfig,e),this):this._legendConfig}},{key:"midpoint",value:function t(e){return arguments.length?(this._midpoint=e,this):this._midpoint}},{key:"orient",value:function t(e){return arguments.length?(this._orient=e,this):this._orient}},{key:"outerBounds",value:function t(){return this._outerBounds}},{key:"padding",value:function t(e){return arguments.length?(this._padding=e,this):this._padding}},{key:"rectConfig",value:function t(e){return arguments.length?(this._rectConfig=gt(this._rectConfig,e),this):this._rectConfig}},{key:"scale",value:function t(e){return arguments.length?(this._scale=e,this):this._scale}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"size",value:function t(e){return arguments.length?(this._size=e,this):this._size}},{key:"value",value:function t(e){return arguments.length?(this._value=typeof e==="function"?e:Oc(e),this):this._value}},{key:"width",value:function t(e){return arguments.length?(this._width=e,this):this._width}}]);return e}(Mc);function fO(t){if(t.constructor===Date)return t;else if(t.constructor===Number&&"".concat(t).length>5&&t%1===0)return new Date(t);var e="".concat(t);var n=new RegExp(/^\d{1,2}[./-]\d{1,2}[./-](-*\d{1,4})$/g).exec(e),i=new RegExp(/^[A-z]{1,3} [A-z]{1,3} \d{1,2} (-*\d{1,4}) \d{1,2}:\d{1,2}:\d{1,2} [A-z]{1,3}-*\d{1,4} \([A-z]{1,3}\)/g).exec(e);if(n){var a=n[1];if(a.indexOf("-")===0)e=e.replace(a,a.substr(1));var r=new Date(e);r.setFullYear(a);return r}else if(i){var o=i[1];if(o.indexOf("-")===0)e=e.replace(o,o.substr(1));var s=new Date(e);s.setFullYear(o);return s}else if(!e.includes("/")&&!e.includes(" ")&&(!e.includes("-")||!e.indexOf("-"))){var l=new Date("".concat(e,"/01/01"));l.setFullYear(t);return l}else return new Date(e)}var dO={"de-DE":{dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},"en-GB":{dateTime:"%a %e %b %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"en-US":{dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"es-ES":{dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],shortDays:["dom","lun","mar","mi","jue","vie","sb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},"es-MX":{dateTime:"%x, %X",date:"%d/%m/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],shortDays:["dom","lun","mar","mi","jue","vie","sb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},"fr-FR":{dateTime:"%A, le %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],months:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],shortMonths:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."]},"it-IT":{dateTime:"%A %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato"],shortDays:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],shortMonths:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"]},"pt-BR":{dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Tera","Quarta","Quinta","Sexta","Sbado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}};function gO(t,e,n){if(e in t){Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true})}else{t[e]=n}return t}function pO(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){pO=function t(e){return ie(e)}}else{pO=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return pO(t)}function vO(t){return yO(t)||_O(t)||mO()}function mO(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _O(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function yO(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++){n[e]=t[e]}return n}}function bO(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function wO(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function xO(t,e,n){if(e)wO(t.prototype,e);if(n)wO(t,n);return t}function kO(t,e){if(e&&(pO(e)==="object"||typeof e==="function")){return e}return SO(t)}function SO(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function CO(t){CO=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return CO(t)}function AO(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)EO(t,e)}function EO(t,e){EO=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return EO(t,e)}var MO=function(t){AO(e,t);function e(){var n;bO(this,e);n=kO(this,CO(e).call(this));n._align="middle";n._barConfig={stroke:"#000","stroke-width":1};n._domain=[0,10];n._duration=600;n._gridConfig={stroke:"#ccc","stroke-width":1};n._gridLog=false;n._height=400;n._labelOffset=true;n.orient("bottom");n._outerBounds={width:0,height:0,x:0,y:0};n._padding=5;n._paddingInner=.1;n._paddingOuter=.1;n._rotateLabels=false;n._scale="linear";n._scalePadding=.5;n._shape="Line";n._shapeConfig={fill:"#000",height:function t(e){return e.tick?8:0},label:function t(e){return e.text},labelBounds:function t(e){return e.labelBounds},labelConfig:{fontColor:"#000",fontFamily:(new pC).fontFamily(),fontResize:false,fontSize:Oc(10),padding:0,textAnchor:function t(){var e=jS();return n._orient==="left"?e?"start":"end":n._orient==="right"?e?"end":"start":n._rotateLabels?n._orient==="bottom"?"end":"start":"middle"},verticalAlign:function t(){return n._orient==="bottom"?"top":n._orient==="top"?"bottom":"middle"}},r:function t(e){return e.tick?4:0},stroke:"#000",strokeWidth:1,width:function t(e){return e.tick?8:0}};n._tickSize=5;n._tickSpecifier=undefined;n._tickSuffix="normal";n._tickUnit=0;n._timeLocale=undefined;n._titleClass=new pC;n._titleConfig={fontSize:12,textAnchor:"middle"};n._width=400;return n}xO(e,[{key:"_barPosition",value:function t(e){var n=this._position,i=n.height,a=n.x,r=n.y,o=n.opposite,s=this._getDomain(),l=this._margin[o],u=["top","left"].includes(this._orient)?this._outerBounds[r]+this._outerBounds[i]-l:this._outerBounds[r]+l;var h=this._scale==="band"?this._d3Scale.step()-this._d3Scale.bandwidth():this._scale==="point"?this._d3Scale.step()*this._d3Scale.padding():0;var c=this._scale==="band"?this._d3Scale.step():this._scale==="point"?this._d3Scale.step()*this._d3Scale.padding():0;e.call(_,this._barConfig).attr("".concat(a,"1"),this._getPosition(s[0])-h).attr("".concat(a,"2"),this._getPosition(s[s.length-1])+c).attr("".concat(r,"1"),u).attr("".concat(r,"2"),u)}},{key:"_getDomain",value:function t(){var e=[];if(this._d3ScaleNegative)e=this._d3ScaleNegative.domain();if(this._d3Scale)e=e.concat(this._d3Scale.domain());var n=["band","ordinal","point"].includes(this._scale)?e:tm(e);return e[0]>e[1]?n.reverse():n}},{key:"_getPosition",value:function t(e){return e<0&&this._d3ScaleNegative?this._d3ScaleNegative(e):this._d3Scale(e)}},{key:"_getRange",value:function t(){var e=[];if(this._d3ScaleNegative)e=this._d3ScaleNegative.range();if(this._d3Scale)e=e.concat(this._d3Scale.range());return e[0]>e[1]?tm(e).reverse():tm(e)}},{key:"_getTicks",value:function t(){var e=W_().domain([10,400]).range([10,50]);var n=[];if(this._d3ScaleNegative){var i=this._d3ScaleNegative.range();var a=i[1]-i[0];n=this._d3ScaleNegative.ticks(Math.floor(a/e(a)))}if(this._d3Scale){var r=this._d3Scale.range();var o=r[1]-r[0];n=n.concat(this._d3Scale.ticks(Math.floor(o/e(o))))}return n}},{key:"_gridPosition",value:function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=this._position,a=i.height,r=i.x,o=i.y,s=i.opposite,l=this._margin[s],u=["top","left"].includes(this._orient)?this._outerBounds[o]+this._outerBounds[a]-l:this._outerBounds[o]+l,h=n?this._lastScale||this._getPosition.bind(this):this._getPosition.bind(this),c=["top","left"].includes(this._orient)?l:-l,f=this._scale==="band"?this._d3Scale.bandwidth()/2:0,d=function t(e){return h(e.id)+f};e.call(_,this._gridConfig).attr("".concat(r,"1"),d).attr("".concat(r,"2"),d).attr("".concat(o,"1"),u).attr("".concat(o,"2"),n?u:u+c)}},{key:"render",value:function t(e){var d=this,n;if(this._select===void 0){this.select(Sd("body").append("svg").attr("width","".concat(this._width,"px")).attr("height","".concat(this._height,"px")).node())}var i=this._timeLocale||dO[this._locale]||dO["en-US"];Jb(i).format();var c=qb("%a %d"),f=qb("%I %p"),g=qb(".%L"),p=qb("%I:%M"),v=qb("%b"),m=qb(":%S"),_=qb("%b %d"),y=qb("%Y");var a=this._position,r=a.width,b=a.height,w=a.x,x=a.y,k=a.horizontal,S=a.opposite,o="d3plus-Axis-clip-".concat(this._uuid),C=["top","left"].includes(this._orient),A=this._padding,s=this._select,E=[A,this["_".concat(r)]-A],l=Lv().duration(this._duration);var u=this._shape==="Circle"?this._shapeConfig.r:this._shape==="Rect"?this._shapeConfig[r]:this._shapeConfig.strokeWidth;var M=typeof u!=="function"?function(){return u}:u;var R=this._margin={top:0,right:0,bottom:0,left:0};var T,B,O;function h(){var a=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._range;B=t?t.slice():[undefined,undefined];var e=E[0],n=E[1];if(this._range){if(this._range[0]!==undefined)e=this._range[0];if(this._range[this._range.length-1]!==undefined)n=this._range[this._range.length-1]}if(B[0]===undefined||B[0]<e)B[0]=e;if(B[1]===undefined||B[1]>n)B[1]=n;var i=n-e;if(this._scale==="ordinal"&&this._domain.length>B.length){if(t===this._range){var r=this._domain.length+1;B=em(r).map(function(t){return B[0]+i*(t/(r-1))}).slice(1,r);B=B.map(function(t){return t-B[0]/2})}else{var o=this._domain.length;var s=B[1]-B[0];B=em(o).map(function(t){return B[0]+s*(t/(o-1))})}}else if(t===this._range){var l=W_().domain([10,400]).range([10,50]);var u=this._scale==="time"?this._domain.map(fO):this._domain;var h=rm(u[0],u[1],Math.floor(i/l(i)));O=(this._ticks?this._scale==="time"?this._ticks.map(fO):this._ticks:h).slice();T=(this._labels?this._scale==="time"?this._labels.map(fO):this._labels:h).slice();var c=T.length;if(c){var f=Math.ceil(i/c/2);B=[B[0]+f,B[1]-f]}}this._d3Scale=Sw["scale".concat(this._scale.charAt(0).toUpperCase()).concat(this._scale.slice(1))]().domain(this._scale==="time"?this._domain.map(fO):this._domain);if(this._d3Scale.round)this._d3Scale.round(true);if(this._d3Scale.padding)this._d3Scale.padding(this._scalePadding);if(this._d3Scale.paddingInner)this._d3Scale.paddingInner(this._paddingInner);if(this._d3Scale.paddingOuter)this._d3Scale.paddingOuter(this._paddingOuter);if(this._d3Scale.rangeRound)this._d3Scale.rangeRound(B);else this._d3Scale.range(B);this._d3ScaleNegative=null;if(this._scale==="log"){var d=this._d3Scale.domain();if(d[0]===0)d[0]=1;if(d[d.length-1]===0)d[d.length-1]=-1;var g=this._d3Scale.range();if(d[0]<0&&d[d.length-1]<0){this._d3ScaleNegative=this._d3Scale.copy().domain(d).range(g);this._d3Scale=null}else if(d[0]>0&&d[d.length-1]>0){this._d3Scale.domain(d).range(g)}else{var p=N_().domain([1,d[d[1]>0?1:0]]).range([0,1]);var v=p(Math.abs(d[d[1]<0?1:0]));var m=v/(v+1)*(g[1]-g[0]);if(d[0]>0)m=g[1]-g[0]-m;this._d3ScaleNegative=this._d3Scale.copy();(d[0]<0?this._d3Scale:this._d3ScaleNegative).domain([Math.sign(d[1]),d[1]]).range([g[0]+m,g[1]]);(d[0]<0?this._d3ScaleNegative:this._d3Scale).domain([d[0],Math.sign(d[0])]).range([g[0],g[0]+m])}}O=(this._ticks?this._scale==="time"?this._ticks.map(fO):this._ticks:(this._d3Scale?this._d3Scale.ticks:this._d3ScaleNegative.ticks)?this._getTicks():this._domain).slice();T=(this._labels?this._scale==="time"?this._labels.map(fO):this._labels:(this._d3Scale?this._d3Scale.ticks:this._d3ScaleNegative.ticks)?this._getTicks():O).slice();if(this._scale==="log"){T=T.filter(function(t){return Math.abs(t).toString().charAt(0)==="1"&&(a._d3Scale?t!==-1:t!==1)})}else if(this._scale==="time"){O=O.map(Number);T=T.map(Number)}O=O.sort(function(t,e){return a._getPosition(t)-a._getPosition(e)});T=T.sort(function(t,e){return a._getPosition(t)-a._getPosition(e)});if(this._scale==="linear"&&this._tickSuffix==="smallest"){var _=T.filter(function(t){return t>=1e3});if(_.length>0){var y=Math.min.apply(Math,vO(_));var b=1;while(b&&b<7){var w=Math.pow(10,3*b);if(y/w>=1){this._tickUnit=b;b+=1}else{break}}}}var x=[];this._availableTicks=O;O.forEach(function(t,e){var n=M({id:t,tick:true},e);if(a._shape==="Circle")n*=2;var i=a._getPosition(t);if(!x.length||Math.abs(Rc(i,x)-i)>n*2)x.push(i);else x.push(false)});O=O.filter(function(t,e){return x[e]!==false});this._visibleTicks=O}h.bind(this)();function P(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var n=t.i,i=t.position;if(this._scale==="band"){return this._d3Scale.bandwidth()}else{var a=n-e<0?U.length===1||!this._range?E[0]:(i-U[n+e].position)/2-i:i-(i-U[n-e].position)/2;var r=Math.abs(i-a);var o=n+e>U.length-1?U.length===1||!this._range?E[1]:(i-U[n-e].position)/2-i:i-(i-U[n+e].position)/2;var s=Math.abs(i-o);return fm([r,s])*2}}var D=this._tickFormat?this._tickFormat:function(t){if(d._scale==="log"){var e=Math.round(Math.log(Math.abs(t))/Math.LN10);var n=Math.abs(t).toString().charAt(0);var i="10 ".concat("".concat(e).split("").map(function(t){return""[t]}).join(""));if(n!=="1")i="".concat(n," x ").concat(i);return t<0?"-".concat(i):i}else if(d._scale==="time"){return(ay(t)<t?g:ry(t)<t?m:oy(t)<t?p:sy(t)<t?f:vy(t)<t?uy(t)<t?c:_:my(t)<t?v:y)(t)}else if(["band","ordinal","point"].includes(d._scale)){return t}var a=d._d3Scale.tickFormat?d._d3Scale.tickFormat(T.length-1)(t):t;a=typeof a==="string"?a.replace(/[^\d\.\-\+]/g,"")*1:a;if(isNaN(a)){return a}else if(d._scale==="linear"&&d._tickSuffix==="smallest"){var r=pO(d._locale)==="object"?d._locale:LT[d._locale];var o=r.separator,s=r.suffixes;var l=a>=1e3?s[d._tickUnit+8]:"";var u=a/Math.pow(10,3*d._tickUnit);var h=UT(u,r,",.".concat(u.toString().length,"r"));return"".concat(h).concat(o).concat(l)}else{return UT(a,d._locale)}};if(this._title){var N=this._titleConfig,z=N.fontFamily,F=N.fontSize,L=N.lineHeight;var j=aC().fontFamily(typeof z==="function"?z():z).fontSize(typeof F==="function"?F():F).lineHeight(typeof L==="function"?L():L).width(B[B.length-1]-B[0]-A*2).height(this["_".concat(b)]-this._tickSize-A*2);var I=j(this._title).lines.length;R[this._orient]=I*j.lineHeight()+A}var H=this._shape==="Circle"?typeof this._shapeConfig.r==="function"?this._shapeConfig.r({tick:true}):this._shapeConfig.r:this._shape==="Rect"?typeof this._shapeConfig[b]==="function"?this._shapeConfig[b]({tick:true}):this._shapeConfig[b]:this._tickSize,V=M({tick:true});if(typeof H==="function")H=um(O.map(H));if(this._shape==="Rect")H/=2;if(typeof V==="function")V=um(O.map(V));if(this._shape!=="Circle")V/=2;var U=T.map(function(t,e){var n=d._shapeConfig.labelConfig.fontFamily(t,e),i=d._shapeConfig.labelConfig.fontSize(t,e),a=d._getPosition(t);var r=d._shapeConfig.lineHeight?d._shapeConfig.lineHeight(t,e):i*1.4;return{d:t,i:e,fF:n,fS:i,lineHeight:r,position:a}});function G(t){var e=t.d,n=t.i,i=t.fF,a=t.fS,r=t.rotate,o=t.space;var s=r?"width":"height",l=r?"height":"width";var u=fm([this._maxSize,this._width]);var h=fm([this._maxSize,this._height]);var c=aC().fontFamily(i).fontSize(a).lineHeight(this._shapeConfig.lineHeight?this._shapeConfig.lineHeight(e,n):undefined)[l](k?o:u-H-A-this._margin.left-this._margin.right)[s](k?h-H-A-this._margin.top-this._margin.bottom:o);var f=c(D(e));f.lines=f.lines.filter(function(t){return t!==""});f.width=f.lines.length?Math.ceil(um(f.widths))+a/4:0;if(f.width%2)f.width++;f.height=f.lines.length?Math.ceil(f.lines.length*c.lineHeight())+a/4:0;if(f.height%2)f.height++;return f}U=U.map(function(t){t.rotate=d._labelRotation;t.space=P.bind(d)(t);var e=G.bind(d)(t);return Object.assign(e,t)});this._rotateLabels=k&&this._labelRotation===undefined?U.some(function(t){return t.truncated}):this._labelRotation;if(this._rotateLabels){U=U.map(function(t){t.rotate=true;var e=G.bind(d)(t);return Object.assign(t,e)})}var W=[0,0];for(var K=0;K<2;K++){var q=U[K?U.length-1:0];if(!q)break;var Y=q.height,X=q.position,Z=q.rotate,J=q.width;var $=K?E[1]:E[0];var Q=(Z||!k?Y:J)/2;var tt=K?X+Q-$:X-Q-$;W[K]=tt}var et=B[0];var nt=B[B.length-1];var it=[et-W[0],nt-W[1]];if(this._range){if(this._range[0]!==undefined)it[0]=this._range[0];if(this._range[this._range.length-1]!==undefined)it[1]=this._range[this._range.length-1]}if(it[0]!==et||it[1]!==nt){h.bind(this)(it);U=T.map(function(t,e){var n=d._shapeConfig.labelConfig.fontFamily(t,e),i=d._shapeConfig.labelConfig.fontSize(t,e),a=d._getPosition(t);var r=d._shapeConfig.lineHeight?d._shapeConfig.lineHeight(t,e):i*1.4;return{d:t,i:e,fF:n,fS:i,lineHeight:r,position:a}});U=U.map(function(t){t.rotate=d._rotateLabels;t.space=P.bind(d)(t);var e=G.bind(d)(t);return Object.assign(e,t)})}var at=um(U,function(t){return t.height})||0;this._rotateLabels=k&&this._labelRotation===undefined?U.some(function(t){var e=t.i,n=t.height,i=t.position,a=t.truncated;var r=U[e-1];return a||e&&r.position+r.height/2>i-n/2}):this._labelRotation;if(this._rotateLabels){var rt=0;U=U.map(function(t){t.space=P.bind(d)(t,2);var e=G.bind(d)(t);t=Object.assign(t,e);var n=U[t.i-1];if(!n){rt=1}else if(n.position+n.height/2>t.position){if(rt){t.offset=n.width;rt=0}else rt=1}return t})}var ot=this._labelOffset?um(U,function(t){return t.offset||0}):0;U.forEach(function(t){return t.offset=t.offset?ot:0});var st=this._shape==="Line"?0:H;var lt=this._outerBounds=(n={},gO(n,b,(um(U,function(t){return Math.ceil(t[t.rotate||!k?"width":"height"]+t.offset)})||0)+(U.length?A:0)),gO(n,r,E[E.length-1]-E[0]),gO(n,w,E[0]),n);lt[b]=um([this._minSize,lt[b]]);R[this._orient]+=H;R[S]=this._gridSize!==undefined?um([this._gridSize,st]):this["_".concat(b)]-R[this._orient]-lt[b]-A;lt[b]+=R[S]+R[this._orient];lt[x]=this._align==="start"?this._padding:this._align==="end"?this["_".concat(b)]-lt[b]-this._padding:this["_".concat(b)]/2-lt[b]/2;var ut=Wv("g#d3plus-Axis-".concat(this._uuid),{parent:s});this._group=ut;var ht=Wv("g.grid",{parent:ut}).selectAll("line").data((this._gridSize!==0?this._grid||this._scale==="log"&&!this._gridLog?T:O:[]).map(function(t){return{id:t}}),function(t){return t.id});ht.exit().transition(l).attr("opacity",0).call(this._gridPosition.bind(this)).remove();ht.enter().append("line").attr("opacity",0).attr("clip-path","url(#".concat(o,")")).call(this._gridPosition.bind(this),true).merge(ht).transition(l).attr("opacity",1).call(this._gridPosition.bind(this));var ct=T.filter(function(t,e){return U[e].lines.length&&!O.includes(t)});var ft=U.some(function(t){return t.rotate});var dt=O.concat(ct).map(function(e){var t;var n=U.find(function(t){return t.d===e});var i=d._getPosition(e);var a=n?n.space:0;var r=n?n.lines.length:1;var o=n?n.lineHeight:1;var s=n&&d._labelOffset?n.offset:0;var l=k?a:lt.width-R[d._position.opposite]-H-R[d._orient]+A;var u=R[S],h=(H+s)*(C?-1:1),c=C?lt[x]+lt[b]-u:lt[x]+u;var f=(t={id:e,labelBounds:ft&&n?{x:-n.width/2+n.fS/4,y:d._orient==="bottom"?h+A+(n.width-o*r)/2:h-A*2-(n.width+o*r)/2,width:n.width,height:n.height}:{x:k?-a/2:d._orient==="left"?-l-A+h:h+A,y:k?d._orient==="bottom"?h+A:h-A-at:-a/2,width:k?a:l,height:k?at:a},rotate:n?n.rotate:false,size:T.includes(e)?h:0,text:T.includes(e)?D(e):false,tick:O.includes(e)},gO(t,w,i+(d._scale==="band"?d._d3Scale.bandwidth()/2:0)),gO(t,x,c),t);return f});if(this._shape==="Line"){dt=dt.concat(dt.map(function(t){var e=Object.assign({},t);e[x]+=t.size;return e}))}(new lM[this._shape]).data(dt).duration(this._duration).labelConfig({ellipsis:function t(e){return e&&e.length?"".concat(e,"..."):""},rotate:function t(e){return e.rotate?-90:0}}).select(Wv("g.ticks",{parent:ut}).node()).config(this._shapeConfig).render();var gt=ut.selectAll("line.bar").data([null]);gt.enter().append("line").attr("class","bar").attr("opacity",0).call(this._barPosition.bind(this)).merge(gt).transition(l).attr("opacity",1).call(this._barPosition.bind(this));this._titleClass.data(this._title?[{text:this._title}]:[]).duration(this._duration).height(R[this._orient]).rotate(this._orient==="left"?-90:this._orient==="right"?90:0).select(Wv("g.d3plus-Axis-title",{parent:ut}).node()).text(function(t){return t.text}).verticalAlign("middle").width(B[B.length-1]-B[0]).x(k?B[0]:this._orient==="left"?lt.x+R.left/2-(B[B.length-1]-B[0])/2:lt.x+lt.width-R.right/2-(B[B.length-1]-B[0])/2).y(k?this._orient==="bottom"?lt.y+lt.height-R.bottom:lt.y:B[0]+(B[B.length-1]-B[0])/2-R[this._orient]/2).config(this._titleConfig).render();this._lastScale=this._getPosition.bind(this);if(e)setTimeout(e,this._duration+100);return this}},{key:"align",value:function t(e){return arguments.length?(this._align=e,this):this._align}},{key:"barConfig",value:function t(e){return arguments.length?(this._barConfig=Object.assign(this._barConfig,e),this):this._barConfig}},{key:"domain",value:function t(e){return arguments.length?(this._domain=e,this):this._domain}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"grid",value:function t(e){return arguments.length?(this._grid=e,this):this._grid}},{key:"gridConfig",value:function t(e){return arguments.length?(this._gridConfig=Object.assign(this._gridConfig,e),this):this._gridConfig}},{key:"gridLog",value:function t(e){return arguments.length?(this._gridLog=e,this):this._gridLog}},{key:"gridSize",value:function t(e){return arguments.length?(this._gridSize=e,this):this._gridSize}},{key:"height",value:function t(e){return arguments.length?(this._height=e,this):this._height}},{key:"labels",value:function t(e){return arguments.length?(this._labels=e,this):this._labels}},{key:"labelOffset",value:function t(e){return arguments.length?(this._labelOffset=e,this):this._labelOffset}},{key:"labelRotation",value:function t(e){return arguments.length?(this._labelRotation=e,this):this._labelRotation}},{key:"maxSize",value:function t(e){return arguments.length?(this._maxSize=e,this):this._maxSize}},{key:"minSize",value:function t(e){return arguments.length?(this._minSize=e,this):this._minSize}},{key:"orient",value:function t(e){if(arguments.length){var n=["top","bottom"].includes(e),i={top:"bottom",right:"left",bottom:"top",left:"right"};this._position={horizontal:n,width:n?"width":"height",height:n?"height":"width",x:n?"x":"y",y:n?"y":"x",opposite:i[e]};return this._orient=e,this}return this._orient}},{key:"outerBounds",value:function t(){return this._outerBounds}},{key:"padding",value:function t(e){return arguments.length?(this._padding=e,this):this._padding}},{key:"paddingInner",value:function t(e){return arguments.length?(this._paddingInner=e,this):this._paddingInner}},{key:"paddingOuter",value:function t(e){return arguments.length?(this._paddingOuter=e,this):this._paddingOuter}},{key:"range",value:function t(e){return arguments.length?(this._range=e,this):this._range}},{key:"scale",value:function t(e){return arguments.length?(this._scale=e,this):this._scale}},{key:"scalePadding",value:function t(e){return arguments.length?(this._scalePadding=e,this):this._scalePadding}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"shape",value:function t(e){return arguments.length?(this._shape=e,this):this._shape}},{key:"shapeConfig",value:function t(e){return arguments.length?(this._shapeConfig=gt(this._shapeConfig,e),this):this._shapeConfig}},{key:"tickFormat",value:function t(e){return arguments.length?(this._tickFormat=e,this):this._tickFormat}},{key:"ticks",value:function t(e){return arguments.length?(this._ticks=e,this):this._ticks}},{key:"tickSize",value:function t(e){return arguments.length?(this._tickSize=e,this):this._tickSize}},{key:"tickSpecifier",value:function t(e){return arguments.length?(this._tickSpecifier=e,this):this._tickSpecifier}},{key:"tickSuffix",value:function t(e){return arguments.length?(this._tickSuffix=e,this):this._tickSuffix}},{key:"timeLocale",value:function t(e){return arguments.length?(this._timeLocale=e,this):this._timeLocale}},{key:"title",value:function t(e){return arguments.length?(this._title=e,this):this._title}},{key:"titleConfig",value:function t(e){return arguments.length?(this._titleConfig=Object.assign(this._titleConfig,e),this):this._titleConfig}},{key:"width",value:function t(e){return arguments.length?(this._width=e,this):this._width}}]);return e}(Mc);function RO(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){RO=function t(e){return ie(e)}}else{RO=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return RO(t)}function TO(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function BO(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function OO(t,e,n){if(e)BO(t.prototype,e);if(n)BO(t,n);return t}function PO(t,e){if(e&&(RO(e)==="object"||typeof e==="function")){return e}return DO(t)}function DO(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function NO(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){NO=Reflect.get}else{NO=function t(e,n,i){var a=zO(e,n);if(!a)return;var r=Object.getOwnPropertyDescriptor(a,n);if(r.get){return r.get.call(i)}return r.value}}return NO(t,e,n||t)}function zO(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=FO(t);if(t===null)break}return t}function FO(t){FO=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return FO(t)}function LO(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)jO(t,e)}function jO(t,e){jO=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return jO(t,e)}var IO=function(t){LO(m,t);function m(){var n;TO(this,m);n=PO(this,FO(m).call(this));n._barConfig=Object.assign({},n._barConfig,{"stroke-width":function t(){return n._buttonBehaviorCurrent==="buttons"?0:1}});n._brushing=true;n._brushFilter=function(){return!ld.button&&ld.detail<2};n._buttonAlign="middle";n._buttonBehavior="auto";n._buttonPadding=10;n._buttonHeight=30;n._domain=[2001,2010];n._gridSize=0;n._handleConfig={fill:"#444"};n._handleSize=6;n._height=100;n._labelOffset=false;n._on={};n.orient("bottom");n._scale="time";n._selectionConfig={fill:"#777","stroke-width":0};n._shape="Rect";n._shapeConfig=Object.assign({},n._shapeConfig,{labelBounds:function t(e){return n._buttonBehaviorCurrent==="buttons"?{x:e.labelBounds.x,y:-5,width:e.labelBounds.width,height:n._buttonHeight}:e.labelBounds},fill:function t(){return n._buttonBehaviorCurrent==="buttons"?"#EEE":"#444"},height:function t(e){return n._buttonBehaviorCurrent==="buttons"?n._buttonHeight:e.tick?10:0},width:function t(e){return n._buttonBehaviorCurrent==="buttons"?n._ticksWidth/n._availableTicks.length:e.tick?n._domain.map(function(t){return fO(t).getTime()}).includes(e.id)?2:1:0},y:function t(e){return n._buttonBehaviorCurrent==="buttons"?n._align==="middle"?n._height/2:n._align==="start"?n._margin.top+n._buttonHeight/2:n._height-n._buttonHeight/2-n._margin.bottom:e.y}});n._snapping=true;return n}OO(m,[{key:"_brushBrush",value:function t(){if(ld.sourceEvent&&ld.sourceEvent.offsetX&&ld.selection!==null&&(!this._brushing||this._snapping)){var e=this._updateDomain();this._brushGroup.call(this._brush.move,this._updateBrushLimit(e))}this._brushStyle();if(this._on.brush)this._on.brush(this._selection)}},{key:"_brushEnd",value:function t(){if(!ld.sourceEvent)return;var e=this._updateDomain();this._brushStyle();if(this._brushing||!this._snapping)this._brushGroup.transition(this._transition).call(this._brush.move,this._updateBrushLimit(e));if(this._on.end)this._on.end(this._selection)}},{key:"_brushStart",value:function t(){if(ld.sourceEvent!==null&&(!this._brushing||this._snapping)){var e=this._updateDomain();this._brushGroup.call(this._brush.move,this._updateBrushLimit(e))}this._brushStyle();if(this._on.start)this._on.start()}},{key:"_brushStyle",value:function t(){var e=this._position.height;var n=this._shape==="Circle"?typeof this._shapeConfig.r==="function"?this._shapeConfig.r({tick:true})*2:this._shapeConfig.r:this._shape==="Rect"?typeof this._shapeConfig[e]==="function"?this._shapeConfig[e]({tick:true}):this._shapeConfig[e]:this._tickSize;var i=this._brushGroup.selectAll(".overlay").attr("cursor",this._brushing?"crosshair":"pointer");var a=this._brushGroup.selectAll(".selection").call(_,this._selectionConfig).attr("height",n);var r=this._brushGroup.selectAll(".handle").call(_,this._handleConfig).attr("height",this._buttonBehaviorCurrent==="buttons"?this._buttonHeight:n+this._handleSize);if(this._buttonBehaviorCurrent==="buttons"){var o=this._align==="middle"?this._height/2-this._buttonHeight/2:this._align==="start"?this._margin.top:this._height-this._buttonHeight-this._margin.bottom;r.attr("y",o);i.attr("x",this._marginLeft).attr("width",this._ticksWidth);a.attr("y",o)}}},{key:"_updateDomain",value:function t(){var e=Ed(this._select.node())[0];var n=ld.selection&&this._brushing?ld.selection:[e,e];if(this._buttonBehaviorCurrent==="ticks")n=n.map(this._d3Scale.invert);n=n.map(Number);if(ld.type==="brush"&&this._brushing&&this._buttonBehaviorCurrent==="buttons"){var i=ld.selection.map(function(t){return Math.abs(t-ld.sourceEvent.offsetX)});n=i[1]<=i[0]?[ld.selection[0],ld.sourceEvent.offsetX].sort(function(t,e){return t-e}):[ld.sourceEvent.offsetX,ld.selection[1]].sort(function(t,e){return t-e})}var a=this._buttonBehaviorCurrent==="ticks"?this._availableTicks.map(Number):this._d3Scale.range();if(this._buttonBehaviorCurrent==="ticks"){n[0]=fO(Rc(n[0],a));n[1]=fO(Rc(n[1],a))}else{n[0]=Rc(n[0],a);n[1]=Rc(n[1],a)}var r=+n[0]===+n[1];if(ld.type==="brush"||ld.type==="end"){this._selection=this._buttonBehaviorCurrent==="ticks"?r?n[0]:n:r?fO(this._availableTicks[a.indexOf(n[0])]):[fO(this._availableTicks[a.indexOf(n[0])]),fO(this._availableTicks[a.indexOf(n[1])])]}return n}},{key:"_updateBrushLimit",value:function t(e){var n=this._buttonBehaviorCurrent==="ticks"?e.map(fO).map(this._d3Scale):e;if(n[0]===n[1]){n[0]-=.1;n[1]+=.1}if(this._buttonBehaviorCurrent==="buttons"){var i=.5*(this._ticksWidth/this._availableTicks.length-this._handleSize);n[0]-=i;n[1]+=i}return n}},{key:"render",value:function t(e){var s=this;var n=this._position,i=n.height,a=n.y;if(this._buttonBehavior!=="ticks"){var l=this._ticks?this._ticks.map(fO):this._domain.map(fO);var u=lw().domain(l).range([0,this._width]);l=this._ticks?l:u.ticks();if(!this._tickFormat)this._tickFormat=u.tickFormat(l.length-1,this._tickSpecifier);var h=0;l.forEach(function(t,e){var n=s._shapeConfig.labelConfig.fontFamily(t,e),i=s._shapeConfig.labelConfig.fontSize(t,e);var a=aC().fontFamily(n).fontSize(i).lineHeight(s._shapeConfig.lineHeight?s._shapeConfig.lineHeight(t,e):undefined);var r=a(u.tickFormat(l.length-1,s._tickSpecifier)(t));var o=r.lines.length?Math.ceil(um(r.lines.map(function(t){return MS(t,{"font-family":n,"font-size":i})})))+i/4:0;if(o%2)o++;if(h<o)h=o+2*s._buttonPadding});this._ticksWidth=h*l.length}this._buttonBehaviorCurrent=this._buttonBehavior==="auto"?this._ticksWidth<this._width?"buttons":"ticks":this._buttonBehavior;if(this._buttonBehaviorCurrent==="buttons"){this._scale="ordinal";this._labelRotation=0;if(!this._brushing)this._handleSize=0;var r=lw().domain(this._domain.map(fO)).ticks().map(this._tickFormat).map(Number);this._domain=this._ticks?this._ticks.map(fO):Array.from(Array(r[r.length-1]-r[0]+1),function(t,e){return r[0]+e}).map(fO);this._ticks=this._domain;var o=.5*this._ticksWidth/this._ticks.length;this._marginLeft=this._buttonAlign==="middle"?(this._width-this._ticksWidth)/2:this._buttonAlign==="end"?this._width-this._ticksWidth:0;var c=this._buttonAlign==="middle"?(this._width+this._ticksWidth)/2:this._buttonAlign==="start"?this._ticksWidth:undefined;this._range=[this._buttonAlign==="start"?undefined:this._marginLeft+o,this._buttonAlign==="end"?undefined:c-o]}if(this._ticks)this._domain=this._buttonBehaviorCurrent==="ticks"?[this._ticks[0],this._ticks[this._ticks.length-1]]:this._ticks.map(fO);this._labels=this._ticks;NO(FO(m.prototype),"render",this).call(this,e);var f=this._outerBounds[a],d=this._d3Scale.range();var g=this._brush=lT().extent([[d[0],f],[d[d.length-1],f+this._outerBounds[i]]]).filter(this._brushFilter).handleSize(this._handleSize).on("start",this._brushStart.bind(this)).on("brush",this._brushBrush.bind(this)).on("end",this._brushEnd.bind(this));var p=this._buttonBehaviorCurrent==="ticks"?this._availableTicks[this._availableTicks.length-1]:d[d.length-1];var v=this._selection===void 0?[p,p]:this._selection instanceof Array?this._buttonBehaviorCurrent==="buttons"?this._selection.map(function(t){return d[s._ticks.map(Number).indexOf(+t)]}).slice():this._selection.slice():this._buttonBehaviorCurrent==="buttons"?[d[this._ticks.map(Number).indexOf(+this._selection)],d[this._ticks.map(Number).indexOf(+this._selection)]]:[this._selection,this._selection];this._updateBrushLimit(v);this._brushGroup=Wv("g.brushGroup",{parent:this._group});this._brushGroup.call(g).transition(this._transition).call(g.move,this._buttonBehaviorCurrent==="ticks"?this._updateBrushLimit(v):v);this._outerBounds.y-=this._handleSize/2;this._outerBounds.height+=this._handleSize/2;return this}},{key:"buttonPadding",value:function t(e){return arguments.length?(this._buttonPadding=e,this):this._buttonPadding}},{key:"brushing",value:function t(e){return arguments.length?(this._brushing=e,this):this._brushing}},{key:"brushFilter",value:function t(e){return arguments.length?(this._brushFilter=e,this):this._brushFilter}},{key:"buttonAlign",value:function t(e){return arguments.length?(this._buttonAlign=e,this):this._buttonAlign}},{key:"buttonBehavior",value:function t(e){return arguments.length?(this._buttonBehavior=e,this):this._buttonBehavior}},{key:"buttonHeight",value:function t(e){return arguments.length?(this._buttonHeight=e,this):this._buttonHeight}},{key:"handleConfig",value:function t(e){return arguments.length?(this._handleConfig=Object.assign(this._handleConfig,e),this):this._handleConfig}},{key:"handleSize",value:function t(e){return arguments.length?(this._handleSize=e,this):this._handleSize}},{key:"on",value:function t(e,n){return arguments.length===2?(this._on[e]=n,this):arguments.length?typeof e==="string"?this._on[e]:(this._on=Object.assign({},this._on,e),this):this._on}},{key:"selectionConfig",value:function t(e){return arguments.length?(this._selectionConfig=Object.assign(this._selectionConfig,e),this):this._selectionConfig}},{key:"selection",value:function t(e){return arguments.length?(this._selection=e,this):this._selection}},{key:"snapping",value:function t(e){return arguments.length?(this._snapping=e,this):this._snapping}}]);return m}(MO);
/**!
   * @fileOverview Kickass library to create and place poppers near their reference elements.
   * @version 1.16.1
   * @license
   * Copyright (c) 2016 Federico Zivolo and contributors
   *
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   *
   * The above copyright notice and this permission notice shall be included in all
   * copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
   * SOFTWARE.
   */var HO=typeof window!=="undefined"&&typeof document!=="undefined"&&typeof navigator!=="undefined";var VO=function(){var t=["Edge","Trident","Firefox"];for(var e=0;e<t.length;e+=1){if(HO&&navigator.userAgent.indexOf(t[e])>=0){return 1}}return 0}();function UO(t){var e=false;return function(){if(e){return}e=true;window.Promise.resolve().then(function(){e=false;t()})}}function GO(t){var e=false;return function(){if(!e){e=true;setTimeout(function(){e=false;t()},VO)}}}var WO=HO&&window.Promise;var KO=WO?UO:GO;function qO(t){var e={};return t&&e.toString.call(t)==="[object Function]"}function YO(t,e){if(t.nodeType!==1){return[]}var n=t.ownerDocument.defaultView;var i=n.getComputedStyle(t,null);return e?i[e]:i}function XO(t){if(t.nodeName==="HTML"){return t}return t.parentNode||t.host}function ZO(t){if(!t){return document.body}switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}var e=YO(t),n=e.overflow,i=e.overflowX,a=e.overflowY;if(/(auto|scroll|overlay)/.test(n+a+i)){return t}return ZO(XO(t))}function JO(t){return t&&t.referenceNode?t.referenceNode:t}var $O=HO&&!!(window.MSInputMethodContext&&document.documentMode);var QO=HO&&/MSIE 10/.test(navigator.userAgent);function tP(t){if(t===11){return $O}if(t===10){return QO}return $O||QO}function eP(t){if(!t){return document.documentElement}var e=tP(10)?document.body:null;var n=t.offsetParent||null;while(n===e&&t.nextElementSibling){n=(t=t.nextElementSibling).offsetParent}var i=n&&n.nodeName;if(!i||i==="BODY"||i==="HTML"){return t?t.ownerDocument.documentElement:document.documentElement}if(["TH","TD","TABLE"].indexOf(n.nodeName)!==-1&&YO(n,"position")==="static"){return eP(n)}return n}function nP(t){var e=t.nodeName;if(e==="BODY"){return false}return e==="HTML"||eP(t.firstElementChild)===t}function iP(t){if(t.parentNode!==null){return iP(t.parentNode)}return t}function aP(t,e){if(!t||!t.nodeType||!e||!e.nodeType){return document.documentElement}var n=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING;var i=n?t:e;var a=n?e:t;var r=document.createRange();r.setStart(i,0);r.setEnd(a,0);var o=r.commonAncestorContainer;if(t!==o&&e!==o||i.contains(a)){if(nP(o)){return o}return eP(o)}var s=iP(t);if(s.host){return aP(s.host,e)}else{return aP(t,iP(e).host)}}function rP(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"top";var n=e==="top"?"scrollTop":"scrollLeft";var i=t.nodeName;if(i==="BODY"||i==="HTML"){var a=t.ownerDocument.documentElement;var r=t.ownerDocument.scrollingElement||a;return r[n]}return t[n]}function oP(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var i=rP(e,"top");var a=rP(e,"left");var r=n?-1:1;t.top+=i*r;t.bottom+=i*r;t.left+=a*r;t.right+=a*r;return t}function sP(t,e){var n=e==="x"?"Left":"Top";var i=n==="Left"?"Right":"Bottom";return parseFloat(t["border"+n+"Width"])+parseFloat(t["border"+i+"Width"])}function lP(t,e,n,i){return Math.max(e["offset"+t],e["scroll"+t],n["client"+t],n["offset"+t],n["scroll"+t],tP(10)?parseInt(n["offset"+t])+parseInt(i["margin"+(t==="Height"?"Top":"Left")])+parseInt(i["margin"+(t==="Height"?"Bottom":"Right")]):0)}function uP(t){var e=t.body;var n=t.documentElement;var i=tP(10)&&getComputedStyle(n);return{height:lP("Height",e,n,i),width:lP("Width",e,n,i)}}var hP=function t(e,n){if(!(e instanceof n)){throw new TypeError("Cannot call a class as a function")}};var cP=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}return function(t,e,n){if(e)i(t.prototype,e);if(n)i(t,n);return t}}();var fP=function t(e,n,i){if(n in e){Object.defineProperty(e,n,{value:i,enumerable:true,configurable:true,writable:true})}else{e[n]=i}return e};var dP=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};function gP(t){return dP({},t,{right:t.left+t.width,bottom:t.top+t.height})}function pP(t){var e={};try{if(tP(10)){e=t.getBoundingClientRect();var n=rP(t,"top");var i=rP(t,"left");e.top+=n;e.left+=i;e.bottom+=n;e.right+=i}else{e=t.getBoundingClientRect()}}catch(t){}var a={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top};var r=t.nodeName==="HTML"?uP(t.ownerDocument):{};var o=r.width||t.clientWidth||a.width;var s=r.height||t.clientHeight||a.height;var l=t.offsetWidth-o;var u=t.offsetHeight-s;if(l||u){var h=YO(t);l-=sP(h,"x");u-=sP(h,"y");a.width-=l;a.height-=u}return gP(a)}function vP(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var i=tP(10);var a=e.nodeName==="HTML";var r=pP(t);var o=pP(e);var s=ZO(t);var l=YO(e);var u=parseFloat(l.borderTopWidth);var h=parseFloat(l.borderLeftWidth);if(n&&a){o.top=Math.max(o.top,0);o.left=Math.max(o.left,0)}var c=gP({top:r.top-o.top-u,left:r.left-o.left-h,width:r.width,height:r.height});c.marginTop=0;c.marginLeft=0;if(!i&&a){var f=parseFloat(l.marginTop);var d=parseFloat(l.marginLeft);c.top-=u-f;c.bottom-=u-f;c.left-=h-d;c.right-=h-d;c.marginTop=f;c.marginLeft=d}if(i&&!n?e.contains(s):e===s&&s.nodeName!=="BODY"){c=oP(c,e)}return c}function mP(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var n=t.ownerDocument.documentElement;var i=vP(t,n);var a=Math.max(n.clientWidth,window.innerWidth||0);var r=Math.max(n.clientHeight,window.innerHeight||0);var o=!e?rP(n):0;var s=!e?rP(n,"left"):0;var l={top:o-i.top+i.marginTop,left:s-i.left+i.marginLeft,width:a,height:r};return gP(l)}function _P(t){var e=t.nodeName;if(e==="BODY"||e==="HTML"){return false}if(YO(t,"position")==="fixed"){return true}var n=XO(t);if(!n){return false}return _P(n)}function yP(t){if(!t||!t.parentElement||tP()){return document.documentElement}var e=t.parentElement;while(e&&YO(e,"transform")==="none"){e=e.parentElement}return e||document.documentElement}function bP(t,e,n,i){var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var r={top:0,left:0};var o=a?yP(t):aP(t,JO(e));if(i==="viewport"){r=mP(o,a)}else{var s=void 0;if(i==="scrollParent"){s=ZO(XO(e));if(s.nodeName==="BODY"){s=t.ownerDocument.documentElement}}else if(i==="window"){s=t.ownerDocument.documentElement}else{s=i}var l=vP(s,o,a);if(s.nodeName==="HTML"&&!_P(o)){var u=uP(t.ownerDocument),h=u.height,c=u.width;r.top+=l.top-l.marginTop;r.bottom=h+l.top;r.left+=l.left-l.marginLeft;r.right=c+l.left}else{r=l}}n=n||0;var f=typeof n==="number";r.left+=f?n:n.left||0;r.top+=f?n:n.top||0;r.right-=f?n:n.right||0;r.bottom-=f?n:n.bottom||0;return r}function wP(t){var e=t.width,n=t.height;return e*n}function xP(t,e,i,n,a){var r=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;if(t.indexOf("auto")===-1){return t}var o=bP(i,n,r,a);var s={top:{width:o.width,height:e.top-o.top},right:{width:o.right-e.right,height:o.height},bottom:{width:o.width,height:o.bottom-e.bottom},left:{width:e.left-o.left,height:o.height}};var l=Object.keys(s).map(function(t){return dP({key:t},s[t],{area:wP(s[t])})}).sort(function(t,e){return e.area-t.area});var u=l.filter(function(t){var e=t.width,n=t.height;return e>=i.clientWidth&&n>=i.clientHeight});var h=u.length>0?u[0].key:l[0].key;var c=t.split("-")[1];return h+(c?"-"+c:"")}function kP(t,e,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var a=i?yP(e):aP(e,JO(n));return vP(n,a,i)}function SP(t){var e=t.ownerDocument.defaultView;var n=e.getComputedStyle(t);var i=parseFloat(n.marginTop||0)+parseFloat(n.marginBottom||0);var a=parseFloat(n.marginLeft||0)+parseFloat(n.marginRight||0);var r={width:t.offsetWidth+a,height:t.offsetHeight+i};return r}function CP(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(t){return e[t]})}function AP(t,e,n){n=n.split("-")[0];var i=SP(t);var a={width:i.width,height:i.height};var r=["right","left"].indexOf(n)!==-1;var o=r?"top":"left";var s=r?"left":"top";var l=r?"height":"width";var u=!r?"height":"width";a[o]=e[o]+e[l]/2-i[l]/2;if(n===s){a[s]=e[s]-i[u]}else{a[s]=e[CP(s)]}return a}function EP(t,e){if(Array.prototype.find){return t.find(e)}return t.filter(e)[0]}function MP(t,e,n){if(Array.prototype.findIndex){return t.findIndex(function(t){return t[e]===n})}var i=EP(t,function(t){return t[e]===n});return t.indexOf(i)}function RP(t,n,e){var i=e===undefined?t:t.slice(0,MP(t,"name",e));i.forEach(function(t){if(t["function"]){console.warn("`modifier.function` is deprecated, use `modifier.fn`!")}var e=t["function"]||t.fn;if(t.enabled&&qO(e)){n.offsets.popper=gP(n.offsets.popper);n.offsets.reference=gP(n.offsets.reference);n=e(n,t)}});return n}function TP(){if(this.state.isDestroyed){return}var t={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:false,offsets:{}};t.offsets.reference=kP(this.state,this.popper,this.reference,this.options.positionFixed);t.placement=xP(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding);t.originalPlacement=t.placement;t.positionFixed=this.options.positionFixed;t.offsets.popper=AP(this.popper,t.offsets.reference,t.placement);t.offsets.popper.position=this.options.positionFixed?"fixed":"absolute";t=RP(this.modifiers,t);if(!this.state.isCreated){this.state.isCreated=true;this.options.onCreate(t)}else{this.options.onUpdate(t)}}function BP(t,i){return t.some(function(t){var e=t.name,n=t.enabled;return n&&e===i})}function OP(t){var e=[false,"ms","Webkit","Moz","O"];var n=t.charAt(0).toUpperCase()+t.slice(1);for(var i=0;i<e.length;i++){var a=e[i];var r=a?""+a+n:t;if(typeof document.body.style[r]!=="undefined"){return r}}return null}function PP(){this.state.isDestroyed=true;if(BP(this.modifiers,"applyStyle")){this.popper.removeAttribute("x-placement");this.popper.style.position="";this.popper.style.top="";this.popper.style.left="";this.popper.style.right="";this.popper.style.bottom="";this.popper.style.willChange="";this.popper.style[OP("transform")]=""}this.disableEventListeners();if(this.options.removeOnDestroy){this.popper.parentNode.removeChild(this.popper)}return this}function DP(t){var e=t.ownerDocument;return e?e.defaultView:window}function NP(t,e,n,i){var a=t.nodeName==="BODY";var r=a?t.ownerDocument.defaultView:t;r.addEventListener(e,n,{passive:true});if(!a){NP(ZO(r.parentNode),e,n,i)}i.push(r)}function zP(t,e,n,i){n.updateBound=i;DP(t).addEventListener("resize",n.updateBound,{passive:true});var a=ZO(t);NP(a,"scroll",n.updateBound,n.scrollParents);n.scrollElement=a;n.eventsEnabled=true;return n}function FP(){if(!this.state.eventsEnabled){this.state=zP(this.reference,this.options,this.state,this.scheduleUpdate)}}function LP(t,e){DP(t).removeEventListener("resize",e.updateBound);e.scrollParents.forEach(function(t){t.removeEventListener("scroll",e.updateBound)});e.updateBound=null;e.scrollParents=[];e.scrollElement=null;e.eventsEnabled=false;return e}function jP(){if(this.state.eventsEnabled){cancelAnimationFrame(this.scheduleUpdate);this.state=LP(this.reference,this.state)}}function IP(t){return t!==""&&!isNaN(parseFloat(t))&&isFinite(t)}function HP(n,i){Object.keys(i).forEach(function(t){var e="";if(["width","height","top","right","bottom","left"].indexOf(t)!==-1&&IP(i[t])){e="px"}n.style[t]=i[t]+e})}function VP(n,i){Object.keys(i).forEach(function(t){var e=i[t];if(e!==false){n.setAttribute(t,i[t])}else{n.removeAttribute(t)}})}function UP(t){HP(t.instance.popper,t.styles);VP(t.instance.popper,t.attributes);if(t.arrowElement&&Object.keys(t.arrowStyles).length){HP(t.arrowElement,t.arrowStyles)}return t}function GP(t,e,n,i,a){var r=kP(a,e,t,n.positionFixed);var o=xP(n.placement,r,e,t,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);e.setAttribute("x-placement",o);HP(e,{position:n.positionFixed?"fixed":"absolute"});return n}function WP(t,e){var n=t.offsets,i=n.popper,a=n.reference;var r=Math.round,o=Math.floor;var s=function t(e){return e};var l=r(a.width);var u=r(i.width);var h=["left","right"].indexOf(t.placement)!==-1;var c=t.placement.indexOf("-")!==-1;var f=l%2===u%2;var d=l%2===1&&u%2===1;var g=!e?s:h||c||f?r:o;var p=!e?s:r;return{left:g(d&&!c&&e?i.left-1:i.left),top:p(i.top),bottom:p(i.bottom),right:g(i.right)}}var KP=HO&&/Firefox/i.test(navigator.userAgent);function qP(t,e){var n=e.x,i=e.y;var a=t.offsets.popper;var r=EP(t.instance.modifiers,function(t){return t.name==="applyStyle"}).gpuAcceleration;if(r!==undefined){console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!")}var o=r!==undefined?r:e.gpuAcceleration;var s=eP(t.instance.popper);var l=pP(s);var u={position:a.position};var h=WP(t,window.devicePixelRatio<2||!KP);var c=n==="bottom"?"top":"bottom";var f=i==="right"?"left":"right";var d=OP("transform");var g=void 0,p=void 0;if(c==="bottom"){if(s.nodeName==="HTML"){p=-s.clientHeight+h.bottom}else{p=-l.height+h.bottom}}else{p=h.top}if(f==="right"){if(s.nodeName==="HTML"){g=-s.clientWidth+h.right}else{g=-l.width+h.right}}else{g=h.left}if(o&&d){u[d]="translate3d("+g+"px, "+p+"px, 0)";u[c]=0;u[f]=0;u.willChange="transform"}else{var v=c==="bottom"?-1:1;var m=f==="right"?-1:1;u[c]=p*v;u[f]=g*m;u.willChange=c+", "+f}var _={"x-placement":t.placement};t.attributes=dP({},_,t.attributes);t.styles=dP({},u,t.styles);t.arrowStyles=dP({},t.offsets.arrow,t.arrowStyles);return t}function YP(t,n,e){var i=EP(t,function(t){var e=t.name;return e===n});var a=!!i&&t.some(function(t){return t.name===e&&t.enabled&&t.order<i.order});if(!a){var r="`"+n+"`";var o="`"+e+"`";console.warn(o+" modifier is required by "+r+" modifier in order to work, be sure to include it before "+r+"!")}return a}function XP(t,e){var n;if(!YP(t.instance.modifiers,"arrow","keepTogether")){return t}var i=e.element;if(typeof i==="string"){i=t.instance.popper.querySelector(i);if(!i){return t}}else{if(!t.instance.popper.contains(i)){console.warn("WARNING: `arrow.element` must be child of its popper element!");return t}}var a=t.placement.split("-")[0];var r=t.offsets,o=r.popper,s=r.reference;var l=["left","right"].indexOf(a)!==-1;var u=l?"height":"width";var h=l?"Top":"Left";var c=h.toLowerCase();var f=l?"left":"top";var d=l?"bottom":"right";var g=SP(i)[u];if(s[d]-g<o[c]){t.offsets.popper[c]-=o[c]-(s[d]-g)}if(s[c]+g>o[d]){t.offsets.popper[c]+=s[c]+g-o[d]}t.offsets.popper=gP(t.offsets.popper);var p=s[c]+s[u]/2-g/2;var v=YO(t.instance.popper);var m=parseFloat(v["margin"+h]);var _=parseFloat(v["border"+h+"Width"]);var y=p-t.offsets.popper[c]-m-_;y=Math.max(Math.min(o[u]-g,y),0);t.arrowElement=i;t.offsets.arrow=(n={},fP(n,c,Math.round(y)),fP(n,f,""),n);return t}function ZP(t){if(t==="end"){return"start"}else if(t==="start"){return"end"}return t}var JP=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"];var $P=JP.slice(3);function QP(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var n=$P.indexOf(t);var i=$P.slice(n+1).concat($P.slice(0,n));return e?i.reverse():i}var tD={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function eD(p,v){if(BP(p.instance.modifiers,"inner")){return p}if(p.flipped&&p.placement===p.originalPlacement){return p}var m=bP(p.instance.popper,p.instance.reference,v.padding,v.boundariesElement,p.positionFixed);var _=p.placement.split("-")[0];var y=CP(_);var b=p.placement.split("-")[1]||"";var w=[];switch(v.behavior){case tD.FLIP:w=[_,y];break;case tD.CLOCKWISE:w=QP(_);break;case tD.COUNTERCLOCKWISE:w=QP(_,true);break;default:w=v.behavior}w.forEach(function(t,e){if(_!==t||w.length===e+1){return p}_=p.placement.split("-")[0];y=CP(_);var n=p.offsets.popper;var i=p.offsets.reference;var a=Math.floor;var r=_==="left"&&a(n.right)>a(i.left)||_==="right"&&a(n.left)<a(i.right)||_==="top"&&a(n.bottom)>a(i.top)||_==="bottom"&&a(n.top)<a(i.bottom);var o=a(n.left)<a(m.left);var s=a(n.right)>a(m.right);var l=a(n.top)<a(m.top);var u=a(n.bottom)>a(m.bottom);var h=_==="left"&&o||_==="right"&&s||_==="top"&&l||_==="bottom"&&u;var c=["top","bottom"].indexOf(_)!==-1;var f=!!v.flipVariations&&(c&&b==="start"&&o||c&&b==="end"&&s||!c&&b==="start"&&l||!c&&b==="end"&&u);var d=!!v.flipVariationsByContent&&(c&&b==="start"&&s||c&&b==="end"&&o||!c&&b==="start"&&u||!c&&b==="end"&&l);var g=f||d;if(r||h||g){p.flipped=true;if(r||h){_=w[e+1]}if(g){b=ZP(b)}p.placement=_+(b?"-"+b:"");p.offsets.popper=dP({},p.offsets.popper,AP(p.instance.popper,p.offsets.reference,p.placement));p=RP(p.instance.modifiers,p,"flip")}});return p}function nD(t){var e=t.offsets,n=e.popper,i=e.reference;var a=t.placement.split("-")[0];var r=Math.floor;var o=["top","bottom"].indexOf(a)!==-1;var s=o?"right":"bottom";var l=o?"left":"top";var u=o?"width":"height";if(n[s]<r(i[l])){t.offsets.popper[l]=r(i[l])-n[u]}if(n[l]>r(i[s])){t.offsets.popper[l]=r(i[s])}return t}function iD(t,e,n,i){var a=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/);var r=+a[1];var o=a[2];if(!r){return t}if(o.indexOf("%")===0){var s=void 0;switch(o){case"%p":s=n;break;case"%":case"%r":default:s=i}var l=gP(s);return l[e]/100*r}else if(o==="vh"||o==="vw"){var u=void 0;if(o==="vh"){u=Math.max(document.documentElement.clientHeight,window.innerHeight||0)}else{u=Math.max(document.documentElement.clientWidth,window.innerWidth||0)}return u/100*r}else{return r}}function aD(t,a,r,e){var o=[0,0];var s=["right","left"].indexOf(e)!==-1;var n=t.split(/(\+|\-)/).map(function(t){return t.trim()});var i=n.indexOf(EP(n,function(t){return t.search(/,|\s/)!==-1}));if(n[i]&&n[i].indexOf(",")===-1){console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.")}var l=/\s*,\s*|\s+/;var u=i!==-1?[n.slice(0,i).concat([n[i].split(l)[0]]),[n[i].split(l)[1]].concat(n.slice(i+1))]:[n];u=u.map(function(t,e){var n=(e===1?!s:s)?"height":"width";var i=false;return t.reduce(function(t,e){if(t[t.length-1]===""&&["+","-"].indexOf(e)!==-1){t[t.length-1]=e;i=true;return t}else if(i){t[t.length-1]+=e;i=false;return t}else{return t.concat(e)}},[]).map(function(t){return iD(t,n,a,r)})});u.forEach(function(n,i){n.forEach(function(t,e){if(IP(t)){o[i]+=t*(n[e-1]==="-"?-1:1)}})});return o}function rD(t,e){var n=e.offset;var i=t.placement,a=t.offsets,r=a.popper,o=a.reference;var s=i.split("-")[0];var l=void 0;if(IP(+n)){l=[+n,0]}else{l=aD(n,r,o,s)}if(s==="left"){r.top+=l[0];r.left-=l[1]}else if(s==="right"){r.top+=l[0];r.left+=l[1]}else if(s==="top"){r.left+=l[0];r.top-=l[1]}else if(s==="bottom"){r.left+=l[0];r.top+=l[1]}t.popper=r;return t}function oD(t,a){var e=a.boundariesElement||eP(t.instance.popper);if(t.instance.reference===e){e=eP(e)}var n=OP("transform");var i=t.instance.popper.style;var r=i.top,o=i.left,s=i[n];i.top="";i.left="";i[n]="";var l=bP(t.instance.popper,t.instance.reference,a.padding,e,t.positionFixed);i.top=r;i.left=o;i[n]=s;a.boundaries=l;var u=a.priority;var h=t.offsets.popper;var c={primary:function t(e){var n=h[e];if(h[e]<l[e]&&!a.escapeWithReference){n=Math.max(h[e],l[e])}return fP({},e,n)},secondary:function t(e){var n=e==="right"?"left":"top";var i=h[n];if(h[e]>l[e]&&!a.escapeWithReference){i=Math.min(h[n],l[e]-(e==="right"?h.width:h.height))}return fP({},n,i)}};u.forEach(function(t){var e=["left","top"].indexOf(t)!==-1?"primary":"secondary";h=dP({},h,c[e](t))});t.offsets.popper=h;return t}function sD(t){var e=t.placement;var n=e.split("-")[0];var i=e.split("-")[1];if(i){var a=t.offsets,r=a.reference,o=a.popper;var s=["bottom","top"].indexOf(n)!==-1;var l=s?"left":"top";var u=s?"width":"height";var h={start:fP({},l,r[l]),end:fP({},l,r[l]+r[u]-o[u])};t.offsets.popper=dP({},o,h[i])}return t}function lD(t){if(!YP(t.instance.modifiers,"hide","preventOverflow")){return t}var e=t.offsets.reference;var n=EP(t.instance.modifiers,function(t){return t.name==="preventOverflow"}).boundaries;if(e.bottom<n.top||e.left>n.right||e.top>n.bottom||e.right<n.left){if(t.hide===true){return t}t.hide=true;t.attributes["x-out-of-boundaries"]=""}else{if(t.hide===false){return t}t.hide=false;t.attributes["x-out-of-boundaries"]=false}return t}function uD(t){var e=t.placement;var n=e.split("-")[0];var i=t.offsets,a=i.popper,r=i.reference;var o=["left","right"].indexOf(n)!==-1;var s=["top","left"].indexOf(n)===-1;a[o?"left":"top"]=r[n]-(s?a[o?"width":"height"]:0);t.placement=CP(e);t.offsets.popper=gP(a);return t}var hD={shift:{order:100,enabled:true,fn:sD},offset:{order:200,enabled:true,fn:rD,offset:0},preventOverflow:{order:300,enabled:true,fn:oD,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:true,fn:nD},arrow:{order:500,enabled:true,fn:XP,element:"[x-arrow]"},flip:{order:600,enabled:true,fn:eD,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:false,flipVariationsByContent:false},inner:{order:700,enabled:false,fn:uD},hide:{order:800,enabled:true,fn:lD},computeStyle:{order:850,enabled:true,fn:qP,gpuAcceleration:true,x:"bottom",y:"right"},applyStyle:{order:900,enabled:true,fn:UP,onLoad:GP,gpuAcceleration:undefined}};var cD={placement:"bottom",positionFixed:false,eventsEnabled:true,removeOnDestroy:false,onCreate:function t(){},onUpdate:function t(){},modifiers:hD};var fD=function(){function r(t,e){var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};hP(this,r);this.scheduleUpdate=function(){return requestAnimationFrame(n.update)};this.update=KO(this.update.bind(this));this.options=dP({},r.Defaults,i);this.state={isDestroyed:false,isCreated:false,scrollParents:[]};this.reference=t&&t.jquery?t[0]:t;this.popper=e&&e.jquery?e[0]:e;this.options.modifiers={};Object.keys(dP({},r.Defaults.modifiers,i.modifiers)).forEach(function(t){n.options.modifiers[t]=dP({},r.Defaults.modifiers[t]||{},i.modifiers?i.modifiers[t]:{})});this.modifiers=Object.keys(this.options.modifiers).map(function(t){return dP({name:t},n.options.modifiers[t])}).sort(function(t,e){return t.order-e.order});this.modifiers.forEach(function(t){if(t.enabled&&qO(t.onLoad)){t.onLoad(n.reference,n.popper,n.options,t,n.state)}});this.update();var a=this.options.eventsEnabled;if(a){this.enableEventListeners()}this.state.eventsEnabled=a}cP(r,[{key:"update",value:function t(){return TP.call(this)}},{key:"destroy",value:function t(){return PP.call(this)}},{key:"enableEventListeners",value:function t(){return FP.call(this)}},{key:"disableEventListeners",value:function t(){return jP.call(this)}}]);return r}();fD.Utils=(typeof window!=="undefined"?window:global).PopperUtils;fD.placements=JP;fD.Defaults=cD;function dD(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){dD=function t(e){return ie(e)}}else{dD=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return dD(t)}function gD(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function pD(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function vD(t,e,n){if(e)pD(t.prototype,e);if(n)pD(t,n);return t}function mD(t,e){if(e&&(dD(e)==="object"||typeof e==="function")){return e}return _D(t)}function _D(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function yD(t){yD=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return yD(t)}function bD(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)wD(t,e)}function wD(t,e){wD=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return wD(t,e)}var xD=function(t){bD(e,t);function e(){var t;gD(this,e);t=mD(this,yD(e).call(this));t._arrow=g("arrow","");t._arrowStyle={content:"",background:"inherit",border:"inherit","border-width":"0 1px 1px 0",height:"10px",position:"absolute",transform:"rotate(45deg)",width:"10px","z-index":"-1"};t._background=Oc("rgba(255, 255, 255, 1)");t._body=g("body","");t._bodyStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"12px","font-weight":"400","z-index":"1"};t._border=Oc("1px solid rgba(0, 0, 0, 0.1)");t._borderRadius=Oc("2px");t._className="d3plus-tooltip";t._data=[];t._footer=g("footer","");t._footerStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"12px","font-weight":"400","z-index":"1"};t._height=Oc("auto");t._id=function(t,e){return"".concat(e)};t._offset=Oc(5);t._padding=Oc("5px");t._pointerEvents=Oc("auto");t._popperClasses={};t._position=function(t){return[t.x,t.y]};t._prefix=Rm();t._tableStyle={"border-collapse":"collapse","border-spacing":"0",width:"100%"};t._tbody=[];t._tbodyStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"12px","text-align":"center"};t._thead=[];t._theadStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"12px","font-weight":"600","text-align":"center"};t._title=g("title","");t._titleStyle={"font-family":"'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif","font-size":"14px","font-weight":"600"};t._trStyle={"border-top":"1px solid rgba(0, 0, 0, 0.1)"};t._tdStyle={};t._width=Oc("auto");return t}vD(e,[{key:"render",value:function t(e){var u=this;var h=this;var n=Sd("body").selectAll(".".concat(this._className)).data(this._data,this._id);var i=n.enter().append("div").attr("class",this._className);var r=n.merge(i);function a(a){i.append("div").attr("class","d3plus-tooltip-".concat(a)).attr("id",function(t,e){return"d3plus-tooltip-".concat(a,"-").concat(t?h._id(t,e):"")});var t=r.select(".d3plus-tooltip-".concat(a)).html(function(t,e){return h["_".concat(a)](t,e)}).style("display",function(t,e){var n=h["_".concat(a)](t,e);var i=n!==false&&n!==undefined&&n!==null;return i?"block":"none"});Tm(t,h["_".concat(a,"Style")])}function o(t){if(typeof t==="function"){var e=Sd(this.parentNode.parentNode).datum();return t(e,h._data.indexOf(e))}else return t}function s(t){t.style("background",h._background).style("".concat(h._prefix,"border-radius"),h._borderRadius).style("pointer-events",h._pointerEvents).style("padding",h._padding).style("width",h._width).style("height",h._height).style("border",function(t,e){var n=Sd(this).style("border");return n!=="0px none rgb(0, 0, 0)"?n:h._border(t,e)})}a("title");a("body");var l=i.append("table").attr("class","d3plus-tooltip-table");var c=r.select(".d3plus-tooltip-table");Tm(c,this._tableStyle);l.append("thead").attr("class","d3plus-tooltip-thead");var f=r.select(".d3plus-tooltip-thead");Tm(f,this._theadStyle);var d=f.selectAll("th").data(this._thead);d.enter().append("th").merge(d).html(o);d.exit().remove();l.append("tbody").attr("class","d3plus-tooltip-tbody");var g=r.select(".d3plus-tooltip-tbody");Tm(g,this._tbodyStyle);var p=g.selectAll("tr").data(this._tbody);var v=p.enter().append("tr");p.exit().remove();var m=p.merge(v);Tm(m,this._trStyle);var _=m.selectAll("td").data(function(t){return t});_.enter().append("td").merge(_).html(o);Tm(_,this._tdStyle);a("footer");a("arrow");i.attr("id",function(t,e){return"d3plus-tooltip-".concat(t?u._id(t,e):"")}).call(s).each(function(t,e){var n=h._id(t,e);var i=document.getElementById("d3plus-tooltip-".concat(n));var a=document.getElementById("d3plus-tooltip-arrow-".concat(n));var r=a.offsetHeight;var o=a.getBoundingClientRect().height/2;a.style.bottom="-".concat(r/2,"px");var s=h._position(t,e);var l=Array.isArray(s)?{clientWidth:0,clientHeight:0,getBoundingClientRect:function t(){return{top:s[1],right:s[0],bottom:s[1],left:s[0],width:0,height:0}}}:s;u._popperClasses[n]=new fD(l,i,{placement:"top",placements:["top","bottom","left","right"],modifiers:{arrow:{element:a},offset:{offset:"0,".concat(h._offset(t,e)+o)},preventOverflow:{boundariesElement:"scrollParent"},flip:{behavior:"flip",boundariesElement:"viewport"}},onUpdate:function t(e){var n=e.arrowElement,i=e.flipped;if(i){n.style.transform="rotate(225deg)";n.style.top="-".concat(r/2,"px")}else{n.style.transform="rotate(45deg)";n.style.bottom="-".concat(r/2,"px")}},removeOnDestroy:true})});r.each(function(t,e){var n=h._id(t,e);var i=h._position(t,e);var a=u._popperClasses[n];if(a){var r=Array.isArray(i)?{clientWidth:0,clientHeight:0,getBoundingClientRect:function t(){return{top:i[1],right:i[0],bottom:i[1],left:i[0],width:0,height:0}}}:i;a.reference=r;a.scheduleUpdate()}}).call(s);n.exit().each(function(t,e){var n=h._id(t,e);var i=u._popperClasses[n];if(i){i.destroy();delete u._popperClasses[n]}}).remove();if(e)setTimeout(e,100);return this}},{key:"arrow",value:function t(e){return arguments.length?(this._arrow=typeof e==="function"?e:Oc(e),this):this._arrow}},{key:"arrowStyle",value:function t(e){return arguments.length?(this._arrowStyle=Object.assign(this._arrowStyle,e),this):this._arrowStyle}},{key:"background",value:function t(e){return arguments.length?(this._background=typeof e==="function"?e:Oc(e),this):this._background}},{key:"body",value:function t(e){return arguments.length?(this._body=typeof e==="function"?e:Oc(e),this):this._body}},{key:"bodyStyle",value:function t(e){return arguments.length?(this._bodyStyle=Object.assign(this._bodyStyle,e),this):this._bodyStyle}},{key:"border",value:function t(e){return arguments.length?(this._border=typeof e==="function"?e:Oc(e),this):this._border}},{key:"borderRadius",value:function t(e){return arguments.length?(this._borderRadius=typeof e==="function"?e:Oc(e),this):this._borderRadius}},{key:"className",value:function t(e){return arguments.length?(this._className=e,this):this._className}},{key:"data",value:function t(e){return arguments.length?(this._data=e,this):this._data}},{key:"footer",value:function t(e){return arguments.length?(this._footer=typeof e==="function"?e:Oc(e),this):this._footer}},{key:"footerStyle",value:function t(e){return arguments.length?(this._footerStyle=Object.assign(this._footerStyle,e),this):this._footerStyle}},{key:"height",value:function t(e){return arguments.length?(this._height=typeof e==="function"?e:Oc(e),this):this._height}},{key:"id",value:function t(e){return arguments.length?(this._id=typeof e==="function"?e:Oc(e),this):this._id}},{key:"offset",value:function t(e){return arguments.length?(this._offset=typeof e==="function"?e:Oc(e),this):this._offset}},{key:"padding",value:function t(e){return arguments.length?(this._padding=typeof e==="function"?e:Oc(e),this):this._padding}},{key:"pointerEvents",value:function t(e){return arguments.length?(this._pointerEvents=typeof e==="function"?e:Oc(e),this):this._pointerEvents}},{key:"position",value:function t(e){return arguments.length?(this._position=typeof e==="string"?Oc(Sd(e).node()||[0,0]):typeof e==="function"?e:Oc(e),this):this._position}},{key:"tableStyle",value:function t(e){return arguments.length?(this._tableStyle=Object.assign(this._tableStyle,e),this):this._tableStyle}},{key:"tbody",value:function t(e){return arguments.length?(this._tbody=e,this):this._tbody}},{key:"tbodyStyle",value:function t(e){return arguments.length?(this._tbodyStyle=Object.assign(this._tbodyStyle,e),this):this._tbodyStyle}},{key:"thead",value:function t(e){return arguments.length?(this._thead=e,this):this._thead}},{key:"theadStyle",value:function t(e){return arguments.length?(this._theadStyle=Object.assign(this._theadStyle,e),this):this._theadStyle}},{key:"title",value:function t(e){return arguments.length?(this._title=typeof e==="function"?e:Oc(e),this):this._title}},{key:"titleStyle",value:function t(e){return arguments.length?(this._titleStyle=Object.assign(this._titleStyle,e),this):this._titleStyle}},{key:"trStyle",value:function t(e){return arguments.length?(this._trStyle=Object.assign(this._trStyle,e),this):this._trStyle}},{key:"tdStyle",value:function t(e){return arguments.length?(this._tdStyle=Object.assign(this._tdStyle,e),this):this._tdStyle}},{key:"width",value:function t(e){return arguments.length?(this._width=typeof e==="function"?e:Oc(e),this):this._width}}]);return e}(Mc);function kD(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function SD(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function CD(t,e,n){if(e)SD(t.prototype,e);if(n)SD(t,n);return t}var AD=function(){function t(){kD(this,t);this._isVisible=false}CD(t,[{key:"exit",value:function t(e,n){e.transition().duration(n).style("opacity",0).transition().remove();this._isVisible=false}},{key:"hide",value:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=e.duration,i=n===void 0?600:n,a=e.callback;this.mask.call(this.exit.bind(this),i);this.elem.call(this.exit.bind(this),i);if(a)setTimeout(a,i+100);this._isVisible=false;return this}},{key:"render",value:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=e.callback,i=e.container,a=i===void 0?"body":i,r=e.duration,o=r===void 0?600:r,s=e.html,l=s===void 0?"Please Wait":s,u=e.mask,h=u===void 0?"rgba(0, 0, 0, 0.05)":u,c=e.style,f=c===void 0?{}:c;var d=Sd(a).style("position","relative");this.mask=d.selectAll("div.d3plus-Mask").data(h?[h]:[]);this.mask=this.mask.enter().append("div").attr("class","d3plus-Mask").style("opacity",1).merge(this.mask);this.mask.exit().call(this.exit.bind(this),o);Tm(this.mask,{"background-color":String,bottom:"0px",left:"0px",position:"absolute",right:"0px",top:"0px"});this.elem=d.selectAll("div.d3plus-Message").data([l]);this.elem=this.elem.enter().append("div").attr("class","d3plus-Message").style("opacity",1).merge(this.elem).html(String);Tm(this.elem,f);if(n)setTimeout(n,100);this._isVisible=true;return this}}]);return t}();function ED(){var t=this._history.length;var e=Wv("g.d3plus-viz-back",{parent:this._select,transition:this._transition,update:{transform:"translate(".concat(this._margin.left,", ").concat(this._margin.top,")")}}).node();this._backClass.data(t?[{text:" ".concat(this._translate("Back")),x:0,y:0}]:[]).select(e).config(this._backConfig).render();this._margin.top+=t?this._backClass.fontSize()()+this._backClass.padding()()*2:0}function MD(){var i=this;var t=this._data;var e=this._colorScalePosition||"bottom";var n=["top","bottom"].includes(e);var a=this._colorScalePadding()?this._padding:{top:0,right:0,bottom:0,left:0};var r=this._width-(this._margin.left+this._margin.right+a.left+a.right);var o=n?fm([this._colorScaleMaxSize,r]):this._width-(this._margin.left+this._margin.right);var s=this._height-(this._margin.bottom+this._margin.top+a.bottom+a.top);var l=!n?fm([this._colorScaleMaxSize,s]):this._height-(this._margin.bottom+this._margin.top);var u={opacity:this._colorScalePosition?1:0,transform:"translate(".concat(n?this._margin.left+a.left+(r-o)/2:this._margin.left,", ").concat(n?this._margin.top:this._margin.top+a.top+(s-l)/2,")")};var h=this._colorScale&&t&&t.length>1;var c=Wv("g.d3plus-viz-colorScale",{condition:h&&!this._colorScaleConfig.select,enter:u,parent:this._select,transition:this._transition,update:u}).node();if(h){var f=t.filter(function(t,e){var n=i._colorScale(t,e);return n!==undefined&&n!==null});this._colorScaleClass.align({bottom:"end",left:"start",right:"end",top:"start"}[e]||"bottom").duration(this._duration).data(f).height(l).locale(this._locale).orient(e).select(c).value(this._colorScale).width(o).config(this._colorScaleConfig).render();var d=this._colorScaleClass.outerBounds();if(this._colorScalePosition&&!this._colorScaleConfig.select&&d.height){if(n)this._margin[e]+=d.height+this._legendClass.padding()*2;else this._margin[e]+=d.width+this._legendClass.padding()*2}}else{this._colorScaleClass.config(this._colorScaleConfig)}}var RD=zT(function(e,t){(function(t){{e.exports=t()}})(function(){return function r(o,s,l){function u(n,t){if(!s[n]){if(!o[n]){var e=typeof NT=="function"&&NT;if(!t&&e)return e(n,!0);if(h)return h(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var a=s[n]={exports:{}};o[n][0].call(a.exports,function(t){var e=o[n][1][t];return u(e?e:t)},a,a.exports,r,o,s,l)}return s[n].exports}var h=typeof NT=="function"&&NT;for(var t=0;t<l.length;t++){u(l[t])}return u}({1:[function(t,N,z){(function(D){(function(t){var e=ie(z)=="object"&&z&&!z.nodeType&&z;var n=ie(N)=="object"&&N&&!N.nodeType&&N;var i=ie(D)=="object"&&D;if(i.global===i||i.window===i||i.self===i){t=i}var a,m=2147483647,_=36,y=1,b=26,r=38,o=700,w=72,x=128,k="-",s=/^xn--/,l=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},c=_-y,S=Math.floor,C=String.fromCharCode,f;function A(t){throw new RangeError(h[t])}function d(t,e){var n=t.length;var i=[];while(n--){i[n]=e(t[n])}return i}function g(t,e){var n=t.split("@");var i="";if(n.length>1){i=n[0]+"@";t=n[1]}t=t.replace(u,".");var a=t.split(".");var r=d(a,e).join(".");return i+r}function E(t){var e=[],n=0,i=t.length,a,r;while(n<i){a=t.charCodeAt(n++);if(a>=55296&&a<=56319&&n<i){r=t.charCodeAt(n++);if((r&64512)==56320){e.push(((a&1023)<<10)+(r&1023)+65536)}else{e.push(a);n--}}else{e.push(a)}}return e}function v(t){return d(t,function(t){var e="";if(t>65535){t-=65536;e+=C(t>>>10&1023|55296);t=56320|t&1023}e+=C(t);return e}).join("")}function M(t){if(t-48<10){return t-22}if(t-65<26){return t-65}if(t-97<26){return t-97}return _}function R(t,e){return t+22+75*(t<26)-((e!=0)<<5)}function T(t,e,n){var i=0;t=n?S(t/o):t>>1;t+=S(t/e);for(;t>c*b>>1;i+=_){t=S(t/c)}return S(i+(c+1)*t/(t+r))}function p(t){var e=[],n=t.length,i,a=0,r=x,o=w,s,l,u,h,c,f,d,g,p;s=t.lastIndexOf(k);if(s<0){s=0}for(l=0;l<s;++l){if(t.charCodeAt(l)>=128){A("not-basic")}e.push(t.charCodeAt(l))}for(u=s>0?s+1:0;u<n;){for(h=a,c=1,f=_;;f+=_){if(u>=n){A("invalid-input")}d=M(t.charCodeAt(u++));if(d>=_||d>S((m-a)/c)){A("overflow")}a+=d*c;g=f<=o?y:f>=o+b?b:f-o;if(d<g){break}p=_-g;if(c>S(m/p)){A("overflow")}c*=p}i=e.length+1;o=T(a-h,i,h==0);if(S(a/i)>m-r){A("overflow")}r+=S(a/i);a%=i;e.splice(a++,0,r)}return v(e)}function B(t){var e,n,i,a,r,o,s,l,u,h,c,f=[],d,g,p,v;t=E(t);d=t.length;e=x;n=0;r=w;for(o=0;o<d;++o){c=t[o];if(c<128){f.push(C(c))}}i=a=f.length;if(a){f.push(k)}while(i<d){for(s=m,o=0;o<d;++o){c=t[o];if(c>=e&&c<s){s=c}}g=i+1;if(s-e>S((m-n)/g)){A("overflow")}n+=(s-e)*g;e=s;for(o=0;o<d;++o){c=t[o];if(c<e&&++n>m){A("overflow")}if(c==e){for(l=n,u=_;;u+=_){h=u<=r?y:u>=r+b?b:u-r;if(l<h){break}v=l-h;p=_-h;f.push(C(R(h+v%p,0)));l=S(v/p)}f.push(C(R(l,0)));r=T(n,g,i==a);n=0;++i}}++n;++e}return f.join("")}function O(t){return g(t,function(t){return s.test(t)?p(t.slice(4).toLowerCase()):t})}function P(t){return g(t,function(t){return l.test(t)?"xn--"+B(t):t})}a={version:"1.3.2",ucs2:{decode:E,encode:v},decode:p,encode:B,toASCII:P,toUnicode:O};if(e&&n){if(N.exports==e){n.exports=a}else{for(f in a){a.hasOwnProperty(f)&&(e[f]=a[f])}}}else{t.punycode=a}})(this)}).call(this,typeof DT!=="undefined"?DT:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],2:[function(t,e,n){var i=t("./log");function u(t,e,n){if(t.defaultView&&(e!==t.defaultView.pageXOffset||n!==t.defaultView.pageYOffset)){t.defaultView.scrollTo(e,n)}}function a(e,t){try{if(t){t.width=e.width;t.height=e.height;t.getContext("2d").putImageData(e.getContext("2d").getImageData(0,0,e.width,e.height),0,0)}}catch(t){i("Unable to copy canvas content from",e,t)}}function h(t,e){var n=t.nodeType===3?document.createTextNode(t.nodeValue):t.cloneNode(false);var i=t.firstChild;while(i){if(e===true||i.nodeType!==1||i.nodeName!=="SCRIPT"){n.appendChild(h(i,e))}i=i.nextSibling}if(t.nodeType===1){n._scrollTop=t.scrollTop;n._scrollLeft=t.scrollLeft;if(t.nodeName==="CANVAS"){a(t,n)}else if(t.nodeName==="TEXTAREA"||t.nodeName==="SELECT"){n.value=t.value}}return n}function c(t){if(t.nodeType===1){t.scrollTop=t._scrollTop;t.scrollLeft=t._scrollLeft;var e=t.firstChild;while(e){c(e);e=e.nextSibling}}}e.exports=function(t,e,n,i,a,r,o){var s=h(t.documentElement,a.javascriptEnabled);var l=e.createElement("iframe");l.className="html2canvas-container";l.style.visibility="hidden";l.style.position="fixed";l.style.left="-10000px";l.style.top="0px";l.style.border="0";l.width=n;l.height=i;l.scrolling="no";e.body.appendChild(l);return new Promise(function(e){var n=l.contentWindow.document;l.contentWindow.onload=l.onload=function(){var t=setInterval(function(){if(n.body.childNodes.length>0){c(n.documentElement);clearInterval(t);if(a.type==="view"){l.contentWindow.scrollTo(r,o);if(/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.contentWindow.scrollY!==o||l.contentWindow.scrollX!==r)){n.documentElement.style.top=-o+"px";n.documentElement.style.left=-r+"px";n.documentElement.style.position="absolute"}}e(l)}},50)};n.open();n.write("<!DOCTYPE html><html></html>");u(t,r,o);n.replaceChild(n.adoptNode(s),n.documentElement);n.close()})}},{"./log":13}],3:[function(t,e,n){function i(t){this.r=0;this.g=0;this.b=0;this.a=null;var e=this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}i.prototype.darken=function(t){var e=1-t;return new i([Math.round(this.r*e),Math.round(this.g*e),Math.round(this.b*e),this.a])};i.prototype.isTransparent=function(){return this.a===0};i.prototype.isBlack=function(){return this.r===0&&this.g===0&&this.b===0};i.prototype.fromArray=function(t){if(Array.isArray(t)){this.r=Math.min(t[0],255);this.g=Math.min(t[1],255);this.b=Math.min(t[2],255);if(t.length>3){this.a=t[3]}}return Array.isArray(t)};var a=/^#([a-f0-9]{3})$/i;i.prototype.hex3=function(t){var e=null;if((e=t.match(a))!==null){this.r=parseInt(e[1][0]+e[1][0],16);this.g=parseInt(e[1][1]+e[1][1],16);this.b=parseInt(e[1][2]+e[1][2],16)}return e!==null};var r=/^#([a-f0-9]{6})$/i;i.prototype.hex6=function(t){var e=null;if((e=t.match(r))!==null){this.r=parseInt(e[1].substring(0,2),16);this.g=parseInt(e[1].substring(2,4),16);this.b=parseInt(e[1].substring(4,6),16)}return e!==null};var o=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;i.prototype.rgb=function(t){var e=null;if((e=t.match(o))!==null){this.r=Number(e[1]);this.g=Number(e[2]);this.b=Number(e[3])}return e!==null};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;i.prototype.rgba=function(t){var e=null;if((e=t.match(s))!==null){this.r=Number(e[1]);this.g=Number(e[2]);this.b=Number(e[3]);this.a=Number(e[4])}return e!==null};i.prototype.toString=function(){return this.a!==null&&this.a!==1?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"};i.prototype.namedColor=function(t){t=t.toLowerCase();var e=l[t];if(e){this.r=e[0];this.g=e[1];this.b=e[2]}else if(t==="transparent"){this.r=this.g=this.b=this.a=0;return true}return!!e};i.prototype.isColor=true;var l={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};e.exports=i},{}],4:[function(t,e,n){var d=t("./support");var o=t("./renderers/canvas");var g=t("./imageloader");var p=t("./nodeparser");var i=t("./nodecontainer");var v=t("./log");var a=t("./utils");var r=t("./clone");var s=t("./proxy").loadUrlDocument;var m=a.getBounds;var c="data-html2canvas-node";var l=0;function u(t,e){var n=l++;e=e||{};if(e.logging){v.options.logging=true;v.options.start=Date.now()}e.async=typeof e.async==="undefined"?true:e.async;e.allowTaint=typeof e.allowTaint==="undefined"?false:e.allowTaint;e.removeContainer=typeof e.removeContainer==="undefined"?true:e.removeContainer;e.javascriptEnabled=typeof e.javascriptEnabled==="undefined"?false:e.javascriptEnabled;e.imageTimeout=typeof e.imageTimeout==="undefined"?1e4:e.imageTimeout;e.renderer=typeof e.renderer==="function"?e.renderer:o;e.strict=!!e.strict;if(typeof t==="string"){if(typeof e.proxy!=="string"){return Promise.reject("Proxy must be used when rendering url")}var i=e.width!=null?e.width:window.innerWidth;var a=e.height!=null?e.height:window.innerHeight;return s(k(t),e.proxy,document,i,a,e).then(function(t){return _(t.contentWindow.document.documentElement,t,e,i,a)})}var r=(t===undefined?[document.documentElement]:t.length?t:[t])[0];r.setAttribute(c+n,n);return f(r.ownerDocument,e,r.ownerDocument.defaultView.innerWidth,r.ownerDocument.defaultView.innerHeight,n).then(function(t){if(typeof e.onrendered==="function"){v("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas");e.onrendered(t)}return t})}u.CanvasRenderer=o;u.NodeContainer=i;u.log=v;u.utils=a;var h=typeof document==="undefined"||typeof Object.create!=="function"||typeof document.createElement("canvas").getContext!=="function"?function(){return Promise.reject("No canvas support")}:u;e.exports=h;function f(o,s,l,u,h){return r(o,o,l,u,s,o.defaultView.pageXOffset,o.defaultView.pageYOffset).then(function(t){v("Document cloned");var e=c+h;var n="["+e+"='"+h+"']";o.querySelector(n).removeAttribute(e);var i=t.contentWindow;var a=i.document.querySelector(n);var r=typeof s.onclone==="function"?Promise.resolve(s.onclone(i.document)):Promise.resolve(true);return r.then(function(){return _(a,t,s,l,u)})})}function _(e,n,i,t,a){var r=n.contentWindow;var o=new d(r.document);var s=new g(i,o);var l=m(e);var u=i.type==="view"?t:w(r.document);var h=i.type==="view"?a:x(r.document);var c=new i.renderer(u,h,s,i,document);var f=new p(e,c,o,s,i);return f.ready.then(function(){v("Finished rendering");var t;if(i.type==="view"){t=b(c.canvas,{width:c.canvas.width,height:c.canvas.height,top:0,left:0,x:0,y:0})}else if(e===r.document.body||e===r.document.documentElement||i.canvas!=null){t=c.canvas}else{t=b(c.canvas,{width:i.width!=null?i.width:l.width,height:i.height!=null?i.height:l.height,top:l.top,left:l.left,x:0,y:0})}y(n,i);return t})}function y(t,e){if(e.removeContainer){t.parentNode.removeChild(t);v("Cleaned up container")}}function b(t,e){var n=document.createElement("canvas");var i=Math.min(t.width-1,Math.max(0,e.left));var a=Math.min(t.width,Math.max(1,e.left+e.width));var r=Math.min(t.height-1,Math.max(0,e.top));var o=Math.min(t.height,Math.max(1,e.top+e.height));n.width=e.width;n.height=e.height;var s=a-i;var l=o-r;v("Cropping canvas at:","left:",e.left,"top:",e.top,"width:",s,"height:",l);v("Resulting crop with width",e.width,"and height",e.height,"with x",i,"and y",r);n.getContext("2d").drawImage(t,i,r,s,l,e.x,e.y,s,l);return n}function w(t){return Math.max(Math.max(t.body.scrollWidth,t.documentElement.scrollWidth),Math.max(t.body.offsetWidth,t.documentElement.offsetWidth),Math.max(t.body.clientWidth,t.documentElement.clientWidth))}function x(t){return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}function k(t){var e=document.createElement("a");e.href=t;e.href=e.href;return e}},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(t,e,n){var i=t("./log");var a=t("./utils").smallImage;function r(t){this.src=t;i("DummyImageContainer for",t);if(!this.promise||!this.image){i("Initiating DummyImageContainer");r.prototype.image=new Image;var n=this.image;r.prototype.promise=new Promise(function(t,e){n.onload=t;n.onerror=e;n.src=a();if(n.complete===true){t(n)}})}}e.exports=r},{"./log":13,"./utils":26}],6:[function(t,e,n){var l=t("./utils").smallImage;function i(t,e){var n=document.createElement("div"),i=document.createElement("img"),a=document.createElement("span"),r="Hidden Text",o,s;n.style.visibility="hidden";n.style.fontFamily=t;n.style.fontSize=e;n.style.margin=0;n.style.padding=0;document.body.appendChild(n);i.src=l();i.width=1;i.height=1;i.style.margin=0;i.style.padding=0;i.style.verticalAlign="baseline";a.style.fontFamily=t;a.style.fontSize=e;a.style.margin=0;a.style.padding=0;a.appendChild(document.createTextNode(r));n.appendChild(a);n.appendChild(i);o=i.offsetTop-a.offsetTop+1;n.removeChild(a);n.appendChild(document.createTextNode(r));n.style.lineHeight="normal";i.style.verticalAlign="super";s=i.offsetTop-n.offsetTop+1;document.body.removeChild(n);this.baseline=o;this.lineWidth=1;this.middle=s}e.exports=i},{"./utils":26}],7:[function(t,e,n){var i=t("./font");function a(){this.data={}}a.prototype.getMetrics=function(t,e){if(this.data[t+"-"+e]===undefined){this.data[t+"-"+e]=new i(t,e)}return this.data[t+"-"+e]};e.exports=a},{"./font":6}],8:[function(r,t,e){var n=r("./utils");var o=n.getBounds;var a=r("./proxy").loadUrlDocument;function i(e,t,n){this.image=null;this.src=e;var i=this;var a=o(e);this.promise=(!t?this.proxyLoad(n.proxy,a,n):new Promise(function(t){if(e.contentWindow.document.URL==="about:blank"||e.contentWindow.document.documentElement==null){e.contentWindow.onload=e.onload=function(){t(e)}}else{t(e)}})).then(function(t){var e=r("./core");return e(t.contentWindow.document.documentElement,{type:"view",width:t.width,height:t.height,proxy:n.proxy,javascriptEnabled:n.javascriptEnabled,removeContainer:n.removeContainer,allowTaint:n.allowTaint,imageTimeout:n.imageTimeout/2})}).then(function(t){return i.image=t})}i.prototype.proxyLoad=function(t,e,n){var i=this.src;return a(i.src,t,i.ownerDocument,e.width,e.height,n)};t.exports=i},{"./core":4,"./proxy":16,"./utils":26}],9:[function(t,e,n){function i(t){this.src=t.value;this.colorStops=[];this.type=null;this.x0=.5;this.y0=.5;this.x1=.5;this.y1=.5;this.promise=Promise.resolve(true)}i.TYPES={LINEAR:1,RADIAL:2};i.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i;e.exports=i},{}],10:[function(t,e,n){function i(n,i){this.src=n;this.image=new Image;var a=this;this.tainted=null;this.promise=new Promise(function(t,e){a.image.onload=t;a.image.onerror=e;if(i){a.image.crossOrigin="anonymous"}a.image.src=n;if(a.image.complete===true){t(a.image)}})}e.exports=i},{}],11:[function(t,e,n){var r=t("./log");var i=t("./imagecontainer");var a=t("./dummyimagecontainer");var o=t("./proxyimagecontainer");var s=t("./framecontainer");var l=t("./svgcontainer");var u=t("./svgnodecontainer");var h=t("./lineargradientcontainer");var c=t("./webkitgradientcontainer");var f=t("./utils").bind;function d(t,e){this.link=null;this.options=t;this.support=e;this.origin=this.getOrigin(window.location.href)}d.prototype.findImages=function(t){var e=[];t.reduce(function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t},[]).forEach(this.addImage(e,this.loadImage),this);return e};d.prototype.findBackgroundImage=function(t,e){e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this);return t};d.prototype.addImage=function(n,i){return function(e){e.args.forEach(function(t){if(!this.imageExists(n,t)){n.splice(0,0,i.call(this,e));r("Added image #"+n.length,typeof t==="string"?t.substring(0,100):t)}},this)}};d.prototype.hasImageBackground=function(t){return t.method!=="none"};d.prototype.loadImage=function(t){if(t.method==="url"){var e=t.args[0];if(this.isSVG(e)&&!this.support.svg&&!this.options.allowTaint){return new l(e)}else if(e.match(/data:image\/.*;base64,/i)){return new i(e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),false)}else if(this.isSameOrigin(e)||this.options.allowTaint===true||this.isSVG(e)){return new i(e,false)}else if(this.support.cors&&!this.options.allowTaint&&this.options.useCORS){return new i(e,true)}else if(this.options.proxy){return new o(e,this.options.proxy)}else{return new a(e)}}else if(t.method==="linear-gradient"){return new h(t)}else if(t.method==="gradient"){return new c(t)}else if(t.method==="svg"){return new u(t.args[0],this.support.svg)}else if(t.method==="IFRAME"){return new s(t.args[0],this.isSameOrigin(t.args[0].src),this.options)}else{return new a(t)}};d.prototype.isSVG=function(t){return t.substring(t.length-3).toLowerCase()==="svg"||l.prototype.isInline(t)};d.prototype.imageExists=function(t,e){return t.some(function(t){return t.src===e})};d.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin};d.prototype.getOrigin=function(t){var e=this.link||(this.link=document.createElement("a"));e.href=t;e.href=e.href;return e.protocol+e.hostname+e.port};d.prototype.getPromise=function(e){return this.timeout(e,this.options.imageTimeout)["catch"](function(){var t=new a(e.src);return t.promise.then(function(t){e.image=t})})};d.prototype.get=function(e){var n=null;return this.images.some(function(t){return(n=t).src===e})?n:null};d.prototype.fetch=function(t){this.images=t.reduce(f(this.findBackgroundImage,this),this.findImages(t));this.images.forEach(function(e,n){e.promise.then(function(){r("Succesfully loaded image #"+(n+1),e)},function(t){r("Failed loading image #"+(n+1),e,t)})});this.ready=Promise.all(this.images.map(this.getPromise,this));r("Finished searching images");return this};d.prototype.timeout=function(n,i){var a;var t=Promise.race([n.promise,new Promise(function(t,e){a=setTimeout(function(){r("Timed out loading image",n);e(n)},i)})]).then(function(t){clearTimeout(a);return t});t["catch"](function(){clearTimeout(a)});return t};e.exports=d},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(t,e,n){var a=t("./gradientcontainer");var r=t("./color");function i(t){a.apply(this,arguments);this.type=a.TYPES.LINEAR;var e=i.REGEXP_DIRECTION.test(t.args[0])||!a.REGEXP_COLORSTOP.test(t.args[0]);if(e){t.args[0].split(/\s+/).reverse().forEach(function(t,e){switch(t){case"left":this.x0=0;this.x1=1;break;case"top":this.y0=0;this.y1=1;break;case"right":this.x0=1;this.x1=0;break;case"bottom":this.y0=1;this.y1=0;break;case"to":var n=this.y0;var i=this.x0;this.y0=this.y1;this.x0=this.x1;this.x1=i;this.y1=n;break;case"center":break;default:var a=parseFloat(t,10)*.01;if(isNaN(a)){break}if(e===0){this.y0=a;this.y1=1-this.y0}else{this.x0=a;this.x1=1-this.x0}break}},this)}else{this.y0=0;this.y1=1}this.colorStops=t.args.slice(e?1:0).map(function(t){var e=t.match(a.REGEXP_COLORSTOP);var n=+e[2];var i=n===0?"%":e[3];return{color:new r(e[1]),stop:i==="%"?n/100:null}});if(this.colorStops[0].stop===null){this.colorStops[0].stop=0}if(this.colorStops[this.colorStops.length-1].stop===null){this.colorStops[this.colorStops.length-1].stop=1}this.colorStops.forEach(function(n,i){if(n.stop===null){this.colorStops.slice(i).some(function(t,e){if(t.stop!==null){n.stop=(t.stop-this.colorStops[i-1].stop)/(e+1)+this.colorStops[i-1].stop;return true}else{return false}},this)}},this)}i.prototype=Object.create(a.prototype);i.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i;e.exports=i},{"./color":3,"./gradientcontainer":9}],13:[function(t,e,n){var i=function t(){if(t.options.logging&&window.console&&window.console.log){Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-t.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))}};i.options={logging:false};e.exports=i},{}],14:[function(t,e,n){var r=t("./color");var i=t("./utils");var a=i.getBounds;var o=i.parseBackgrounds;var s=i.offsetBounds;function l(t,e){this.node=t;this.parent=e;this.stack=null;this.bounds=null;this.borders=null;this.clip=[];this.backgroundClip=[];this.offsetBounds=null;this.visible=null;this.computedStyles=null;this.colors={};this.styles={};this.backgroundImages=null;this.transformData=null;this.transformMatrix=null;this.isPseudoElement=false;this.opacity=null}l.prototype.cloneTo=function(t){t.visible=this.visible;t.borders=this.borders;t.bounds=this.bounds;t.clip=this.clip;t.backgroundClip=this.backgroundClip;t.computedStyles=this.computedStyles;t.styles=this.styles;t.backgroundImages=this.backgroundImages;t.opacity=this.opacity};l.prototype.getOpacity=function(){return this.opacity===null?this.opacity=this.cssFloat("opacity"):this.opacity};l.prototype.assignStack=function(t){this.stack=t;t.children.push(this)};l.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:this.css("display")!=="none"&&this.css("visibility")!=="hidden"&&!this.node.hasAttribute("data-html2canvas-ignore")&&(this.node.nodeName!=="INPUT"||this.node.getAttribute("type")!=="hidden")};l.prototype.css=function(t){if(!this.computedStyles){this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)}return this.styles[t]||(this.styles[t]=this.computedStyles[t])};l.prototype.prefixedCss=function(e){var t=["webkit","moz","ms","o"];var n=this.css(e);if(n===undefined){t.some(function(t){n=this.css(t+e.substr(0,1).toUpperCase()+e.substr(1));return n!==undefined},this)}return n===undefined?null:n};l.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)};l.prototype.cssInt=function(t){var e=parseInt(this.css(t),10);return isNaN(e)?0:e};l.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new r(this.css(t)))};l.prototype.cssFloat=function(t){var e=parseFloat(this.css(t));return isNaN(e)?0:e};l.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal";break}return t};l.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);if(t){return{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}}return null};l.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=o(this.css("backgroundImage")))};l.prototype.cssList=function(t,e){var n=(this.css(t)||"").split(",");n=n[e||0]||n[0]||"auto";n=n.trim().split(" ");if(n.length===1){n=[n[0],c(n[0])?"auto":n[0]]}return n};l.prototype.parseBackgroundSize=function(t,e,n){var i=this.cssList("backgroundSize",n);var a,r;if(c(i[0])){a=t.width*parseFloat(i[0])/100}else if(/contain|cover/.test(i[0])){var o=t.width/t.height,s=e.width/e.height;return o<s^i[0]==="contain"?{width:t.height*s,height:t.height}:{width:t.width,height:t.width/s}}else{a=parseInt(i[0],10)}if(i[0]==="auto"&&i[1]==="auto"){r=e.height}else if(i[1]==="auto"){r=a/e.width*e.height}else if(c(i[1])){r=t.height*parseFloat(i[1])/100}else{r=parseInt(i[1],10)}if(i[0]==="auto"){a=r/e.height*e.width}return{width:a,height:r}};l.prototype.parseBackgroundPosition=function(t,e,n,i){var a=this.cssList("backgroundPosition",n);var r,o;if(c(a[0])){r=(t.width-(i||e).width)*(parseFloat(a[0])/100)}else{r=parseInt(a[0],10)}if(a[1]==="auto"){o=r/e.width*e.height}else if(c(a[1])){o=(t.height-(i||e).height)*parseFloat(a[1])/100}else{o=parseInt(a[1],10)}if(a[0]==="auto"){r=o/e.height*e.width}return{left:r,top:o}};l.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]};l.prototype.parseTextShadows=function(){var t=this.css("textShadow");var e=[];if(t&&t!=="none"){var n=t.match(this.TEXT_SHADOW_PROPERTY);for(var i=0;n&&i<n.length;i++){var a=n[i].match(this.TEXT_SHADOW_VALUES);e.push({color:new r(a[0]),offsetX:a[1]?parseFloat(a[1].replace("px","")):0,offsetY:a[2]?parseFloat(a[2].replace("px","")):0,blur:a[3]?a[3].replace("px",""):0})}}return e};l.prototype.parseTransform=function(){if(!this.transformData){if(this.hasTransform()){var t=this.parseBounds();var e=this.prefixedCss("transformOrigin").split(" ").map(f).map(d);e[0]+=t.left;e[1]+=t.top;this.transformData={origin:e,matrix:this.parseTransformMatrix()}}else{this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]}}}return this.transformData};l.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var t=this.prefixedCss("transform");var e=t?h(t.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=e?e:[1,0,0,1,0,0]}return this.transformMatrix};l.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?s(this.node):a(this.node))};l.prototype.hasTransform=function(){return this.parseTransformMatrix().join(",")!=="1,0,0,1,0,0"||this.parent&&this.parent.hasTransform()};l.prototype.getValue=function(){var t=this.node.value||"";if(this.node.tagName==="SELECT"){t=u(this.node)}else if(this.node.type==="password"){t=Array(t.length+1).join("")}return t.length===0?this.node.placeholder||"":t};l.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/;l.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g;l.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;l.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/;function u(t){var e=t.options[t.selectedIndex||0];return e?e.text||"":""}function h(t){if(t&&t[1]==="matrix"){return t[2].split(",").map(function(t){return parseFloat(t.trim())})}else if(t&&t[1]==="matrix3d"){var e=t[2].split(",").map(function(t){return parseFloat(t.trim())});return[e[0],e[1],e[4],e[5],e[12],e[13]]}}function c(t){return t.toString().indexOf("%")!==-1}function f(t){return t.replace("px","")}function d(t){return parseFloat(t)}e.exports=l},{"./color":3,"./utils":26}],15:[function(t,e,n){var s=t("./log");var l=t("punycode");var u=t("./nodecontainer");var h=t("./textcontainer");var c=t("./pseudoelementcontainer");var f=t("./fontmetrics");var d=t("./color");var g=t("./stackingcontext");var i=t("./utils");var p=i.bind;var o=i.getBounds;var v=i.parseBackgrounds;var m=i.offsetBounds;function a(t,e,n,i,a){s("Starting NodeParser");this.renderer=e;this.options=a;this.range=null;this.support=n;this.renderQueue=[];this.stack=new g(true,1,t.ownerDocument,null);var r=new u(t,null);if(a.background){e.rectangle(0,0,e.width,e.height,new d(a.background))}if(t===t.ownerDocument.documentElement){var o=new u(r.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null);e.rectangle(0,0,e.width,e.height,o.color("backgroundColor"))}r.visibile=r.isElementVisible();this.createPseudoHideStyles(t.ownerDocument);this.disableAnimations(t.ownerDocument);this.nodes=X([r].concat(this.getChildren(r)).filter(function(t){return t.visible=t.isElementVisible()}).map(this.getPseudoElements,this));this.fontMetrics=new f;s("Fetched nodes, total:",this.nodes.length);s("Calculate overflow clips");this.calculateOverflowClips();s("Start fetching images");this.images=i.fetch(this.nodes.filter(H));this.ready=this.images.ready.then(p(function(){s("Images loaded, starting parsing");s("Creating stacking contexts");this.createStackingContexts();s("Sorting stacking contexts");this.sortStackingContexts(this.stack);this.parse(this.stack);s("Render queue created with "+this.renderQueue.length+" items");return new Promise(p(function(t){if(!a.async){this.renderQueue.forEach(this.paint,this);t()}else if(typeof a.async==="function"){a.async.call(this,this.renderQueue,t)}else if(this.renderQueue.length>0){this.renderIndex=0;this.asyncRenderer(this.renderQueue,t)}else{t()}},this))},this))}a.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(t){if(H(t)){if(V(t)){t.appendToDOM()}t.borders=this.parseBorders(t);var e=t.css("overflow")==="hidden"?[t.borders.clip]:[];var n=t.parseClip();if(n&&["absolute","fixed"].indexOf(t.css("position"))!==-1){e.push([["rect",t.bounds.left+n.left,t.bounds.top+n.top,n.right-n.left,n.bottom-n.top]])}t.clip=r(t)?t.parent.clip.concat(e):e;t.backgroundClip=t.css("overflow")!=="hidden"?t.clip.concat([t.borders.clip]):t.clip;if(V(t)){t.cleanDOM()}}else if(U(t)){t.clip=r(t)?t.parent.clip:[]}if(!V(t)){t.bounds=null}},this)};function r(t){return t.parent&&t.parent.clip.length}a.prototype.asyncRenderer=function(t,e,n){n=n||Date.now();this.paint(t[this.renderIndex++]);if(t.length===this.renderIndex){e()}else if(n+20>Date.now()){this.asyncRenderer(t,e,n)}else{setTimeout(p(function(){this.asyncRenderer(t,e)},this),0)}};a.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+c.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }'+"."+c.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')};a.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; "+"-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")};a.prototype.createStyles=function(t,e){var n=t.createElement("style");n.innerHTML=e;t.body.appendChild(n)};a.prototype.getPseudoElements=function(t){var e=[[t]];if(t.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(t,":before");var i=this.getPseudoElement(t,":after");if(n){e.push(n)}if(i){e.push(i)}}return X(e)};function _(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})}a.prototype.getPseudoElement=function(t,e){var n=t.computedStyle(e);if(!n||!n.content||n.content==="none"||n.content==="-moz-alt-content"||n.display==="none"){return null}var i=Z(n.content);var a=i.substr(0,3)==="url";var r=document.createElement(a?"img":"html2canvaspseudoelement");var o=new c(r,t,e);for(var s=n.length-1;s>=0;s--){var l=_(n.item(s));r.style[l]=n[l]}r.className=c.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+c.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;if(a){r.src=v(i)[0].args[0];return[o]}else{var u=document.createTextNode(i);r.appendChild(u);return[o,new h(u,o)]}};a.prototype.getChildren=function(n){return X([].filter.call(n.node.childNodes,N).map(function(t){var e=[t.nodeType===Node.TEXT_NODE?new h(t,n):new u(t,n)].filter(Y);return t.nodeType===Node.ELEMENT_NODE&&e.length&&t.tagName!=="TEXTAREA"?e[0].isElementVisible()?e.concat(this.getChildren(e[0])):[]:e},this))};a.prototype.newStackingContext=function(t,e){var n=new g(e,t.getOpacity(),t.node,t.parent);t.cloneTo(n);var i=e?n.getParentStack(this):n.parent.stack;i.contexts.push(n);t.stack=n};a.prototype.createStackingContexts=function(){this.nodes.forEach(function(t){if(H(t)&&(this.isRootElement(t)||W(t)||z(t)||this.isBodyWithTransparentRoot(t)||t.hasTransform())){this.newStackingContext(t,true)}else if(H(t)&&(F(t)&&R(t)||j(t)||L(t))){this.newStackingContext(t,false)}else{t.assignStack(t.parent.stack)}},this)};a.prototype.isBodyWithTransparentRoot=function(t){return t.node.nodeName==="BODY"&&t.parent.color("backgroundColor").isTransparent()};a.prototype.isRootElement=function(t){return t.parent===null};a.prototype.sortStackingContexts=function(t){t.contexts.sort(G(t.contexts.slice(0)));t.contexts.forEach(this.sortStackingContexts,this)};a.prototype.parseTextBounds=function(o){return function(t,e,n){if(o.parent.css("textDecoration").substr(0,4)!=="none"||t.trim().length!==0){if(this.support.rangeBounds&&!o.parent.hasTransform()){var i=n.slice(0,e).join("").length;return this.getRangeBounds(o.node,i,t.length)}else if(o.node&&typeof o.node.data==="string"){var a=o.node.splitText(t.length);var r=this.getWrapperBounds(o.node,o.parent.hasTransform());o.node=a;return r}}else if(!this.support.rangeBounds||o.parent.hasTransform()){o.node=o.node.splitText(t.length)}return{}}};a.prototype.getWrapperBounds=function(t,e){var n=t.ownerDocument.createElement("html2canvaswrapper");var i=t.parentNode,a=t.cloneNode(true);n.appendChild(t.cloneNode(true));i.replaceChild(n,t);var r=e?m(n):o(n);i.replaceChild(a,n);return r};a.prototype.getRangeBounds=function(t,e,n){var i=this.range||(this.range=t.ownerDocument.createRange());i.setStart(t,e);i.setEnd(t,e+n);return i.getBoundingClientRect()};function y(){}a.prototype.parse=function(t){var e=t.contexts.filter(E);var n=t.children.filter(H);var i=n.filter(I(L));var a=i.filter(I(F)).filter(I(T));var r=n.filter(I(F)).filter(L);var o=i.filter(I(F)).filter(T);var s=t.contexts.concat(i.filter(F)).filter(R);var l=t.children.filter(U).filter(O);var u=t.contexts.filter(M);e.concat(a).concat(r).concat(o).concat(s).concat(l).concat(u).forEach(function(t){this.renderQueue.push(t);if(B(t)){this.parse(t);this.renderQueue.push(new y)}},this)};a.prototype.paint=function(t){try{if(t instanceof y){this.renderer.ctx.restore()}else if(U(t)){if(V(t.parent)){t.parent.appendToDOM()}this.paintText(t);if(V(t.parent)){t.parent.cleanDOM()}}else{this.paintNode(t)}}catch(t){s(t);if(this.options.strict){throw t}}};a.prototype.paintNode=function(t){if(B(t)){this.renderer.setOpacity(t.opacity);this.renderer.ctx.save();if(t.hasTransform()){this.renderer.setTransform(t.parseTransform())}}if(t.node.nodeName==="INPUT"&&t.node.type==="checkbox"){this.paintCheckbox(t)}else if(t.node.nodeName==="INPUT"&&t.node.type==="radio"){this.paintRadio(t)}else{this.paintElement(t)}};a.prototype.paintElement=function(n){var i=n.parseBounds();this.renderer.clip(n.backgroundClip,function(){this.renderer.renderBackground(n,i,n.borders.borders.map(q))},this);this.renderer.clip(n.clip,function(){this.renderer.renderBorders(n.borders.borders)},this);this.renderer.clip(n.backgroundClip,function(){switch(n.node.nodeName){case"svg":case"IFRAME":var t=this.images.get(n.node);if(t){this.renderer.renderImage(n,i,n.borders,t)}else{s("Error loading <"+n.node.nodeName+">",n.node)}break;case"IMG":var e=this.images.get(n.node.src);if(e){this.renderer.renderImage(n,i,n.borders,e)}else{s("Error loading <img>",n.node.src)}break;case"CANVAS":this.renderer.renderImage(n,i,n.borders,{image:n.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(n);break}},this)};a.prototype.paintCheckbox=function(t){var e=t.parseBounds();var n=Math.min(e.width,e.height);var i={width:n-1,height:n-1,top:e.top,left:e.left};var a=[3,3];var r=[a,a,a,a];var o=[1,1,1,1].map(function(t){return{color:new d("#A5A5A5"),width:t}});var s=k(i,r,o);this.renderer.clip(t.backgroundClip,function(){this.renderer.rectangle(i.left+1,i.top+1,i.width-2,i.height-2,new d("#DEDEDE"));this.renderer.renderBorders(w(o,i,s,r));if(t.node.checked){this.renderer.font(new d("#424242"),"normal","normal","bold",n-3+"px","arial");this.renderer.text("",i.left+n/6,i.top+n-1)}},this)};a.prototype.paintRadio=function(t){var e=t.parseBounds();var n=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,function(){this.renderer.circleStroke(e.left+1,e.top+1,n,new d("#DEDEDE"),1,new d("#A5A5A5"));if(t.node.checked){this.renderer.circle(Math.ceil(e.left+n/4)+1,Math.ceil(e.top+n/4)+1,Math.floor(n/2),new d("#424242"))}},this)};a.prototype.paintFormValue=function(e){var t=e.getValue();if(t.length>0){var n=e.node.ownerDocument;var i=n.createElement("html2canvaswrapper");var a=["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"];a.forEach(function(t){try{i.style[t]=e.css(t)}catch(t){s("html2canvas: Parse: Exception caught in renderFormValue: "+t.message)}});var r=e.parseBounds();i.style.position="fixed";i.style.left=r.left+"px";i.style.top=r.top+"px";i.textContent=t;n.body.appendChild(i);this.paintText(new h(i.firstChild,e));n.body.removeChild(i)}};a.prototype.paintText=function(n){n.applyTextTransform();var t=l.ucs2.decode(n.node.data);var i=(!this.options.letterRendering||P(n))&&!Q(n.node.data)?J(t):t.map(function(t){return l.ucs2.encode([t])});var e=n.parent.fontWeight();var a=n.parent.css("fontSize");var r=n.parent.css("fontFamily");var o=n.parent.parseTextShadows();this.renderer.font(n.parent.color("color"),n.parent.css("fontStyle"),n.parent.css("fontVariant"),e,a,r);if(o.length){this.renderer.fontShadow(o[0].color,o[0].offsetX,o[0].offsetY,o[0].blur)}else{this.renderer.clearShadow()}this.renderer.clip(n.parent.clip,function(){i.map(this.parseTextBounds(n),this).forEach(function(t,e){if(t){this.renderer.text(i[e],t.left,t.bottom);this.renderTextDecoration(n.parent,t,this.fontMetrics.getMetrics(r,a))}},this)},this)};a.prototype.renderTextDecoration=function(t,e,n){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+n.baseline+n.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+n.middle+n.lineWidth),e.width,1,t.color("color"));break}};var b={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};a.prototype.parseBorders=function(r){var t=r.parseBounds();var e=D(r);var n=["Top","Right","Bottom","Left"].map(function(t,e){var n=r.css("border"+t+"Style");var i=r.color("border"+t+"Color");if(n==="inset"&&i.isBlack()){i=new d([255,255,255,i.a])}var a=b[n]?b[n][e]:null;return{width:r.cssInt("border"+t+"Width"),color:a?i[a[0]](a[1]):i,args:null}});var i=k(t,e,n);return{clip:this.parseBackgroundClip(r,i,n,e,t),borders:w(n,t,i,e)}};function w(o,s,l,u){return o.map(function(t,e){if(t.width>0){var n=s.left;var i=s.top;var a=s.width;var r=s.height-o[2].width;switch(e){case 0:r=o[0].width;t.args=C({c1:[n,i],c2:[n+a,i],c3:[n+a-o[1].width,i+r],c4:[n+o[3].width,i+r]},u[0],u[1],l.topLeftOuter,l.topLeftInner,l.topRightOuter,l.topRightInner);break;case 1:n=s.left+s.width-o[1].width;a=o[1].width;t.args=C({c1:[n+a,i],c2:[n+a,i+r+o[2].width],c3:[n,i+r],c4:[n,i+o[0].width]},u[1],u[2],l.topRightOuter,l.topRightInner,l.bottomRightOuter,l.bottomRightInner);break;case 2:i=i+s.height-o[2].width;r=o[2].width;t.args=C({c1:[n+a,i+r],c2:[n,i+r],c3:[n+o[3].width,i],c4:[n+a-o[3].width,i]},u[2],u[3],l.bottomRightOuter,l.bottomRightInner,l.bottomLeftOuter,l.bottomLeftInner);break;case 3:a=o[3].width;t.args=C({c1:[n,i+r+o[2].width],c2:[n,i],c3:[n+a,i+o[0].width],c4:[n+a,i+r]},u[3],u[0],l.bottomLeftOuter,l.bottomLeftInner,l.topLeftOuter,l.topLeftInner);break}}return t})}a.prototype.parseBackgroundClip=function(t,e,n,i,a){var r=t.css("backgroundClip"),o=[];switch(r){case"content-box":case"padding-box":A(o,i[0],i[1],e.topLeftInner,e.topRightInner,a.left+n[3].width,a.top+n[0].width);A(o,i[1],i[2],e.topRightInner,e.bottomRightInner,a.left+a.width-n[1].width,a.top+n[0].width);A(o,i[2],i[3],e.bottomRightInner,e.bottomLeftInner,a.left+a.width-n[1].width,a.top+a.height-n[2].width);A(o,i[3],i[0],e.bottomLeftInner,e.topLeftInner,a.left+n[3].width,a.top+a.height-n[2].width);break;default:A(o,i[0],i[1],e.topLeftOuter,e.topRightOuter,a.left,a.top);A(o,i[1],i[2],e.topRightOuter,e.bottomRightOuter,a.left+a.width,a.top);A(o,i[2],i[3],e.bottomRightOuter,e.bottomLeftOuter,a.left+a.width,a.top+a.height);A(o,i[3],i[0],e.bottomLeftOuter,e.topLeftOuter,a.left,a.top+a.height);break}return o};function x(t,e,n,i){var a=4*((Math.sqrt(2)-1)/3);var r=n*a,o=i*a,s=t+n,l=e+i;return{topLeft:S({x:t,y:l},{x:t,y:l-o},{x:s-r,y:e},{x:s,y:e}),topRight:S({x:t,y:e},{x:t+r,y:e},{x:s,y:l-o},{x:s,y:l}),bottomRight:S({x:s,y:e},{x:s,y:e+o},{x:t+r,y:l},{x:t,y:l}),bottomLeft:S({x:s,y:l},{x:s-r,y:l},{x:t,y:e+o},{x:t,y:e})}}function k(t,e,n){var i=t.left,a=t.top,r=t.width,o=t.height,s=e[0][0]<r/2?e[0][0]:r/2,l=e[0][1]<o/2?e[0][1]:o/2,u=e[1][0]<r/2?e[1][0]:r/2,h=e[1][1]<o/2?e[1][1]:o/2,c=e[2][0]<r/2?e[2][0]:r/2,f=e[2][1]<o/2?e[2][1]:o/2,d=e[3][0]<r/2?e[3][0]:r/2,g=e[3][1]<o/2?e[3][1]:o/2;var p=r-u,v=o-f,m=r-c,_=o-g;return{topLeftOuter:x(i,a,s,l).topLeft.subdivide(.5),topLeftInner:x(i+n[3].width,a+n[0].width,Math.max(0,s-n[3].width),Math.max(0,l-n[0].width)).topLeft.subdivide(.5),topRightOuter:x(i+p,a,u,h).topRight.subdivide(.5),topRightInner:x(i+Math.min(p,r+n[3].width),a+n[0].width,p>r+n[3].width?0:u-n[3].width,h-n[0].width).topRight.subdivide(.5),bottomRightOuter:x(i+m,a+v,c,f).bottomRight.subdivide(.5),bottomRightInner:x(i+Math.min(m,r-n[3].width),a+Math.min(v,o+n[0].width),Math.max(0,c-n[1].width),f-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:x(i,a+_,d,g).bottomLeft.subdivide(.5),bottomLeftInner:x(i+n[3].width,a+_,Math.max(0,d-n[3].width),g-n[2].width).bottomLeft.subdivide(.5)}}function S(l,u,h,c){var f=function t(e,n,i){return{x:e.x+(n.x-e.x)*i,y:e.y+(n.y-e.y)*i}};return{start:l,startControl:u,endControl:h,end:c,subdivide:function t(e){var n=f(l,u,e),i=f(u,h,e),a=f(h,c,e),r=f(n,i,e),o=f(i,a,e),s=f(r,o,e);return[S(l,n,r,s),S(s,o,a,c)]},curveTo:function t(e){e.push(["bezierCurve",u.x,u.y,h.x,h.y,c.x,c.y])},curveToReversed:function t(e){e.push(["bezierCurve",h.x,h.y,u.x,u.y,l.x,l.y])}}}function C(t,e,n,i,a,r,o){var s=[];if(e[0]>0||e[1]>0){s.push(["line",i[1].start.x,i[1].start.y]);i[1].curveTo(s)}else{s.push(["line",t.c1[0],t.c1[1]])}if(n[0]>0||n[1]>0){s.push(["line",r[0].start.x,r[0].start.y]);r[0].curveTo(s);s.push(["line",o[0].end.x,o[0].end.y]);o[0].curveToReversed(s)}else{s.push(["line",t.c2[0],t.c2[1]]);s.push(["line",t.c3[0],t.c3[1]])}if(e[0]>0||e[1]>0){s.push(["line",a[1].end.x,a[1].end.y]);a[1].curveToReversed(s)}else{s.push(["line",t.c4[0],t.c4[1]])}return s}function A(t,e,n,i,a,r,o){if(e[0]>0||e[1]>0){t.push(["line",i[0].start.x,i[0].start.y]);i[0].curveTo(t);i[1].curveTo(t)}else{t.push(["line",r,o])}if(n[0]>0||n[1]>0){t.push(["line",a[0].start.x,a[0].start.y])}}function E(t){return t.cssInt("zIndex")<0}function M(t){return t.cssInt("zIndex")>0}function R(t){return t.cssInt("zIndex")===0}function T(t){return["inline","inline-block","inline-table"].indexOf(t.css("display"))!==-1}function B(t){return t instanceof g}function O(t){return t.node.data.trim().length>0}function P(t){return/^(normal|none|0px)$/.test(t.parent.css("letterSpacing"))}function D(i){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){var e=i.css("border"+t+"Radius");var n=e.split(" ");if(n.length<=1){n[1]=n[0]}return n.map(K)})}function N(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function z(t){var e=t.css("position");var n=["absolute","relative","fixed"].indexOf(e)!==-1?t.css("zIndex"):"auto";return n!=="auto"}function F(t){return t.css("position")!=="static"}function L(t){return t.css("float")!=="none"}function j(t){return["inline-block","inline-table"].indexOf(t.css("display"))!==-1}function I(t){var e=this;return function(){return!t.apply(e,arguments)}}function H(t){return t.node.nodeType===Node.ELEMENT_NODE}function V(t){return t.isPseudoElement===true}function U(t){return t.node.nodeType===Node.TEXT_NODE}function G(n){return function(t,e){return t.cssInt("zIndex")+n.indexOf(t)/n.length-(e.cssInt("zIndex")+n.indexOf(e)/n.length)}}function W(t){return t.getOpacity()<1}function K(t){return parseInt(t,10)}function q(t){return t.width}function Y(t){return t.node.nodeType!==Node.ELEMENT_NODE||["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)===-1}function X(t){return[].concat.apply([],t)}function Z(t){var e=t.substr(0,1);return e===t.substr(t.length-1)&&e.match(/'|"/)?t.substr(1,t.length-2):t}function J(t){var e=[],n=0,i=false,a;while(t.length){if($(t[n])===i){a=t.splice(0,n);if(a.length){e.push(l.ucs2.encode(a))}i=!i;n=0}else{n++}if(n>=t.length){a=t.splice(0,n);if(a.length){e.push(l.ucs2.encode(a))}}}return e}function $(t){return[32,13,10,9,45].indexOf(t)!==-1}function Q(t){return/[^\u0000-\u00ff]/.test(t)}e.exports=a},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(t,e,n){var o=t("./xhr");var i=t("./utils");var s=t("./log");var l=t("./clone");var u=i.decode64;function h(t,e,n){var i="withCredentials"in new XMLHttpRequest;if(!e){return Promise.reject("No proxy configured")}var a=f(i);var r=d(e,t,a);return i?o(r):c(n,r,a).then(function(t){return u(t.content)})}var a=0;function r(t,e,n){var i="crossOrigin"in new Image;var a=f(i);var r=d(e,t,a);return i?Promise.resolve(r):c(n,r,a).then(function(t){return"data:"+t.type+";base64,"+t.content})}function c(r,t,o){return new Promise(function(e,n){var i=r.createElement("script");var a=function t(){delete window.html2canvas.proxy[o];r.body.removeChild(i)};window.html2canvas.proxy[o]=function(t){a();e(t)};i.src=t;i.onerror=function(t){a();n(t)};r.body.appendChild(i)})}function f(t){return!t?"html2canvas_"+Date.now()+"_"+ ++a+"_"+Math.round(Math.random()*1e5):""}function d(t,e,n){return t+"?url="+encodeURIComponent(e)+(n.length?"&callback=html2canvas.proxy."+n:"")}function g(r){return function(e){var t=new DOMParser,n;try{n=t.parseFromString(e,"text/html")}catch(t){s("DOMParser not supported, falling back to createHTMLDocument");n=document.implementation.createHTMLDocument("");try{n.open();n.write(e);n.close()}catch(t){s("createHTMLDocument write not supported, falling back to document.body.innerHTML");n.body.innerHTML=e}}var i=n.querySelector("base");if(!i||!i.href.host){var a=n.createElement("base");a.href=r;n.head.insertBefore(a,n.head.firstChild)}return n}}function p(t,e,n,i,a,r){return new h(t,e,window.document).then(g(t)).then(function(t){return l(t,n,i,a,r,0,0)})}n.Proxy=h;n.ProxyURL=r;n.loadUrlDocument=p},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(t,e,n){var r=t("./proxy").ProxyURL;function i(n,i){var t=document.createElement("a");t.href=n;n=t.href;this.src=n;this.image=new Image;var a=this;this.promise=new Promise(function(t,e){a.image.crossOrigin="Anonymous";a.image.onload=t;a.image.onerror=e;new r(n,i,document).then(function(t){a.image.src=t})["catch"](e)})}e.exports=i},{"./proxy":16}],18:[function(t,e,n){var i=t("./nodecontainer");function a(t,e,n){i.call(this,t,e);this.isPseudoElement=true;this.before=n===":before"}a.prototype.cloneTo=function(t){a.prototype.cloneTo.call(this,t);t.isPseudoElement=true;t.before=this.before};a.prototype=Object.create(i.prototype);a.prototype.appendToDOM=function(){if(this.before){this.parent.node.insertBefore(this.node,this.parent.node.firstChild)}else{this.parent.node.appendChild(this.node)}this.parent.node.className+=" "+this.getHideClass()};a.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node);this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")};a.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]};a.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before";a.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after";e.exports=a},{"./nodecontainer":14}],19:[function(t,e,n){var l=t("./log");function i(t,e,n,i,a){this.width=t;this.height=e;this.images=n;this.options=i;this.document=a}i.prototype.renderImage=function(t,e,n,i){var a=t.cssInt("paddingLeft"),r=t.cssInt("paddingTop"),o=t.cssInt("paddingRight"),s=t.cssInt("paddingBottom"),l=n.borders;var u=e.width-(l[1].width+l[3].width+a+o);var h=e.height-(l[0].width+l[2].width+r+s);this.drawImage(i,0,0,i.image.width||u,i.image.height||h,e.left+a+l[3].width,e.top+r+l[0].width,u,h)};i.prototype.renderBackground=function(t,e,n){if(e.height>0&&e.width>0){this.renderBackgroundColor(t,e);this.renderBackgroundImage(t,e,n)}};i.prototype.renderBackgroundColor=function(t,e){var n=t.color("backgroundColor");if(!n.isTransparent()){this.rectangle(e.left,e.top,e.width,e.height,n)}};i.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)};i.prototype.renderBorder=function(t){if(!t.color.isTransparent()&&t.args!==null){this.drawShape(t.args,t.color)}};i.prototype.renderBackgroundImage=function(r,o,s){var t=r.parseBackgroundImages();t.reverse().forEach(function(t,e,n){switch(t.method){case"url":var i=this.images.get(t.args[0]);if(i){this.renderBackgroundRepeating(r,o,i,n.length-(e+1),s)}else{l("Error loading background-image",t.args[0])}break;case"linear-gradient":case"gradient":var a=this.images.get(t.value);if(a){this.renderBackgroundGradient(a,o,s)}else{l("Error loading background-image",t.args[0])}break;case"none":break;default:l("Unknown background-image type",t.args[0])}},this)};i.prototype.renderBackgroundRepeating=function(t,e,n,i,a){var r=t.parseBackgroundSize(e,n.image,i);var o=t.parseBackgroundPosition(e,n.image,i,r);var s=t.parseBackgroundRepeat(i);switch(s){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,o,r,e,e.left+a[3],e.top+o.top+a[0],99999,r.height,a);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,o,r,e,e.left+o.left+a[3],e.top+a[0],r.width,99999,a);break;case"no-repeat":this.backgroundRepeatShape(n,o,r,e,e.left+o.left+a[3],e.top+o.top+a[0],r.width,r.height,a);break;default:this.renderBackgroundRepeat(n,o,r,{top:e.top,left:e.left},a[3],a[0]);break}};e.exports=i},{"./log":13}],20:[function(t,e,n){var i=t("../renderer");var a=t("../lineargradientcontainer");var r=t("../log");function o(t,e){i.apply(this,arguments);this.canvas=this.options.canvas||this.document.createElement("canvas");if(!this.options.canvas){this.canvas.width=t;this.canvas.height=e}this.ctx=this.canvas.getContext("2d");this.taintCtx=this.document.createElement("canvas").getContext("2d");this.ctx.textBaseline="bottom";this.variables={};r("Initialized CanvasRenderer with size",t,"x",e)}o.prototype=Object.create(i.prototype);o.prototype.setFillStyle=function(t){this.ctx.fillStyle=ie(t)==="object"&&!!t.isColor?t.toString():t;return this.ctx};o.prototype.rectangle=function(t,e,n,i,a){this.setFillStyle(a).fillRect(t,e,n,i)};o.prototype.circle=function(t,e,n,i){this.setFillStyle(i);this.ctx.beginPath();this.ctx.arc(t+n/2,e+n/2,n/2,0,Math.PI*2,true);this.ctx.closePath();this.ctx.fill()};o.prototype.circleStroke=function(t,e,n,i,a,r){this.circle(t,e,n,i);this.ctx.strokeStyle=r.toString();this.ctx.stroke()};o.prototype.drawShape=function(t,e){this.shape(t);this.setFillStyle(e).fill()};o.prototype.taints=function(e){if(e.tainted===null){this.taintCtx.drawImage(e.image,0,0);try{this.taintCtx.getImageData(0,0,1,1);e.tainted=false}catch(t){this.taintCtx=document.createElement("canvas").getContext("2d");e.tainted=true}}return e.tainted};o.prototype.drawImage=function(t,e,n,i,a,r,o,s,l){if(!this.taints(t)||this.options.allowTaint){this.ctx.drawImage(t.image,e,n,i,a,r,o,s,l)}};o.prototype.clip=function(t,e,n){this.ctx.save();t.filter(s).forEach(function(t){this.shape(t).clip()},this);e.call(n);this.ctx.restore()};o.prototype.shape=function(t){this.ctx.beginPath();t.forEach(function(t,e){if(t[0]==="rect"){this.ctx.rect.apply(this.ctx,t.slice(1))}else{this.ctx[e===0?"moveTo":t[0]+"To"].apply(this.ctx,t.slice(1))}},this);this.ctx.closePath();return this.ctx};o.prototype.font=function(t,e,n,i,a,r){this.setFillStyle(t).font=[e,n,i,a,r].join(" ").split(",")[0]};o.prototype.fontShadow=function(t,e,n,i){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",n).setVariable("shadowBlur",i)};o.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")};o.prototype.setOpacity=function(t){this.ctx.globalAlpha=t};o.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]);this.ctx.transform.apply(this.ctx,t.matrix);this.ctx.translate(-t.origin[0],-t.origin[1])};o.prototype.setVariable=function(t,e){if(this.variables[t]!==e){this.variables[t]=this.ctx[t]=e}return this};o.prototype.text=function(t,e,n){this.ctx.fillText(t,e,n)};o.prototype.backgroundRepeatShape=function(t,e,n,i,a,r,o,s,l){var u=[["line",Math.round(a),Math.round(r)],["line",Math.round(a+o),Math.round(r)],["line",Math.round(a+o),Math.round(s+r)],["line",Math.round(a),Math.round(s+r)]];this.clip([u],function(){this.renderBackgroundRepeat(t,e,n,i,l[3],l[0])},this)};o.prototype.renderBackgroundRepeat=function(t,e,n,i,a,r){var o=Math.round(i.left+e.left+a),s=Math.round(i.top+e.top+r);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,n),"repeat"));this.ctx.translate(o,s);this.ctx.fill();this.ctx.translate(-o,-s)};o.prototype.renderBackgroundGradient=function(t,e){if(t instanceof a){var n=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1);t.colorStops.forEach(function(t){n.addColorStop(t.stop,t.color.toString())});this.rectangle(e.left,e.top,e.width,e.height,n)}};o.prototype.resizeImage=function(t,e){var n=t.image;if(n.width===e.width&&n.height===e.height){return n}var i,a=document.createElement("canvas");a.width=e.width;a.height=e.height;i=a.getContext("2d");i.drawImage(n,0,0,n.width,n.height,0,0,e.width,e.height);return a};function s(t){return t.length>0}e.exports=o},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(t,e,n){var a=t("./nodecontainer");function i(t,e,n,i){a.call(this,n,i);this.ownStacking=t;this.contexts=[];this.children=[];this.opacity=(this.parent?this.parent.stack.opacity:1)*e}i.prototype=Object.create(a.prototype);i.prototype.getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack};e.exports=i},{"./nodecontainer":14}],22:[function(t,e,n){function i(t){this.rangeBounds=this.testRangeBounds(t);this.cors=this.testCORS();this.svg=this.testSVG()}i.prototype.testRangeBounds=function(t){var e,n,i,a,r=false;if(t.createRange){e=t.createRange();if(e.getBoundingClientRect){n=t.createElement("boundtest");n.style.height="123px";n.style.display="block";t.body.appendChild(n);e.selectNode(n);i=e.getBoundingClientRect();a=i.height;if(a===123){r=true}t.body.removeChild(n)}}return r};i.prototype.testCORS=function(){return typeof(new Image).crossOrigin!=="undefined"};i.prototype.testSVG=function(){var t=new Image;var e=document.createElement("canvas");var n=e.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0);e.toDataURL()}catch(t){return false}return true};e.exports=i},{}],23:[function(t,e,n){var i=t("./xhr");var a=t("./utils").decode64;function r(t){this.src=t;this.image=null;var n=this;this.promise=this.hasFabric().then(function(){return n.isInline(t)?Promise.resolve(n.inlineFormatting(t)):i(t)}).then(function(e){return new Promise(function(t){window.html2canvas.svg.fabric.loadSVGFromString(e,n.createCanvas.call(n,t))})})}r.prototype.hasFabric=function(){return!window.html2canvas.svg||!window.html2canvas.svg.fabric?Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg")):Promise.resolve()};r.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)};r.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")};r.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)};r.prototype.createCanvas=function(i){var a=this;return function(t,e){var n=new window.html2canvas.svg.fabric.StaticCanvas("c");a.image=n.lowerCanvasEl;n.setWidth(e.width).setHeight(e.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(t,e)).renderAll();i(n.lowerCanvasEl)}};r.prototype.decode64=function(t){return typeof window.atob==="function"?window.atob(t):a(t)};e.exports=r},{"./utils":26,"./xhr":28}],24:[function(t,e,n){var i=t("./svgcontainer");function a(n,t){this.src=n;this.image=null;var i=this;this.promise=t?new Promise(function(t,e){i.image=new Image;i.image.onload=t;i.image.onerror=e;i.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(n);if(i.image.complete===true){t(i.image)}}):this.hasFabric().then(function(){return new Promise(function(t){window.html2canvas.svg.fabric.parseSVGDocument(n,i.createCanvas.call(i,t))})})}a.prototype=Object.create(i.prototype);e.exports=a},{"./svgcontainer":23}],25:[function(t,e,n){var i=t("./nodecontainer");function a(t,e){i.call(this,t,e)}a.prototype=Object.create(i.prototype);a.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))};a.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,r);case"uppercase":return e.toUpperCase();default:return e}};function r(t,e,n){if(t.length>0){return e+n.toUpperCase()}}e.exports=a},{"./nodecontainer":14}],26:[function(t,e,n){n.smallImage=function t(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"};n.bind=function(t,e){return function(){return t.apply(e,arguments)}};n.decode64=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var n=t.length,i,a,r,o,s,l,u,h;var c="";for(i=0;i<n;i+=4){a=e.indexOf(t[i]);r=e.indexOf(t[i+1]);o=e.indexOf(t[i+2]);s=e.indexOf(t[i+3]);l=a<<2|r>>4;u=(r&15)<<4|o>>2;h=(o&3)<<6|s;if(o===64){c+=String.fromCharCode(l)}else if(s===64||s===-1){c+=String.fromCharCode(l,u)}else{c+=String.fromCharCode(l,u,h)}}return c};n.getBounds=function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect();var n=t.offsetWidth==null?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+n,left:e.left,width:n,height:t.offsetHeight==null?e.height:t.offsetHeight}}return{}};n.offsetBounds=function(t){var e=t.offsetParent?n.offsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}};n.parseBackgrounds=function(t){var e=" \r\n\t",n,i,a,r,o,s=[],l=0,u=0,h,c;var f=function t(){if(n){if(i.substr(0,1)==='"'){i=i.substr(1,i.length-2)}if(i){c.push(i)}if(n.substr(0,1)==="-"&&(r=n.indexOf("-",1)+1)>0){a=n.substr(0,r);n=n.substr(r)}s.push({prefix:a,method:n.toLowerCase(),value:o,args:c,image:null})}c=[];n=a=i=o=""};c=[];n=a=i=o="";t.split("").forEach(function(t){if(l===0&&e.indexOf(t)>-1){return}switch(t){case'"':if(!h){h=t}else if(h===t){h=null}break;case"(":if(h){break}else if(l===0){l=1;o+=t;return}else{u++}break;case")":if(h){break}else if(l===1){if(u===0){l=0;o+=t;f();return}else{u--}}break;case",":if(h){break}else if(l===0){f();return}else if(l===1){if(u===0&&!n.match(/^url$/i)){c.push(i);i="";o+=t;return}}break}o+=t;if(l===0){n+=t}else{i+=t}});f();return s}},{}],27:[function(t,e,n){var i=t("./gradientcontainer");function a(t){i.apply(this,arguments);this.type=t.args[0]==="linear"?i.TYPES.LINEAR:i.TYPES.RADIAL}a.prototype=Object.create(i.prototype);e.exports=a},{"./gradientcontainer":9}],28:[function(t,e,n){function i(i){return new Promise(function(t,e){var n=new XMLHttpRequest;n.open("GET",i);n.onload=function(){if(n.status===200){t(n.responseText)}else{e(new Error(n.statusText))}};n.onerror=function(){e(new Error("Network Error"))};n.send()})}e.exports=i},{}]},{},[4])(4)})});var TD=function t(e){this.ok=false;this.alpha=1;if(e.charAt(0)=="#"){e=e.substr(1,6)}e=e.replace(/ /g,"");e=e.toLowerCase();var h={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};e=h[e]||e;var c=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function t(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),parseFloat(e[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function t(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function t(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function t(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}];for(var n=0;n<c.length;n++){var i=c[n].re;var a=c[n].process;var r=i.exec(e);if(r){var o=a(r);this.r=o[0];this.g=o[1];this.b=o[2];if(o.length>3){this.alpha=o[3]}this.ok=true}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r;this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g;this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b;this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha;this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"};this.toHex=function(){var t=this.r.toString(16);var e=this.g.toString(16);var n=this.b.toString(16);if(t.length==1)t="0"+t;if(e.length==1)e="0"+e;if(n.length==1)n="0"+n;return"#"+t+e+n};this.getHelpXML=function(){var t=new Array;for(var e=0;e<c.length;e++){var n=c[e].example;for(var i=0;i<n.length;i++){t[t.length]=n[i]}}for(var a in h){t[t.length]=a}var r=document.createElement("ul");r.setAttribute("id","rgbcolor-examples");for(var e=0;e<t.length;e++){try{var o=document.createElement("li");var s=new RGBColor(t[e]);var l=document.createElement("div");l.style.cssText="margin: 3px; "+"border: 1px solid black; "+"background:"+s.toHex()+"; "+"color:"+s.toHex();l.appendChild(document.createTextNode("test"));var u=document.createTextNode(" "+t[e]+" -> "+s.toRGB()+" -> "+s.toHex());o.appendChild(l);o.appendChild(u);r.appendChild(o)}catch(t){}}return r}};var BD=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];var OD=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function PD(t,e,n,i){if(isNaN(i)||i<1)return;i|=0;var a,r,o,s,l,u,h,c,f,d,g,p,v,m,_,y,b,w,x,k,S,C,A,E;var M=i+i+1;var R=e-1;var T=n-1;var B=i+1;var O=B*(B+1)/2;var P=new DD;var D=P;for(o=1;o<M;o++){D=D.next=new DD;if(o==B)var N=D}D.next=P;var z=null;var F=null;h=u=0;var L=BD[i];var j=OD[i];for(r=0;r<n;r++){y=b=w=x=c=f=d=g=0;p=B*(k=t[u]);v=B*(S=t[u+1]);m=B*(C=t[u+2]);_=B*(A=t[u+3]);c+=O*k;f+=O*S;d+=O*C;g+=O*A;D=P;for(o=0;o<B;o++){D.r=k;D.g=S;D.b=C;D.a=A;D=D.next}for(o=1;o<B;o++){s=u+((R<o?R:o)<<2);c+=(D.r=k=t[s])*(E=B-o);f+=(D.g=S=t[s+1])*E;d+=(D.b=C=t[s+2])*E;g+=(D.a=A=t[s+3])*E;y+=k;b+=S;w+=C;x+=A;D=D.next}z=P;F=N;for(a=0;a<e;a++){t[u+3]=A=g*L>>j;if(A!=0){A=255/A;t[u]=(c*L>>j)*A;t[u+1]=(f*L>>j)*A;t[u+2]=(d*L>>j)*A}else{t[u]=t[u+1]=t[u+2]=0}c-=p;f-=v;d-=m;g-=_;p-=z.r;v-=z.g;m-=z.b;_-=z.a;s=h+((s=a+i+1)<R?s:R)<<2;y+=z.r=t[s];b+=z.g=t[s+1];w+=z.b=t[s+2];x+=z.a=t[s+3];c+=y;f+=b;d+=w;g+=x;z=z.next;p+=k=F.r;v+=S=F.g;m+=C=F.b;_+=A=F.a;y-=k;b-=S;w-=C;x-=A;F=F.next;u+=4}h+=e}for(a=0;a<e;a++){b=w=x=y=f=d=g=c=0;u=a<<2;p=B*(k=t[u]);v=B*(S=t[u+1]);m=B*(C=t[u+2]);_=B*(A=t[u+3]);c+=O*k;f+=O*S;d+=O*C;g+=O*A;D=P;for(o=0;o<B;o++){D.r=k;D.g=S;D.b=C;D.a=A;D=D.next}l=e;for(o=1;o<=i;o++){u=l+a<<2;c+=(D.r=k=t[u])*(E=B-o);f+=(D.g=S=t[u+1])*E;d+=(D.b=C=t[u+2])*E;g+=(D.a=A=t[u+3])*E;y+=k;b+=S;w+=C;x+=A;D=D.next;if(o<T){l+=e}}u=a;z=P;F=N;for(r=0;r<n;r++){s=u<<2;t[s+3]=A=g*L>>j;if(A>0){A=255/A;t[s]=(c*L>>j)*A;t[s+1]=(f*L>>j)*A;t[s+2]=(d*L>>j)*A}else{t[s]=t[s+1]=t[s+2]=0}c-=p;f-=v;d-=m;g-=_;p-=z.r;v-=z.g;m-=z.b;_-=z.a;s=a+((s=r+B)<T?s:T)*e<<2;c+=y+=z.r=t[s];f+=b+=z.g=t[s+1];d+=w+=z.b=t[s+2];g+=x+=z.a=t[s+3];z=z.next;p+=k=F.r;v+=S=F.g;m+=C=F.b;_+=A=F.a;y-=k;b-=S;w-=C;x-=A;F=F.next;u+=e}}}function DD(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null}var ND=PD;var zD=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;var FD=new RegExp("[\\-\\.0-9"+zD.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]");var LD=new RegExp("^"+zD.source+FD.source+"*(?::"+zD.source+FD.source+"*)?$");var jD=0;var ID=1;var HD=2;var VD=3;var UD=4;var GD=5;var WD=6;var KD=7;function qD(){}qD.prototype={parse:function t(e,n,i){var a=this.domBuilder;a.startDocument();tN(n,n={});YD(e,n,i,a,this.errorHandler);a.endDocument()}};function YD(n,t,i,a,r){function o(t){if(t>65535){t-=65536;var e=55296+(t>>10),n=56320+(t&1023);return String.fromCharCode(e,n)}else{return String.fromCharCode(t)}}function s(t){var e=t.slice(1,-1);if(e in i){return i[e]}else if(e.charAt(0)==="#"){return o(parseInt(e.substr(1).replace("x","0x")))}else{r.error("entity not found:"+t);return t}}function e(t){if(t>p){var e=n.substring(p,t).replace(/&#?\w+;/g,s);f&&l(p);a.characters(e,0,t-p);p=t}}function l(t,e){while(t>=h&&(e=c.exec(n))){u=e.index;h=u+e[0].length;f.lineNumber++}f.columnNumber=t-u+1}var u=0;var h=0;var c=/.*(?:\r\n?|\n)|.*$/g;var f=a.locator;var d=[{currentNSMap:t}];var g={};var p=0;while(true){try{var v=n.indexOf("<",p);if(v<0){if(!n.substr(p).match(/^\s*$/)){var m=a.doc;var _=m.createTextNode(n.substr(p));m.appendChild(_);a.currentElement=_}return}if(v>p){e(v)}switch(n.charAt(v+1)){case"/":var y=n.indexOf(">",v+3);var b=n.substring(v+2,y);var w=d.pop();if(y<0){b=n.substring(v+2).replace(/[\s<].*/,"");r.error("end tag name: "+b+" is not complete:"+w.tagName);y=v+1+b.length}else if(b.match(/\s</)){b=b.replace(/[\s<].*/,"");r.error("end tag name: "+b+" maybe not complete");y=v+1+b.length}var x=w.localNSMap;var k=w.tagName==b;var S=k||w.tagName&&w.tagName.toLowerCase()==b.toLowerCase();if(S){a.endElement(w.uri,w.localName,b);if(x){for(var C in x){a.endPrefixMapping(C)}}if(!k){r.fatalError("end tag name: "+b+" is not match the current start tagName:"+w.tagName)}}else{d.push(w)}y++;break;case"?":f&&l(v);y=nN(n,v,a);break;case"!":f&&l(v);y=eN(n,v,a,r);break;default:f&&l(v);var A=new iN;var E=d[d.length-1].currentNSMap;var y=ZD(n,v,A,E,s,r);var M=A.length;if(!A.closed&&QD(n,y,A.tagName,g)){A.closed=true;if(!i.nbsp){r.warning("unclosed xml attribute")}}if(f&&M){var R=XD(f,{});for(var T=0;T<M;T++){var B=A[T];l(B.offset);B.locator=XD(f,{})}a.locator=R;if(JD(A,a,E)){d.push(A)}a.locator=f}else{if(JD(A,a,E)){d.push(A)}}if(A.uri==="http://www.w3.org/1999/xhtml"&&!A.closed){y=$D(n,y,A.tagName,s,a)}else{y++}}}catch(t){r.error("element parse error: "+t);y=-1}if(y>p){p=y}else{e(Math.max(v,p)+1)}}}function XD(t,e){e.lineNumber=t.lineNumber;e.columnNumber=t.columnNumber;return e}function ZD(t,e,n,i,a,r){var o;var s;var l=++e;var u=jD;while(true){var h=t.charAt(l);switch(h){case"=":if(u===ID){o=t.slice(e,l);u=VD}else if(u===HD){u=VD}else{throw new Error("attribute equal must after attrName")}break;case"'":case'"':if(u===VD||u===ID){if(u===ID){r.warning('attribute value must after "="');o=t.slice(e,l)}e=l+1;l=t.indexOf(h,e);if(l>0){s=t.slice(e,l).replace(/&#?\w+;/g,a);n.add(o,s,e-1);u=GD}else{throw new Error("attribute value no end '"+h+"' match")}}else if(u==UD){s=t.slice(e,l).replace(/&#?\w+;/g,a);n.add(o,s,e);r.warning('attribute "'+o+'" missed start quot('+h+")!!");e=l+1;u=GD}else{throw new Error('attribute value must after "="')}break;case"/":switch(u){case jD:n.setTagName(t.slice(e,l));case GD:case WD:case KD:u=KD;n.closed=true;case UD:case ID:case HD:break;default:throw new Error("attribute invalid close char('/')")}break;case"":r.error("unexpected end of input");if(u==jD){n.setTagName(t.slice(e,l))}return l;case">":switch(u){case jD:n.setTagName(t.slice(e,l));case GD:case WD:case KD:break;case UD:case ID:s=t.slice(e,l);if(s.slice(-1)==="/"){n.closed=true;s=s.slice(0,-1)}case HD:if(u===HD){s=o}if(u==UD){r.warning('attribute "'+s+'" missed quot(")!!');n.add(o,s.replace(/&#?\w+;/g,a),e)}else{if(i[""]!=="http://www.w3.org/1999/xhtml"||!s.match(/^(?:disabled|checked|selected)$/i)){r.warning('attribute "'+s+'" missed value!! "'+s+'" instead!!')}n.add(s,s,e)}break;case VD:throw new Error("attribute value missed!!")}return l;case"":h=" ";default:if(h<=" "){switch(u){case jD:n.setTagName(t.slice(e,l));u=WD;break;case ID:o=t.slice(e,l);u=HD;break;case UD:var s=t.slice(e,l).replace(/&#?\w+;/g,a);r.warning('attribute "'+s+'" missed quot(")!!');n.add(o,s,e);case GD:u=WD;break}}else{switch(u){case HD:var c=n.tagName;if(i[""]!=="http://www.w3.org/1999/xhtml"||!o.match(/^(?:disabled|checked|selected)$/i)){r.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!')}n.add(o,o,e);e=l;u=ID;break;case GD:r.warning('attribute space is required"'+o+'"!!');case WD:u=ID;e=l;break;case VD:u=UD;e=l;break;case KD:throw new Error("elements closed character '/' and '>' must be connected to")}}}l++}}function JD(t,e,n){var i=t.tagName;var a=null;var r=t.length;while(r--){var o=t[r];var s=o.qName;var l=o.value;var u=s.indexOf(":");if(u>0){var h=o.prefix=s.slice(0,u);var c=s.slice(u+1);var f=h==="xmlns"&&c}else{c=s;h=null;f=s==="xmlns"&&""}o.localName=c;if(f!==false){if(a==null){a={};tN(n,n={})}n[f]=a[f]=l;o.uri="http://www.w3.org/2000/xmlns/";e.startPrefixMapping(f,l)}}var r=t.length;while(r--){o=t[r];var h=o.prefix;if(h){if(h==="xml"){o.uri="http://www.w3.org/XML/1998/namespace"}if(h!=="xmlns"){o.uri=n[h||""]}}}var u=i.indexOf(":");if(u>0){h=t.prefix=i.slice(0,u);c=t.localName=i.slice(u+1)}else{h=null;c=t.localName=i}var d=t.uri=n[h||""];e.startElement(d,c,i,t);if(t.closed){e.endElement(d,c,i);if(a){for(h in a){e.endPrefixMapping(h)}}}else{t.currentNSMap=n;t.localNSMap=a;return true}}function $D(t,e,n,i,a){if(/^(?:script|textarea)$/i.test(n)){var r=t.indexOf("</"+n+">",e);var o=t.substring(e+1,r);if(/[&<]/.test(o)){if(/^script$/i.test(n)){a.characters(o,0,o.length);return r}o=o.replace(/&#?\w+;/g,i);a.characters(o,0,o.length);return r}}return e+1}function QD(t,e,n,i){var a=i[n];if(a==null){a=t.lastIndexOf("</"+n+">");if(a<e){a=t.lastIndexOf("</"+n)}i[n]=a}return a<e}function tN(t,e){for(var n in t){e[n]=t[n]}}function eN(t,e,n,i){var a=t.charAt(e+2);switch(a){case"-":if(t.charAt(e+3)==="-"){var r=t.indexOf("--\x3e",e+4);if(r>e){n.comment(t,e+4,r-e-4);return r+3}else{i.error("Unclosed comment");return-1}}else{return-1}default:if(t.substr(e+3,6)=="CDATA["){var r=t.indexOf("]]>",e+9);n.startCDATA();n.characters(t,e+9,r-e-9);n.endCDATA();return r+3}var o=rN(t,e);var s=o.length;if(s>1&&/!doctype/i.test(o[0][0])){var l=o[1][0];var u=s>3&&/^public$/i.test(o[2][0])&&o[3][0];var h=s>4&&o[4][0];var c=o[s-1];n.startDTD(l,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),h&&h.replace(/^(['"])(.*?)\1$/,"$2"));n.endDTD();return c.index+c[0].length}}return-1}function nN(t,e,n){var i=t.indexOf("?>",e);if(i){var a=t.substring(e,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(a){var r=a[0].length;n.processingInstruction(a[1],a[2]);return i+2}else{return-1}}return-1}function iN(t){}iN.prototype={setTagName:function t(e){if(!LD.test(e)){throw new Error("invalid tagName:"+e)}this.tagName=e},add:function t(e,n,i){if(!LD.test(e)){throw new Error("invalid attribute:"+e)}this[this.length++]={qName:e,value:n,offset:i}},length:0,getLocalName:function t(e){return this[e].localName},getLocator:function t(e){return this[e].locator},getQName:function t(e){return this[e].qName},getURI:function t(e){return this[e].uri},getValue:function t(e){return this[e].value}};function aN(t,e){t.__proto__=e;return t}if(!(aN({},aN.prototype)instanceof aN)){aN=function t(e,n){function i(){}i.prototype=n;i=new i;for(n in e){i[n]=e[n]}return i}}function rN(t,e){var n;var i=[];var a=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;a.lastIndex=e;a.exec(t);while(n=a.exec(t)){i.push(n);if(n[1])return i}}var oN=qD;var sN={XMLReader:oN};function lN(t,e){for(var n in t){e[n]=t[n]}}function uN(t,e){var n=t.prototype;if(Object.create){var i=Object.create(e.prototype);n.__proto__=i}if(!(n instanceof e)){var a=function t(){};a.prototype=e.prototype;a=new a;lN(n,a);t.prototype=n=a}if(n.constructor!=t){if(typeof t!="function"){console.error("unknow Class:"+t)}n.constructor=t}}var hN="http://www.w3.org/1999/xhtml";var cN={};var fN=cN.ELEMENT_NODE=1;var dN=cN.ATTRIBUTE_NODE=2;var gN=cN.TEXT_NODE=3;var pN=cN.CDATA_SECTION_NODE=4;var vN=cN.ENTITY_REFERENCE_NODE=5;var mN=cN.ENTITY_NODE=6;var _N=cN.PROCESSING_INSTRUCTION_NODE=7;var yN=cN.COMMENT_NODE=8;var bN=cN.DOCUMENT_NODE=9;var wN=cN.DOCUMENT_TYPE_NODE=10;var xN=cN.DOCUMENT_FRAGMENT_NODE=11;var kN=cN.NOTATION_NODE=12;var SN={};var CN={};var AN=SN.INDEX_SIZE_ERR=(CN[1]="Index size error",1);var EN=SN.DOMSTRING_SIZE_ERR=(CN[2]="DOMString size error",2);var MN=SN.HIERARCHY_REQUEST_ERR=(CN[3]="Hierarchy request error",3);var RN=SN.WRONG_DOCUMENT_ERR=(CN[4]="Wrong document",4);var TN=SN.INVALID_CHARACTER_ERR=(CN[5]="Invalid character",5);var BN=SN.NO_DATA_ALLOWED_ERR=(CN[6]="No data allowed",6);var ON=SN.NO_MODIFICATION_ALLOWED_ERR=(CN[7]="No modification allowed",7);var PN=SN.NOT_FOUND_ERR=(CN[8]="Not found",8);var DN=SN.NOT_SUPPORTED_ERR=(CN[9]="Not supported",9);var NN=SN.INUSE_ATTRIBUTE_ERR=(CN[10]="Attribute in use",10);var zN=SN.INVALID_STATE_ERR=(CN[11]="Invalid state",11);var FN=SN.SYNTAX_ERR=(CN[12]="Syntax error",12);var LN=SN.INVALID_MODIFICATION_ERR=(CN[13]="Invalid modification",13);var jN=SN.NAMESPACE_ERR=(CN[14]="Invalid namespace",14);var IN=SN.INVALID_ACCESS_ERR=(CN[15]="Invalid access",15);function HN(t,e){if(e instanceof Error){var n=e}else{n=this;Error.call(this,CN[t]);this.message=CN[t];if(Error.captureStackTrace)Error.captureStackTrace(this,HN)}n.code=t;if(e)this.message=this.message+": "+e;return n}HN.prototype=Error.prototype;lN(SN,HN);function VN(){}VN.prototype={length:0,item:function t(e){return this[e]||null},toString:function t(e,n){for(var i=[],a=0;a<this.length;a++){wz(this[a],i,e,n)}return i.join("")}};function UN(t,e){this._node=t;this._refresh=e;GN(this)}function GN(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!=e){var n=t._refresh(t._node);Sz(t,"length",n.length);lN(n,t);t._inc=e}}UN.prototype.item=function(t){GN(this);return this[t]};uN(UN,VN);function WN(){}function KN(t,e){var n=t.length;while(n--){if(t[n]===e){return n}}}function qN(t,e,n,i){if(i){e[KN(e,i)]=n}else{e[e.length++]=n}if(t){n.ownerElement=t;var a=t.ownerDocument;if(a){i&&ez(a,t,i);tz(a,t,n)}}}function YN(t,e,n){var i=KN(e,n);if(i>=0){var a=e.length-1;while(i<a){e[i]=e[++i]}e.length=a;if(t){var r=t.ownerDocument;if(r){ez(r,t,n);n.ownerElement=null}}}else{throw HN(PN,new Error(t.tagName+"@"+n))}}WN.prototype={length:0,item:VN.prototype.item,getNamedItem:function t(e){var n=this.length;while(n--){var i=this[n];if(i.nodeName==e){return i}}},setNamedItem:function t(e){var n=e.ownerElement;if(n&&n!=this._ownerElement){throw new HN(NN)}var i=this.getNamedItem(e.nodeName);qN(this._ownerElement,this,e,i);return i},setNamedItemNS:function t(e){var n=e.ownerElement,i;if(n&&n!=this._ownerElement){throw new HN(NN)}i=this.getNamedItemNS(e.namespaceURI,e.localName);qN(this._ownerElement,this,e,i);return i},removeNamedItem:function t(e){var n=this.getNamedItem(e);YN(this._ownerElement,this,n);return n},removeNamedItemNS:function t(e,n){var i=this.getNamedItemNS(e,n);YN(this._ownerElement,this,i);return i},getNamedItemNS:function t(e,n){var i=this.length;while(i--){var a=this[i];if(a.localName==n&&a.namespaceURI==e){return a}}return null}};function XN(t){this._features={};if(t){for(var e in t){this._features=t[e]}}}XN.prototype={hasFeature:function t(e,n){var i=this._features[e.toLowerCase()];if(i&&(!n||n in i)){return true}else{return false}},createDocument:function t(e,n,i){var a=new QN;a.implementation=this;a.childNodes=new VN;a.doctype=i;if(i){a.appendChild(i)}if(n){var r=a.createElementNS(e,n);a.appendChild(r)}return a},createDocumentType:function t(e,n,i){var a=new fz;a.name=e;a.nodeName=e;a.publicId=n;a.systemId=i;return a}};function ZN(){}ZN.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function t(e,n){return az(this,e,n)},replaceChild:function t(e,n){this.insertBefore(e,n);if(n){this.removeChild(n)}},removeChild:function t(e){return iz(this,e)},appendChild:function t(e){return this.insertBefore(e,null)},hasChildNodes:function t(){return this.firstChild!=null},cloneNode:function t(e){return kz(this.ownerDocument||this,this,e)},normalize:function t(){var e=this.firstChild;while(e){var n=e.nextSibling;if(n&&n.nodeType==gN&&e.nodeType==gN){this.removeChild(n);e.appendData(n.data)}else{e.normalize();e=n}}},isSupported:function t(e,n){return this.ownerDocument.implementation.hasFeature(e,n)},hasAttributes:function t(){return this.attributes.length>0},lookupPrefix:function t(e){var n=this;while(n){var i=n._nsMap;if(i){for(var a in i){if(i[a]==e){return a}}}n=n.nodeType==dN?n.ownerDocument:n.parentNode}return null},lookupNamespaceURI:function t(e){var n=this;while(n){var i=n._nsMap;if(i){if(e in i){return i[e]}}n=n.nodeType==dN?n.ownerDocument:n.parentNode}return null},isDefaultNamespace:function t(e){var n=this.lookupPrefix(e);return n==null}};function JN(t){return t=="<"&&"&lt;"||t==">"&&"&gt;"||t=="&"&&"&amp;"||t=='"'&&"&quot;"||"&#"+t.charCodeAt()+";"}lN(cN,ZN);lN(cN,ZN.prototype);function $N(t,e){if(e(t)){return true}if(t=t.firstChild){do{if($N(t,e)){return true}}while(t=t.nextSibling)}}function QN(){}function tz(t,e,n){t&&t._inc++;var i=n.namespaceURI;if(i=="http://www.w3.org/2000/xmlns/"){e._nsMap[n.prefix?n.localName:""]=n.value}}function ez(t,e,n,i){t&&t._inc++;var a=n.namespaceURI;if(a=="http://www.w3.org/2000/xmlns/"){delete e._nsMap[n.prefix?n.localName:""]}}function nz(t,e,n){if(t&&t._inc){t._inc++;var i=e.childNodes;if(n){i[i.length++]=n}else{var a=e.firstChild;var r=0;while(a){i[r++]=a;a=a.nextSibling}i.length=r}}}function iz(t,e){var n=e.previousSibling;var i=e.nextSibling;if(n){n.nextSibling=i}else{t.firstChild=i}if(i){i.previousSibling=n}else{t.lastChild=n}nz(t.ownerDocument,t);return e}function az(t,e,n){var i=e.parentNode;if(i){i.removeChild(e)}if(e.nodeType===xN){var a=e.firstChild;if(a==null){return e}var r=e.lastChild}else{a=r=e}var o=n?n.previousSibling:t.lastChild;a.previousSibling=o;r.nextSibling=n;if(o){o.nextSibling=a}else{t.firstChild=a}if(n==null){t.lastChild=r}else{n.previousSibling=r}do{a.parentNode=t}while(a!==r&&(a=a.nextSibling));nz(t.ownerDocument||t,t);if(e.nodeType==xN){e.firstChild=e.lastChild=null}return e}function rz(t,e){var n=e.parentNode;if(n){var i=t.lastChild;n.removeChild(e);var i=t.lastChild}var i=t.lastChild;e.parentNode=t;e.previousSibling=i;e.nextSibling=null;if(i){i.nextSibling=e}else{t.firstChild=e}t.lastChild=e;nz(t.ownerDocument,t,e);return e}QN.prototype={nodeName:"#document",nodeType:bN,doctype:null,documentElement:null,_inc:1,insertBefore:function t(e,n){if(e.nodeType==xN){var i=e.firstChild;while(i){var a=i.nextSibling;this.insertBefore(i,n);i=a}return e}if(this.documentElement==null&&e.nodeType==fN){this.documentElement=e}return az(this,e,n),e.ownerDocument=this,e},removeChild:function t(e){if(this.documentElement==e){this.documentElement=null}return iz(this,e)},importNode:function t(e,n){return xz(this,e,n)},getElementById:function t(e){var n=null;$N(this.documentElement,function(t){if(t.nodeType==fN){if(t.getAttribute("id")==e){n=t;return true}}});return n},createElement:function t(e){var n=new oz;n.ownerDocument=this;n.nodeName=e;n.tagName=e;n.childNodes=new VN;var i=n.attributes=new WN;i._ownerElement=n;return n},createDocumentFragment:function t(){var e=new vz;e.ownerDocument=this;e.childNodes=new VN;return e},createTextNode:function t(e){var n=new uz;n.ownerDocument=this;n.appendData(e);return n},createComment:function t(e){var n=new hz;n.ownerDocument=this;n.appendData(e);return n},createCDATASection:function t(e){var n=new cz;n.ownerDocument=this;n.appendData(e);return n},createProcessingInstruction:function t(e,n){var i=new mz;i.ownerDocument=this;i.tagName=i.target=e;i.nodeValue=i.data=n;return i},createAttribute:function t(e){var n=new sz;n.ownerDocument=this;n.name=e;n.nodeName=e;n.localName=e;n.specified=true;return n},createEntityReference:function t(e){var n=new pz;n.ownerDocument=this;n.nodeName=e;return n},createElementNS:function t(e,n){var i=new oz;var a=n.split(":");var r=i.attributes=new WN;i.childNodes=new VN;i.ownerDocument=this;i.nodeName=n;i.tagName=n;i.namespaceURI=e;if(a.length==2){i.prefix=a[0];i.localName=a[1]}else{i.localName=n}r._ownerElement=i;return i},createAttributeNS:function t(e,n){var i=new sz;var a=n.split(":");i.ownerDocument=this;i.nodeName=n;i.name=n;i.namespaceURI=e;i.specified=true;if(a.length==2){i.prefix=a[0];i.localName=a[1]}else{i.localName=n}return i}};uN(QN,ZN);function oz(){this._nsMap={}}oz.prototype={nodeType:fN,hasAttribute:function t(e){return this.getAttributeNode(e)!=null},getAttribute:function t(e){var n=this.getAttributeNode(e);return n&&n.value||""},getAttributeNode:function t(e){return this.attributes.getNamedItem(e)},setAttribute:function t(e,n){var i=this.ownerDocument.createAttribute(e);i.value=i.nodeValue=""+n;this.setAttributeNode(i)},removeAttribute:function t(e){var n=this.getAttributeNode(e);n&&this.removeAttributeNode(n)},appendChild:function t(e){if(e.nodeType===xN){return this.insertBefore(e,null)}else{return rz(this,e)}},setAttributeNode:function t(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function t(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function t(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function t(e,n){var i=this.getAttributeNodeNS(e,n);i&&this.removeAttributeNode(i)},hasAttributeNS:function t(e,n){return this.getAttributeNodeNS(e,n)!=null},getAttributeNS:function t(e,n){var i=this.getAttributeNodeNS(e,n);return i&&i.value||""},setAttributeNS:function t(e,n,i){var a=this.ownerDocument.createAttributeNS(e,n);a.value=a.nodeValue=""+i;this.setAttributeNode(a)},getAttributeNodeNS:function t(e,n){return this.attributes.getNamedItemNS(e,n)},getElementsByTagName:function t(i){return new UN(this,function(e){var n=[];$N(e,function(t){if(t!==e&&t.nodeType==fN&&(i==="*"||t.tagName==i)){n.push(t)}});return n})},getElementsByTagNameNS:function t(i,a){return new UN(this,function(e){var n=[];$N(e,function(t){if(t!==e&&t.nodeType===fN&&(i==="*"||t.namespaceURI===i)&&(a==="*"||t.localName==a)){n.push(t)}});return n})}};QN.prototype.getElementsByTagName=oz.prototype.getElementsByTagName;QN.prototype.getElementsByTagNameNS=oz.prototype.getElementsByTagNameNS;uN(oz,ZN);function sz(){}sz.prototype.nodeType=dN;uN(sz,ZN);function lz(){}lz.prototype={data:"",substringData:function t(e,n){return this.data.substring(e,e+n)},appendData:function t(e){e=this.data+e;this.nodeValue=this.data=e;this.length=e.length},insertData:function t(e,n){this.replaceData(e,0,n)},appendChild:function t(e){throw new Error(CN[MN])},deleteData:function t(e,n){this.replaceData(e,n,"")},replaceData:function t(e,n,i){var a=this.data.substring(0,e);var r=this.data.substring(e+n);i=a+i+r;this.nodeValue=this.data=i;this.length=i.length}};uN(lz,ZN);function uz(){}uz.prototype={nodeName:"#text",nodeType:gN,splitText:function t(e){var n=this.data;var i=n.substring(e);n=n.substring(0,e);this.data=this.nodeValue=n;this.length=n.length;var a=this.ownerDocument.createTextNode(i);if(this.parentNode){this.parentNode.insertBefore(a,this.nextSibling)}return a}};uN(uz,lz);function hz(){}hz.prototype={nodeName:"#comment",nodeType:yN};uN(hz,lz);function cz(){}cz.prototype={nodeName:"#cdata-section",nodeType:pN};uN(cz,lz);function fz(){}fz.prototype.nodeType=wN;uN(fz,ZN);function dz(){}dz.prototype.nodeType=kN;uN(dz,ZN);function gz(){}gz.prototype.nodeType=mN;uN(gz,ZN);function pz(){}pz.prototype.nodeType=vN;uN(pz,ZN);function vz(){}vz.prototype.nodeName="#document-fragment";vz.prototype.nodeType=xN;uN(vz,ZN);function mz(){}mz.prototype.nodeType=_N;uN(mz,ZN);function _z(){}_z.prototype.serializeToString=function(t,e,n){return yz.call(t,e,n)};ZN.prototype.toString=yz;function yz(t,e){var n=[];var i=this.nodeType==9?this.documentElement:this;var a=i.prefix;var r=i.namespaceURI;if(r&&a==null){var a=i.lookupPrefix(r);if(a==null){var o=[{namespace:r,prefix:null}]}}wz(this,n,t,e,o);return n.join("")}function bz(t,e,n){var i=t.prefix||"";var a=t.namespaceURI;if(!i&&!a){return false}if(i==="xml"&&a==="http://www.w3.org/XML/1998/namespace"||a=="http://www.w3.org/2000/xmlns/"){return false}var r=n.length;while(r--){var o=n[r];if(o.prefix==i){return o.namespace!=a}}return true}function wz(t,e,n,i,a){if(i){t=i(t);if(t){if(typeof t=="string"){e.push(t);return}}else{return}}switch(t.nodeType){case fN:if(!a)a=[];var r=a.length;var o=t.attributes;var s=o.length;var l=t.firstChild;var u=t.tagName;n=hN===t.namespaceURI||n;e.push("<",u);for(var h=0;h<s;h++){var c=o.item(h);if(c.prefix=="xmlns"){a.push({prefix:c.localName,namespace:c.value})}else if(c.nodeName=="xmlns"){a.push({prefix:"",namespace:c.value})}}for(var h=0;h<s;h++){var c=o.item(h);if(bz(c,n,a)){var f=c.prefix||"";var d=c.namespaceURI;var g=f?" xmlns:"+f:" xmlns";e.push(g,'="',d,'"');a.push({prefix:f,namespace:d})}wz(c,e,n,i,a)}if(bz(t,n,a)){var f=t.prefix||"";var d=t.namespaceURI;var g=f?" xmlns:"+f:" xmlns";e.push(g,'="',d,'"');a.push({prefix:f,namespace:d})}if(l||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){e.push(">");if(n&&/^script$/i.test(u)){while(l){if(l.data){e.push(l.data)}else{wz(l,e,n,i,a)}l=l.nextSibling}}else{while(l){wz(l,e,n,i,a);l=l.nextSibling}}e.push("</",u,">")}else{e.push("/>")}return;case bN:case xN:var l=t.firstChild;while(l){wz(l,e,n,i,a);l=l.nextSibling}return;case dN:return e.push(" ",t.name,'="',t.value.replace(/[<&"]/g,JN),'"');case gN:return e.push(t.data.replace(/[<&]/g,JN));case pN:return e.push("<![CDATA[",t.data,"]]>");case yN:return e.push("\x3c!--",t.data,"--\x3e");case wN:var p=t.publicId;var v=t.systemId;e.push("<!DOCTYPE ",t.name);if(p){e.push(' PUBLIC "',p);if(v&&v!="."){e.push('" "',v)}e.push('">')}else if(v&&v!="."){e.push(' SYSTEM "',v,'">')}else{var m=t.internalSubset;if(m){e.push(" [",m,"]")}e.push(">")}return;case _N:return e.push("<?",t.target," ",t.data,"?>");case vN:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function xz(t,e,n){var i;switch(e.nodeType){case fN:i=e.cloneNode(false);i.ownerDocument=t;case xN:break;case dN:n=true;break}if(!i){i=e.cloneNode(false)}i.ownerDocument=t;i.parentNode=null;if(n){var a=e.firstChild;while(a){i.appendChild(xz(t,a,n));a=a.nextSibling}}return i}function kz(t,e,n){var i=new e.constructor;for(var a in e){var r=e[a];if(ie(r)!="object"){if(r!=i[a]){i[a]=r}}}if(e.childNodes){i.childNodes=new VN}i.ownerDocument=t;switch(i.nodeType){case fN:var o=e.attributes;var s=i.attributes=new WN;var l=o.length;s._ownerElement=i;for(var u=0;u<l;u++){i.setAttributeNode(kz(t,o.item(u),true))}break;case dN:n=true}if(n){var h=e.firstChild;while(h){i.appendChild(kz(t,h,n));h=h.nextSibling}}return i}function Sz(t,e,n){t[e]=n}try{if(Object.defineProperty){var Cz=function t(e){switch(e.nodeType){case fN:case xN:var n=[];e=e.firstChild;while(e){if(e.nodeType!==7&&e.nodeType!==8){n.push(t(e))}e=e.nextSibling}return n.join("");default:return e.nodeValue}};Object.defineProperty(UN.prototype,"length",{get:function t(){GN(this);return this.$$length}});Object.defineProperty(ZN.prototype,"textContent",{get:function t(){return Cz(this)},set:function t(e){switch(this.nodeType){case fN:case xN:while(this.firstChild){this.removeChild(this.firstChild)}if(e||String(e)){this.appendChild(this.ownerDocument.createTextNode(e))}break;default:this.data=e;this.value=e;this.nodeValue=e}}});Sz=function t(e,n,i){e["$$"+n]=i}}}catch(t){}var Az=XN;var Ez=_z;var Mz={DOMImplementation:Az,XMLSerializer:Ez};var Rz=zT(function(t,e){function n(t){this.options=t||{locator:{}}}n.prototype.parseFromString=function(t,e){var n=this.options;var i=new d;var a=n.domBuilder||new h;var r=n.errorHandler;var o=n.locator;var s=n.xmlns||{};var l={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};if(o){a.setDocumentLocator(o)}i.errorHandler=u(r,a,o);i.domBuilder=n.domBuilder||a;if(/\/x?html?$/.test(e)){l.nbsp="";l.copy="";s[""]="http://www.w3.org/1999/xhtml"}s.xml=s.xml||"http://www.w3.org/XML/1998/namespace";if(t){i.parse(t,s,l)}else{i.errorHandler.error("invalid doc source")}return a.doc};function u(i,t,a){if(!i){if(t instanceof h){return t}i=t}var r={};var o=i instanceof Function;a=a||{};function e(e){var n=i[e];if(!n&&o){n=i.length==2?function(t){i(e,t)}:i}r[e]=n&&function(t){n("[xmldom "+e+"]\t"+t+s(a))}||function(){}}e("warning");e("error");e("fatalError");return r}function h(){this.cdata=false}function c(t,e){e.lineNumber=t.lineNumber;e.columnNumber=t.columnNumber}h.prototype={startDocument:function t(){this.doc=(new i).createDocument(null,null,null);if(this.locator){this.doc.documentURI=this.locator.systemId}},startElement:function t(e,n,i,a){var r=this.doc;var o=r.createElementNS(e,i||n);var s=a.length;f(this,o);this.currentElement=o;this.locator&&c(this.locator,o);for(var l=0;l<s;l++){var e=a.getURI(l);var u=a.getValue(l);var i=a.getQName(l);var h=r.createAttributeNS(e,i);this.locator&&c(a.getLocator(l),h);h.value=h.nodeValue=u;o.setAttributeNode(h)}},endElement:function t(e,n,i){var a=this.currentElement;var r=a.tagName;this.currentElement=a.parentNode},startPrefixMapping:function t(e,n){},endPrefixMapping:function t(e){},processingInstruction:function t(e,n){var i=this.doc.createProcessingInstruction(e,n);this.locator&&c(this.locator,i);f(this,i)},ignorableWhitespace:function t(e,n,i){},characters:function t(e,n,i){e=r.apply(this,arguments);if(e){if(this.cdata){var a=this.doc.createCDATASection(e)}else{var a=this.doc.createTextNode(e)}if(this.currentElement){this.currentElement.appendChild(a)}else if(/^\s*$/.test(e)){this.doc.appendChild(a)}this.locator&&c(this.locator,a)}},skippedEntity:function t(e){},endDocument:function t(){this.doc.normalize()},setDocumentLocator:function t(e){if(this.locator=e){e.lineNumber=0}},comment:function t(e,n,i){e=r.apply(this,arguments);var a=this.doc.createComment(e);this.locator&&c(this.locator,a);f(this,a)},startCDATA:function t(){this.cdata=true},endCDATA:function t(){this.cdata=false},startDTD:function t(e,n,i){var a=this.doc.implementation;if(a&&a.createDocumentType){var r=a.createDocumentType(e,n,i);this.locator&&c(this.locator,r);f(this,r)}},warning:function t(e){console.warn("[xmldom warning]\t"+e,s(this.locator))},error:function t(e){console.error("[xmldom error]\t"+e,s(this.locator))},fatalError:function t(e){console.error("[xmldom fatalError]\t"+e,s(this.locator));throw e}};function s(t){if(t){return"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}}function r(t,e,n){if(typeof t=="string"){return t.substr(e,n)}else{if(t.length>=e+n||e){return new java.lang.String(t,e,n)+""}return t}}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){h.prototype[t]=function(){return null}});function f(t,e){if(!t.currentElement){t.doc.appendChild(e)}else{t.currentElement.appendChild(e)}}var d=sN.XMLReader;var i=e.DOMImplementation=Mz.DOMImplementation;e.XMLSerializer=Mz.XMLSerializer;e.DOMParser=n});var Tz=Rz.DOMImplementation;var Bz=Rz.XMLSerializer;var Oz=Rz.DOMParser;function Pz(t,e,n){if(t==null&&e==null&&n==null){var i=document.querySelectorAll("svg");for(var a=0;a<i.length;a++){var r=i[a];var o=document.createElement("canvas");o.width=r.clientWidth;o.height=r.clientHeight;r.parentNode.insertBefore(o,r);r.parentNode.removeChild(r);var s=document.createElement("div");s.appendChild(r);Pz(o,s.innerHTML)}return}if(typeof t=="string"){t=document.getElementById(t)}if(t.svg!=null)t.svg.stop();var l=zz(n||{});if(!(t.childNodes.length==1&&t.childNodes[0].nodeName=="OBJECT"))t.svg=l;var u=t.getContext("2d");if(typeof e.documentElement!="undefined"){l.loadXmlDoc(u,e)}else if(e.substr(0,1)=="<"){l.loadXml(u,e)}else{l.load(u,e)}}function Dz(){var t;if(typeof Element.prototype.matches!="undefined"){t=function t(e,n){return e.matches(n)}}else if(typeof Element.prototype.webkitMatchesSelector!="undefined"){t=function t(e,n){return e.webkitMatchesSelector(n)}}else if(typeof Element.prototype.mozMatchesSelector!="undefined"){t=function t(e,n){return e.mozMatchesSelector(n)}}else if(typeof Element.prototype.msMatchesSelector!="undefined"){t=function t(e,n){return e.msMatchesSelector(n)}}else if(typeof Element.prototype.oMatchesSelector!="undefined"){t=function t(e,n){return e.oMatchesSelector(n)}}else{if(typeof jQuery=="function"||typeof Zepto=="function"){t=function t(e,n){return $(e).is(n)}}if(typeof t=="undefined"){t=Sizzle.matchesSelector}}return t}function Nz(a){var r=[0,0,0];var t=/(\[[^\]]+\])/g;var e=/(#[^\s\+>~\.\[:]+)/g;var n=/(\.[^\s\+>~\.\[:]+)/g;var i=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi;var o=/(:[\w-]+\([^\)]*\))/gi;var s=/(:[^\s\+>~\.\[:]+)/g;var l=/([^\s\+>~\.\[:]+)/g;var u=function t(e,n){var i=a.match(e);if(i==null){return}r[n]+=i.length;a=a.replace(e," ")};a=a.replace(/:not\(([^\)]*)\)/g,"     $1 ");a=a.replace(/{[^]*/gm," ");u(t,1);u(e,0);u(n,1);u(i,2);u(o,1);u(s,1);a=a.replace(/[\*\s\+>~]/g," ");a=a.replace(/[#\.]/g," ");u(l,2);return r.join("")}function zz(t){var O={opts:t};var u=Dz();if(typeof CanvasRenderingContext2D!="undefined"){CanvasRenderingContext2D.prototype.drawSvg=function(t,e,n,i,a,r){var o={ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true,offsetX:e,offsetY:n,scaleWidth:i,scaleHeight:a};for(var s in r){if(r.hasOwnProperty(s)){o[s]=r[s]}}Pz(this.canvas,t,o)}}O.FRAMERATE=30;O.MAX_VIRTUAL_PIXELS=3e4;O.log=function(t){};if(O.opts.log==true&&typeof console!="undefined"){O.log=function(t){console.log(t)}}O.init=function(t){var e=0;O.UniqueId=function(){e++;return"canvg"+e};O.Definitions={};O.Styles={};O.StylesSpecificity={};O.Animations=[];O.Images=[];O.ctx=t;O.ViewPort=new function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(t){if(t!=null&&typeof t=="number")return t;if(t=="x")return this.width();if(t=="y")return this.height();return Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}};O.init();O.ImagesLoaded=function(){for(var t=0;t<O.Images.length;t++){if(!O.Images[t].loaded)return false}return true};O.trim=function(t){return t.replace(/^\s+|\s+$/g,"")};O.compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")};O.ajax=function(t){var e;if(window.XMLHttpRequest){e=new XMLHttpRequest}else{e=new ActiveXObject("Microsoft.XMLHTTP")}if(e){e.open("GET",t,false);e.send(null);return e.responseText}return null};O.parseXml=function(t){if(typeof Windows!="undefined"&&typeof Windows.Data!="undefined"&&typeof Windows.Data.Xml!="undefined"){var e=new Windows.Data.Xml.Dom.XmlDocument;var n=new Windows.Data.Xml.Dom.XmlLoadSettings;n.prohibitDtd=false;e.loadXml(t,n);return e}else if(window.DOMParser){var i=new DOMParser;return i.parseFromString(t,"text/xml")}else{t=t.replace(/<!DOCTYPE svg[^>]*>/,"");var e=new ActiveXObject("Microsoft.XMLDOM");e.async="false";e.loadXML(t);return e}};O.Property=function(t,e){this.name=t;this.value=e};O.Property.prototype.getValue=function(){return this.value};O.Property.prototype.hasValue=function(){return this.value!=null&&this.value!=""};O.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);if((this.value+"").match(/%$/)){t=t/100}return t};O.Property.prototype.valueOrDefault=function(t){if(this.hasValue())return this.value;return t};O.Property.prototype.numValueOrDefault=function(t){if(this.hasValue())return this.numValue();return t};O.Property.prototype.addOpacity=function(t){var e=this.value;if(t.value!=null&&t.value!=""&&typeof this.value=="string"){var n=new TD(this.value);if(n.ok){e="rgba("+n.r+", "+n.g+", "+n.b+", "+t.numValue()+")"}}return new O.Property(this.name,e)};O.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);if(t){t=t[1]}if(!t){t=this.value}return O.Definitions[t]};O.Property.prototype.isUrlDefinition=function(){return this.value.indexOf("url(")==0};O.Property.prototype.getFillStyleDefinition=function(t,e){var n=this.getDefinition();if(n!=null&&n.createGradient){return n.createGradient(O.ctx,t,e)}if(n!=null&&n.createPattern){if(n.getHrefAttribute().hasValue()){var i=n.attribute("patternTransform");n=n.getHrefAttribute().getDefinition();if(i.hasValue()){n.attribute("patternTransform",true).value=i.value}}return n.createPattern(O.ctx,t)}return null};O.Property.prototype.getDPI=function(t){return 96};O.Property.prototype.getEM=function(t){var e=12;var n=new O.Property("fontSize",O.Font.Parse(O.ctx.font).fontSize);if(n.hasValue())e=n.toPixels(t);return e};O.Property.prototype.getUnits=function(){var t=this.value+"";return t.replace(/[0-9\.\-]/g,"")};O.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var n=this.value+"";if(n.match(/em$/))return this.numValue()*this.getEM(t);if(n.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(n.match(/px$/))return this.numValue();if(n.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(n.match(/pc$/))return this.numValue()*15;if(n.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(n.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(n.match(/in$/))return this.numValue()*this.getDPI(t);if(n.match(/%$/))return this.numValue()*O.ViewPort.ComputeSize(t);var i=this.numValue();if(e&&i<1)return i*O.ViewPort.ComputeSize(t);return i};O.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";if(t.match(/s$/))return this.numValue()*1e3;if(t.match(/ms$/))return this.numValue();return this.numValue()};O.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";if(t.match(/deg$/))return this.numValue()*(Math.PI/180);if(t.match(/grad$/))return this.numValue()*(Math.PI/200);if(t.match(/rad$/))return this.numValue();return this.numValue()*(Math.PI/180)};var e={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};O.Property.prototype.toTextBaseline=function(){if(!this.hasValue())return null;return e[this.value]};O.Font=new function(){this.Styles="normal|italic|oblique|inherit";this.Variants="normal|small-caps|inherit";this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";this.CreateFont=function(t,e,n,i,a,r){var o=r!=null?this.Parse(r):this.CreateFont("","","","","",O.ctx.font);return{fontFamily:a||o.fontFamily,fontSize:i||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:n||o.fontWeight,fontVariant:e||o.fontVariant,toString:function t(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var o=this;this.Parse=function(t){var e={};var n=O.trim(O.compressSpaces(t||"")).split(" ");var i={fontSize:false,fontStyle:false,fontWeight:false,fontVariant:false};var a="";for(var r=0;r<n.length;r++){if(!i.fontStyle&&o.Styles.indexOf(n[r])!=-1){if(n[r]!="inherit")e.fontStyle=n[r];i.fontStyle=true}else if(!i.fontVariant&&o.Variants.indexOf(n[r])!=-1){if(n[r]!="inherit")e.fontVariant=n[r];i.fontStyle=i.fontVariant=true}else if(!i.fontWeight&&o.Weights.indexOf(n[r])!=-1){if(n[r]!="inherit")e.fontWeight=n[r];i.fontStyle=i.fontVariant=i.fontWeight=true}else if(!i.fontSize){if(n[r]!="inherit")e.fontSize=n[r].split("/")[0];i.fontStyle=i.fontVariant=i.fontWeight=i.fontSize=true}else{if(n[r]!="inherit")a+=n[r]}}if(a!="")e.fontFamily=a;return e}};O.ToNumberArray=function(t){var e=O.trim(O.compressSpaces((t||"").replace(/,/g," "))).split(" ");for(var n=0;n<e.length;n++){e[n]=parseFloat(e[n])}return e};O.Point=function(t,e){this.x=t;this.y=e};O.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)};O.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4];var n=this.x*t[1]+this.y*t[3]+t[5];this.x=e;this.y=n};O.CreatePoint=function(t){var e=O.ToNumberArray(t);return new O.Point(e[0],e[1])};O.CreatePath=function(t){var e=O.ToNumberArray(t);var n=[];for(var i=0;i<e.length;i+=2){n.push(new O.Point(e[i],e[i+1]))}return n};O.BoundingBox=function(t,e,n,i){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(t,e){if(t!=null){if(isNaN(this.x1)||isNaN(this.x2)){this.x1=t;this.x2=t}if(t<this.x1)this.x1=t;if(t>this.x2)this.x2=t}if(e!=null){if(isNaN(this.y1)||isNaN(this.y2)){this.y1=e;this.y2=e}if(e<this.y1)this.y1=e;if(e>this.y2)this.y2=e}};this.addX=function(t){this.addPoint(t,null)};this.addY=function(t){this.addPoint(null,t)};this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1);this.addPoint(t.x2,t.y2)};this.addQuadraticCurve=function(t,e,n,i,a,r){var o=t+2/3*(n-t);var s=e+2/3*(i-e);var l=o+1/3*(a-t);var u=s+1/3*(r-e);this.addBezierCurve(t,e,o,l,s,u,a,r)};this.addBezierCurve=function(t,e,n,i,a,r,o,s){var l=[t,e],u=[n,i],h=[a,r],c=[o,s];this.addPoint(l[0],l[1]);this.addPoint(c[0],c[1]);for(var f=0;f<=1;f++){var d=function t(e){return Math.pow(1-e,3)*l[f]+3*Math.pow(1-e,2)*e*u[f]+3*(1-e)*Math.pow(e,2)*h[f]+Math.pow(e,3)*c[f]};var g=6*l[f]-12*u[f]+6*h[f];var p=-3*l[f]+9*u[f]-9*h[f]+3*c[f];var v=3*u[f]-3*l[f];if(p==0){if(g==0)continue;var m=-v/g;if(0<m&&m<1){if(f==0)this.addX(d(m));if(f==1)this.addY(d(m))}continue}var _=Math.pow(g,2)-4*v*p;if(_<0)continue;var y=(-g+Math.sqrt(_))/(2*p);if(0<y&&y<1){if(f==0)this.addX(d(y));if(f==1)this.addY(d(y))}var b=(-g-Math.sqrt(_))/(2*p);if(0<b&&b<1){if(f==0)this.addX(d(b));if(f==1)this.addY(d(b))}}};this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2};this.addPoint(t,e);this.addPoint(n,i)};O.Transform=function(t){var e=this;this.Type={};this.Type.translate=function(t){this.p=O.CreatePoint(t);this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)};this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)};this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=function(t){var e=O.ToNumberArray(t);this.angle=new O.Property("angle",e[0]);this.cx=e[1]||0;this.cy=e[2]||0;this.apply=function(t){t.translate(this.cx,this.cy);t.rotate(this.angle.toRadians());t.translate(-this.cx,-this.cy)};this.unapply=function(t){t.translate(this.cx,this.cy);t.rotate(-1*this.angle.toRadians());t.translate(-this.cx,-this.cy)};this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]);t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}};this.Type.scale=function(t){this.p=O.CreatePoint(t);this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)};this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)};this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(t){this.m=O.ToNumberArray(t);this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.unapply=function(t){var e=this.m[0];var n=this.m[2];var i=this.m[4];var a=this.m[1];var r=this.m[3];var o=this.m[5];var s=0;var l=0;var u=1;var h=1/(e*(r*u-o*l)-n*(a*u-o*s)+i*(a*l-r*s));t.transform(h*(r*u-o*l),h*(o*s-a*u),h*(i*l-n*u),h*(e*u-i*s),h*(n*o-i*r),h*(i*a-e*o))};this.applyToPoint=function(t){t.applyTransform(this.m)}};this.Type.SkewBase=function(t){this.base=e.Type.matrix;this.base(t);this.angle=new O.Property("angle",t)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(t){this.base=e.Type.SkewBase;this.base(t);this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(t){this.base=e.Type.SkewBase;this.base(t);this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(t){for(var e=0;e<this.transforms.length;e++){this.transforms[e].apply(t)}};this.unapply=function(t){for(var e=this.transforms.length-1;e>=0;e--){this.transforms[e].unapply(t)}};this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++){this.transforms[e].applyToPoint(t)}};var n=O.trim(O.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/);for(var i=0;i<n.length;i++){var a=O.trim(n[i].split("(")[0]);var r=n[i].split("(")[1].replace(")","");var o=this.Type[a];if(typeof o!="undefined"){var s=new o(r);s.type=a;this.transforms.push(s)}}};O.AspectRatio=function(t,e,n,i,a,r,o,s,l,u){e=O.compressSpaces(e);e=e.replace(/^defer\s/,"");var h=e.split(" ")[0]||"xMidYMid";var c=e.split(" ")[1]||"meet";var f=n/i;var d=a/r;var g=Math.min(f,d);var p=Math.max(f,d);if(c=="meet"){i*=g;r*=g}if(c=="slice"){i*=p;r*=p}l=new O.Property("refX",l);u=new O.Property("refY",u);if(l.hasValue()&&u.hasValue()){t.translate(-g*l.toPixels("x"),-g*u.toPixels("y"))}else{if(h.match(/^xMid/)&&(c=="meet"&&g==d||c=="slice"&&p==d))t.translate(n/2-i/2,0);if(h.match(/YMid$/)&&(c=="meet"&&g==f||c=="slice"&&p==f))t.translate(0,a/2-r/2);if(h.match(/^xMax/)&&(c=="meet"&&g==d||c=="slice"&&p==d))t.translate(n-i,0);if(h.match(/YMax$/)&&(c=="meet"&&g==f||c=="slice"&&p==f))t.translate(0,a-r)}if(h=="none")t.scale(f,d);else if(c=="meet")t.scale(g,g);else if(c=="slice")t.scale(p,p);t.translate(o==null?0:-o,s==null?0:-s)};O.Element={};O.EmptyProperty=new O.Property("EMPTY","");O.Element.ElementBase=function(r){this.attributes={};this.styles={};this.stylesSpecificity={};this.children=[];this.attribute=function(t,e){var n=this.attributes[t];if(n!=null)return n;if(e==true){n=new O.Property(t,"");this.attributes[t]=n}return n||O.EmptyProperty};this.getHrefAttribute=function(){for(var t in this.attributes){if(t=="href"||t.match(/:href$/)){return this.attributes[t]}}return O.EmptyProperty};this.style=function(t,e,n){var i=this.styles[t];if(i!=null)return i;var a=this.attribute(t);if(a!=null&&a.hasValue()){this.styles[t]=a;return a}if(n!=true){var r=this.parent;if(r!=null){var o=r.style(t);if(o!=null&&o.hasValue()){return o}}}if(e==true){i=new O.Property(t,"");this.styles[t]=i}return i||O.EmptyProperty};this.render=function(t){if(this.style("display").value=="none")return;if(this.style("visibility").value=="hidden")return;t.save();if(this.style("mask").hasValue()){var e=this.style("mask").getDefinition();if(e!=null)e.apply(t,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();if(n!=null)n.apply(t,this)}else{this.setContext(t);this.renderChildren(t);this.clearContext(t)}t.restore()};this.setContext=function(t){};this.clearContext=function(t){};this.renderChildren=function(t){for(var e=0;e<this.children.length;e++){this.children[e].render(t)}};this.addChild=function(t,e){var n=t;if(e)n=O.CreateElement(t);n.parent=this;if(n.type!="title"){this.children.push(n)}};this.addStylesFromStyleDefinition=function(){for(var t in O.Styles){if(t[0]!="@"&&u(r,t)){var e=O.Styles[t];var n=O.StylesSpecificity[t];if(e!=null){for(var i in e){var a=this.stylesSpecificity[i];if(typeof a=="undefined"){a="000"}if(n>a){this.styles[i]=e[i];this.stylesSpecificity[i]=n}}}}}};if(r!=null&&r.nodeType==1){for(var t=0;t<r.attributes.length;t++){var e=r.attributes[t];this.attributes[e.nodeName]=new O.Property(e.nodeName,e.value)}this.addStylesFromStyleDefinition();if(this.attribute("style").hasValue()){var n=this.attribute("style").value.split(";");for(var t=0;t<n.length;t++){if(O.trim(n[t])!=""){var i=n[t].split(":");var a=O.trim(i[0]);var o=O.trim(i[1]);this.styles[a]=new O.Property(a,o)}}}if(this.attribute("id").hasValue()){if(O.Definitions[this.attribute("id").value]==null){O.Definitions[this.attribute("id").value]=this}}for(var t=0;t<r.childNodes.length;t++){var s=r.childNodes[t];if(s.nodeType==1)this.addChild(s,true);if(this.captureTextNodes&&(s.nodeType==3||s.nodeType==4)){var l=s.value||s.text||s.textContent||"";if(O.compressSpaces(l)!=""){this.addChild(new O.Element.tspan(s),false)}}}}};O.Element.RenderedElementBase=function(t){this.base=O.Element.ElementBase;this.base(t);this.setContext=function(t){if(this.style("fill").isUrlDefinition()){var e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));if(e!=null)t.fillStyle=e}else if(this.style("fill").hasValue()){var n=this.style("fill");if(n.value=="currentColor")n.value=this.style("color").value;if(n.value!="inherit")t.fillStyle=n.value=="none"?"rgba(0,0,0,0)":n.value}if(this.style("fill-opacity").hasValue()){var n=new O.Property("fill",t.fillStyle);n=n.addOpacity(this.style("fill-opacity"));t.fillStyle=n.value}if(this.style("stroke").isUrlDefinition()){var e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));if(e!=null)t.strokeStyle=e}else if(this.style("stroke").hasValue()){var i=this.style("stroke");if(i.value=="currentColor")i.value=this.style("color").value;if(i.value!="inherit")t.strokeStyle=i.value=="none"?"rgba(0,0,0,0)":i.value}if(this.style("stroke-opacity").hasValue()){var i=new O.Property("stroke",t.strokeStyle);i=i.addOpacity(this.style("stroke-opacity"));t.strokeStyle=i.value}if(this.style("stroke-width").hasValue()){var a=this.style("stroke-width").toPixels();t.lineWidth=a==0?.001:a}if(this.style("stroke-linecap").hasValue())t.lineCap=this.style("stroke-linecap").value;if(this.style("stroke-linejoin").hasValue())t.lineJoin=this.style("stroke-linejoin").value;if(this.style("stroke-miterlimit").hasValue())t.miterLimit=this.style("stroke-miterlimit").value;if(this.style("stroke-dasharray").hasValue()&&this.style("stroke-dasharray").value!="none"){var r=O.ToNumberArray(this.style("stroke-dasharray").value);if(typeof t.setLineDash!="undefined"){t.setLineDash(r)}else if(typeof t.webkitLineDash!="undefined"){t.webkitLineDash=r}else if(typeof t.mozDash!="undefined"&&!(r.length==1&&r[0]==0)){t.mozDash=r}var o=this.style("stroke-dashoffset").numValueOrDefault(1);if(typeof t.lineDashOffset!="undefined"){t.lineDashOffset=o}else if(typeof t.webkitLineDashOffset!="undefined"){t.webkitLineDashOffset=o}else if(typeof t.mozDashOffset!="undefined"){t.mozDashOffset=o}}if(typeof t.font!="undefined"){t.font=O.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()}if(this.style("transform",false,true).hasValue()){var s=new O.Transform(this.style("transform",false,true).value);s.apply(t)}if(this.style("clip-path",false,true).hasValue()){var l=this.style("clip-path",false,true).getDefinition();if(l!=null)l.apply(t)}if(this.style("opacity").hasValue()){t.globalAlpha=this.style("opacity").numValue()}}};O.Element.RenderedElementBase.prototype=new O.Element.ElementBase;O.Element.PathElementBase=function(t){this.base=O.Element.RenderedElementBase;this.base(t);this.path=function(t){if(t!=null)t.beginPath();return new O.BoundingBox};this.renderChildren=function(t){this.path(t);O.Mouse.checkPath(this,t);if(t.fillStyle!=""){if(this.style("fill-rule").valueOrDefault("inherit")!="inherit"){t.fill(this.style("fill-rule").value)}else{t.fill()}}if(t.strokeStyle!="")t.stroke();var e=this.getMarkers();if(e!=null){if(this.style("marker-start").isUrlDefinition()){var n=this.style("marker-start").getDefinition();n.render(t,e[0][0],e[0][1])}if(this.style("marker-mid").isUrlDefinition()){var n=this.style("marker-mid").getDefinition();for(var i=1;i<e.length-1;i++){n.render(t,e[i][0],e[i][1])}}if(this.style("marker-end").isUrlDefinition()){var n=this.style("marker-end").getDefinition();n.render(t,e[e.length-1][0],e[e.length-1][1])}}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};O.Element.PathElementBase.prototype=new O.Element.RenderedElementBase;O.Element.svg=function(t){this.base=O.Element.RenderedElementBase;this.base(t);this.baseClearContext=this.clearContext;this.clearContext=function(t){this.baseClearContext(t);O.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)";t.lineCap="butt";t.lineJoin="miter";t.miterLimit=4;if(typeof t.font!="undefined"&&typeof window.getComputedStyle!="undefined"){t.font=window.getComputedStyle(t.canvas).getPropertyValue("font")}this.baseSetContext(t);if(!this.attribute("x").hasValue())this.attribute("x",true).value=0;if(!this.attribute("y").hasValue())this.attribute("y",true).value=0;t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var e=O.ViewPort.width();var n=O.ViewPort.height();if(!this.attribute("width").hasValue())this.attribute("width",true).value="100%";if(!this.attribute("height").hasValue())this.attribute("height",true).value="100%";if(typeof this.root=="undefined"){e=this.attribute("width").toPixels("x");n=this.attribute("height").toPixels("y");var i=0;var a=0;if(this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()){i=-this.attribute("refX").toPixels("x");a=-this.attribute("refY").toPixels("y")}if(this.attribute("overflow").valueOrDefault("hidden")!="visible"){t.beginPath();t.moveTo(i,a);t.lineTo(e,a);t.lineTo(e,n);t.lineTo(i,n);t.closePath();t.clip()}}O.ViewPort.SetCurrent(e,n);if(this.attribute("viewBox").hasValue()){var r=O.ToNumberArray(this.attribute("viewBox").value);var o=r[0];var s=r[1];e=r[2];n=r[3];O.AspectRatio(t,this.attribute("preserveAspectRatio").value,O.ViewPort.width(),e,O.ViewPort.height(),n,o,s,this.attribute("refX").value,this.attribute("refY").value);O.ViewPort.RemoveCurrent();O.ViewPort.SetCurrent(r[2],r[3])}}};O.Element.svg.prototype=new O.Element.RenderedElementBase;O.Element.rect=function(t){this.base=O.Element.PathElementBase;this.base(t);this.path=function(t){var e=this.attribute("x").toPixels("x");var n=this.attribute("y").toPixels("y");var i=this.attribute("width").toPixels("x");var a=this.attribute("height").toPixels("y");var r=this.attribute("rx").toPixels("x");var o=this.attribute("ry").toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue())o=r;if(this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue())r=o;r=Math.min(r,i/2);o=Math.min(o,a/2);if(t!=null){t.beginPath();t.moveTo(e+r,n);t.lineTo(e+i-r,n);t.quadraticCurveTo(e+i,n,e+i,n+o);t.lineTo(e+i,n+a-o);t.quadraticCurveTo(e+i,n+a,e+i-r,n+a);t.lineTo(e+r,n+a);t.quadraticCurveTo(e,n+a,e,n+a-o);t.lineTo(e,n+o);t.quadraticCurveTo(e,n,e+r,n);t.closePath()}return new O.BoundingBox(e,n,e+i,n+a)}};O.Element.rect.prototype=new O.Element.PathElementBase;O.Element.circle=function(t){this.base=O.Element.PathElementBase;this.base(t);this.path=function(t){var e=this.attribute("cx").toPixels("x");var n=this.attribute("cy").toPixels("y");var i=this.attribute("r").toPixels();if(t!=null){t.beginPath();t.arc(e,n,i,0,Math.PI*2,true);t.closePath()}return new O.BoundingBox(e-i,n-i,e+i,n+i)}};O.Element.circle.prototype=new O.Element.PathElementBase;O.Element.ellipse=function(t){this.base=O.Element.PathElementBase;this.base(t);this.path=function(t){var e=4*((Math.sqrt(2)-1)/3);var n=this.attribute("rx").toPixels("x");var i=this.attribute("ry").toPixels("y");var a=this.attribute("cx").toPixels("x");var r=this.attribute("cy").toPixels("y");if(t!=null){t.beginPath();t.moveTo(a,r-i);t.bezierCurveTo(a+e*n,r-i,a+n,r-e*i,a+n,r);t.bezierCurveTo(a+n,r+e*i,a+e*n,r+i,a,r+i);t.bezierCurveTo(a-e*n,r+i,a-n,r+e*i,a-n,r);t.bezierCurveTo(a-n,r-e*i,a-e*n,r-i,a,r-i);t.closePath()}return new O.BoundingBox(a-n,r-i,a+n,r+i)}};O.Element.ellipse.prototype=new O.Element.PathElementBase;O.Element.line=function(t){this.base=O.Element.PathElementBase;this.base(t);this.getPoints=function(){return[new O.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new O.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]};this.path=function(t){var e=this.getPoints();if(t!=null){t.beginPath();t.moveTo(e[0].x,e[0].y);t.lineTo(e[1].x,e[1].y)}return new O.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)};this.getMarkers=function(){var t=this.getPoints();var e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}};O.Element.line.prototype=new O.Element.PathElementBase;O.Element.polyline=function(t){this.base=O.Element.PathElementBase;this.base(t);this.points=O.CreatePath(this.attribute("points").value);this.path=function(t){var e=new O.BoundingBox(this.points[0].x,this.points[0].y);if(t!=null){t.beginPath();t.moveTo(this.points[0].x,this.points[0].y)}for(var n=1;n<this.points.length;n++){e.addPoint(this.points[n].x,this.points[n].y);if(t!=null)t.lineTo(this.points[n].x,this.points[n].y)}return e};this.getMarkers=function(){var t=[];for(var e=0;e<this.points.length-1;e++){t.push([this.points[e],this.points[e].angleTo(this.points[e+1])])}if(t.length>0){t.push([this.points[this.points.length-1],t[t.length-1][1]])}return t}};O.Element.polyline.prototype=new O.Element.PathElementBase;O.Element.polygon=function(t){this.base=O.Element.polyline;this.base(t);this.basePath=this.path;this.path=function(t){var e=this.basePath(t);if(t!=null){t.lineTo(this.points[0].x,this.points[0].y);t.closePath()}return e}};O.Element.polygon.prototype=new O.Element.polyline;O.Element.path=function(t){this.base=O.Element.PathElementBase;this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var n=0;n<2;n++){e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2")}e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");e=e.replace(/([0-9])([+\-])/gm,"$1 $2");for(var n=0;n<2;n++){e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2")}e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");e=O.compressSpaces(e);e=O.trim(e);this.PathParser=new function(t){this.tokens=t.split(" ");this.reset=function(){this.i=-1;this.command="";this.previousCommand="";this.start=new O.Point(0,0);this.control=new O.Point(0,0);this.current=new O.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-1};this.isCommandOrEnd=function(){if(this.isEnd())return true;return this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null};this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return true}return false};this.getToken=function(){this.i++;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){var t=new O.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)};this.getAsControlPoint=function(){var t=this.getPoint();this.control=t;return t};this.getAsCurrentPoint=function(){var t=this.getPoint();this.current=t;return t};this.getReflectedControlPoint=function(){if(this.previousCommand.toLowerCase()!="c"&&this.previousCommand.toLowerCase()!="s"&&this.previousCommand.toLowerCase()!="q"&&this.previousCommand.toLowerCase()!="t"){return this.current}var t=new O.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return t};this.makeAbsolute=function(t){if(this.isRelativeCommand()){t.x+=this.current.x;t.y+=this.current.y}return t};this.addMarker=function(t,e,n){if(n!=null&&this.angles.length>0&&this.angles[this.angles.length-1]==null){this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)}this.addMarkerAngle(t,e==null?null:e.angleTo(t))};this.addMarkerAngle=function(t,e){this.points.push(t);this.angles.push(e)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++){if(this.angles[t]==null){for(var e=t+1;e<this.angles.length;e++){if(this.angles[e]!=null){this.angles[t]=this.angles[e];break}}}}return this.angles}}(e);this.path=function(t){var e=this.PathParser;e.reset();var n=new O.BoundingBox;if(t!=null)t.beginPath();while(!e.isEnd()){e.nextCommand();switch(e.command){case"M":case"m":var i=e.getAsCurrentPoint();e.addMarker(i);n.addPoint(i.x,i.y);if(t!=null)t.moveTo(i.x,i.y);e.start=e.current;while(!e.isCommandOrEnd()){var i=e.getAsCurrentPoint();e.addMarker(i,e.start);n.addPoint(i.x,i.y);if(t!=null)t.lineTo(i.x,i.y)}break;case"L":case"l":while(!e.isCommandOrEnd()){var a=e.current;var i=e.getAsCurrentPoint();e.addMarker(i,a);n.addPoint(i.x,i.y);if(t!=null)t.lineTo(i.x,i.y)}break;case"H":case"h":while(!e.isCommandOrEnd()){var r=new O.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(r,e.current);e.current=r;n.addPoint(e.current.x,e.current.y);if(t!=null)t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":while(!e.isCommandOrEnd()){var r=new O.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar());e.addMarker(r,e.current);e.current=r;n.addPoint(e.current.x,e.current.y);if(t!=null)t.lineTo(e.current.x,e.current.y)}break;case"C":case"c":while(!e.isCommandOrEnd()){var o=e.current;var s=e.getPoint();var l=e.getAsControlPoint();var u=e.getAsCurrentPoint();e.addMarker(u,l,s);n.addBezierCurve(o.x,o.y,s.x,s.y,l.x,l.y,u.x,u.y);if(t!=null)t.bezierCurveTo(s.x,s.y,l.x,l.y,u.x,u.y)}break;case"S":case"s":while(!e.isCommandOrEnd()){var o=e.current;var s=e.getReflectedControlPoint();var l=e.getAsControlPoint();var u=e.getAsCurrentPoint();e.addMarker(u,l,s);n.addBezierCurve(o.x,o.y,s.x,s.y,l.x,l.y,u.x,u.y);if(t!=null)t.bezierCurveTo(s.x,s.y,l.x,l.y,u.x,u.y)}break;case"Q":case"q":while(!e.isCommandOrEnd()){var o=e.current;var l=e.getAsControlPoint();var u=e.getAsCurrentPoint();e.addMarker(u,l,l);n.addQuadraticCurve(o.x,o.y,l.x,l.y,u.x,u.y);if(t!=null)t.quadraticCurveTo(l.x,l.y,u.x,u.y)}break;case"T":case"t":while(!e.isCommandOrEnd()){var o=e.current;var l=e.getReflectedControlPoint();e.control=l;var u=e.getAsCurrentPoint();e.addMarker(u,l,l);n.addQuadraticCurve(o.x,o.y,l.x,l.y,u.x,u.y);if(t!=null)t.quadraticCurveTo(l.x,l.y,u.x,u.y)}break;case"A":case"a":while(!e.isCommandOrEnd()){var o=e.current;var h=e.getScalar();var c=e.getScalar();var f=e.getScalar()*(Math.PI/180);var d=e.getScalar();var g=e.getScalar();var u=e.getAsCurrentPoint();var p=new O.Point(Math.cos(f)*(o.x-u.x)/2+Math.sin(f)*(o.y-u.y)/2,-Math.sin(f)*(o.x-u.x)/2+Math.cos(f)*(o.y-u.y)/2);var v=Math.pow(p.x,2)/Math.pow(h,2)+Math.pow(p.y,2)/Math.pow(c,2);if(v>1){h*=Math.sqrt(v);c*=Math.sqrt(v)}var m=(d==g?-1:1)*Math.sqrt((Math.pow(h,2)*Math.pow(c,2)-Math.pow(h,2)*Math.pow(p.y,2)-Math.pow(c,2)*Math.pow(p.x,2))/(Math.pow(h,2)*Math.pow(p.y,2)+Math.pow(c,2)*Math.pow(p.x,2)));if(isNaN(m))m=0;var _=new O.Point(m*h*p.y/c,m*-c*p.x/h);var y=new O.Point((o.x+u.x)/2+Math.cos(f)*_.x-Math.sin(f)*_.y,(o.y+u.y)/2+Math.sin(f)*_.x+Math.cos(f)*_.y);var b=function t(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))};var w=function t(e,n){return(e[0]*n[0]+e[1]*n[1])/(b(e)*b(n))};var x=function t(e,n){return(e[0]*n[1]<e[1]*n[0]?-1:1)*Math.acos(w(e,n))};var k=x([1,0],[(p.x-_.x)/h,(p.y-_.y)/c]);var S=[(p.x-_.x)/h,(p.y-_.y)/c];var C=[(-p.x-_.x)/h,(-p.y-_.y)/c];var A=x(S,C);if(w(S,C)<=-1)A=Math.PI;if(w(S,C)>=1)A=0;var E=1-g?1:-1;var M=k+E*(A/2);var R=new O.Point(y.x+h*Math.cos(M),y.y+c*Math.sin(M));e.addMarkerAngle(R,M-E*Math.PI/2);e.addMarkerAngle(u,M-E*Math.PI);n.addPoint(u.x,u.y);if(t!=null){var w=h>c?h:c;var T=h>c?1:h/c;var B=h>c?c/h:1;t.translate(y.x,y.y);t.rotate(f);t.scale(T,B);t.arc(0,0,w,k,k+A,1-g);t.scale(1/T,1/B);t.rotate(-f);t.translate(-y.x,-y.y)}}break;case"Z":case"z":if(t!=null)t.closePath();e.current=e.start}}return n};this.getMarkers=function(){var t=this.PathParser.getMarkerPoints();var e=this.PathParser.getMarkerAngles();var n=[];for(var i=0;i<t.length;i++){n.push([t[i],e[i]])}return n}};O.Element.path.prototype=new O.Element.PathElementBase;O.Element.pattern=function(t){this.base=O.Element.ElementBase;this.base(t);this.createPattern=function(t,e){var n=this.attribute("width").toPixels("x",true);var i=this.attribute("height").toPixels("y",true);var a=new O.Element.svg;a.attributes["viewBox"]=new O.Property("viewBox",this.attribute("viewBox").value);a.attributes["width"]=new O.Property("width",n+"px");a.attributes["height"]=new O.Property("height",i+"px");a.attributes["transform"]=new O.Property("transform",this.attribute("patternTransform").value);a.children=this.children;var r=document.createElement("canvas");r.width=n;r.height=i;var o=r.getContext("2d");if(this.attribute("x").hasValue()&&this.attribute("y").hasValue()){o.translate(this.attribute("x").toPixels("x",true),this.attribute("y").toPixels("y",true))}for(var s=-1;s<=1;s++){for(var l=-1;l<=1;l++){o.save();a.attributes["x"]=new O.Property("x",s*r.width);a.attributes["y"]=new O.Property("y",l*r.height);a.render(o);o.restore()}}var u=t.createPattern(r,"repeat");return u}};O.Element.pattern.prototype=new O.Element.ElementBase;O.Element.marker=function(t){this.base=O.Element.ElementBase;this.base(t);this.baseRender=this.render;this.render=function(t,e,n){t.translate(e.x,e.y);if(this.attribute("orient").valueOrDefault("auto")=="auto")t.rotate(n);if(this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth")t.scale(t.lineWidth,t.lineWidth);t.save();var i=new O.Element.svg;i.attributes["viewBox"]=new O.Property("viewBox",this.attribute("viewBox").value);i.attributes["refX"]=new O.Property("refX",this.attribute("refX").value);i.attributes["refY"]=new O.Property("refY",this.attribute("refY").value);i.attributes["width"]=new O.Property("width",this.attribute("markerWidth").value);i.attributes["height"]=new O.Property("height",this.attribute("markerHeight").value);i.attributes["fill"]=new O.Property("fill",this.attribute("fill").valueOrDefault("black"));i.attributes["stroke"]=new O.Property("stroke",this.attribute("stroke").valueOrDefault("none"));i.children=this.children;i.render(t);t.restore();if(this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth")t.scale(1/t.lineWidth,1/t.lineWidth);if(this.attribute("orient").valueOrDefault("auto")=="auto")t.rotate(-n);t.translate(-e.x,-e.y)}};O.Element.marker.prototype=new O.Element.ElementBase;O.Element.defs=function(t){this.base=O.Element.ElementBase;this.base(t);this.render=function(t){}};O.Element.defs.prototype=new O.Element.ElementBase;O.Element.GradientBase=function(t){this.base=O.Element.ElementBase;this.base(t);this.stops=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];if(n.type=="stop")this.stops.push(n)}this.getGradient=function(){};this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")};this.attributesToInherit=["gradientUnits"];this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var n=this.attributesToInherit[e];if(!this.attribute(n).hasValue()&&t.attribute(n).hasValue()){this.attribute(n,true).value=t.attribute(n).value}}};this.createGradient=function(t,e,i){var n=this;if(this.getHrefAttribute().hasValue()){n=this.getHrefAttribute().getDefinition();this.inheritStopContainer(n)}var a=function t(e){if(i.hasValue()){var n=new O.Property("color",e);return n.addOpacity(i).value}return e};var r=this.getGradient(t,e);if(r==null)return a(n.stops[n.stops.length-1].color);for(var o=0;o<n.stops.length;o++){r.addColorStop(n.stops[o].offset,a(n.stops[o].color))}if(this.attribute("gradientTransform").hasValue()){var s=O.ViewPort.viewPorts[0];var l=new O.Element.rect;l.attributes["x"]=new O.Property("x",-O.MAX_VIRTUAL_PIXELS/3);l.attributes["y"]=new O.Property("y",-O.MAX_VIRTUAL_PIXELS/3);l.attributes["width"]=new O.Property("width",O.MAX_VIRTUAL_PIXELS);l.attributes["height"]=new O.Property("height",O.MAX_VIRTUAL_PIXELS);var u=new O.Element.g;u.attributes["transform"]=new O.Property("transform",this.attribute("gradientTransform").value);u.children=[l];var h=new O.Element.svg;h.attributes["x"]=new O.Property("x",0);h.attributes["y"]=new O.Property("y",0);h.attributes["width"]=new O.Property("width",s.width);h.attributes["height"]=new O.Property("height",s.height);h.children=[u];var c=document.createElement("canvas");c.width=s.width;c.height=s.height;var f=c.getContext("2d");f.fillStyle=r;h.render(f);return f.createPattern(c,"no-repeat")}return r}};O.Element.GradientBase.prototype=new O.Element.ElementBase;O.Element.linearGradient=function(t){this.base=O.Element.GradientBase;this.base(t);this.attributesToInherit.push("x1");this.attributesToInherit.push("y1");this.attributesToInherit.push("x2");this.attributesToInherit.push("y2");this.getGradient=function(t,e){var n=this.gradientUnits()=="objectBoundingBox"?e.getBoundingBox():null;if(!this.attribute("x1").hasValue()&&!this.attribute("y1").hasValue()&&!this.attribute("x2").hasValue()&&!this.attribute("y2").hasValue()){this.attribute("x1",true).value=0;this.attribute("y1",true).value=0;this.attribute("x2",true).value=1;this.attribute("y2",true).value=0}var i=this.gradientUnits()=="objectBoundingBox"?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x");var a=this.gradientUnits()=="objectBoundingBox"?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y");var r=this.gradientUnits()=="objectBoundingBox"?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x");var o=this.gradientUnits()=="objectBoundingBox"?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");if(i==r&&a==o)return null;return t.createLinearGradient(i,a,r,o)}};O.Element.linearGradient.prototype=new O.Element.GradientBase;O.Element.radialGradient=function(t){this.base=O.Element.GradientBase;this.base(t);this.attributesToInherit.push("cx");this.attributesToInherit.push("cy");this.attributesToInherit.push("r");this.attributesToInherit.push("fx");this.attributesToInherit.push("fy");this.getGradient=function(t,e){var n=e.getBoundingBox();if(!this.attribute("cx").hasValue())this.attribute("cx",true).value="50%";if(!this.attribute("cy").hasValue())this.attribute("cy",true).value="50%";if(!this.attribute("r").hasValue())this.attribute("r",true).value="50%";var i=this.gradientUnits()=="objectBoundingBox"?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x");var a=this.gradientUnits()=="objectBoundingBox"?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y");var r=i;var o=a;if(this.attribute("fx").hasValue()){r=this.gradientUnits()=="objectBoundingBox"?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")}if(this.attribute("fy").hasValue()){o=this.gradientUnits()=="objectBoundingBox"?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y")}var s=this.gradientUnits()=="objectBoundingBox"?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(r,o,0,i,a,s)}};O.Element.radialGradient.prototype=new O.Element.GradientBase;O.Element.stop=function(t){this.base=O.Element.ElementBase;this.base(t);this.offset=this.attribute("offset").numValue();if(this.offset<0)this.offset=0;if(this.offset>1)this.offset=1;var e=this.style("stop-color",true);if(e.value=="")e.value="#000";if(this.style("stop-opacity").hasValue())e=e.addOpacity(this.style("stop-opacity"));this.color=e.value};O.Element.stop.prototype=new O.Element.ElementBase;O.Element.AnimateBase=function(t){this.base=O.Element.ElementBase;this.base(t);O.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").toMilliseconds();this.getProperty=function(){var t=this.attribute("attributeType").value;var e=this.attribute("attributeName").value;if(t=="CSS"){return this.parent.style(e,true)}return this.parent.attribute(e,true)};this.initialValue=null;this.initialUnits="";this.removed=false;this.calcValue=function(){return""};this.update=function(t){if(this.initialValue==null){this.initialValue=this.getProperty().value;this.initialUnits=this.getProperty().getUnits()}if(this.duration>this.maxDuration){if(this.attribute("repeatCount").value=="indefinite"||this.attribute("repeatDur").value=="indefinite"){this.duration=0}else if(this.attribute("fill").valueOrDefault("remove")=="freeze"&&!this.frozen){this.frozen=true;this.parent.animationFrozen=true;this.parent.animationFrozenValue=this.getProperty().value}else if(this.attribute("fill").valueOrDefault("remove")=="remove"&&!this.removed){this.removed=true;this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue;return true}return false}this.duration=this.duration+t;var e=false;if(this.begin<this.duration){var n=this.calcValue();if(this.attribute("type").hasValue()){var i=this.attribute("type").value;n=i+"("+n+")"}this.getProperty().value=n;e=true}return e};this.from=this.attribute("from");this.to=this.attribute("to");this.values=this.attribute("values");if(this.values.hasValue())this.values.value=this.values.value.split(";");this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1);var n=Math.floor(e),i=Math.ceil(e);t.from=new O.Property("from",parseFloat(this.values.value[n]));t.to=new O.Property("to",parseFloat(this.values.value[i]));t.progress=(e-n)/(i-n)}else{t.from=this.from;t.to=this.to}return t}};O.Element.AnimateBase.prototype=new O.Element.ElementBase;O.Element.animate=function(t){this.base=O.Element.AnimateBase;this.base(t);this.calcValue=function(){var t=this.progress();var e=t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress;return e+this.initialUnits}};O.Element.animate.prototype=new O.Element.AnimateBase;O.Element.animateColor=function(t){this.base=O.Element.AnimateBase;this.base(t);this.calcValue=function(){var t=this.progress();var e=new TD(t.from.value);var n=new TD(t.to.value);if(e.ok&&n.ok){var i=e.r+(n.r-e.r)*t.progress;var a=e.g+(n.g-e.g)*t.progress;var r=e.b+(n.b-e.b)*t.progress;return"rgb("+parseInt(i,10)+","+parseInt(a,10)+","+parseInt(r,10)+")"}return this.attribute("from").value}};O.Element.animateColor.prototype=new O.Element.AnimateBase;O.Element.animateTransform=function(t){this.base=O.Element.AnimateBase;this.base(t);this.calcValue=function(){var t=this.progress();var e=O.ToNumberArray(t.from.value);var n=O.ToNumberArray(t.to.value);var i="";for(var a=0;a<e.length;a++){i+=e[a]+(n[a]-e[a])*t.progress+" "}return i}};O.Element.animateTransform.prototype=new O.Element.animate;O.Element.font=function(t){this.base=O.Element.ElementBase;this.base(t);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.isRTL=false;this.isArabic=false;this.fontFace=null;this.missingGlyph=null;this.glyphs=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];if(n.type=="font-face"){this.fontFace=n;if(n.style("font-family").hasValue()){O.Definitions[n.style("font-family").value]=this}}else if(n.type=="missing-glyph")this.missingGlyph=n;else if(n.type=="glyph"){if(n.arabicForm!=""){this.isRTL=true;this.isArabic=true;if(typeof this.glyphs[n.unicode]=="undefined")this.glyphs[n.unicode]=[];this.glyphs[n.unicode][n.arabicForm]=n}else{this.glyphs[n.unicode]=n}}}};O.Element.font.prototype=new O.Element.ElementBase;O.Element.fontface=function(t){this.base=O.Element.ElementBase;this.base(t);this.ascent=this.attribute("ascent").value;this.descent=this.attribute("descent").value;this.unitsPerEm=this.attribute("units-per-em").numValue()};O.Element.fontface.prototype=new O.Element.ElementBase;O.Element.missingglyph=function(t){this.base=O.Element.path;this.base(t);this.horizAdvX=0};O.Element.missingglyph.prototype=new O.Element.path;O.Element.glyph=function(t){this.base=O.Element.path;this.base(t);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.unicode=this.attribute("unicode").value;this.arabicForm=this.attribute("arabic-form").value};O.Element.glyph.prototype=new O.Element.path;O.Element.text=function(t){this.captureTextNodes=true;this.base=O.Element.RenderedElementBase;this.base(t);this.baseSetContext=this.setContext;this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();if(e==null)e=this.style("alignment-baseline").toTextBaseline();if(e!=null)t.textBaseline=e};this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x");var e=this.attribute("y").toPixels("y");var n=this.parent.style("font-size").numValueOrDefault(O.Font.Parse(O.ctx.font).fontSize);return new O.BoundingBox(t,e-n,t+Math.floor(n*2/3)*this.children[0].getText().length,e)};this.renderChildren=function(t){this.x=this.attribute("x").toPixels("x");this.y=this.attribute("y").toPixels("y");if(this.attribute("dx").hasValue())this.x+=this.attribute("dx").toPixels("x");if(this.attribute("dy").hasValue())this.y+=this.attribute("dy").toPixels("y");this.x+=this.getAnchorDelta(t,this,0);for(var e=0;e<this.children.length;e++){this.renderChild(t,this,this,e)}};this.getAnchorDelta=function(t,e,n){var i=this.style("text-anchor").valueOrDefault("start");if(i!="start"){var a=0;for(var r=n;r<e.children.length;r++){var o=e.children[r];if(r>n&&o.attribute("x").hasValue())break;a+=o.measureTextRecursive(t)}return-1*(i=="end"?a:a/2)}return 0};this.renderChild=function(t,e,n,i){var a=n.children[i];if(a.attribute("x").hasValue()){a.x=a.attribute("x").toPixels("x")+e.getAnchorDelta(t,n,i);if(a.attribute("dx").hasValue())a.x+=a.attribute("dx").toPixels("x")}else{if(a.attribute("dx").hasValue())e.x+=a.attribute("dx").toPixels("x");a.x=e.x}e.x=a.x+a.measureText(t);if(a.attribute("y").hasValue()){a.y=a.attribute("y").toPixels("y");if(a.attribute("dy").hasValue())a.y+=a.attribute("dy").toPixels("y")}else{if(a.attribute("dy").hasValue())e.y+=a.attribute("dy").toPixels("y");a.y=e.y}e.y=a.y;a.render(t);for(var i=0;i<a.children.length;i++){e.renderChild(t,e,a,i)}}};O.Element.text.prototype=new O.Element.RenderedElementBase;O.Element.TextElementBase=function(t){this.base=O.Element.RenderedElementBase;this.base(t);this.getGlyph=function(t,e,n){var i=e[n];var a=null;if(t.isArabic){var r="isolated";if((n==0||e[n-1]==" ")&&n<e.length-2&&e[n+1]!=" ")r="terminal";if(n>0&&e[n-1]!=" "&&n<e.length-2&&e[n+1]!=" ")r="medial";if(n>0&&e[n-1]!=" "&&(n==e.length-1||e[n+1]==" "))r="initial";if(typeof t.glyphs[i]!="undefined"){a=t.glyphs[i][r];if(a==null&&t.glyphs[i].type=="glyph")a=t.glyphs[i]}}else{a=t.glyphs[i]}if(a==null)a=t.missingGlyph;return a};this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(e!=null){var n=this.parent.style("font-size").numValueOrDefault(O.Font.Parse(O.ctx.font).fontSize);var i=this.parent.style("font-style").valueOrDefault(O.Font.Parse(O.ctx.font).fontStyle);var a=this.getText();if(e.isRTL)a=a.split("").reverse().join("");var r=O.ToNumberArray(this.parent.attribute("dx").value);for(var o=0;o<a.length;o++){var s=this.getGlyph(e,a,o);var l=n/e.fontFace.unitsPerEm;t.translate(this.x,this.y);t.scale(l,-l);var u=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/n;if(i=="italic")t.transform(1,0,.4,1,0,0);s.render(t);if(i=="italic")t.transform(1,0,-.4,1,0,0);t.lineWidth=u;t.scale(1/l,-1/l);t.translate(-this.x,-this.y);this.x+=n*(s.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm;if(typeof r[o]!="undefined"&&!isNaN(r[o])){this.x+=r[o]}}return}if(t.fillStyle!="")t.fillText(O.compressSpaces(this.getText()),this.x,this.y);if(t.strokeStyle!="")t.strokeText(O.compressSpaces(this.getText()),this.x,this.y)};this.getText=function(){};this.measureTextRecursive=function(t){var e=this.measureText(t);for(var n=0;n<this.children.length;n++){e+=this.children[n].measureTextRecursive(t)}return e};this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(e!=null){var n=this.parent.style("font-size").numValueOrDefault(O.Font.Parse(O.ctx.font).fontSize);var i=0;var a=this.getText();if(e.isRTL)a=a.split("").reverse().join("");var r=O.ToNumberArray(this.parent.attribute("dx").value);for(var o=0;o<a.length;o++){var s=this.getGlyph(e,a,o);i+=(s.horizAdvX||e.horizAdvX)*n/e.fontFace.unitsPerEm;if(typeof r[o]!="undefined"&&!isNaN(r[o])){i+=r[o]}}return i}var l=O.compressSpaces(this.getText());if(!t.measureText)return l.length*10;t.save();this.setContext(t);var u=t.measureText(l).width;t.restore();return u}};O.Element.TextElementBase.prototype=new O.Element.RenderedElementBase;O.Element.tspan=function(t){this.captureTextNodes=true;this.base=O.Element.TextElementBase;this.base(t);this.text=O.compressSpaces(t.value||t.text||t.textContent||"");this.getText=function(){if(this.children.length>0){return""}return this.text}};O.Element.tspan.prototype=new O.Element.TextElementBase;O.Element.tref=function(t){this.base=O.Element.TextElementBase;this.base(t);this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(t!=null)return t.children[0].getText()}};O.Element.tref.prototype=new O.Element.TextElementBase;O.Element.a=function(t){this.base=O.Element.TextElementBase;this.base(t);this.hasText=t.childNodes.length>0;for(var e=0;e<t.childNodes.length;e++){if(t.childNodes[e].nodeType!=3)this.hasText=false}this.text=this.hasText?t.childNodes[0].value:"";this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new O.Property("fontSize",O.Font.Parse(O.ctx.font).fontSize);O.Mouse.checkBoundingBox(this,new O.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(this.children.length>0){var n=new O.Element.g;n.children=this.children;n.parent=this;n.render(t)}};this.onclick=function(){window.open(this.getHrefAttribute().value)};this.onmousemove=function(){O.ctx.canvas.style.cursor="pointer"}};O.Element.a.prototype=new O.Element.TextElementBase;O.Element.image=function(t){this.base=O.Element.RenderedElementBase;this.base(t);var e=this.getHrefAttribute().value;if(e==""){return}var r=e.match(/\.svg$/);O.Images.push(this);this.loaded=false;if(!r){this.img=document.createElement("img");if(O.opts["useCORS"]==true){this.img.crossOrigin="Anonymous"}var n=this;this.img.onload=function(){n.loaded=true};this.img.onerror=function(){O.log('ERROR: image "'+e+'" not found');n.loaded=true};this.img.src=e}else{this.img=O.ajax(e);this.loaded=true}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x");var n=this.attribute("y").toPixels("y");var i=this.attribute("width").toPixels("x");var a=this.attribute("height").toPixels("y");if(i==0||a==0)return;t.save();if(r){t.drawSvg(this.img,e,n,i,a)}else{t.translate(e,n);O.AspectRatio(t,this.attribute("preserveAspectRatio").value,i,this.img.width,a,this.img.height,0,0);t.drawImage(this.img,0,0)}t.restore()};this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x");var e=this.attribute("y").toPixels("y");var n=this.attribute("width").toPixels("x");var i=this.attribute("height").toPixels("y");return new O.BoundingBox(t,e,t+n,e+i)}};O.Element.image.prototype=new O.Element.RenderedElementBase;O.Element.g=function(t){this.base=O.Element.RenderedElementBase;this.base(t);this.getBoundingBox=function(){var t=new O.BoundingBox;for(var e=0;e<this.children.length;e++){t.addBoundingBox(this.children[e].getBoundingBox())}return t}};O.Element.g.prototype=new O.Element.RenderedElementBase;O.Element.symbol=function(t){this.base=O.Element.RenderedElementBase;this.base(t);this.render=function(t){}};O.Element.symbol.prototype=new O.Element.RenderedElementBase;O.Element.style=function(t){this.base=O.Element.ElementBase;this.base(t);var e="";for(var n=0;n<t.childNodes.length;n++){e+=t.childNodes[n].data}e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");e=O.compressSpaces(e);var i=e.split("}");for(var n=0;n<i.length;n++){if(O.trim(i[n])!=""){var a=i[n].split("{");var r=a[0].split(",");var o=a[1].split(";");for(var s=0;s<r.length;s++){var l=O.trim(r[s]);if(l!=""){var u=O.Styles[l]||{};for(var h=0;h<o.length;h++){var c=o[h].indexOf(":");var f=o[h].substr(0,c);var d=o[h].substr(c+1,o[h].length-c);if(f!=null&&d!=null){u[O.trim(f)]=new O.Property(O.trim(f),O.trim(d))}}O.Styles[l]=u;O.StylesSpecificity[l]=Nz(l);if(l=="@font-face"){var g=u["font-family"].value.replace(/"/g,"");var p=u["src"].value.split(",");for(var v=0;v<p.length;v++){if(p[v].indexOf('format("svg")')>0){var m=p[v].indexOf("url");var _=p[v].indexOf(")",m);var y=p[v].substr(m+5,_-m-6);var b=O.parseXml(O.ajax(y));var w=b.getElementsByTagName("font");for(var x=0;x<w.length;x++){var k=O.CreateElement(w[x]);O.Definitions[g]=k}}}}}}}}};O.Element.style.prototype=new O.Element.ElementBase;O.Element.use=function(t){this.base=O.Element.RenderedElementBase;this.base(t);this.baseSetContext=this.setContext;this.setContext=function(t){this.baseSetContext(t);if(this.attribute("x").hasValue())t.translate(this.attribute("x").toPixels("x"),0);if(this.attribute("y").hasValue())t.translate(0,this.attribute("y").toPixels("y"))};var i=this.getHrefAttribute().getDefinition();this.path=function(t){if(i!=null)i.path(t)};this.getBoundingBox=function(){if(i!=null)return i.getBoundingBox()};this.renderChildren=function(t){if(i!=null){var e=i;if(i.type=="symbol"){e=new O.Element.svg;e.type="svg";e.attributes["viewBox"]=new O.Property("viewBox",i.attribute("viewBox").value);e.attributes["preserveAspectRatio"]=new O.Property("preserveAspectRatio",i.attribute("preserveAspectRatio").value);e.attributes["overflow"]=new O.Property("overflow",i.attribute("overflow").value);e.children=i.children}if(e.type=="svg"){if(this.attribute("width").hasValue())e.attributes["width"]=new O.Property("width",this.attribute("width").value);if(this.attribute("height").hasValue())e.attributes["height"]=new O.Property("height",this.attribute("height").value)}var n=e.parent;e.parent=null;e.render(t);e.parent=n}}};O.Element.use.prototype=new O.Element.RenderedElementBase;O.Element.mask=function(t){this.base=O.Element.ElementBase;this.base(t);this.apply=function(t,e){var n=this.attribute("x").toPixels("x");var i=this.attribute("y").toPixels("y");var a=this.attribute("width").toPixels("x");var r=this.attribute("height").toPixels("y");if(a==0&&r==0){var o=new O.BoundingBox;for(var s=0;s<this.children.length;s++){o.addBoundingBox(this.children[s].getBoundingBox())}var n=Math.floor(o.x1);var i=Math.floor(o.y1);var a=Math.floor(o.width());var r=Math.floor(o.height())}var l=e.attribute("mask").value;e.attribute("mask").value="";var u=document.createElement("canvas");u.width=n+a;u.height=i+r;var h=u.getContext("2d");this.renderChildren(h);var c=document.createElement("canvas");c.width=n+a;c.height=i+r;var f=c.getContext("2d");e.render(f);f.globalCompositeOperation="destination-in";f.fillStyle=h.createPattern(u,"no-repeat");f.fillRect(0,0,n+a,i+r);t.fillStyle=f.createPattern(c,"no-repeat");t.fillRect(0,0,n+a,i+r);e.attribute("mask").value=l};this.render=function(t){}};O.Element.mask.prototype=new O.Element.ElementBase;O.Element.clipPath=function(t){this.base=O.Element.ElementBase;this.base(t);this.apply=function(t){var e=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var n=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){};e.call(t);for(var i=0;i<this.children.length;i++){var a=this.children[i];if(typeof a.path!="undefined"){var r=null;if(a.style("transform",false,true).hasValue()){r=new O.Transform(a.style("transform",false,true).value);r.apply(t)}a.path(t);CanvasRenderingContext2D.prototype.closePath=n;if(r){r.unapply(t)}}}n.call(t);t.clip();CanvasRenderingContext2D.prototype.beginPath=e;CanvasRenderingContext2D.prototype.closePath=n};this.render=function(t){}};O.Element.clipPath.prototype=new O.Element.ElementBase;O.Element.filter=function(t){this.base=O.Element.ElementBase;this.base(t);this.apply=function(t,e){var n=e.getBoundingBox();var i=Math.floor(n.x1);var a=Math.floor(n.y1);var r=Math.floor(n.width());var o=Math.floor(n.height());var s=e.style("filter").value;e.style("filter").value="";var l=0,u=0;for(var h=0;h<this.children.length;h++){var c=this.children[h].extraFilterDistance||0;l=Math.max(l,c);u=Math.max(u,c)}var f=document.createElement("canvas");f.width=r+2*l;f.height=o+2*u;var d=f.getContext("2d");d.translate(-i+l,-a+u);e.render(d);for(var h=0;h<this.children.length;h++){if(typeof this.children[h].apply=="function"){this.children[h].apply(d,0,0,r+2*l,o+2*u)}}t.drawImage(f,0,0,r+2*l,o+2*u,i-l,a-u,r+2*l,o+2*u);e.style("filter",true).value=s};this.render=function(t){}};O.Element.filter.prototype=new O.Element.ElementBase;O.Element.feMorphology=function(t){this.base=O.Element.ElementBase;this.base(t);this.apply=function(t,e,n,i,a){}};O.Element.feMorphology.prototype=new O.Element.ElementBase;O.Element.feComposite=function(t){this.base=O.Element.ElementBase;this.base(t);this.apply=function(t,e,n,i,a){}};O.Element.feComposite.prototype=new O.Element.ElementBase;O.Element.feColorMatrix=function(t){this.base=O.Element.ElementBase;this.base(t);var i=O.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var e=i[0];i=[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var a=i[0]*Math.PI/180;var n=function t(e,n,i){return e+Math.cos(a)*n+Math.sin(a)*i};i=[n(.213,.787,-.213),n(.715,-.715,-.715),n(.072,-.072,.928),0,0,n(.213,-.213,.143),n(.715,.285,.14),n(.072,-.072,-.283),0,0,n(.213,-.213,-.787),n(.715,-.715,.715),n(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}function h(t,e,n,i,a,r){return t[n*i*4+e*4+r]}function c(t,e,n,i,a,r,o){t[n*i*4+e*4+r]=o}function f(t,e){var n=i[t];return n*(n<0?e-255:e)}this.apply=function(t,e,n,i,a){var r=t.getImageData(0,0,i,a);for(var n=0;n<a;n++){for(var e=0;e<i;e++){var o=h(r.data,e,n,i,a,0);var s=h(r.data,e,n,i,a,1);var l=h(r.data,e,n,i,a,2);var u=h(r.data,e,n,i,a,3);c(r.data,e,n,i,a,0,f(0,o)+f(1,s)+f(2,l)+f(3,u)+f(4,1));c(r.data,e,n,i,a,1,f(5,o)+f(6,s)+f(7,l)+f(8,u)+f(9,1));c(r.data,e,n,i,a,2,f(10,o)+f(11,s)+f(12,l)+f(13,u)+f(14,1));c(r.data,e,n,i,a,3,f(15,o)+f(16,s)+f(17,l)+f(18,u)+f(19,1))}}t.clearRect(0,0,i,a);t.putImageData(r,0,0)}};O.Element.feColorMatrix.prototype=new O.Element.ElementBase;O.Element.feGaussianBlur=function(t){this.base=O.Element.ElementBase;this.base(t);this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue());this.extraFilterDistance=this.blurRadius;this.apply=function(t,e,n,i,a){if(typeof ND.canvasRGBA=="undefined"){O.log("ERROR: StackBlur.js must be included for blur to work");return}t.canvas.id=O.UniqueId();t.canvas.style.display="none";document.body.appendChild(t.canvas);ND.canvasRGBA(t.canvas.id,e,n,i,a,this.blurRadius);document.body.removeChild(t.canvas)}};O.Element.feGaussianBlur.prototype=new O.Element.ElementBase;O.Element.title=function(t){};O.Element.title.prototype=new O.Element.ElementBase;O.Element.desc=function(t){};O.Element.desc.prototype=new O.Element.ElementBase;O.Element.MISSING=function(t){O.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")};O.Element.MISSING.prototype=new O.Element.ElementBase;O.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var n=null;if(typeof O.Element[e]!="undefined"){n=new O.Element[e](t)}else{n=new O.Element.MISSING(t)}n.type=t.nodeName;return n};O.load=function(t,e){O.loadXml(t,O.ajax(e))};O.loadXml=function(t,e){O.loadXmlDoc(t,O.parseXml(e))};O.loadXmlDoc=function(o,s){O.init(o);var n=function t(e){var n=o.canvas;while(n){e.x-=n.offsetLeft;e.y-=n.offsetTop;n=n.offsetParent}if(window.scrollX)e.x+=window.scrollX;if(window.scrollY)e.y+=window.scrollY;return e};if(O.opts["ignoreMouse"]!=true){o.canvas.onclick=function(t){var e=n(new O.Point(t!=null?t.clientX:event.clientX,t!=null?t.clientY:event.clientY));O.Mouse.onclick(e.x,e.y)};o.canvas.onmousemove=function(t){var e=n(new O.Point(t!=null?t.clientX:event.clientX,t!=null?t.clientY:event.clientY));O.Mouse.onmousemove(e.x,e.y)}}var l=O.CreateElement(s.documentElement);l.root=true;l.addStylesFromStyleDefinition();var u=true;var i=function t(){O.ViewPort.Clear();if(o.canvas.parentNode)O.ViewPort.SetCurrent(o.canvas.parentNode.clientWidth,o.canvas.parentNode.clientHeight);if(O.opts["ignoreDimensions"]!=true){if(l.style("width").hasValue()){o.canvas.width=l.style("width").toPixels("x");o.canvas.style.width=o.canvas.width+"px"}if(l.style("height").hasValue()){o.canvas.height=l.style("height").toPixels("y");o.canvas.style.height=o.canvas.height+"px"}}var e=o.canvas.clientWidth||o.canvas.width;var n=o.canvas.clientHeight||o.canvas.height;if(O.opts["ignoreDimensions"]==true&&l.style("width").hasValue()&&l.style("height").hasValue()){e=l.style("width").toPixels("x");n=l.style("height").toPixels("y")}O.ViewPort.SetCurrent(e,n);if(O.opts["offsetX"]!=null)l.attribute("x",true).value=O.opts["offsetX"];if(O.opts["offsetY"]!=null)l.attribute("y",true).value=O.opts["offsetY"];if(O.opts["scaleWidth"]!=null||O.opts["scaleHeight"]!=null){var i=null,a=null,r=O.ToNumberArray(l.attribute("viewBox").value);if(O.opts["scaleWidth"]!=null){if(l.attribute("width").hasValue())i=l.attribute("width").toPixels("x")/O.opts["scaleWidth"];else if(!isNaN(r[2]))i=r[2]/O.opts["scaleWidth"]}if(O.opts["scaleHeight"]!=null){if(l.attribute("height").hasValue())a=l.attribute("height").toPixels("y")/O.opts["scaleHeight"];else if(!isNaN(r[3]))a=r[3]/O.opts["scaleHeight"]}if(i==null){i=a}if(a==null){a=i}l.attribute("width",true).value=O.opts["scaleWidth"];l.attribute("height",true).value=O.opts["scaleHeight"];l.style("transform",true,true).value+=" scale("+1/i+","+1/a+")"}if(O.opts["ignoreClear"]!=true){o.clearRect(0,0,e,n)}l.render(o);if(u){u=false;if(typeof O.opts["renderCallback"]=="function")O.opts["renderCallback"](s)}};var a=true;if(O.ImagesLoaded()){a=false;i()}O.intervalID=setInterval(function(){var t=false;if(a&&O.ImagesLoaded()){a=false;t=true}if(O.opts["ignoreMouse"]!=true){t=t|O.Mouse.hasEvents()}if(O.opts["ignoreAnimation"]!=true){for(var e=0;e<O.Animations.length;e++){t=t|O.Animations[e].update(1e3/O.FRAMERATE)}}if(typeof O.opts["forceRedraw"]=="function"){if(O.opts["forceRedraw"]()==true)t=true}if(t){i();O.Mouse.runEvents()}},1e3/O.FRAMERATE)};O.stop=function(){if(O.intervalID){clearInterval(O.intervalID)}};O.Mouse=new function(){this.events=[];this.hasEvents=function(){return this.events.length!=0};this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function t(e){if(e.onclick)e.onclick()}})};this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function t(e){if(e.onmousemove)e.onmousemove()}})};this.eventElements=[];this.checkPath=function(t,e){for(var n=0;n<this.events.length;n++){var i=this.events[n];if(e.isPointInPath&&e.isPointInPath(i.x,i.y))this.eventElements[n]=t}};this.checkBoundingBox=function(t,e){for(var n=0;n<this.events.length;n++){var i=this.events[n];if(e.isPointInBox(i.x,i.y))this.eventElements[n]=t}};this.runEvents=function(){O.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++){var e=this.events[t];var n=this.eventElements[t];while(n){e.run(n);n=n.parent}}this.events=[];this.eventElements=[]}};return O}var Fz=Pz;function Lz(t){var e=t.attr("stroke-width");t.attr("stroke-width",!e?0:e);if(!e)t.attr("stroke","transparent");var n=["none","transparent"].includes(t.attr("fill"));var i=t.attr("fill-opacity");t.attr("fill-opacity",n?0:i);t.attr("aria-label",null)}function jz(t){t.selectAll("*").each(function(){var t=this.tagName.toLowerCase();if(!["option"].includes(t)){var e=Sd(this);var n=e.style("letter-spacing");e.style("letter-spacing",n==="normal"?"0.1px":n)}})}function Iz(t,e){return Uz(t)||Vz(t,e)||Hz()}function Hz(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Vz(t,e){if(!(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")){return}var n=[];var i=true;var a=false;var r=undefined;try{for(var o=t[Symbol.iterator](),s;!(i=(s=o.next()).done);i=true){n.push(s.value);if(e&&n.length===e)break}}catch(t){a=true;r=t}finally{try{if(!i&&o["return"]!=null)o["return"]()}finally{if(a)throw r}}return n}function Uz(t){if(Array.isArray(t))return t}var Gz={background:false,callback:function t(){},exclude:[],padding:0,scale:1};var Wz={ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true};function Kz(t){var e=Sd(t).attr("transform");var n=1,i=0,a=0;if(e){n=e.match(/scale\(([^a-z]+)\)/i);if(n)n=parseFloat(n[1]);else n=1;var r=e.match(/translate\(([^a-z]+)\)/i);if(r){var o=r[1].replace(", ",",").replace(/([^a-z]),*\s([^a-z])/gi,"$1,$2").split(",").map(function(t){return parseFloat(t)*n});var s=Iz(o,2);i=s[0];a=s[1]}}return[n,i,a]}function qz(t,q){if(!t)return;if(!(t instanceof Array))t=[t];q=Object.assign({},Gz,q);var h=new RegExp(/(MSIE|Trident\/|Edge\/)/i).test(navigator.userAgent);var Y=window?window.devicePixelRatio||1:1;var e=t[0];if(e.constructor===Object)e=e.element;var X=q.height||parseFloat(Sd(e).style("height"))+parseFloat(Sd(e).style("padding-top"))+parseFloat(Sd(e).style("padding-bottom")),Z=q.width||parseFloat(Sd(e).style("width"))+parseFloat(Sd(e).style("padding-left"))+parseFloat(Sd(e).style("padding-right"));var J,$,Q=0,tt=0;if(e.getBoundingClientRect){var n=e.getBoundingClientRect();Q=n.left;tt=n.top}else{Q=e.offsetLeft;tt=e.offsetTop}var c=document.createElement("canvas");c.width=(Z+q.padding*2)*q.scale*Y;c.height=(X+q.padding*2)*q.scale*Y;c.style.width=(Z+q.padding*2)*q.scale;c.style.height=(X+q.padding*2)*q.scale;var f=c.getContext("2d");f.scale(q.scale*Y,q.scale*Y);f.clearRect(0,0,c.width/Y,c.height/Y);if(q.background){f.beginPath();f.rect(0,0,c.width/Y,c.height/Y);f.fillStyle=q.background;f.fill()}var et=[];function i(t){var e=(this.tagName||"").toLowerCase();if(q.exclude.includes(this)||e==="foreignobject")return;var n=Object.assign({},t);if(this.tagName){var i=Sd(this).attr("opacity")||Sd(this).style("opacity");var a=Sd(this).style("display");var r=Sd(this).style("visibility");if(a==="none"||r==="hidden"||i&&parseFloat(i)===0)return;var o=this.tagName.toLowerCase();if(o.length&&["defs","title","desc"].includes(o))return;if(o==="svg"){if(!n.svg){var s=this.getBoundingClientRect(),l=s.left,u=s.top;n.x+=l-Q;n.y+=u-tt;n.svg=true}var h=Sd(this).attr("x");h=h?parseFloat(h)*n.scale:0;n.x+=h;var c=Sd(this).attr("y");c=c?parseFloat(c)*n.scale:0;n.y+=c;n.clip={height:parseFloat(Sd(this).attr("height")||Sd(this).style("height")),width:parseFloat(Sd(this).attr("width")||Sd(this).style("width")),x:h,y:c}}else{var f=Sd(this).attr("x");if(f)n.x+=parseFloat(f)*n.scale;var d=Sd(this).attr("y");if(d)n.y+=parseFloat(d)*n.scale}}if(!e.length){var g=(this.wholeText||"").replace(/\s/g,"");if(g.length){var p=this.nodeValue.replace(/^\s*/,"").replace(/^\n/,"").replace(/^\s*/,"").replace(/\n$/,"").replace(/\s*$/,"").replace(/\n$/,"");et.push({type:"text",style:this.parentNode,value:p,x:n.x,y:n.y})}}else if(e==="text"){var v=this.cloneNode(true);Sd(v).call(Lz);et.push(Object.assign({},n,{type:"svg",value:v}))}else if(["image","img"].includes(e)){var m=Sd(this).attr("href")||Sd(this).attr("xlink:href");if(m.length){var _=parseFloat(Sd(this).attr("height"))*n.scale,y=parseFloat(Sd(this).attr("width"))*n.scale;var b={clip:n.clip,height:_,loaded:false,type:"img",width:y,x:n.x,y:n.y};et.push(b);var w=new Image;w.crossOrigin="Anonymous";w.onload=function(){var t=document.createElement("canvas");var e=t.getContext("2d");t.height=_*Y;t.width=y*Y;e.drawImage(this,0,0,y*Y,_*Y);var n=document.createElement("img");n.src=t.toDataURL("image/png");b.value=n;b.loaded=true};w.onerror=function(){b.loaded=true;b.value=false};w.src=m}}else if(!["svg","g","text"].includes(e)&&!Sd(this).selectAll("svg").size()){var x=q.scale*Y;var k={height:Math.floor(X+q.padding*2+tt),loaded:false,type:"html",width:Math.floor(Z+q.padding*2+Q),x:Math.floor(J-Q),y:Math.floor($-tt)};var S=document.createElement("canvas");S.width=k.width*x;S.height=k.height*x;S.style.width="".concat(k.width*x,"px");S.style.height="".concat(k.height*x,"px");var C=S.getContext("2d");C.scale(x,x);et.push(k);jz(Sd(this));RD(this,{allowTaint:true,canvas:S,letterRendering:true}).then(function(t){k.value=t;k.loaded=true})}else if(e!=="svg"&&this.childNodes.length>0&&!Sd(this).selectAll("image, img, svg").size()){var A=this.cloneNode(true);Sd(A).selectAll("*").each(function(){Sd(this).call(Lz);if(Sd(this).attr("opacity")==="0")this.parentNode.removeChild(this)});et.push(Object.assign({},n,{type:"svg",value:A,tag:e}))}else if(this.childNodes.length>0){var E=Kz(this),M=Iz(E,3),R=M[0],T=M[1],B=M[2];n.scale*=R;n.x+=T;n.y+=B;nt(this,n)}else{var O=this.cloneNode(true);Sd(O).selectAll("*").each(function(){if(Sd(this).attr("opacity")==="0")this.parentNode.removeChild(this)});if(e==="line"){Sd(O).attr("x1",parseFloat(Sd(O).attr("x1"))+n.x);Sd(O).attr("x2",parseFloat(Sd(O).attr("x2"))+n.x);Sd(O).attr("y1",parseFloat(Sd(O).attr("y1"))+n.y);Sd(O).attr("y2",parseFloat(Sd(O).attr("y2"))+n.y)}else if(e==="path"){var P=Kz(O),D=Iz(P,3),N=D[0],z=D[1],F=D[2];if(Sd(O).attr("transform"))Sd(O).attr("transform","scale(".concat(N,")translate(").concat(z+n.x,",").concat(F+n.y,")"))}Sd(O).call(Lz);var L=Sd(O).attr("fill");var j=L&&L.indexOf("url")===0;et.push(Object.assign({},n,{type:"svg",value:O,tag:e}));if(j){var I=Sd(L.slice(4,-1)).node().cloneNode(true);var H=(I.tagName||"").toLowerCase();if(H==="pattern"){var V=Kz(O),U=Iz(V,3),G=U[0],W=U[1],K=U[2];n.scale*=G;n.x+=W;n.y+=K;nt(I,n)}}}}function nt(t,e){Md(t.childNodes).each(function(){i.bind(this)(e)})}for(var a=0;a<t.length;a++){var r=t[a],o={scale:1,x:0,y:0,svg:false};if(r.constructor===Object){o=Object.assign(o,r);r=r.element}J=o.x;$=o.y;i.bind(r)(o)}function s(){var t=true;for(var e=0;e<et.length;e++){if(et[e].loaded===false){t=false;break}}if(t)l();else setTimeout(s,500)}s();function l(){for(var t=0;t<et.length;t++){var e=et[t];var n=e.clip||{height:X,width:Z,x:0,y:0};switch(e.type){case"img":if(e.value){f.save();f.beginPath();f.translate(q.padding+n.x,q.padding+n.y);f.rect(0,0,n.width,n.height);f.clip();f.drawImage(e.value,e.x+n.x,e.y+n.y,e.width,e.height);f.restore()}break;case"html":f.save();f.beginPath();f.translate(q.padding,q.padding);f.drawImage(e.value,e.x,e.y,e.width,e.height);f.restore();break;case"text":var i=Sd(e.style);var a=e.value.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var r=i.style("color"),o=i.style("font-size");var s=i.style("font-family").split(",")[0];if(s.indexOf("'")!==0)s="'".concat(s,"'");var l="<text stroke='none' dy='".concat(o,"' fill='").concat(r,"' font-family=").concat(s," font-size='").concat(o,"'>").concat(a,"</text>");f.save();f.translate(q.padding,q.padding);Fz(c,l,Object.assign({},Wz,{offsetX:e.x,offsetY:e.y}));f.restore();break;case"svg":var u=h?(new XMLSerializer).serializeToString(e.value):e.value.outerHTML;f.save();f.translate(q.padding+n.x+e.x,q.padding+n.y+e.y);f.rect(0,0,n.width,n.height);f.clip();Fz(c,u,Object.assign({},Wz,{offsetX:e.x+n.x,offsetY:e.y+n.y}));f.restore();break;default:console.warn("uncaught",e);break}}q.callback(c)}}(function(t){var f=t.Uint8Array,e=t.HTMLCanvasElement,n=e&&e.prototype,l=/\s*;\s*base64\s*(?:;|$)/i,u="toDataURL",d,h=function t(e){var n=e.length,i=new f(n/4*3|0),a=0,r=0,o=[0,0],s=0,l=0,u,h,c;while(n--){h=e.charCodeAt(a++);u=d[h-43];if(u!==255&&u!==c){o[1]=o[0];o[0]=h;l=l<<6|u;s++;if(s===4){i[r++]=l>>>16;if(o[1]!==61){i[r++]=l>>>8}if(o[0]!==61){i[r++]=l}s=0}}}return i};if(f){d=new f([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51])}if(e&&(!n.toBlob||!n.toBlobHD)){if(!n.toBlob)n.toBlob=function(t,e){if(!e){e="image/png"}if(this.mozGetAsFile){t(this.mozGetAsFile("canvas",e));return}if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(e)){t(this.msToBlob());return}var n=Array.prototype.slice.call(arguments,1),i=this[u].apply(this,n),a=i.indexOf(","),r=i.substring(a+1),o=l.test(i.substring(0,a)),s;if(Blob.fake){s=new Blob;if(o){s.encoding="base64"}else{s.encoding="URI"}s.data=r;s.size=r.length}else if(f){if(o){s=new Blob([h(r)],{type:e})}else{s=new Blob([decodeURIComponent(r)],{type:e})}}t(s)};if(!n.toBlobHD&&n.toDataURLHD){n.toBlobHD=function(){u="toDataURLHD";var t=this.toBlob();u="toDataURL";return t}}else{n.toBlobHD=n.toBlob}}})(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||DT.content||DT);var Yz=zT(function(t){var e=e||function(h){if(typeof h==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var t=h.document,c=function t(){return h.URL||h.webkitURL||h},f=t.createElementNS("http://www.w3.org/1999/xhtml","a"),d="download"in f,g=function t(e){var n=new MouseEvent("click");e.dispatchEvent(n)},p=/constructor/i.test(h.HTMLElement)||h.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent),o=function t(e){(h.setImmediate||h.setTimeout)(function(){throw e},0)},m="application/octet-stream",i=1e3*40,_=function t(e){var n=function t(){if(typeof e==="string"){c().revokeObjectURL(e)}else{e.remove()}};setTimeout(n,i)},y=function t(e,n,i){n=[].concat(n);var a=n.length;while(a--){var r=e["on"+n[a]];if(typeof r==="function"){try{r.call(e,i||e)}catch(t){o(t)}}}},b=function t(e){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)){return new Blob([String.fromCharCode(65279),e],{type:e.type})}return e},a=function t(i,e,n){if(!n){i=b(i)}var a=this,r=i.type,o=r===m,s,l=function t(){y(a,"writestart progress write writeend".split(" "))},u=function t(){if((v||o&&p)&&h.FileReader){var n=new FileReader;n.onloadend=function(){var t=v?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");var e=h.open(t,"_blank");if(!e)h.location.href=t;t=undefined;a.readyState=a.DONE;l()};n.readAsDataURL(i);a.readyState=a.INIT;return}if(!s){s=c().createObjectURL(i)}if(o){h.location.href=s}else{var e=h.open(s,"_blank");if(!e){h.location.href=s}}a.readyState=a.DONE;l();_(s)};a.readyState=a.INIT;if(d){s=c().createObjectURL(i);setTimeout(function(){f.href=s;f.download=e;g(f);l();_(s);a.readyState=a.DONE});return}u()},e=a.prototype,n=function t(e,n,i){return new a(e,n||e.name||"download",i)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(t,e,n){e=e||t.name||"download";if(!n){t=b(t)}return navigator.msSaveOrOpenBlob(t,e)}}e.abort=function(){};e.readyState=e.INIT=0;e.WRITING=1;e.DONE=2;e.error=e.onwritestart=e.onprogress=e.onwrite=e.onabort=e.onerror=e.onwriteend=null;return n}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||DT.content);if(t.exports){t.exports.saveAs=e}});var Xz=Yz.saveAs;var Zz={filename:"download",type:"png"};function Jz(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!t)return;n=Object.assign({},Zz,n);var e=new RegExp(/(MSIE|Trident\/|Edge\/)/i).test(navigator.userAgent);if(!(t instanceof Array)&&n.type==="svg"){var a=e?(new XMLSerializer).serializeToString(t):t.outerHTML;Xz(new Blob([a],{type:"application/svg+xml"}),"".concat(n.filename,".svg"))}qz(t,Object.assign({},i,{callback:function t(e){if(i.callback)i.callback(e);if(["jpg","png"].includes(n.type)){e.toBlob(function(t){return Xz(t,"".concat(n.filename,".").concat(n.type))})}}}))}var $z={Button:tB,Radio:hB,Select:bB};function Qz(){var c=this;var f=this;var d=this._controlPadding()?this._padding:{top:0,right:0,bottom:0,left:0};var g=["left","right","top","bottom"];var t=function t(e){var l=g[e];var u=(c._controls||[]).filter(function(t){return!t.position&&l==="bottom"||t.position===l});if(c._downloadButton&&c._downloadPosition===l){u.push({data:[{text:c._translate("Download"),value:1}],label:"downloadButton",on:{click:function t(){var e=c._detectResize;if(e)c.detectResize(false).render();Jz(c._select.node(),Object.assign({title:c._title||undefined},c._downloadConfig),{callback:function t(){setTimeout(function(){if(e)c.detectResize(e).render()},5e3)}})}},type:"Button"})}var n=l==="top"||l==="bottom";var i={height:n?c._height-(c._margin.top+c._margin.bottom):c._height-(c._margin.top+c._margin.bottom+d.top+d.bottom),width:n?c._width-(c._margin.left+c._margin.right+d.left+d.right):c._width-(c._margin.left+c._margin.right)};i.x=(n?c._margin.left+d.left:c._margin.left)+(l==="right"?c._width-c._margin.bottom:0);i.y=(n?c._margin.top:c._margin.top+d.top)+(l==="bottom"?c._height-c._margin.bottom:0);var a=Wv("foreignObject.d3plus-viz-controls-".concat(l),{condition:u.length,enter:Object.assign({opacity:0},i),exit:Object.assign({opacity:0},i),parent:c._select,transition:c._transition,update:{height:i.height,opacity:1,width:i.width}});var h=a.selectAll("div.d3plus-viz-controls-container").data([null]);h=h.enter().append("xhtml:div").attr("class","d3plus-viz-controls-container").merge(h);if(u.length){var r=function t(e){var n=Object.assign({},u[e]);var i={};if(n.on){var a=function t(e){if({}.hasOwnProperty.call(n.on,e)){i[e]=function(){n.on[e].bind(f)(this.value)}}};for(var r in n.on){a(r)}}var o=n.label||"".concat(l,"-").concat(e);if(!c._controlCache[o]){var s=n.type&&$z[n.type]?n.type:"Select";c._controlCache[o]=(new $z[s]).container(h.node());if(n.checked)c._controlCache[o].checked(n.checked);if(n.selected)c._controlCache[o].selected(n.selected)}delete n.checked;delete n.selected;c._controlCache[o].config(n).config({on:i}).config(c._controlConfig).render()};for(var o=0;o<u.length;o++){r(o)}h.style("display",["top","bottom"].includes(l)?"block":"inline-block").style("text-align",["top","bottom"].includes(l)?"center":l);var s=h.node().getBoundingClientRect();a.transition(c._transition).attr("x",i.x-(l==="right"?s.width:0)).attr("y",i.y-(l==="bottom"?s.height:0)).attr("height",n?s.height:i.height).attr("width",n?i.width:s.width);c._margin[l]+=["top","bottom"].includes(l)?s.height:s.width}};for(var e=0;e<g.length;e++){t(e)}}function tF(t,e){return this._drawLabel(t,e,this._legendDepth)}function eF(){var o=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(this._legend){var e=this._legendClass.outerBounds();var n=this._legendPosition;var i=["top","bottom"].includes(n);var a=this._legendPadding()?this._padding:{top:0,right:0,bottom:0,left:0};var r={transform:"translate(".concat(i?this._margin.left+a.left:this._margin.left,", ").concat(i?this._margin.top:this._margin.top+a.top,")")};var s=Wv("g.d3plus-viz-legend",{condition:this._legend&&!this._legendConfig.select,enter:r,parent:this._select,transition:this._transition,update:r}).node();var l=[];var u=function t(e,n){var i=o._shape(e,n);var a=i==="Line"?"stroke":"fill";var r=o._shapeConfig[i]&&o._shapeConfig[i][a]?o._shapeConfig[i][a]:o._shapeConfig[a];return typeof r==="function"?r(e,n):r};var h=function t(e,n){var i=o._shape(e,n);var a=o._shapeConfig[i]&&o._shapeConfig[i].opacity?o._shapeConfig[i].opacity:o._shapeConfig.opacity;return typeof a==="function"?a(e,n):a};var c=function t(e,n){return"".concat(u(e,n),"_").concat(h(e,n))};mm().key(c).rollup(function(t){return l.push(Em(t,o._aggs))}).entries(this._colorScale?t.filter(function(t,e){return o._colorScale(t,e)===undefined}):t);l.sort(this._legendSort);var f=l.map(function(t,e){return o._ids(t,e).slice(0,o._drawDepth+1)});this._legendDepth=0;var d=function t(e){var n=f.map(function(t){return t[e]});if(!n.some(function(t){return t instanceof Array})&&Array.from(new Set(n)).length===l.length){o._legendDepth=e;return"break"}};for(var g=0;g<=this._drawDepth;g++){var p=d(g);if(p==="break")break}var v=function t(e,n){var i=o._id(e,n);if(i instanceof Array)i=i[0];return o._hidden.includes(i)||o._solo.length&&!o._solo.includes(i)};this._legendClass.id(c).align(i?"center":n).direction(i?"row":"column").duration(this._duration).data(l.length>this._legendCutoff||this._colorScale?l:[]).height(i?this._height-(this._margin.bottom+this._margin.top):this._height-(this._margin.bottom+this._margin.top+a.bottom+a.top)).locale(this._locale).select(s).verticalAlign(!i?"middle":n).width(i?this._width-(this._margin.left+this._margin.right+a.left+a.right):this._width-(this._margin.left+this._margin.right)).shapeConfig(Bc.bind(this)(this._shapeConfig,"legend")).config(this._legendConfig).shapeConfig({fill:function t(e,n){return v(e,n)?o._hiddenColor(e,n):u(e,n)},labelConfig:{fontOpacity:function t(e,n){return v(e,n)?o._hiddenOpacity(e,n):1}},opacity:h}).render();if(!this._legendConfig.select&&e.height){if(i)this._margin[n]+=e.height+this._legendClass.padding()*2;else this._margin[n]+=e.width+this._legendClass.padding()*2}}}function nF(n){var i=this;if(!(n instanceof Array))n=[n,n];if(JSON.stringify(n)!==JSON.stringify(this._timelineSelection)){this._timelineSelection=n;n=n.map(Number);this.timeFilter(function(t){var e=GT(i._time(t)).getTime();return e>=n[0]&&e<=n[1]}).render()}}function iF(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var n=this._time&&this._timeline;var i=n?Am(this._data.map(this._time)).map(GT):[];n=n&&i.length>1;var a=this._timelinePadding()?this._padding:{top:0,right:0,bottom:0,left:0};var r={transform:"translate(".concat(this._margin.left+a.left,", 0)")};var o=Wv("g.d3plus-viz-timeline",{condition:n,enter:r,parent:this._select,transition:this._transition,update:r}).node();if(n){var s=this._timelineClass.domain(tm(i)).duration(this._duration).height(this._height-this._margin.bottom).locale(this._locale).select(o).ticks(i.sort(function(t,e){return+t-+e})).width(this._width-(this._margin.left+this._margin.right+a.left+a.right));if(s.selection()===undefined){this._timelineSelection=tm(t,this._time).map(GT);s.selection(this._timelineSelection)}var l=this._timelineConfig;s.config(l).on("end",function(t){nF.bind(e)(t);if(l.on&&l.on.end)l.on.end(t)}).render();this._margin.bottom+=s.outerBounds().height+s.padding()*2}}function aF(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var e=this._title?this._title(t):false;var n=this._titlePadding()?this._padding:{top:0,right:0,bottom:0,left:0};var i={transform:"translate(".concat(this._margin.left+n.left,", ").concat(this._margin.top,")")};var a=Wv("g.d3plus-viz-title",{enter:i,parent:this._select,transition:this._transition,update:i}).node();this._titleClass.data(e?[{text:e}]:[]).locale(this._locale).select(a).width(this._width-(this._margin.left+this._margin.right+n.left+n.right)).config(this._titleConfig).render();this._margin.top+=e?a.getBBox().height:0}function rF(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var e=typeof this._total==="function"?dm(t.map(this._total)):this._total===true&&this._size?dm(t.map(this._size)):false;var n=this._totalPadding()?this._padding:{top:0,right:0,bottom:0,left:0};var i={transform:"translate(".concat(this._margin.left+n.left,", ").concat(this._margin.top,")")};var a=Wv("g.d3plus-viz-total",{enter:i,parent:this._select,transition:this._transition,update:i}).node();var r=typeof e==="number";this._totalClass.data(r?[{text:this._totalFormat(e)}]:[]).locale(this._locale).select(a).width(this._width-(this._margin.left+this._margin.right+n.left+n.right)).config(this._totalConfig).render();this._margin.top+=r?a.getBBox().height+this._totalConfig.padding*2:0}function oF(t,e){if(!t)return undefined;if(t.tagName===undefined||["BODY","HTML"].indexOf(t.tagName)>=0){var n=window["inner".concat(e.charAt(0).toUpperCase()+e.slice(1))];var i=Sd(t);if(e==="width"){n-=parseFloat(i.style("margin-left"),10);n-=parseFloat(i.style("margin-right"),10);n-=parseFloat(i.style("padding-left"),10);n-=parseFloat(i.style("padding-right"),10)}else{n-=parseFloat(i.style("margin-top"),10);n-=parseFloat(i.style("margin-bottom"),10);n-=parseFloat(i.style("padding-top"),10);n-=parseFloat(i.style("padding-bottom"),10)}return n}else{var a=parseFloat(Sd(t).style(e),10);if(typeof a==="number"&&a>0)return a;else return oF(t.parentNode,e)}}function sF(t){return[oF(t,"width"),oF(t,"height")]}function lF(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var n=window.pageXOffset!==undefined?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft;var i=window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;var a=t.getBoundingClientRect();var r=a.height,o=a.left+n,s=a.top+i,l=a.width;return i+window.innerHeight>s+e&&i+e<s+r&&n+window.innerWidth>o+e&&n+e<o+l}function uF(t,e){this._select.style("cursor","auto");if(this._drawDepth<this._groupBy.length-1){var i=this._groupBy[this._drawDepth],a=i(t,e);this.hover(false);if(this._tooltip(t,e))this._tooltipClass.data([]).render();var r=this._filter;this._history.push({depth:this._depth,filter:r});this.config({depth:this._drawDepth+1,filter:function t(e,n){return(!r||r(e,n))&&i(e,n)===a}}).render()}}function hF(t,e){var i=this;this._select.style("cursor","auto");if(this._tooltip(t,e))this._tooltipClass.data([]).render();var n=this._id(t,e);if(!(n instanceof Array))n=[n];var a=this._hidden.indexOf(n[0]);var r=this._solo.indexOf(n[0]);var o=cm(this._legendClass.data().map(function(t,e){var n=i._id(t,e);if(!(n instanceof Array))n=[n];return n})).length;if(ld.shiftKey){if(a<0&&!this._solo.length){this._hidden=this._hidden.concat(n);if(this._solo.length===o)this._solo=[];if(this._hidden.length===o)this._hidden=[];this.render()}else if(r>=0){this._solo=[];this._hidden=[];this.render()}}else{if(r<0&&this._hidden.length<o-1){this._solo=n;this._hidden=[]}else{this._solo=[];this._hidden=[]}this.render()}}var cF=function t(e){return e.reduce(function(t,e){if(e instanceof Array){if(t.length){var n=t.slice();t=[];e.forEach(function(e){return t=t.concat(n.map(function(t){return"".concat(t,"_").concat(e)}))})}else{t=e.slice()}}else if(t.length){t=t.map(function(t){return"".concat(t,"_").concat(e)})}else{t.push(e)}return t},[])};function fF(t,e){var i=this;if(this._shapeConfig.hoverOpacity!==1){var a=cF(this._ids(t,e));this.hover(function(t,e){var n=cF(i._ids(t,e));return a.some(function(t){return n.includes(t)})})}}function dF(n,i){var a=this;setTimeout(function(){if(a._shapeConfig.hoverOpacity!==1&&a._hover?a._hover(n,i):true){a.hover(false)}var t=a._tooltipClass.data();if(t.length&&a._tooltip(n,i)){var e=t[0];while(e.__d3plus__&&e.data){e=e.data}if(a._id(e)===a._id(n))a._tooltipClass.data([]).render()}},50);this._select.style("cursor","auto")}function gF(t,e,n){var i=this;var a=ld.touches?[ld.touches[0].clientX,ld.touches[0].clientY]:[ld.clientX,ld.clientY];var r=cm(this._legendClass.data().map(function(t,e){var n=i._id(t,e);if(!(n instanceof Array))n=[n];return n})).length;if(t&&this._tooltip(t,e)){var o=this._id(t,e);if(o instanceof Array)o=o[0];var s=this._translate;this._select.style("cursor","pointer");this._tooltipClass.data([n||t]).footer(this._solo.length&&!this._solo.includes(o)?s("Click to Highlight"):this._solo.length===1&&this._solo.includes(o)||this._hidden.length===r-1?s("Click to Reset"):this._solo.includes(o)?s("Click to Hide"):this._hidden.includes(o)?s("Click to Highlight"):"".concat(s("Click to Highlight"),"<br />").concat(s("Shift+Click to Hide"))).title(this._legendConfig.label?this._legendClass.label():tF.bind(this)).position(a).config(Bc.bind(this)(this._tooltipConfig)).config(Bc.bind(this)(this._legendTooltip)).render()}}function pF(t,e,n){if(t&&this._tooltip(t,e)){this._select.style("cursor","pointer");var i=ld.touches?[ld.touches[0].clientX,ld.touches[0].clientY]:[ld.clientX,ld.clientY];this._tooltipClass.data([n||t]).footer(this._drawDepth<this._groupBy.length-1?this._translate("Click to Expand"):false).title(this._drawLabel).position(i).config(Bc.bind(this)(this._tooltipConfig)).render()}}function vF(t){ld.preventDefault();ld.stopPropagation();if(!t)this._tooltipClass.data([]).render()}function mF(t,e){return bF(t)||yF(t,e)||_F()}function _F(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function yF(t,e){if(!(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")){return}var n=[];var i=true;var a=false;var r=undefined;try{for(var o=t[Symbol.iterator](),s;!(i=(s=o.next()).done);i=true){n.push(s.value);if(e&&n.length===e)break}}catch(t){a=true;r=t}finally{try{if(!i&&o["return"]!=null)o["return"]()}finally{if(a)throw r}}return n}function bF(t){if(Array.isArray(t))return t}var wF=false;function xF(){if(!this._container||!this._zoomGroup)return;var t=this._zoomHeight||this._height-this._margin.top-this._margin.bottom,e=this,n=this._zoomWidth||this._width-this._margin.left-this._margin.right;this._zoomBehavior.extent([[0,0],[n,t]]).scaleExtent([1,this._zoomMax]).translateExtent([[0,0],[n,t]]).on("zoom",SF.bind(this));this._zoomToBounds=AF.bind(this);var i=Sd(this._select.node().parentNode).selectAll("div.d3plus-zoom-control").data(this._zoom?[0]:[]);var a=i.enter().append("div").attr("class","d3plus-zoom-control");i.exit().remove();i=i.merge(a).style("position","absolute").style("top","".concat(this._margin.top,"px")).style("left","".concat(this._margin.left,"px"));a.append("div").attr("class","zoom-control zoom-in");i.select(".zoom-in").on("click",CF.bind(this,this._zoomFactor)).html("&#65291;");a.append("div").attr("class","zoom-control zoom-out");i.select(".zoom-out").on("click",CF.bind(this,1/this._zoomFactor)).html("&#65293;");a.append("div").attr("class","zoom-control zoom-reset");i.select(".zoom-reset").on("click",CF.bind(this,0)).html("&#8634");a.append("div").attr("class","zoom-control zoom-brush");i.select(".zoom-brush").on("click",function(){Sd(this).classed("active",!wF).call(Tm,wF?e._zoomControlStyle||{}:e._zoomControlStyleActive||{});kF.bind(e)(!wF)}).html("&#164");i.selectAll(".zoom-control").call(Tm,e._zoomControlStyle).on("mouseenter",function(){Sd(this).call(Tm,e._zoomControlStyleHover||{})}).on("mouseleave",function(){Sd(this).call(Tm,Sd(this).classed("active")?e._zoomControlStyleActive||{}:e._zoomControlStyle||{})});this._zoomBrush.extent([[0,0],[n,t]]).filter(function(){return!ld.button&&ld.detail<2}).handleSize(this._zoomBrushHandleSize).on("start",RF.bind(this)).on("brush",EF.bind(this)).on("end",MF.bind(this));var r=this._container.selectAll("g.brush").data([0]);this._brushGroup=r.enter().append("g").attr("class","brush").merge(r).call(this._zoomBrush);kF.bind(this)();if(this._renderTiles)this._renderTiles(ST(this._container.node()),0)}function kF(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;wF=t;if(wF)this._brushGroup.style("display","inline");else this._brushGroup.style("display","none");if(!wF&&this._zoom){this._container.call(this._zoomBehavior);if(!this._zoomScroll){this._container.on("wheel.zoom",null)}if(!this._zoomPan){this._container.on("mousedown.zoom mousemove.zoom",null).on("touchstart.zoom touchmove.zoom touchend.zoom touchcancel.zoom",null)}}else{this._container.on(".zoom",null)}}function SF(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this._zoomGroup){if(!e)this._zoomGroup.attr("transform",t||ld.transform);else this._zoomGroup.transition().duration(e).attr("transform",t||ld.transform)}if(this._renderTiles)this._renderTiles(ST(this._container.node()),e)}function CF(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(!this._container)return;var e=this._zoomBehavior.extent().bind(document)()[1].map(function(t){return t/2}),n=this._zoomBehavior.scaleExtent(),i=ST(this._container.node());if(!t){i.k=n[0];i.x=0;i.y=0}else{var a=[(e[0]-i.x)/i.k,(e[1]-i.y)/i.k];i.k=Math.min(n[1],i.k*t);if(i.k<=n[0]){i.k=n[0];i.x=0;i.y=0}else{i.x+=e[0]-(a[0]*i.k+i.x);i.y+=e[1]-(a[1]*i.k+i.y)}}SF.bind(this)(i,this._duration)}function AF(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this._duration;var n=this._zoomBehavior.scaleExtent(),i=ST(this._container.node());if(t){var a=mF(this._zoomBehavior.translateExtent()[1],2),r=a[0],o=a[1],s=t[1][0]-t[0][0],l=t[1][1]-t[0][1];var u=Math.min(n[1],1/Math.max(s/r,l/o));var h,c;if(s/l<r/o){u*=(o-this._zoomPadding*2)/o;h=(r-s*u)/2/u;c=this._zoomPadding/u}else{u*=(r-this._zoomPadding*2)/r;c=(o-l*u)/2/u;h=this._zoomPadding/u}i.x=(i.x-t[0][0]+h)*(i.k*u/i.k);i.y=(i.y-t[0][1]+c)*(i.k*u/i.k);i.k*=u;if(i.x>0)i.x=0;else if(i.x<r*-i.k+r)i.x=r*-i.k+r;if(i.y>0)i.y=0;else if(i.y<o*-i.k+o)i.y=o*-i.k+o}else{i.k=n[0];i.x=0;i.y=0}SF.bind(this)(i,e)}function EF(){TF.bind(this)()}function MF(){if(!ld.selection)return;this._brushGroup.call(this._zoomBrush.move,null);AF.bind(this)(ld.selection)}function RF(){TF.bind(this)()}function TF(){this._brushGroup.selectAll(".selection").call(_,this._zoomBrushSelectionStyle||{});this._brushGroup.selectAll(".handle").call(_,this._zoomBrushHandleStyle||{})}function BF(t){return DF(t)||PF(t)||OF()}function OF(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function PF(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function DF(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++){n[e]=t[e]}return n}}function NF(t,e){return LF(t)||FF(t,e)||zF()}function zF(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function FF(t,e){if(!(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")){return}var n=[];var i=true;var a=false;var r=undefined;try{for(var o=t[Symbol.iterator](),s;!(i=(s=o.next()).done);i=true){n.push(s.value);if(e&&n.length===e)break}}catch(t){a=true;r=t}finally{try{if(!i&&o["return"]!=null)o["return"]()}finally{if(a)throw r}}return n}function LF(t){if(Array.isArray(t))return t}function jF(t){if(typeof Symbol==="function"&&ie(Symbol.iterator)==="symbol"){jF=function t(e){return ie(e)}}else{jF=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ie(e)}}return jF(t)}function IF(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function HF(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}function VF(t,e,n){if(e)HF(t.prototype,e);if(n)HF(t,n);return t}function UF(t,e){if(e&&(jF(e)==="object"||typeof e==="function")){return e}return WF(t)}function GF(t){GF=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return GF(t)}function WF(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function KF(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)qF(t,e)}function qF(t,e){qF=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return qF(t,e)}function YF(){return typeof window!=="undefined"?window.innerWidth>600:true}function XF(i){return i.reduce(function(t,e,n){if(!n)t+=e;else if(n===i.length-1&&n===1)t+=" and ".concat(e);else if(n===i.length-1)t+=", and ".concat(e);else t+=", ".concat(e);return t},"")}var ZF=function(t){KF(e,t);function e(){var s;IF(this,e);s=UF(this,GF(e).call(this));s._aggs={};s._ariaHidden=true;s._backClass=(new pC).on("click",function(){if(s._history.length)s.config(s._history.pop()).render();else s.depth(s._drawDepth-1).filter(false).render()}).on("mousemove",function(){return s._backClass.select().style("cursor","pointer")});s._backConfig={fontSize:10,padding:5,resize:false};s._cache=true;s._color=function(t,e){return s._groupBy[0](t,e)};s._colorScaleClass=new cO;s._colorScaleConfig={};s._colorScalePadding=YF;s._colorScalePosition="bottom";s._colorScaleMaxSize=600;var t=new bB;s._controlCache={};s._controlConfig={selectStyle:Object.assign({margin:"5px"},t.selectStyle())};s._controlPadding=YF;s._data=[];s._dataCutoff=100;s._detectResize=true;s._detectResizeDelay=400;s._detectVisible=true;s._detectVisibleInterval=1e3;s._downloadButton=false;s._downloadConfig={type:"png"};s._downloadPosition="top";s._duration=600;s._hidden=[];s._hiddenColor=Oc("#aaa");s._hiddenOpacity=Oc(.5);s._history=[];s._groupBy=[g("id")];s._legend=true;s._legendClass=new FB;s._legendConfig={label:tF.bind(WF(s)),shapeConfig:{ariaLabel:tF.bind(WF(s)),labelConfig:{fontColor:undefined,fontResize:false,padding:0}}};s._legendCutoff=1;s._legendPadding=YF;s._legendPosition="bottom";s._legendSort=function(t,e){return s._drawLabel(t).localeCompare(s._drawLabel(e))};s._legendTooltip={};s._loadingHTML=function(){return"\n    <div style=\"left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;\">\n      <strong>".concat(s._translate("Loading Visualization"),'</strong>\n      <sub style="bottom: 0; display: block; line-height: 1; margin-top: 5px;"><a href="https://d3plus.org" target="_blank">').concat(s._translate("Powered by D3plus"),"</a></sub>\n    </div>")};s._loadingMessage=true;s._lrucache=FT(10);s._messageClass=new AD;s._messageMask="rgba(0, 0, 0, 0.05)";s._messageStyle={bottom:"0",left:"0",position:"absolute",right:"0","text-align":"center",top:"0"};s._noDataHTML=function(){return"\n    <div style=\"left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;\">\n      <strong>".concat(s._translate("No Data Available"),"</strong>\n    </div>")};s._noDataMessage=true;s._on={"click.shape":uF.bind(WF(s)),"click.legend":hF.bind(WF(s)),mouseenter:fF.bind(WF(s)),mouseleave:dF.bind(WF(s)),"mousemove.shape":pF.bind(WF(s)),"mousemove.legend":gF.bind(WF(s))};s._queue=[];s._scrollContainer=(typeof window==="undefined"?"undefined":jF(window))===undefined?"":window;s._shape=Oc("Rect");s._shapes=[];s._shapeConfig={ariaLabel:function t(e,n){return s._drawLabel(e,n)},fill:function t(e,n){while(e.__d3plus__&&e.data){e=e.data;n=e.i}if(s._colorScale){var i=s._colorScale(e,n);if(i!==undefined&&i!==null){var a=s._colorScaleClass._colorScale;var r=s._colorScaleClass.color();if(!a)return r instanceof Array?r[r.length-1]:r;else if(!a.domain().length)return a.range()[a.range().length-1];return a(i)}}var o=s._color(e,n);if(Lg(o))return o;return kS(o)},labelConfig:{fontColor:function t(e,n){var i=typeof s._shapeConfig.fill==="function"?s._shapeConfig.fill(e,n):s._shapeConfig.fill;return SS(i)}},opacity:Oc(1),stroke:function t(e,n){var i=typeof s._shapeConfig.fill==="function"?s._shapeConfig.fill(e,n):s._shapeConfig.fill;return Lg(i).darker()},role:"presentation",strokeWidth:Oc(0)};s._solo=[];s._svgDesc="";s._svgTitle="";s._timeline=true;s._timelineClass=(new IO).align("end");s._timelineConfig={brushing:false,padding:5};s._timelinePadding=YF;s._threshold=Oc(1e-4);s._thresholdKey=undefined;s._thresholdName=function(){return s._translate("Values")};s._titleClass=new pC;s._titleConfig={ariaHidden:true,fontSize:12,padding:5,resize:false,textAnchor:"middle"};s._titlePadding=YF;s._tooltip=Oc(true);s._tooltipClass=new xD;s._tooltipConfig={pointerEvents:"none",titleStyle:{"max-width":"200px"}};s._totalClass=new pC;s._totalConfig={fontSize:10,padding:5,resize:false,textAnchor:"middle"};s._totalFormat=function(t){return"".concat(s._translate("Total"),": ").concat(UT(t,s._locale))};s._totalPadding=YF;s._zoom=false;s._zoomBehavior=PT();s._zoomBrush=uT();s._zoomBrushHandleSize=1;s._zoomBrushHandleStyle={fill:"#444"};s._zoomBrushSelectionStyle={fill:"#777","stroke-width":0};s._zoomControlStyle={background:"rgba(255, 255, 255, 0.75)",border:"1px solid rgba(0, 0, 0, 0.75)",color:"rgba(0, 0, 0, 0.75)",display:"block",font:"900 15px/21px 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",height:"20px",margin:"5px",opacity:.75,padding:0,"text-align":"center",width:"20px"};s._zoomControlStyleActive={background:"rgba(0, 0, 0, 0.75)",color:"rgba(255, 255, 255, 0.75)",opacity:1};s._zoomControlStyleHover={cursor:"pointer",opacity:1};s._zoomFactor=2;s._zoomMax=16;s._zoomPadding=20;s._zoomPan=true;s._zoomScroll=true;return s}VF(e,[{key:"_preDraw",value:function t(){var r=this;var o=this;this._drawDepth=this._depth!==void 0?this._depth:this._groupBy.length-1;this._id=this._groupBy[this._drawDepth];this._ids=function(e,n){return r._groupBy.map(function(t){return!e||e.__d3plus__&&!e.data?undefined:t(e.__d3plus__?e.data:e,e.__d3plus__?e.i:n)}).filter(function(t){return t!==undefined&&t!==null})};this._drawLabel=function(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:r._drawDepth;if(!t)return"";if(t._isAggregation){return"".concat(r._thresholdName(t,e)," < ").concat(UT(t._threshold*100,r._locale),"%")}while(t.__d3plus__&&t.data){t=t.data;e=t.i}if(r._label)return"".concat(r._label(t,e));var i=o._ids(t,e).slice(0,n+1);var a=i.reverse().find(function(t){return!(t instanceof Array)})||i[i.length-1];return a instanceof Array?XF(a):"".concat(a)};if(this._time&&!this._timeFilter&&this._data.length){var e=this._data.map(this._time).map(GT);var n=this._data[0],i=0;if(this._discrete&&"_".concat(this._discrete)in this&&this["_".concat(this._discrete)](n,i)===this._time(n,i)){this._timeFilter=function(){return true}}else{var a=+um(e);this._timeFilter=function(t,e){return+GT(r._time(t,e))===a}}}this._filteredData=[];this._legendData=[];var s=[];if(this._data.length){s=this._timeFilter?this._data.filter(this._timeFilter):this._data;if(this._filter)s=s.filter(this._filter);var l=mm();for(var u=0;u<=this._drawDepth;u++){l.key(this._groupBy[u])}if(this._discrete&&"_".concat(this._discrete)in this)l.key(this["_".concat(this._discrete)]);if(this._discrete&&"_".concat(this._discrete,"2")in this)l.key(this["_".concat(this._discrete,"2")]);var h=l.rollup(function(t){var e=r._data.indexOf(t[0]);var n=r._shape(t[0],e);var i=r._id(t[0],e);var a=Em(t,r._aggs);if(!r._hidden.includes(i)&&(!r._solo.length||r._solo.includes(i))){if(!r._discrete&&n==="Line")r._filteredData=r._filteredData.concat(t);else r._filteredData.push(a)}r._legendData.push(a)}).entries(s);this._filteredData=this._thresholdFunction(this._filteredData,h)}var c=mm().key(this._id).entries(this._filteredData).length;if(c>this._dataCutoff){if(this._userHover===undefined)this._userHover=this._shapeConfig.hoverOpacity||.5;if(this._userDuration===undefined)this._userDuration=this._shapeConfig.duration||600;this._shapeConfig.hoverOpacity=1;this._shapeConfig.duration=0}else if(this._userHover!==undefined){this._shapeConfig.hoverOpacity=this._userHover;this._shapeConfig.duration=this._userDuration}if(this._noDataMessage&&!this._filteredData.length){this._messageClass.render({container:this._select.node().parentNode,html:this._noDataHTML(this),mask:false,style:this._messageStyle})}}},{key:"_draw",value:function t(){if(this._legendPosition==="left"||this._legendPosition==="right")eF.bind(this)(this._filteredData);if(this._colorScalePosition==="left"||this._colorScalePosition==="right"||this._colorScalePosition===false)MD.bind(this)(this._filteredData);ED.bind(this)();aF.bind(this)(this._filteredData);rF.bind(this)(this._filteredData);iF.bind(this)(this._filteredData);Qz.bind(this)(this._filteredData);if(this._legendPosition==="top"||this._legendPosition==="bottom")eF.bind(this)(this._legendData);if(this._colorScalePosition==="top"||this._colorScalePosition==="bottom")MD.bind(this)(this._filteredData);this._shapes=[]}},{key:"_thresholdFunction",value:function t(e){return e}},{key:"render",value:function t(r){var o=this;this._margin={bottom:0,left:0,right:0,top:0};this._padding={bottom:0,left:0,right:0,top:0};this._transition=Lv().duration(this._duration);if(this._select===void 0||this._select.node().tagName.toLowerCase()!=="svg"){var e=this._select===void 0?Sd("body").append("div"):this._select;var n=e.append("svg");this.select(n.node())}function s(){var t=this._select.style("display");this._select.style("display","none");var e=sF(this._select.node().parentNode),n=NF(e,2),i=n[0],a=n[1];i-=parseFloat(this._select.style("border-left-width"),10);i-=parseFloat(this._select.style("border-right-width"),10);a-=parseFloat(this._select.style("border-top-width"),10);a-=parseFloat(this._select.style("border-bottom-width"),10);this._select.style("display",t);if(this._autoWidth){this.width(i);this._select.style("width","".concat(this._width,"px")).attr("width","".concat(this._width,"px"))}if(this._autoHeight){this.height(a);this._select.style("height","".concat(this._height,"px")).attr("height","".concat(this._height,"px"))}}if((!this._width||!this._height)&&(!this._detectVisible||lF(this._select.node()))){this._autoWidth=this._width===undefined;this._autoHeight=this._height===undefined;s.bind(this)()}this._select.attr("class","d3plus-viz").attr("aria-hidden",this._ariaHidden).attr("aria-labelledby","".concat(this._uuid,"-title ").concat(this._uuid,"-desc")).attr("role","img").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").transition(Lv).style("width",this._width!==undefined?"".concat(this._width,"px"):undefined).style("height",this._height!==undefined?"".concat(this._height,"px"):undefined).attr("width",this._width!==undefined?"".concat(this._width,"px"):undefined).attr("height",this._height!==undefined?"".concat(this._height,"px"):undefined);var i=this._select.selectAll("title").data([0]);var a=i.enter().append("title").attr("id","".concat(this._uuid,"-title"));i.merge(a).text(this._svgTitle);var l=this._select.selectAll("desc").data([0]);var u=l.enter().append("desc").attr("id","".concat(this._uuid,"-desc"));l.merge(u).text(this._svgDesc);this._visiblePoll=clearInterval(this._visiblePoll);this._resizePoll=clearTimeout(this._resizePoll);this._scrollPoll=clearTimeout(this._scrollPoll);Sd(this._scrollContainer).on("scroll.".concat(this._uuid),null);Sd(this._scrollContainer).on("resize.".concat(this._uuid),null);if(this._detectVisible&&this._select.style("visibility")==="hidden"){this._visiblePoll=setInterval(function(){if(o._select.style("visibility")!=="hidden"){o._visiblePoll=clearInterval(o._visiblePoll);o.render(r)}},this._detectVisibleInterval)}else if(this._detectVisible&&this._select.style("display")==="none"){this._visiblePoll=setInterval(function(){if(o._select.style("display")!=="none"){o._visiblePoll=clearInterval(o._visiblePoll);o.render(r)}},this._detectVisibleInterval)}else if(this._detectVisible&&!lF(this._select.node())){Sd(this._scrollContainer).on("scroll.".concat(this._uuid),function(){if(!o._scrollPoll){o._scrollPoll=setTimeout(function(){if(lF(o._select.node())){Sd(o._scrollContainer).on("scroll.".concat(o._uuid),null);o.render(r)}o._scrollPoll=clearTimeout(o._scrollPoll)},o._detectVisibleInterval)}})}else{var h=yT();if(this._loadingMessage){this._messageClass.render({container:this._select.node().parentNode,html:this._loadingHTML(this),mask:this._filteredData?this._messageMask:false,style:this._messageStyle})}this._queue.forEach(function(t){var e=o._cache?o._lrucache.get(t[1]):undefined;if(!e)h.defer.apply(h,BF(t));else o["_".concat(t[3])]=e});this._queue=[];h.awaitAll(function(){var n=o._data instanceof Array&&o._data.length>0?Object.keys(o._data[0]):[];var t=o._select.selectAll("g.data-table").data(!o._ariaHidden&&o._data instanceof Array&&o._data.length?[0]:[]);var e=t.enter().append("g").attr("class","data-table").attr("role","table");t.exit().remove();var i=t.merge(e).selectAll("text").data(o._data instanceof Array?em(0,o._data.length+1):[]);i.exit().remove();var a=i.merge(i.enter().append("text").attr("role","row")).selectAll("tspan").data(function(t,e){return n.map(function(t){return{role:e?"cell":"columnheader",text:e?o._data[e-1][t]:t}})});a.exit().remove();a.merge(a.enter().append("tspan")).attr("role",function(t){return t.role}).attr("dy","-1000px").html(function(t){return t.text});o._preDraw();o._draw(r);xF.bind(o)();if(o._messageClass._isVisible&&(!o._noDataMessage||o._filteredData.length))o._messageClass.hide();if(o._detectResize&&(o._autoWidth||o._autoHeight)){Sd(o._scrollContainer).on("resize.".concat(o._uuid),function(){o._resizePoll=clearTimeout(o._resizePoll);o._resizePoll=setTimeout(function(){o._resizePoll=clearTimeout(o._resizePoll);s.bind(o)();o.render(r)},o._detectResizeDelay)})}if(r)setTimeout(r,o._duration+100)})}Sd("body").on("touchstart.".concat(this._uuid),vF.bind(this));return this}},{key:"active",value:function t(e){this._active=e;if(this._shapeConfig.activeOpacity!==1){this._shapes.forEach(function(t){return t.active(e)});if(this._legend)this._legendClass.active(e)}return this}},{key:"aggs",value:function t(e){return arguments.length?(this._aggs=gt(this._aggs,e),this):this._aggs}},{key:"ariaHidden",value:function t(e){return arguments.length?(this._ariaHidden=e,this):this._ariaHidden}},{key:"backConfig",value:function t(e){return arguments.length?(this._backConfig=gt(this._backConfig,e),this):this._backConfig}},{key:"cache",value:function t(e){return arguments.length?(this._cache=e,this):this._cache}},{key:"color",value:function t(e){return arguments.length?(this._color=!e||typeof e==="function"?e:g(e),this):this._color}},{key:"colorScale",value:function t(e){return arguments.length?(this._colorScale=!e||typeof e==="function"?e:g(e),this):this._colorScale}},{key:"colorScaleConfig",value:function t(e){return arguments.length?(this._colorScaleConfig=gt(this._colorScaleConfig,e),this):this._colorScaleConfig}},{key:"colorScalePadding",value:function t(e){return arguments.length?(this._colorScalePadding=typeof e==="function"?e:Oc(e),this):this._colorScalePadding}},{key:"colorScalePosition",value:function t(e){return arguments.length?(this._colorScalePosition=e,this):this._colorScalePosition}},{key:"colorScaleMaxSize",value:function t(e){return arguments.length?(this._colorScaleMaxSize=e,this):this._colorScaleMaxSize}},{key:"controls",value:function t(e){return arguments.length?(this._controls=e,this):this._controls}},{key:"controlConfig",value:function t(e){return arguments.length?(this._controlConfig=gt(this._controlConfig,e),this):this._controlConfig}},{key:"controlPadding",value:function t(e){return arguments.length?(this._controlPadding=typeof e==="function"?e:Oc(e),this):this._controlPadding}},{key:"data",value:function t(e,n){if(arguments.length){var i=this._queue.find(function(t){return t[3]==="data"});var a=[PR.bind(this),e,n,"data"];if(i)this._queue[this._queue.indexOf(i)]=a;else this._queue.push(a);this._hidden=[];this._solo=[];return this}return this._data}},{key:"dataCutoff",value:function t(e){return arguments.length?(this._dataCutoff=e,this):this._dataCutoff}},{key:"depth",value:function t(e){return arguments.length?(this._depth=e,this):this._depth}},{key:"detectResize",value:function t(e){return arguments.length?(this._detectResize=e,this):this._detectResize}},{key:"detectResizeDelay",value:function t(e){return arguments.length?(this._detectResizeDelay=e,this):this._detectResizeDelay}},{key:"detectVisible",value:function t(e){return arguments.length?(this._detectVisible=e,this):this._detectVisible}},{key:"detectVisibleInterval",value:function t(e){return arguments.length?(this._detectVisibleInterval=e,this):this._detectVisibleInterval}},{key:"discrete",value:function t(e){return arguments.length?(this._discrete=e,this):this._discrete}},{key:"downloadButton",value:function t(e){return arguments.length?(this._downloadButton=e,this):this._downloadButton}},{key:"downloadConfig",value:function t(e){return arguments.length?(this._downloadConfig=gt(this._downloadConfig,e),this):this._downloadConfig}},{key:"downloadPosition",value:function t(e){return arguments.length?(this._downloadPosition=e,this):this._downloadPosition}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"filter",value:function t(e){return arguments.length?(this._filter=e,this):this._filter}},{key:"groupBy",value:function t(e){var n=this;if(!arguments.length)return this._groupBy;if(!(e instanceof Array))e=[e];return this._groupBy=e.map(function(t){if(typeof t==="function")return t;else{if(!n._aggs[t]){n._aggs[t]=function(t){var e=Am(t);return e.length===1?e[0]:e}}return g(t)}}),this}},{key:"height",value:function t(e){return arguments.length?(this._height=e,this):this._height}},{key:"hiddenColor",value:function t(e){return arguments.length?(this._hiddenColor=typeof e==="function"?e:Oc(e),this):this._hiddenColor}},{key:"hiddenOpacity",value:function t(e){return arguments.length?(this._hiddenOpacity=typeof e==="function"?e:Oc(e),this):this._hiddenOpacity}},{key:"hover",value:function t(e){var i=this;var n=this._hover=e;if(this._shapeConfig.hoverOpacity!==1){if(typeof e==="function"){var a=cm(this._shapes.map(function(t){return t.data()}));a=a.concat(this._legendClass.data());var r=e?a.filter(e):[];var o=[];r.map(this._ids).forEach(function(t){for(var e=1;e<=t.length;e++){o.push(JSON.stringify(t.slice(0,e)))}});o=o.filter(function(t,e){return o.indexOf(t)===e});if(o.length)n=function t(e,n){return o.includes(JSON.stringify(i._ids(e,n)))}}this._shapes.forEach(function(t){return t.hover(n)});if(this._legend)this._legendClass.hover(n)}return this}},{key:"label",value:function t(e){return arguments.length?(this._label=typeof e==="function"?e:Oc(e),this):this._label}},{key:"legend",value:function t(e){return arguments.length?(this._legend=e,this):this._legend}},{key:"legendConfig",value:function t(e){return arguments.length?(this._legendConfig=gt(this._legendConfig,e),this):this._legendConfig}},{key:"legendCutoff",value:function t(e){return arguments.length?(this._legendCutoff=e,this):this._legendCutoff}},{key:"legendTooltip",value:function t(e){return arguments.length?(this._legendTooltip=gt(this._legendTooltip,e),this):this._legendTooltip}},{key:"legendPadding",value:function t(e){return arguments.length?(this._legendPadding=typeof e==="function"?e:Oc(e),this):this._legendPadding}},{key:"legendPosition",value:function t(e){return arguments.length?(this._legendPosition=e,this):this._legendPosition}},{key:"legendSort",value:function t(e){return arguments.length?(this._legendSort=e,this):this._legendSort}},{key:"loadingHTML",value:function t(e){return arguments.length?(this._loadingHTML=typeof e==="function"?e:Oc(e),this):this._loadingHTML}},{key:"loadingMessage",value:function t(e){return arguments.length?(this._loadingMessage=e,this):this._loadingMessage}},{key:"messageMask",value:function t(e){return arguments.length?(this._messageMask=e,this):this._messageMask}},{key:"messageStyle",value:function t(e){return arguments.length?(this._messageStyle=gt(this._messageStyle,e),this):this._messageStyle}},{key:"noDataHTML",value:function t(e){return arguments.length?(this._noDataHTML=typeof e==="function"?e:Oc(e),this):this._noDataHTML}},{key:"noDataMessage",value:function t(e){return arguments.length?(this._noDataMessage=e,this):this._noDataMessage}},{key:"scrollContainer",value:function t(e){return arguments.length?(this._scrollContainer=e,this):this._scrollContainer}},{key:"select",value:function t(e){return arguments.length?(this._select=Sd(e),this):this._select}},{key:"shape",value:function t(e){return arguments.length?(this._shape=typeof e==="function"?e:Oc(e),this):this._shape}},{key:"shapeConfig",value:function t(e){return arguments.length?(this._shapeConfig=gt(this._shapeConfig,e),this):this._shapeConfig}},{key:"svgDesc",value:function t(e){return arguments.length?(this._svgDesc=e,this):this._svgDesc}},{key:"svgTitle",value:function t(e){return arguments.length?(this._svgTitle=e,this):this._svgTitle}},{key:"threshold",value:function t(e){if(arguments.length){if(typeof e==="function"){this._threshold=e}else if(isFinite(e)&&!isNaN(e)){this._threshold=Oc(e*1)}return this}else return this._threshold}},{key:"thresholdKey",value:function t(e){if(arguments.length){if(typeof e==="function"){this._thresholdKey=e}else{this._thresholdKey=g(e)}return this}else return this._thresholdKey}},{key:"thresholdName",value:function t(e){return arguments.length?(this._thresholdName=typeof e==="function"?e:Oc(e),this):this._thresholdName}},{key:"time",value:function t(e){if(arguments.length){if(typeof e==="function"){this._time=e}else{this._time=g(e);if(!this._aggs[e]){this._aggs[e]=function(t){var e=Am(t);return e.length===1?e[0]:e}}}this._timeFilter=false;return this}else return this._time}},{key:"timeFilter",value:function t(e){return arguments.length?(this._timeFilter=e,this):this._timeFilter}},{key:"timeline",value:function t(e){return arguments.length?(this._timeline=e,this):this._timeline}},{key:"timelineConfig",value:function t(e){return arguments.length?(this._timelineConfig=gt(this._timelineConfig,e),this):this._timelineConfig}},{key:"timelinePadding",value:function t(e){return arguments.length?(this._timelinePadding=typeof e==="function"?e:Oc(e),this):this._timelinePadding}},{key:"title",value:function t(e){return arguments.length?(this._title=typeof e==="function"?e:Oc(e),this):this._title}},{key:"titleConfig",value:function t(e){return arguments.length?(this._titleConfig=gt(this._titleConfig,e),this):this._titleConfig}},{key:"titlePadding",value:function t(e){return arguments.length?(this._titlePadding=typeof e==="function"?e:Oc(e),this):this._titlePadding}},{key:"tooltip",value:function t(e){return arguments.length?(this._tooltip=typeof e==="function"?e:Oc(e),this):this._tooltip}},{key:"tooltipConfig",value:function t(e){return arguments.length?(this._tooltipConfig=gt(this._tooltipConfig,e),this):this._tooltipConfig}},{key:"total",value:function t(e){if(arguments.length){if(typeof e==="function")this._total=e;else if(e)this._total=g(e);else this._total=false;return this}else return this._total}},{key:"totalConfig",value:function t(e){return arguments.length?(this._totalConfig=gt(this._totalConfig,e),this):this._totalConfig}},{key:"totalFormat",value:function t(e){return arguments.length?(this._totalFormat=e,this):this._totalFormat}},{key:"totalPadding",value:function t(e){return arguments.length?(this._totalPadding=typeof e==="function"?e:Oc(e),this):this._totalPadding}},{key:"width",value:function t(e){return arguments.length?(this._width=e,this):this._width}},{key:"zoom",value:function t(e){return arguments.length?(this._zoom=e,this):this._zoom}},{key:"zoomBrushHandleSize",value:function t(e){return arguments.length?(this._zoomBrushHandleSize=e,this):this._zoomBrushHandleSize}},{key:"zoomBrushHandleStyle",value:function t(e){return arguments.length?(this._zoomBrushHandleStyle=e,this):this._zoomBrushHandleStyle}},{key:"zoomBrushSelectionStyle",value:function t(e){return arguments.length?(this._zoomBrushSelectionStyle=e,this):this._zoomBrushSelectionStyle}},{key:"zoomControlStyle",value:function t(e){return arguments.length?(this._zoomControlStyle=e,this):this._zoomControlStyle}},{key:"zoomControlStyleActive",value:function t(e){return arguments.length?(this._zoomControlStyleActive=e,this):this._zoomControlStyleActive}},{key:"zoomControlStyleHover",value:function t(e){return arguments.length?(this._zoomControlStyleHover=e,this):this._zoomControlStyleHover}},{key:"zoomFactor",value:function t(e){return arguments.length?(this._zoomFactor=e,this):this._zoomFactor}},{key:"zoomMax",value:function t(e){return arguments.length?(this._zoomMax=e,this):this._zoomMax}},{key:"zoomPan",value:function t(e){return arguments.length?(this._zoomPan=e,this):this._zoomPan}},{key:"zoomPadding",value:function t(e){return arguments.length?(this._zoomPadding=e,this):this._zoomPadding}},{key:"zoomScroll",value:function t(e){return arguments.length?(this._zoomScroll=e,this):this._zoomScroll}}]);return e}(Mc);var JF=function(t,e,n){if(t.padding)t.padding(.5);else{var i=e.map(function(t){return t[n]}).reduce(function(t,e,n,i){if(!n)return t;var a=i[n-1];if(!t||e-a<t)return e-a;else return t},0);var a=t.domain().slice();if(n==="y")a.reverse();a[0]=new Date(+a[0]-i/2);a[1]=new Date(+a[1]+i/2);if(n==="y")a.reverse();t.domain(a)}};function $F(t){var e=this;var n=t.data,i=t.x,a=t.y,r=t.x2,o=t.y2,s=t.buffer,l=s===void 0?10:s;var u=r?"x2":"x";var h=o?"y2":"y";var c=this._discrete==="x"?a:i;var f=c.domain().slice();var d=this._discrete==="x";if(d)f.reverse();var g,p;if(this._stacked){var v=mm().key(function(t){return"".concat(t[e._discrete],"_").concat(t.group)}).entries(n).map(function(t){return t.values.map(function(t){return t[d?h:u]})});p=v.map(function(t){return dm(t.filter(function(t){return t>0}))});g=v.map(function(t){return dm(t.filter(function(t){return t<0}))})}else{p=n.map(function(t){return t[d?h:u]});g=p}var m=c(um(p));if(d?m<c(0):m>c(0))m+=d?-l:l;m=c.invert(m);var _=c(fm(g));if(d?_>c(0):_<c(0))_+=d?l:-l;_=c.invert(_);if(m>f[1])f[1]=m;if(_<f[0])f[0]=_;if(d)f.reverse();c.domain(f);JF(d?i:a,n,this._discrete);return[i,a]}function QF(t){var e=this;var n=t.data,i=t.x,a=t.y,r=t.x2,o=t.y2,s=t.buffer,l=s===void 0?10:s;var u=r?"x2":"x";var h=o?"y2":"y";var c=this._discrete==="x"?a:i;var f=c.domain().slice();var d=this._discrete==="x";if(d)f.reverse();var g,p;if(this._stacked){var v=mm().key(function(t){return t[e._discrete]}).entries(n).map(function(t){return t.values.map(function(t){return t[d?h:u]})});p=v.map(function(t){return dm(t.filter(function(t){return t>0}))});g=v.map(function(t){return dm(t.filter(function(t){return t<0}))})}else{p=n.map(function(t){return t[d?h:u]});g=p}var m=c(um(p));m+=d?-l:l;m=c.invert(m);var _=c(fm(g));_+=d?l:-l;_=c.invert(_);if(m>f[1])f[1]=m;if(_<f[0])f[0]=_;if(d)f.reverse();c.domain(f);JF(d?i:a,n,this._discrete);return[i,a]}function tL(c,f,d,g,t,e,p,v){if(v){e=e.slice().reverse();t=t.slice().reverse()}var n=function t(){var e=c.copy();var n=false;if(f==="log"){var i=c.domain().slice(),a=c.range().slice();if(v){i=i.reverse();a=a.reverse()}n=i[0]*i[1]<0;if(n){var r=N_().domain([1,Math.abs(i[p])]).range([0,1]);var o=r(Math.abs(i[p?0:1]));var s=o/(o+1)*(a[1]-a[0]);i=(p===0?[i[0],1]:[1,i[1]]).map(Math.abs);a=p===0?[a[0],a[0]+s]:[a[0]+s,a[1]]}e=N_().domain(i).range(a)}var l=false;var u=e.range();var h;if(f==="log"){h=!n||d<0&&!p||d>0&&p?e(Math.abs(d)):u[d<0?0:1]}else h=e(d);if(v){if(p===0)l=h+g>u[p];else if(p===1)l=h-g<u[p]}else{if(p===0)l=h-g<u[p];else if(p===1)l=h+g>u[p]}return l};if(c.invert&&n()){if(f==="log"){var i=p===0&&e[0]>0||p===1&&e[1]<0;var a=Math[i?"ceil":"floor"](Math.log10(Math.abs(e[p])));while(n()&&a<20){a=i?a-1:a+1;var r=e[p]<0?-1:1;if(a<0){a=1;i=!i;r=!r}e[p]=Math.pow(10,a)*r;c.domain(v?e.slice().reverse():e)}}else if(p===0){var o=c.invert(c(d)+g*(v?1:-1));if(o<e[p]){e[p]=o;c.domain(v?e.slice().reverse():e)}}else if(p===1){var s=c.invert(c(d)+g*(v?-1:1));if(s>e[p]){e[p]=s;c.domain(v?e.slice().reverse():e)}}}return v?e.reverse():e}function eL(t){var e=t.data,n=t.x,i=t.y,a=t.x2,r=t.y2,o=t.yScale,s=t.xScale,l=t.config,u=t.buffer;n=n.copy();i=i.copy();var h=a?"x2":"x";var c=r?"y2":"y";var f=n.domain().slice(),d=i.domain().slice();var g=n.range(),p=i.range();if(!n.invert&&n.padding)JF(n,e,this._discrete);if(!i.invert&&i.padding)JF(i,e,this._discrete);if(n.invert||i.invert){e.forEach(function(t){var e=u?u:l.r(t.data,t.i)*2;if(n.invert){f=tL(n,s,t[h],e,g,f,0,false);f=tL(n,s,t[h],e,g,f,1,false)}if(i.invert){d=tL(i,o,t[c],e,p,d,0,true);d=tL(i,o,t[c],e,p,d,1,true)}})}return[n,i]}function nL(t){var e=this;var n=t.data,i=t.x,a=t.y,r=t.x2,o=t.y2;var s=r?"x2":"x";var l=o?"y2":"y";var u=this._discrete==="x"?a:i;var h=u.domain().slice();if(this._discrete==="x")h.reverse();var c=n.map(function(t){return t[e._discrete==="x"?l:s]});var f=u.invert(u(um(c))+(this._discrete==="x"?-10:10));if(f>h[1])h[1]=f;if(this._discrete==="x")h.reverse();u.domain(h);return[i,a]}function iL(t){var e=t.data,i=t.x,a=t.y,n=t.x2,r=t.y2,o=t.yScale,s=t.xScale,l=t.config;i=i.copy();a=a.copy();var u=n?"x2":"x";var h=r?"y2":"y";var c=i.domain().slice(),f=a.domain().slice();var d=i.range(),g=a.range();if(!i.invert&&i.padding)JF(i,e,this._discrete);if(!a.invert&&a.padding)JF(a,e,this._discrete);if(i.invert||a.invert){e.forEach(function(t){if(i.invert){var e=l.width(t.data,t.i);c=tL(i,s,t[u],e,d,c,0,false);c=tL(i,s,t[u],e,d,c,1,false)}if(a.invert){var n=l.height(t.data,t.i);f=tL(a,o,t[h],n,g,f,0,true);f=tL(a,o,t[h],n,g,f,1,true)}})}return[i,a]}var aL=new kE;var rL=new pC;function oL(t){return this._sizeScaleD3(this._size?this._size(t):null)}function sL(t){var n=t.map(uL);var i=t.map(function(t){return t.key.split("_")[0]});return Dk(t).sort(function(t,e){return i[e].localeCompare(i[t])||n[t]-n[e]})}function lL(t){return sL(t).reverse()}function uL(t){var e=-1,n=0,i;var a=t.length;while(++e<a){if(i=+t[e][1])n+=i}return n}function hL(t,e){var n;if(!((n=t.length)>0))return;var i,a,r,o,s;var l=t[e[0]].length;for(var u=0;u<l;++u){for(s=o=0,r=0;r<n;++r){if((a=(i=t[e[r]][u])[1]-i[0])>=0){i[0]=s,i[1]=s+=a}else if(a<0){i[1]=o,i[0]=o+=a}else{i[0]=s}}}}var cL=function(t){o(ne,t);function ne(){var a;n(this,ne);a=u(this,re(ne).call(this));a._annotations=[];a._backgroundConfig={duration:0,fill:"transparent"};a._barPadding=0;a._buffer={Bar:$F,Box:QF,Circle:eL,Line:nL,Rect:iL};a._confidenceConfig={fill:function t(e,n){var i=typeof a._shapeConfig.Line.stroke==="function"?a._shapeConfig.Line.stroke(e,n):a._shapeConfig.Line.stroke;return i},fillOpacity:Oc(.5)};a._discreteCutoff=100;a._groupPadding=5;a._lineMarkerConfig={fill:function t(e,n){return kS(a._id(e,n))},r:Oc(3)};a._lineMarkers=false;a._previousShapes=[];a._shape=Oc("Circle");a._shapeConfig=gt(a._shapeConfig,{Area:{label:function t(e,n){return a._stacked?a._drawLabel(e,n):false},labelConfig:{fontResize:true}},ariaLabel:function t(e,n){var i="";if(e.nested)i="".concat(a._drawLabel(e.data,e.i));else{i="".concat(a._drawLabel(e,n));if(a._x(e,n)!==undefined)i+=", x: ".concat(a._x(e,n));if(a._y(e,n)!==undefined)i+=", y: ".concat(a._y(e,n));if(a._x2(e,n)!==undefined)i+=", x2: ".concat(a._x2(e,n));if(a._y2(e,n)!==undefined)i+=", y2: ".concat(a._y2(e,n))}return"".concat(i,".")},Bar:{labelConfig:{textAnchor:function t(){return a._discrete==="x"?"middle":"end"},verticalAlign:function t(){return a._discrete==="x"?"top":"middle"}}},Circle:{r:oL.bind(l(a))},Line:{fill:Oc("none"),labelConfig:{fontColor:function t(e,n){var i=typeof a._shapeConfig.Line.stroke==="function"?a._shapeConfig.Line.stroke(e,n):a._shapeConfig.Line.stroke;return CS(i)},fontResize:false,padding:5,textAnchor:"start",verticalAlign:"middle"},stroke:function t(e,n){return kS(a._id(e,n))},strokeWidth:Oc(2)},Rect:{height:function t(e){return oL.bind(l(a))(e)*2},width:function t(e){return oL.bind(l(a))(e)*2}}});a._shapeOrder=["Area","Path","Bar","Box","Line","Rect","Circle"];a._shapeSort=function(t,e){return a._shapeOrder.indexOf(t)-a._shapeOrder.indexOf(e)};a._sizeMax=20;a._sizeMin=5;a._sizeScale="sqrt";a._stackOffset=hL;a._stackOrder=lL;a._timelineConfig=gt(a._timelineConfig,{brushing:true});a._x=g("x");a._xAxis=(new PM).align("end");a._xTest=(new PM).align("end").gridSize(0);a._xConfig={};a._xCutoff=150;a._x2=g("x2");a._x2Axis=(new iR).align("start");a._x2Test=(new iR).align("start").gridSize(0);a._x2Config={padding:0};a._y=g("y");a._yAxis=(new HM).align("start");a._yTest=(new HM).align("start").gridSize(0);a._yConfig={gridConfig:{stroke:function t(e){var n=a._yAxis.range();return n[n.length-1]===a._yAxis._getPosition.bind(a._yAxis)(e.id)?"transparent":"#ccc"}}};a._yCutoff=150;a._y2=g("y2");a._y2Axis=(new XM).align("end");a._y2Test=(new HM).align("end").gridSize(0);a._y2Config={};return a}e(ne,[{key:"_draw",value:function t(e){var z=this;if(!this._filteredData.length)return this;var s=function t(e,n){return z._stacked?"".concat(z._groupBy.length>1?z._ids(e,n).slice(0,-1).join("_"):"group"):"".concat(z._ids(e,n).join("_"))};var l=this._filteredData.map(function(t,e){return{__d3plus__:true,data:t,group:s(t,e),i:e,hci:z._confidence&&z._confidence[1]&&z._confidence[1](t,e),id:z._ids(t,e).slice(0,z._drawDepth+1).join("_"),lci:z._confidence&&z._confidence[0]&&z._confidence[0](t,e),shape:z._shape(t,e),x:z._x(t,e),x2:z._x2(t,e),y:z._y(t,e),y2:z._y2(t,e)}});this._formattedData=l;if(this._size){var n=tm(l,function(t){return z._size(t.data)});this._sizeScaleD3=function(){return z._sizeMin};this._sizeScaleD3=Sw["scale".concat(this._sizeScale.charAt(0).toUpperCase()).concat(this._sizeScale.slice(1))]().domain(n).range([n[0]===n[1]?this._sizeMax:fm([this._sizeMax/2,this._sizeMin]),this._sizeMax])}else{this._sizeScaleD3=function(){return z._sizeMin}}var i=l.some(function(t){return t.x2!==undefined}),a=l.some(function(t){return t.y2!==undefined});var r=this._height-this._margin.top-this._margin.bottom,u=this._discrete?this._discrete==="x"?"y":"x":undefined,o=this._discrete?this._discrete==="x"?"y2":"x2":undefined,h=[u,o].filter(function(t){return t}),c=this._select,f=this._transition,F=this._width-this._margin.left-this._margin.right;var d=this._time&&l[0].x2===this._time(l[0].data,l[0].i),g=this._time&&l[0].x===this._time(l[0].data,l[0].i),p=this._time&&l[0].y2===this._time(l[0].data,l[0].i),v=this._time&&l[0].y===this._time(l[0].data,l[0].i);for(var m=0;m<l.length;m++){var _=l[m];if(g)_.x=uM(_.x);if(d)_.x2=uM(_.x2);if(v)_.y=uM(_.y);if(p)_.y2=uM(_.y2);_.discrete=_.shape==="Bar"?"".concat(_[this._discrete],"_").concat(_.group):"".concat(_[this._discrete])}var y,b,w,x;if(this._stacked){var k;var S=mm().key(function(t){return t.group}).entries(l).reduce(function(t,e){if(!t[e.key])t[e.key]=0;t[e.key]+=dm(e.values,function(t){return t[u]});return t},{});l=l.sort(function(t,e){if(z["_".concat(z._discrete,"Sort")])return z["_".concat(z._discrete,"Sort")](t.data,e.data);var n=t[z._discrete],i=e[z._discrete];if(n-i!==0)return n-i;if(t.group!==e.group)return S[e.group]-S[t.group];return e[u]-t[u]});y=Array.from(new Set(l.map(function(t){return t.discrete})));x=Array.from(new Set(l.map(function(t){return t.id})));w=mm().key(function(t){return t.discrete}).entries(l).map(function(t){return t.values});w.forEach(function(r){var o=Array.from(new Set(r.map(function(t){return t.id})));if(o.length<x.length){x.forEach(function(e){if(!o.includes(e)){var t=l.filter(function(t){return t.id===e})[0];if(t.shape==="Area"){var n;var i=s(t.data,t.i);var a=(n={__d3plus__:true,data:t.data,discrete:t.shape==="Bar"?"".concat(r[0][z._discrete],"_").concat(i):"".concat(r[0][z._discrete]),group:i,id:e,shape:t.shape},ae(n,z._discrete,r[0][z._discrete]),ae(n,u,0),n);l.push(a)}}})}});if(this["_".concat(this._discrete,"Sort")]){l.sort(function(t,e){return z["_".concat(z._discrete,"Sort")](t.data,e.data)})}else{l.sort(function(t,e){return t[z._discrete]-e[z._discrete]})}var C=this._stackOrder;if(C instanceof Array)x.sort(function(t,e){return C.indexOf(t)-C.indexOf(e)});else if(C===Dk)x.sort(function(t,e){return t.localeCompare(e)});w=zk().keys(x).offset(this._stackOffset).order(C instanceof Array?Dk:C).value(function(t,e){var n=t.filter(function(t){return t.id===e});return n.length?n[0][u]:0})(w);b=(k={},ae(k,this._discrete,tm(l,function(t){return t[z._discrete]})),ae(k,u,[fm(w.map(function(t){return fm(t.map(function(t){return t[0]}))})),um(w.map(function(t){return um(t.map(function(t){return t[1]}))}))]),k)}else{var A=this._discrete||"x";if(this["_".concat(this._discrete,"Sort")]){l.sort(function(t,e){return z["_".concat(z._discrete,"Sort")](t.data,e.data)})}else{l.sort(function(t,e){return t[A]-e[A]})}var E=A==="x"?l.map(function(t){return t.x}):l.map(function(t){return t.x}).concat(this._confidence&&this._confidence[0]?l.map(function(t){return t.lci}):[]).concat(this._confidence&&this._confidence[1]?l.map(function(t){return t.hci}):[]);var M=A==="x"?l.map(function(t){return t.x2}):l.map(function(t){return t.x2}).concat(this._confidence&&this._confidence[0]?l.map(function(t){return t.lci}):[]).concat(this._confidence&&this._confidence[1]?l.map(function(t){return t.hci}):[]);var R=A==="y"?l.map(function(t){return t.y}):l.map(function(t){return t.y}).concat(this._confidence&&this._confidence[0]?l.map(function(t){return t.lci}):[]).concat(this._confidence&&this._confidence[1]?l.map(function(t){return t.hci}):[]);var T=A==="y"?l.map(function(t){return t.y2}):l.map(function(t){return t.y2}).concat(this._confidence&&this._confidence[0]?l.map(function(t){return t.lci}):[]).concat(this._confidence&&this._confidence[1]?l.map(function(t){return t.hci}):[]);b={x:this._xSort?Array.from(new Set(l.filter(function(t){return t.x}).sort(function(t,e){return z._xSort(t.data,e.data)}).map(function(t){return t.x}))):tm(E,function(t){return t}),x2:this._x2Sort?Array.from(new Set(l.filter(function(t){return t.x2}).sort(function(t,e){return z._x2Sort(t.data,e.data)}).map(function(t){return t.x2}))):tm(M,function(t){return t}),y:this._ySort?Array.from(new Set(l.filter(function(t){return t.y}).sort(function(t,e){return z._ySort(t.data,e.data)}).map(function(t){return t.y}))):tm(R,function(t){return t}),y2:this._y2Sort?Array.from(new Set(l.filter(function(t){return t.y2}).sort(function(t,e){return z._y2Sort(t.data,e.data)}).map(function(t){return t.y2}))):tm(T,function(t){return t})}}var L=this._xDomain?this._xDomain.slice():b.x,j=this._xSort?"Point":"Linear";if(L[0]===void 0)L[0]=b.x[0];if(L[1]===void 0)L[1]=b.x[1];if(g){L=L.map(uM);j="Time"}else if(this._discrete==="x"){if(!this._xDomain)L=Array.from(new Set(l.filter(function(t){return["number","string"].includes(ie(t.x))}).sort(function(t,e){return z._xSort?z._xSort(t.data,e.data):t.x-e.x}).map(function(t){return t.x})));j="Point"}var B=this._x2Domain?this._x2Domain.slice():b.x2,O=this._x2Sort?"Point":"Linear";if(B&&B[0]===void 0)B[0]=b.x2[0];if(B&&B[1]===void 0)B[1]=b.x2[1];if(d){B=B.map(uM);O="Time"}else if(this._discrete==="x"){if(!this._x2Domain)B=Array.from(new Set(l.filter(function(t){return["number","string"].includes(ie(t.x2))}).sort(function(t,e){return z._x2Sort?z._x2Sort(t.data,e.data):t.x2-e.x2}).map(function(t){return t.x2})));O="Point"}var I=this._yDomain?this._yDomain.slice():b.y,H=this._ySort?"Point":"Linear";if(I[0]===void 0)I[0]=b.y[0];if(I[1]===void 0)I[1]=b.y[1];var P=this._y2Domain?this._y2Domain.slice():b.y2,D=this._y2Sort?"Point":"Linear";if(P&&P[0]===void 0)P[0]=b.y2[0];if(P&&P[1]===void 0)P[1]=b.y2[1];if(v){I=I.map(uM);H="Time"}else if(this._discrete==="y"){if(!this._yDomain)I=Array.from(new Set(l.filter(function(t){return["number","string"].includes(ie(t.y))}).sort(function(t,e){return z._ySort?z._ySort(t.data,e.data):t.y-e.y}).map(function(t){return t.y})));H="Point";if(!this._y2Domain)P=Array.from(new Set(l.filter(function(t){return["number","string"].includes(ie(t.y2))}).sort(function(t,e){return z._y2Sort?z._y2Sort(t.data,e.data):t.y2-e.y2}).map(function(t){return t.y2})));D="Point"}if(p){P=P.map(uM);D="Time"}b={x:L,x2:B||L,y:I,y2:P||I};h.forEach(function(t){if(z["_".concat(t,"Config")].domain){var e=z["_".concat(t,"Config")].domain;if(z._discrete==="x")e.reverse();b[t]=e}else if(t&&z._baseline!==void 0){var n=z._baseline;if(b[t]&&b[t][0]>n)b[t][0]=n;else if(b[t]&&b[t][1]<n)b[t][1]=n}});var V=Sw["scale".concat(j)]().domain(b.x).range(em(0,F+1,F/(b.x.length-1))),N=Sw["scale".concat(O)]().domain(b.x2).range(em(0,F+1,F/(b.x2.length-1))),U=Sw["scale".concat(H)]().domain(b.y.reverse()).range(em(0,r+1,r/(b.y.length-1))),G=Sw["scale".concat(D)]().domain(b.y2.reverse()).range(em(0,r+1,r/(b.y2.length-1)));var W=mm().key(function(t){return t.shape}).entries(l).sort(function(t,e){return z._shapeSort(t.key,e.key)});var K=function t(e,n){var i=z["_".concat(e,"Config")].scale;if(i==="auto"){if(z._discrete===e)return n;var a=l.map(function(t){return t[e]});return Qv(a)/hm(a)>3?"log":"linear"}return i||n};var q=K("y",H).toLowerCase();var Y=K("y2",D).toLowerCase();var X=K("x",j).toLowerCase();var Z=K("x2",O).toLowerCase();var J=this._discrete==="x"?H:j;if(J!=="Point"){W.forEach(function(t){if(z._buffer[t.key]){var e=z._buffer[t.key].bind(z)({data:t.values,x:V,y:U,yScale:q,xScale:X,config:z._shapeConfig[t.key]});V=e[0];U=e[1];var n=z._buffer[t.key].bind(z)({data:t.values,x:N,y:G,yScale:Y,xScale:Z,x2:true,y2:true,config:z._shapeConfig[t.key]});N=n[0];G=n[1]}})}L=V.domain();B=N.domain();I=U.domain();P=G.domain();var $={barConfig:{"stroke-width":0},gridSize:0,labels:[],title:false,tickSize:0};var Q=i?{}:$;var tt=a?{}:$;var et=this._discrete==="x"&&this._width>this._discreteCutoff||this._width>this._xCutoff;var nt=this._discrete==="y"&&this._height>this._discreteCutoff||this._height>this._yCutoff;var it={gridConfig:{stroke:!this._discrete||this._discrete==="x"?this._yTest.gridConfig().stroke:"transparent"},locale:this._locale,scalePadding:U.padding?U.padding():0};if(!et){it.barConfig={stroke:"transparent"};it.tickSize=0;it.shapeConfig={labelBounds:function t(e,n){var i=e.labelBounds,a=i.width,r=i.y;var o=z._height/2;var s=n?-o:0;return{x:s,y:r,width:a,height:o}},labelConfig:{padding:0,rotate:0,verticalAlign:function t(e){return e.id===lt[0]?"top":"bottom"}},labelRotation:false}}var at=Wv("g.d3plus-plot-test",{enter:{opacity:0},parent:this._select}),rt=this._discrete==="x"&&!d?b.x2:undefined,ot=!nt?tm(b.x):this._discrete==="x"&&!g?b.x:undefined,st=this._discrete==="y"&&!p?b.y2:undefined,lt=!et?tm(b.y):this._discrete==="y"&&!v?b.y:undefined;if(nt){this._yTest.domain(I).height(r).maxSize(F/2).range([undefined,undefined]).select(at.node()).ticks(lt).width(F).config(it).config(this._yConfig).scale(q).render()}var ut=this._yTest.outerBounds();var ht=ut.width?ut.width+this._yTest.padding():undefined;if(a){this._y2Test.domain(P).height(r).range([undefined,undefined]).select(at.node()).ticks(st).width(F).config(it).config(tt).config(this._y2Config).scale(Y).render()}var ct=this._y2Test.outerBounds();var ft=ct.width?ct.width+this._y2Test.padding():undefined;var dt={gridConfig:{stroke:!this._discrete||this._discrete==="y"?this._xTest.gridConfig().stroke:"transparent"},locale:this._locale,scalePadding:V.padding?V.padding():0};if(!nt){dt.barConfig={stroke:"transparent"};dt.tickSize=0;dt.shapeConfig={labelBounds:function t(e,n){var i=e.labelBounds,a=i.height,r=i.y;var o=z._width/2;var s=n?-o:0;return{x:s,y:r,width:o,height:a}},labelConfig:{padding:0,rotate:0,textAnchor:function t(e){return e.id===ot[0]?"start":"end"}},labelRotation:false}}var gt=undefined;if(this._lineLabels){var pt=mm().key(function(t){return t.id}).entries(l.filter(function(t){return t.shape==="Line"}));if(pt.length&&pt.length<this._dataCutoff){var vt=Bc.bind(this)(this._shapeConfig,"shape","Line");aL.config(vt);var mt=aL.labelConfig();var _t=mt.fontSize!==undefined?mt.fontSize:rL.fontSize();var yt=mt.fontWeight!==undefined?mt.fontWeight:rL.fontWeight();var bt=mt.fontFamily!==undefined?mt.fontFamily:rL.fontFamily();var wt=mt.padding!==undefined?mt.padding:rL.padding();var xt=pt.map(function(t){var e=t.values[0];var n=z._drawLabel(e);var i=typeof _t==="function"?_t(e):_t;var a=typeof yt==="function"?yt(e):yt;var r=typeof bt==="function"?bt(e):bt;if(r instanceof Array)r=r.map(function(t){return"'".concat(t,"'")}).join(", ");var o=typeof wt==="function"?wt(e):wt;var s=MS(n,{"font-size":i,"font-family":r,"font-weight":a});return s+o*2});var kt=um(xt);var St=fm([kt,F/4]);gt=F-St-this._margin.right}}if(et){this._xTest.domain(L).height(r).maxSize(r/2).range([undefined,gt]).select(at.node()).ticks(ot).width(F).config(dt).config(this._xConfig).scale(X).render()}if(i){this._x2Test.domain(B).height(r).range([undefined,gt]).select(at.node()).ticks(rt).width(F).config(dt).tickSize(0).config(Q).config(this._x2Config).scale(Z).render()}var Ct=this._xTest._getRange();var At=this._x2Test._getRange();var Et=this._x2Test.outerBounds();var Mt=i?Et.height+this._x2Test.padding():0;var Rt=um([ht,Ct[0],At[0]]);if(et){this._xTest.range([Rt,undefined]).render()}var Tt=nt?this._yTest.shapeConfig().labelConfig.fontSize()/2:0;var Bt=um([ft,F-Ct[1],F-At[1]]);var Ot=this._xTest.outerBounds();var Pt=Ot.height+(nt?this._xTest.padding():0);this._padding.left+=Rt;this._padding.right+=Bt;this._padding.bottom+=Pt;this._padding.top+=Mt+Tt;oe(re(ne.prototype),"_draw",this).call(this,e);var Dt=this._margin.left+this._margin.right;var Nt=this._margin.top+this._margin.bottom;var zt=[Mt,r-(Pt+Tt+Nt)];if(nt){this._yTest.domain(I).height(r).maxSize(F/2).range(zt).select(at.node()).ticks(lt).width(F).config(it).config(this._yConfig).scale(q).render()}ut=this._yTest.outerBounds();ht=ut.width?ut.width+this._yTest.padding():undefined;Rt=um([ht,Ct[0],At[0]]);if(a){this._y2Test.config(it).domain(P).gridSize(0).height(r).range(zt).select(at.node()).width(F-um([0,Bt-ft])).title(false).config(this._y2Config).config(tt).scale(Y).render()}ct=this._y2Test.outerBounds();ft=ct.width?ct.width+this._y2Test.padding():undefined;Bt=um([0,ft,F-Ct[1],F-At[1]]);var Ft=[Rt,F-(Bt+Dt)];var Lt=Wv("g.d3plus-plot-background",{parent:c,transition:f});var jt="translate(".concat(this._margin.left,", ").concat(this._margin.top+Mt+Tt,")");var It="translate(".concat(this._margin.left,", ").concat(this._margin.top+Tt,")");var Ht=et&&Wv("g.d3plus-plot-x-axis",{parent:c,transition:f,enter:{transform:jt},update:{transform:jt}});var Vt=i&&Wv("g.d3plus-plot-x2-axis",{parent:c,transition:f,enter:{transform:It},update:{transform:It}});var Ut=Rt>ht?Rt-ht:0;var Gt="translate(".concat(this._margin.left+Ut,", ").concat(this._margin.top+Tt,")");var Wt=nt&&Wv("g.d3plus-plot-y-axis",{parent:c,transition:f,enter:{transform:Gt},update:{transform:Gt}});var Kt="translate(-".concat(this._margin.right,", ").concat(this._margin.top+Tt,")");var qt=a&&Wv("g.d3plus-plot-y2-axis",{parent:c,transition:f,enter:{transform:Kt},update:{transform:Kt}});this._xAxis.domain(L).height(r-(Mt+Tt+Nt)).maxSize(r/2).range(Ft).select(et?Ht.node():undefined).ticks(ot).width(F).config(dt).config(this._xConfig).scale(X).render();if(i){this._x2Axis.domain(B).height(r-(Pt+Tt+Nt)).range(Ft).select(Vt.node()).ticks(rt).width(F).config(dt).config(Q).config(this._x2Config).scale(Z).render()}V=function t(e,n){if(n==="x2"){if(z._x2Config.scale==="log"&&e===0)e=B[0]<0?-1:1;return z._x2Axis._getPosition.bind(z._x2Axis)(e)}else{if(z._xConfig.scale==="log"&&e===0)e=L[0]<0?-1:1;return z._xAxis._getPosition.bind(z._xAxis)(e)}};zt=[this._xAxis.outerBounds().y+Mt,r-(Pt+Tt+Nt)];this._yAxis.domain(I).height(r).maxSize(F/2).range(zt).select(nt?Wt.node():undefined).ticks(lt).width(Ft[Ft.length-1]).config(it).config(this._yConfig).scale(q).render();if(a){this._y2Axis.config(it).domain(a?P:I).gridSize(0).height(r).range(zt).select(qt.node()).width(F-um([0,Bt-ft])).title(false).config(this._y2Config).config(tt).scale(Y).render()}U=function t(e,n){if(n==="y2"){if(z._y2Config.scale==="log"&&e===0)e=P[0]<0?-1:1;return z._y2Axis._getPosition.bind(z._y2Axis)(e)-Mt}else{if(z._yConfig.scale==="log"&&e===0)e=I[0]<0?-1:1;return z._yAxis._getPosition.bind(z._yAxis)(e)-Mt}};(new cE).data([{}]).select(Lt.node()).x(Ft[0]+(Ft[1]-Ft[0])/2).width(Ft[1]-Ft[0]).y(this._margin.top+Tt+zt[0]+(zt[1]-zt[0])/2).height(zt[1]-zt[0]).config(this._backgroundConfig).render();var Yt=Wv("g.d3plus-plot-annotations",{parent:c,transition:f,enter:{transform:jt},update:{transform:jt}}).node();this._annotations.forEach(function(t){(new lM[t.shape]).config(t).config({x:function t(e){return e.x2?V(e.x2,"x2"):V(e.x)},x0:z._discrete==="x"?function(t){return t.x2?V(t.x2,"x2"):V(t.x)}:V(b.x[0]),x1:z._discrete==="x"?null:function(t){return t.x2?V(t.x2,"x2"):V(t.x)},y:function t(e){return e.y2?U(e.y2,"y2"):U(e.y)},y0:z._discrete==="y"?function(t){return t.y2?U(t.y2,"y2"):U(t.y)}:U(b.y[1])-Xt,y1:z._discrete==="y"?null:function(t){return t.y2?U(t.y2,"y2"):U(t.y)-Xt}}).select(Yt).render()});var Xt=this._xAxis.barConfig()["stroke-width"];if(Xt)Xt/=2;var Zt=this._discrete||"x";var Jt={duration:this._duration,label:function t(e){return z._drawLabel(e.data,e.i)},select:Wv("g.d3plus-plot-shapes",{parent:c,transition:f,enter:{transform:jt},update:{transform:jt}}).node(),x:function t(e){return e.x2!==undefined?V(e.x2,"x2"):V(e.x)},x0:Zt==="x"?function(t){return t.x2?V(t.x2,"x2"):V(t.x)}:V(typeof this._baseline==="number"?this._baseline:b.x[0]),x1:Zt==="x"?null:function(t){return t.x2?V(t.x2,"x2"):V(t.x)},y:function t(e){return e.y2!==undefined?U(e.y2,"y2"):U(e.y)},y0:Zt==="y"?function(t){return t.y2?U(t.y2,"y2"):U(t.y)}:U(typeof this._baseline==="number"?this._baseline:b.y[1])-Xt,y1:Zt==="y"?null:function(t){return t.y2?U(t.y2,"y2"):U(t.y)-Xt}};if(this._stacked){var $t=u==="x"?V:U;Jt["".concat(u)]=Jt["".concat(u,"0")]=function(t){var e=x.indexOf(t.id),n=y.indexOf(t.discrete);return e>=0?$t(w[e][n][0]):$t(b[u][u==="x"?0:1])};Jt["".concat(u,"1")]=function(t){var e=x.indexOf(t.id),n=y.indexOf(t.discrete);return e>=0?$t(w[e][n][1]):$t(b[u][u==="x"?0:1])}}var Qt=Object.keys(this._on);W.forEach(function(e){var n=(new lM[e.key]).config(Jt).data(e.values);if(e.key==="Bar"){var t;var i=z._discrete==="x"?V:U;var a=z._discrete==="x"?j:H;var r=z._discrete==="x"?L:I;var o=z._discrete==="x"?Ft:zt;if(a!=="Point"&&r.length===2){t=(i(e.values[z._discrete==="x"?0:e.values.length-1][z._discrete])-i(r[0]))*2}else if(r.length>1)t=i(r[1])-i(r[0]);else t=o[o.length-1]-o[0];if(z._groupPadding<t)t-=z._groupPadding;var s=t||1;var l=mm().key(function(t){return t[z._discrete]}).key(function(t){return t.group}).entries(e.values);var u=cm(l.map(function(t){return t.values.map(function(t){return t.key})}));var h=Array.from(new Set(u));if(um(l.map(function(t){return t.values.length}))===1){n[z._discrete](function(t,e){return Jt[z._discrete](t,e)})}else{s=(s-z._barPadding*h.length-1)/h.length;var c=t/2-s/2;var f=k_().domain([0,h.length-1]).range([-c,c]);n[z._discrete](function(t,e){return Jt[z._discrete](t,e)+f(h.indexOf(t.group))})}n.width(s);n.height(s)}else if(e.key==="Line"){n.duration(F*1.5);if(z._confidence){var d=Object.assign({},Jt);var g=z._discrete||"x";var p=g==="x"?"y":"x";var v=g==="x"?U:V;d["".concat(p,"0")]=function(t){return v(z._confidence[0]?t.lci:t[p])};d["".concat(p,"1")]=function(t){return v(z._confidence[1]?t.hci:t[p])};var m=(new RA).config(d).data(e.values);var _=Object.assign(z._shapeConfig,z._confidenceConfig);m.config(Bc.bind(z)(_,"shape","Area")).render();z._shapes.push(m)}n.config({label:z._lineLabels?z._drawLabel:false,labelBounds:z._lineLabels?function(t,e,n){var i=se(n.points[0],2),a=i[0],r=i[1];var o=se(n.points[n.points.length-1],2),s=o[0],l=o[1];var u=z._height/4;return{x:s-a,y:l-r-u/2,width:z._padding.right,height:u}}:false})}var y=Qt.filter(function(t){return t.includes(".".concat(e.key))}),b=Qt.filter(function(t){return!t.includes(".")}),w=Qt.filter(function(t){return t.includes(".shape")});var x=function t(e){n.on(b[e],function(t){return z._on[b[e]](t.data,t.i)})};for(var k=0;k<b.length;k++){x(k)}var S=function t(e){n.on(w[e],function(t){return z._on[w[e]](t.data,t.i)})};for(var C=0;C<w.length;C++){S(C)}var A=function t(e){n.on(y[e],function(t){return z._on[y[e]](t.data,t.i)})};for(var E=0;E<y.length;E++){A(E)}var M=Bc.bind(z)(z._shapeConfig,"shape",e.key);if(z._shapeConfig.duration===undefined)delete M.duration;n.config(M).render();z._shapes.push(n);if(e.key==="Line"&&z._lineMarkers){var R=(new QA).data(e.values).config(Jt).config(z._lineMarkerConfig).id(function(t){return"".concat(t.id,"_").concat(t.discrete)});var T=function t(e){R.on(b[e],function(t){return z._on[b[e]](t.data,t.i)})};for(var B=0;B<b.length;B++){T(B)}var O=function t(e){R.on(w[e],function(t){return z._on[w[e]](t.data,t.i)})};for(var P=0;P<w.length;P++){O(P)}var D=function t(e){R.on(y[e],function(t){return z._on[y[e]](t.data,t.i)})};for(var N=0;N<y.length;N++){D(N)}R.render();z._shapes.push(R)}});var te=W.map(function(t){return t.key});if(te.includes("Line")){if(this._confidence)te.push("Area");if(this._labelMarkers)te.push("Circle")}var ee=this._previousShapes.filter(function(t){return!te.includes(t)});ee.forEach(function(t){(new lM[t]).config(Jt).data([]).render()});this._previousShapes=te;return this}},{key:"annotations",value:function t(e){return arguments.length?(this._annotations=e instanceof Array?e:[e],this):this._annotations}},{key:"backgroundConfig",value:function t(e){return arguments.length?(this._backgroundConfig=gt(this._backgroundConfig,e),this):this._backgroundConfig}},{key:"barPadding",value:function t(e){return arguments.length?(this._barPadding=e,this):this._barPadding}},{key:"baseline",value:function t(e){return arguments.length?(this._baseline=e,this):this._baseline}},{key:"confidence",value:function t(e){if(arguments.length&&e instanceof Array){this._confidence=[];var n=e[0];this._confidence[0]=typeof n==="function"||!n?n:g(n);var i=e[1];this._confidence[1]=typeof i==="function"||!i?i:g(i);return this}else return this._confidence}},{key:"confidenceConfig",value:function t(e){return arguments.length?(this._confidenceConfig=gt(this._confidenceConfig,e),this):this._confidenceConfig}},{key:"discrete",value:function t(e){return arguments.length?(this._discrete=e,this):this._discrete}},{key:"discreteCutoff",value:function t(e){return arguments.length?(this._discreteCutoff=e,this):this._discreteCutoff}},{key:"groupPadding",value:function t(e){return arguments.length?(this._groupPadding=e,this):this._groupPadding}},{key:"lineLabels",value:function t(e){return arguments.length?(this._lineLabels=e,this):this._lineLabels}},{key:"lineMarkerConfig",value:function t(e){return arguments.length?(this._lineMarkerConfig=gt(this._lineMarkerConfig,e),this):this._lineMarkerConfig}},{key:"lineMarkers",value:function t(e){return arguments.length?(this._lineMarkers=e,this):this._lineMarkers}},{key:"shapeSort",value:function t(e){return arguments.length?(this._shapeSort=e,this):this._shapeSort}},{key:"size",value:function t(e){return arguments.length?(this._size=typeof e==="function"||!e?e:g(e),this):this._size}},{key:"sizeMax",value:function t(e){return arguments.length?(this._sizeMax=e,this):this._sizeMax}},{key:"sizeMin",value:function t(e){return arguments.length?(this._sizeMin=e,this):this._sizeMin}},{key:"sizeScale",value:function t(e){return arguments.length?(this._sizeScale=e,this):this._sizeScale}},{key:"stacked",value:function t(e){return arguments.length?(this._stacked=e,this):this._stacked}},{key:"stackOffset",value:function t(e){return arguments.length?(this._stackOffset=typeof e==="function"?e:Yk["stackOffset".concat(e.charAt(0).toUpperCase()+e.slice(1))],this):this._stackOffset}},{key:"stackOrder",value:function t(e){if(arguments.length){if(typeof e==="string")this._stackOrder=e==="ascending"?sL:e==="descending"?lL:Yk["stackOrder".concat(e.charAt(0).toUpperCase()+e.slice(1))];else this._stackOrder=e;return this}else return this._stackOrder}},{key:"x",value:function t(e){if(arguments.length){if(typeof e==="function")this._x=e;else{this._x=g(e);if(!this._aggs[e]&&this._discrete==="x"){this._aggs[e]=function(t){var e=Array.from(new Set(t));return e.length===1?e[0]:e}}}return this}else return this._x}},{key:"x2",value:function t(e){if(arguments.length){if(typeof e==="function")this._x2=e;else{this._x2=g(e);if(!this._aggs[e]&&this._discrete==="x"){this._aggs[e]=function(t){var e=Array.from(new Set(t));return e.length===1?e[0]:e}}}return this}else return this._x2}},{key:"xConfig",value:function t(e){return arguments.length?(this._xConfig=gt(this._xConfig,e),this):this._xConfig}},{key:"xCutoff",value:function t(e){return arguments.length?(this._xCutoff=e,this):this._xCutoff}},{key:"x2Config",value:function t(e){return arguments.length?(this._x2Config=gt(this._x2Config,e),this):this._x2Config}},{key:"xDomain",value:function t(e){return arguments.length?(this._xDomain=e,this):this._xDomain}},{key:"x2Domain",value:function t(e){return arguments.length?(this._x2Domain=e,this):this._x2Domain}},{key:"xSort",value:function t(e){return arguments.length?(this._xSort=e,this):this._xSort}},{key:"x2Sort",value:function t(e){return arguments.length?(this._x2Sort=e,this):this._x2Sort}},{key:"y",value:function t(e){if(arguments.length){if(typeof e==="function")this._y=e;else{this._y=g(e);if(!this._aggs[e]&&this._discrete==="y"){this._aggs[e]=function(t){var e=Array.from(new Set(t));return e.length===1?e[0]:e}}}return this}else return this._y}},{key:"y2",value:function t(e){if(arguments.length){if(typeof e==="function")this._y2=e;else{this._y2=g(e);if(!this._aggs[e]&&this._discrete==="y2"){this._aggs[e]=function(t){var e=Array.from(new Set(t));return e.length===1?e[0]:e}}}return this}else return this._y2}},{key:"yConfig",value:function t(e){if(arguments.length){if(e.domain)e.domain=e.domain.slice().reverse();this._yConfig=gt(this._yConfig,e);return this}return this._yConfig}},{key:"yCutoff",value:function t(e){return arguments.length?(this._yCutoff=e,this):this._yCutoff}},{key:"y2Config",value:function t(e){if(arguments.length){if(e.domain)e.domain=e.domain.slice().reverse();this._y2Config=gt(this._y2Config,e);return this}return this._y2Config}},{key:"yDomain",value:function t(e){return arguments.length?(this._yDomain=e,this):this._yDomain}},{key:"y2Domain",value:function t(e){return arguments.length?(this._y2Domain=e,this):this._y2Domain}},{key:"ySort",value:function t(e){return arguments.length?(this._ySort=e,this):this._ySort}},{key:"y2Sort",value:function t(e){return arguments.length?(this._y2Sort=e,this):this._y2Sort}}]);return ne}(ZF);var fL=function(t){o(e,t);function e(){var t;n(this,e);t=u(this,re(e).call(this));t._baseline=0;t._discrete="x";t._shape=Oc("Area");t.x("x");return t}return e}(cL);var dL=function(t){o(e,t);function e(){var t;n(this,e);t=u(this,re(e).call(this));t._baseline=0;t._discrete="x";t._shape=Oc("Bar");t.x("x");return t}return e}(cL);var gL=function(t){o(e,t);function e(){var a;n(this,e);a=u(this,re(e).call(this));a._discrete="x";a._shape=Oc("Box");a.x("x");a._tooltipConfig=gt(a._tooltipConfig,{title:function t(e,n){if(!e)return"";while(e.__d3plus__&&e.data){e=e.data;n=e.i}if(a._label)return a._label(e,n);var i=a._ids(e,n).slice(0,a._drawDepth);return i[i.length-1]}});return a}return e}(cL);var pL=function(t){o(e,t);function e(){var o;n(this,e);o=u(this,re(e).call(this));o._discrete="x";o._shape=Oc("Line");o.x("x");o.y2(function(t){return o._y(t)});o.yConfig({tickFormat:function t(e){var n=o._formattedData;var i=n[0].x instanceof Date?n[0].x.getTime():n[0].x;var a=n.filter(function(t){return(t.x instanceof Date?t.x.getTime():t.x)===i});var r=a.find(function(t){return t.y===e});return r?o._drawLabel(r,r.i):""}});o.y2Config({tickFormat:function t(e){var n=o._formattedData;var i=n[n.length-1].x instanceof Date?n[n.length-1].x.getTime():n[n.length-1].x;var a=n.filter(function(t){return(t.x instanceof Date?t.x.getTime():t.x)===i});var r=a.find(function(t){return t.y===e});return r?o._drawLabel(r,r.i):""}});o.ySort(function(t,e){return o._y(e)-o._y(t)});o.y2Sort(function(t,e){return o._y(e)-o._y(t)});return o}return e}(cL);var vL=function(t){o(e,t);function e(){var t;n(this,e);t=u(this,re(e).call(this));t._discrete="x";t._shape=Oc("Line");t.x("x");return t}return e}(cL);var mL=Math.PI*2;var _L=function(t){o(y,t);function y(){var t;n(this,y);t=u(this,re(y).call(this));t._axisConfig={shapeConfig:{fill:Oc("none"),labelConfig:{fontColor:"#000",padding:0,textAnchor:function t(e,n,i){return i.textAnchor},verticalAlign:"middle"},stroke:"#ccc",strokeWidth:Oc(1)}};t._discrete="metric";t._levels=6;t._metric=g("metric");t._outerPadding=100;t._shape=Oc("Path");t._value=g("value");return t}e(y,[{key:"_draw",value:function t(e){var d=this;oe(re(y.prototype),"_draw",this).call(this,e);var u=this._height-this._margin.top-this._margin.bottom,h=this._width-this._margin.left-this._margin.right;var g=fm([u,h])/2-this._outerPadding,n="translate(".concat(h/2,", ").concat(u/2,")");var i=mm().key(this._metric).entries(this._filteredData),a=mm().key(this._id).key(this._metric).entries(this._filteredData);var r=um(a.map(function(t){return t.values.map(function(t){return dm(t.values,function(t,e){return d._value(t,e)})})}).flat());var o=Array.from(Array(this._levels).keys()).map(function(t){return{id:t,r:g*((t+1)/d._levels)}});var s=Bc.bind(this)(this._axisConfig.shapeConfig,"shape","Circle");delete s.label;(new QA).data(o).select(Wv("g.d3plus-Radar-radial-circles",{parent:this._select,enter:{transform:n},update:{transform:n}}).node()).config(s).render();var p=i.length;var l=i.map(function(t,e){var n=d._outerPadding;var i=d._shapeConfig.labelConfig.fontSize&&d._shapeConfig.labelConfig.fontSize(t,e)||11;var a=i*1.4;var r=a*2;var o=10,s=parseInt(360-360/p*e/90,10)%4+1,l=mL/p*e;var u=360/p*e;var h="start";var c=o;if(s===2||s===3){c=-n-o;h="end";u+=180}var f={x:c,y:-r/2,width:n,height:r};return{__d3plus__:true,data:Em(t.values),i:e,id:t.key,angle:u,textAnchor:h,labelBounds:f,rotateAnchor:[-c,r/2],x:g*Math.cos(l),y:g*Math.sin(l)}}).sort(function(t,e){return t.key-e.key});(new cE).data(l).rotate(function(t){return t.angle||0}).width(0).height(0).x(function(t){return t.x}).y(function(t){return t.y}).label(function(t){return t.id}).labelBounds(function(t){return t.labelBounds}).labelConfig(this._axisConfig.shapeConfig.labelConfig).select(Wv("g.d3plus-Radar-text",{parent:this._select,enter:{transform:n},update:{transform:n}}).node()).render();(new sM).data(l).d(function(t){return"M".concat(0,",",0," ",-t.x,",").concat(-t.y)}).select(Wv("g.d3plus-Radar-axis",{parent:this._select,enter:{transform:n},update:{transform:n}}).node()).config(Bc.bind(this)(this._axisConfig.shapeConfig,"shape","Path")).render();var c=a.map(function(t){var e=t.values.map(function(t,e){var n=dm(t.values,function(t,e){return d._value(t,e)});var i=n/r*g,a=mL/p*e;return{x:i*Math.cos(a),y:i*Math.sin(a)}});var n="M ".concat(e[0].x," ").concat(e[0].y," ").concat(e.map(function(t){return"L ".concat(t.x," ").concat(t.y)}).join(" ")," L ").concat(e[0].x," ").concat(e[0].y);return{arr:t.values.map(function(t){return Em(t.values)}),id:t.key,points:e,d:n,__d3plus__:true,data:Em(t.values.map(function(t){return Em(t.values)}))}});var f=Bc.bind(this)(this._shapeConfig,"shape","Path");var v=Object.keys(f.on);f.on={};var m=function t(e){var l=v[e];f.on[l]=function(t,e){var n=t.points.map(function(t){return t.x+h/2});var i=t.points.map(function(t){return t.y+u/2});var a=Ed(d._select.node());var r=n.map(function(t){return Math.abs(t-a[0])});var o=i.map(function(t){return Math.abs(t-a[1])});var s=r.map(function(t,e){return t+o[e]});d._on[l].bind(d)(t.arr[s.indexOf(fm(s))],e)}};for(var _=0;_<v.length;_++){m(_)}this._shapes.push((new sM).data(c).d(function(t){return t.d}).select(Wv("g.d3plus-Radar-items",{parent:this._select,enter:{transform:n},update:{transform:n}}).node()).config(f).render());return this}},{key:"axisConfig",value:function t(e){return arguments.length?(this._axisConfig=gt(this._axisConfig,e),this):this._axisConfig}},{key:"metric",value:function t(e){return arguments.length?(this._metric=typeof e==="function"?e:g(e),this):this._metric}},{key:"outerPadding",value:function t(e){return arguments.length?(this._outerPadding=e,this):this._outerPadding}},{key:"value",value:function t(e){return arguments.length?(this._value=typeof e==="function"?e:g(e),this):this._value}}]);return y}(ZF);var yL=function(t){o(e,t);function e(){var t;n(this,e);t=u(this,re(e).call(this));t._stacked=true;return t}return e}(fL);t.AreaPlot=fL;t.BarChart=dL;t.BoxWhisker=gL;t.BumpChart=pL;t.LinePlot=vL;t.Plot=cL;t.Radar=_L;t.StackedArea=yL;Object.defineProperty(t,"__esModule",{value:true})});
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./src/app/d3plus.js":
/*!***************************!*\
  !*** ./src/app/d3plus.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*
  d3plus v2.0.0-alpha.24
  Data visualization made easy. A javascript library that extends the popular D3.js to enable fast and beautiful visualizations.
  Copyright (c) 2019 D3plus - https://d3plus.org
  @license MIT
*/

(function (factory) {
	 true ? !(__WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :
				__WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) :
	undefined;
}((function () { 'use strict';

	var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

	function createCommonjsModule(fn, module) {
		return module = { exports: {} }, fn(module, module.exports), module.exports;
	}

	var check = function (it) {
	  return it && it.Math == Math && it;
	};

	// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
	var global_1 =
	  // eslint-disable-next-line no-undef
	  check(typeof globalThis == 'object' && globalThis) ||
	  check(typeof window == 'object' && window) ||
	  check(typeof self == 'object' && self) ||
	  check(typeof commonjsGlobal == 'object' && commonjsGlobal) ||
	  // eslint-disable-next-line no-new-func
	  Function('return this')();

	var fails = function (exec) {
	  try {
	    return !!exec();
	  } catch (error) {
	    return true;
	  }
	};

	// Thank's IE8 for his funny defineProperty
	var descriptors = !fails(function () {
	  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;
	});

	var nativePropertyIsEnumerable = {}.propertyIsEnumerable;
	var getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;

	// Nashorn ~ JDK8 bug
	var NASHORN_BUG = getOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);

	// `Object.prototype.propertyIsEnumerable` method implementation
	// https://tc39.github.io/ecma262/#sec-object.prototype.propertyisenumerable
	var f = NASHORN_BUG ? function propertyIsEnumerable(V) {
	  var descriptor = getOwnPropertyDescriptor(this, V);
	  return !!descriptor && descriptor.enumerable;
	} : nativePropertyIsEnumerable;

	var objectPropertyIsEnumerable = {
		f: f
	};

	var createPropertyDescriptor = function (bitmap, value) {
	  return {
	    enumerable: !(bitmap & 1),
	    configurable: !(bitmap & 2),
	    writable: !(bitmap & 4),
	    value: value
	  };
	};

	var toString = {}.toString;

	var classofRaw = function (it) {
	  return toString.call(it).slice(8, -1);
	};

	var split = ''.split;

	// fallback for non-array-like ES3 and non-enumerable old V8 strings
	var indexedObject = fails(function () {
	  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346
	  // eslint-disable-next-line no-prototype-builtins
	  return !Object('z').propertyIsEnumerable(0);
	}) ? function (it) {
	  return classofRaw(it) == 'String' ? split.call(it, '') : Object(it);
	} : Object;

	// `RequireObjectCoercible` abstract operation
	// https://tc39.github.io/ecma262/#sec-requireobjectcoercible
	var requireObjectCoercible = function (it) {
	  if (it == undefined) throw TypeError("Can't call method on " + it);
	  return it;
	};

	// toObject with fallback for non-array-like ES3 strings



	var toIndexedObject = function (it) {
	  return indexedObject(requireObjectCoercible(it));
	};

	var isObject = function (it) {
	  return typeof it === 'object' ? it !== null : typeof it === 'function';
	};

	// `ToPrimitive` abstract operation
	// https://tc39.github.io/ecma262/#sec-toprimitive
	// instead of the ES6 spec version, we didn't implement @@toPrimitive case
	// and the second argument - flag - preferred type is a string
	var toPrimitive = function (input, PREFERRED_STRING) {
	  if (!isObject(input)) return input;
	  var fn, val;
	  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;
	  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;
	  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;
	  throw TypeError("Can't convert object to primitive value");
	};

	var hasOwnProperty = {}.hasOwnProperty;

	var has = function (it, key) {
	  return hasOwnProperty.call(it, key);
	};

	var document = global_1.document;
	// typeof document.createElement is 'object' in old IE
	var EXISTS = isObject(document) && isObject(document.createElement);

	var documentCreateElement = function (it) {
	  return EXISTS ? document.createElement(it) : {};
	};

	// Thank's IE8 for his funny defineProperty
	var ie8DomDefine = !descriptors && !fails(function () {
	  return Object.defineProperty(documentCreateElement('div'), 'a', {
	    get: function () { return 7; }
	  }).a != 7;
	});

	var nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;

	// `Object.getOwnPropertyDescriptor` method
	// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor
	var f$1 = descriptors ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {
	  O = toIndexedObject(O);
	  P = toPrimitive(P, true);
	  if (ie8DomDefine) try {
	    return nativeGetOwnPropertyDescriptor(O, P);
	  } catch (error) { /* empty */ }
	  if (has(O, P)) return createPropertyDescriptor(!objectPropertyIsEnumerable.f.call(O, P), O[P]);
	};

	var objectGetOwnPropertyDescriptor = {
		f: f$1
	};

	var anObject = function (it) {
	  if (!isObject(it)) {
	    throw TypeError(String(it) + ' is not an object');
	  } return it;
	};

	var nativeDefineProperty = Object.defineProperty;

	// `Object.defineProperty` method
	// https://tc39.github.io/ecma262/#sec-object.defineproperty
	var f$2 = descriptors ? nativeDefineProperty : function defineProperty(O, P, Attributes) {
	  anObject(O);
	  P = toPrimitive(P, true);
	  anObject(Attributes);
	  if (ie8DomDefine) try {
	    return nativeDefineProperty(O, P, Attributes);
	  } catch (error) { /* empty */ }
	  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');
	  if ('value' in Attributes) O[P] = Attributes.value;
	  return O;
	};

	var objectDefineProperty = {
		f: f$2
	};

	var createNonEnumerableProperty = descriptors ? function (object, key, value) {
	  return objectDefineProperty.f(object, key, createPropertyDescriptor(1, value));
	} : function (object, key, value) {
	  object[key] = value;
	  return object;
	};

	var setGlobal = function (key, value) {
	  try {
	    createNonEnumerableProperty(global_1, key, value);
	  } catch (error) {
	    global_1[key] = value;
	  } return value;
	};

	var SHARED = '__core-js_shared__';
	var store = global_1[SHARED] || setGlobal(SHARED, {});

	var sharedStore = store;

	var shared = createCommonjsModule(function (module) {
	(module.exports = function (key, value) {
	  return sharedStore[key] || (sharedStore[key] = value !== undefined ? value : {});
	})('versions', []).push({
	  version: '3.4.1',
	  mode:  'global',
	  copyright: ' 2019 Denis Pushkarev (zloirock.ru)'
	});
	});

	var functionToString = shared('native-function-to-string', Function.toString);

	var WeakMap = global_1.WeakMap;

	var nativeWeakMap = typeof WeakMap === 'function' && /native code/.test(functionToString.call(WeakMap));

	var id = 0;
	var postfix = Math.random();

	var uid = function (key) {
	  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);
	};

	var keys = shared('keys');

	var sharedKey = function (key) {
	  return keys[key] || (keys[key] = uid(key));
	};

	var hiddenKeys = {};

	var WeakMap$1 = global_1.WeakMap;
	var set, get, has$1;

	var enforce = function (it) {
	  return has$1(it) ? get(it) : set(it, {});
	};

	var getterFor = function (TYPE) {
	  return function (it) {
	    var state;
	    if (!isObject(it) || (state = get(it)).type !== TYPE) {
	      throw TypeError('Incompatible receiver, ' + TYPE + ' required');
	    } return state;
	  };
	};

	if (nativeWeakMap) {
	  var store$1 = new WeakMap$1();
	  var wmget = store$1.get;
	  var wmhas = store$1.has;
	  var wmset = store$1.set;
	  set = function (it, metadata) {
	    wmset.call(store$1, it, metadata);
	    return metadata;
	  };
	  get = function (it) {
	    return wmget.call(store$1, it) || {};
	  };
	  has$1 = function (it) {
	    return wmhas.call(store$1, it);
	  };
	} else {
	  var STATE = sharedKey('state');
	  hiddenKeys[STATE] = true;
	  set = function (it, metadata) {
	    createNonEnumerableProperty(it, STATE, metadata);
	    return metadata;
	  };
	  get = function (it) {
	    return has(it, STATE) ? it[STATE] : {};
	  };
	  has$1 = function (it) {
	    return has(it, STATE);
	  };
	}

	var internalState = {
	  set: set,
	  get: get,
	  has: has$1,
	  enforce: enforce,
	  getterFor: getterFor
	};

	var redefine = createCommonjsModule(function (module) {
	var getInternalState = internalState.get;
	var enforceInternalState = internalState.enforce;
	var TEMPLATE = String(functionToString).split('toString');

	shared('inspectSource', function (it) {
	  return functionToString.call(it);
	});

	(module.exports = function (O, key, value, options) {
	  var unsafe = options ? !!options.unsafe : false;
	  var simple = options ? !!options.enumerable : false;
	  var noTargetGet = options ? !!options.noTargetGet : false;
	  if (typeof value == 'function') {
	    if (typeof key == 'string' && !has(value, 'name')) createNonEnumerableProperty(value, 'name', key);
	    enforceInternalState(value).source = TEMPLATE.join(typeof key == 'string' ? key : '');
	  }
	  if (O === global_1) {
	    if (simple) O[key] = value;
	    else setGlobal(key, value);
	    return;
	  } else if (!unsafe) {
	    delete O[key];
	  } else if (!noTargetGet && O[key]) {
	    simple = true;
	  }
	  if (simple) O[key] = value;
	  else createNonEnumerableProperty(O, key, value);
	// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative
	})(Function.prototype, 'toString', function toString() {
	  return typeof this == 'function' && getInternalState(this).source || functionToString.call(this);
	});
	});

	var path = global_1;

	var aFunction = function (variable) {
	  return typeof variable == 'function' ? variable : undefined;
	};

	var getBuiltIn = function (namespace, method) {
	  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global_1[namespace])
	    : path[namespace] && path[namespace][method] || global_1[namespace] && global_1[namespace][method];
	};

	var ceil = Math.ceil;
	var floor = Math.floor;

	// `ToInteger` abstract operation
	// https://tc39.github.io/ecma262/#sec-tointeger
	var toInteger = function (argument) {
	  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);
	};

	var min = Math.min;

	// `ToLength` abstract operation
	// https://tc39.github.io/ecma262/#sec-tolength
	var toLength = function (argument) {
	  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991
	};

	var max = Math.max;
	var min$1 = Math.min;

	// Helper for a popular repeating case of the spec:
	// Let integer be ? ToInteger(index).
	// If integer < 0, let result be max((length + integer), 0); else let result be min(length, length).
	var toAbsoluteIndex = function (index, length) {
	  var integer = toInteger(index);
	  return integer < 0 ? max(integer + length, 0) : min$1(integer, length);
	};

	// `Array.prototype.{ indexOf, includes }` methods implementation
	var createMethod = function (IS_INCLUDES) {
	  return function ($this, el, fromIndex) {
	    var O = toIndexedObject($this);
	    var length = toLength(O.length);
	    var index = toAbsoluteIndex(fromIndex, length);
	    var value;
	    // Array#includes uses SameValueZero equality algorithm
	    // eslint-disable-next-line no-self-compare
	    if (IS_INCLUDES && el != el) while (length > index) {
	      value = O[index++];
	      // eslint-disable-next-line no-self-compare
	      if (value != value) return true;
	    // Array#indexOf ignores holes, Array#includes - not
	    } else for (;length > index; index++) {
	      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;
	    } return !IS_INCLUDES && -1;
	  };
	};

	var arrayIncludes = {
	  // `Array.prototype.includes` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.includes
	  includes: createMethod(true),
	  // `Array.prototype.indexOf` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.indexof
	  indexOf: createMethod(false)
	};

	var indexOf = arrayIncludes.indexOf;


	var objectKeysInternal = function (object, names) {
	  var O = toIndexedObject(object);
	  var i = 0;
	  var result = [];
	  var key;
	  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);
	  // Don't enum bug & hidden keys
	  while (names.length > i) if (has(O, key = names[i++])) {
	    ~indexOf(result, key) || result.push(key);
	  }
	  return result;
	};

	// IE8- don't enum bug keys
	var enumBugKeys = [
	  'constructor',
	  'hasOwnProperty',
	  'isPrototypeOf',
	  'propertyIsEnumerable',
	  'toLocaleString',
	  'toString',
	  'valueOf'
	];

	var hiddenKeys$1 = enumBugKeys.concat('length', 'prototype');

	// `Object.getOwnPropertyNames` method
	// https://tc39.github.io/ecma262/#sec-object.getownpropertynames
	var f$3 = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
	  return objectKeysInternal(O, hiddenKeys$1);
	};

	var objectGetOwnPropertyNames = {
		f: f$3
	};

	var f$4 = Object.getOwnPropertySymbols;

	var objectGetOwnPropertySymbols = {
		f: f$4
	};

	// all object keys, includes non-enumerable and symbols
	var ownKeys = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {
	  var keys = objectGetOwnPropertyNames.f(anObject(it));
	  var getOwnPropertySymbols = objectGetOwnPropertySymbols.f;
	  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;
	};

	var copyConstructorProperties = function (target, source) {
	  var keys = ownKeys(source);
	  var defineProperty = objectDefineProperty.f;
	  var getOwnPropertyDescriptor = objectGetOwnPropertyDescriptor.f;
	  for (var i = 0; i < keys.length; i++) {
	    var key = keys[i];
	    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));
	  }
	};

	var replacement = /#|\.prototype\./;

	var isForced = function (feature, detection) {
	  var value = data[normalize(feature)];
	  return value == POLYFILL ? true
	    : value == NATIVE ? false
	    : typeof detection == 'function' ? fails(detection)
	    : !!detection;
	};

	var normalize = isForced.normalize = function (string) {
	  return String(string).replace(replacement, '.').toLowerCase();
	};

	var data = isForced.data = {};
	var NATIVE = isForced.NATIVE = 'N';
	var POLYFILL = isForced.POLYFILL = 'P';

	var isForced_1 = isForced;

	var getOwnPropertyDescriptor$1 = objectGetOwnPropertyDescriptor.f;






	/*
	  options.target      - name of the target object
	  options.global      - target is the global object
	  options.stat        - export as static methods of target
	  options.proto       - export as prototype methods of target
	  options.real        - real prototype method for the `pure` version
	  options.forced      - export even if the native feature is available
	  options.bind        - bind methods to the target, required for the `pure` version
	  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version
	  options.unsafe      - use the simple assignment of property instead of delete + defineProperty
	  options.sham        - add a flag to not completely full polyfills
	  options.enumerable  - export as enumerable property
	  options.noTargetGet - prevent calling a getter on target
	*/
	var _export = function (options, source) {
	  var TARGET = options.target;
	  var GLOBAL = options.global;
	  var STATIC = options.stat;
	  var FORCED, target, key, targetProperty, sourceProperty, descriptor;
	  if (GLOBAL) {
	    target = global_1;
	  } else if (STATIC) {
	    target = global_1[TARGET] || setGlobal(TARGET, {});
	  } else {
	    target = (global_1[TARGET] || {}).prototype;
	  }
	  if (target) for (key in source) {
	    sourceProperty = source[key];
	    if (options.noTargetGet) {
	      descriptor = getOwnPropertyDescriptor$1(target, key);
	      targetProperty = descriptor && descriptor.value;
	    } else targetProperty = target[key];
	    FORCED = isForced_1(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);
	    // contained in target
	    if (!FORCED && targetProperty !== undefined) {
	      if (typeof sourceProperty === typeof targetProperty) continue;
	      copyConstructorProperties(sourceProperty, targetProperty);
	    }
	    // add a flag to not completely full polyfills
	    if (options.sham || (targetProperty && targetProperty.sham)) {
	      createNonEnumerableProperty(sourceProperty, 'sham', true);
	    }
	    // extend global
	    redefine(target, key, sourceProperty, options);
	  }
	};

	var aFunction$1 = function (it) {
	  if (typeof it != 'function') {
	    throw TypeError(String(it) + ' is not a function');
	  } return it;
	};

	// optional / simple context binding
	var bindContext = function (fn, that, length) {
	  aFunction$1(fn);
	  if (that === undefined) return fn;
	  switch (length) {
	    case 0: return function () {
	      return fn.call(that);
	    };
	    case 1: return function (a) {
	      return fn.call(that, a);
	    };
	    case 2: return function (a, b) {
	      return fn.call(that, a, b);
	    };
	    case 3: return function (a, b, c) {
	      return fn.call(that, a, b, c);
	    };
	  }
	  return function (/* ...args */) {
	    return fn.apply(that, arguments);
	  };
	};

	// `ToObject` abstract operation
	// https://tc39.github.io/ecma262/#sec-toobject
	var toObject = function (argument) {
	  return Object(requireObjectCoercible(argument));
	};

	// `IsArray` abstract operation
	// https://tc39.github.io/ecma262/#sec-isarray
	var isArray = Array.isArray || function isArray(arg) {
	  return classofRaw(arg) == 'Array';
	};

	var nativeSymbol = !!Object.getOwnPropertySymbols && !fails(function () {
	  // Chrome 38 Symbol has incorrect toString conversion
	  // eslint-disable-next-line no-undef
	  return !String(Symbol());
	});

	var Symbol$1 = global_1.Symbol;
	var store$2 = shared('wks');

	var wellKnownSymbol = function (name) {
	  return store$2[name] || (store$2[name] = nativeSymbol && Symbol$1[name]
	    || (nativeSymbol ? Symbol$1 : uid)('Symbol.' + name));
	};

	var SPECIES = wellKnownSymbol('species');

	// `ArraySpeciesCreate` abstract operation
	// https://tc39.github.io/ecma262/#sec-arrayspeciescreate
	var arraySpeciesCreate = function (originalArray, length) {
	  var C;
	  if (isArray(originalArray)) {
	    C = originalArray.constructor;
	    // cross-realm fallback
	    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;
	    else if (isObject(C)) {
	      C = C[SPECIES];
	      if (C === null) C = undefined;
	    }
	  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);
	};

	var push = [].push;

	// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation
	var createMethod$1 = function (TYPE) {
	  var IS_MAP = TYPE == 1;
	  var IS_FILTER = TYPE == 2;
	  var IS_SOME = TYPE == 3;
	  var IS_EVERY = TYPE == 4;
	  var IS_FIND_INDEX = TYPE == 6;
	  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;
	  return function ($this, callbackfn, that, specificCreate) {
	    var O = toObject($this);
	    var self = indexedObject(O);
	    var boundFunction = bindContext(callbackfn, that, 3);
	    var length = toLength(self.length);
	    var index = 0;
	    var create = specificCreate || arraySpeciesCreate;
	    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;
	    var value, result;
	    for (;length > index; index++) if (NO_HOLES || index in self) {
	      value = self[index];
	      result = boundFunction(value, index, O);
	      if (TYPE) {
	        if (IS_MAP) target[index] = result; // map
	        else if (result) switch (TYPE) {
	          case 3: return true;              // some
	          case 5: return value;             // find
	          case 6: return index;             // findIndex
	          case 2: push.call(target, value); // filter
	        } else if (IS_EVERY) return false;  // every
	      }
	    }
	    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;
	  };
	};

	var arrayIteration = {
	  // `Array.prototype.forEach` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.foreach
	  forEach: createMethod$1(0),
	  // `Array.prototype.map` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.map
	  map: createMethod$1(1),
	  // `Array.prototype.filter` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.filter
	  filter: createMethod$1(2),
	  // `Array.prototype.some` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.some
	  some: createMethod$1(3),
	  // `Array.prototype.every` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.every
	  every: createMethod$1(4),
	  // `Array.prototype.find` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.find
	  find: createMethod$1(5),
	  // `Array.prototype.findIndex` method
	  // https://tc39.github.io/ecma262/#sec-array.prototype.findIndex
	  findIndex: createMethod$1(6)
	};

	// `Object.keys` method
	// https://tc39.github.io/ecma262/#sec-object.keys
	var objectKeys = Object.keys || function keys(O) {
	  return objectKeysInternal(O, enumBugKeys);
	};

	// `Object.defineProperties` method
	// https://tc39.github.io/ecma262/#sec-object.defineproperties
	var objectDefineProperties = descriptors ? Object.defineProperties : function defineProperties(O, Properties) {
	  anObject(O);
	  var keys = objectKeys(Properties);
	  var length = keys.length;
	  var index = 0;
	  var key;
	  while (length > index) objectDefineProperty.f(O, key = keys[index++], Properties[key]);
	  return O;
	};

	var html = getBuiltIn('document', 'documentElement');

	var IE_PROTO = sharedKey('IE_PROTO');

	var PROTOTYPE = 'prototype';
	var Empty = function () { /* empty */ };

	// Create object with fake `null` prototype: use iframe Object with cleared prototype
	var createDict = function () {
	  // Thrash, waste and sodomy: IE GC bug
	  var iframe = documentCreateElement('iframe');
	  var length = enumBugKeys.length;
	  var lt = '<';
	  var script = 'script';
	  var gt = '>';
	  var js = 'java' + script + ':';
	  var iframeDocument;
	  iframe.style.display = 'none';
	  html.appendChild(iframe);
	  iframe.src = String(js);
	  iframeDocument = iframe.contentWindow.document;
	  iframeDocument.open();
	  iframeDocument.write(lt + script + gt + 'document.F=Object' + lt + '/' + script + gt);
	  iframeDocument.close();
	  createDict = iframeDocument.F;
	  while (length--) delete createDict[PROTOTYPE][enumBugKeys[length]];
	  return createDict();
	};

	// `Object.create` method
	// https://tc39.github.io/ecma262/#sec-object.create
	var objectCreate = Object.create || function create(O, Properties) {
	  var result;
	  if (O !== null) {
	    Empty[PROTOTYPE] = anObject(O);
	    result = new Empty();
	    Empty[PROTOTYPE] = null;
	    // add "__proto__" for Object.getPrototypeOf polyfill
	    result[IE_PROTO] = O;
	  } else result = createDict();
	  return Properties === undefined ? result : objectDefineProperties(result, Properties);
	};

	hiddenKeys[IE_PROTO] = true;

	var UNSCOPABLES = wellKnownSymbol('unscopables');
	var ArrayPrototype = Array.prototype;

	// Array.prototype[@@unscopables]
	// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables
	if (ArrayPrototype[UNSCOPABLES] == undefined) {
	  createNonEnumerableProperty(ArrayPrototype, UNSCOPABLES, objectCreate(null));
	}

	// add a key to Array.prototype[@@unscopables]
	var addToUnscopables = function (key) {
	  ArrayPrototype[UNSCOPABLES][key] = true;
	};

	var $find = arrayIteration.find;


	var FIND = 'find';
	var SKIPS_HOLES = true;

	// Shouldn't skip holes
	if (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });

	// `Array.prototype.find` method
	// https://tc39.github.io/ecma262/#sec-array.prototype.find
	_export({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {
	  find: function find(callbackfn /* , that = undefined */) {
	    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
	  }
	});

	// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables
	addToUnscopables(FIND);

	var $includes = arrayIncludes.includes;


	// `Array.prototype.includes` method
	// https://tc39.github.io/ecma262/#sec-array.prototype.includes
	_export({ target: 'Array', proto: true }, {
	  includes: function includes(el /* , fromIndex = 0 */) {
	    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);
	  }
	});

	// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables
	addToUnscopables('includes');

	var nativeAssign = Object.assign;

	// `Object.assign` method
	// https://tc39.github.io/ecma262/#sec-object.assign
	// should work with symbols and should have deterministic property order (V8 bug)
	var objectAssign = !nativeAssign || fails(function () {
	  var A = {};
	  var B = {};
	  // eslint-disable-next-line no-undef
	  var symbol = Symbol();
	  var alphabet = 'abcdefghijklmnopqrst';
	  A[symbol] = 7;
	  alphabet.split('').forEach(function (chr) { B[chr] = chr; });
	  return nativeAssign({}, A)[symbol] != 7 || objectKeys(nativeAssign({}, B)).join('') != alphabet;
	}) ? function assign(target, source) { // eslint-disable-line no-unused-vars
	  var T = toObject(target);
	  var argumentsLength = arguments.length;
	  var index = 1;
	  var getOwnPropertySymbols = objectGetOwnPropertySymbols.f;
	  var propertyIsEnumerable = objectPropertyIsEnumerable.f;
	  while (argumentsLength > index) {
	    var S = indexedObject(arguments[index++]);
	    var keys = getOwnPropertySymbols ? objectKeys(S).concat(getOwnPropertySymbols(S)) : objectKeys(S);
	    var length = keys.length;
	    var j = 0;
	    var key;
	    while (length > j) {
	      key = keys[j++];
	      if (!descriptors || propertyIsEnumerable.call(S, key)) T[key] = S[key];
	    }
	  } return T;
	} : nativeAssign;

	// `Object.assign` method
	// https://tc39.github.io/ecma262/#sec-object.assign
	_export({ target: 'Object', stat: true, forced: Object.assign !== objectAssign }, {
	  assign: objectAssign
	});

	var MATCH = wellKnownSymbol('match');

	// `IsRegExp` abstract operation
	// https://tc39.github.io/ecma262/#sec-isregexp
	var isRegexp = function (it) {
	  var isRegExp;
	  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classofRaw(it) == 'RegExp');
	};

	var notARegexp = function (it) {
	  if (isRegexp(it)) {
	    throw TypeError("The method doesn't accept regular expressions");
	  } return it;
	};

	var MATCH$1 = wellKnownSymbol('match');

	var correctIsRegexpLogic = function (METHOD_NAME) {
	  var regexp = /./;
	  try {
	    '/./'[METHOD_NAME](regexp);
	  } catch (e) {
	    try {
	      regexp[MATCH$1] = false;
	      return '/./'[METHOD_NAME](regexp);
	    } catch (f) { /* empty */ }
	  } return false;
	};

	// `String.prototype.includes` method
	// https://tc39.github.io/ecma262/#sec-string.prototype.includes
	_export({ target: 'String', proto: true, forced: !correctIsRegexpLogic('includes') }, {
	  includes: function includes(searchString /* , position = 0 */) {
	    return !!~String(requireObjectCoercible(this))
	      .indexOf(notARegexp(searchString), arguments.length > 1 ? arguments[1] : undefined);
	  }
	});

	var nativeStartsWith = ''.startsWith;
	var min$2 = Math.min;

	// `String.prototype.startsWith` method
	// https://tc39.github.io/ecma262/#sec-string.prototype.startswith
	_export({ target: 'String', proto: true, forced: !correctIsRegexpLogic('startsWith') }, {
	  startsWith: function startsWith(searchString /* , position = 0 */) {
	    var that = String(requireObjectCoercible(this));
	    notARegexp(searchString);
	    var index = toLength(min$2(arguments.length > 1 ? arguments[1] : undefined, that.length));
	    var search = String(searchString);
	    return nativeStartsWith
	      ? nativeStartsWith.call(that, search, index)
	      : that.slice(index, index + search.length) === search;
	  }
	});

	if (typeof window !== "undefined") {
	  (function () {
	    var serializeXML = function (node, output) {
	      var nodeType = node.nodeType;
	      if (nodeType === 3) {
	        output.push(node.textContent.replace(/&/, '&amp;').replace(/</, '&lt;').replace('>', '&gt;'));
	      } else if (nodeType === 1) {
	        output.push('<', node.tagName);
	        if (node.hasAttributes()) {
	          [].forEach.call(node.attributes, function(attrNode){
	            output.push(' ', attrNode.item.name, '=\'', attrNode.item.value, '\'');
	          });
	        }
	        if (node.hasChildNodes()) {
	          output.push('>');
	          [].forEach.call(node.childNodes, function(childNode){
	            serializeXML(childNode, output);
	          });
	          output.push('</', node.tagName, '>');
	        } else {
	          output.push('/>');
	        }
	      } else if (nodeType == 8) {
	        output.push('<!--', node.nodeValue, '-->');
	      }
	    };

	    Object.defineProperty(SVGElement.prototype, 'innerHTML', {
	      get: function () {
	        var output = [];
	        var childNode = this.firstChild;
	        while (childNode) {
	          serializeXML(childNode, output);
	          childNode = childNode.nextSibling;
	        }
	        return output.join('');
	      },
	      set: function (markupText) {
	        while (this.firstChild) {
	          this.removeChild(this.firstChild);
	        }

	        try {
	          var dXML = new DOMParser();
	          dXML.async = false;

	          var sXML = '<svg xmlns=\'http://www.w3.org/2000/svg\' xmlns:xlink=\'http://www.w3.org/1999/xlink\'>' + markupText + '</svg>';
	          var svgDocElement = dXML.parseFromString(sXML, 'text/xml').documentElement;

	          var childNode = svgDocElement.firstChild;
	          while (childNode) {
	            this.appendChild(this.ownerDocument.importNode(childNode, true));
	            childNode = childNode.nextSibling;
	          }
	        } catch (e) {}      }
	    });

	    Object.defineProperty(SVGElement.prototype, 'innerSVG', {
	      get: function () {
	        return this.innerHTML;
	      },
	      set: function (markup) {
	        this.innerHTML = markup;
	      }
	    });

	  })();
	}

})));

(function (global, factory) {
   true ? factory(exports) :
  undefined;
}(this, (function (exports) {
  var version = "2.0.0-alpha.24";

  function _typeof(obj) {
    if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
      _typeof = function (obj) {
        return typeof obj;
      };
    } else {
      _typeof = function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
      };
    }

    return _typeof(obj);
  }

  function _defineProperty(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);

    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      if (enumerableOnly) symbols = symbols.filter(function (sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
      keys.push.apply(keys, symbols);
    }

    return keys;
  }

  function _objectSpread2(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i] != null ? arguments[i] : {};

      if (i % 2) {
        ownKeys(source, true).forEach(function (key) {
          _defineProperty(target, key, source[key]);
        });
      } else if (Object.getOwnPropertyDescriptors) {
        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
      } else {
        ownKeys(source).forEach(function (key) {
          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
        });
      }
    }

    return target;
  }

  function ascending (a, b) {
    return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;
  }

  function bisector (compare) {
    if (compare.length === 1) compare = ascendingComparator(compare);
    return {
      left: function left(a, x, lo, hi) {
        if (lo == null) lo = 0;
        if (hi == null) hi = a.length;

        while (lo < hi) {
          var mid = lo + hi >>> 1;
          if (compare(a[mid], x) < 0) lo = mid + 1;else hi = mid;
        }

        return lo;
      },
      right: function right(a, x, lo, hi) {
        if (lo == null) lo = 0;
        if (hi == null) hi = a.length;

        while (lo < hi) {
          var mid = lo + hi >>> 1;
          if (compare(a[mid], x) > 0) hi = mid;else lo = mid + 1;
        }

        return lo;
      }
    };
  }

  function ascendingComparator(f) {
    return function (d, x) {
      return ascending(f(d), x);
    };
  }

  var ascendingBisect = bisector(ascending);
  var bisectRight = ascendingBisect.right;

  function number (x) {
    return x === null ? NaN : +x;
  }

  function extent (values, valueof) {
    var n = values.length,
        i = -1,
        value,
        min,
        max;

    if (valueof == null) {
      while (++i < n) {
        // Find the first comparable value.
        if ((value = values[i]) != null && value >= value) {
          min = max = value;

          while (++i < n) {
            // Compare the remaining values.
            if ((value = values[i]) != null) {
              if (min > value) min = value;
              if (max < value) max = value;
            }
          }
        }
      }
    } else {
      while (++i < n) {
        // Find the first comparable value.
        if ((value = valueof(values[i], i, values)) != null && value >= value) {
          min = max = value;

          while (++i < n) {
            // Compare the remaining values.
            if ((value = valueof(values[i], i, values)) != null) {
              if (min > value) min = value;
              if (max < value) max = value;
            }
          }
        }
      }
    }

    return [min, max];
  }

  function range (start, stop, step) {
    start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;
    var i = -1,
        n = Math.max(0, Math.ceil((stop - start) / step)) | 0,
        range = new Array(n);

    while (++i < n) {
      range[i] = start + i * step;
    }

    return range;
  }

  var e10 = Math.sqrt(50),
      e5 = Math.sqrt(10),
      e2 = Math.sqrt(2);
  function d3Ticks (start, stop, count) {
    var reverse,
        i = -1,
        n,
        ticks,
        step;
    stop = +stop, start = +start, count = +count;
    if (start === stop && count > 0) return [start];
    if (reverse = stop < start) n = start, start = stop, stop = n;
    if ((step = tickIncrement(start, stop, count)) === 0 || !isFinite(step)) return [];

    if (step > 0) {
      start = Math.ceil(start / step);
      stop = Math.floor(stop / step);
      ticks = new Array(n = Math.ceil(stop - start + 1));

      while (++i < n) {
        ticks[i] = (start + i) * step;
      }
    } else {
      start = Math.floor(start * step);
      stop = Math.ceil(stop * step);
      ticks = new Array(n = Math.ceil(start - stop + 1));

      while (++i < n) {
        ticks[i] = (start - i) / step;
      }
    }

    if (reverse) ticks.reverse();
    return ticks;
  }
  function tickIncrement(start, stop, count) {
    var step = (stop - start) / Math.max(0, count),
        power = Math.floor(Math.log(step) / Math.LN10),
        error = step / Math.pow(10, power);
    return power >= 0 ? (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1) * Math.pow(10, power) : -Math.pow(10, -power) / (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1);
  }
  function tickStep(start, stop, count) {
    var step0 = Math.abs(stop - start) / Math.max(0, count),
        step1 = Math.pow(10, Math.floor(Math.log(step0) / Math.LN10)),
        error = step0 / step1;
    if (error >= e10) step1 *= 10;else if (error >= e5) step1 *= 5;else if (error >= e2) step1 *= 2;
    return stop < start ? -step1 : step1;
  }

  function quantile (values, p, valueof) {
    if (valueof == null) valueof = number;
    if (!(n = values.length)) return;
    if ((p = +p) <= 0 || n < 2) return +valueof(values[0], 0, values);
    if (p >= 1) return +valueof(values[n - 1], n - 1, values);
    var n,
        i = (n - 1) * p,
        i0 = Math.floor(i),
        value0 = +valueof(values[i0], i0, values),
        value1 = +valueof(values[i0 + 1], i0 + 1, values);
    return value0 + (value1 - value0) * (i - i0);
  }

  function max (values, valueof) {
    var n = values.length,
        i = -1,
        value,
        max;

    if (valueof == null) {
      while (++i < n) {
        // Find the first comparable value.
        if ((value = values[i]) != null && value >= value) {
          max = value;

          while (++i < n) {
            // Compare the remaining values.
            if ((value = values[i]) != null && value > max) {
              max = value;
            }
          }
        }
      }
    } else {
      while (++i < n) {
        // Find the first comparable value.
        if ((value = valueof(values[i], i, values)) != null && value >= value) {
          max = value;

          while (++i < n) {
            // Compare the remaining values.
            if ((value = valueof(values[i], i, values)) != null && value > max) {
              max = value;
            }
          }
        }
      }
    }

    return max;
  }

  function mean (values, valueof) {
    var n = values.length,
        m = n,
        i = -1,
        value,
        sum = 0;

    if (valueof == null) {
      while (++i < n) {
        if (!isNaN(value = number(values[i]))) sum += value;else --m;
      }
    } else {
      while (++i < n) {
        if (!isNaN(value = number(valueof(values[i], i, values)))) sum += value;else --m;
      }
    }

    if (m) return sum / m;
  }

  function merge (arrays) {
    var n = arrays.length,
        m,
        i = -1,
        j = 0,
        merged,
        array;

    while (++i < n) {
      j += arrays[i].length;
    }

    merged = new Array(j);

    while (--n >= 0) {
      array = arrays[n];
      m = array.length;

      while (--m >= 0) {
        merged[--j] = array[m];
      }
    }

    return merged;
  }

  function min (values, valueof) {
    var n = values.length,
        i = -1,
        value,
        min;

    if (valueof == null) {
      while (++i < n) {
        // Find the first comparable value.
        if ((value = values[i]) != null && value >= value) {
          min = value;

          while (++i < n) {
            // Compare the remaining values.
            if ((value = values[i]) != null && min > value) {
              min = value;
            }
          }
        }
      }
    } else {
      while (++i < n) {
        // Find the first comparable value.
        if ((value = valueof(values[i], i, values)) != null && value >= value) {
          min = value;

          while (++i < n) {
            // Compare the remaining values.
            if ((value = valueof(values[i], i, values)) != null && min > value) {
              min = value;
            }
          }
        }
      }
    }

    return min;
  }

  function sum (values, valueof) {
    var n = values.length,
        i = -1,
        value,
        sum = 0;

    if (valueof == null) {
      while (++i < n) {
        if (value = +values[i]) sum += value; // Note: zero and null are equivalent.
      }
    } else {
      while (++i < n) {
        if (value = +valueof(values[i], i, values)) sum += value;
      }
    }

    return sum;
  }

  var t0 = new Date(),
      t1 = new Date();
  function newInterval(floori, offseti, count, field) {
    function interval(date) {
      return floori(date = new Date(+date)), date;
    }

    interval.floor = interval;

    interval.ceil = function (date) {
      return floori(date = new Date(date - 1)), offseti(date, 1), floori(date), date;
    };

    interval.round = function (date) {
      var d0 = interval(date),
          d1 = interval.ceil(date);
      return date - d0 < d1 - date ? d0 : d1;
    };

    interval.offset = function (date, step) {
      return offseti(date = new Date(+date), step == null ? 1 : Math.floor(step)), date;
    };

    interval.range = function (start, stop, step) {
      var range = [],
          previous;
      start = interval.ceil(start);
      step = step == null ? 1 : Math.floor(step);
      if (!(start < stop) || !(step > 0)) return range; // also handles Invalid Date

      do {
        range.push(previous = new Date(+start)), offseti(start, step), floori(start);
      } while (previous < start && start < stop);

      return range;
    };

    interval.filter = function (test) {
      return newInterval(function (date) {
        if (date >= date) while (floori(date), !test(date)) {
          date.setTime(date - 1);
        }
      }, function (date, step) {
        if (date >= date) {
          if (step < 0) while (++step <= 0) {
            while (offseti(date, -1), !test(date)) {} // eslint-disable-line no-empty

          } else while (--step >= 0) {
            while (offseti(date, +1), !test(date)) {} // eslint-disable-line no-empty

          }
        }
      });
    };

    if (count) {
      interval.count = function (start, end) {
        t0.setTime(+start), t1.setTime(+end);
        floori(t0), floori(t1);
        return Math.floor(count(t0, t1));
      };

      interval.every = function (step) {
        step = Math.floor(step);
        return !isFinite(step) || !(step > 0) ? null : !(step > 1) ? interval : interval.filter(field ? function (d) {
          return field(d) % step === 0;
        } : function (d) {
          return interval.count(0, d) % step === 0;
        });
      };
    }

    return interval;
  }

  var millisecond = newInterval(function () {// noop
  }, function (date, step) {
    date.setTime(+date + step);
  }, function (start, end) {
    return end - start;
  }); // An optimized implementation for this simple case.

  millisecond.every = function (k) {
    k = Math.floor(k);
    if (!isFinite(k) || !(k > 0)) return null;
    if (!(k > 1)) return millisecond;
    return newInterval(function (date) {
      date.setTime(Math.floor(date / k) * k);
    }, function (date, step) {
      date.setTime(+date + step * k);
    }, function (start, end) {
      return (end - start) / k;
    });
  };

  var durationSecond = 1e3;
  var durationMinute = 6e4;
  var durationHour = 36e5;
  var durationDay = 864e5;
  var durationWeek = 6048e5;

  var second = newInterval(function (date) {
    date.setTime(date - date.getMilliseconds());
  }, function (date, step) {
    date.setTime(+date + step * durationSecond);
  }, function (start, end) {
    return (end - start) / durationSecond;
  }, function (date) {
    return date.getUTCSeconds();
  });

  var minute = newInterval(function (date) {
    date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond);
  }, function (date, step) {
    date.setTime(+date + step * durationMinute);
  }, function (start, end) {
    return (end - start) / durationMinute;
  }, function (date) {
    return date.getMinutes();
  });

  var hour = newInterval(function (date) {
    date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond - date.getMinutes() * durationMinute);
  }, function (date, step) {
    date.setTime(+date + step * durationHour);
  }, function (start, end) {
    return (end - start) / durationHour;
  }, function (date) {
    return date.getHours();
  });

  var day = newInterval(function (date) {
    date.setHours(0, 0, 0, 0);
  }, function (date, step) {
    date.setDate(date.getDate() + step);
  }, function (start, end) {
    return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationDay;
  }, function (date) {
    return date.getDate() - 1;
  });

  function weekday(i) {
    return newInterval(function (date) {
      date.setDate(date.getDate() - (date.getDay() + 7 - i) % 7);
      date.setHours(0, 0, 0, 0);
    }, function (date, step) {
      date.setDate(date.getDate() + step * 7);
    }, function (start, end) {
      return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationWeek;
    });
  }

  var sunday = weekday(0);
  var monday = weekday(1);
  var tuesday = weekday(2);
  var wednesday = weekday(3);
  var thursday = weekday(4);
  var friday = weekday(5);
  var saturday = weekday(6);

  var month = newInterval(function (date) {
    date.setDate(1);
    date.setHours(0, 0, 0, 0);
  }, function (date, step) {
    date.setMonth(date.getMonth() + step);
  }, function (start, end) {
    return end.getMonth() - start.getMonth() + (end.getFullYear() - start.getFullYear()) * 12;
  }, function (date) {
    return date.getMonth();
  });

  var year = newInterval(function (date) {
    date.setMonth(0, 1);
    date.setHours(0, 0, 0, 0);
  }, function (date, step) {
    date.setFullYear(date.getFullYear() + step);
  }, function (start, end) {
    return end.getFullYear() - start.getFullYear();
  }, function (date) {
    return date.getFullYear();
  }); // An optimized implementation for this simple case.

  year.every = function (k) {
    return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : newInterval(function (date) {
      date.setFullYear(Math.floor(date.getFullYear() / k) * k);
      date.setMonth(0, 1);
      date.setHours(0, 0, 0, 0);
    }, function (date, step) {
      date.setFullYear(date.getFullYear() + step * k);
    });
  };

  var utcMinute = newInterval(function (date) {
    date.setUTCSeconds(0, 0);
  }, function (date, step) {
    date.setTime(+date + step * durationMinute);
  }, function (start, end) {
    return (end - start) / durationMinute;
  }, function (date) {
    return date.getUTCMinutes();
  });

  var utcHour = newInterval(function (date) {
    date.setUTCMinutes(0, 0, 0);
  }, function (date, step) {
    date.setTime(+date + step * durationHour);
  }, function (start, end) {
    return (end - start) / durationHour;
  }, function (date) {
    return date.getUTCHours();
  });

  var utcDay = newInterval(function (date) {
    date.setUTCHours(0, 0, 0, 0);
  }, function (date, step) {
    date.setUTCDate(date.getUTCDate() + step);
  }, function (start, end) {
    return (end - start) / durationDay;
  }, function (date) {
    return date.getUTCDate() - 1;
  });

  function utcWeekday(i) {
    return newInterval(function (date) {
      date.setUTCDate(date.getUTCDate() - (date.getUTCDay() + 7 - i) % 7);
      date.setUTCHours(0, 0, 0, 0);
    }, function (date, step) {
      date.setUTCDate(date.getUTCDate() + step * 7);
    }, function (start, end) {
      return (end - start) / durationWeek;
    });
  }

  var utcSunday = utcWeekday(0);
  var utcMonday = utcWeekday(1);
  var utcTuesday = utcWeekday(2);
  var utcWednesday = utcWeekday(3);
  var utcThursday = utcWeekday(4);
  var utcFriday = utcWeekday(5);
  var utcSaturday = utcWeekday(6);

  var utcMonth = newInterval(function (date) {
    date.setUTCDate(1);
    date.setUTCHours(0, 0, 0, 0);
  }, function (date, step) {
    date.setUTCMonth(date.getUTCMonth() + step);
  }, function (start, end) {
    return end.getUTCMonth() - start.getUTCMonth() + (end.getUTCFullYear() - start.getUTCFullYear()) * 12;
  }, function (date) {
    return date.getUTCMonth();
  });

  var utcYear = newInterval(function (date) {
    date.setUTCMonth(0, 1);
    date.setUTCHours(0, 0, 0, 0);
  }, function (date, step) {
    date.setUTCFullYear(date.getUTCFullYear() + step);
  }, function (start, end) {
    return end.getUTCFullYear() - start.getUTCFullYear();
  }, function (date) {
    return date.getUTCFullYear();
  }); // An optimized implementation for this simple case.

  utcYear.every = function (k) {
    return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : newInterval(function (date) {
      date.setUTCFullYear(Math.floor(date.getUTCFullYear() / k) * k);
      date.setUTCMonth(0, 1);
      date.setUTCHours(0, 0, 0, 0);
    }, function (date, step) {
      date.setUTCFullYear(date.getUTCFullYear() + step * k);
    });
  };

  function localDate(d) {
    if (0 <= d.y && d.y < 100) {
      var date = new Date(-1, d.m, d.d, d.H, d.M, d.S, d.L);
      date.setFullYear(d.y);
      return date;
    }

    return new Date(d.y, d.m, d.d, d.H, d.M, d.S, d.L);
  }

  function utcDate(d) {
    if (0 <= d.y && d.y < 100) {
      var date = new Date(Date.UTC(-1, d.m, d.d, d.H, d.M, d.S, d.L));
      date.setUTCFullYear(d.y);
      return date;
    }

    return new Date(Date.UTC(d.y, d.m, d.d, d.H, d.M, d.S, d.L));
  }

  function newYear(y) {
    return {
      y: y,
      m: 0,
      d: 1,
      H: 0,
      M: 0,
      S: 0,
      L: 0
    };
  }

  function formatLocale(locale) {
    var locale_dateTime = locale.dateTime,
        locale_date = locale.date,
        locale_time = locale.time,
        locale_periods = locale.periods,
        locale_weekdays = locale.days,
        locale_shortWeekdays = locale.shortDays,
        locale_months = locale.months,
        locale_shortMonths = locale.shortMonths;
    var periodRe = formatRe(locale_periods),
        periodLookup = formatLookup(locale_periods),
        weekdayRe = formatRe(locale_weekdays),
        weekdayLookup = formatLookup(locale_weekdays),
        shortWeekdayRe = formatRe(locale_shortWeekdays),
        shortWeekdayLookup = formatLookup(locale_shortWeekdays),
        monthRe = formatRe(locale_months),
        monthLookup = formatLookup(locale_months),
        shortMonthRe = formatRe(locale_shortMonths),
        shortMonthLookup = formatLookup(locale_shortMonths);
    var formats = {
      "a": formatShortWeekday,
      "A": formatWeekday,
      "b": formatShortMonth,
      "B": formatMonth,
      "c": null,
      "d": formatDayOfMonth,
      "e": formatDayOfMonth,
      "f": formatMicroseconds,
      "H": formatHour24,
      "I": formatHour12,
      "j": formatDayOfYear,
      "L": formatMilliseconds,
      "m": formatMonthNumber,
      "M": formatMinutes,
      "p": formatPeriod,
      "Q": formatUnixTimestamp,
      "s": formatUnixTimestampSeconds,
      "S": formatSeconds,
      "u": formatWeekdayNumberMonday,
      "U": formatWeekNumberSunday,
      "V": formatWeekNumberISO,
      "w": formatWeekdayNumberSunday,
      "W": formatWeekNumberMonday,
      "x": null,
      "X": null,
      "y": formatYear,
      "Y": formatFullYear,
      "Z": formatZone,
      "%": formatLiteralPercent
    };
    var utcFormats = {
      "a": formatUTCShortWeekday,
      "A": formatUTCWeekday,
      "b": formatUTCShortMonth,
      "B": formatUTCMonth,
      "c": null,
      "d": formatUTCDayOfMonth,
      "e": formatUTCDayOfMonth,
      "f": formatUTCMicroseconds,
      "H": formatUTCHour24,
      "I": formatUTCHour12,
      "j": formatUTCDayOfYear,
      "L": formatUTCMilliseconds,
      "m": formatUTCMonthNumber,
      "M": formatUTCMinutes,
      "p": formatUTCPeriod,
      "Q": formatUnixTimestamp,
      "s": formatUnixTimestampSeconds,
      "S": formatUTCSeconds,
      "u": formatUTCWeekdayNumberMonday,
      "U": formatUTCWeekNumberSunday,
      "V": formatUTCWeekNumberISO,
      "w": formatUTCWeekdayNumberSunday,
      "W": formatUTCWeekNumberMonday,
      "x": null,
      "X": null,
      "y": formatUTCYear,
      "Y": formatUTCFullYear,
      "Z": formatUTCZone,
      "%": formatLiteralPercent
    };
    var parses = {
      "a": parseShortWeekday,
      "A": parseWeekday,
      "b": parseShortMonth,
      "B": parseMonth,
      "c": parseLocaleDateTime,
      "d": parseDayOfMonth,
      "e": parseDayOfMonth,
      "f": parseMicroseconds,
      "H": parseHour24,
      "I": parseHour24,
      "j": parseDayOfYear,
      "L": parseMilliseconds,
      "m": parseMonthNumber,
      "M": parseMinutes,
      "p": parsePeriod,
      "Q": parseUnixTimestamp,
      "s": parseUnixTimestampSeconds,
      "S": parseSeconds,
      "u": parseWeekdayNumberMonday,
      "U": parseWeekNumberSunday,
      "V": parseWeekNumberISO,
      "w": parseWeekdayNumberSunday,
      "W": parseWeekNumberMonday,
      "x": parseLocaleDate,
      "X": parseLocaleTime,
      "y": parseYear,
      "Y": parseFullYear,
      "Z": parseZone,
      "%": parseLiteralPercent
    }; // These recursive directive definitions must be deferred.

    formats.x = newFormat(locale_date, formats);
    formats.X = newFormat(locale_time, formats);
    formats.c = newFormat(locale_dateTime, formats);
    utcFormats.x = newFormat(locale_date, utcFormats);
    utcFormats.X = newFormat(locale_time, utcFormats);
    utcFormats.c = newFormat(locale_dateTime, utcFormats);

    function newFormat(specifier, formats) {
      return function (date) {
        var string = [],
            i = -1,
            j = 0,
            n = specifier.length,
            c,
            pad,
            format;
        if (!(date instanceof Date)) date = new Date(+date);

        while (++i < n) {
          if (specifier.charCodeAt(i) === 37) {
            string.push(specifier.slice(j, i));
            if ((pad = pads[c = specifier.charAt(++i)]) != null) c = specifier.charAt(++i);else pad = c === "e" ? " " : "0";
            if (format = formats[c]) c = format(date, pad);
            string.push(c);
            j = i + 1;
          }
        }

        string.push(specifier.slice(j, i));
        return string.join("");
      };
    }

    function newParse(specifier, newDate) {
      return function (string) {
        var d = newYear(1900),
            i = parseSpecifier(d, specifier, string += "", 0),
            week,
            day$1;
        if (i != string.length) return null; // If a UNIX timestamp is specified, return it.

        if ("Q" in d) return new Date(d.Q); // The am-pm flag is 0 for AM, and 1 for PM.

        if ("p" in d) d.H = d.H % 12 + d.p * 12; // Convert day-of-week and week-of-year to day-of-year.

        if ("V" in d) {
          if (d.V < 1 || d.V > 53) return null;
          if (!("w" in d)) d.w = 1;

          if ("Z" in d) {
            week = utcDate(newYear(d.y)), day$1 = week.getUTCDay();
            week = day$1 > 4 || day$1 === 0 ? utcMonday.ceil(week) : utcMonday(week);
            week = utcDay.offset(week, (d.V - 1) * 7);
            d.y = week.getUTCFullYear();
            d.m = week.getUTCMonth();
            d.d = week.getUTCDate() + (d.w + 6) % 7;
          } else {
            week = newDate(newYear(d.y)), day$1 = week.getDay();
            week = day$1 > 4 || day$1 === 0 ? monday.ceil(week) : monday(week);
            week = day.offset(week, (d.V - 1) * 7);
            d.y = week.getFullYear();
            d.m = week.getMonth();
            d.d = week.getDate() + (d.w + 6) % 7;
          }
        } else if ("W" in d || "U" in d) {
          if (!("w" in d)) d.w = "u" in d ? d.u % 7 : "W" in d ? 1 : 0;
          day$1 = "Z" in d ? utcDate(newYear(d.y)).getUTCDay() : newDate(newYear(d.y)).getDay();
          d.m = 0;
          d.d = "W" in d ? (d.w + 6) % 7 + d.W * 7 - (day$1 + 5) % 7 : d.w + d.U * 7 - (day$1 + 6) % 7;
        } // If a time zone is specified, all fields are interpreted as UTC and then
        // offset according to the specified time zone.


        if ("Z" in d) {
          d.H += d.Z / 100 | 0;
          d.M += d.Z % 100;
          return utcDate(d);
        } // Otherwise, all fields are in local time.


        return newDate(d);
      };
    }

    function parseSpecifier(d, specifier, string, j) {
      var i = 0,
          n = specifier.length,
          m = string.length,
          c,
          parse;

      while (i < n) {
        if (j >= m) return -1;
        c = specifier.charCodeAt(i++);

        if (c === 37) {
          c = specifier.charAt(i++);
          parse = parses[c in pads ? specifier.charAt(i++) : c];
          if (!parse || (j = parse(d, string, j)) < 0) return -1;
        } else if (c != string.charCodeAt(j++)) {
          return -1;
        }
      }

      return j;
    }

    function parsePeriod(d, string, i) {
      var n = periodRe.exec(string.slice(i));
      return n ? (d.p = periodLookup[n[0].toLowerCase()], i + n[0].length) : -1;
    }

    function parseShortWeekday(d, string, i) {
      var n = shortWeekdayRe.exec(string.slice(i));
      return n ? (d.w = shortWeekdayLookup[n[0].toLowerCase()], i + n[0].length) : -1;
    }

    function parseWeekday(d, string, i) {
      var n = weekdayRe.exec(string.slice(i));
      return n ? (d.w = weekdayLookup[n[0].toLowerCase()], i + n[0].length) : -1;
    }

    function parseShortMonth(d, string, i) {
      var n = shortMonthRe.exec(string.slice(i));
      return n ? (d.m = shortMonthLookup[n[0].toLowerCase()], i + n[0].length) : -1;
    }

    function parseMonth(d, string, i) {
      var n = monthRe.exec(string.slice(i));
      return n ? (d.m = monthLookup[n[0].toLowerCase()], i + n[0].length) : -1;
    }

    function parseLocaleDateTime(d, string, i) {
      return parseSpecifier(d, locale_dateTime, string, i);
    }

    function parseLocaleDate(d, string, i) {
      return parseSpecifier(d, locale_date, string, i);
    }

    function parseLocaleTime(d, string, i) {
      return parseSpecifier(d, locale_time, string, i);
    }

    function formatShortWeekday(d) {
      return locale_shortWeekdays[d.getDay()];
    }

    function formatWeekday(d) {
      return locale_weekdays[d.getDay()];
    }

    function formatShortMonth(d) {
      return locale_shortMonths[d.getMonth()];
    }

    function formatMonth(d) {
      return locale_months[d.getMonth()];
    }

    function formatPeriod(d) {
      return locale_periods[+(d.getHours() >= 12)];
    }

    function formatUTCShortWeekday(d) {
      return locale_shortWeekdays[d.getUTCDay()];
    }

    function formatUTCWeekday(d) {
      return locale_weekdays[d.getUTCDay()];
    }

    function formatUTCShortMonth(d) {
      return locale_shortMonths[d.getUTCMonth()];
    }

    function formatUTCMonth(d) {
      return locale_months[d.getUTCMonth()];
    }

    function formatUTCPeriod(d) {
      return locale_periods[+(d.getUTCHours() >= 12)];
    }

    return {
      format: function format(specifier) {
        var f = newFormat(specifier += "", formats);

        f.toString = function () {
          return specifier;
        };

        return f;
      },
      parse: function parse(specifier) {
        var p = newParse(specifier += "", localDate);

        p.toString = function () {
          return specifier;
        };

        return p;
      },
      utcFormat: function utcFormat(specifier) {
        var f = newFormat(specifier += "", utcFormats);

        f.toString = function () {
          return specifier;
        };

        return f;
      },
      utcParse: function utcParse(specifier) {
        var p = newParse(specifier, utcDate);

        p.toString = function () {
          return specifier;
        };

        return p;
      }
    };
  }
  var pads = {
    "-": "",
    "_": " ",
    "0": "0"
  },
      numberRe = /^\s*\d+/,
      // note: ignores next directive
  percentRe = /^%/,
      requoteRe = /[\\^$*+?|[\]().{}]/g;

  function pad(value, fill, width) {
    var sign = value < 0 ? "-" : "",
        string = (sign ? -value : value) + "",
        length = string.length;
    return sign + (length < width ? new Array(width - length + 1).join(fill) + string : string);
  }

  function requote(s) {
    return s.replace(requoteRe, "\\$&");
  }

  function formatRe(names) {
    return new RegExp("^(?:" + names.map(requote).join("|") + ")", "i");
  }

  function formatLookup(names) {
    var map = {},
        i = -1,
        n = names.length;

    while (++i < n) {
      map[names[i].toLowerCase()] = i;
    }

    return map;
  }

  function parseWeekdayNumberSunday(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 1));
    return n ? (d.w = +n[0], i + n[0].length) : -1;
  }

  function parseWeekdayNumberMonday(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 1));
    return n ? (d.u = +n[0], i + n[0].length) : -1;
  }

  function parseWeekNumberSunday(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.U = +n[0], i + n[0].length) : -1;
  }

  function parseWeekNumberISO(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.V = +n[0], i + n[0].length) : -1;
  }

  function parseWeekNumberMonday(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.W = +n[0], i + n[0].length) : -1;
  }

  function parseFullYear(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 4));
    return n ? (d.y = +n[0], i + n[0].length) : -1;
  }

  function parseYear(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.y = +n[0] + (+n[0] > 68 ? 1900 : 2000), i + n[0].length) : -1;
  }

  function parseZone(d, string, i) {
    var n = /^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(string.slice(i, i + 6));
    return n ? (d.Z = n[1] ? 0 : -(n[2] + (n[3] || "00")), i + n[0].length) : -1;
  }

  function parseMonthNumber(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.m = n[0] - 1, i + n[0].length) : -1;
  }

  function parseDayOfMonth(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.d = +n[0], i + n[0].length) : -1;
  }

  function parseDayOfYear(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 3));
    return n ? (d.m = 0, d.d = +n[0], i + n[0].length) : -1;
  }

  function parseHour24(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.H = +n[0], i + n[0].length) : -1;
  }

  function parseMinutes(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.M = +n[0], i + n[0].length) : -1;
  }

  function parseSeconds(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 2));
    return n ? (d.S = +n[0], i + n[0].length) : -1;
  }

  function parseMilliseconds(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 3));
    return n ? (d.L = +n[0], i + n[0].length) : -1;
  }

  function parseMicroseconds(d, string, i) {
    var n = numberRe.exec(string.slice(i, i + 6));
    return n ? (d.L = Math.floor(n[0] / 1000), i + n[0].length) : -1;
  }

  function parseLiteralPercent(d, string, i) {
    var n = percentRe.exec(string.slice(i, i + 1));
    return n ? i + n[0].length : -1;
  }

  function parseUnixTimestamp(d, string, i) {
    var n = numberRe.exec(string.slice(i));
    return n ? (d.Q = +n[0], i + n[0].length) : -1;
  }

  function parseUnixTimestampSeconds(d, string, i) {
    var n = numberRe.exec(string.slice(i));
    return n ? (d.Q = +n[0] * 1000, i + n[0].length) : -1;
  }

  function formatDayOfMonth(d, p) {
    return pad(d.getDate(), p, 2);
  }

  function formatHour24(d, p) {
    return pad(d.getHours(), p, 2);
  }

  function formatHour12(d, p) {
    return pad(d.getHours() % 12 || 12, p, 2);
  }

  function formatDayOfYear(d, p) {
    return pad(1 + day.count(year(d), d), p, 3);
  }

  function formatMilliseconds(d, p) {
    return pad(d.getMilliseconds(), p, 3);
  }

  function formatMicroseconds(d, p) {
    return formatMilliseconds(d, p) + "000";
  }

  function formatMonthNumber(d, p) {
    return pad(d.getMonth() + 1, p, 2);
  }

  function formatMinutes(d, p) {
    return pad(d.getMinutes(), p, 2);
  }

  function formatSeconds(d, p) {
    return pad(d.getSeconds(), p, 2);
  }

  function formatWeekdayNumberMonday(d) {
    var day = d.getDay();
    return day === 0 ? 7 : day;
  }

  function formatWeekNumberSunday(d, p) {
    return pad(sunday.count(year(d), d), p, 2);
  }

  function formatWeekNumberISO(d, p) {
    var day = d.getDay();
    d = day >= 4 || day === 0 ? thursday(d) : thursday.ceil(d);
    return pad(thursday.count(year(d), d) + (year(d).getDay() === 4), p, 2);
  }

  function formatWeekdayNumberSunday(d) {
    return d.getDay();
  }

  function formatWeekNumberMonday(d, p) {
    return pad(monday.count(year(d), d), p, 2);
  }

  function formatYear(d, p) {
    return pad(d.getFullYear() % 100, p, 2);
  }

  function formatFullYear(d, p) {
    return pad(d.getFullYear() % 10000, p, 4);
  }

  function formatZone(d) {
    var z = d.getTimezoneOffset();
    return (z > 0 ? "-" : (z *= -1, "+")) + pad(z / 60 | 0, "0", 2) + pad(z % 60, "0", 2);
  }

  function formatUTCDayOfMonth(d, p) {
    return pad(d.getUTCDate(), p, 2);
  }

  function formatUTCHour24(d, p) {
    return pad(d.getUTCHours(), p, 2);
  }

  function formatUTCHour12(d, p) {
    return pad(d.getUTCHours() % 12 || 12, p, 2);
  }

  function formatUTCDayOfYear(d, p) {
    return pad(1 + utcDay.count(utcYear(d), d), p, 3);
  }

  function formatUTCMilliseconds(d, p) {
    return pad(d.getUTCMilliseconds(), p, 3);
  }

  function formatUTCMicroseconds(d, p) {
    return formatUTCMilliseconds(d, p) + "000";
  }

  function formatUTCMonthNumber(d, p) {
    return pad(d.getUTCMonth() + 1, p, 2);
  }

  function formatUTCMinutes(d, p) {
    return pad(d.getUTCMinutes(), p, 2);
  }

  function formatUTCSeconds(d, p) {
    return pad(d.getUTCSeconds(), p, 2);
  }

  function formatUTCWeekdayNumberMonday(d) {
    var dow = d.getUTCDay();
    return dow === 0 ? 7 : dow;
  }

  function formatUTCWeekNumberSunday(d, p) {
    return pad(utcSunday.count(utcYear(d), d), p, 2);
  }

  function formatUTCWeekNumberISO(d, p) {
    var day = d.getUTCDay();
    d = day >= 4 || day === 0 ? utcThursday(d) : utcThursday.ceil(d);
    return pad(utcThursday.count(utcYear(d), d) + (utcYear(d).getUTCDay() === 4), p, 2);
  }

  function formatUTCWeekdayNumberSunday(d) {
    return d.getUTCDay();
  }

  function formatUTCWeekNumberMonday(d, p) {
    return pad(utcMonday.count(utcYear(d), d), p, 2);
  }

  function formatUTCYear(d, p) {
    return pad(d.getUTCFullYear() % 100, p, 2);
  }

  function formatUTCFullYear(d, p) {
    return pad(d.getUTCFullYear() % 10000, p, 4);
  }

  function formatUTCZone() {
    return "+0000";
  }

  function formatLiteralPercent() {
    return "%";
  }

  function formatUnixTimestamp(d) {
    return +d;
  }

  function formatUnixTimestampSeconds(d) {
    return Math.floor(+d / 1000);
  }

  var locale;
  var timeFormat;
  var timeParse;
  var utcFormat;
  var utcParse;
  defaultLocale({
    dateTime: "%x, %X",
    date: "%-m/%-d/%Y",
    time: "%-I:%M:%S %p",
    periods: ["AM", "PM"],
    days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
    shortDays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
    months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    shortMonths: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
  });
  function defaultLocale(definition) {
    locale = formatLocale(definition);
    timeFormat = locale.format;
    timeParse = locale.parse;
    utcFormat = locale.utcFormat;
    utcParse = locale.utcParse;
    return locale;
  }

  var isoSpecifier = "%Y-%m-%dT%H:%M:%S.%LZ";

  function formatIsoNative(date) {
    return date.toISOString();
  }

  var formatIso = Date.prototype.toISOString ? formatIsoNative : utcFormat(isoSpecifier);

  function parseIsoNative(string) {
    var date = new Date(string);
    return isNaN(date) ? null : date;
  }

  var parseIso = +new Date("2000-01-01T00:00:00.000Z") ? parseIsoNative : utcParse(isoSpecifier);

  function initRange(domain, range) {
    switch (arguments.length) {
      case 0:
        break;

      case 1:
        this.range(domain);
        break;

      default:
        this.range(range).domain(domain);
        break;
    }

    return this;
  }
  function initInterpolator(domain, interpolator) {
    switch (arguments.length) {
      case 0:
        break;

      case 1:
        this.interpolator(domain);
        break;

      default:
        this.interpolator(interpolator).domain(domain);
        break;
    }

    return this;
  }

  var prefix = "$";

  function Map() {}

  Map.prototype = map.prototype = {
    constructor: Map,
    has: function has(key) {
      return prefix + key in this;
    },
    get: function get(key) {
      return this[prefix + key];
    },
    set: function set(key, value) {
      this[prefix + key] = value;
      return this;
    },
    remove: function remove(key) {
      var property = prefix + key;
      return property in this && delete this[property];
    },
    clear: function clear() {
      for (var property in this) {
        if (property[0] === prefix) delete this[property];
      }
    },
    keys: function keys() {
      var keys = [];

      for (var property in this) {
        if (property[0] === prefix) keys.push(property.slice(1));
      }

      return keys;
    },
    values: function values() {
      var values = [];

      for (var property in this) {
        if (property[0] === prefix) values.push(this[property]);
      }

      return values;
    },
    entries: function entries() {
      var entries = [];

      for (var property in this) {
        if (property[0] === prefix) entries.push({
          key: property.slice(1),
          value: this[property]
        });
      }

      return entries;
    },
    size: function size() {
      var size = 0;

      for (var property in this) {
        if (property[0] === prefix) ++size;
      }

      return size;
    },
    empty: function empty() {
      for (var property in this) {
        if (property[0] === prefix) return false;
      }

      return true;
    },
    each: function each(f) {
      for (var property in this) {
        if (property[0] === prefix) f(this[property], property.slice(1), this);
      }
    }
  };

  function map(object, f) {
    var map = new Map(); // Copy constructor.

    if (object instanceof Map) object.each(function (value, key) {
      map.set(key, value);
    }); // Index array by numeric index or specified key function.
    else if (Array.isArray(object)) {
        var i = -1,
            n = object.length,
            o;
        if (f == null) while (++i < n) {
          map.set(i, object[i]);
        } else while (++i < n) {
          map.set(f(o = object[i], i, object), o);
        }
      } // Convert object to map.
      else if (object) for (var key in object) {
          map.set(key, object[key]);
        }
    return map;
  }

  function nest () {
    var keys = [],
        _sortKeys = [],
        _sortValues,
        _rollup,
        nest;

    function apply(array, depth, createResult, setResult) {
      if (depth >= keys.length) {
        if (_sortValues != null) array.sort(_sortValues);
        return _rollup != null ? _rollup(array) : array;
      }

      var i = -1,
          n = array.length,
          key = keys[depth++],
          keyValue,
          value,
          valuesByKey = map(),
          values,
          result = createResult();

      while (++i < n) {
        if (values = valuesByKey.get(keyValue = key(value = array[i]) + "")) {
          values.push(value);
        } else {
          valuesByKey.set(keyValue, [value]);
        }
      }

      valuesByKey.each(function (values, key) {
        setResult(result, key, apply(values, depth, createResult, setResult));
      });
      return result;
    }

    function _entries(map, depth) {
      if (++depth > keys.length) return map;
      var array,
          sortKey = _sortKeys[depth - 1];
      if (_rollup != null && depth >= keys.length) array = map.entries();else array = [], map.each(function (v, k) {
        array.push({
          key: k,
          values: _entries(v, depth)
        });
      });
      return sortKey != null ? array.sort(function (a, b) {
        return sortKey(a.key, b.key);
      }) : array;
    }

    return nest = {
      object: function object(array) {
        return apply(array, 0, createObject, setObject);
      },
      map: function map(array) {
        return apply(array, 0, createMap, setMap);
      },
      entries: function entries(array) {
        return _entries(apply(array, 0, createMap, setMap), 0);
      },
      key: function key(d) {
        keys.push(d);
        return nest;
      },
      sortKeys: function sortKeys(order) {
        _sortKeys[keys.length - 1] = order;
        return nest;
      },
      sortValues: function sortValues(order) {
        _sortValues = order;
        return nest;
      },
      rollup: function rollup(f) {
        _rollup = f;
        return nest;
      }
    };
  }

  function createObject() {
    return {};
  }

  function setObject(object, key, value) {
    object[key] = value;
  }

  function createMap() {
    return map();
  }

  function setMap(map, key, value) {
    map.set(key, value);
  }

  function Set$1() {}

  var proto = map.prototype;
  Set$1.prototype = set.prototype = {
    constructor: Set$1,
    has: proto.has,
    add: function add(value) {
      value += "";
      this[prefix + value] = value;
      return this;
    },
    remove: proto.remove,
    clear: proto.clear,
    values: proto.keys,
    size: proto.size,
    empty: proto.empty,
    each: proto.each
  };

  function set(object, f) {
    var set = new Set$1(); // Copy constructor.

    if (object instanceof Set$1) object.each(function (value) {
      set.add(value);
    }); // Otherwise, assume its an array.
    else if (object) {
        var i = -1,
            n = object.length;
        if (f == null) while (++i < n) {
          set.add(object[i]);
        } else while (++i < n) {
          set.add(f(object[i], i, object));
        }
      }
    return set;
  }

  function keys (map) {
    var keys = [];

    for (var key in map) {
      keys.push(key);
    }

    return keys;
  }

  var array = Array.prototype;
  var map$1 = array.map;
  var slice = array.slice;

  var implicit = {
    name: "implicit"
  };
  function ordinal() {
    var index = map(),
        domain = [],
        range = [],
        unknown = implicit;

    function scale(d) {
      var key = d + "",
          i = index.get(key);

      if (!i) {
        if (unknown !== implicit) return unknown;
        index.set(key, i = domain.push(d));
      }

      return range[(i - 1) % range.length];
    }

    scale.domain = function (_) {
      if (!arguments.length) return domain.slice();
      domain = [], index = map();
      var i = -1,
          n = _.length,
          d,
          key;

      while (++i < n) {
        if (!index.has(key = (d = _[i]) + "")) index.set(key, domain.push(d));
      }

      return scale;
    };

    scale.range = function (_) {
      return arguments.length ? (range = slice.call(_), scale) : range.slice();
    };

    scale.unknown = function (_) {
      return arguments.length ? (unknown = _, scale) : unknown;
    };

    scale.copy = function () {
      return ordinal(domain, range).unknown(unknown);
    };

    initRange.apply(scale, arguments);
    return scale;
  }

  function band() {
    var scale = ordinal().unknown(undefined),
        domain = scale.domain,
        ordinalRange = scale.range,
        range$1 = [0, 1],
        step,
        bandwidth,
        round = false,
        paddingInner = 0,
        paddingOuter = 0,
        align = 0.5;
    delete scale.unknown;

    function rescale() {
      var n = domain().length,
          reverse = range$1[1] < range$1[0],
          start = range$1[reverse - 0],
          stop = range$1[1 - reverse];
      step = (stop - start) / Math.max(1, n - paddingInner + paddingOuter * 2);
      if (round) step = Math.floor(step);
      start += (stop - start - step * (n - paddingInner)) * align;
      bandwidth = step * (1 - paddingInner);
      if (round) start = Math.round(start), bandwidth = Math.round(bandwidth);
      var values = range(n).map(function (i) {
        return start + step * i;
      });
      return ordinalRange(reverse ? values.reverse() : values);
    }

    scale.domain = function (_) {
      return arguments.length ? (domain(_), rescale()) : domain();
    };

    scale.range = function (_) {
      return arguments.length ? (range$1 = [+_[0], +_[1]], rescale()) : range$1.slice();
    };

    scale.rangeRound = function (_) {
      return range$1 = [+_[0], +_[1]], round = true, rescale();
    };

    scale.bandwidth = function () {
      return bandwidth;
    };

    scale.step = function () {
      return step;
    };

    scale.round = function (_) {
      return arguments.length ? (round = !!_, rescale()) : round;
    };

    scale.padding = function (_) {
      return arguments.length ? (paddingInner = Math.min(1, paddingOuter = +_), rescale()) : paddingInner;
    };

    scale.paddingInner = function (_) {
      return arguments.length ? (paddingInner = Math.min(1, _), rescale()) : paddingInner;
    };

    scale.paddingOuter = function (_) {
      return arguments.length ? (paddingOuter = +_, rescale()) : paddingOuter;
    };

    scale.align = function (_) {
      return arguments.length ? (align = Math.max(0, Math.min(1, _)), rescale()) : align;
    };

    scale.copy = function () {
      return band(domain(), range$1).round(round).paddingInner(paddingInner).paddingOuter(paddingOuter).align(align);
    };

    return initRange.apply(rescale(), arguments);
  }

  function pointish(scale) {
    var copy = scale.copy;
    scale.padding = scale.paddingOuter;
    delete scale.paddingInner;
    delete scale.paddingOuter;

    scale.copy = function () {
      return pointish(copy());
    };

    return scale;
  }

  function point() {
    return pointish(band.apply(null, arguments).paddingInner(1));
  }

  function define (constructor, factory, prototype) {
    constructor.prototype = factory.prototype = prototype;
    prototype.constructor = constructor;
  }
  function extend(parent, definition) {
    var prototype = Object.create(parent.prototype);

    for (var key in definition) {
      prototype[key] = definition[key];
    }

    return prototype;
  }

  function Color() {}
  var _darker = 0.7;

  var _brighter = 1 / _darker;
  var reI = "\\s*([+-]?\\d+)\\s*",
      reN = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",
      reP = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",
      reHex3 = /^#([0-9a-f]{3})$/,
      reHex6 = /^#([0-9a-f]{6})$/,
      reRgbInteger = new RegExp("^rgb\\(" + [reI, reI, reI] + "\\)$"),
      reRgbPercent = new RegExp("^rgb\\(" + [reP, reP, reP] + "\\)$"),
      reRgbaInteger = new RegExp("^rgba\\(" + [reI, reI, reI, reN] + "\\)$"),
      reRgbaPercent = new RegExp("^rgba\\(" + [reP, reP, reP, reN] + "\\)$"),
      reHslPercent = new RegExp("^hsl\\(" + [reN, reP, reP] + "\\)$"),
      reHslaPercent = new RegExp("^hsla\\(" + [reN, reP, reP, reN] + "\\)$");
  var named = {
    aliceblue: 0xf0f8ff,
    antiquewhite: 0xfaebd7,
    aqua: 0x00ffff,
    aquamarine: 0x7fffd4,
    azure: 0xf0ffff,
    beige: 0xf5f5dc,
    bisque: 0xffe4c4,
    black: 0x000000,
    blanchedalmond: 0xffebcd,
    blue: 0x0000ff,
    blueviolet: 0x8a2be2,
    brown: 0xa52a2a,
    burlywood: 0xdeb887,
    cadetblue: 0x5f9ea0,
    chartreuse: 0x7fff00,
    chocolate: 0xd2691e,
    coral: 0xff7f50,
    cornflowerblue: 0x6495ed,
    cornsilk: 0xfff8dc,
    crimson: 0xdc143c,
    cyan: 0x00ffff,
    darkblue: 0x00008b,
    darkcyan: 0x008b8b,
    darkgoldenrod: 0xb8860b,
    darkgray: 0xa9a9a9,
    darkgreen: 0x006400,
    darkgrey: 0xa9a9a9,
    darkkhaki: 0xbdb76b,
    darkmagenta: 0x8b008b,
    darkolivegreen: 0x556b2f,
    darkorange: 0xff8c00,
    darkorchid: 0x9932cc,
    darkred: 0x8b0000,
    darksalmon: 0xe9967a,
    darkseagreen: 0x8fbc8f,
    darkslateblue: 0x483d8b,
    darkslategray: 0x2f4f4f,
    darkslategrey: 0x2f4f4f,
    darkturquoise: 0x00ced1,
    darkviolet: 0x9400d3,
    deeppink: 0xff1493,
    deepskyblue: 0x00bfff,
    dimgray: 0x696969,
    dimgrey: 0x696969,
    dodgerblue: 0x1e90ff,
    firebrick: 0xb22222,
    floralwhite: 0xfffaf0,
    forestgreen: 0x228b22,
    fuchsia: 0xff00ff,
    gainsboro: 0xdcdcdc,
    ghostwhite: 0xf8f8ff,
    gold: 0xffd700,
    goldenrod: 0xdaa520,
    gray: 0x808080,
    green: 0x008000,
    greenyellow: 0xadff2f,
    grey: 0x808080,
    honeydew: 0xf0fff0,
    hotpink: 0xff69b4,
    indianred: 0xcd5c5c,
    indigo: 0x4b0082,
    ivory: 0xfffff0,
    khaki: 0xf0e68c,
    lavender: 0xe6e6fa,
    lavenderblush: 0xfff0f5,
    lawngreen: 0x7cfc00,
    lemonchiffon: 0xfffacd,
    lightblue: 0xadd8e6,
    lightcoral: 0xf08080,
    lightcyan: 0xe0ffff,
    lightgoldenrodyellow: 0xfafad2,
    lightgray: 0xd3d3d3,
    lightgreen: 0x90ee90,
    lightgrey: 0xd3d3d3,
    lightpink: 0xffb6c1,
    lightsalmon: 0xffa07a,
    lightseagreen: 0x20b2aa,
    lightskyblue: 0x87cefa,
    lightslategray: 0x778899,
    lightslategrey: 0x778899,
    lightsteelblue: 0xb0c4de,
    lightyellow: 0xffffe0,
    lime: 0x00ff00,
    limegreen: 0x32cd32,
    linen: 0xfaf0e6,
    magenta: 0xff00ff,
    maroon: 0x800000,
    mediumaquamarine: 0x66cdaa,
    mediumblue: 0x0000cd,
    mediumorchid: 0xba55d3,
    mediumpurple: 0x9370db,
    mediumseagreen: 0x3cb371,
    mediumslateblue: 0x7b68ee,
    mediumspringgreen: 0x00fa9a,
    mediumturquoise: 0x48d1cc,
    mediumvioletred: 0xc71585,
    midnightblue: 0x191970,
    mintcream: 0xf5fffa,
    mistyrose: 0xffe4e1,
    moccasin: 0xffe4b5,
    navajowhite: 0xffdead,
    navy: 0x000080,
    oldlace: 0xfdf5e6,
    olive: 0x808000,
    olivedrab: 0x6b8e23,
    orange: 0xffa500,
    orangered: 0xff4500,
    orchid: 0xda70d6,
    palegoldenrod: 0xeee8aa,
    palegreen: 0x98fb98,
    paleturquoise: 0xafeeee,
    palevioletred: 0xdb7093,
    papayawhip: 0xffefd5,
    peachpuff: 0xffdab9,
    peru: 0xcd853f,
    pink: 0xffc0cb,
    plum: 0xdda0dd,
    powderblue: 0xb0e0e6,
    purple: 0x800080,
    rebeccapurple: 0x663399,
    red: 0xff0000,
    rosybrown: 0xbc8f8f,
    royalblue: 0x4169e1,
    saddlebrown: 0x8b4513,
    salmon: 0xfa8072,
    sandybrown: 0xf4a460,
    seagreen: 0x2e8b57,
    seashell: 0xfff5ee,
    sienna: 0xa0522d,
    silver: 0xc0c0c0,
    skyblue: 0x87ceeb,
    slateblue: 0x6a5acd,
    slategray: 0x708090,
    slategrey: 0x708090,
    snow: 0xfffafa,
    springgreen: 0x00ff7f,
    steelblue: 0x4682b4,
    tan: 0xd2b48c,
    teal: 0x008080,
    thistle: 0xd8bfd8,
    tomato: 0xff6347,
    turquoise: 0x40e0d0,
    violet: 0xee82ee,
    wheat: 0xf5deb3,
    white: 0xffffff,
    whitesmoke: 0xf5f5f5,
    yellow: 0xffff00,
    yellowgreen: 0x9acd32
  };
  define(Color, color, {
    displayable: function displayable() {
      return this.rgb().displayable();
    },
    hex: function hex() {
      return this.rgb().hex();
    },
    toString: function toString() {
      return this.rgb() + "";
    }
  });
  function color(format) {
    var m;
    format = (format + "").trim().toLowerCase();
    return (m = reHex3.exec(format)) ? (m = parseInt(m[1], 16), new Rgb(m >> 8 & 0xf | m >> 4 & 0x0f0, m >> 4 & 0xf | m & 0xf0, (m & 0xf) << 4 | m & 0xf, 1) // #f00
    ) : (m = reHex6.exec(format)) ? rgbn(parseInt(m[1], 16)) // #ff0000
    : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)
    : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)
    : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)
    : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)
    : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)
    : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)
    : named.hasOwnProperty(format) ? rgbn(named[format]) : format === "transparent" ? new Rgb(NaN, NaN, NaN, 0) : null;
  }

  function rgbn(n) {
    return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);
  }

  function rgba(r, g, b, a) {
    if (a <= 0) r = g = b = NaN;
    return new Rgb(r, g, b, a);
  }

  function rgbConvert(o) {
    if (!(o instanceof Color)) o = color(o);
    if (!o) return new Rgb();
    o = o.rgb();
    return new Rgb(o.r, o.g, o.b, o.opacity);
  }
  function rgb(r, g, b, opacity) {
    return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);
  }
  function Rgb(r, g, b, opacity) {
    this.r = +r;
    this.g = +g;
    this.b = +b;
    this.opacity = +opacity;
  }
  define(Rgb, rgb, extend(Color, {
    brighter: function brighter(k) {
      k = k == null ? _brighter : Math.pow(_brighter, k);
      return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker : Math.pow(_darker, k);
      return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    rgb: function rgb() {
      return this;
    },
    displayable: function displayable() {
      return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
    },
    hex: function hex() {
      return "#" + _hex(this.r) + _hex(this.g) + _hex(this.b);
    },
    toString: function toString() {
      var a = this.opacity;
      a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
      return (a === 1 ? "rgb(" : "rgba(") + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.b) || 0)) + (a === 1 ? ")" : ", " + a + ")");
    }
  }));

  function _hex(value) {
    value = Math.max(0, Math.min(255, Math.round(value) || 0));
    return (value < 16 ? "0" : "") + value.toString(16);
  }

  function hsla(h, s, l, a) {
    if (a <= 0) h = s = l = NaN;else if (l <= 0 || l >= 1) h = s = NaN;else if (s <= 0) h = NaN;
    return new Hsl(h, s, l, a);
  }

  function hslConvert(o) {
    if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);
    if (!(o instanceof Color)) o = color(o);
    if (!o) return new Hsl();
    if (o instanceof Hsl) return o;
    o = o.rgb();
    var r = o.r / 255,
        g = o.g / 255,
        b = o.b / 255,
        min = Math.min(r, g, b),
        max = Math.max(r, g, b),
        h = NaN,
        s = max - min,
        l = (max + min) / 2;

    if (s) {
      if (r === max) h = (g - b) / s + (g < b) * 6;else if (g === max) h = (b - r) / s + 2;else h = (r - g) / s + 4;
      s /= l < 0.5 ? max + min : 2 - max - min;
      h *= 60;
    } else {
      s = l > 0 && l < 1 ? 0 : h;
    }

    return new Hsl(h, s, l, o.opacity);
  }
  function hsl(h, s, l, opacity) {
    return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);
  }

  function Hsl(h, s, l, opacity) {
    this.h = +h;
    this.s = +s;
    this.l = +l;
    this.opacity = +opacity;
  }

  define(Hsl, hsl, extend(Color, {
    brighter: function brighter(k) {
      k = k == null ? _brighter : Math.pow(_brighter, k);
      return new Hsl(this.h, this.s, this.l * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker : Math.pow(_darker, k);
      return new Hsl(this.h, this.s, this.l * k, this.opacity);
    },
    rgb: function rgb() {
      var h = this.h % 360 + (this.h < 0) * 360,
          s = isNaN(h) || isNaN(this.s) ? 0 : this.s,
          l = this.l,
          m2 = l + (l < 0.5 ? l : 1 - l) * s,
          m1 = 2 * l - m2;
      return new Rgb(hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2), hsl2rgb(h, m1, m2), hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2), this.opacity);
    },
    displayable: function displayable() {
      return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
    }
  }));
  /* From FvD 13.37, CSS Color Module Level 3 */

  function hsl2rgb(h, m1, m2) {
    return (h < 60 ? m1 + (m2 - m1) * h / 60 : h < 180 ? m2 : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60 : m1) * 255;
  }

  var deg2rad = Math.PI / 180;
  var rad2deg = 180 / Math.PI;

  var K = 18,
      Xn = 0.96422,
      Yn = 1,
      Zn = 0.82521,
      t0$1 = 4 / 29,
      t1$1 = 6 / 29,
      t2 = 3 * t1$1 * t1$1,
      t3 = t1$1 * t1$1 * t1$1;

  function labConvert(o) {
    if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);
    if (o instanceof Hcl) return hcl2lab(o);
    if (!(o instanceof Rgb)) o = rgbConvert(o);
    var r = rgb2lrgb(o.r),
        g = rgb2lrgb(o.g),
        b = rgb2lrgb(o.b),
        y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn),
        x,
        z;
    if (r === g && g === b) x = z = y;else {
      x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);
      z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);
    }
    return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);
  }
  function lab(l, a, b, opacity) {
    return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);
  }
  function Lab(l, a, b, opacity) {
    this.l = +l;
    this.a = +a;
    this.b = +b;
    this.opacity = +opacity;
  }
  define(Lab, lab, extend(Color, {
    brighter: function brighter(k) {
      return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);
    },
    darker: function darker(k) {
      return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);
    },
    rgb: function rgb() {
      var y = (this.l + 16) / 116,
          x = isNaN(this.a) ? y : y + this.a / 500,
          z = isNaN(this.b) ? y : y - this.b / 200;
      x = Xn * lab2xyz(x);
      y = Yn * lab2xyz(y);
      z = Zn * lab2xyz(z);
      return new Rgb(lrgb2rgb(3.1338561 * x - 1.6168667 * y - 0.4906146 * z), lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z), lrgb2rgb(0.0719453 * x - 0.2289914 * y + 1.4052427 * z), this.opacity);
    }
  }));

  function xyz2lab(t) {
    return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0$1;
  }

  function lab2xyz(t) {
    return t > t1$1 ? t * t * t : t2 * (t - t0$1);
  }

  function lrgb2rgb(x) {
    return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);
  }

  function rgb2lrgb(x) {
    return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);
  }

  function hclConvert(o) {
    if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);
    if (!(o instanceof Lab)) o = labConvert(o);
    if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);
    var h = Math.atan2(o.b, o.a) * rad2deg;
    return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);
  }
  function hcl(h, c, l, opacity) {
    return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);
  }
  function Hcl(h, c, l, opacity) {
    this.h = +h;
    this.c = +c;
    this.l = +l;
    this.opacity = +opacity;
  }

  function hcl2lab(o) {
    if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);
    var h = o.h * deg2rad;
    return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);
  }

  define(Hcl, hcl, extend(Color, {
    brighter: function brighter(k) {
      return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);
    },
    darker: function darker(k) {
      return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);
    },
    rgb: function rgb() {
      return hcl2lab(this).rgb();
    }
  }));

  var A = -0.14861,
      B = +1.78277,
      C = -0.29227,
      D = -0.90649,
      E = +1.97294,
      ED = E * D,
      EB = E * B,
      BC_DA = B * C - D * A;

  function cubehelixConvert(o) {
    if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);
    if (!(o instanceof Rgb)) o = rgbConvert(o);
    var r = o.r / 255,
        g = o.g / 255,
        b = o.b / 255,
        l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),
        bl = b - l,
        k = (E * (g - l) - C * bl) / D,
        s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)),
        // NaN if l=0 or l=1
    h = s ? Math.atan2(k, bl) * rad2deg - 120 : NaN;
    return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);
  }

  function cubehelix(h, s, l, opacity) {
    return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);
  }
  function Cubehelix(h, s, l, opacity) {
    this.h = +h;
    this.s = +s;
    this.l = +l;
    this.opacity = +opacity;
  }
  define(Cubehelix, cubehelix, extend(Color, {
    brighter: function brighter(k) {
      k = k == null ? _brighter : Math.pow(_brighter, k);
      return new Cubehelix(this.h, this.s, this.l * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker : Math.pow(_darker, k);
      return new Cubehelix(this.h, this.s, this.l * k, this.opacity);
    },
    rgb: function rgb() {
      var h = isNaN(this.h) ? 0 : (this.h + 120) * deg2rad,
          l = +this.l,
          a = isNaN(this.s) ? 0 : this.s * l * (1 - l),
          cosh = Math.cos(h),
          sinh = Math.sin(h);
      return new Rgb(255 * (l + a * (A * cosh + B * sinh)), 255 * (l + a * (C * cosh + D * sinh)), 255 * (l + a * (E * cosh)), this.opacity);
    }
  }));

  function constant (x) {
    return function () {
      return x;
    };
  }

  function linear(a, d) {
    return function (t) {
      return a + t * d;
    };
  }

  function exponential(a, b, y) {
    return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function (t) {
      return Math.pow(a + t * b, y);
    };
  }
  function gamma(y) {
    return (y = +y) === 1 ? nogamma : function (a, b) {
      return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);
    };
  }
  function nogamma(a, b) {
    var d = b - a;
    return d ? linear(a, d) : constant(isNaN(a) ? b : a);
  }

  var interpolateRgb = (function rgbGamma(y) {
    var color = gamma(y);

    function rgb$1(start, end) {
      var r = color((start = rgb(start)).r, (end = rgb(end)).r),
          g = color(start.g, end.g),
          b = color(start.b, end.b),
          opacity = nogamma(start.opacity, end.opacity);
      return function (t) {
        start.r = r(t);
        start.g = g(t);
        start.b = b(t);
        start.opacity = opacity(t);
        return start + "";
      };
    }

    rgb$1.gamma = rgbGamma;
    return rgb$1;
  })(1);

  function array$1 (a, b) {
    var nb = b ? b.length : 0,
        na = a ? Math.min(nb, a.length) : 0,
        x = new Array(na),
        c = new Array(nb),
        i;

    for (i = 0; i < na; ++i) {
      x[i] = interpolate(a[i], b[i]);
    }

    for (; i < nb; ++i) {
      c[i] = b[i];
    }

    return function (t) {
      for (i = 0; i < na; ++i) {
        c[i] = x[i](t);
      }

      return c;
    };
  }

  function date (a, b) {
    var d = new Date();
    return a = +a, b -= a, function (t) {
      return d.setTime(a + b * t), d;
    };
  }

  function interpolateNumber (a, b) {
    return a = +a, b -= a, function (t) {
      return a + b * t;
    };
  }

  function object (a, b) {
    var i = {},
        c = {},
        k;
    if (a === null || _typeof(a) !== "object") a = {};
    if (b === null || _typeof(b) !== "object") b = {};

    for (k in b) {
      if (k in a) {
        i[k] = interpolate(a[k], b[k]);
      } else {
        c[k] = b[k];
      }
    }

    return function (t) {
      for (k in i) {
        c[k] = i[k](t);
      }

      return c;
    };
  }

  var reA = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,
      reB = new RegExp(reA.source, "g");

  function zero(b) {
    return function () {
      return b;
    };
  }

  function one(b) {
    return function (t) {
      return b(t) + "";
    };
  }

  function interpolateString (a, b) {
    var bi = reA.lastIndex = reB.lastIndex = 0,
        // scan index for next number in b
    am,
        // current match in a
    bm,
        // current match in b
    bs,
        // string preceding current number in b, if any
    i = -1,
        // index in s
    s = [],
        // string constants and placeholders
    q = []; // number interpolators
    // Coerce inputs to strings.

    a = a + "", b = b + ""; // Interpolate pairs of numbers in a & b.

    while ((am = reA.exec(a)) && (bm = reB.exec(b))) {
      if ((bs = bm.index) > bi) {
        // a string precedes the next number in b
        bs = b.slice(bi, bs);
        if (s[i]) s[i] += bs; // coalesce with previous string
        else s[++i] = bs;
      }

      if ((am = am[0]) === (bm = bm[0])) {
        // numbers in a & b match
        if (s[i]) s[i] += bm; // coalesce with previous string
        else s[++i] = bm;
      } else {
        // interpolate non-matching numbers
        s[++i] = null;
        q.push({
          i: i,
          x: interpolateNumber(am, bm)
        });
      }

      bi = reB.lastIndex;
    } // Add remains of b.


    if (bi < b.length) {
      bs = b.slice(bi);
      if (s[i]) s[i] += bs; // coalesce with previous string
      else s[++i] = bs;
    } // Special optimization for only a single match.
    // Otherwise, interpolate each of the numbers and rejoin the string.


    return s.length < 2 ? q[0] ? one(q[0].x) : zero(b) : (b = q.length, function (t) {
      for (var i = 0, o; i < b; ++i) {
        s[(o = q[i]).i] = o.x(t);
      }

      return s.join("");
    });
  }

  function interpolate (a, b) {
    var t = _typeof(b),
        c;

    return b == null || t === "boolean" ? constant(b) : (t === "number" ? interpolateNumber : t === "string" ? (c = color(b)) ? (b = c, interpolateRgb) : interpolateString : b instanceof color ? interpolateRgb : b instanceof Date ? date : Array.isArray(b) ? array$1 : typeof b.valueOf !== "function" && typeof b.toString !== "function" || isNaN(b) ? object : interpolateNumber)(a, b);
  }

  function interpolateRound (a, b) {
    return a = +a, b -= a, function (t) {
      return Math.round(a + b * t);
    };
  }

  var degrees = 180 / Math.PI;
  var identity = {
    translateX: 0,
    translateY: 0,
    rotate: 0,
    skewX: 0,
    scaleX: 1,
    scaleY: 1
  };
  function decompose (a, b, c, d, e, f) {
    var scaleX, scaleY, skewX;
    if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;
    if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;
    if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;
    if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;
    return {
      translateX: e,
      translateY: f,
      rotate: Math.atan2(b, a) * degrees,
      skewX: Math.atan(skewX) * degrees,
      scaleX: scaleX,
      scaleY: scaleY
    };
  }

  var cssNode, cssRoot, cssView, svgNode;
  function parseCss(value) {
    if (value === "none") return identity;
    if (!cssNode) cssNode = document.createElement("DIV"), cssRoot = document.documentElement, cssView = document.defaultView;
    cssNode.style.transform = value;
    value = cssView.getComputedStyle(cssRoot.appendChild(cssNode), null).getPropertyValue("transform");
    cssRoot.removeChild(cssNode);
    value = value.slice(7, -1).split(",");
    return decompose(+value[0], +value[1], +value[2], +value[3], +value[4], +value[5]);
  }
  function parseSvg(value) {
    if (value == null) return identity;
    if (!svgNode) svgNode = document.createElementNS("http://www.w3.org/2000/svg", "g");
    svgNode.setAttribute("transform", value);
    if (!(value = svgNode.transform.baseVal.consolidate())) return identity;
    value = value.matrix;
    return decompose(value.a, value.b, value.c, value.d, value.e, value.f);
  }

  function interpolateTransform(parse, pxComma, pxParen, degParen) {
    function pop(s) {
      return s.length ? s.pop() + " " : "";
    }

    function translate(xa, ya, xb, yb, s, q) {
      if (xa !== xb || ya !== yb) {
        var i = s.push("translate(", null, pxComma, null, pxParen);
        q.push({
          i: i - 4,
          x: interpolateNumber(xa, xb)
        }, {
          i: i - 2,
          x: interpolateNumber(ya, yb)
        });
      } else if (xb || yb) {
        s.push("translate(" + xb + pxComma + yb + pxParen);
      }
    }

    function rotate(a, b, s, q) {
      if (a !== b) {
        if (a - b > 180) b += 360;else if (b - a > 180) a += 360; // shortest path

        q.push({
          i: s.push(pop(s) + "rotate(", null, degParen) - 2,
          x: interpolateNumber(a, b)
        });
      } else if (b) {
        s.push(pop(s) + "rotate(" + b + degParen);
      }
    }

    function skewX(a, b, s, q) {
      if (a !== b) {
        q.push({
          i: s.push(pop(s) + "skewX(", null, degParen) - 2,
          x: interpolateNumber(a, b)
        });
      } else if (b) {
        s.push(pop(s) + "skewX(" + b + degParen);
      }
    }

    function scale(xa, ya, xb, yb, s, q) {
      if (xa !== xb || ya !== yb) {
        var i = s.push(pop(s) + "scale(", null, ",", null, ")");
        q.push({
          i: i - 4,
          x: interpolateNumber(xa, xb)
        }, {
          i: i - 2,
          x: interpolateNumber(ya, yb)
        });
      } else if (xb !== 1 || yb !== 1) {
        s.push(pop(s) + "scale(" + xb + "," + yb + ")");
      }
    }

    return function (a, b) {
      var s = [],
          // string constants and placeholders
      q = []; // number interpolators

      a = parse(a), b = parse(b);
      translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);
      rotate(a.rotate, b.rotate, s, q);
      skewX(a.skewX, b.skewX, s, q);
      scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);
      a = b = null; // gc

      return function (t) {
        var i = -1,
            n = q.length,
            o;

        while (++i < n) {
          s[(o = q[i]).i] = o.x(t);
        }

        return s.join("");
      };
    };
  }

  var interpolateTransformCss = interpolateTransform(parseCss, "px, ", "px)", "deg)");
  var interpolateTransformSvg = interpolateTransform(parseSvg, ", ", ")", ")");

  var rho = Math.SQRT2,
      rho2 = 2,
      rho4 = 4,
      epsilon2 = 1e-12;

  function cosh(x) {
    return ((x = Math.exp(x)) + 1 / x) / 2;
  }

  function sinh(x) {
    return ((x = Math.exp(x)) - 1 / x) / 2;
  }

  function tanh(x) {
    return ((x = Math.exp(2 * x)) - 1) / (x + 1);
  } // p0 = [ux0, uy0, w0]
  // p1 = [ux1, uy1, w1]


  function interpolateZoom (p0, p1) {
    var ux0 = p0[0],
        uy0 = p0[1],
        w0 = p0[2],
        ux1 = p1[0],
        uy1 = p1[1],
        w1 = p1[2],
        dx = ux1 - ux0,
        dy = uy1 - uy0,
        d2 = dx * dx + dy * dy,
        i,
        S; // Special case for u0  u1.

    if (d2 < epsilon2) {
      S = Math.log(w1 / w0) / rho;

      i = function i(t) {
        return [ux0 + t * dx, uy0 + t * dy, w0 * Math.exp(rho * t * S)];
      };
    } // General case.
    else {
        var d1 = Math.sqrt(d2),
            b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),
            b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),
            r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),
            r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);
        S = (r1 - r0) / rho;

        i = function i(t) {
          var s = t * S,
              coshr0 = cosh(r0),
              u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));
          return [ux0 + u * dx, uy0 + u * dy, w0 * coshr0 / cosh(rho * s + r0)];
        };
      }

    i.duration = S * 1000;
    return i;
  }

  function constant$1 (x) {
    return function () {
      return x;
    };
  }

  function number$1 (x) {
    return +x;
  }

  var unit = [0, 1];
  function identity$1(x) {
    return x;
  }

  function normalize(a, b) {
    return (b -= a = +a) ? function (x) {
      return (x - a) / b;
    } : constant$1(isNaN(b) ? NaN : 0.5);
  }

  function clamper(domain) {
    var a = domain[0],
        b = domain[domain.length - 1],
        t;
    if (a > b) t = a, a = b, b = t;
    return function (x) {
      return Math.max(a, Math.min(b, x));
    };
  } // normalize(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].
  // interpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding range value x in [a,b].


  function bimap(domain, range, interpolate) {
    var d0 = domain[0],
        d1 = domain[1],
        r0 = range[0],
        r1 = range[1];
    if (d1 < d0) d0 = normalize(d1, d0), r0 = interpolate(r1, r0);else d0 = normalize(d0, d1), r0 = interpolate(r0, r1);
    return function (x) {
      return r0(d0(x));
    };
  }

  function polymap(domain, range, interpolate) {
    var j = Math.min(domain.length, range.length) - 1,
        d = new Array(j),
        r = new Array(j),
        i = -1; // Reverse descending domains.

    if (domain[j] < domain[0]) {
      domain = domain.slice().reverse();
      range = range.slice().reverse();
    }

    while (++i < j) {
      d[i] = normalize(domain[i], domain[i + 1]);
      r[i] = interpolate(range[i], range[i + 1]);
    }

    return function (x) {
      var i = bisectRight(domain, x, 1, j) - 1;
      return r[i](d[i](x));
    };
  }

  function copy(source, target) {
    return target.domain(source.domain()).range(source.range()).interpolate(source.interpolate()).clamp(source.clamp()).unknown(source.unknown());
  }
  function transformer() {
    var domain = unit,
        range = unit,
        interpolate$1 = interpolate,
        transform,
        untransform,
        unknown,
        clamp = identity$1,
        piecewise,
        output,
        input;

    function rescale() {
      piecewise = Math.min(domain.length, range.length) > 2 ? polymap : bimap;
      output = input = null;
      return scale;
    }

    function scale(x) {
      return isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate$1)))(transform(clamp(x)));
    }

    scale.invert = function (y) {
      return clamp(untransform((input || (input = piecewise(range, domain.map(transform), interpolateNumber)))(y)));
    };

    scale.domain = function (_) {
      return arguments.length ? (domain = map$1.call(_, number$1), clamp === identity$1 || (clamp = clamper(domain)), rescale()) : domain.slice();
    };

    scale.range = function (_) {
      return arguments.length ? (range = slice.call(_), rescale()) : range.slice();
    };

    scale.rangeRound = function (_) {
      return range = slice.call(_), interpolate$1 = interpolateRound, rescale();
    };

    scale.clamp = function (_) {
      return arguments.length ? (clamp = _ ? clamper(domain) : identity$1, scale) : clamp !== identity$1;
    };

    scale.interpolate = function (_) {
      return arguments.length ? (interpolate$1 = _, rescale()) : interpolate$1;
    };

    scale.unknown = function (_) {
      return arguments.length ? (unknown = _, scale) : unknown;
    };

    return function (t, u) {
      transform = t, untransform = u;
      return rescale();
    };
  }
  function continuous(transform, untransform) {
    return transformer()(transform, untransform);
  }

  // Computes the decimal coefficient and exponent of the specified number x with
  // significant digits p, where x is positive and p is in [1, 21] or undefined.
  // For example, formatDecimal(1.23) returns ["123", 0].
  function formatDecimal (x, p) {
    if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf("e")) < 0) return null; // NaN, Infinity

    var i,
        coefficient = x.slice(0, i); // The string returned by toExponential either has the form \d\.\d+e[-+]\d+
    // (e.g., 1.2e+3) or the form \de[-+]\d+ (e.g., 1e+3).

    return [coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient, +x.slice(i + 1)];
  }

  function exponent (x) {
    return x = formatDecimal(Math.abs(x)), x ? x[1] : NaN;
  }

  function formatGroup (grouping, thousands) {
    return function (value, width) {
      var i = value.length,
          t = [],
          j = 0,
          g = grouping[0],
          length = 0;

      while (i > 0 && g > 0) {
        if (length + g + 1 > width) g = Math.max(1, width - length);
        t.push(value.substring(i -= g, i + g));
        if ((length += g + 1) > width) break;
        g = grouping[j = (j + 1) % grouping.length];
      }

      return t.reverse().join(thousands);
    };
  }

  function formatNumerals (numerals) {
    return function (value) {
      return value.replace(/[0-9]/g, function (i) {
        return numerals[+i];
      });
    };
  }

  // [[fill]align][sign][symbol][0][width][,][.precision][~][type]
  var re = /^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;
  function formatSpecifier(specifier) {
    return new FormatSpecifier(specifier);
  }
  formatSpecifier.prototype = FormatSpecifier.prototype; // instanceof

  function FormatSpecifier(specifier) {
    if (!(match = re.exec(specifier))) throw new Error("invalid format: " + specifier);
    var match;
    this.fill = match[1] || " ";
    this.align = match[2] || ">";
    this.sign = match[3] || "-";
    this.symbol = match[4] || "";
    this.zero = !!match[5];
    this.width = match[6] && +match[6];
    this.comma = !!match[7];
    this.precision = match[8] && +match[8].slice(1);
    this.trim = !!match[9];
    this.type = match[10] || "";
  }

  FormatSpecifier.prototype.toString = function () {
    return this.fill + this.align + this.sign + this.symbol + (this.zero ? "0" : "") + (this.width == null ? "" : Math.max(1, this.width | 0)) + (this.comma ? "," : "") + (this.precision == null ? "" : "." + Math.max(0, this.precision | 0)) + (this.trim ? "~" : "") + this.type;
  };

  // Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.
  function formatTrim (s) {
    out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {
      switch (s[i]) {
        case ".":
          i0 = i1 = i;
          break;

        case "0":
          if (i0 === 0) i0 = i;
          i1 = i;
          break;

        default:
          if (i0 > 0) {
            if (!+s[i]) break out;
            i0 = 0;
          }

          break;
      }
    }

    return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;
  }

  var prefixExponent;
  function formatPrefixAuto (x, p) {
    var d = formatDecimal(x, p);
    if (!d) return x + "";
    var coefficient = d[0],
        exponent = d[1],
        i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,
        n = coefficient.length;
    return i === n ? coefficient : i > n ? coefficient + new Array(i - n + 1).join("0") : i > 0 ? coefficient.slice(0, i) + "." + coefficient.slice(i) : "0." + new Array(1 - i).join("0") + formatDecimal(x, Math.max(0, p + i - 1))[0]; // less than 1y!
  }

  function formatRounded (x, p) {
    var d = formatDecimal(x, p);
    if (!d) return x + "";
    var coefficient = d[0],
        exponent = d[1];
    return exponent < 0 ? "0." + new Array(-exponent).join("0") + coefficient : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + "." + coefficient.slice(exponent + 1) : coefficient + new Array(exponent - coefficient.length + 2).join("0");
  }

  var formatTypes = {
    "%": function _(x, p) {
      return (x * 100).toFixed(p);
    },
    "b": function b(x) {
      return Math.round(x).toString(2);
    },
    "c": function c(x) {
      return x + "";
    },
    "d": function d(x) {
      return Math.round(x).toString(10);
    },
    "e": function e(x, p) {
      return x.toExponential(p);
    },
    "f": function f(x, p) {
      return x.toFixed(p);
    },
    "g": function g(x, p) {
      return x.toPrecision(p);
    },
    "o": function o(x) {
      return Math.round(x).toString(8);
    },
    "p": function p(x, _p) {
      return formatRounded(x * 100, _p);
    },
    "r": formatRounded,
    "s": formatPrefixAuto,
    "X": function X(x) {
      return Math.round(x).toString(16).toUpperCase();
    },
    "x": function x(_x) {
      return Math.round(_x).toString(16);
    }
  };

  function identity$2 (x) {
    return x;
  }

  var prefixes = ["y", "z", "a", "f", "p", "n", "", "m", "", "k", "M", "G", "T", "P", "E", "Z", "Y"];
  function formatLocale$1 (locale) {
    var group = locale.grouping && locale.thousands ? formatGroup(locale.grouping, locale.thousands) : identity$2,
        currency = locale.currency,
        decimal = locale.decimal,
        numerals = locale.numerals ? formatNumerals(locale.numerals) : identity$2,
        percent = locale.percent || "%";

    function newFormat(specifier) {
      specifier = formatSpecifier(specifier);
      var fill = specifier.fill,
          align = specifier.align,
          sign = specifier.sign,
          symbol = specifier.symbol,
          zero = specifier.zero,
          width = specifier.width,
          comma = specifier.comma,
          precision = specifier.precision,
          trim = specifier.trim,
          type = specifier.type; // The "n" type is an alias for ",g".

      if (type === "n") comma = true, type = "g"; // The "" type, and any invalid type, is an alias for ".12~g".
      else if (!formatTypes[type]) precision == null && (precision = 12), trim = true, type = "g"; // If zero fill is specified, padding goes after sign and before digits.

      if (zero || fill === "0" && align === "=") zero = true, fill = "0", align = "="; // Compute the prefix and suffix.
      // For SI-prefix, the suffix is lazily computed.

      var prefix = symbol === "$" ? currency[0] : symbol === "#" && /[boxX]/.test(type) ? "0" + type.toLowerCase() : "",
          suffix = symbol === "$" ? currency[1] : /[%p]/.test(type) ? percent : ""; // What format function should we use?
      // Is this an integer type?
      // Can this type generate exponential notation?

      var formatType = formatTypes[type],
          maybeSuffix = /[defgprs%]/.test(type); // Set the default precision if not specified,
      // or clamp the specified precision to the supported range.
      // For significant precision, it must be in [1, 21].
      // For fixed precision, it must be in [0, 20].

      precision = precision == null ? 6 : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision)) : Math.max(0, Math.min(20, precision));

      function format(value) {
        var valuePrefix = prefix,
            valueSuffix = suffix,
            i,
            n,
            c;

        if (type === "c") {
          valueSuffix = formatType(value) + valueSuffix;
          value = "";
        } else {
          value = +value; // Perform the initial formatting.

          var valueNegative = value < 0;
          value = formatType(Math.abs(value), precision); // Trim insignificant zeros.

          if (trim) value = formatTrim(value); // If a negative value rounds to zero during formatting, treat as positive.

          if (valueNegative && +value === 0) valueNegative = false; // Compute the prefix and suffix.

          valuePrefix = (valueNegative ? sign === "(" ? sign : "-" : sign === "-" || sign === "(" ? "" : sign) + valuePrefix;
          valueSuffix = (type === "s" ? prefixes[8 + prefixExponent / 3] : "") + valueSuffix + (valueNegative && sign === "(" ? ")" : ""); // Break the formatted value into the integer value part that can be
          // grouped, and fractional or exponential suffix part that is not.

          if (maybeSuffix) {
            i = -1, n = value.length;

            while (++i < n) {
              if (c = value.charCodeAt(i), 48 > c || c > 57) {
                valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;
                value = value.slice(0, i);
                break;
              }
            }
          }
        } // If the fill character is not "0", grouping is applied before padding.


        if (comma && !zero) value = group(value, Infinity); // Compute the padding.

        var length = valuePrefix.length + value.length + valueSuffix.length,
            padding = length < width ? new Array(width - length + 1).join(fill) : ""; // If the fill character is "0", grouping is applied after padding.

        if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = ""; // Reconstruct the final output based on the desired alignment.

        switch (align) {
          case "<":
            value = valuePrefix + value + valueSuffix + padding;
            break;

          case "=":
            value = valuePrefix + padding + value + valueSuffix;
            break;

          case "^":
            value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length);
            break;

          default:
            value = padding + valuePrefix + value + valueSuffix;
            break;
        }

        return numerals(value);
      }

      format.toString = function () {
        return specifier + "";
      };

      return format;
    }

    function formatPrefix(specifier, value) {
      var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = "f", specifier)),
          e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,
          k = Math.pow(10, -e),
          prefix = prefixes[8 + e / 3];
      return function (value) {
        return f(k * value) + prefix;
      };
    }

    return {
      format: newFormat,
      formatPrefix: formatPrefix
    };
  }

  var locale$1;
  var format;
  var formatPrefix;
  defaultLocale$1({
    decimal: ".",
    thousands: ",",
    grouping: [3],
    currency: ["$", ""]
  });
  function defaultLocale$1(definition) {
    locale$1 = formatLocale$1(definition);
    format = locale$1.format;
    formatPrefix = locale$1.formatPrefix;
    return locale$1;
  }

  function precisionFixed (step) {
    return Math.max(0, -exponent(Math.abs(step)));
  }

  function precisionPrefix (step, value) {
    return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));
  }

  function precisionRound (step, max) {
    step = Math.abs(step), max = Math.abs(max) - step;
    return Math.max(0, exponent(max) - exponent(step)) + 1;
  }

  function tickFormat (start, stop, count, specifier) {
    var step = tickStep(start, stop, count),
        precision;
    specifier = formatSpecifier(specifier == null ? ",f" : specifier);

    switch (specifier.type) {
      case "s":
        {
          var value = Math.max(Math.abs(start), Math.abs(stop));
          if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;
          return formatPrefix(specifier, value);
        }

      case "":
      case "e":
      case "g":
      case "p":
      case "r":
        {
          if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === "e");
          break;
        }

      case "f":
      case "%":
        {
          if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === "%") * 2;
          break;
        }
    }

    return format(specifier);
  }

  function linearish(scale) {
    var domain = scale.domain;

    scale.ticks = function (count) {
      var d = domain();
      return d3Ticks(d[0], d[d.length - 1], count == null ? 10 : count);
    };

    scale.tickFormat = function (count, specifier) {
      var d = domain();
      return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);
    };

    scale.nice = function (count) {
      if (count == null) count = 10;
      var d = domain(),
          i0 = 0,
          i1 = d.length - 1,
          start = d[i0],
          stop = d[i1],
          step;

      if (stop < start) {
        step = start, start = stop, stop = step;
        step = i0, i0 = i1, i1 = step;
      }

      step = tickIncrement(start, stop, count);

      if (step > 0) {
        start = Math.floor(start / step) * step;
        stop = Math.ceil(stop / step) * step;
        step = tickIncrement(start, stop, count);
      } else if (step < 0) {
        start = Math.ceil(start * step) / step;
        stop = Math.floor(stop * step) / step;
        step = tickIncrement(start, stop, count);
      }

      if (step > 0) {
        d[i0] = Math.floor(start / step) * step;
        d[i1] = Math.ceil(stop / step) * step;
        domain(d);
      } else if (step < 0) {
        d[i0] = Math.ceil(start * step) / step;
        d[i1] = Math.floor(stop * step) / step;
        domain(d);
      }

      return scale;
    };

    return scale;
  }
  function linear$1() {
    var scale = continuous(identity$1, identity$1);

    scale.copy = function () {
      return copy(scale, linear$1());
    };

    initRange.apply(scale, arguments);
    return linearish(scale);
  }

  function identity$3(domain) {
    var unknown;

    function scale(x) {
      return isNaN(x = +x) ? unknown : x;
    }

    scale.invert = scale;

    scale.domain = scale.range = function (_) {
      return arguments.length ? (domain = map$1.call(_, number$1), scale) : domain.slice();
    };

    scale.unknown = function (_) {
      return arguments.length ? (unknown = _, scale) : unknown;
    };

    scale.copy = function () {
      return identity$3(domain).unknown(unknown);
    };

    domain = arguments.length ? map$1.call(domain, number$1) : [0, 1];
    return linearish(scale);
  }

  function nice (domain, interval) {
    domain = domain.slice();
    var i0 = 0,
        i1 = domain.length - 1,
        x0 = domain[i0],
        x1 = domain[i1],
        t;

    if (x1 < x0) {
      t = i0, i0 = i1, i1 = t;
      t = x0, x0 = x1, x1 = t;
    }

    domain[i0] = interval.floor(x0);
    domain[i1] = interval.ceil(x1);
    return domain;
  }

  function transformLog(x) {
    return Math.log(x);
  }

  function transformExp(x) {
    return Math.exp(x);
  }

  function transformLogn(x) {
    return -Math.log(-x);
  }

  function transformExpn(x) {
    return -Math.exp(-x);
  }

  function pow10(x) {
    return isFinite(x) ? +("1e" + x) : x < 0 ? 0 : x;
  }

  function powp(base) {
    return base === 10 ? pow10 : base === Math.E ? Math.exp : function (x) {
      return Math.pow(base, x);
    };
  }

  function logp(base) {
    return base === Math.E ? Math.log : base === 10 && Math.log10 || base === 2 && Math.log2 || (base = Math.log(base), function (x) {
      return Math.log(x) / base;
    });
  }

  function reflect(f) {
    return function (x) {
      return -f(-x);
    };
  }

  function loggish(transform) {
    var scale = transform(transformLog, transformExp),
        domain = scale.domain,
        base = 10,
        logs,
        pows;

    function rescale() {
      logs = logp(base), pows = powp(base);

      if (domain()[0] < 0) {
        logs = reflect(logs), pows = reflect(pows);
        transform(transformLogn, transformExpn);
      } else {
        transform(transformLog, transformExp);
      }

      return scale;
    }

    scale.base = function (_) {
      return arguments.length ? (base = +_, rescale()) : base;
    };

    scale.domain = function (_) {
      return arguments.length ? (domain(_), rescale()) : domain();
    };

    scale.ticks = function (count) {
      var d = domain(),
          u = d[0],
          v = d[d.length - 1],
          r;
      if (r = v < u) i = u, u = v, v = i;
      var i = logs(u),
          j = logs(v),
          p,
          k,
          t,
          n = count == null ? 10 : +count,
          z = [];

      if (!(base % 1) && j - i < n) {
        i = Math.round(i) - 1, j = Math.round(j) + 1;
        if (u > 0) for (; i < j; ++i) {
          for (k = 1, p = pows(i); k < base; ++k) {
            t = p * k;
            if (t < u) continue;
            if (t > v) break;
            z.push(t);
          }
        } else for (; i < j; ++i) {
          for (k = base - 1, p = pows(i); k >= 1; --k) {
            t = p * k;
            if (t < u) continue;
            if (t > v) break;
            z.push(t);
          }
        }
      } else {
        z = d3Ticks(i, j, Math.min(j - i, n)).map(pows);
      }

      return r ? z.reverse() : z;
    };

    scale.tickFormat = function (count, specifier) {
      if (specifier == null) specifier = base === 10 ? ".0e" : ",";
      if (typeof specifier !== "function") specifier = format(specifier);
      if (count === Infinity) return specifier;
      if (count == null) count = 10;
      var k = Math.max(1, base * count / scale.ticks().length); // TODO fast estimate?

      return function (d) {
        var i = d / pows(Math.round(logs(d)));
        if (i * base < base - 0.5) i *= base;
        return i <= k ? specifier(d) : "";
      };
    };

    scale.nice = function () {
      return domain(nice(domain(), {
        floor: function floor(x) {
          return pows(Math.floor(logs(x)));
        },
        ceil: function ceil(x) {
          return pows(Math.ceil(logs(x)));
        }
      }));
    };

    return scale;
  }
  function log() {
    var scale = loggish(transformer()).domain([1, 10]);

    scale.copy = function () {
      return copy(scale, log()).base(scale.base());
    };

    initRange.apply(scale, arguments);
    return scale;
  }

  function transformSymlog(c) {
    return function (x) {
      return Math.sign(x) * Math.log1p(Math.abs(x / c));
    };
  }

  function transformSymexp(c) {
    return function (x) {
      return Math.sign(x) * Math.expm1(Math.abs(x)) * c;
    };
  }

  function symlogish(transform) {
    var c = 1,
        scale = transform(transformSymlog(c), transformSymexp(c));

    scale.constant = function (_) {
      return arguments.length ? transform(transformSymlog(c = +_), transformSymexp(c)) : c;
    };

    return linearish(scale);
  }
  function symlog() {
    var scale = symlogish(transformer());

    scale.copy = function () {
      return copy(scale, symlog()).constant(scale.constant());
    };

    return initRange.apply(scale, arguments);
  }

  function transformPow(exponent) {
    return function (x) {
      return x < 0 ? -Math.pow(-x, exponent) : Math.pow(x, exponent);
    };
  }

  function transformSqrt(x) {
    return x < 0 ? -Math.sqrt(-x) : Math.sqrt(x);
  }

  function transformSquare(x) {
    return x < 0 ? -x * x : x * x;
  }

  function powish(transform) {
    var scale = transform(identity$1, identity$1),
        exponent = 1;

    function rescale() {
      return exponent === 1 ? transform(identity$1, identity$1) : exponent === 0.5 ? transform(transformSqrt, transformSquare) : transform(transformPow(exponent), transformPow(1 / exponent));
    }

    scale.exponent = function (_) {
      return arguments.length ? (exponent = +_, rescale()) : exponent;
    };

    return linearish(scale);
  }
  function pow() {
    var scale = powish(transformer());

    scale.copy = function () {
      return copy(scale, pow()).exponent(scale.exponent());
    };

    initRange.apply(scale, arguments);
    return scale;
  }
  function sqrt() {
    return pow.apply(null, arguments).exponent(0.5);
  }

  function quantile$1() {
    var domain = [],
        range = [],
        thresholds = [],
        unknown;

    function rescale() {
      var i = 0,
          n = Math.max(1, range.length);
      thresholds = new Array(n - 1);

      while (++i < n) {
        thresholds[i - 1] = quantile(domain, i / n);
      }

      return scale;
    }

    function scale(x) {
      return isNaN(x = +x) ? unknown : range[bisectRight(thresholds, x)];
    }

    scale.invertExtent = function (y) {
      var i = range.indexOf(y);
      return i < 0 ? [NaN, NaN] : [i > 0 ? thresholds[i - 1] : domain[0], i < thresholds.length ? thresholds[i] : domain[domain.length - 1]];
    };

    scale.domain = function (_) {
      if (!arguments.length) return domain.slice();
      domain = [];

      for (var i = 0, n = _.length, d; i < n; ++i) {
        if (d = _[i], d != null && !isNaN(d = +d)) domain.push(d);
      }

      domain.sort(ascending);
      return rescale();
    };

    scale.range = function (_) {
      return arguments.length ? (range = slice.call(_), rescale()) : range.slice();
    };

    scale.unknown = function (_) {
      return arguments.length ? (unknown = _, scale) : unknown;
    };

    scale.quantiles = function () {
      return thresholds.slice();
    };

    scale.copy = function () {
      return quantile$1().domain(domain).range(range).unknown(unknown);
    };

    return initRange.apply(scale, arguments);
  }

  function quantize() {
    var x0 = 0,
        x1 = 1,
        n = 1,
        domain = [0.5],
        range = [0, 1],
        unknown;

    function scale(x) {
      return x <= x ? range[bisectRight(domain, x, 0, n)] : unknown;
    }

    function rescale() {
      var i = -1;
      domain = new Array(n);

      while (++i < n) {
        domain[i] = ((i + 1) * x1 - (i - n) * x0) / (n + 1);
      }

      return scale;
    }

    scale.domain = function (_) {
      return arguments.length ? (x0 = +_[0], x1 = +_[1], rescale()) : [x0, x1];
    };

    scale.range = function (_) {
      return arguments.length ? (n = (range = slice.call(_)).length - 1, rescale()) : range.slice();
    };

    scale.invertExtent = function (y) {
      var i = range.indexOf(y);
      return i < 0 ? [NaN, NaN] : i < 1 ? [x0, domain[0]] : i >= n ? [domain[n - 1], x1] : [domain[i - 1], domain[i]];
    };

    scale.unknown = function (_) {
      return arguments.length ? (unknown = _, scale) : scale;
    };

    scale.thresholds = function () {
      return domain.slice();
    };

    scale.copy = function () {
      return quantize().domain([x0, x1]).range(range).unknown(unknown);
    };

    return initRange.apply(linearish(scale), arguments);
  }

  function threshold() {
    var domain = [0.5],
        range = [0, 1],
        unknown,
        n = 1;

    function scale(x) {
      return x <= x ? range[bisectRight(domain, x, 0, n)] : unknown;
    }

    scale.domain = function (_) {
      return arguments.length ? (domain = slice.call(_), n = Math.min(domain.length, range.length - 1), scale) : domain.slice();
    };

    scale.range = function (_) {
      return arguments.length ? (range = slice.call(_), n = Math.min(domain.length, range.length - 1), scale) : range.slice();
    };

    scale.invertExtent = function (y) {
      var i = range.indexOf(y);
      return [domain[i - 1], domain[i]];
    };

    scale.unknown = function (_) {
      return arguments.length ? (unknown = _, scale) : unknown;
    };

    scale.copy = function () {
      return threshold().domain(domain).range(range).unknown(unknown);
    };

    return initRange.apply(scale, arguments);
  }

  var durationSecond$1 = 1000,
      durationMinute$1 = durationSecond$1 * 60,
      durationHour$1 = durationMinute$1 * 60,
      durationDay$1 = durationHour$1 * 24,
      durationWeek$1 = durationDay$1 * 7,
      durationMonth = durationDay$1 * 30,
      durationYear = durationDay$1 * 365;

  function date$1(t) {
    return new Date(t);
  }

  function number$2(t) {
    return t instanceof Date ? +t : +new Date(+t);
  }

  function calendar(year, month, week, day, hour, minute, second, millisecond, format) {
    var scale = continuous(identity$1, identity$1),
        invert = scale.invert,
        domain = scale.domain;
    var formatMillisecond = format(".%L"),
        formatSecond = format(":%S"),
        formatMinute = format("%I:%M"),
        formatHour = format("%I %p"),
        formatDay = format("%a %d"),
        formatWeek = format("%b %d"),
        formatMonth = format("%B"),
        formatYear = format("%Y");
    var tickIntervals = [[second, 1, durationSecond$1], [second, 5, 5 * durationSecond$1], [second, 15, 15 * durationSecond$1], [second, 30, 30 * durationSecond$1], [minute, 1, durationMinute$1], [minute, 5, 5 * durationMinute$1], [minute, 15, 15 * durationMinute$1], [minute, 30, 30 * durationMinute$1], [hour, 1, durationHour$1], [hour, 3, 3 * durationHour$1], [hour, 6, 6 * durationHour$1], [hour, 12, 12 * durationHour$1], [day, 1, durationDay$1], [day, 2, 2 * durationDay$1], [week, 1, durationWeek$1], [month, 1, durationMonth], [month, 3, 3 * durationMonth], [year, 1, durationYear]];

    function tickFormat(date) {
      return (second(date) < date ? formatMillisecond : minute(date) < date ? formatSecond : hour(date) < date ? formatMinute : day(date) < date ? formatHour : month(date) < date ? week(date) < date ? formatDay : formatWeek : year(date) < date ? formatMonth : formatYear)(date);
    }

    function tickInterval(interval, start, stop, step) {
      if (interval == null) interval = 10; // If a desired tick count is specified, pick a reasonable tick interval
      // based on the extent of the domain and a rough estimate of tick size.
      // Otherwise, assume interval is already a time interval and use it.

      if (typeof interval === "number") {
        var target = Math.abs(stop - start) / interval,
            i = bisector(function (i) {
          return i[2];
        }).right(tickIntervals, target);

        if (i === tickIntervals.length) {
          step = tickStep(start / durationYear, stop / durationYear, interval);
          interval = year;
        } else if (i) {
          i = tickIntervals[target / tickIntervals[i - 1][2] < tickIntervals[i][2] / target ? i - 1 : i];
          step = i[1];
          interval = i[0];
        } else {
          step = Math.max(tickStep(start, stop, interval), 1);
          interval = millisecond;
        }
      }

      return step == null ? interval : interval.every(step);
    }

    scale.invert = function (y) {
      return new Date(invert(y));
    };

    scale.domain = function (_) {
      return arguments.length ? domain(map$1.call(_, number$2)) : domain().map(date$1);
    };

    scale.ticks = function (interval, step) {
      var d = domain(),
          t0 = d[0],
          t1 = d[d.length - 1],
          r = t1 < t0,
          t;
      if (r) t = t0, t0 = t1, t1 = t;
      t = tickInterval(interval, t0, t1, step);
      t = t ? t.range(t0, t1 + 1) : []; // inclusive stop

      return r ? t.reverse() : t;
    };

    scale.tickFormat = function (count, specifier) {
      return specifier == null ? tickFormat : format(specifier);
    };

    scale.nice = function (interval, step) {
      var d = domain();
      return (interval = tickInterval(interval, d[0], d[d.length - 1], step)) ? domain(nice(d, interval)) : scale;
    };

    scale.copy = function () {
      return copy(scale, calendar(year, month, week, day, hour, minute, second, millisecond, format));
    };

    return scale;
  }
  function scaleTime () {
    return initRange.apply(calendar(year, month, sunday, day, hour, minute, second, millisecond, timeFormat).domain([new Date(2000, 0, 1), new Date(2000, 0, 2)]), arguments);
  }

  function utcTime () {
    return initRange.apply(calendar(utcYear, utcMonth, utcSunday, utcDay, utcHour, utcMinute, second, millisecond, utcFormat).domain([Date.UTC(2000, 0, 1), Date.UTC(2000, 0, 2)]), arguments);
  }

  function transformer$1() {
    var x0 = 0,
        x1 = 1,
        t0,
        t1,
        k10,
        transform,
        interpolator = identity$1,
        clamp = false,
        unknown;

    function scale(x) {
      return isNaN(x = +x) ? unknown : interpolator(k10 === 0 ? 0.5 : (x = (transform(x) - t0) * k10, clamp ? Math.max(0, Math.min(1, x)) : x));
    }

    scale.domain = function (_) {
      return arguments.length ? (t0 = transform(x0 = +_[0]), t1 = transform(x1 = +_[1]), k10 = t0 === t1 ? 0 : 1 / (t1 - t0), scale) : [x0, x1];
    };

    scale.clamp = function (_) {
      return arguments.length ? (clamp = !!_, scale) : clamp;
    };

    scale.interpolator = function (_) {
      return arguments.length ? (interpolator = _, scale) : interpolator;
    };

    scale.unknown = function (_) {
      return arguments.length ? (unknown = _, scale) : unknown;
    };

    return function (t) {
      transform = t, t0 = t(x0), t1 = t(x1), k10 = t0 === t1 ? 0 : 1 / (t1 - t0);
      return scale;
    };
  }

  function copy$1(source, target) {
    return target.domain(source.domain()).interpolator(source.interpolator()).clamp(source.clamp()).unknown(source.unknown());
  }
  function sequential() {
    var scale = linearish(transformer$1()(identity$1));

    scale.copy = function () {
      return copy$1(scale, sequential());
    };

    return initInterpolator.apply(scale, arguments);
  }
  function sequentialLog() {
    var scale = loggish(transformer$1()).domain([1, 10]);

    scale.copy = function () {
      return copy$1(scale, sequentialLog()).base(scale.base());
    };

    return initInterpolator.apply(scale, arguments);
  }
  function sequentialSymlog() {
    var scale = symlogish(transformer$1());

    scale.copy = function () {
      return copy$1(scale, sequentialSymlog()).constant(scale.constant());
    };

    return initInterpolator.apply(scale, arguments);
  }
  function sequentialPow() {
    var scale = powish(transformer$1());

    scale.copy = function () {
      return copy$1(scale, sequentialPow()).exponent(scale.exponent());
    };

    return initInterpolator.apply(scale, arguments);
  }
  function sequentialSqrt() {
    return sequentialPow.apply(null, arguments).exponent(0.5);
  }

  function sequentialQuantile() {
    var domain = [],
        interpolator = identity$1;

    function scale(x) {
      if (!isNaN(x = +x)) return interpolator((bisectRight(domain, x) - 1) / (domain.length - 1));
    }

    scale.domain = function (_) {
      if (!arguments.length) return domain.slice();
      domain = [];

      for (var i = 0, n = _.length, d; i < n; ++i) {
        if (d = _[i], d != null && !isNaN(d = +d)) domain.push(d);
      }

      domain.sort(ascending);
      return scale;
    };

    scale.interpolator = function (_) {
      return arguments.length ? (interpolator = _, scale) : interpolator;
    };

    scale.copy = function () {
      return sequentialQuantile(interpolator).domain(domain);
    };

    return initInterpolator.apply(scale, arguments);
  }

  function transformer$2() {
    var x0 = 0,
        x1 = 0.5,
        x2 = 1,
        t0,
        t1,
        t2,
        k10,
        k21,
        interpolator = identity$1,
        transform,
        clamp = false,
        unknown;

    function scale(x) {
      return isNaN(x = +x) ? unknown : (x = 0.5 + ((x = +transform(x)) - t1) * (x < t1 ? k10 : k21), interpolator(clamp ? Math.max(0, Math.min(1, x)) : x));
    }

    scale.domain = function (_) {
      return arguments.length ? (t0 = transform(x0 = +_[0]), t1 = transform(x1 = +_[1]), t2 = transform(x2 = +_[2]), k10 = t0 === t1 ? 0 : 0.5 / (t1 - t0), k21 = t1 === t2 ? 0 : 0.5 / (t2 - t1), scale) : [x0, x1, x2];
    };

    scale.clamp = function (_) {
      return arguments.length ? (clamp = !!_, scale) : clamp;
    };

    scale.interpolator = function (_) {
      return arguments.length ? (interpolator = _, scale) : interpolator;
    };

    scale.unknown = function (_) {
      return arguments.length ? (unknown = _, scale) : unknown;
    };

    return function (t) {
      transform = t, t0 = t(x0), t1 = t(x1), t2 = t(x2), k10 = t0 === t1 ? 0 : 0.5 / (t1 - t0), k21 = t1 === t2 ? 0 : 0.5 / (t2 - t1);
      return scale;
    };
  }

  function diverging() {
    var scale = linearish(transformer$2()(identity$1));

    scale.copy = function () {
      return copy$1(scale, diverging());
    };

    return initInterpolator.apply(scale, arguments);
  }
  function divergingLog() {
    var scale = loggish(transformer$2()).domain([0.1, 1, 10]);

    scale.copy = function () {
      return copy$1(scale, divergingLog()).base(scale.base());
    };

    return initInterpolator.apply(scale, arguments);
  }
  function divergingSymlog() {
    var scale = symlogish(transformer$2());

    scale.copy = function () {
      return copy$1(scale, divergingSymlog()).constant(scale.constant());
    };

    return initInterpolator.apply(scale, arguments);
  }
  function divergingPow() {
    var scale = powish(transformer$2());

    scale.copy = function () {
      return copy$1(scale, divergingPow()).exponent(scale.exponent());
    };

    return initInterpolator.apply(scale, arguments);
  }
  function divergingSqrt() {
    return divergingPow.apply(null, arguments).exponent(0.5);
  }



  var scales = /*#__PURE__*/Object.freeze({
    __proto__: null,
    scaleBand: band,
    scalePoint: point,
    scaleIdentity: identity$3,
    scaleLinear: linear$1,
    scaleLog: log,
    scaleSymlog: symlog,
    scaleOrdinal: ordinal,
    scaleImplicit: implicit,
    scalePow: pow,
    scaleSqrt: sqrt,
    scaleQuantile: quantile$1,
    scaleQuantize: quantize,
    scaleThreshold: threshold,
    scaleTime: scaleTime,
    scaleUtc: utcTime,
    scaleSequential: sequential,
    scaleSequentialLog: sequentialLog,
    scaleSequentialPow: sequentialPow,
    scaleSequentialSqrt: sequentialSqrt,
    scaleSequentialSymlog: sequentialSymlog,
    scaleSequentialQuantile: sequentialQuantile,
    scaleDiverging: diverging,
    scaleDivergingLog: divergingLog,
    scaleDivergingPow: divergingPow,
    scaleDivergingSqrt: divergingSqrt,
    scaleDivergingSymlog: divergingSymlog,
    tickFormat: tickFormat
  });

  var xhtml = "http://www.w3.org/1999/xhtml";
  var namespaces = {
    svg: "http://www.w3.org/2000/svg",
    xhtml: xhtml,
    xlink: "http://www.w3.org/1999/xlink",
    xml: "http://www.w3.org/XML/1998/namespace",
    xmlns: "http://www.w3.org/2000/xmlns/"
  };

  function namespace (name) {
    var prefix = name += "",
        i = prefix.indexOf(":");
    if (i >= 0 && (prefix = name.slice(0, i)) !== "xmlns") name = name.slice(i + 1);
    return namespaces.hasOwnProperty(prefix) ? {
      space: namespaces[prefix],
      local: name
    } : name;
  }

  function creatorInherit(name) {
    return function () {
      var document = this.ownerDocument,
          uri = this.namespaceURI;
      return uri === xhtml && document.documentElement.namespaceURI === xhtml ? document.createElement(name) : document.createElementNS(uri, name);
    };
  }

  function creatorFixed(fullname) {
    return function () {
      return this.ownerDocument.createElementNS(fullname.space, fullname.local);
    };
  }

  function creator (name) {
    var fullname = namespace(name);
    return (fullname.local ? creatorFixed : creatorInherit)(fullname);
  }

  function none() {}

  function selector (selector) {
    return selector == null ? none : function () {
      return this.querySelector(selector);
    };
  }

  function selection_select (select) {
    if (typeof select !== "function") select = selector(select);

    for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {
        if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {
          if ("__data__" in node) subnode.__data__ = node.__data__;
          subgroup[i] = subnode;
        }
      }
    }

    return new Selection(subgroups, this._parents);
  }

  function empty() {
    return [];
  }

  function selectorAll (selector) {
    return selector == null ? empty : function () {
      return this.querySelectorAll(selector);
    };
  }

  function selection_selectAll (select) {
    if (typeof select !== "function") select = selectorAll(select);

    for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
        if (node = group[i]) {
          subgroups.push(select.call(node, node.__data__, i, group));
          parents.push(node);
        }
      }
    }

    return new Selection(subgroups, parents);
  }

  function matcher (selector) {
    return function () {
      return this.matches(selector);
    };
  }

  function selection_filter (match) {
    if (typeof match !== "function") match = matcher(match);

    for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {
        if ((node = group[i]) && match.call(node, node.__data__, i, group)) {
          subgroup.push(node);
        }
      }
    }

    return new Selection(subgroups, this._parents);
  }

  function sparse (update) {
    return new Array(update.length);
  }

  function selection_enter () {
    return new Selection(this._enter || this._groups.map(sparse), this._parents);
  }
  function EnterNode(parent, datum) {
    this.ownerDocument = parent.ownerDocument;
    this.namespaceURI = parent.namespaceURI;
    this._next = null;
    this._parent = parent;
    this.__data__ = datum;
  }
  EnterNode.prototype = {
    constructor: EnterNode,
    appendChild: function appendChild(child) {
      return this._parent.insertBefore(child, this._next);
    },
    insertBefore: function insertBefore(child, next) {
      return this._parent.insertBefore(child, next);
    },
    querySelector: function querySelector(selector) {
      return this._parent.querySelector(selector);
    },
    querySelectorAll: function querySelectorAll(selector) {
      return this._parent.querySelectorAll(selector);
    }
  };

  function constant$2 (x) {
    return function () {
      return x;
    };
  }

  var keyPrefix = "$"; // Protect against keys like __proto__.

  function bindIndex(parent, group, enter, update, exit, data) {
    var i = 0,
        node,
        groupLength = group.length,
        dataLength = data.length; // Put any non-null nodes that fit into update.
    // Put any null nodes into enter.
    // Put any remaining data into enter.

    for (; i < dataLength; ++i) {
      if (node = group[i]) {
        node.__data__ = data[i];
        update[i] = node;
      } else {
        enter[i] = new EnterNode(parent, data[i]);
      }
    } // Put any non-null nodes that dont fit into exit.


    for (; i < groupLength; ++i) {
      if (node = group[i]) {
        exit[i] = node;
      }
    }
  }

  function bindKey(parent, group, enter, update, exit, data, key) {
    var i,
        node,
        nodeByKeyValue = {},
        groupLength = group.length,
        dataLength = data.length,
        keyValues = new Array(groupLength),
        keyValue; // Compute the key for each node.
    // If multiple nodes have the same key, the duplicates are added to exit.

    for (i = 0; i < groupLength; ++i) {
      if (node = group[i]) {
        keyValues[i] = keyValue = keyPrefix + key.call(node, node.__data__, i, group);

        if (keyValue in nodeByKeyValue) {
          exit[i] = node;
        } else {
          nodeByKeyValue[keyValue] = node;
        }
      }
    } // Compute the key for each datum.
    // If there a node associated with this key, join and add it to update.
    // If there is not (or the key is a duplicate), add it to enter.


    for (i = 0; i < dataLength; ++i) {
      keyValue = keyPrefix + key.call(parent, data[i], i, data);

      if (node = nodeByKeyValue[keyValue]) {
        update[i] = node;
        node.__data__ = data[i];
        nodeByKeyValue[keyValue] = null;
      } else {
        enter[i] = new EnterNode(parent, data[i]);
      }
    } // Add any remaining nodes that were not bound to data to exit.


    for (i = 0; i < groupLength; ++i) {
      if ((node = group[i]) && nodeByKeyValue[keyValues[i]] === node) {
        exit[i] = node;
      }
    }
  }

  function selection_data (value, key) {
    if (!value) {
      data = new Array(this.size()), j = -1;
      this.each(function (d) {
        data[++j] = d;
      });
      return data;
    }

    var bind = key ? bindKey : bindIndex,
        parents = this._parents,
        groups = this._groups;
    if (typeof value !== "function") value = constant$2(value);

    for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {
      var parent = parents[j],
          group = groups[j],
          groupLength = group.length,
          data = value.call(parent, parent && parent.__data__, j, parents),
          dataLength = data.length,
          enterGroup = enter[j] = new Array(dataLength),
          updateGroup = update[j] = new Array(dataLength),
          exitGroup = exit[j] = new Array(groupLength);
      bind(parent, group, enterGroup, updateGroup, exitGroup, data, key); // Now connect the enter nodes to their following update node, such that
      // appendChild can insert the materialized enter node before this node,
      // rather than at the end of the parent node.

      for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {
        if (previous = enterGroup[i0]) {
          if (i0 >= i1) i1 = i0 + 1;

          while (!(next = updateGroup[i1]) && ++i1 < dataLength) {
          }

          previous._next = next || null;
        }
      }
    }

    update = new Selection(update, parents);
    update._enter = enter;
    update._exit = exit;
    return update;
  }

  function selection_exit () {
    return new Selection(this._exit || this._groups.map(sparse), this._parents);
  }

  function selection_join (onenter, onupdate, onexit) {
    var enter = this.enter(),
        update = this,
        exit = this.exit();
    enter = typeof onenter === "function" ? onenter(enter) : enter.append(onenter + "");
    if (onupdate != null) update = onupdate(update);
    if (onexit == null) exit.remove();else onexit(exit);
    return enter && update ? enter.merge(update).order() : update;
  }

  function selection_merge (selection) {
    for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {
      for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {
        if (node = group0[i] || group1[i]) {
          merge[i] = node;
        }
      }
    }

    for (; j < m0; ++j) {
      merges[j] = groups0[j];
    }

    return new Selection(merges, this._parents);
  }

  function selection_order () {
    for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {
      for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {
        if (node = group[i]) {
          if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);
          next = node;
        }
      }
    }

    return this;
  }

  function selection_sort (compare) {
    if (!compare) compare = ascending$1;

    function compareNode(a, b) {
      return a && b ? compare(a.__data__, b.__data__) : !a - !b;
    }

    for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {
        if (node = group[i]) {
          sortgroup[i] = node;
        }
      }

      sortgroup.sort(compareNode);
    }

    return new Selection(sortgroups, this._parents).order();
  }

  function ascending$1(a, b) {
    return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;
  }

  function selection_call () {
    var callback = arguments[0];
    arguments[0] = this;
    callback.apply(null, arguments);
    return this;
  }

  function selection_nodes () {
    var nodes = new Array(this.size()),
        i = -1;
    this.each(function () {
      nodes[++i] = this;
    });
    return nodes;
  }

  function selection_node () {
    for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
      for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {
        var node = group[i];
        if (node) return node;
      }
    }

    return null;
  }

  function selection_size () {
    var size = 0;
    this.each(function () {
      ++size;
    });
    return size;
  }

  function selection_empty () {
    return !this.node();
  }

  function selection_each (callback) {
    for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
      for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {
        if (node = group[i]) callback.call(node, node.__data__, i, group);
      }
    }

    return this;
  }

  function attrRemove(name) {
    return function () {
      this.removeAttribute(name);
    };
  }

  function attrRemoveNS(fullname) {
    return function () {
      this.removeAttributeNS(fullname.space, fullname.local);
    };
  }

  function attrConstant(name, value) {
    return function () {
      this.setAttribute(name, value);
    };
  }

  function attrConstantNS(fullname, value) {
    return function () {
      this.setAttributeNS(fullname.space, fullname.local, value);
    };
  }

  function attrFunction(name, value) {
    return function () {
      var v = value.apply(this, arguments);
      if (v == null) this.removeAttribute(name);else this.setAttribute(name, v);
    };
  }

  function attrFunctionNS(fullname, value) {
    return function () {
      var v = value.apply(this, arguments);
      if (v == null) this.removeAttributeNS(fullname.space, fullname.local);else this.setAttributeNS(fullname.space, fullname.local, v);
    };
  }

  function selection_attr (name, value) {
    var fullname = namespace(name);

    if (arguments.length < 2) {
      var node = this.node();
      return fullname.local ? node.getAttributeNS(fullname.space, fullname.local) : node.getAttribute(fullname);
    }

    return this.each((value == null ? fullname.local ? attrRemoveNS : attrRemove : typeof value === "function" ? fullname.local ? attrFunctionNS : attrFunction : fullname.local ? attrConstantNS : attrConstant)(fullname, value));
  }

  function defaultView (node) {
    return node.ownerDocument && node.ownerDocument.defaultView || // node is a Node
    node.document && node // node is a Window
    || node.defaultView; // node is a Document
  }

  function styleRemove(name) {
    return function () {
      this.style.removeProperty(name);
    };
  }

  function styleConstant(name, value, priority) {
    return function () {
      this.style.setProperty(name, value, priority);
    };
  }

  function styleFunction(name, value, priority) {
    return function () {
      var v = value.apply(this, arguments);
      if (v == null) this.style.removeProperty(name);else this.style.setProperty(name, v, priority);
    };
  }

  function selection_style (name, value, priority) {
    return arguments.length > 1 ? this.each((value == null ? styleRemove : typeof value === "function" ? styleFunction : styleConstant)(name, value, priority == null ? "" : priority)) : styleValue(this.node(), name);
  }
  function styleValue(node, name) {
    return node.style.getPropertyValue(name) || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);
  }

  function propertyRemove(name) {
    return function () {
      delete this[name];
    };
  }

  function propertyConstant(name, value) {
    return function () {
      this[name] = value;
    };
  }

  function propertyFunction(name, value) {
    return function () {
      var v = value.apply(this, arguments);
      if (v == null) delete this[name];else this[name] = v;
    };
  }

  function selection_property (name, value) {
    return arguments.length > 1 ? this.each((value == null ? propertyRemove : typeof value === "function" ? propertyFunction : propertyConstant)(name, value)) : this.node()[name];
  }

  function classArray(string) {
    return string.trim().split(/^|\s+/);
  }

  function classList(node) {
    return node.classList || new ClassList(node);
  }

  function ClassList(node) {
    this._node = node;
    this._names = classArray(node.getAttribute("class") || "");
  }

  ClassList.prototype = {
    add: function add(name) {
      var i = this._names.indexOf(name);

      if (i < 0) {
        this._names.push(name);

        this._node.setAttribute("class", this._names.join(" "));
      }
    },
    remove: function remove(name) {
      var i = this._names.indexOf(name);

      if (i >= 0) {
        this._names.splice(i, 1);

        this._node.setAttribute("class", this._names.join(" "));
      }
    },
    contains: function contains(name) {
      return this._names.indexOf(name) >= 0;
    }
  };

  function classedAdd(node, names) {
    var list = classList(node),
        i = -1,
        n = names.length;

    while (++i < n) {
      list.add(names[i]);
    }
  }

  function classedRemove(node, names) {
    var list = classList(node),
        i = -1,
        n = names.length;

    while (++i < n) {
      list.remove(names[i]);
    }
  }

  function classedTrue(names) {
    return function () {
      classedAdd(this, names);
    };
  }

  function classedFalse(names) {
    return function () {
      classedRemove(this, names);
    };
  }

  function classedFunction(names, value) {
    return function () {
      (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);
    };
  }

  function selection_classed (name, value) {
    var names = classArray(name + "");

    if (arguments.length < 2) {
      var list = classList(this.node()),
          i = -1,
          n = names.length;

      while (++i < n) {
        if (!list.contains(names[i])) return false;
      }

      return true;
    }

    return this.each((typeof value === "function" ? classedFunction : value ? classedTrue : classedFalse)(names, value));
  }

  function textRemove() {
    this.textContent = "";
  }

  function textConstant(value) {
    return function () {
      this.textContent = value;
    };
  }

  function textFunction(value) {
    return function () {
      var v = value.apply(this, arguments);
      this.textContent = v == null ? "" : v;
    };
  }

  function selection_text (value) {
    return arguments.length ? this.each(value == null ? textRemove : (typeof value === "function" ? textFunction : textConstant)(value)) : this.node().textContent;
  }

  function htmlRemove() {
    this.innerHTML = "";
  }

  function htmlConstant(value) {
    return function () {
      this.innerHTML = value;
    };
  }

  function htmlFunction(value) {
    return function () {
      var v = value.apply(this, arguments);
      this.innerHTML = v == null ? "" : v;
    };
  }

  function selection_html (value) {
    return arguments.length ? this.each(value == null ? htmlRemove : (typeof value === "function" ? htmlFunction : htmlConstant)(value)) : this.node().innerHTML;
  }

  function raise() {
    if (this.nextSibling) this.parentNode.appendChild(this);
  }

  function selection_raise () {
    return this.each(raise);
  }

  function lower() {
    if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);
  }

  function selection_lower () {
    return this.each(lower);
  }

  function selection_append (name) {
    var create = typeof name === "function" ? name : creator(name);
    return this.select(function () {
      return this.appendChild(create.apply(this, arguments));
    });
  }

  function constantNull() {
    return null;
  }

  function selection_insert (name, before) {
    var create = typeof name === "function" ? name : creator(name),
        select = before == null ? constantNull : typeof before === "function" ? before : selector(before);
    return this.select(function () {
      return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);
    });
  }

  function remove() {
    var parent = this.parentNode;
    if (parent) parent.removeChild(this);
  }

  function selection_remove () {
    return this.each(remove);
  }

  function selection_cloneShallow() {
    return this.parentNode.insertBefore(this.cloneNode(false), this.nextSibling);
  }

  function selection_cloneDeep() {
    return this.parentNode.insertBefore(this.cloneNode(true), this.nextSibling);
  }

  function selection_clone (deep) {
    return this.select(deep ? selection_cloneDeep : selection_cloneShallow);
  }

  function selection_datum (value) {
    return arguments.length ? this.property("__data__", value) : this.node().__data__;
  }

  var filterEvents = {};
  var event$1 = null;

  if (typeof document !== "undefined") {
    var element = document.documentElement;

    if (!("onmouseenter" in element)) {
      filterEvents = {
        mouseenter: "mouseover",
        mouseleave: "mouseout"
      };
    }
  }

  function filterContextListener(listener, index, group) {
    listener = contextListener(listener, index, group);
    return function (event) {
      var related = event.relatedTarget;

      if (!related || related !== this && !(related.compareDocumentPosition(this) & 8)) {
        listener.call(this, event);
      }
    };
  }

  function contextListener(listener, index, group) {
    return function (event1) {
      var event0 = event$1; // Events can be reentrant (e.g., focus).

      event$1 = event1;

      try {
        listener.call(this, this.__data__, index, group);
      } finally {
        event$1 = event0;
      }
    };
  }

  function parseTypenames(typenames) {
    return typenames.trim().split(/^|\s+/).map(function (t) {
      var name = "",
          i = t.indexOf(".");
      if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);
      return {
        type: t,
        name: name
      };
    });
  }

  function onRemove(typename) {
    return function () {
      var on = this.__on;
      if (!on) return;

      for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {
        if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {
          this.removeEventListener(o.type, o.listener, o.capture);
        } else {
          on[++i] = o;
        }
      }

      if (++i) on.length = i;else delete this.__on;
    };
  }

  function onAdd(typename, value, capture) {
    var wrap = filterEvents.hasOwnProperty(typename.type) ? filterContextListener : contextListener;
    return function (d, i, group) {
      var on = this.__on,
          o,
          listener = wrap(value, i, group);
      if (on) for (var j = 0, m = on.length; j < m; ++j) {
        if ((o = on[j]).type === typename.type && o.name === typename.name) {
          this.removeEventListener(o.type, o.listener, o.capture);
          this.addEventListener(o.type, o.listener = listener, o.capture = capture);
          o.value = value;
          return;
        }
      }
      this.addEventListener(typename.type, listener, capture);
      o = {
        type: typename.type,
        name: typename.name,
        value: value,
        listener: listener,
        capture: capture
      };
      if (!on) this.__on = [o];else on.push(o);
    };
  }

  function selection_on (typename, value, capture) {
    var typenames = parseTypenames(typename + ""),
        i,
        n = typenames.length,
        t;

    if (arguments.length < 2) {
      var on = this.node().__on;

      if (on) for (var j = 0, m = on.length, o; j < m; ++j) {
        for (i = 0, o = on[j]; i < n; ++i) {
          if ((t = typenames[i]).type === o.type && t.name === o.name) {
            return o.value;
          }
        }
      }
      return;
    }

    on = value ? onAdd : onRemove;
    if (capture == null) capture = false;

    for (i = 0; i < n; ++i) {
      this.each(on(typenames[i], value, capture));
    }

    return this;
  }
  function customEvent(event1, listener, that, args) {
    var event0 = event$1;
    event1.sourceEvent = event$1;
    event$1 = event1;

    try {
      return listener.apply(that, args);
    } finally {
      event$1 = event0;
    }
  }

  function dispatchEvent(node, type, params) {
    var window = defaultView(node),
        event = window.CustomEvent;

    if (typeof event === "function") {
      event = new event(type, params);
    } else {
      event = window.document.createEvent("Event");
      if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;else event.initEvent(type, false, false);
    }

    node.dispatchEvent(event);
  }

  function dispatchConstant(type, params) {
    return function () {
      return dispatchEvent(this, type, params);
    };
  }

  function dispatchFunction(type, params) {
    return function () {
      return dispatchEvent(this, type, params.apply(this, arguments));
    };
  }

  function selection_dispatch (type, params) {
    return this.each((typeof params === "function" ? dispatchFunction : dispatchConstant)(type, params));
  }

  var root = [null];
  function Selection(groups, parents) {
    this._groups = groups;
    this._parents = parents;
  }

  function selection() {
    return new Selection([[document.documentElement]], root);
  }

  Selection.prototype = selection.prototype = {
    constructor: Selection,
    select: selection_select,
    selectAll: selection_selectAll,
    filter: selection_filter,
    data: selection_data,
    enter: selection_enter,
    exit: selection_exit,
    join: selection_join,
    merge: selection_merge,
    order: selection_order,
    sort: selection_sort,
    call: selection_call,
    nodes: selection_nodes,
    node: selection_node,
    size: selection_size,
    empty: selection_empty,
    each: selection_each,
    attr: selection_attr,
    style: selection_style,
    property: selection_property,
    classed: selection_classed,
    text: selection_text,
    html: selection_html,
    raise: selection_raise,
    lower: selection_lower,
    append: selection_append,
    insert: selection_insert,
    remove: selection_remove,
    clone: selection_clone,
    datum: selection_datum,
    on: selection_on,
    dispatch: selection_dispatch
  };

  function _select (selector) {
    return typeof selector === "string" ? new Selection([[document.querySelector(selector)]], [document.documentElement]) : new Selection([[selector]], root);
  }

  function sourceEvent () {
    var current = event$1,
        source;

    while (source = current.sourceEvent) {
      current = source;
    }

    return current;
  }

  function point$1 (node, event) {
    var svg = node.ownerSVGElement || node;

    if (svg.createSVGPoint) {
      var point = svg.createSVGPoint();
      point.x = event.clientX, point.y = event.clientY;
      point = point.matrixTransform(node.getScreenCTM().inverse());
      return [point.x, point.y];
    }

    var rect = node.getBoundingClientRect();
    return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];
  }

  function mouse (node) {
    var event = sourceEvent();
    if (event.changedTouches) event = event.changedTouches[0];
    return point$1(node, event);
  }

  function selectAll (selector) {
    return typeof selector === "string" ? new Selection([document.querySelectorAll(selector)], [document.documentElement]) : new Selection([selector == null ? [] : selector], root);
  }

  function touch (node, touches, identifier) {
    if (arguments.length < 3) identifier = touches, touches = sourceEvent().changedTouches;

    for (var i = 0, n = touches ? touches.length : 0, touch; i < n; ++i) {
      if ((touch = touches[i]).identifier === identifier) {
        return point$1(node, touch);
      }
    }

    return null;
  }

  var noop = {
    value: function value() {}
  };

  function dispatch() {
    for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {
      if (!(t = arguments[i] + "") || t in _) throw new Error("illegal type: " + t);
      _[t] = [];
    }

    return new Dispatch(_);
  }

  function Dispatch(_) {
    this._ = _;
  }

  function parseTypenames$1(typenames, types) {
    return typenames.trim().split(/^|\s+/).map(function (t) {
      var name = "",
          i = t.indexOf(".");
      if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);
      if (t && !types.hasOwnProperty(t)) throw new Error("unknown type: " + t);
      return {
        type: t,
        name: name
      };
    });
  }

  Dispatch.prototype = dispatch.prototype = {
    constructor: Dispatch,
    on: function on(typename, callback) {
      var _ = this._,
          T = parseTypenames$1(typename + "", _),
          t,
          i = -1,
          n = T.length; // If no callback was specified, return the callback of the given type and name.

      if (arguments.length < 2) {
        while (++i < n) {
          if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;
        }

        return;
      } // If a type was specified, set the callback for the given type and name.
      // Otherwise, if a null callback was specified, remove callbacks of the given name.


      if (callback != null && typeof callback !== "function") throw new Error("invalid callback: " + callback);

      while (++i < n) {
        if (t = (typename = T[i]).type) _[t] = set$1(_[t], typename.name, callback);else if (callback == null) for (t in _) {
          _[t] = set$1(_[t], typename.name, null);
        }
      }

      return this;
    },
    copy: function copy() {
      var copy = {},
          _ = this._;

      for (var t in _) {
        copy[t] = _[t].slice();
      }

      return new Dispatch(copy);
    },
    call: function call(type, that) {
      if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) {
        args[i] = arguments[i + 2];
      }
      if (!this._.hasOwnProperty(type)) throw new Error("unknown type: " + type);

      for (t = this._[type], i = 0, n = t.length; i < n; ++i) {
        t[i].value.apply(that, args);
      }
    },
    apply: function apply(type, that, args) {
      if (!this._.hasOwnProperty(type)) throw new Error("unknown type: " + type);

      for (var t = this._[type], i = 0, n = t.length; i < n; ++i) {
        t[i].value.apply(that, args);
      }
    }
  };

  function get(type, name) {
    for (var i = 0, n = type.length, c; i < n; ++i) {
      if ((c = type[i]).name === name) {
        return c.value;
      }
    }
  }

  function set$1(type, name, callback) {
    for (var i = 0, n = type.length; i < n; ++i) {
      if (type[i].name === name) {
        type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));
        break;
      }
    }

    if (callback != null) type.push({
      name: name,
      value: callback
    });
    return type;
  }

  var frame = 0,
      // is an animation frame pending?
  timeout = 0,
      // is a timeout pending?
  interval = 0,
      // are any timers active?
  pokeDelay = 1000,
      // how frequently we check for clock skew
  taskHead,
      taskTail,
      clockLast = 0,
      clockNow = 0,
      clockSkew = 0,
      clock = (typeof performance === "undefined" ? "undefined" : _typeof(performance)) === "object" && performance.now ? performance : Date,
      setFrame = (typeof window === "undefined" ? "undefined" : _typeof(window)) === "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function (f) {
    setTimeout(f, 17);
  };
  function now() {
    return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);
  }

  function clearNow() {
    clockNow = 0;
  }

  function Timer() {
    this._call = this._time = this._next = null;
  }
  Timer.prototype = timer.prototype = {
    constructor: Timer,
    restart: function restart(callback, delay, time) {
      if (typeof callback !== "function") throw new TypeError("callback is not a function");
      time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);

      if (!this._next && taskTail !== this) {
        if (taskTail) taskTail._next = this;else taskHead = this;
        taskTail = this;
      }

      this._call = callback;
      this._time = time;
      sleep();
    },
    stop: function stop() {
      if (this._call) {
        this._call = null;
        this._time = Infinity;
        sleep();
      }
    }
  };
  function timer(callback, delay, time) {
    var t = new Timer();
    t.restart(callback, delay, time);
    return t;
  }
  function timerFlush() {
    now(); // Get the current time, if not already set.

    ++frame; // Pretend weve set an alarm, if we havent already.

    var t = taskHead,
        e;

    while (t) {
      if ((e = clockNow - t._time) >= 0) t._call.call(null, e);
      t = t._next;
    }

    --frame;
  }

  function wake() {
    clockNow = (clockLast = clock.now()) + clockSkew;
    frame = timeout = 0;

    try {
      timerFlush();
    } finally {
      frame = 0;
      nap();
      clockNow = 0;
    }
  }

  function poke() {
    var now = clock.now(),
        delay = now - clockLast;
    if (delay > pokeDelay) clockSkew -= delay, clockLast = now;
  }

  function nap() {
    var t0,
        t1 = taskHead,
        t2,
        time = Infinity;

    while (t1) {
      if (t1._call) {
        if (time > t1._time) time = t1._time;
        t0 = t1, t1 = t1._next;
      } else {
        t2 = t1._next, t1._next = null;
        t1 = t0 ? t0._next = t2 : taskHead = t2;
      }
    }

    taskTail = t0;
    sleep(time);
  }

  function sleep(time) {
    if (frame) return; // Soonest alarm already set, or will be.

    if (timeout) timeout = clearTimeout(timeout);
    var delay = time - clockNow; // Strictly less than if we recomputed clockNow.

    if (delay > 24) {
      if (time < Infinity) timeout = setTimeout(wake, time - clock.now() - clockSkew);
      if (interval) interval = clearInterval(interval);
    } else {
      if (!interval) clockLast = clock.now(), interval = setInterval(poke, pokeDelay);
      frame = 1, setFrame(wake);
    }
  }

  function timeout$1 (callback, delay, time) {
    var t = new Timer();
    delay = delay == null ? 0 : +delay;
    t.restart(function (elapsed) {
      t.stop();
      callback(elapsed + delay);
    }, delay, time);
    return t;
  }

  var emptyOn = dispatch("start", "end", "cancel", "interrupt");
  var emptyTween = [];
  var CREATED = 0;
  var SCHEDULED = 1;
  var STARTING = 2;
  var STARTED = 3;
  var RUNNING = 4;
  var ENDING = 5;
  var ENDED = 6;
  function schedule (node, name, id, index, group, timing) {
    var schedules = node.__transition;
    if (!schedules) node.__transition = {};else if (id in schedules) return;
    create(node, id, {
      name: name,
      index: index,
      // For context during callback.
      group: group,
      // For context during callback.
      on: emptyOn,
      tween: emptyTween,
      time: timing.time,
      delay: timing.delay,
      duration: timing.duration,
      ease: timing.ease,
      timer: null,
      state: CREATED
    });
  }
  function init(node, id) {
    var schedule = get$1(node, id);
    if (schedule.state > CREATED) throw new Error("too late; already scheduled");
    return schedule;
  }
  function set$2(node, id) {
    var schedule = get$1(node, id);
   // if (schedule.state > STARTED) throw new Error("too late; already running");
    return schedule;
  }
  function get$1(node, id) {
    var schedule = node.__transition;
    if (!schedule || !(schedule = schedule[id])) throw new Error("transition not found");
    return schedule;
  }

  function create(node, id, self) {
    var schedules = node.__transition,
        tween; // Initialize the self timer when the transition is created.
    // Note the actual delay is not known until the first callback!

    schedules[id] = self;
    self.timer = timer(schedule, 0, self.time);

    function schedule(elapsed) {
      self.state = SCHEDULED;
      self.timer.restart(start, self.delay, self.time); // If the elapsed delay is less than our first sleep, start immediately.

      if (self.delay <= elapsed) start(elapsed - self.delay);
    }

    function start(elapsed) {
      var i, j, n, o; // If the state is not SCHEDULED, then we previously errored on start.

      if (self.state !== SCHEDULED) return stop();

      for (i in schedules) {
        o = schedules[i];
        if (o.name !== self.name) continue; // While this element already has a starting transition during this frame,
        // defer starting an interrupting transition until that transition has a
        // chance to tick (and possibly end); see d3/d3-transition#54!

        if (o.state === STARTED) return timeout$1(start); // Interrupt the active transition, if any.

        if (o.state === RUNNING) {
          o.state = ENDED;
          o.timer.stop();
          o.on.call("interrupt", node, node.__data__, o.index, o.group);
          delete schedules[i];
        } // Cancel any pre-empted transitions.
        else if (+i < id) {
            o.state = ENDED;
            o.timer.stop();
            o.on.call("cancel", node, node.__data__, o.index, o.group);
            delete schedules[i];
          }
      } // Defer the first tick to end of the current frame; see d3/d3#1576.
      // Note the transition may be canceled after start and before the first tick!
      // Note this must be scheduled before the start event; see d3/d3-transition#16!
      // Assuming this is successful, subsequent callbacks go straight to tick.


      timeout$1(function () {
        if (self.state === STARTED) {
          self.state = RUNNING;
          self.timer.restart(tick, self.delay, self.time);
          tick(elapsed);
        }
      }); // Dispatch the start event.
      // Note this must be done before the tween are initialized.

      self.state = STARTING;
      self.on.call("start", node, node.__data__, self.index, self.group);
      if (self.state !== STARTING) return; // interrupted

      self.state = STARTED; // Initialize the tween, deleting null tween.

      tween = new Array(n = self.tween.length);

      for (i = 0, j = -1; i < n; ++i) {
        if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {
          tween[++j] = o;
        }
      }

      tween.length = j + 1;
    }

    function tick(elapsed) {
      var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),
          i = -1,
          n = tween.length;

      while (++i < n) {
        tween[i].call(node, t);
      } // Dispatch the end event.


      if (self.state === ENDING) {
        self.on.call("end", node, node.__data__, self.index, self.group);
        stop();
      }
    }

    function stop() {
      self.state = ENDED;
      self.timer.stop();
      delete schedules[id];

      for (var i in schedules) {
        return;
      } // eslint-disable-line no-unused-vars


      delete node.__transition;
    }
  }

  function interrupt (node, name) {
    var schedules = node.__transition,
        schedule,
        active,
        empty = true,
        i;
    if (!schedules) return;
    name = name == null ? null : name + "";

    for (i in schedules) {
      if ((schedule = schedules[i]).name !== name) {
        empty = false;
        continue;
      }

      active = schedule.state > STARTING && schedule.state < ENDING;
      schedule.state = ENDED;
      schedule.timer.stop();
      schedule.on.call(active ? "interrupt" : "cancel", node, node.__data__, schedule.index, schedule.group);
      delete schedules[i];
    }

    if (empty) delete node.__transition;
  }

  function selection_interrupt (name) {
    return this.each(function () {
      interrupt(this, name);
    });
  }

  function tweenRemove(id, name) {
    var tween0, tween1;
    return function () {
      var schedule = set$2(this, id),
          tween = schedule.tween; // If this node shared tween with the previous node,
      // just assign the updated shared tween and were done!
      // Otherwise, copy-on-write.

      if (tween !== tween0) {
        tween1 = tween0 = tween;

        for (var i = 0, n = tween1.length; i < n; ++i) {
          if (tween1[i].name === name) {
            tween1 = tween1.slice();
            tween1.splice(i, 1);
            break;
          }
        }
      }

      schedule.tween = tween1;
    };
  }

  function tweenFunction(id, name, value) {
    var tween0, tween1;
    if (typeof value !== "function") throw new Error();
    return function () {
      var schedule = set$2(this, id),
          tween = schedule.tween; // If this node shared tween with the previous node,
      // just assign the updated shared tween and were done!
      // Otherwise, copy-on-write.

      if (tween !== tween0) {
        tween1 = (tween0 = tween).slice();

        for (var t = {
          name: name,
          value: value
        }, i = 0, n = tween1.length; i < n; ++i) {
          if (tween1[i].name === name) {
            tween1[i] = t;
            break;
          }
        }

        if (i === n) tween1.push(t);
      }

      schedule.tween = tween1;
    };
  }

  function transition_tween (name, value) {
    var id = this._id;
    name += "";

    if (arguments.length < 2) {
      var tween = get$1(this.node(), id).tween;

      for (var i = 0, n = tween.length, t; i < n; ++i) {
        if ((t = tween[i]).name === name) {
          return t.value;
        }
      }

      return null;
    }

    return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));
  }
  function tweenValue(transition, name, value) {
    var id = transition._id;
    transition.each(function () {
      var schedule = set$2(this, id);
      (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);
    });
    return function (node) {
      return get$1(node, id).value[name];
    };
  }

  function interpolate$1 (a, b) {
    var c;
    return (typeof b === "number" ? interpolateNumber : b instanceof color ? interpolateRgb : (c = color(b)) ? (b = c, interpolateRgb) : interpolateString)(a, b);
  }

  function attrRemove$1(name) {
    return function () {
      this.removeAttribute(name);
    };
  }

  function attrRemoveNS$1(fullname) {
    return function () {
      this.removeAttributeNS(fullname.space, fullname.local);
    };
  }

  function attrConstant$1(name, interpolate, value1) {
    var string00,
        string1 = value1 + "",
        interpolate0;
    return function () {
      var string0 = this.getAttribute(name);
      return string0 === string1 ? null : string0 === string00 ? interpolate0 : interpolate0 = interpolate(string00 = string0, value1);
    };
  }

  function attrConstantNS$1(fullname, interpolate, value1) {
    var string00,
        string1 = value1 + "",
        interpolate0;
    return function () {
      var string0 = this.getAttributeNS(fullname.space, fullname.local);
      return string0 === string1 ? null : string0 === string00 ? interpolate0 : interpolate0 = interpolate(string00 = string0, value1);
    };
  }

  function attrFunction$1(name, interpolate, value) {
    var string00, string10, interpolate0;
    return function () {
      var string0,
          value1 = value(this),
          string1;
      if (value1 == null) return void this.removeAttribute(name);
      string0 = this.getAttribute(name);
      string1 = value1 + "";
      return string0 === string1 ? null : string0 === string00 && string1 === string10 ? interpolate0 : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
    };
  }

  function attrFunctionNS$1(fullname, interpolate, value) {
    var string00, string10, interpolate0;
    return function () {
      var string0,
          value1 = value(this),
          string1;
      if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);
      string0 = this.getAttributeNS(fullname.space, fullname.local);
      string1 = value1 + "";
      return string0 === string1 ? null : string0 === string00 && string1 === string10 ? interpolate0 : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
    };
  }

  function transition_attr (name, value) {
    var fullname = namespace(name),
        i = fullname === "transform" ? interpolateTransformSvg : interpolate$1;
    return this.attrTween(name, typeof value === "function" ? (fullname.local ? attrFunctionNS$1 : attrFunction$1)(fullname, i, tweenValue(this, "attr." + name, value)) : value == null ? (fullname.local ? attrRemoveNS$1 : attrRemove$1)(fullname) : (fullname.local ? attrConstantNS$1 : attrConstant$1)(fullname, i, value));
  }

  function attrInterpolate(name, i) {
    return function (t) {
      this.setAttribute(name, i(t));
    };
  }

  function attrInterpolateNS(fullname, i) {
    return function (t) {
      this.setAttributeNS(fullname.space, fullname.local, i(t));
    };
  }

  function attrTweenNS(fullname, value) {
    var t0, i0;

    function tween() {
      var i = value.apply(this, arguments);
      if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);
      return t0;
    }

    tween._value = value;
    return tween;
  }

  function attrTween(name, value) {
    var t0, i0;

    function tween() {
      var i = value.apply(this, arguments);
      if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);
      return t0;
    }

    tween._value = value;
    return tween;
  }

  function transition_attrTween (name, value) {
    var key = "attr." + name;
    if (arguments.length < 2) return (key = this.tween(key)) && key._value;
    if (value == null) return this.tween(key, null);
    if (typeof value !== "function") throw new Error();
    var fullname = namespace(name);
    return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));
  }

  function delayFunction(id, value) {
    return function () {
      init(this, id).delay = +value.apply(this, arguments);
    };
  }

  function delayConstant(id, value) {
    return value = +value, function () {
      init(this, id).delay = value;
    };
  }

  function transition_delay (value) {
    var id = this._id;
    return arguments.length ? this.each((typeof value === "function" ? delayFunction : delayConstant)(id, value)) : get$1(this.node(), id).delay;
  }

  function durationFunction(id, value) {
    return function () {
      set$2(this, id).duration = +value.apply(this, arguments);
    };
  }

  function durationConstant(id, value) {
    return value = +value, function () {
      set$2(this, id).duration = value;
    };
  }

  function transition_duration (value) {
    var id = this._id;
    return arguments.length ? this.each((typeof value === "function" ? durationFunction : durationConstant)(id, value)) : get$1(this.node(), id).duration;
  }

  function easeConstant(id, value) {
    if (typeof value !== "function") throw new Error();
    return function () {
      set$2(this, id).ease = value;
    };
  }

  function transition_ease (value) {
    var id = this._id;
    return arguments.length ? this.each(easeConstant(id, value)) : get$1(this.node(), id).ease;
  }

  function transition_filter (match) {
    if (typeof match !== "function") match = matcher(match);

    for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {
        if ((node = group[i]) && match.call(node, node.__data__, i, group)) {
          subgroup.push(node);
        }
      }
    }

    return new Transition(subgroups, this._parents, this._name, this._id);
  }

  function transition_merge (transition) {
    if (transition._id !== this._id) throw new Error();

    for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {
      for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {
        if (node = group0[i] || group1[i]) {
          merge[i] = node;
        }
      }
    }

    for (; j < m0; ++j) {
      merges[j] = groups0[j];
    }

    return new Transition(merges, this._parents, this._name, this._id);
  }

  function start(name) {
    return (name + "").trim().split(/^|\s+/).every(function (t) {
      var i = t.indexOf(".");
      if (i >= 0) t = t.slice(0, i);
      return !t || t === "start";
    });
  }

  function onFunction(id, name, listener) {
    var on0,
        on1,
        sit = start(name) ? init : set$2;
    return function () {
      var schedule = sit(this, id),
          on = schedule.on; // If this node shared a dispatch with the previous node,
      // just assign the updated shared dispatch and were done!
      // Otherwise, copy-on-write.

      if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);
      schedule.on = on1;
    };
  }

  function transition_on (name, listener) {
    var id = this._id;
    return arguments.length < 2 ? get$1(this.node(), id).on.on(name) : this.each(onFunction(id, name, listener));
  }

  function removeFunction(id) {
    return function () {
      var parent = this.parentNode;

      for (var i in this.__transition) {
        if (+i !== id) return;
      }

      if (parent) parent.removeChild(this);
    };
  }

  function transition_remove () {
    return this.on("end.remove", removeFunction(this._id));
  }

  function transition_select (select) {
    var name = this._name,
        id = this._id;
    if (typeof select !== "function") select = selector(select);

    for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {
        if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {
          if ("__data__" in node) subnode.__data__ = node.__data__;
          subgroup[i] = subnode;
          schedule(subgroup[i], name, id, i, subgroup, get$1(node, id));
        }
      }
    }

    return new Transition(subgroups, this._parents, name, id);
  }

  function transition_selectAll (select) {
    var name = this._name,
        id = this._id;
    if (typeof select !== "function") select = selectorAll(select);

    for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
        if (node = group[i]) {
          for (var children = select.call(node, node.__data__, i, group), child, inherit = get$1(node, id), k = 0, l = children.length; k < l; ++k) {
            if (child = children[k]) {
              schedule(child, name, id, k, children, inherit);
            }
          }

          subgroups.push(children);
          parents.push(node);
        }
      }
    }

    return new Transition(subgroups, parents, name, id);
  }

  var Selection$1 = selection.prototype.constructor;
  function transition_selection () {
    return new Selection$1(this._groups, this._parents);
  }

  function styleNull(name, interpolate) {
    var string00, string10, interpolate0;
    return function () {
      var string0 = styleValue(this, name),
          string1 = (this.style.removeProperty(name), styleValue(this, name));
      return string0 === string1 ? null : string0 === string00 && string1 === string10 ? interpolate0 : interpolate0 = interpolate(string00 = string0, string10 = string1);
    };
  }

  function styleRemove$1(name) {
    return function () {
      this.style.removeProperty(name);
    };
  }

  function styleConstant$1(name, interpolate, value1) {
    var string00,
        string1 = value1 + "",
        interpolate0;
    return function () {
      var string0 = styleValue(this, name);
      return string0 === string1 ? null : string0 === string00 ? interpolate0 : interpolate0 = interpolate(string00 = string0, value1);
    };
  }

  function styleFunction$1(name, interpolate, value) {
    var string00, string10, interpolate0;
    return function () {
      var string0 = styleValue(this, name),
          value1 = value(this),
          string1 = value1 + "";
      if (value1 == null) string1 = value1 = (this.style.removeProperty(name), styleValue(this, name));
      return string0 === string1 ? null : string0 === string00 && string1 === string10 ? interpolate0 : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
    };
  }

  function styleMaybeRemove(id, name) {
    var on0,
        on1,
        listener0,
        key = "style." + name,
        event = "end." + key,
        remove;
    return function () {
      var schedule = set$2(this, id),
          on = schedule.on,
          listener = schedule.value[key] == null ? remove || (remove = styleRemove$1(name)) : undefined; // If this node shared a dispatch with the previous node,
      // just assign the updated shared dispatch and were done!
      // Otherwise, copy-on-write.

      if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);
      schedule.on = on1;
    };
  }

  function transition_style (name, value, priority) {
    var i = (name += "") === "transform" ? interpolateTransformCss : interpolate$1;
    return value == null ? this.styleTween(name, styleNull(name, i)).on("end.style." + name, styleRemove$1(name)) : typeof value === "function" ? this.styleTween(name, styleFunction$1(name, i, tweenValue(this, "style." + name, value))).each(styleMaybeRemove(this._id, name)) : this.styleTween(name, styleConstant$1(name, i, value), priority).on("end.style." + name, null);
  }

  function styleInterpolate(name, i, priority) {
    return function (t) {
      this.style.setProperty(name, i(t), priority);
    };
  }

  function styleTween(name, value, priority) {
    var t, i0;

    function tween() {
      var i = value.apply(this, arguments);
      if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);
      return t;
    }

    tween._value = value;
    return tween;
  }

  function transition_styleTween (name, value, priority) {
    var key = "style." + (name += "");
    if (arguments.length < 2) return (key = this.tween(key)) && key._value;
    if (value == null) return this.tween(key, null);
    if (typeof value !== "function") throw new Error();
    return this.tween(key, styleTween(name, value, priority == null ? "" : priority));
  }

  function textConstant$1(value) {
    return function () {
      this.textContent = value;
    };
  }

  function textFunction$1(value) {
    return function () {
      var value1 = value(this);
      this.textContent = value1 == null ? "" : value1;
    };
  }

  function transition_text (value) {
    return this.tween("text", typeof value === "function" ? textFunction$1(tweenValue(this, "text", value)) : textConstant$1(value == null ? "" : value + ""));
  }

  function transition_transition () {
    var name = this._name,
        id0 = this._id,
        id1 = newId();

    for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
        if (node = group[i]) {
          var inherit = get$1(node, id0);
          schedule(node, name, id1, i, group, {
            time: inherit.time + inherit.delay + inherit.duration,
            delay: 0,
            duration: inherit.duration,
            ease: inherit.ease
          });
        }
      }
    }

    return new Transition(groups, this._parents, name, id1);
  }

  function transition_end () {
    var on0,
        on1,
        that = this,
        id = that._id,
        size = that.size();
    return new Promise(function (resolve, reject) {
      var cancel = {
        value: reject
      },
          end = {
        value: function value() {
          if (--size === 0) resolve();
        }
      };
      that.each(function () {
        var schedule = set$2(this, id),
            on = schedule.on; // If this node shared a dispatch with the previous node,
        // just assign the updated shared dispatch and were done!
        // Otherwise, copy-on-write.

        if (on !== on0) {
          on1 = (on0 = on).copy();

          on1._.cancel.push(cancel);

          on1._.interrupt.push(cancel);

          on1._.end.push(end);
        }

        schedule.on = on1;
      });
    });
  }

  var id = 0;
  function Transition(groups, parents, name, id) {
    this._groups = groups;
    this._parents = parents;
    this._name = name;
    this._id = id;
  }
  function transition(name) {
    return selection().transition(name);
  }
  function newId() {
    return ++id;
  }
  var selection_prototype = selection.prototype;
  Transition.prototype = transition.prototype = {
    constructor: Transition,
    select: transition_select,
    selectAll: transition_selectAll,
    filter: transition_filter,
    merge: transition_merge,
    selection: transition_selection,
    transition: transition_transition,
    call: selection_prototype.call,
    nodes: selection_prototype.nodes,
    node: selection_prototype.node,
    size: selection_prototype.size,
    empty: selection_prototype.empty,
    each: selection_prototype.each,
    on: transition_on,
    attr: transition_attr,
    attrTween: transition_attrTween,
    style: transition_style,
    styleTween: transition_styleTween,
    text: transition_text,
    remove: transition_remove,
    tween: transition_tween,
    delay: transition_delay,
    duration: transition_duration,
    ease: transition_ease,
    end: transition_end
  };

  function cubicInOut(t) {
    return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;
  }

  var defaultTiming = {
    time: null,
    // Set on use.
    delay: 0,
    duration: 250,
    ease: cubicInOut
  };

  function inherit(node, id) {
    var timing;

    while (!(timing = node.__transition) || !(timing = timing[id])) {
      if (!(node = node.parentNode)) {
        return defaultTiming.time = now(), defaultTiming;
      }
    }

    return timing;
  }

  function selection_transition (name) {
    var id, timing;

    if (name instanceof Transition) {
      id = name._id, name = name._name;
    } else {
      id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + "";
    }

    for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {
      for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
        if (node = group[i]) {
          schedule(node, name, id, i, group, timing || inherit(node, id));
        }
      }
    }

    return new Transition(groups, this._parents, name, id);
  }

  selection.prototype.interrupt = selection_interrupt;
  selection.prototype.transition = selection_transition;

  /**
      @function accessor
      @desc Wraps an object key in a simple accessor function.
      @param {String} key The key to be returned from each Object passed to the function.
      @param {*} [def] A default value to be returned if the key is not present.
      @example <caption>this</caption>
  accessor("id");
      @example <caption>returns this</caption>
  function(d) {
    return d["id"];
  }
  */
  function accessor (key, def) {
    if (def === void 0) return function (d) {
      return d[key];
    };
    return function (d) {
      return d[key] === void 0 ? def : d[key];
    };
  }

  function _typeof$1(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$1 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$1 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$1(obj);
  }
  /**
      @function isObject
      @desc Detects if a variable is a javascript Object.
      @param {*} item
  */


  function isObject (item) {
    return item && _typeof$1(item) === "object" && (typeof window === "undefined" || item !== window && item !== window.document && !(item instanceof Element)) && !Array.isArray(item) ? true : false;
  }

  /**
      @function validObject
      @desc Determines if the object passed is the document or window.
      @param {Object} obj
      @private
  */

  function validObject(obj) {
    if (typeof window === "undefined") return true;else return obj !== window && obj !== document;
  }
  /**
      @function assign
      @desc A deeply recursive version of `Object.assign`.
      @param {...Object} objects
      @example <caption>this</caption>
  assign({id: "foo", deep: {group: "A"}}, {id: "bar", deep: {value: 20}}));
      @example <caption>returns this</caption>
  {id: "bar", deep: {group: "A", value: 20}}
  */


  function assign() {
    var _arguments = arguments;
    var target = arguments.length <= 0 ? undefined : arguments[0];

    var _loop = function _loop(i) {
      var source = i < 0 || _arguments.length <= i ? undefined : _arguments[i];
      Object.keys(source).forEach(function (prop) {
        var value = source[prop];

        if (isObject(value) && validObject(value)) {
          if (target.hasOwnProperty(prop) && isObject(target[prop])) target[prop] = assign({}, target[prop], value);else target[prop] = assign({}, value);
        } else if (Array.isArray(value)) target[prop] = value.slice();else target[prop] = value;
      });
    };

    for (var i = 1; i < arguments.length; i++) {
      _loop(i);
    }

    return target;
  }

  /**
      @function attrize
      @desc Applies each key/value in an object as an attr.
      @param {D3selection} elem The D3 element to apply the styles to.
      @param {Object} attrs An object of key/value attr pairs.
  */
  function attrize (e) {
    var a = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    for (var k in a) {
      if ({}.hasOwnProperty.call(a, k)) e.attr(k, a[k]);
    }
  }

  var aa = {
  	language: "Afar",
  	location: null,
  	id: 4096,
  	tag: "aa",
  	version: "Release 10"
  };
  var af = {
  	language: "Afrikaans",
  	location: null,
  	id: 54,
  	tag: "af",
  	version: "Release 7"
  };
  var agq = {
  	language: "Aghem",
  	location: null,
  	id: 4096,
  	tag: "agq",
  	version: "Release 10"
  };
  var ak = {
  	language: "Akan",
  	location: null,
  	id: 4096,
  	tag: "ak",
  	version: "Release 10"
  };
  var sq = {
  	language: "Albanian",
  	location: null,
  	id: 28,
  	tag: "sq",
  	version: "Release 7"
  };
  var gsw = {
  	language: "Alsatian",
  	location: null,
  	id: 132,
  	tag: "gsw",
  	version: "Release 7"
  };
  var am = {
  	language: "Amharic",
  	location: null,
  	id: 94,
  	tag: "am",
  	version: "Release 7"
  };
  var ar = {
  	language: "Arabic",
  	location: null,
  	id: 1,
  	tag: "ar",
  	version: "Release 7"
  };
  var hy = {
  	language: "Armenian",
  	location: null,
  	id: 43,
  	tag: "hy",
  	version: "Release 7"
  };
  var as = {
  	language: "Assamese",
  	location: null,
  	id: 77,
  	tag: "as",
  	version: "Release 7"
  };
  var ast = {
  	language: "Asturian",
  	location: null,
  	id: 4096,
  	tag: "ast",
  	version: "Release 10"
  };
  var asa = {
  	language: "Asu",
  	location: null,
  	id: 4096,
  	tag: "asa",
  	version: "Release 10"
  };
  var az = {
  	language: "Azerbaijani (Latin)",
  	location: null,
  	id: 44,
  	tag: "az",
  	version: "Release 7"
  };
  var ksf = {
  	language: "Bafia",
  	location: null,
  	id: 4096,
  	tag: "ksf",
  	version: "Release 10"
  };
  var bm = {
  	language: "Bamanankan",
  	location: null,
  	id: 4096,
  	tag: "bm",
  	version: "Release 10"
  };
  var bn = {
  	language: "Bangla",
  	location: null,
  	id: 69,
  	tag: "bn",
  	version: "Release 7"
  };
  var bas = {
  	language: "Basaa",
  	location: null,
  	id: 4096,
  	tag: "bas",
  	version: "Release 10"
  };
  var ba = {
  	language: "Bashkir",
  	location: null,
  	id: 109,
  	tag: "ba",
  	version: "Release 7"
  };
  var eu = {
  	language: "Basque",
  	location: null,
  	id: 45,
  	tag: "eu",
  	version: "Release 7"
  };
  var be = {
  	language: "Belarusian",
  	location: null,
  	id: 35,
  	tag: "be",
  	version: "Release 7"
  };
  var bem = {
  	language: "Bemba",
  	location: null,
  	id: 4096,
  	tag: "bem",
  	version: "Release 10"
  };
  var bez = {
  	language: "Bena",
  	location: null,
  	id: 4096,
  	tag: "bez",
  	version: "Release 10"
  };
  var byn = {
  	language: "Blin",
  	location: null,
  	id: 4096,
  	tag: "byn",
  	version: "Release 10"
  };
  var brx = {
  	language: "Bodo",
  	location: null,
  	id: 4096,
  	tag: "brx",
  	version: "Release 10"
  };
  var bs = {
  	language: "Bosnian (Latin)",
  	location: null,
  	id: 30746,
  	tag: "bs",
  	version: "Release 7"
  };
  var br = {
  	language: "Breton",
  	location: null,
  	id: 126,
  	tag: "br",
  	version: "Release 7"
  };
  var bg = {
  	language: "Bulgarian",
  	location: null,
  	id: 2,
  	tag: "bg",
  	version: "Release 7"
  };
  var my = {
  	language: "Burmese",
  	location: null,
  	id: 85,
  	tag: "my",
  	version: "Release 8.1"
  };
  var ca = {
  	language: "Catalan",
  	location: null,
  	id: 3,
  	tag: "ca",
  	version: "Release 7"
  };
  var ku = {
  	language: "Central Kurdish",
  	location: null,
  	id: 146,
  	tag: "ku",
  	version: "Release 8"
  };
  var chr = {
  	language: "Cherokee",
  	location: null,
  	id: 92,
  	tag: "chr",
  	version: "Release 8"
  };
  var cgg = {
  	language: "Chiga",
  	location: null,
  	id: 4096,
  	tag: "cgg",
  	version: "Release 10"
  };
  var zh = {
  	language: "Chinese (Simplified)",
  	location: null,
  	id: 30724,
  	tag: "zh",
  	version: "Windows 7"
  };
  var swc = {
  	language: "Congo Swahili",
  	location: null,
  	id: 4096,
  	tag: "swc",
  	version: "Release 10"
  };
  var kw = {
  	language: "Cornish",
  	location: null,
  	id: 4096,
  	tag: "kw",
  	version: "Release 10"
  };
  var co = {
  	language: "Corsican",
  	location: null,
  	id: 131,
  	tag: "co",
  	version: "Release 7"
  };
  var cs = {
  	language: "Czech",
  	location: null,
  	id: 5,
  	tag: "cs",
  	version: "Release 7"
  };
  var da = {
  	language: "Danish",
  	location: null,
  	id: 6,
  	tag: "da",
  	version: "Release 7"
  };
  var prs = {
  	language: "Dari",
  	location: null,
  	id: 140,
  	tag: "prs",
  	version: "Release 7"
  };
  var dv = {
  	language: "Divehi",
  	location: null,
  	id: 101,
  	tag: "dv",
  	version: "Release 7"
  };
  var dua = {
  	language: "Duala",
  	location: null,
  	id: 4096,
  	tag: "dua",
  	version: "Release 10"
  };
  var nl = {
  	language: "Dutch",
  	location: null,
  	id: 19,
  	tag: "nl",
  	version: "Release 7"
  };
  var dz = {
  	language: "Dzongkha",
  	location: null,
  	id: 4096,
  	tag: "dz",
  	version: "Release 10"
  };
  var ebu = {
  	language: "Embu",
  	location: null,
  	id: 4096,
  	tag: "ebu",
  	version: "Release 10"
  };
  var en = {
  	language: "English",
  	location: null,
  	id: 9,
  	tag: "en",
  	version: "Release 7"
  };
  var eo = {
  	language: "Esperanto",
  	location: null,
  	id: 4096,
  	tag: "eo",
  	version: "Release 10"
  };
  var et = {
  	language: "Estonian",
  	location: null,
  	id: 37,
  	tag: "et",
  	version: "Release 7"
  };
  var ee = {
  	language: "Ewe",
  	location: null,
  	id: 4096,
  	tag: "ee",
  	version: "Release 10"
  };
  var ewo = {
  	language: "Ewondo",
  	location: null,
  	id: 4096,
  	tag: "ewo",
  	version: "Release 10"
  };
  var fo = {
  	language: "Faroese",
  	location: null,
  	id: 56,
  	tag: "fo",
  	version: "Release 7"
  };
  var fil = {
  	language: "Filipino",
  	location: null,
  	id: 100,
  	tag: "fil",
  	version: "Release 7"
  };
  var fi = {
  	language: "Finnish",
  	location: null,
  	id: 11,
  	tag: "fi",
  	version: "Release 7"
  };
  var fr = {
  	language: "French",
  	location: null,
  	id: 12,
  	tag: "fr",
  	version: "Release 7"
  };
  var fy = {
  	language: "Frisian",
  	location: null,
  	id: 98,
  	tag: "fy",
  	version: "Release 7"
  };
  var fur = {
  	language: "Friulian",
  	location: null,
  	id: 4096,
  	tag: "fur",
  	version: "Release 10"
  };
  var ff = {
  	language: "Fulah",
  	location: null,
  	id: 103,
  	tag: "ff",
  	version: "Release 8"
  };
  var gl = {
  	language: "Galician",
  	location: null,
  	id: 86,
  	tag: "gl",
  	version: "Release 7"
  };
  var lg = {
  	language: "Ganda",
  	location: null,
  	id: 4096,
  	tag: "lg",
  	version: "Release 10"
  };
  var ka = {
  	language: "Georgian",
  	location: null,
  	id: 55,
  	tag: "ka",
  	version: "Release 7"
  };
  var de = {
  	language: "German",
  	location: null,
  	id: 7,
  	tag: "de",
  	version: "Release 7"
  };
  var el = {
  	language: "Greek",
  	location: null,
  	id: 8,
  	tag: "el",
  	version: "Release 7"
  };
  var kl = {
  	language: "Greenlandic",
  	location: null,
  	id: 111,
  	tag: "kl",
  	version: "Release 7"
  };
  var gn = {
  	language: "Guarani",
  	location: null,
  	id: 116,
  	tag: "gn",
  	version: "Release 8.1"
  };
  var gu = {
  	language: "Gujarati",
  	location: null,
  	id: 71,
  	tag: "gu",
  	version: "Release 7"
  };
  var guz = {
  	language: "Gusii",
  	location: null,
  	id: 4096,
  	tag: "guz",
  	version: "Release 10"
  };
  var ha = {
  	language: "Hausa (Latin)",
  	location: null,
  	id: 104,
  	tag: "ha",
  	version: "Release 7"
  };
  var haw = {
  	language: "Hawaiian",
  	location: null,
  	id: 117,
  	tag: "haw",
  	version: "Release 8"
  };
  var he = {
  	language: "Hebrew",
  	location: null,
  	id: 13,
  	tag: "he",
  	version: "Release 7"
  };
  var hi = {
  	language: "Hindi",
  	location: null,
  	id: 57,
  	tag: "hi",
  	version: "Release 7"
  };
  var hu = {
  	language: "Hungarian",
  	location: null,
  	id: 14,
  	tag: "hu",
  	version: "Release 7"
  };
  var is = {
  	language: "Icelandic",
  	location: null,
  	id: 15,
  	tag: "is",
  	version: "Release 7"
  };
  var ig = {
  	language: "Igbo",
  	location: null,
  	id: 112,
  	tag: "ig",
  	version: "Release 7"
  };
  var id$1 = {
  	language: "Indonesian",
  	location: null,
  	id: 33,
  	tag: "id",
  	version: "Release 7"
  };
  var ia = {
  	language: "Interlingua",
  	location: null,
  	id: 4096,
  	tag: "ia",
  	version: "Release 10"
  };
  var iu = {
  	language: "Inuktitut (Latin)",
  	location: null,
  	id: 93,
  	tag: "iu",
  	version: "Release 7"
  };
  var ga = {
  	language: "Irish",
  	location: null,
  	id: 60,
  	tag: "ga",
  	version: "Windows 7"
  };
  var it = {
  	language: "Italian",
  	location: null,
  	id: 16,
  	tag: "it",
  	version: "Release 7"
  };
  var ja = {
  	language: "Japanese",
  	location: null,
  	id: 17,
  	tag: "ja",
  	version: "Release 7"
  };
  var jv = {
  	language: "Javanese",
  	location: null,
  	id: 4096,
  	tag: "jv",
  	version: "Release 8.1"
  };
  var dyo = {
  	language: "Jola-Fonyi",
  	location: null,
  	id: 4096,
  	tag: "dyo",
  	version: "Release 10"
  };
  var kea = {
  	language: "Kabuverdianu",
  	location: null,
  	id: 4096,
  	tag: "kea",
  	version: "Release 10"
  };
  var kab = {
  	language: "Kabyle",
  	location: null,
  	id: 4096,
  	tag: "kab",
  	version: "Release 10"
  };
  var kkj = {
  	language: "Kako",
  	location: null,
  	id: 4096,
  	tag: "kkj",
  	version: "Release 10"
  };
  var kln = {
  	language: "Kalenjin",
  	location: null,
  	id: 4096,
  	tag: "kln",
  	version: "Release 10"
  };
  var kam = {
  	language: "Kamba",
  	location: null,
  	id: 4096,
  	tag: "kam",
  	version: "Release 10"
  };
  var kn = {
  	language: "Kannada",
  	location: null,
  	id: 75,
  	tag: "kn",
  	version: "Release 7"
  };
  var ks = {
  	language: "Kashmiri",
  	location: null,
  	id: 96,
  	tag: "ks",
  	version: "Release 10"
  };
  var kk = {
  	language: "Kazakh",
  	location: null,
  	id: 63,
  	tag: "kk",
  	version: "Release 7"
  };
  var km = {
  	language: "Khmer",
  	location: null,
  	id: 83,
  	tag: "km",
  	version: "Release 7"
  };
  var quc = {
  	language: "K'iche",
  	location: null,
  	id: 134,
  	tag: "quc",
  	version: "Release 10"
  };
  var ki = {
  	language: "Kikuyu",
  	location: null,
  	id: 4096,
  	tag: "ki",
  	version: "Release 10"
  };
  var rw = {
  	language: "Kinyarwanda",
  	location: null,
  	id: 135,
  	tag: "rw",
  	version: "Release 7"
  };
  var sw = {
  	language: "Kiswahili",
  	location: null,
  	id: 65,
  	tag: "sw",
  	version: "Release 7"
  };
  var kok = {
  	language: "Konkani",
  	location: null,
  	id: 87,
  	tag: "kok",
  	version: "Release 7"
  };
  var ko = {
  	language: "Korean",
  	location: null,
  	id: 18,
  	tag: "ko",
  	version: "Release 7"
  };
  var khq = {
  	language: "Koyra Chiini",
  	location: null,
  	id: 4096,
  	tag: "khq",
  	version: "Release 10"
  };
  var ses = {
  	language: "Koyraboro Senni",
  	location: null,
  	id: 4096,
  	tag: "ses",
  	version: "Release 10"
  };
  var nmg = {
  	language: "Kwasio",
  	location: null,
  	id: 4096,
  	tag: "nmg",
  	version: "Release 10"
  };
  var ky = {
  	language: "Kyrgyz",
  	location: null,
  	id: 64,
  	tag: "ky",
  	version: "Release 7"
  };
  var lkt = {
  	language: "Lakota",
  	location: null,
  	id: 4096,
  	tag: "lkt",
  	version: "Release 10"
  };
  var lag = {
  	language: "Langi",
  	location: null,
  	id: 4096,
  	tag: "lag",
  	version: "Release 10"
  };
  var lo = {
  	language: "Lao",
  	location: null,
  	id: 84,
  	tag: "lo",
  	version: "Release 7"
  };
  var lv = {
  	language: "Latvian",
  	location: null,
  	id: 38,
  	tag: "lv",
  	version: "Release 7"
  };
  var ln = {
  	language: "Lingala",
  	location: null,
  	id: 4096,
  	tag: "ln",
  	version: "Release 10"
  };
  var lt = {
  	language: "Lithuanian",
  	location: null,
  	id: 39,
  	tag: "lt",
  	version: "Release 7"
  };
  var nds = {
  	language: "Low German",
  	location: null,
  	id: 4096,
  	tag: "nds",
  	version: "Release 10.2"
  };
  var dsb = {
  	language: "Lower Sorbian",
  	location: null,
  	id: 31790,
  	tag: "dsb",
  	version: "Windows 7"
  };
  var lu = {
  	language: "Luba-Katanga",
  	location: null,
  	id: 4096,
  	tag: "lu",
  	version: "Release 10"
  };
  var luo = {
  	language: "Luo",
  	location: null,
  	id: 4096,
  	tag: "luo",
  	version: "Release 10"
  };
  var lb = {
  	language: "Luxembourgish",
  	location: null,
  	id: 110,
  	tag: "lb",
  	version: "Release 7"
  };
  var luy = {
  	language: "Luyia",
  	location: null,
  	id: 4096,
  	tag: "luy",
  	version: "Release 10"
  };
  var mk = {
  	language: "Macedonian",
  	location: null,
  	id: 47,
  	tag: "mk",
  	version: "Release 7"
  };
  var jmc = {
  	language: "Machame",
  	location: null,
  	id: 4096,
  	tag: "jmc",
  	version: "Release 10"
  };
  var mgh = {
  	language: "Makhuwa-Meetto",
  	location: null,
  	id: 4096,
  	tag: "mgh",
  	version: "Release 10"
  };
  var kde = {
  	language: "Makonde",
  	location: null,
  	id: 4096,
  	tag: "kde",
  	version: "Release 10"
  };
  var mg = {
  	language: "Malagasy",
  	location: null,
  	id: 4096,
  	tag: "mg",
  	version: "Release 8.1"
  };
  var ms = {
  	language: "Malay",
  	location: null,
  	id: 62,
  	tag: "ms",
  	version: "Release 7"
  };
  var ml = {
  	language: "Malayalam",
  	location: null,
  	id: 76,
  	tag: "ml",
  	version: "Release 7"
  };
  var mt = {
  	language: "Maltese",
  	location: null,
  	id: 58,
  	tag: "mt",
  	version: "Release 7"
  };
  var gv = {
  	language: "Manx",
  	location: null,
  	id: 4096,
  	tag: "gv",
  	version: "Release 10"
  };
  var mi = {
  	language: "Maori",
  	location: null,
  	id: 129,
  	tag: "mi",
  	version: "Release 7"
  };
  var arn = {
  	language: "Mapudungun",
  	location: null,
  	id: 122,
  	tag: "arn",
  	version: "Release 7"
  };
  var mr = {
  	language: "Marathi",
  	location: null,
  	id: 78,
  	tag: "mr",
  	version: "Release 7"
  };
  var mas = {
  	language: "Masai",
  	location: null,
  	id: 4096,
  	tag: "mas",
  	version: "Release 10"
  };
  var mer = {
  	language: "Meru",
  	location: null,
  	id: 4096,
  	tag: "mer",
  	version: "Release 10"
  };
  var mgo = {
  	language: "Meta'",
  	location: null,
  	id: 4096,
  	tag: "mgo",
  	version: "Release 10"
  };
  var moh = {
  	language: "Mohawk",
  	location: null,
  	id: 124,
  	tag: "moh",
  	version: "Release 7"
  };
  var mn = {
  	language: "Mongolian (Cyrillic)",
  	location: null,
  	id: 80,
  	tag: "mn",
  	version: "Release 7"
  };
  var mfe = {
  	language: "Morisyen",
  	location: null,
  	id: 4096,
  	tag: "mfe",
  	version: "Release 10"
  };
  var mua = {
  	language: "Mundang",
  	location: null,
  	id: 4096,
  	tag: "mua",
  	version: "Release 10"
  };
  var nqo = {
  	language: "N'ko",
  	location: null,
  	id: 4096,
  	tag: "nqo",
  	version: "Release 8.1"
  };
  var naq = {
  	language: "Nama",
  	location: null,
  	id: 4096,
  	tag: "naq",
  	version: "Release 10"
  };
  var ne = {
  	language: "Nepali",
  	location: null,
  	id: 97,
  	tag: "ne",
  	version: "Release 7"
  };
  var nnh = {
  	language: "Ngiemboon",
  	location: null,
  	id: 4096,
  	tag: "nnh",
  	version: "Release 10"
  };
  var jgo = {
  	language: "Ngomba",
  	location: null,
  	id: 4096,
  	tag: "jgo",
  	version: "Release 10"
  };
  var nd = {
  	language: "North Ndebele",
  	location: null,
  	id: 4096,
  	tag: "nd",
  	version: "Release 10"
  };
  var no = {
  	language: "Norwegian (Bokmal)",
  	location: null,
  	id: 20,
  	tag: "no",
  	version: "Release 7"
  };
  var nb = {
  	language: "Norwegian (Bokmal)",
  	location: null,
  	id: 31764,
  	tag: "nb",
  	version: "Release 7"
  };
  var nn = {
  	language: "Norwegian (Nynorsk)",
  	location: null,
  	id: 30740,
  	tag: "nn",
  	version: "Release 7"
  };
  var nus = {
  	language: "Nuer",
  	location: null,
  	id: 4096,
  	tag: "nus",
  	version: "Release 10"
  };
  var nyn = {
  	language: "Nyankole",
  	location: null,
  	id: 4096,
  	tag: "nyn",
  	version: "Release 10"
  };
  var oc = {
  	language: "Occitan",
  	location: null,
  	id: 130,
  	tag: "oc",
  	version: "Release 7"
  };
  var or = {
  	language: "Odia",
  	location: null,
  	id: 72,
  	tag: "or",
  	version: "Release 7"
  };
  var om = {
  	language: "Oromo",
  	location: null,
  	id: 114,
  	tag: "om",
  	version: "Release 8.1"
  };
  var os = {
  	language: "Ossetian",
  	location: null,
  	id: 4096,
  	tag: "os",
  	version: "Release 10"
  };
  var ps = {
  	language: "Pashto",
  	location: null,
  	id: 99,
  	tag: "ps",
  	version: "Release 7"
  };
  var fa = {
  	language: "Persian",
  	location: null,
  	id: 41,
  	tag: "fa",
  	version: "Release 7"
  };
  var pl = {
  	language: "Polish",
  	location: null,
  	id: 21,
  	tag: "pl",
  	version: "Release 7"
  };
  var pt = {
  	language: "Portuguese",
  	location: null,
  	id: 22,
  	tag: "pt",
  	version: "Release 7"
  };
  var pa = {
  	language: "Punjabi",
  	location: null,
  	id: 70,
  	tag: "pa",
  	version: "Release 7"
  };
  var quz = {
  	language: "Quechua",
  	location: null,
  	id: 107,
  	tag: "quz",
  	version: "Release 7"
  };
  var ksh = {
  	language: "Ripuarian",
  	location: null,
  	id: 4096,
  	tag: "ksh",
  	version: "Release 10"
  };
  var ro = {
  	language: "Romanian",
  	location: null,
  	id: 24,
  	tag: "ro",
  	version: "Release 7"
  };
  var rm = {
  	language: "Romansh",
  	location: null,
  	id: 23,
  	tag: "rm",
  	version: "Release 7"
  };
  var rof = {
  	language: "Rombo",
  	location: null,
  	id: 4096,
  	tag: "rof",
  	version: "Release 10"
  };
  var rn = {
  	language: "Rundi",
  	location: null,
  	id: 4096,
  	tag: "rn",
  	version: "Release 10"
  };
  var ru = {
  	language: "Russian",
  	location: null,
  	id: 25,
  	tag: "ru",
  	version: "Release 7"
  };
  var rwk = {
  	language: "Rwa",
  	location: null,
  	id: 4096,
  	tag: "rwk",
  	version: "Release 10"
  };
  var ssy = {
  	language: "Saho",
  	location: null,
  	id: 4096,
  	tag: "ssy",
  	version: "Release 10"
  };
  var sah = {
  	language: "Sakha",
  	location: null,
  	id: 133,
  	tag: "sah",
  	version: "Release 7"
  };
  var saq = {
  	language: "Samburu",
  	location: null,
  	id: 4096,
  	tag: "saq",
  	version: "Release 10"
  };
  var smn = {
  	language: "Sami (Inari)",
  	location: null,
  	id: 28731,
  	tag: "smn",
  	version: "Windows 7"
  };
  var smj = {
  	language: "Sami (Lule)",
  	location: null,
  	id: 31803,
  	tag: "smj",
  	version: "Windows 7"
  };
  var se = {
  	language: "Sami (Northern)",
  	location: null,
  	id: 59,
  	tag: "se",
  	version: "Release 7"
  };
  var sms = {
  	language: "Sami (Skolt)",
  	location: null,
  	id: 29755,
  	tag: "sms",
  	version: "Windows 7"
  };
  var sma = {
  	language: "Sami (Southern)",
  	location: null,
  	id: 30779,
  	tag: "sma",
  	version: "Windows 7"
  };
  var sg = {
  	language: "Sango",
  	location: null,
  	id: 4096,
  	tag: "sg",
  	version: "Release 10"
  };
  var sbp = {
  	language: "Sangu",
  	location: null,
  	id: 4096,
  	tag: "sbp",
  	version: "Release 10"
  };
  var sa = {
  	language: "Sanskrit",
  	location: null,
  	id: 79,
  	tag: "sa",
  	version: "Release 7"
  };
  var gd = {
  	language: "Scottish Gaelic",
  	location: null,
  	id: 145,
  	tag: "gd",
  	version: "Windows 7"
  };
  var seh = {
  	language: "Sena",
  	location: null,
  	id: 4096,
  	tag: "seh",
  	version: "Release 10"
  };
  var sr = {
  	language: "Serbian (Latin)",
  	location: null,
  	id: 31770,
  	tag: "sr",
  	version: "Release 7"
  };
  var nso = {
  	language: "Sesotho sa Leboa",
  	location: null,
  	id: 108,
  	tag: "nso",
  	version: "Release 7"
  };
  var tn = {
  	language: "Setswana",
  	location: null,
  	id: 50,
  	tag: "tn",
  	version: "Release 7"
  };
  var ksb = {
  	language: "Shambala",
  	location: null,
  	id: 4096,
  	tag: "ksb",
  	version: "Release 10"
  };
  var sn = {
  	language: "Shona",
  	location: null,
  	id: 4096,
  	tag: "sn",
  	version: "Release 8.1"
  };
  var sd = {
  	language: "Sindhi",
  	location: null,
  	id: 89,
  	tag: "sd",
  	version: "Release 8"
  };
  var si = {
  	language: "Sinhala",
  	location: null,
  	id: 91,
  	tag: "si",
  	version: "Release 7"
  };
  var sk = {
  	language: "Slovak",
  	location: null,
  	id: 27,
  	tag: "sk",
  	version: "Release 7"
  };
  var sl = {
  	language: "Slovenian",
  	location: null,
  	id: 36,
  	tag: "sl",
  	version: "Release 7"
  };
  var xog = {
  	language: "Soga",
  	location: null,
  	id: 4096,
  	tag: "xog",
  	version: "Release 10"
  };
  var so = {
  	language: "Somali",
  	location: null,
  	id: 119,
  	tag: "so",
  	version: "Release 8.1"
  };
  var st = {
  	language: "Sotho",
  	location: null,
  	id: 48,
  	tag: "st",
  	version: "Release 8.1"
  };
  var nr = {
  	language: "South Ndebele",
  	location: null,
  	id: 4096,
  	tag: "nr",
  	version: "Release 10"
  };
  var es = {
  	language: "Spanish",
  	location: null,
  	id: 10,
  	tag: "es",
  	version: "Release 7"
  };
  var zgh = {
  	language: "Standard Moroccan ",
  	location: null,
  	id: 4096,
  	tag: "zgh",
  	version: "Release 8.1"
  };
  var ss = {
  	language: "Swati",
  	location: null,
  	id: 4096,
  	tag: "ss",
  	version: "Release 10"
  };
  var sv = {
  	language: "Swedish",
  	location: null,
  	id: 29,
  	tag: "sv",
  	version: "Release 7"
  };
  var syr = {
  	language: "Syriac",
  	location: null,
  	id: 90,
  	tag: "syr",
  	version: "Release 7"
  };
  var shi = {
  	language: "Tachelhit",
  	location: null,
  	id: 4096,
  	tag: "shi",
  	version: "Release 10"
  };
  var dav = {
  	language: "Taita",
  	location: null,
  	id: 4096,
  	tag: "dav",
  	version: "Release 10"
  };
  var tg = {
  	language: "Tajik (Cyrillic)",
  	location: null,
  	id: 40,
  	tag: "tg",
  	version: "Release 7"
  };
  var tzm = {
  	language: "Tamazight (Latin)",
  	location: null,
  	id: 95,
  	tag: "tzm",
  	version: "Release 7"
  };
  var ta = {
  	language: "Tamil",
  	location: null,
  	id: 73,
  	tag: "ta",
  	version: "Release 7"
  };
  var twq = {
  	language: "Tasawaq",
  	location: null,
  	id: 4096,
  	tag: "twq",
  	version: "Release 10"
  };
  var tt = {
  	language: "Tatar",
  	location: null,
  	id: 68,
  	tag: "tt",
  	version: "Release 7"
  };
  var te = {
  	language: "Telugu",
  	location: null,
  	id: 74,
  	tag: "te",
  	version: "Release 7"
  };
  var teo = {
  	language: "Teso",
  	location: null,
  	id: 4096,
  	tag: "teo",
  	version: "Release 10"
  };
  var th = {
  	language: "Thai",
  	location: null,
  	id: 30,
  	tag: "th",
  	version: "Release 7"
  };
  var bo = {
  	language: "Tibetan",
  	location: null,
  	id: 81,
  	tag: "bo",
  	version: "Release 7"
  };
  var tig = {
  	language: "Tigre",
  	location: null,
  	id: 4096,
  	tag: "tig",
  	version: "Release 10"
  };
  var ti = {
  	language: "Tigrinya",
  	location: null,
  	id: 115,
  	tag: "ti",
  	version: "Release 8"
  };
  var to = {
  	language: "Tongan",
  	location: null,
  	id: 4096,
  	tag: "to",
  	version: "Release 10"
  };
  var ts = {
  	language: "Tsonga",
  	location: null,
  	id: 49,
  	tag: "ts",
  	version: "Release 8.1"
  };
  var tr = {
  	language: "Turkish",
  	location: null,
  	id: 31,
  	tag: "tr",
  	version: "Release 7"
  };
  var tk = {
  	language: "Turkmen",
  	location: null,
  	id: 66,
  	tag: "tk",
  	version: "Release 7"
  };
  var uk = {
  	language: "Ukrainian",
  	location: null,
  	id: 34,
  	tag: "uk",
  	version: "Release 7"
  };
  var hsb = {
  	language: "Upper Sorbian",
  	location: null,
  	id: 46,
  	tag: "hsb",
  	version: "Release 7"
  };
  var ur = {
  	language: "Urdu",
  	location: null,
  	id: 32,
  	tag: "ur",
  	version: "Release 7"
  };
  var ug = {
  	language: "Uyghur",
  	location: null,
  	id: 128,
  	tag: "ug",
  	version: "Release 7"
  };
  var uz = {
  	language: "Uzbek (Latin)",
  	location: null,
  	id: 67,
  	tag: "uz",
  	version: "Release 7"
  };
  var vai = {
  	language: "Vai",
  	location: null,
  	id: 4096,
  	tag: "vai",
  	version: "Release 10"
  };
  var ve = {
  	language: "Venda",
  	location: null,
  	id: 51,
  	tag: "ve",
  	version: "Release 10"
  };
  var vi = {
  	language: "Vietnamese",
  	location: null,
  	id: 42,
  	tag: "vi",
  	version: "Release 7"
  };
  var vo = {
  	language: "Volapk",
  	location: null,
  	id: 4096,
  	tag: "vo",
  	version: "Release 10"
  };
  var vun = {
  	language: "Vunjo",
  	location: null,
  	id: 4096,
  	tag: "vun",
  	version: "Release 10"
  };
  var wae = {
  	language: "Walser",
  	location: null,
  	id: 4096,
  	tag: "wae",
  	version: "Release 10"
  };
  var cy = {
  	language: "Welsh",
  	location: null,
  	id: 82,
  	tag: "cy",
  	version: "Release 7"
  };
  var wal = {
  	language: "Wolaytta",
  	location: null,
  	id: 4096,
  	tag: "wal",
  	version: "Release 10"
  };
  var wo = {
  	language: "Wolof",
  	location: null,
  	id: 136,
  	tag: "wo",
  	version: "Release 7"
  };
  var xh = {
  	language: "Xhosa",
  	location: null,
  	id: 52,
  	tag: "xh",
  	version: "Release 7"
  };
  var yav = {
  	language: "Yangben",
  	location: null,
  	id: 4096,
  	tag: "yav",
  	version: "Release 10"
  };
  var ii = {
  	language: "Yi",
  	location: null,
  	id: 120,
  	tag: "ii",
  	version: "Release 7"
  };
  var yo = {
  	language: "Yoruba",
  	location: null,
  	id: 106,
  	tag: "yo",
  	version: "Release 7"
  };
  var dje = {
  	language: "Zarma",
  	location: null,
  	id: 4096,
  	tag: "dje",
  	version: "Release 10"
  };
  var zu = {
  	language: "Zulu",
  	location: null,
  	id: 53,
  	tag: "zu",
  	version: "Release 7"
  };
  var lcid = {
  	aa: aa,
  	"aa-dj": {
  	language: "Afar",
  	location: "Djibouti",
  	id: 4096,
  	tag: "aa-DJ",
  	version: "Release 10"
  },
  	"aa-er": {
  	language: "Afar",
  	location: "Eritrea",
  	id: 4096,
  	tag: "aa-ER",
  	version: "Release 10"
  },
  	"aa-et": {
  	language: "Afar",
  	location: "Ethiopia",
  	id: 4096,
  	tag: "aa-ET",
  	version: "Release 10"
  },
  	af: af,
  	"af-na": {
  	language: "Afrikaans",
  	location: "Namibia",
  	id: 4096,
  	tag: "af-NA",
  	version: "Release 10"
  },
  	"af-za": {
  	language: "Afrikaans",
  	location: "South Africa",
  	id: 1078,
  	tag: "af-ZA",
  	version: "Release B"
  },
  	agq: agq,
  	"agq-cm": {
  	language: "Aghem",
  	location: "Cameroon",
  	id: 4096,
  	tag: "agq-CM",
  	version: "Release 10"
  },
  	ak: ak,
  	"ak-gh": {
  	language: "Akan",
  	location: "Ghana",
  	id: 4096,
  	tag: "ak-GH",
  	version: "Release 10"
  },
  	sq: sq,
  	"sq-al": {
  	language: "Albanian",
  	location: "Albania",
  	id: 1052,
  	tag: "sq-AL",
  	version: "Release B"
  },
  	"sq-mk": {
  	language: "Albanian",
  	location: "North Macedonia",
  	id: 4096,
  	tag: "sq-MK",
  	version: "Release 10"
  },
  	gsw: gsw,
  	"gsw-fr": {
  	language: "Alsatian",
  	location: "France",
  	id: 1156,
  	tag: "gsw-FR",
  	version: "Release V"
  },
  	"gsw-li": {
  	language: "Alsatian",
  	location: "Liechtenstein",
  	id: 4096,
  	tag: "gsw-LI",
  	version: "Release 10"
  },
  	"gsw-ch": {
  	language: "Alsatian",
  	location: "Switzerland",
  	id: 4096,
  	tag: "gsw-CH",
  	version: "Release 10"
  },
  	am: am,
  	"am-et": {
  	language: "Amharic",
  	location: "Ethiopia",
  	id: 1118,
  	tag: "am-ET",
  	version: "Release V"
  },
  	ar: ar,
  	"ar-dz": {
  	language: "Arabic",
  	location: "Algeria",
  	id: 5121,
  	tag: "ar-DZ",
  	version: "Release B"
  },
  	"ar-bh": {
  	language: "Arabic",
  	location: "Bahrain",
  	id: 15361,
  	tag: "ar-BH",
  	version: "Release B"
  },
  	"ar-td": {
  	language: "Arabic",
  	location: "Chad",
  	id: 4096,
  	tag: "ar-TD",
  	version: "Release 10"
  },
  	"ar-km": {
  	language: "Arabic",
  	location: "Comoros",
  	id: 4096,
  	tag: "ar-KM",
  	version: "Release 10"
  },
  	"ar-dj": {
  	language: "Arabic",
  	location: "Djibouti",
  	id: 4096,
  	tag: "ar-DJ",
  	version: "Release 10"
  },
  	"ar-eg": {
  	language: "Arabic",
  	location: "Egypt",
  	id: 3073,
  	tag: "ar-EG",
  	version: "Release B"
  },
  	"ar-er": {
  	language: "Arabic",
  	location: "Eritrea",
  	id: 4096,
  	tag: "ar-ER",
  	version: "Release 10"
  },
  	"ar-iq": {
  	language: "Arabic",
  	location: "Iraq",
  	id: 2049,
  	tag: "ar-IQ",
  	version: "Release B"
  },
  	"ar-il": {
  	language: "Arabic",
  	location: "Israel",
  	id: 4096,
  	tag: "ar-IL",
  	version: "Release 10"
  },
  	"ar-jo": {
  	language: "Arabic",
  	location: "Jordan",
  	id: 11265,
  	tag: "ar-JO",
  	version: "Release B"
  },
  	"ar-kw": {
  	language: "Arabic",
  	location: "Kuwait",
  	id: 13313,
  	tag: "ar-KW",
  	version: "Release B"
  },
  	"ar-lb": {
  	language: "Arabic",
  	location: "Lebanon",
  	id: 12289,
  	tag: "ar-LB",
  	version: "Release B"
  },
  	"ar-ly": {
  	language: "Arabic",
  	location: "Libya",
  	id: 4097,
  	tag: "ar-LY",
  	version: "Release B"
  },
  	"ar-mr": {
  	language: "Arabic",
  	location: "Mauritania",
  	id: 4096,
  	tag: "ar-MR",
  	version: "Release 10"
  },
  	"ar-ma": {
  	language: "Arabic",
  	location: "Morocco",
  	id: 6145,
  	tag: "ar-MA",
  	version: "Release B"
  },
  	"ar-om": {
  	language: "Arabic",
  	location: "Oman",
  	id: 8193,
  	tag: "ar-OM",
  	version: "Release B"
  },
  	"ar-ps": {
  	language: "Arabic",
  	location: "Palestinian Authority",
  	id: 4096,
  	tag: "ar-PS",
  	version: "Release 10"
  },
  	"ar-qa": {
  	language: "Arabic",
  	location: "Qatar",
  	id: 16385,
  	tag: "ar-QA",
  	version: "Release B"
  },
  	"ar-sa": {
  	language: "Arabic",
  	location: "Saudi Arabia",
  	id: 1025,
  	tag: "ar-SA",
  	version: "Release B"
  },
  	"ar-so": {
  	language: "Arabic",
  	location: "Somalia",
  	id: 4096,
  	tag: "ar-SO",
  	version: "Release 10"
  },
  	"ar-ss": {
  	language: "Arabic",
  	location: "South Sudan",
  	id: 4096,
  	tag: "ar-SS",
  	version: "Release 10"
  },
  	"ar-sd": {
  	language: "Arabic",
  	location: "Sudan",
  	id: 4096,
  	tag: "ar-SD",
  	version: "Release 10"
  },
  	"ar-sy": {
  	language: "Arabic",
  	location: "Syria",
  	id: 10241,
  	tag: "ar-SY",
  	version: "Release B"
  },
  	"ar-tn": {
  	language: "Arabic",
  	location: "Tunisia",
  	id: 7169,
  	tag: "ar-TN",
  	version: "Release B"
  },
  	"ar-ae": {
  	language: "Arabic",
  	location: "U.A.E.",
  	id: 14337,
  	tag: "ar-AE",
  	version: "Release B"
  },
  	"ar-001": {
  	language: "Arabic",
  	location: "World",
  	id: 4096,
  	tag: "ar-001",
  	version: "Release 10"
  },
  	"ar-ye": {
  	language: "Arabic",
  	location: "Yemen",
  	id: 9217,
  	tag: "ar-YE",
  	version: "Release B"
  },
  	hy: hy,
  	"hy-am": {
  	language: "Armenian",
  	location: "Armenia",
  	id: 1067,
  	tag: "hy-AM",
  	version: "Release C"
  },
  	as: as,
  	"as-in": {
  	language: "Assamese",
  	location: "India",
  	id: 1101,
  	tag: "as-IN",
  	version: "Release V"
  },
  	ast: ast,
  	"ast-es": {
  	language: "Asturian",
  	location: "Spain",
  	id: 4096,
  	tag: "ast-ES",
  	version: "Release 10"
  },
  	asa: asa,
  	"asa-tz": {
  	language: "Asu",
  	location: "Tanzania",
  	id: 4096,
  	tag: "asa-TZ",
  	version: "Release 10"
  },
  	"az-cyrl": {
  	language: "Azerbaijani (Cyrillic)",
  	location: null,
  	id: 29740,
  	tag: "az-Cyrl",
  	version: "Windows 7"
  },
  	"az-cyrl-az": {
  	language: "Azerbaijani (Cyrillic)",
  	location: "Azerbaijan",
  	id: 2092,
  	tag: "az-Cyrl-AZ",
  	version: "Release C"
  },
  	az: az,
  	"az-latn": {
  	language: "Azerbaijani (Latin)",
  	location: null,
  	id: 30764,
  	tag: "az-Latn",
  	version: "Windows 7"
  },
  	"az-latn-az": {
  	language: "Azerbaijani (Latin)",
  	location: "Azerbaijan",
  	id: 1068,
  	tag: "az-Latn-AZ",
  	version: "Release C"
  },
  	ksf: ksf,
  	"ksf-cm": {
  	language: "Bafia",
  	location: "Cameroon",
  	id: 4096,
  	tag: "ksf-CM",
  	version: "Release 10"
  },
  	bm: bm,
  	"bm-latn-ml": {
  	language: "Bamanankan (Latin)",
  	location: "Mali",
  	id: 4096,
  	tag: "bm-Latn-ML",
  	version: "Release 10"
  },
  	bn: bn,
  	"bn-bd": {
  	language: "Bangla",
  	location: "Bangladesh",
  	id: 2117,
  	tag: "bn-BD",
  	version: "Release V"
  },
  	"bn-in": {
  	language: "Bangla",
  	location: "India",
  	id: 1093,
  	tag: "bn-IN",
  	version: "Release E1"
  },
  	bas: bas,
  	"bas-cm": {
  	language: "Basaa",
  	location: "Cameroon",
  	id: 4096,
  	tag: "bas-CM",
  	version: "Release 10"
  },
  	ba: ba,
  	"ba-ru": {
  	language: "Bashkir",
  	location: "Russia",
  	id: 1133,
  	tag: "ba-RU",
  	version: "Release V"
  },
  	eu: eu,
  	"eu-es": {
  	language: "Basque",
  	location: "Spain",
  	id: 1069,
  	tag: "eu-ES",
  	version: "Release B"
  },
  	be: be,
  	"be-by": {
  	language: "Belarusian",
  	location: "Belarus",
  	id: 1059,
  	tag: "be-BY",
  	version: "Release B"
  },
  	bem: bem,
  	"bem-zm": {
  	language: "Bemba",
  	location: "Zambia",
  	id: 4096,
  	tag: "bem-ZM",
  	version: "Release 10"
  },
  	bez: bez,
  	"bez-tz": {
  	language: "Bena",
  	location: "Tanzania",
  	id: 4096,
  	tag: "bez-TZ",
  	version: "Release 10"
  },
  	byn: byn,
  	"byn-er": {
  	language: "Blin",
  	location: "Eritrea",
  	id: 4096,
  	tag: "byn-ER",
  	version: "Release 10"
  },
  	brx: brx,
  	"brx-in": {
  	language: "Bodo",
  	location: "India",
  	id: 4096,
  	tag: "brx-IN",
  	version: "Release 10"
  },
  	"bs-cyrl": {
  	language: "Bosnian (Cyrillic)",
  	location: null,
  	id: 25626,
  	tag: "bs-Cyrl",
  	version: "Windows 7"
  },
  	"bs-cyrl-ba": {
  	language: "Bosnian (Cyrillic)",
  	location: "Bosnia and Herzegovina",
  	id: 8218,
  	tag: "bs-Cyrl-BA",
  	version: "Release E1"
  },
  	"bs-latn": {
  	language: "Bosnian (Latin)",
  	location: null,
  	id: 26650,
  	tag: "bs-Latn",
  	version: "Windows 7"
  },
  	bs: bs,
  	"bs-latn-ba": {
  	language: "Bosnian (Latin)",
  	location: "Bosnia and Herzegovina",
  	id: 5146,
  	tag: "bs-Latn-BA",
  	version: "Release E1"
  },
  	br: br,
  	"br-fr": {
  	language: "Breton",
  	location: "France",
  	id: 1150,
  	tag: "br-FR",
  	version: "Release V"
  },
  	bg: bg,
  	"bg-bg": {
  	language: "Bulgarian",
  	location: "Bulgaria",
  	id: 1026,
  	tag: "bg-BG",
  	version: "Release B"
  },
  	my: my,
  	"my-mm": {
  	language: "Burmese",
  	location: "Myanmar",
  	id: 1109,
  	tag: "my-MM",
  	version: "Release 8.1"
  },
  	ca: ca,
  	"ca-ad": {
  	language: "Catalan",
  	location: "Andorra",
  	id: 4096,
  	tag: "ca-AD",
  	version: "Release 10"
  },
  	"ca-fr": {
  	language: "Catalan",
  	location: "France",
  	id: 4096,
  	tag: "ca-FR",
  	version: "Release 10"
  },
  	"ca-it": {
  	language: "Catalan",
  	location: "Italy",
  	id: 4096,
  	tag: "ca-IT",
  	version: "Release 10"
  },
  	"ca-es": {
  	language: "Catalan",
  	location: "Spain",
  	id: 1027,
  	tag: "ca-ES",
  	version: "Release B"
  },
  	"tzm-latn-": {
  	language: "Central Atlas Tamazight ",
  	location: "Morocco",
  	id: 4096,
  	tag: "tzm-Latn-",
  	version: "Release 10"
  },
  	ku: ku,
  	"ku-arab": {
  	language: "Central Kurdish",
  	location: null,
  	id: 31890,
  	tag: "ku-Arab",
  	version: "Release 8"
  },
  	"ku-arab-iq": {
  	language: "Central Kurdish",
  	location: "Iraq",
  	id: 1170,
  	tag: "ku-Arab-IQ",
  	version: "Release 8"
  },
  	"cd-ru": {
  	language: "Chechen",
  	location: "Russia",
  	id: 4096,
  	tag: "cd-RU",
  	version: "Release 10.1"
  },
  	chr: chr,
  	"chr-cher": {
  	language: "Cherokee",
  	location: null,
  	id: 31836,
  	tag: "chr-Cher",
  	version: "Release 8"
  },
  	"chr-cher-us": {
  	language: "Cherokee",
  	location: "United States",
  	id: 1116,
  	tag: "chr-Cher-US",
  	version: "Release 8"
  },
  	cgg: cgg,
  	"cgg-ug": {
  	language: "Chiga",
  	location: "Uganda",
  	id: 4096,
  	tag: "cgg-UG",
  	version: "Release 10"
  },
  	"zh-hans": {
  	language: "Chinese (Simplified)",
  	location: null,
  	id: 4,
  	tag: "zh-Hans",
  	version: "Release A"
  },
  	zh: zh,
  	"zh-cn": {
  	language: "Chinese (Simplified)",
  	location: "People's Republic of China",
  	id: 2052,
  	tag: "zh-CN",
  	version: "Release A"
  },
  	"zh-sg": {
  	language: "Chinese (Simplified)",
  	location: "Singapore",
  	id: 4100,
  	tag: "zh-SG",
  	version: "Release A"
  },
  	"zh-hant": {
  	language: "Chinese (Traditional)",
  	location: null,
  	id: 31748,
  	tag: "zh-Hant",
  	version: "Release A"
  },
  	"zh-hk": {
  	language: "Chinese (Traditional)",
  	location: "Hong Kong S.A.R.",
  	id: 3076,
  	tag: "zh-HK",
  	version: "Release A"
  },
  	"zh-mo": {
  	language: "Chinese (Traditional)",
  	location: "Macao S.A.R.",
  	id: 5124,
  	tag: "zh-MO",
  	version: "Release D"
  },
  	"zh-tw": {
  	language: "Chinese (Traditional)",
  	location: "Taiwan",
  	id: 1028,
  	tag: "zh-TW",
  	version: "Release A"
  },
  	"cu-ru": {
  	language: "Church Slavic",
  	location: "Russia",
  	id: 4096,
  	tag: "cu-RU",
  	version: "Release 10.1"
  },
  	swc: swc,
  	"swc-cd": {
  	language: "Congo Swahili",
  	location: "Congo DRC",
  	id: 4096,
  	tag: "swc-CD",
  	version: "Release 10"
  },
  	kw: kw,
  	"kw-gb": {
  	language: "Cornish",
  	location: "United Kingdom",
  	id: 4096,
  	tag: "kw-GB",
  	version: "Release 10"
  },
  	co: co,
  	"co-fr": {
  	language: "Corsican",
  	location: "France",
  	id: 1155,
  	tag: "co-FR",
  	version: "Release V"
  },
  	"hr,": {
  	language: "Croatian",
  	location: null,
  	id: 26,
  	tag: "hr,",
  	version: "Release 7"
  },
  	"hr-hr": {
  	language: "Croatian",
  	location: "Croatia",
  	id: 1050,
  	tag: "hr-HR",
  	version: "Release A"
  },
  	"hr-ba": {
  	language: "Croatian (Latin)",
  	location: "Bosnia and Herzegovina",
  	id: 4122,
  	tag: "hr-BA",
  	version: "Release E1"
  },
  	cs: cs,
  	"cs-cz": {
  	language: "Czech",
  	location: "Czech Republic",
  	id: 1029,
  	tag: "cs-CZ",
  	version: "Release A"
  },
  	da: da,
  	"da-dk": {
  	language: "Danish",
  	location: "Denmark",
  	id: 1030,
  	tag: "da-DK",
  	version: "Release A"
  },
  	"da-gl": {
  	language: "Danish",
  	location: "Greenland",
  	id: 4096,
  	tag: "da-GL",
  	version: "Release 10"
  },
  	prs: prs,
  	"prs-af": {
  	language: "Dari",
  	location: "Afghanistan",
  	id: 1164,
  	tag: "prs-AF",
  	version: "Release V"
  },
  	dv: dv,
  	"dv-mv": {
  	language: "Divehi",
  	location: "Maldives",
  	id: 1125,
  	tag: "dv-MV",
  	version: "ReleaseD"
  },
  	dua: dua,
  	"dua-cm": {
  	language: "Duala",
  	location: "Cameroon",
  	id: 4096,
  	tag: "dua-CM",
  	version: "Release 10"
  },
  	nl: nl,
  	"nl-aw": {
  	language: "Dutch",
  	location: "Aruba",
  	id: 4096,
  	tag: "nl-AW",
  	version: "Release 10"
  },
  	"nl-be": {
  	language: "Dutch",
  	location: "Belgium",
  	id: 2067,
  	tag: "nl-BE",
  	version: "Release A"
  },
  	"nl-bq": {
  	language: "Dutch",
  	location: "Bonaire, Sint Eustatius and Saba",
  	id: 4096,
  	tag: "nl-BQ",
  	version: "Release 10"
  },
  	"nl-cw": {
  	language: "Dutch",
  	location: "Curaao",
  	id: 4096,
  	tag: "nl-CW",
  	version: "Release 10"
  },
  	"nl-nl": {
  	language: "Dutch",
  	location: "Netherlands",
  	id: 1043,
  	tag: "nl-NL",
  	version: "Release A"
  },
  	"nl-sx": {
  	language: "Dutch",
  	location: "Sint Maarten",
  	id: 4096,
  	tag: "nl-SX",
  	version: "Release 10"
  },
  	"nl-sr": {
  	language: "Dutch",
  	location: "Suriname",
  	id: 4096,
  	tag: "nl-SR",
  	version: "Release 10"
  },
  	dz: dz,
  	"dz-bt": {
  	language: "Dzongkha",
  	location: "Bhutan",
  	id: 3153,
  	tag: "dz-BT",
  	version: "Release 10"
  },
  	ebu: ebu,
  	"ebu-ke": {
  	language: "Embu",
  	location: "Kenya",
  	id: 4096,
  	tag: "ebu-KE",
  	version: "Release 10"
  },
  	en: en,
  	"en-as": {
  	language: "English",
  	location: "American Samoa",
  	id: 4096,
  	tag: "en-AS",
  	version: "Release 10"
  },
  	"en-ai": {
  	language: "English",
  	location: "Anguilla",
  	id: 4096,
  	tag: "en-AI",
  	version: "Release 10"
  },
  	"en-ag": {
  	language: "English",
  	location: "Antigua and Barbuda",
  	id: 4096,
  	tag: "en-AG",
  	version: "Release 10"
  },
  	"en-au": {
  	language: "English",
  	location: "Australia",
  	id: 3081,
  	tag: "en-AU",
  	version: "Release A"
  },
  	"en-at": {
  	language: "English",
  	location: "Austria",
  	id: 4096,
  	tag: "en-AT",
  	version: "Release 10.1"
  },
  	"en-bs": {
  	language: "English",
  	location: "Bahamas",
  	id: 4096,
  	tag: "en-BS",
  	version: "Release 10"
  },
  	"en-bb": {
  	language: "English",
  	location: "Barbados",
  	id: 4096,
  	tag: "en-BB",
  	version: "Release 10"
  },
  	"en-be": {
  	language: "English",
  	location: "Belgium",
  	id: 4096,
  	tag: "en-BE",
  	version: "Release 10"
  },
  	"en-bz": {
  	language: "English",
  	location: "Belize",
  	id: 10249,
  	tag: "en-BZ",
  	version: "Release B"
  },
  	"en-bm": {
  	language: "English",
  	location: "Bermuda",
  	id: 4096,
  	tag: "en-BM",
  	version: "Release 10"
  },
  	"en-bw": {
  	language: "English",
  	location: "Botswana",
  	id: 4096,
  	tag: "en-BW",
  	version: "Release 10"
  },
  	"en-io": {
  	language: "English",
  	location: "British Indian Ocean Territory",
  	id: 4096,
  	tag: "en-IO",
  	version: "Release 10"
  },
  	"en-vg": {
  	language: "English",
  	location: "British Virgin Islands",
  	id: 4096,
  	tag: "en-VG",
  	version: "Release 10"
  },
  	"en-bi": {
  	language: "English",
  	location: "Burundi",
  	id: 4096,
  	tag: "en-BI",
  	version: "Release 10.1"
  },
  	"en-cm": {
  	language: "English",
  	location: "Cameroon",
  	id: 4096,
  	tag: "en-CM",
  	version: "Release 10"
  },
  	"en-ca": {
  	language: "English",
  	location: "Canada",
  	id: 4105,
  	tag: "en-CA",
  	version: "Release A"
  },
  	"en-029": {
  	language: "English",
  	location: "Caribbean",
  	id: 9225,
  	tag: "en-029",
  	version: "Release B"
  },
  	"en-ky": {
  	language: "English",
  	location: "Cayman Islands",
  	id: 4096,
  	tag: "en-KY",
  	version: "Release 10"
  },
  	"en-cx": {
  	language: "English",
  	location: "Christmas Island",
  	id: 4096,
  	tag: "en-CX",
  	version: "Release 10"
  },
  	"en-cc": {
  	language: "English",
  	location: "Cocos [Keeling] Islands",
  	id: 4096,
  	tag: "en-CC",
  	version: "Release 10"
  },
  	"en-ck": {
  	language: "English",
  	location: "Cook Islands",
  	id: 4096,
  	tag: "en-CK",
  	version: "Release 10"
  },
  	"en-cy": {
  	language: "English",
  	location: "Cyprus",
  	id: 4096,
  	tag: "en-CY",
  	version: "Release 10.1"
  },
  	"en-dk": {
  	language: "English",
  	location: "Denmark",
  	id: 4096,
  	tag: "en-DK",
  	version: "Release 10.1"
  },
  	"en-dm": {
  	language: "English",
  	location: "Dominica",
  	id: 4096,
  	tag: "en-DM",
  	version: "Release 10"
  },
  	"en-er": {
  	language: "English",
  	location: "Eritrea",
  	id: 4096,
  	tag: "en-ER",
  	version: "Release 10"
  },
  	"en-150": {
  	language: "English",
  	location: "Europe",
  	id: 4096,
  	tag: "en-150",
  	version: "Release 10"
  },
  	"en-fk": {
  	language: "English",
  	location: "Falkland Islands",
  	id: 4096,
  	tag: "en-FK",
  	version: "Release 10"
  },
  	"en-fi": {
  	language: "English",
  	location: "Finland",
  	id: 4096,
  	tag: "en-FI",
  	version: "Release 10.1"
  },
  	"en-fj": {
  	language: "English",
  	location: "Fiji",
  	id: 4096,
  	tag: "en-FJ",
  	version: "Release 10"
  },
  	"en-gm": {
  	language: "English",
  	location: "Gambia",
  	id: 4096,
  	tag: "en-GM",
  	version: "Release 10"
  },
  	"en-de": {
  	language: "English",
  	location: "Germany",
  	id: 4096,
  	tag: "en-DE",
  	version: "Release 10.1"
  },
  	"en-gh": {
  	language: "English",
  	location: "Ghana",
  	id: 4096,
  	tag: "en-GH",
  	version: "Release 10"
  },
  	"en-gi": {
  	language: "English",
  	location: "Gibraltar",
  	id: 4096,
  	tag: "en-GI",
  	version: "Release 10"
  },
  	"en-gd": {
  	language: "English",
  	location: "Grenada",
  	id: 4096,
  	tag: "en-GD",
  	version: "Release 10"
  },
  	"en-gu": {
  	language: "English",
  	location: "Guam",
  	id: 4096,
  	tag: "en-GU",
  	version: "Release 10"
  },
  	"en-gg": {
  	language: "English",
  	location: "Guernsey",
  	id: 4096,
  	tag: "en-GG",
  	version: "Release 10"
  },
  	"en-gy": {
  	language: "English",
  	location: "Guyana",
  	id: 4096,
  	tag: "en-GY",
  	version: "Release 10"
  },
  	"en-hk": {
  	language: "English",
  	location: "Hong Kong",
  	id: 15369,
  	tag: "en-HK",
  	version: "Release 8.1"
  },
  	"en-in": {
  	language: "English",
  	location: "India",
  	id: 16393,
  	tag: "en-IN",
  	version: "Release V"
  },
  	"en-ie": {
  	language: "English",
  	location: "Ireland",
  	id: 6153,
  	tag: "en-IE",
  	version: "Release A"
  },
  	"en-im": {
  	language: "English",
  	location: "Isle of Man",
  	id: 4096,
  	tag: "en-IM",
  	version: "Release 10"
  },
  	"en-il": {
  	language: "English",
  	location: "Israel",
  	id: 4096,
  	tag: "en-IL",
  	version: "Release 10.1"
  },
  	"en-jm": {
  	language: "English",
  	location: "Jamaica",
  	id: 8201,
  	tag: "en-JM",
  	version: "Release B"
  },
  	"en-je": {
  	language: "English",
  	location: "Jersey",
  	id: 4096,
  	tag: "en-JE",
  	version: "Release 10"
  },
  	"en-ke": {
  	language: "English",
  	location: "Kenya",
  	id: 4096,
  	tag: "en-KE",
  	version: "Release 10"
  },
  	"en-ki": {
  	language: "English",
  	location: "Kiribati",
  	id: 4096,
  	tag: "en-KI",
  	version: "Release 10"
  },
  	"en-ls": {
  	language: "English",
  	location: "Lesotho",
  	id: 4096,
  	tag: "en-LS",
  	version: "Release 10"
  },
  	"en-lr": {
  	language: "English",
  	location: "Liberia",
  	id: 4096,
  	tag: "en-LR",
  	version: "Release 10"
  },
  	"en-mo": {
  	language: "English",
  	location: "Macao SAR",
  	id: 4096,
  	tag: "en-MO",
  	version: "Release 10"
  },
  	"en-mg": {
  	language: "English",
  	location: "Madagascar",
  	id: 4096,
  	tag: "en-MG",
  	version: "Release 10"
  },
  	"en-mw": {
  	language: "English",
  	location: "Malawi",
  	id: 4096,
  	tag: "en-MW",
  	version: "Release 10"
  },
  	"en-my": {
  	language: "English",
  	location: "Malaysia",
  	id: 17417,
  	tag: "en-MY",
  	version: "Release V"
  },
  	"en-mt": {
  	language: "English",
  	location: "Malta",
  	id: 4096,
  	tag: "en-MT",
  	version: "Release 10"
  },
  	"en-mh": {
  	language: "English",
  	location: "Marshall Islands",
  	id: 4096,
  	tag: "en-MH",
  	version: "Release 10"
  },
  	"en-mu": {
  	language: "English",
  	location: "Mauritius",
  	id: 4096,
  	tag: "en-MU",
  	version: "Release 10"
  },
  	"en-fm": {
  	language: "English",
  	location: "Micronesia",
  	id: 4096,
  	tag: "en-FM",
  	version: "Release 10"
  },
  	"en-ms": {
  	language: "English",
  	location: "Montserrat",
  	id: 4096,
  	tag: "en-MS",
  	version: "Release 10"
  },
  	"en-na": {
  	language: "English",
  	location: "Namibia",
  	id: 4096,
  	tag: "en-NA",
  	version: "Release 10"
  },
  	"en-nr": {
  	language: "English",
  	location: "Nauru",
  	id: 4096,
  	tag: "en-NR",
  	version: "Release 10"
  },
  	"en-nl": {
  	language: "English",
  	location: "Netherlands",
  	id: 4096,
  	tag: "en-NL",
  	version: "Release 10.1"
  },
  	"en-nz": {
  	language: "English",
  	location: "New Zealand",
  	id: 5129,
  	tag: "en-NZ",
  	version: "Release A"
  },
  	"en-ng": {
  	language: "English",
  	location: "Nigeria",
  	id: 4096,
  	tag: "en-NG",
  	version: "Release 10"
  },
  	"en-nu": {
  	language: "English",
  	location: "Niue",
  	id: 4096,
  	tag: "en-NU",
  	version: "Release 10"
  },
  	"en-nf": {
  	language: "English",
  	location: "Norfolk Island",
  	id: 4096,
  	tag: "en-NF",
  	version: "Release 10"
  },
  	"en-mp": {
  	language: "English",
  	location: "Northern Mariana Islands",
  	id: 4096,
  	tag: "en-MP",
  	version: "Release 10"
  },
  	"en-pk": {
  	language: "English",
  	location: "Pakistan",
  	id: 4096,
  	tag: "en-PK",
  	version: "Release 10"
  },
  	"en-pw": {
  	language: "English",
  	location: "Palau",
  	id: 4096,
  	tag: "en-PW",
  	version: "Release 10"
  },
  	"en-pg": {
  	language: "English",
  	location: "Papua New Guinea",
  	id: 4096,
  	tag: "en-PG",
  	version: "Release 10"
  },
  	"en-pn": {
  	language: "English",
  	location: "Pitcairn Islands",
  	id: 4096,
  	tag: "en-PN",
  	version: "Release 10"
  },
  	"en-pr": {
  	language: "English",
  	location: "Puerto Rico",
  	id: 4096,
  	tag: "en-PR",
  	version: "Release 10"
  },
  	"en-ph": {
  	language: "English",
  	location: "Republic of the Philippines",
  	id: 13321,
  	tag: "en-PH",
  	version: "Release C"
  },
  	"en-rw": {
  	language: "English",
  	location: "Rwanda",
  	id: 4096,
  	tag: "en-RW",
  	version: "Release 10"
  },
  	"en-kn": {
  	language: "English",
  	location: "Saint Kitts and Nevis",
  	id: 4096,
  	tag: "en-KN",
  	version: "Release 10"
  },
  	"en-lc": {
  	language: "English",
  	location: "Saint Lucia",
  	id: 4096,
  	tag: "en-LC",
  	version: "Release 10"
  },
  	"en-vc": {
  	language: "English",
  	location: "Saint Vincent and the Grenadines",
  	id: 4096,
  	tag: "en-VC",
  	version: "Release 10"
  },
  	"en-ws": {
  	language: "English",
  	location: "Samoa",
  	id: 4096,
  	tag: "en-WS",
  	version: "Release 10"
  },
  	"en-sc": {
  	language: "English",
  	location: "Seychelles",
  	id: 4096,
  	tag: "en-SC",
  	version: "Release 10"
  },
  	"en-sl": {
  	language: "English",
  	location: "Sierra Leone",
  	id: 4096,
  	tag: "en-SL",
  	version: "Release 10"
  },
  	"en-sg": {
  	language: "English",
  	location: "Singapore",
  	id: 18441,
  	tag: "en-SG",
  	version: "Release V"
  },
  	"en-sx": {
  	language: "English",
  	location: "Sint Maarten",
  	id: 4096,
  	tag: "en-SX",
  	version: "Release 10"
  },
  	"en-si": {
  	language: "English",
  	location: "Slovenia",
  	id: 4096,
  	tag: "en-SI",
  	version: "Release 10.1"
  },
  	"en-sb": {
  	language: "English",
  	location: "Solomon Islands",
  	id: 4096,
  	tag: "en-SB",
  	version: "Release 10"
  },
  	"en-za": {
  	language: "English",
  	location: "South Africa",
  	id: 7177,
  	tag: "en-ZA",
  	version: "Release B"
  },
  	"en-ss": {
  	language: "English",
  	location: "South Sudan",
  	id: 4096,
  	tag: "en-SS",
  	version: "Release 10"
  },
  	"en-sh": {
  	language: "English",
  	location: "St Helena, Ascension, Tristan da ",
  	id: 4096,
  	tag: "en-SH",
  	version: "Release 10"
  },
  	"en-sd": {
  	language: "English",
  	location: "Sudan",
  	id: 4096,
  	tag: "en-SD",
  	version: "Release 10"
  },
  	"en-sz": {
  	language: "English",
  	location: "Swaziland",
  	id: 4096,
  	tag: "en-SZ",
  	version: "Release 10"
  },
  	"en-se": {
  	language: "English",
  	location: "Sweden",
  	id: 4096,
  	tag: "en-SE",
  	version: "Release 10.1"
  },
  	"en-ch": {
  	language: "English",
  	location: "Switzerland",
  	id: 4096,
  	tag: "en-CH",
  	version: "Release 10.1"
  },
  	"en-tz": {
  	language: "English",
  	location: "Tanzania",
  	id: 4096,
  	tag: "en-TZ",
  	version: "Release 10"
  },
  	"en-tk": {
  	language: "English",
  	location: "Tokelau",
  	id: 4096,
  	tag: "en-TK",
  	version: "Release 10"
  },
  	"en-to": {
  	language: "English",
  	location: "Tonga",
  	id: 4096,
  	tag: "en-TO",
  	version: "Release 10"
  },
  	"en-tt": {
  	language: "English",
  	location: "Trinidad and Tobago",
  	id: 11273,
  	tag: "en-TT",
  	version: "Release B"
  },
  	"en-tc": {
  	language: "English",
  	location: "Turks and Caicos Islands",
  	id: 4096,
  	tag: "en-TC",
  	version: "Release 10"
  },
  	"en-tv": {
  	language: "English",
  	location: "Tuvalu",
  	id: 4096,
  	tag: "en-TV",
  	version: "Release 10"
  },
  	"en-ug": {
  	language: "English",
  	location: "Uganda",
  	id: 4096,
  	tag: "en-UG",
  	version: "Release 10"
  },
  	"en-gb": {
  	language: "English",
  	location: "United Kingdom",
  	id: 2057,
  	tag: "en-GB",
  	version: "Release A"
  },
  	"en-us": {
  	language: "English",
  	location: "United States",
  	id: 1033,
  	tag: "en-US",
  	version: "Release A"
  },
  	"en-um": {
  	language: "English",
  	location: "US Minor Outlying Islands",
  	id: 4096,
  	tag: "en-UM",
  	version: "Release 10"
  },
  	"en-vi": {
  	language: "English",
  	location: "US Virgin Islands",
  	id: 4096,
  	tag: "en-VI",
  	version: "Release 10"
  },
  	"en-vu": {
  	language: "English",
  	location: "Vanuatu",
  	id: 4096,
  	tag: "en-VU",
  	version: "Release 10"
  },
  	"en-001": {
  	language: "English",
  	location: "World",
  	id: 4096,
  	tag: "en-001",
  	version: "Release 10"
  },
  	"en-zm": {
  	language: "English",
  	location: "Zambia",
  	id: 4096,
  	tag: "en-ZM",
  	version: "Release 10"
  },
  	"en-zw": {
  	language: "English",
  	location: "Zimbabwe",
  	id: 12297,
  	tag: "en-ZW",
  	version: "Release C"
  },
  	eo: eo,
  	"eo-001": {
  	language: "Esperanto",
  	location: "World",
  	id: 4096,
  	tag: "eo-001",
  	version: "Release 10"
  },
  	et: et,
  	"et-ee": {
  	language: "Estonian",
  	location: "Estonia",
  	id: 1061,
  	tag: "et-EE",
  	version: "Release B"
  },
  	ee: ee,
  	"ee-gh": {
  	language: "Ewe",
  	location: "Ghana",
  	id: 4096,
  	tag: "ee-GH",
  	version: "Release 10"
  },
  	"ee-tg": {
  	language: "Ewe",
  	location: "Togo",
  	id: 4096,
  	tag: "ee-TG",
  	version: "Release 10"
  },
  	ewo: ewo,
  	"ewo-cm": {
  	language: "Ewondo",
  	location: "Cameroon",
  	id: 4096,
  	tag: "ewo-CM",
  	version: "Release 10"
  },
  	fo: fo,
  	"fo-dk": {
  	language: "Faroese",
  	location: "Denmark",
  	id: 4096,
  	tag: "fo-DK",
  	version: "Release 10.1"
  },
  	"fo-fo": {
  	language: "Faroese",
  	location: "Faroe Islands",
  	id: 1080,
  	tag: "fo-FO",
  	version: "Release B"
  },
  	fil: fil,
  	"fil-ph": {
  	language: "Filipino",
  	location: "Philippines",
  	id: 1124,
  	tag: "fil-PH",
  	version: "Release E2"
  },
  	fi: fi,
  	"fi-fi": {
  	language: "Finnish",
  	location: "Finland",
  	id: 1035,
  	tag: "fi-FI",
  	version: "Release A"
  },
  	fr: fr,
  	"fr-dz": {
  	language: "French",
  	location: "Algeria",
  	id: 4096,
  	tag: "fr-DZ",
  	version: "Release 10"
  },
  	"fr-be": {
  	language: "French",
  	location: "Belgium",
  	id: 2060,
  	tag: "fr-BE",
  	version: "Release A"
  },
  	"fr-bj": {
  	language: "French",
  	location: "Benin",
  	id: 4096,
  	tag: "fr-BJ",
  	version: "Release 10"
  },
  	"fr-bf": {
  	language: "French",
  	location: "Burkina Faso",
  	id: 4096,
  	tag: "fr-BF",
  	version: "Release 10"
  },
  	"fr-bi": {
  	language: "French",
  	location: "Burundi",
  	id: 4096,
  	tag: "fr-BI",
  	version: "Release 10"
  },
  	"fr-cm": {
  	language: "French",
  	location: "Cameroon",
  	id: 11276,
  	tag: "fr-CM",
  	version: "Release 8.1"
  },
  	"fr-ca": {
  	language: "French",
  	location: "Canada",
  	id: 3084,
  	tag: "fr-CA",
  	version: "Release A"
  },
  	"fr-cf": {
  	language: "French",
  	location: "Central African Republic",
  	id: 4096,
  	tag: "fr-CF",
  	version: "Release 10"
  },
  	"fr-td": {
  	language: "French",
  	location: "Chad",
  	id: 4096,
  	tag: "fr-TD",
  	version: "Release 10"
  },
  	"fr-km": {
  	language: "French",
  	location: "Comoros",
  	id: 4096,
  	tag: "fr-KM",
  	version: "Release 10"
  },
  	"fr-cg": {
  	language: "French",
  	location: "Congo",
  	id: 4096,
  	tag: "fr-CG",
  	version: "Release 10"
  },
  	"fr-cd": {
  	language: "French",
  	location: "Congo, DRC",
  	id: 9228,
  	tag: "fr-CD",
  	version: "Release 8.1"
  },
  	"fr-ci": {
  	language: "French",
  	location: "Cte d'Ivoire",
  	id: 12300,
  	tag: "fr-CI",
  	version: "Release 8.1"
  },
  	"fr-dj": {
  	language: "French",
  	location: "Djibouti",
  	id: 4096,
  	tag: "fr-DJ",
  	version: "Release 10"
  },
  	"fr-gq": {
  	language: "French",
  	location: "Equatorial Guinea",
  	id: 4096,
  	tag: "fr-GQ",
  	version: "Release 10"
  },
  	"fr-fr": {
  	language: "French",
  	location: "France",
  	id: 1036,
  	tag: "fr-FR",
  	version: "Release A"
  },
  	"fr-gf": {
  	language: "French",
  	location: "French Guiana",
  	id: 4096,
  	tag: "fr-GF",
  	version: "Release 10"
  },
  	"fr-pf": {
  	language: "French",
  	location: "French Polynesia",
  	id: 4096,
  	tag: "fr-PF",
  	version: "Release 10"
  },
  	"fr-ga": {
  	language: "French",
  	location: "Gabon",
  	id: 4096,
  	tag: "fr-GA",
  	version: "Release 10"
  },
  	"fr-gp": {
  	language: "French",
  	location: "Guadeloupe",
  	id: 4096,
  	tag: "fr-GP",
  	version: "Release 10"
  },
  	"fr-gn": {
  	language: "French",
  	location: "Guinea",
  	id: 4096,
  	tag: "fr-GN",
  	version: "Release 10"
  },
  	"fr-ht": {
  	language: "French",
  	location: "Haiti",
  	id: 15372,
  	tag: "fr-HT",
  	version: "Release 8.1"
  },
  	"fr-lu": {
  	language: "French",
  	location: "Luxembourg",
  	id: 5132,
  	tag: "fr-LU",
  	version: "Release A"
  },
  	"fr-mg": {
  	language: "French",
  	location: "Madagascar",
  	id: 4096,
  	tag: "fr-MG",
  	version: "Release 10"
  },
  	"fr-ml": {
  	language: "French",
  	location: "Mali",
  	id: 13324,
  	tag: "fr-ML",
  	version: "Release 8.1"
  },
  	"fr-mq": {
  	language: "French",
  	location: "Martinique",
  	id: 4096,
  	tag: "fr-MQ",
  	version: "Release 10"
  },
  	"fr-mr": {
  	language: "French",
  	location: "Mauritania",
  	id: 4096,
  	tag: "fr-MR",
  	version: "Release 10"
  },
  	"fr-mu": {
  	language: "French",
  	location: "Mauritius",
  	id: 4096,
  	tag: "fr-MU",
  	version: "Release 10"
  },
  	"fr-yt": {
  	language: "French",
  	location: "Mayotte",
  	id: 4096,
  	tag: "fr-YT",
  	version: "Release 10"
  },
  	"fr-ma": {
  	language: "French",
  	location: "Morocco",
  	id: 14348,
  	tag: "fr-MA",
  	version: "Release 8.1"
  },
  	"fr-nc": {
  	language: "French",
  	location: "New Caledonia",
  	id: 4096,
  	tag: "fr-NC",
  	version: "Release 10"
  },
  	"fr-ne": {
  	language: "French",
  	location: "Niger",
  	id: 4096,
  	tag: "fr-NE",
  	version: "Release 10"
  },
  	"fr-mc": {
  	language: "French",
  	location: "Principality of Monaco",
  	id: 6156,
  	tag: "fr-MC",
  	version: "Release A"
  },
  	"fr-re": {
  	language: "French",
  	location: "Reunion",
  	id: 8204,
  	tag: "fr-RE",
  	version: "Release 8.1"
  },
  	"fr-rw": {
  	language: "French",
  	location: "Rwanda",
  	id: 4096,
  	tag: "fr-RW",
  	version: "Release 10"
  },
  	"fr-bl": {
  	language: "French",
  	location: "Saint Barthlemy",
  	id: 4096,
  	tag: "fr-BL",
  	version: "Release 10"
  },
  	"fr-mf": {
  	language: "French",
  	location: "Saint Martin",
  	id: 4096,
  	tag: "fr-MF",
  	version: "Release 10"
  },
  	"fr-pm": {
  	language: "French",
  	location: "Saint Pierre and Miquelon",
  	id: 4096,
  	tag: "fr-PM",
  	version: "Release 10"
  },
  	"fr-sn": {
  	language: "French",
  	location: "Senegal",
  	id: 10252,
  	tag: "fr-SN",
  	version: "Release 8.1"
  },
  	"fr-sc": {
  	language: "French",
  	location: "Seychelles",
  	id: 4096,
  	tag: "fr-SC",
  	version: "Release 10"
  },
  	"fr-ch": {
  	language: "French",
  	location: "Switzerland",
  	id: 4108,
  	tag: "fr-CH",
  	version: "Release A"
  },
  	"fr-sy": {
  	language: "French",
  	location: "Syria",
  	id: 4096,
  	tag: "fr-SY",
  	version: "Release 10"
  },
  	"fr-tg": {
  	language: "French",
  	location: "Togo",
  	id: 4096,
  	tag: "fr-TG",
  	version: "Release 10"
  },
  	"fr-tn": {
  	language: "French",
  	location: "Tunisia",
  	id: 4096,
  	tag: "fr-TN",
  	version: "Release 10"
  },
  	"fr-vu": {
  	language: "French",
  	location: "Vanuatu",
  	id: 4096,
  	tag: "fr-VU",
  	version: "Release 10"
  },
  	"fr-wf": {
  	language: "French",
  	location: "Wallis and Futuna",
  	id: 4096,
  	tag: "fr-WF",
  	version: "Release 10"
  },
  	fy: fy,
  	"fy-nl": {
  	language: "Frisian",
  	location: "Netherlands",
  	id: 1122,
  	tag: "fy-NL",
  	version: "Release E2"
  },
  	fur: fur,
  	"fur-it": {
  	language: "Friulian",
  	location: "Italy",
  	id: 4096,
  	tag: "fur-IT",
  	version: "Release 10"
  },
  	ff: ff,
  	"ff-latn": {
  	language: "Fulah (Latin)",
  	location: null,
  	id: 31847,
  	tag: "ff-Latn",
  	version: "Release 8"
  },
  	"ff-latn-bf": {
  	language: "Fulah (Latin)",
  	location: "Burkina Faso",
  	id: 4096,
  	tag: "ff-Latn-BF",
  	version: "Release 10.4"
  },
  	"ff-cm": {
  	language: "Fulah",
  	location: "Cameroon",
  	id: 4096,
  	tag: "ff-CM",
  	version: "Release 10"
  },
  	"ff-latn-cm": {
  	language: "Fulah (Latin)",
  	location: "Cameroon",
  	id: 4096,
  	tag: "ff-Latn-CM",
  	version: "Release 10.4"
  },
  	"ff-latn-gm": {
  	language: "Fulah (Latin)",
  	location: "Gambia",
  	id: 4096,
  	tag: "ff-Latn-GM",
  	version: "Release 10.4"
  },
  	"ff-latn-gh": {
  	language: "Fulah (Latin)",
  	location: "Ghana",
  	id: 4096,
  	tag: "ff-Latn-GH",
  	version: "Release 10.4"
  },
  	"ff-gn": {
  	language: "Fulah",
  	location: "Guinea",
  	id: 4096,
  	tag: "ff-GN",
  	version: "Release 10"
  },
  	"ff-latn-gn": {
  	language: "Fulah (Latin)",
  	location: "Guinea",
  	id: 4096,
  	tag: "ff-Latn-GN",
  	version: "Release 10.4"
  },
  	"ff-latn-gw": {
  	language: "Fulah (Latin)",
  	location: "Guinea-Bissau",
  	id: 4096,
  	tag: "ff-Latn-GW",
  	version: "Release 10.4"
  },
  	"ff-latn-lr": {
  	language: "Fulah (Latin)",
  	location: "Liberia",
  	id: 4096,
  	tag: "ff-Latn-LR",
  	version: "Release 10.4"
  },
  	"ff-mr": {
  	language: "Fulah",
  	location: "Mauritania",
  	id: 4096,
  	tag: "ff-MR",
  	version: "Release 10"
  },
  	"ff-latn-mr": {
  	language: "Fulah (Latin)",
  	location: "Mauritania",
  	id: 4096,
  	tag: "ff-Latn-MR",
  	version: "Release 10.4"
  },
  	"ff-latn-ne": {
  	language: "Fulah (Latin)",
  	location: "Niger",
  	id: 4096,
  	tag: "ff-Latn-NE",
  	version: "Release 10.4"
  },
  	"ff-ng": {
  	language: "Fulah",
  	location: "Nigeria",
  	id: 4096,
  	tag: "ff-NG",
  	version: "Release 10"
  },
  	"ff-latn-ng": {
  	language: "Fulah (Latin)",
  	location: "Nigeria",
  	id: 4096,
  	tag: "ff-Latn-NG",
  	version: "Release 10.4"
  },
  	"ff-latn-sn": {
  	language: "Fulah",
  	location: "Senegal",
  	id: 2151,
  	tag: "ff-Latn-SN",
  	version: "Release 8"
  },
  	"ff-latn-sl": {
  	language: "Fulah (Latin)",
  	location: "Sierra Leone",
  	id: 4096,
  	tag: "ff-Latn-SL",
  	version: "Release 10.4"
  },
  	gl: gl,
  	"gl-es": {
  	language: "Galician",
  	location: "Spain",
  	id: 1110,
  	tag: "gl-ES",
  	version: "Release D"
  },
  	lg: lg,
  	"lg-ug": {
  	language: "Ganda",
  	location: "Uganda",
  	id: 4096,
  	tag: "lg-UG",
  	version: "Release 10"
  },
  	ka: ka,
  	"ka-ge": {
  	language: "Georgian",
  	location: "Georgia",
  	id: 1079,
  	tag: "ka-GE",
  	version: "Release C"
  },
  	de: de,
  	"de-at": {
  	language: "German",
  	location: "Austria",
  	id: 3079,
  	tag: "de-AT",
  	version: "Release A"
  },
  	"de-be": {
  	language: "German",
  	location: "Belgium",
  	id: 4096,
  	tag: "de-BE",
  	version: "Release 10"
  },
  	"de-de": {
  	language: "German",
  	location: "Germany",
  	id: 1031,
  	tag: "de-DE",
  	version: "Release A"
  },
  	"de-it": {
  	language: "German",
  	location: "Italy",
  	id: 4096,
  	tag: "de-IT",
  	version: "Release 10.2"
  },
  	"de-li": {
  	language: "German",
  	location: "Liechtenstein",
  	id: 5127,
  	tag: "de-LI",
  	version: "Release B"
  },
  	"de-lu": {
  	language: "German",
  	location: "Luxembourg",
  	id: 4103,
  	tag: "de-LU",
  	version: "Release B"
  },
  	"de-ch": {
  	language: "German",
  	location: "Switzerland",
  	id: 2055,
  	tag: "de-CH",
  	version: "Release A"
  },
  	el: el,
  	"el-cy": {
  	language: "Greek",
  	location: "Cyprus",
  	id: 4096,
  	tag: "el-CY",
  	version: "Release 10"
  },
  	"el-gr": {
  	language: "Greek",
  	location: "Greece",
  	id: 1032,
  	tag: "el-GR",
  	version: "Release A"
  },
  	kl: kl,
  	"kl-gl": {
  	language: "Greenlandic",
  	location: "Greenland",
  	id: 1135,
  	tag: "kl-GL",
  	version: "Release V"
  },
  	gn: gn,
  	"gn-py": {
  	language: "Guarani",
  	location: "Paraguay",
  	id: 1140,
  	tag: "gn-PY",
  	version: "Release 8.1"
  },
  	gu: gu,
  	"gu-in": {
  	language: "Gujarati",
  	location: "India",
  	id: 1095,
  	tag: "gu-IN",
  	version: "Release D"
  },
  	guz: guz,
  	"guz-ke": {
  	language: "Gusii",
  	location: "Kenya",
  	id: 4096,
  	tag: "guz-KE",
  	version: "Release 10"
  },
  	ha: ha,
  	"ha-latn": {
  	language: "Hausa (Latin)",
  	location: null,
  	id: 31848,
  	tag: "ha-Latn",
  	version: "Windows 7"
  },
  	"ha-latn-gh": {
  	language: "Hausa (Latin)",
  	location: "Ghana",
  	id: 4096,
  	tag: "ha-Latn-GH",
  	version: "Release 10"
  },
  	"ha-latn-ne": {
  	language: "Hausa (Latin)",
  	location: "Niger",
  	id: 4096,
  	tag: "ha-Latn-NE",
  	version: "Release 10"
  },
  	"ha-latn-ng": {
  	language: "Hausa (Latin)",
  	location: "Nigeria",
  	id: 1128,
  	tag: "ha-Latn-NG",
  	version: "Release V"
  },
  	haw: haw,
  	"haw-us": {
  	language: "Hawaiian",
  	location: "United States",
  	id: 1141,
  	tag: "haw-US",
  	version: "Release 8"
  },
  	he: he,
  	"he-il": {
  	language: "Hebrew",
  	location: "Israel",
  	id: 1037,
  	tag: "he-IL",
  	version: "Release B"
  },
  	hi: hi,
  	"hi-in": {
  	language: "Hindi",
  	location: "India",
  	id: 1081,
  	tag: "hi-IN",
  	version: "Release C"
  },
  	hu: hu,
  	"hu-hu": {
  	language: "Hungarian",
  	location: "Hungary",
  	id: 1038,
  	tag: "hu-HU",
  	version: "Release A"
  },
  	is: is,
  	"is-is": {
  	language: "Icelandic",
  	location: "Iceland",
  	id: 1039,
  	tag: "is-IS",
  	version: "Release A"
  },
  	ig: ig,
  	"ig-ng": {
  	language: "Igbo",
  	location: "Nigeria",
  	id: 1136,
  	tag: "ig-NG",
  	version: "Release V"
  },
  	id: id$1,
  	"id-id": {
  	language: "Indonesian",
  	location: "Indonesia",
  	id: 1057,
  	tag: "id-ID",
  	version: "Release B"
  },
  	ia: ia,
  	"ia-fr": {
  	language: "Interlingua",
  	location: "France",
  	id: 4096,
  	tag: "ia-FR",
  	version: "Release 10"
  },
  	"ia-001": {
  	language: "Interlingua",
  	location: "World",
  	id: 4096,
  	tag: "ia-001",
  	version: "Release 10"
  },
  	iu: iu,
  	"iu-latn": {
  	language: "Inuktitut (Latin)",
  	location: null,
  	id: 31837,
  	tag: "iu-Latn",
  	version: "Windows 7"
  },
  	"iu-latn-ca": {
  	language: "Inuktitut (Latin)",
  	location: "Canada",
  	id: 2141,
  	tag: "iu-Latn-CA",
  	version: "Release E2"
  },
  	"iu-cans": {
  	language: "Inuktitut (Syllabics)",
  	location: null,
  	id: 30813,
  	tag: "iu-Cans",
  	version: "Windows 7"
  },
  	"iu-cans-ca": {
  	language: "Inuktitut (Syllabics)",
  	location: "Canada",
  	id: 1117,
  	tag: "iu-Cans-CA",
  	version: "Release V"
  },
  	ga: ga,
  	"ga-ie": {
  	language: "Irish",
  	location: "Ireland",
  	id: 2108,
  	tag: "ga-IE",
  	version: "Release E2"
  },
  	it: it,
  	"it-it": {
  	language: "Italian",
  	location: "Italy",
  	id: 1040,
  	tag: "it-IT",
  	version: "Release A"
  },
  	"it-sm": {
  	language: "Italian",
  	location: "San Marino",
  	id: 4096,
  	tag: "it-SM",
  	version: "Release 10"
  },
  	"it-ch": {
  	language: "Italian",
  	location: "Switzerland",
  	id: 2064,
  	tag: "it-CH",
  	version: "Release A"
  },
  	"it-va": {
  	language: "Italian",
  	location: "Vatican City",
  	id: 4096,
  	tag: "it-VA",
  	version: "Release 10.3"
  },
  	ja: ja,
  	"ja-jp": {
  	language: "Japanese",
  	location: "Japan",
  	id: 1041,
  	tag: "ja-JP",
  	version: "Release A"
  },
  	jv: jv,
  	"jv-latn": {
  	language: "Javanese",
  	location: "Latin",
  	id: 4096,
  	tag: "jv-Latn",
  	version: "Release 8.1"
  },
  	"jv-latn-id": {
  	language: "Javanese",
  	location: "Latin, Indonesia",
  	id: 4096,
  	tag: "jv-Latn-ID",
  	version: "Release 8.1"
  },
  	dyo: dyo,
  	"dyo-sn": {
  	language: "Jola-Fonyi",
  	location: "Senegal",
  	id: 4096,
  	tag: "dyo-SN",
  	version: "Release 10"
  },
  	kea: kea,
  	"kea-cv": {
  	language: "Kabuverdianu",
  	location: "Cabo Verde",
  	id: 4096,
  	tag: "kea-CV",
  	version: "Release 10"
  },
  	kab: kab,
  	"kab-dz": {
  	language: "Kabyle",
  	location: "Algeria",
  	id: 4096,
  	tag: "kab-DZ",
  	version: "Release 10"
  },
  	kkj: kkj,
  	"kkj-cm": {
  	language: "Kako",
  	location: "Cameroon",
  	id: 4096,
  	tag: "kkj-CM",
  	version: "Release 10"
  },
  	kln: kln,
  	"kln-ke": {
  	language: "Kalenjin",
  	location: "Kenya",
  	id: 4096,
  	tag: "kln-KE",
  	version: "Release 10"
  },
  	kam: kam,
  	"kam-ke": {
  	language: "Kamba",
  	location: "Kenya",
  	id: 4096,
  	tag: "kam-KE",
  	version: "Release 10"
  },
  	kn: kn,
  	"kn-in": {
  	language: "Kannada",
  	location: "India",
  	id: 1099,
  	tag: "kn-IN",
  	version: "Release D"
  },
  	ks: ks,
  	"ks-arab": {
  	language: "Kashmiri",
  	location: "Perso-Arabic",
  	id: 1120,
  	tag: "ks-Arab",
  	version: "Release 10"
  },
  	"ks-arab-in": {
  	language: "Kashmiri",
  	location: "Perso-Arabic",
  	id: 4096,
  	tag: "ks-Arab-IN",
  	version: "Release 10"
  },
  	kk: kk,
  	"kk-kz": {
  	language: "Kazakh",
  	location: "Kazakhstan",
  	id: 1087,
  	tag: "kk-KZ",
  	version: "Release C"
  },
  	km: km,
  	"km-kh": {
  	language: "Khmer",
  	location: "Cambodia",
  	id: 1107,
  	tag: "km-KH",
  	version: "Release V"
  },
  	quc: quc,
  	"quc-latn-gt": {
  	language: "K'iche",
  	location: "Guatemala",
  	id: 1158,
  	tag: "quc-Latn-GT",
  	version: "Release 10"
  },
  	ki: ki,
  	"ki-ke": {
  	language: "Kikuyu",
  	location: "Kenya",
  	id: 4096,
  	tag: "ki-KE",
  	version: "Release 10"
  },
  	rw: rw,
  	"rw-rw": {
  	language: "Kinyarwanda",
  	location: "Rwanda",
  	id: 1159,
  	tag: "rw-RW",
  	version: "Release V"
  },
  	sw: sw,
  	"sw-ke": {
  	language: "Kiswahili",
  	location: "Kenya",
  	id: 1089,
  	tag: "sw-KE",
  	version: "Release C"
  },
  	"sw-tz": {
  	language: "Kiswahili",
  	location: "Tanzania",
  	id: 4096,
  	tag: "sw-TZ",
  	version: "Release 10"
  },
  	"sw-ug": {
  	language: "Kiswahili",
  	location: "Uganda",
  	id: 4096,
  	tag: "sw-UG",
  	version: "Release 10"
  },
  	kok: kok,
  	"kok-in": {
  	language: "Konkani",
  	location: "India",
  	id: 1111,
  	tag: "kok-IN",
  	version: "Release C"
  },
  	ko: ko,
  	"ko-kr": {
  	language: "Korean",
  	location: "Korea",
  	id: 1042,
  	tag: "ko-KR",
  	version: "Release A"
  },
  	"ko-kp": {
  	language: "Korean",
  	location: "North Korea",
  	id: 4096,
  	tag: "ko-KP",
  	version: "Release 10.1"
  },
  	khq: khq,
  	"khq-ml": {
  	language: "Koyra Chiini",
  	location: "Mali",
  	id: 4096,
  	tag: "khq-ML",
  	version: "Release 10"
  },
  	ses: ses,
  	"ses-ml": {
  	language: "Koyraboro Senni",
  	location: "Mali",
  	id: 4096,
  	tag: "ses-ML",
  	version: "Release 10"
  },
  	nmg: nmg,
  	"nmg-cm": {
  	language: "Kwasio",
  	location: "Cameroon",
  	id: 4096,
  	tag: "nmg-CM",
  	version: "Release 10"
  },
  	ky: ky,
  	"ky-kg": {
  	language: "Kyrgyz",
  	location: "Kyrgyzstan",
  	id: 1088,
  	tag: "ky-KG",
  	version: "Release D"
  },
  	"ku-arab-ir": {
  	language: "Kurdish",
  	location: "Perso-Arabic, Iran",
  	id: 4096,
  	tag: "ku-Arab-IR",
  	version: "Release 10.1"
  },
  	lkt: lkt,
  	"lkt-us": {
  	language: "Lakota",
  	location: "United States",
  	id: 4096,
  	tag: "lkt-US",
  	version: "Release 10"
  },
  	lag: lag,
  	"lag-tz": {
  	language: "Langi",
  	location: "Tanzania",
  	id: 4096,
  	tag: "lag-TZ",
  	version: "Release 10"
  },
  	lo: lo,
  	"lo-la": {
  	language: "Lao",
  	location: "Lao P.D.R.",
  	id: 1108,
  	tag: "lo-LA",
  	version: "Release V"
  },
  	lv: lv,
  	"lv-lv": {
  	language: "Latvian",
  	location: "Latvia",
  	id: 1062,
  	tag: "lv-LV",
  	version: "Release B"
  },
  	ln: ln,
  	"ln-ao": {
  	language: "Lingala",
  	location: "Angola",
  	id: 4096,
  	tag: "ln-AO",
  	version: "Release 10"
  },
  	"ln-cf": {
  	language: "Lingala",
  	location: "Central African Republic",
  	id: 4096,
  	tag: "ln-CF",
  	version: "Release 10"
  },
  	"ln-cg": {
  	language: "Lingala",
  	location: "Congo",
  	id: 4096,
  	tag: "ln-CG",
  	version: "Release 10"
  },
  	"ln-cd": {
  	language: "Lingala",
  	location: "Congo DRC",
  	id: 4096,
  	tag: "ln-CD",
  	version: "Release 10"
  },
  	lt: lt,
  	"lt-lt": {
  	language: "Lithuanian",
  	location: "Lithuania",
  	id: 1063,
  	tag: "lt-LT",
  	version: "Release B"
  },
  	nds: nds,
  	"nds-de": {
  	language: "Low German ",
  	location: "Germany",
  	id: 4096,
  	tag: "nds-DE",
  	version: "Release 10.2"
  },
  	"nds-nl": {
  	language: "Low German",
  	location: "Netherlands",
  	id: 4096,
  	tag: "nds-NL",
  	version: "Release 10.2"
  },
  	dsb: dsb,
  	"dsb-de": {
  	language: "Lower Sorbian",
  	location: "Germany",
  	id: 2094,
  	tag: "dsb-DE",
  	version: "Release V"
  },
  	lu: lu,
  	"lu-cd": {
  	language: "Luba-Katanga",
  	location: "Congo DRC",
  	id: 4096,
  	tag: "lu-CD",
  	version: "Release 10"
  },
  	luo: luo,
  	"luo-ke": {
  	language: "Luo",
  	location: "Kenya",
  	id: 4096,
  	tag: "luo-KE",
  	version: "Release 10"
  },
  	lb: lb,
  	"lb-lu": {
  	language: "Luxembourgish",
  	location: "Luxembourg",
  	id: 1134,
  	tag: "lb-LU",
  	version: "Release E2"
  },
  	luy: luy,
  	"luy-ke": {
  	language: "Luyia",
  	location: "Kenya",
  	id: 4096,
  	tag: "luy-KE",
  	version: "Release 10"
  },
  	mk: mk,
  	"mk-mk": {
  	language: "Macedonian",
  	location: "North Macedonia ",
  	id: 1071,
  	tag: "mk-MK",
  	version: "Release C"
  },
  	jmc: jmc,
  	"jmc-tz": {
  	language: "Machame",
  	location: "Tanzania",
  	id: 4096,
  	tag: "jmc-TZ",
  	version: "Release 10"
  },
  	mgh: mgh,
  	"mgh-mz": {
  	language: "Makhuwa-Meetto",
  	location: "Mozambique",
  	id: 4096,
  	tag: "mgh-MZ",
  	version: "Release 10"
  },
  	kde: kde,
  	"kde-tz": {
  	language: "Makonde",
  	location: "Tanzania",
  	id: 4096,
  	tag: "kde-TZ",
  	version: "Release 10"
  },
  	mg: mg,
  	"mg-mg": {
  	language: "Malagasy",
  	location: "Madagascar",
  	id: 4096,
  	tag: "mg-MG",
  	version: "Release 8.1"
  },
  	ms: ms,
  	"ms-bn": {
  	language: "Malay",
  	location: "Brunei Darussalam",
  	id: 2110,
  	tag: "ms-BN",
  	version: "Release C"
  },
  	"ms-my": {
  	language: "Malay",
  	location: "Malaysia",
  	id: 1086,
  	tag: "ms-MY",
  	version: "Release C"
  },
  	ml: ml,
  	"ml-in": {
  	language: "Malayalam",
  	location: "India",
  	id: 1100,
  	tag: "ml-IN",
  	version: "Release E1"
  },
  	mt: mt,
  	"mt-mt": {
  	language: "Maltese",
  	location: "Malta",
  	id: 1082,
  	tag: "mt-MT",
  	version: "Release E1"
  },
  	gv: gv,
  	"gv-im": {
  	language: "Manx",
  	location: "Isle of Man",
  	id: 4096,
  	tag: "gv-IM",
  	version: "Release 10"
  },
  	mi: mi,
  	"mi-nz": {
  	language: "Maori",
  	location: "New Zealand",
  	id: 1153,
  	tag: "mi-NZ",
  	version: "Release E1"
  },
  	arn: arn,
  	"arn-cl": {
  	language: "Mapudungun",
  	location: "Chile",
  	id: 1146,
  	tag: "arn-CL",
  	version: "Release E2"
  },
  	mr: mr,
  	"mr-in": {
  	language: "Marathi",
  	location: "India",
  	id: 1102,
  	tag: "mr-IN",
  	version: "Release C"
  },
  	mas: mas,
  	"mas-ke": {
  	language: "Masai",
  	location: "Kenya",
  	id: 4096,
  	tag: "mas-KE",
  	version: "Release 10"
  },
  	"mas-tz": {
  	language: "Masai",
  	location: "Tanzania",
  	id: 4096,
  	tag: "mas-TZ",
  	version: "Release 10"
  },
  	"mzn-ir": {
  	language: "Mazanderani",
  	location: "Iran",
  	id: 4096,
  	tag: "mzn-IR",
  	version: "Release 10.1"
  },
  	mer: mer,
  	"mer-ke": {
  	language: "Meru",
  	location: "Kenya",
  	id: 4096,
  	tag: "mer-KE",
  	version: "Release 10"
  },
  	mgo: mgo,
  	"mgo-cm": {
  	language: "Meta'",
  	location: "Cameroon",
  	id: 4096,
  	tag: "mgo-CM",
  	version: "Release 10"
  },
  	moh: moh,
  	"moh-ca": {
  	language: "Mohawk",
  	location: "Canada",
  	id: 1148,
  	tag: "moh-CA",
  	version: "Release E2"
  },
  	mn: mn,
  	"mn-cyrl": {
  	language: "Mongolian (Cyrillic)",
  	location: null,
  	id: 30800,
  	tag: "mn-Cyrl",
  	version: "Windows 7"
  },
  	"mn-mn": {
  	language: "Mongolian (Cyrillic)",
  	location: "Mongolia",
  	id: 1104,
  	tag: "mn-MN",
  	version: "Release D"
  },
  	"mn-mong": {
  	language: "Mongolian (Traditional ",
  	location: null,
  	id: 31824,
  	tag: "mn-Mong",
  	version: "Windows 7"
  },
  	"mn-mong-": {
  	language: "Mongolian (Traditional ",
  	location: "Mongolia",
  	id: 3152,
  	tag: "mn-Mong-",
  	version: "Windows 7"
  },
  	mfe: mfe,
  	"mfe-mu": {
  	language: "Morisyen",
  	location: "Mauritius",
  	id: 4096,
  	tag: "mfe-MU",
  	version: "Release 10"
  },
  	mua: mua,
  	"mua-cm": {
  	language: "Mundang",
  	location: "Cameroon",
  	id: 4096,
  	tag: "mua-CM",
  	version: "Release 10"
  },
  	nqo: nqo,
  	"nqo-gn": {
  	language: "N'ko",
  	location: "Guinea",
  	id: 4096,
  	tag: "nqo-GN",
  	version: "Release 8.1"
  },
  	naq: naq,
  	"naq-na": {
  	language: "Nama",
  	location: "Namibia",
  	id: 4096,
  	tag: "naq-NA",
  	version: "Release 10"
  },
  	ne: ne,
  	"ne-in": {
  	language: "Nepali",
  	location: "India",
  	id: 2145,
  	tag: "ne-IN",
  	version: "Release 8.1"
  },
  	"ne-np": {
  	language: "Nepali",
  	location: "Nepal",
  	id: 1121,
  	tag: "ne-NP",
  	version: "Release E2"
  },
  	nnh: nnh,
  	"nnh-cm": {
  	language: "Ngiemboon",
  	location: "Cameroon",
  	id: 4096,
  	tag: "nnh-CM",
  	version: "Release 10"
  },
  	jgo: jgo,
  	"jgo-cm": {
  	language: "Ngomba",
  	location: "Cameroon",
  	id: 4096,
  	tag: "jgo-CM",
  	version: "Release 10"
  },
  	"lrc-iq": {
  	language: "Northern Luri",
  	location: "Iraq",
  	id: 4096,
  	tag: "lrc-IQ",
  	version: "Release 10.1"
  },
  	"lrc-ir": {
  	language: "Northern Luri",
  	location: "Iran",
  	id: 4096,
  	tag: "lrc-IR",
  	version: "Release 10.1"
  },
  	nd: nd,
  	"nd-zw": {
  	language: "North Ndebele",
  	location: "Zimbabwe",
  	id: 4096,
  	tag: "nd-ZW",
  	version: "Release 10"
  },
  	no: no,
  	nb: nb,
  	"nb-no": {
  	language: "Norwegian (Bokmal)",
  	location: "Norway",
  	id: 1044,
  	tag: "nb-NO",
  	version: "Release A"
  },
  	nn: nn,
  	"nn-no": {
  	language: "Norwegian (Nynorsk)",
  	location: "Norway",
  	id: 2068,
  	tag: "nn-NO",
  	version: "Release A"
  },
  	"nb-sj": {
  	language: "Norwegian Bokml",
  	location: "Svalbard and Jan Mayen",
  	id: 4096,
  	tag: "nb-SJ",
  	version: "Release 10"
  },
  	nus: nus,
  	"nus-sd": {
  	language: "Nuer",
  	location: "Sudan",
  	id: 4096,
  	tag: "nus-SD",
  	version: "Release 10"
  },
  	"nus-ss": {
  	language: "Nuer",
  	location: "South Sudan",
  	id: 4096,
  	tag: "nus-SS",
  	version: "Release 10.1"
  },
  	nyn: nyn,
  	"nyn-ug": {
  	language: "Nyankole",
  	location: "Uganda",
  	id: 4096,
  	tag: "nyn-UG",
  	version: "Release 10"
  },
  	oc: oc,
  	"oc-fr": {
  	language: "Occitan",
  	location: "France",
  	id: 1154,
  	tag: "oc-FR",
  	version: "Release V"
  },
  	or: or,
  	"or-in": {
  	language: "Odia",
  	location: "India",
  	id: 1096,
  	tag: "or-IN",
  	version: "Release V"
  },
  	om: om,
  	"om-et": {
  	language: "Oromo",
  	location: "Ethiopia",
  	id: 1138,
  	tag: "om-ET",
  	version: "Release 8.1"
  },
  	"om-ke": {
  	language: "Oromo",
  	location: "Kenya",
  	id: 4096,
  	tag: "om-KE",
  	version: "Release 10"
  },
  	os: os,
  	"os-ge": {
  	language: "Ossetian",
  	location: "Cyrillic, Georgia",
  	id: 4096,
  	tag: "os-GE",
  	version: "Release 10"
  },
  	"os-ru": {
  	language: "Ossetian",
  	location: "Cyrillic, Russia",
  	id: 4096,
  	tag: "os-RU",
  	version: "Release 10"
  },
  	ps: ps,
  	"ps-af": {
  	language: "Pashto",
  	location: "Afghanistan",
  	id: 1123,
  	tag: "ps-AF",
  	version: "Release E2"
  },
  	fa: fa,
  	"fa-af": {
  	language: "Persian",
  	location: "Afghanistan",
  	id: 4096,
  	tag: "fa-AF",
  	version: "Release 10"
  },
  	"fa-ir": {
  	language: "Persian",
  	location: "Iran",
  	id: 1065,
  	tag: "fa-IR",
  	version: "Release B"
  },
  	pl: pl,
  	"pl-pl": {
  	language: "Polish",
  	location: "Poland",
  	id: 1045,
  	tag: "pl-PL",
  	version: "Release A"
  },
  	pt: pt,
  	"pt-ao": {
  	language: "Portuguese",
  	location: "Angola",
  	id: 4096,
  	tag: "pt-AO",
  	version: "Release 8.1"
  },
  	"pt-br": {
  	language: "Portuguese",
  	location: "Brazil",
  	id: 1046,
  	tag: "pt-BR",
  	version: "ReleaseA"
  },
  	"pt-cv": {
  	language: "Portuguese",
  	location: "Cabo Verde",
  	id: 4096,
  	tag: "pt-CV",
  	version: "Release 10"
  },
  	"pt-gq": {
  	language: "Portuguese",
  	location: "Equatorial Guinea",
  	id: 4096,
  	tag: "pt-GQ",
  	version: "Release 10.2"
  },
  	"pt-gw": {
  	language: "Portuguese",
  	location: "Guinea-Bissau",
  	id: 4096,
  	tag: "pt-GW",
  	version: "Release 10"
  },
  	"pt-lu": {
  	language: "Portuguese",
  	location: "Luxembourg",
  	id: 4096,
  	tag: "pt-LU",
  	version: "Release 10.2"
  },
  	"pt-mo": {
  	language: "Portuguese",
  	location: "Macao SAR",
  	id: 4096,
  	tag: "pt-MO",
  	version: "Release 10"
  },
  	"pt-mz": {
  	language: "Portuguese",
  	location: "Mozambique",
  	id: 4096,
  	tag: "pt-MZ",
  	version: "Release 10"
  },
  	"pt-pt": {
  	language: "Portuguese",
  	location: "Portugal",
  	id: 2070,
  	tag: "pt-PT",
  	version: "Release A"
  },
  	"pt-st": {
  	language: "Portuguese",
  	location: "So Tom and Prncipe",
  	id: 4096,
  	tag: "pt-ST",
  	version: "Release 10"
  },
  	"pt-ch": {
  	language: "Portuguese",
  	location: "Switzerland",
  	id: 4096,
  	tag: "pt-CH",
  	version: "Release 10.2"
  },
  	"pt-tl": {
  	language: "Portuguese",
  	location: "Timor-Leste",
  	id: 4096,
  	tag: "pt-TL",
  	version: "Release 10"
  },
  	"prg-001": {
  	language: "Prussian",
  	location: null,
  	id: 4096,
  	tag: "prg-001",
  	version: "Release 10.1"
  },
  	"qps-ploca": {
  	language: "Pseudo Language",
  	location: "Pseudo locale for east Asian/complex ",
  	id: 1534,
  	tag: "qps-ploca",
  	version: "Release 7"
  },
  	"qps-ploc": {
  	language: "Pseudo Language",
  	location: "Pseudo locale used for localization ",
  	id: 1281,
  	tag: "qps-ploc",
  	version: "Release 7"
  },
  	"qps-plocm": {
  	language: "Pseudo Language",
  	location: "Pseudo locale used for localization ",
  	id: 2559,
  	tag: "qps-plocm",
  	version: "Release 7"
  },
  	pa: pa,
  	"pa-arab": {
  	language: "Punjabi",
  	location: null,
  	id: 31814,
  	tag: "pa-Arab",
  	version: "Release 8"
  },
  	"pa-in": {
  	language: "Punjabi",
  	location: "India",
  	id: 1094,
  	tag: "pa-IN",
  	version: "Release D"
  },
  	"pa-arab-pk": {
  	language: "Punjabi",
  	location: "Islamic Republic of Pakistan",
  	id: 2118,
  	tag: "pa-Arab-PK",
  	version: "Release 8"
  },
  	quz: quz,
  	"quz-bo": {
  	language: "Quechua",
  	location: "Bolivia",
  	id: 1131,
  	tag: "quz-BO",
  	version: "Release E1"
  },
  	"quz-ec": {
  	language: "Quechua",
  	location: "Ecuador",
  	id: 2155,
  	tag: "quz-EC",
  	version: "Release E1"
  },
  	"quz-pe": {
  	language: "Quechua",
  	location: "Peru",
  	id: 3179,
  	tag: "quz-PE",
  	version: "Release E1"
  },
  	ksh: ksh,
  	"ksh-de": {
  	language: "Ripuarian",
  	location: "Germany",
  	id: 4096,
  	tag: "ksh-DE",
  	version: "Release 10"
  },
  	ro: ro,
  	"ro-md": {
  	language: "Romanian",
  	location: "Moldova",
  	id: 2072,
  	tag: "ro-MD",
  	version: "Release 8.1"
  },
  	"ro-ro": {
  	language: "Romanian",
  	location: "Romania",
  	id: 1048,
  	tag: "ro-RO",
  	version: "Release A"
  },
  	rm: rm,
  	"rm-ch": {
  	language: "Romansh",
  	location: "Switzerland",
  	id: 1047,
  	tag: "rm-CH",
  	version: "Release E2"
  },
  	rof: rof,
  	"rof-tz": {
  	language: "Rombo",
  	location: "Tanzania",
  	id: 4096,
  	tag: "rof-TZ",
  	version: "Release 10"
  },
  	rn: rn,
  	"rn-bi": {
  	language: "Rundi",
  	location: "Burundi",
  	id: 4096,
  	tag: "rn-BI",
  	version: "Release 10"
  },
  	ru: ru,
  	"ru-by": {
  	language: "Russian",
  	location: "Belarus",
  	id: 4096,
  	tag: "ru-BY",
  	version: "Release 10"
  },
  	"ru-kz": {
  	language: "Russian",
  	location: "Kazakhstan",
  	id: 4096,
  	tag: "ru-KZ",
  	version: "Release 10"
  },
  	"ru-kg": {
  	language: "Russian",
  	location: "Kyrgyzstan",
  	id: 4096,
  	tag: "ru-KG",
  	version: "Release 10"
  },
  	"ru-md": {
  	language: "Russian",
  	location: "Moldova",
  	id: 2073,
  	tag: "ru-MD",
  	version: "Release 10"
  },
  	"ru-ru": {
  	language: "Russian",
  	location: "Russia",
  	id: 1049,
  	tag: "ru-RU",
  	version: "Release A"
  },
  	"ru-ua": {
  	language: "Russian",
  	location: "Ukraine",
  	id: 4096,
  	tag: "ru-UA",
  	version: "Release 10"
  },
  	rwk: rwk,
  	"rwk-tz": {
  	language: "Rwa",
  	location: "Tanzania",
  	id: 4096,
  	tag: "rwk-TZ",
  	version: "Release 10"
  },
  	ssy: ssy,
  	"ssy-er": {
  	language: "Saho",
  	location: "Eritrea",
  	id: 4096,
  	tag: "ssy-ER",
  	version: "Release 10"
  },
  	sah: sah,
  	"sah-ru": {
  	language: "Sakha",
  	location: "Russia",
  	id: 1157,
  	tag: "sah-RU",
  	version: "Release V"
  },
  	saq: saq,
  	"saq-ke": {
  	language: "Samburu",
  	location: "Kenya",
  	id: 4096,
  	tag: "saq-KE",
  	version: "Release 10"
  },
  	smn: smn,
  	"smn-fi": {
  	language: "Sami (Inari)",
  	location: "Finland",
  	id: 9275,
  	tag: "smn-FI",
  	version: "Release E1"
  },
  	smj: smj,
  	"smj-no": {
  	language: "Sami (Lule)",
  	location: "Norway",
  	id: 4155,
  	tag: "smj-NO",
  	version: "Release E1"
  },
  	"smj-se": {
  	language: "Sami (Lule)",
  	location: "Sweden",
  	id: 5179,
  	tag: "smj-SE",
  	version: "Release E1"
  },
  	se: se,
  	"se-fi": {
  	language: "Sami (Northern)",
  	location: "Finland",
  	id: 3131,
  	tag: "se-FI",
  	version: "Release E1"
  },
  	"se-no": {
  	language: "Sami (Northern)",
  	location: "Norway",
  	id: 1083,
  	tag: "se-NO",
  	version: "Release E1"
  },
  	"se-se": {
  	language: "Sami (Northern)",
  	location: "Sweden",
  	id: 2107,
  	tag: "se-SE",
  	version: "Release E1"
  },
  	sms: sms,
  	"sms-fi": {
  	language: "Sami (Skolt)",
  	location: "Finland",
  	id: 8251,
  	tag: "sms-FI",
  	version: "Release E1"
  },
  	sma: sma,
  	"sma-no": {
  	language: "Sami (Southern)",
  	location: "Norway",
  	id: 6203,
  	tag: "sma-NO",
  	version: "Release E1"
  },
  	"sma-se": {
  	language: "Sami (Southern)",
  	location: "Sweden",
  	id: 7227,
  	tag: "sma-SE",
  	version: "Release E1"
  },
  	sg: sg,
  	"sg-cf": {
  	language: "Sango",
  	location: "Central African Republic",
  	id: 4096,
  	tag: "sg-CF",
  	version: "Release 10"
  },
  	sbp: sbp,
  	"sbp-tz": {
  	language: "Sangu",
  	location: "Tanzania",
  	id: 4096,
  	tag: "sbp-TZ",
  	version: "Release 10"
  },
  	sa: sa,
  	"sa-in": {
  	language: "Sanskrit",
  	location: "India",
  	id: 1103,
  	tag: "sa-IN",
  	version: "Release C"
  },
  	gd: gd,
  	"gd-gb": {
  	language: "Scottish Gaelic",
  	location: "United Kingdom",
  	id: 1169,
  	tag: "gd-GB",
  	version: "Release 7"
  },
  	seh: seh,
  	"seh-mz": {
  	language: "Sena",
  	location: "Mozambique",
  	id: 4096,
  	tag: "seh-MZ",
  	version: "Release 10"
  },
  	"sr-cyrl": {
  	language: "Serbian (Cyrillic)",
  	location: null,
  	id: 27674,
  	tag: "sr-Cyrl",
  	version: "Windows 7"
  },
  	"sr-cyrl-ba": {
  	language: "Serbian (Cyrillic)",
  	location: "Bosnia and Herzegovina",
  	id: 7194,
  	tag: "sr-Cyrl-BA",
  	version: "Release E1"
  },
  	"sr-cyrl-me": {
  	language: "Serbian (Cyrillic)",
  	location: "Montenegro",
  	id: 12314,
  	tag: "sr-Cyrl-ME",
  	version: "Release 7"
  },
  	"sr-cyrl-rs": {
  	language: "Serbian (Cyrillic)",
  	location: "Serbia",
  	id: 10266,
  	tag: "sr-Cyrl-RS",
  	version: "Release 7"
  },
  	"sr-cyrl-cs": {
  	language: "Serbian (Cyrillic)",
  	location: "Serbia and Montenegro (Former)",
  	id: 3098,
  	tag: "sr-Cyrl-CS",
  	version: "Release B"
  },
  	"sr-latn": {
  	language: "Serbian (Latin)",
  	location: null,
  	id: 28698,
  	tag: "sr-Latn",
  	version: "Windows 7"
  },
  	sr: sr,
  	"sr-latn-ba": {
  	language: "Serbian (Latin)",
  	location: "Bosnia and Herzegovina",
  	id: 6170,
  	tag: "sr-Latn-BA",
  	version: "Release E1"
  },
  	"sr-latn-me": {
  	language: "Serbian (Latin)",
  	location: "Montenegro",
  	id: 11290,
  	tag: "sr-Latn-ME",
  	version: "Release 7"
  },
  	"sr-latn-rs": {
  	language: "Serbian (Latin)",
  	location: "Serbia",
  	id: 9242,
  	tag: "sr-Latn-RS",
  	version: "Release 7"
  },
  	"sr-latn-cs": {
  	language: "Serbian (Latin)",
  	location: "Serbia and Montenegro (Former)",
  	id: 2074,
  	tag: "sr-Latn-CS",
  	version: "Release B"
  },
  	nso: nso,
  	"nso-za": {
  	language: "Sesotho sa Leboa",
  	location: "South Africa",
  	id: 1132,
  	tag: "nso-ZA",
  	version: "Release E1"
  },
  	tn: tn,
  	"tn-bw": {
  	language: "Setswana",
  	location: "Botswana",
  	id: 2098,
  	tag: "tn-BW",
  	version: "Release 8"
  },
  	"tn-za": {
  	language: "Setswana",
  	location: "South Africa",
  	id: 1074,
  	tag: "tn-ZA",
  	version: "Release E1"
  },
  	ksb: ksb,
  	"ksb-tz": {
  	language: "Shambala",
  	location: "Tanzania",
  	id: 4096,
  	tag: "ksb-TZ",
  	version: "Release 10"
  },
  	sn: sn,
  	"sn-latn": {
  	language: "Shona",
  	location: "Latin",
  	id: 4096,
  	tag: "sn-Latn",
  	version: "Release 8.1"
  },
  	"sn-latn-zw": {
  	language: "Shona",
  	location: "Zimbabwe",
  	id: 4096,
  	tag: "sn-Latn-ZW",
  	version: "Release 8.1"
  },
  	sd: sd,
  	"sd-arab": {
  	language: "Sindhi",
  	location: null,
  	id: 31833,
  	tag: "sd-Arab",
  	version: "Release 8"
  },
  	"sd-arab-pk": {
  	language: "Sindhi",
  	location: "Islamic Republic of Pakistan",
  	id: 2137,
  	tag: "sd-Arab-PK",
  	version: "Release 8"
  },
  	si: si,
  	"si-lk": {
  	language: "Sinhala",
  	location: "Sri Lanka",
  	id: 1115,
  	tag: "si-LK",
  	version: "Release V"
  },
  	sk: sk,
  	"sk-sk": {
  	language: "Slovak",
  	location: "Slovakia",
  	id: 1051,
  	tag: "sk-SK",
  	version: "Release A"
  },
  	sl: sl,
  	"sl-si": {
  	language: "Slovenian",
  	location: "Slovenia",
  	id: 1060,
  	tag: "sl-SI",
  	version: "Release A"
  },
  	xog: xog,
  	"xog-ug": {
  	language: "Soga",
  	location: "Uganda",
  	id: 4096,
  	tag: "xog-UG",
  	version: "Release 10"
  },
  	so: so,
  	"so-dj": {
  	language: "Somali",
  	location: "Djibouti",
  	id: 4096,
  	tag: "so-DJ",
  	version: "Release 10"
  },
  	"so-et": {
  	language: "Somali",
  	location: "Ethiopia",
  	id: 4096,
  	tag: "so-ET",
  	version: "Release 10"
  },
  	"so-ke": {
  	language: "Somali",
  	location: "Kenya",
  	id: 4096,
  	tag: "so-KE",
  	version: "Release 10"
  },
  	"so-so": {
  	language: "Somali",
  	location: "Somalia",
  	id: 1143,
  	tag: "so-SO",
  	version: "Release 8.1"
  },
  	st: st,
  	"st-za": {
  	language: "Sotho",
  	location: "South Africa",
  	id: 1072,
  	tag: "st-ZA",
  	version: "Release 8.1"
  },
  	nr: nr,
  	"nr-za": {
  	language: "South Ndebele",
  	location: "South Africa",
  	id: 4096,
  	tag: "nr-ZA",
  	version: "Release 10"
  },
  	"st-ls": {
  	language: "Southern Sotho",
  	location: "Lesotho",
  	id: 4096,
  	tag: "st-LS",
  	version: "Release 10"
  },
  	es: es,
  	"es-ar": {
  	language: "Spanish",
  	location: "Argentina",
  	id: 11274,
  	tag: "es-AR",
  	version: "Release B"
  },
  	"es-bz": {
  	language: "Spanish",
  	location: "Belize",
  	id: 4096,
  	tag: "es-BZ",
  	version: "Release 10.3"
  },
  	"es-ve": {
  	language: "Spanish",
  	location: "Bolivarian Republic of Venezuela",
  	id: 8202,
  	tag: "es-VE",
  	version: "Release B"
  },
  	"es-bo": {
  	language: "Spanish",
  	location: "Bolivia",
  	id: 16394,
  	tag: "es-BO",
  	version: "Release B"
  },
  	"es-br": {
  	language: "Spanish",
  	location: "Brazil",
  	id: 4096,
  	tag: "es-BR",
  	version: "Release 10.2"
  },
  	"es-cl": {
  	language: "Spanish",
  	location: "Chile",
  	id: 13322,
  	tag: "es-CL",
  	version: "Release B"
  },
  	"es-co": {
  	language: "Spanish",
  	location: "Colombia",
  	id: 9226,
  	tag: "es-CO",
  	version: "Release B"
  },
  	"es-cr": {
  	language: "Spanish",
  	location: "Costa Rica",
  	id: 5130,
  	tag: "es-CR",
  	version: "Release B"
  },
  	"es-cu": {
  	language: "Spanish",
  	location: "Cuba",
  	id: 23562,
  	tag: "es-CU",
  	version: "Release 10"
  },
  	"es-do": {
  	language: "Spanish",
  	location: "Dominican Republic",
  	id: 7178,
  	tag: "es-DO",
  	version: "Release B"
  },
  	"es-ec": {
  	language: "Spanish",
  	location: "Ecuador",
  	id: 12298,
  	tag: "es-EC",
  	version: "Release B"
  },
  	"es-sv": {
  	language: "Spanish",
  	location: "El Salvador",
  	id: 17418,
  	tag: "es-SV",
  	version: "Release B"
  },
  	"es-gq": {
  	language: "Spanish",
  	location: "Equatorial Guinea",
  	id: 4096,
  	tag: "es-GQ",
  	version: "Release 10"
  },
  	"es-gt": {
  	language: "Spanish",
  	location: "Guatemala",
  	id: 4106,
  	tag: "es-GT",
  	version: "Release B"
  },
  	"es-hn": {
  	language: "Spanish",
  	location: "Honduras",
  	id: 18442,
  	tag: "es-HN",
  	version: "Release B"
  },
  	"es-419": {
  	language: "Spanish",
  	location: "Latin America",
  	id: 22538,
  	tag: "es-419",
  	version: "Release 8.1"
  },
  	"es-mx": {
  	language: "Spanish",
  	location: "Mexico",
  	id: 2058,
  	tag: "es-MX",
  	version: "Release A"
  },
  	"es-ni": {
  	language: "Spanish",
  	location: "Nicaragua",
  	id: 19466,
  	tag: "es-NI",
  	version: "Release B"
  },
  	"es-pa": {
  	language: "Spanish",
  	location: "Panama",
  	id: 6154,
  	tag: "es-PA",
  	version: "Release B"
  },
  	"es-py": {
  	language: "Spanish",
  	location: "Paraguay",
  	id: 15370,
  	tag: "es-PY",
  	version: "Release B"
  },
  	"es-pe": {
  	language: "Spanish",
  	location: "Peru",
  	id: 10250,
  	tag: "es-PE",
  	version: "Release B"
  },
  	"es-ph": {
  	language: "Spanish",
  	location: "Philippines",
  	id: 4096,
  	tag: "es-PH",
  	version: "Release 10"
  },
  	"es-pr": {
  	language: "Spanish",
  	location: "Puerto Rico",
  	id: 20490,
  	tag: "es-PR",
  	version: "Release B"
  },
  	"es-es_tradnl": {
  	language: "Spanish",
  	location: "Spain",
  	id: 1034,
  	tag: "es-ES_tradnl",
  	version: "Release A"
  },
  	"es-es": {
  	language: "Spanish",
  	location: "Spain",
  	id: 3082,
  	tag: "es-ES",
  	version: "Release A"
  },
  	"es-us": {
  	language: "Spanish",
  	location: "United States",
  	id: 21514,
  	tag: "es-US",
  	version: "Release V"
  },
  	"es-uy": {
  	language: "Spanish",
  	location: "Uruguay",
  	id: 14346,
  	tag: "es-UY",
  	version: "Release B"
  },
  	zgh: zgh,
  	"zgh-tfng-ma": {
  	language: "Standard Moroccan ",
  	location: "Morocco",
  	id: 4096,
  	tag: "zgh-Tfng-MA",
  	version: "Release 8.1"
  },
  	"zgh-tfng": {
  	language: "Standard Moroccan ",
  	location: "Tifinagh",
  	id: 4096,
  	tag: "zgh-Tfng",
  	version: "Release 8.1"
  },
  	ss: ss,
  	"ss-za": {
  	language: "Swati",
  	location: "South Africa",
  	id: 4096,
  	tag: "ss-ZA",
  	version: "Release 10"
  },
  	"ss-sz": {
  	language: "Swati",
  	location: "Swaziland",
  	id: 4096,
  	tag: "ss-SZ",
  	version: "Release 10"
  },
  	sv: sv,
  	"sv-ax": {
  	language: "Swedish",
  	location: "land Islands",
  	id: 4096,
  	tag: "sv-AX",
  	version: "Release 10"
  },
  	"sv-fi": {
  	language: "Swedish",
  	location: "Finland",
  	id: 2077,
  	tag: "sv-FI",
  	version: "ReleaseB"
  },
  	"sv-se": {
  	language: "Swedish",
  	location: "Sweden",
  	id: 1053,
  	tag: "sv-SE",
  	version: "Release A"
  },
  	syr: syr,
  	"syr-sy": {
  	language: "Syriac",
  	location: "Syria",
  	id: 1114,
  	tag: "syr-SY",
  	version: "Release D"
  },
  	shi: shi,
  	"shi-tfng": {
  	language: "Tachelhit",
  	location: "Tifinagh",
  	id: 4096,
  	tag: "shi-Tfng",
  	version: "Release 10"
  },
  	"shi-tfng-ma": {
  	language: "Tachelhit",
  	location: "Tifinagh, Morocco",
  	id: 4096,
  	tag: "shi-Tfng-MA",
  	version: "Release 10"
  },
  	"shi-latn": {
  	language: "Tachelhit (Latin)",
  	location: null,
  	id: 4096,
  	tag: "shi-Latn",
  	version: "Release 10"
  },
  	"shi-latn-ma": {
  	language: "Tachelhit (Latin)",
  	location: "Morocco",
  	id: 4096,
  	tag: "shi-Latn-MA",
  	version: "Release 10"
  },
  	dav: dav,
  	"dav-ke": {
  	language: "Taita",
  	location: "Kenya",
  	id: 4096,
  	tag: "dav-KE",
  	version: "Release 10"
  },
  	tg: tg,
  	"tg-cyrl": {
  	language: "Tajik (Cyrillic)",
  	location: null,
  	id: 31784,
  	tag: "tg-Cyrl",
  	version: "Windows 7"
  },
  	"tg-cyrl-tj": {
  	language: "Tajik (Cyrillic)",
  	location: "Tajikistan",
  	id: 1064,
  	tag: "tg-Cyrl-TJ",
  	version: "Release V"
  },
  	tzm: tzm,
  	"tzm-latn": {
  	language: "Tamazight (Latin)",
  	location: null,
  	id: 31839,
  	tag: "tzm-Latn",
  	version: "Windows 7"
  },
  	"tzm-latn-dz": {
  	language: "Tamazight (Latin)",
  	location: "Algeria",
  	id: 2143,
  	tag: "tzm-Latn-DZ",
  	version: "Release V"
  },
  	ta: ta,
  	"ta-in": {
  	language: "Tamil",
  	location: "India",
  	id: 1097,
  	tag: "ta-IN",
  	version: "Release C"
  },
  	"ta-my": {
  	language: "Tamil",
  	location: "Malaysia",
  	id: 4096,
  	tag: "ta-MY",
  	version: "Release 10"
  },
  	"ta-sg": {
  	language: "Tamil",
  	location: "Singapore",
  	id: 4096,
  	tag: "ta-SG",
  	version: "Release 10"
  },
  	"ta-lk": {
  	language: "Tamil",
  	location: "Sri Lanka",
  	id: 2121,
  	tag: "ta-LK",
  	version: "Release 8"
  },
  	twq: twq,
  	"twq-ne": {
  	language: "Tasawaq",
  	location: "Niger",
  	id: 4096,
  	tag: "twq-NE",
  	version: "Release 10"
  },
  	tt: tt,
  	"tt-ru": {
  	language: "Tatar",
  	location: "Russia",
  	id: 1092,
  	tag: "tt-RU",
  	version: "Release D"
  },
  	te: te,
  	"te-in": {
  	language: "Telugu",
  	location: "India",
  	id: 1098,
  	tag: "te-IN",
  	version: "Release D"
  },
  	teo: teo,
  	"teo-ke": {
  	language: "Teso",
  	location: "Kenya",
  	id: 4096,
  	tag: "teo-KE",
  	version: "Release 10"
  },
  	"teo-ug": {
  	language: "Teso",
  	location: "Uganda",
  	id: 4096,
  	tag: "teo-UG",
  	version: "Release 10"
  },
  	th: th,
  	"th-th": {
  	language: "Thai",
  	location: "Thailand",
  	id: 1054,
  	tag: "th-TH",
  	version: "Release B"
  },
  	bo: bo,
  	"bo-in": {
  	language: "Tibetan",
  	location: "India",
  	id: 4096,
  	tag: "bo-IN",
  	version: "Release 10"
  },
  	"bo-cn": {
  	language: "Tibetan",
  	location: "People's Republic of China",
  	id: 1105,
  	tag: "bo-CN",
  	version: "Release V"
  },
  	tig: tig,
  	"tig-er": {
  	language: "Tigre",
  	location: "Eritrea",
  	id: 4096,
  	tag: "tig-ER",
  	version: "Release 10"
  },
  	ti: ti,
  	"ti-er": {
  	language: "Tigrinya",
  	location: "Eritrea",
  	id: 2163,
  	tag: "ti-ER",
  	version: "Release 8"
  },
  	"ti-et": {
  	language: "Tigrinya",
  	location: "Ethiopia",
  	id: 1139,
  	tag: "ti-ET",
  	version: "Release 8"
  },
  	to: to,
  	"to-to": {
  	language: "Tongan",
  	location: "Tonga",
  	id: 4096,
  	tag: "to-TO",
  	version: "Release 10"
  },
  	ts: ts,
  	"ts-za": {
  	language: "Tsonga",
  	location: "South Africa",
  	id: 1073,
  	tag: "ts-ZA",
  	version: "Release 8.1"
  },
  	tr: tr,
  	"tr-cy": {
  	language: "Turkish",
  	location: "Cyprus",
  	id: 4096,
  	tag: "tr-CY",
  	version: "Release 10"
  },
  	"tr-tr": {
  	language: "Turkish",
  	location: "Turkey",
  	id: 1055,
  	tag: "tr-TR",
  	version: "Release A"
  },
  	tk: tk,
  	"tk-tm": {
  	language: "Turkmen",
  	location: "Turkmenistan",
  	id: 1090,
  	tag: "tk-TM",
  	version: "Release V"
  },
  	uk: uk,
  	"uk-ua": {
  	language: "Ukrainian",
  	location: "Ukraine",
  	id: 1058,
  	tag: "uk-UA",
  	version: "Release B"
  },
  	hsb: hsb,
  	"hsb-de": {
  	language: "Upper Sorbian",
  	location: "Germany",
  	id: 1070,
  	tag: "hsb-DE",
  	version: "Release V"
  },
  	ur: ur,
  	"ur-in": {
  	language: "Urdu",
  	location: "India",
  	id: 2080,
  	tag: "ur-IN",
  	version: "Release 8.1"
  },
  	"ur-pk": {
  	language: "Urdu",
  	location: "Islamic Republic of Pakistan",
  	id: 1056,
  	tag: "ur-PK",
  	version: "Release C"
  },
  	ug: ug,
  	"ug-cn": {
  	language: "Uyghur",
  	location: "People's Republic of China",
  	id: 1152,
  	tag: "ug-CN",
  	version: "Release V"
  },
  	"uz-arab": {
  	language: "Uzbek",
  	location: "Perso-Arabic",
  	id: 4096,
  	tag: "uz-Arab",
  	version: "Release 10"
  },
  	"uz-arab-af": {
  	language: "Uzbek",
  	location: "Perso-Arabic, Afghanistan",
  	id: 4096,
  	tag: "uz-Arab-AF",
  	version: "Release 10"
  },
  	"uz-cyrl": {
  	language: "Uzbek (Cyrillic)",
  	location: null,
  	id: 30787,
  	tag: "uz-Cyrl",
  	version: "Windows 7"
  },
  	"uz-cyrl-uz": {
  	language: "Uzbek (Cyrillic)",
  	location: "Uzbekistan",
  	id: 2115,
  	tag: "uz-Cyrl-UZ",
  	version: "Release C"
  },
  	uz: uz,
  	"uz-latn": {
  	language: "Uzbek (Latin)",
  	location: null,
  	id: 31811,
  	tag: "uz-Latn",
  	version: "Windows 7"
  },
  	"uz-latn-uz": {
  	language: "Uzbek (Latin)",
  	location: "Uzbekistan",
  	id: 1091,
  	tag: "uz-Latn-UZ",
  	version: "Release C"
  },
  	vai: vai,
  	"vai-vaii": {
  	language: "Vai",
  	location: null,
  	id: 4096,
  	tag: "vai-Vaii",
  	version: "Release 10"
  },
  	"vai-vaii-lr": {
  	language: "Vai",
  	location: "Liberia",
  	id: 4096,
  	tag: "vai-Vaii-LR",
  	version: "Release 10"
  },
  	"vai-latn-lr": {
  	language: "Vai (Latin)",
  	location: "Liberia",
  	id: 4096,
  	tag: "vai-Latn-LR",
  	version: "Release 10"
  },
  	"vai-latn": {
  	language: "Vai (Latin)",
  	location: null,
  	id: 4096,
  	tag: "vai-Latn",
  	version: "Release 10"
  },
  	"ca-es-": {
  	language: "Valencian",
  	location: "Spain",
  	id: 2051,
  	tag: "ca-ES-",
  	version: "Release 8"
  },
  	ve: ve,
  	"ve-za": {
  	language: "Venda",
  	location: "South Africa",
  	id: 1075,
  	tag: "ve-ZA",
  	version: "Release 10"
  },
  	vi: vi,
  	"vi-vn": {
  	language: "Vietnamese",
  	location: "Vietnam",
  	id: 1066,
  	tag: "vi-VN",
  	version: "Release B"
  },
  	vo: vo,
  	"vo-001": {
  	language: "Volapk",
  	location: "World",
  	id: 4096,
  	tag: "vo-001",
  	version: "Release 10"
  },
  	vun: vun,
  	"vun-tz": {
  	language: "Vunjo",
  	location: "Tanzania",
  	id: 4096,
  	tag: "vun-TZ",
  	version: "Release 10"
  },
  	wae: wae,
  	"wae-ch": {
  	language: "Walser",
  	location: "Switzerland",
  	id: 4096,
  	tag: "wae-CH",
  	version: "Release 10"
  },
  	cy: cy,
  	"cy-gb": {
  	language: "Welsh",
  	location: "United Kingdom",
  	id: 1106,
  	tag: "cy-GB",
  	version: "ReleaseE1"
  },
  	wal: wal,
  	"wal-et": {
  	language: "Wolaytta",
  	location: "Ethiopia",
  	id: 4096,
  	tag: "wal-ET",
  	version: "Release 10"
  },
  	wo: wo,
  	"wo-sn": {
  	language: "Wolof",
  	location: "Senegal",
  	id: 1160,
  	tag: "wo-SN",
  	version: "Release V"
  },
  	xh: xh,
  	"xh-za": {
  	language: "Xhosa",
  	location: "South Africa",
  	id: 1076,
  	tag: "xh-ZA",
  	version: "Release E1"
  },
  	yav: yav,
  	"yav-cm": {
  	language: "Yangben",
  	location: "Cameroon",
  	id: 4096,
  	tag: "yav-CM",
  	version: "Release 10"
  },
  	ii: ii,
  	"ii-cn": {
  	language: "Yi",
  	location: "People's Republic of China",
  	id: 1144,
  	tag: "ii-CN",
  	version: "Release V"
  },
  	yo: yo,
  	"yo-bj": {
  	language: "Yoruba",
  	location: "Benin",
  	id: 4096,
  	tag: "yo-BJ",
  	version: "Release 10"
  },
  	"yo-ng": {
  	language: "Yoruba",
  	location: "Nigeria",
  	id: 1130,
  	tag: "yo-NG",
  	version: "Release V"
  },
  	dje: dje,
  	"dje-ne": {
  	language: "Zarma",
  	location: "Niger",
  	id: 4096,
  	tag: "dje-NE",
  	version: "Release 10"
  },
  	zu: zu,
  	"zu-za": {
  	language: "Zulu",
  	location: "South Africa",
  	id: 1077,
  	tag: "zu-ZA",
  	version: "Release E1"
  }
  };

  var Abkhazian = {
  	name: "Abkhazian",
  	names: [
  		"Abkhazian"
  	],
  	"iso639-2": "abk",
  	"iso639-1": "ab"
  };
  var Achinese = {
  	name: "Achinese",
  	names: [
  		"Achinese"
  	],
  	"iso639-2": "ace",
  	"iso639-1": null
  };
  var Acoli = {
  	name: "Acoli",
  	names: [
  		"Acoli"
  	],
  	"iso639-2": "ach",
  	"iso639-1": null
  };
  var Adangme = {
  	name: "Adangme",
  	names: [
  		"Adangme"
  	],
  	"iso639-2": "ada",
  	"iso639-1": null
  };
  var Adygei = {
  	name: "Adygei",
  	names: [
  		"Adyghe",
  		"Adygei"
  	],
  	"iso639-2": "ady",
  	"iso639-1": null
  };
  var Adyghe = {
  	name: "Adyghe",
  	names: [
  		"Adyghe",
  		"Adygei"
  	],
  	"iso639-2": "ady",
  	"iso639-1": null
  };
  var Afar = {
  	name: "Afar",
  	names: [
  		"Afar"
  	],
  	"iso639-2": "aar",
  	"iso639-1": "aa"
  };
  var Afrihili = {
  	name: "Afrihili",
  	names: [
  		"Afrihili"
  	],
  	"iso639-2": "afh",
  	"iso639-1": null
  };
  var Afrikaans = {
  	name: "Afrikaans",
  	names: [
  		"Afrikaans"
  	],
  	"iso639-2": "afr",
  	"iso639-1": "af"
  };
  var Ainu = {
  	name: "Ainu",
  	names: [
  		"Ainu"
  	],
  	"iso639-2": "ain",
  	"iso639-1": null
  };
  var Akan = {
  	name: "Akan",
  	names: [
  		"Akan"
  	],
  	"iso639-2": "aka",
  	"iso639-1": "ak"
  };
  var Akkadian = {
  	name: "Akkadian",
  	names: [
  		"Akkadian"
  	],
  	"iso639-2": "akk",
  	"iso639-1": null
  };
  var Albanian = {
  	name: "Albanian",
  	names: [
  		"Albanian"
  	],
  	"iso639-2": "alb/sqi",
  	"iso639-1": "sq"
  };
  var Alemannic = {
  	name: "Alemannic",
  	names: [
  		"Swiss German",
  		"Alemannic",
  		"Alsatian"
  	],
  	"iso639-2": "gsw",
  	"iso639-1": null
  };
  var Aleut = {
  	name: "Aleut",
  	names: [
  		"Aleut"
  	],
  	"iso639-2": "ale",
  	"iso639-1": null
  };
  var Alsatian = {
  	name: "Alsatian",
  	names: [
  		"Swiss German",
  		"Alemannic",
  		"Alsatian"
  	],
  	"iso639-2": "gsw",
  	"iso639-1": null
  };
  var Amharic = {
  	name: "Amharic",
  	names: [
  		"Amharic"
  	],
  	"iso639-2": "amh",
  	"iso639-1": "am"
  };
  var Angika = {
  	name: "Angika",
  	names: [
  		"Angika"
  	],
  	"iso639-2": "anp",
  	"iso639-1": null
  };
  var Arabic = {
  	name: "Arabic",
  	names: [
  		"Arabic"
  	],
  	"iso639-2": "ara",
  	"iso639-1": "ar"
  };
  var Aragonese = {
  	name: "Aragonese",
  	names: [
  		"Aragonese"
  	],
  	"iso639-2": "arg",
  	"iso639-1": "an"
  };
  var Arapaho = {
  	name: "Arapaho",
  	names: [
  		"Arapaho"
  	],
  	"iso639-2": "arp",
  	"iso639-1": null
  };
  var Arawak = {
  	name: "Arawak",
  	names: [
  		"Arawak"
  	],
  	"iso639-2": "arw",
  	"iso639-1": null
  };
  var Armenian = {
  	name: "Armenian",
  	names: [
  		"Armenian"
  	],
  	"iso639-2": "arm/hye",
  	"iso639-1": "hy"
  };
  var Aromanian = {
  	name: "Aromanian",
  	names: [
  		"Aromanian",
  		"Arumanian",
  		"Macedo-Romanian"
  	],
  	"iso639-2": "rup",
  	"iso639-1": null
  };
  var Arumanian = {
  	name: "Arumanian",
  	names: [
  		"Aromanian",
  		"Arumanian",
  		"Macedo-Romanian"
  	],
  	"iso639-2": "rup",
  	"iso639-1": null
  };
  var Assamese = {
  	name: "Assamese",
  	names: [
  		"Assamese"
  	],
  	"iso639-2": "asm",
  	"iso639-1": "as"
  };
  var Asturian = {
  	name: "Asturian",
  	names: [
  		"Asturian",
  		"Bable",
  		"Leonese",
  		"Asturleonese"
  	],
  	"iso639-2": "ast",
  	"iso639-1": null
  };
  var Asturleonese = {
  	name: "Asturleonese",
  	names: [
  		"Asturian",
  		"Bable",
  		"Leonese",
  		"Asturleonese"
  	],
  	"iso639-2": "ast",
  	"iso639-1": null
  };
  var Avaric = {
  	name: "Avaric",
  	names: [
  		"Avaric"
  	],
  	"iso639-2": "ava",
  	"iso639-1": "av"
  };
  var Avestan = {
  	name: "Avestan",
  	names: [
  		"Avestan"
  	],
  	"iso639-2": "ave",
  	"iso639-1": "ae"
  };
  var Awadhi = {
  	name: "Awadhi",
  	names: [
  		"Awadhi"
  	],
  	"iso639-2": "awa",
  	"iso639-1": null
  };
  var Aymara = {
  	name: "Aymara",
  	names: [
  		"Aymara"
  	],
  	"iso639-2": "aym",
  	"iso639-1": "ay"
  };
  var Azerbaijani = {
  	name: "Azerbaijani",
  	names: [
  		"Azerbaijani"
  	],
  	"iso639-2": "aze",
  	"iso639-1": "az"
  };
  var Bable = {
  	name: "Bable",
  	names: [
  		"Asturian",
  		"Bable",
  		"Leonese",
  		"Asturleonese"
  	],
  	"iso639-2": "ast",
  	"iso639-1": null
  };
  var Balinese = {
  	name: "Balinese",
  	names: [
  		"Balinese"
  	],
  	"iso639-2": "ban",
  	"iso639-1": null
  };
  var Baluchi = {
  	name: "Baluchi",
  	names: [
  		"Baluchi"
  	],
  	"iso639-2": "bal",
  	"iso639-1": null
  };
  var Bambara = {
  	name: "Bambara",
  	names: [
  		"Bambara"
  	],
  	"iso639-2": "bam",
  	"iso639-1": "bm"
  };
  var Basa = {
  	name: "Basa",
  	names: [
  		"Basa"
  	],
  	"iso639-2": "bas",
  	"iso639-1": null
  };
  var Bashkir = {
  	name: "Bashkir",
  	names: [
  		"Bashkir"
  	],
  	"iso639-2": "bak",
  	"iso639-1": "ba"
  };
  var Basque = {
  	name: "Basque",
  	names: [
  		"Basque"
  	],
  	"iso639-2": "baq/eus",
  	"iso639-1": "eu"
  };
  var Bedawiyet = {
  	name: "Bedawiyet",
  	names: [
  		"Beja",
  		"Bedawiyet"
  	],
  	"iso639-2": "bej",
  	"iso639-1": null
  };
  var Beja = {
  	name: "Beja",
  	names: [
  		"Beja",
  		"Bedawiyet"
  	],
  	"iso639-2": "bej",
  	"iso639-1": null
  };
  var Belarusian = {
  	name: "Belarusian",
  	names: [
  		"Belarusian"
  	],
  	"iso639-2": "bel",
  	"iso639-1": "be"
  };
  var Bemba = {
  	name: "Bemba",
  	names: [
  		"Bemba"
  	],
  	"iso639-2": "bem",
  	"iso639-1": null
  };
  var Bengali = {
  	name: "Bengali",
  	names: [
  		"Bengali"
  	],
  	"iso639-2": "ben",
  	"iso639-1": "bn"
  };
  var Bhojpuri = {
  	name: "Bhojpuri",
  	names: [
  		"Bhojpuri"
  	],
  	"iso639-2": "bho",
  	"iso639-1": null
  };
  var Bikol = {
  	name: "Bikol",
  	names: [
  		"Bikol"
  	],
  	"iso639-2": "bik",
  	"iso639-1": null
  };
  var Bilin = {
  	name: "Bilin",
  	names: [
  		"Blin",
  		"Bilin"
  	],
  	"iso639-2": "byn",
  	"iso639-1": null
  };
  var Bini = {
  	name: "Bini",
  	names: [
  		"Bini",
  		"Edo"
  	],
  	"iso639-2": "bin",
  	"iso639-1": null
  };
  var Bislama = {
  	name: "Bislama",
  	names: [
  		"Bislama"
  	],
  	"iso639-2": "bis",
  	"iso639-1": "bi"
  };
  var Blin = {
  	name: "Blin",
  	names: [
  		"Blin",
  		"Bilin"
  	],
  	"iso639-2": "byn",
  	"iso639-1": null
  };
  var Bliss = {
  	name: "Bliss",
  	names: [
  		"Blissymbols",
  		"Blissymbolics",
  		"Bliss"
  	],
  	"iso639-2": "zbl",
  	"iso639-1": null
  };
  var Blissymbolics = {
  	name: "Blissymbolics",
  	names: [
  		"Blissymbols",
  		"Blissymbolics",
  		"Bliss"
  	],
  	"iso639-2": "zbl",
  	"iso639-1": null
  };
  var Blissymbols = {
  	name: "Blissymbols",
  	names: [
  		"Blissymbols",
  		"Blissymbolics",
  		"Bliss"
  	],
  	"iso639-2": "zbl",
  	"iso639-1": null
  };
  var Bosnian = {
  	name: "Bosnian",
  	names: [
  		"Bosnian"
  	],
  	"iso639-2": "bos",
  	"iso639-1": "bs"
  };
  var Braj = {
  	name: "Braj",
  	names: [
  		"Braj"
  	],
  	"iso639-2": "bra",
  	"iso639-1": null
  };
  var Breton = {
  	name: "Breton",
  	names: [
  		"Breton"
  	],
  	"iso639-2": "bre",
  	"iso639-1": "br"
  };
  var Buginese = {
  	name: "Buginese",
  	names: [
  		"Buginese"
  	],
  	"iso639-2": "bug",
  	"iso639-1": null
  };
  var Bulgarian = {
  	name: "Bulgarian",
  	names: [
  		"Bulgarian"
  	],
  	"iso639-2": "bul",
  	"iso639-1": "bg"
  };
  var Buriat = {
  	name: "Buriat",
  	names: [
  		"Buriat"
  	],
  	"iso639-2": "bua",
  	"iso639-1": null
  };
  var Burmese = {
  	name: "Burmese",
  	names: [
  		"Burmese"
  	],
  	"iso639-2": "bur/mya",
  	"iso639-1": "my"
  };
  var Caddo = {
  	name: "Caddo",
  	names: [
  		"Caddo"
  	],
  	"iso639-2": "cad",
  	"iso639-1": null
  };
  var Castilian = {
  	name: "Castilian",
  	names: [
  		"Spanish",
  		"Castilian"
  	],
  	"iso639-2": "spa",
  	"iso639-1": "es"
  };
  var Catalan = {
  	name: "Catalan",
  	names: [
  		"Catalan",
  		"Valencian"
  	],
  	"iso639-2": "cat",
  	"iso639-1": "ca"
  };
  var Cebuano = {
  	name: "Cebuano",
  	names: [
  		"Cebuano"
  	],
  	"iso639-2": "ceb",
  	"iso639-1": null
  };
  var Chagatai = {
  	name: "Chagatai",
  	names: [
  		"Chagatai"
  	],
  	"iso639-2": "chg",
  	"iso639-1": null
  };
  var Chamorro = {
  	name: "Chamorro",
  	names: [
  		"Chamorro"
  	],
  	"iso639-2": "cha",
  	"iso639-1": "ch"
  };
  var Chechen = {
  	name: "Chechen",
  	names: [
  		"Chechen"
  	],
  	"iso639-2": "che",
  	"iso639-1": "ce"
  };
  var Cherokee = {
  	name: "Cherokee",
  	names: [
  		"Cherokee"
  	],
  	"iso639-2": "chr",
  	"iso639-1": null
  };
  var Chewa = {
  	name: "Chewa",
  	names: [
  		"Chichewa",
  		"Chewa",
  		"Nyanja"
  	],
  	"iso639-2": "nya",
  	"iso639-1": "ny"
  };
  var Cheyenne = {
  	name: "Cheyenne",
  	names: [
  		"Cheyenne"
  	],
  	"iso639-2": "chy",
  	"iso639-1": null
  };
  var Chibcha = {
  	name: "Chibcha",
  	names: [
  		"Chibcha"
  	],
  	"iso639-2": "chb",
  	"iso639-1": null
  };
  var Chichewa = {
  	name: "Chichewa",
  	names: [
  		"Chichewa",
  		"Chewa",
  		"Nyanja"
  	],
  	"iso639-2": "nya",
  	"iso639-1": "ny"
  };
  var Chinese = {
  	name: "Chinese",
  	names: [
  		"Chinese"
  	],
  	"iso639-2": "chi/zho",
  	"iso639-1": "zh"
  };
  var Chipewyan = {
  	name: "Chipewyan",
  	names: [
  		"Chipewyan",
  		"Dene Suline"
  	],
  	"iso639-2": "chp",
  	"iso639-1": null
  };
  var Choctaw = {
  	name: "Choctaw",
  	names: [
  		"Choctaw"
  	],
  	"iso639-2": "cho",
  	"iso639-1": null
  };
  var Chuang = {
  	name: "Chuang",
  	names: [
  		"Zhuang",
  		"Chuang"
  	],
  	"iso639-2": "zha",
  	"iso639-1": "za"
  };
  var Chuukese = {
  	name: "Chuukese",
  	names: [
  		"Chuukese"
  	],
  	"iso639-2": "chk",
  	"iso639-1": null
  };
  var Chuvash = {
  	name: "Chuvash",
  	names: [
  		"Chuvash"
  	],
  	"iso639-2": "chv",
  	"iso639-1": "cv"
  };
  var Coptic = {
  	name: "Coptic",
  	names: [
  		"Coptic"
  	],
  	"iso639-2": "cop",
  	"iso639-1": null
  };
  var Cornish = {
  	name: "Cornish",
  	names: [
  		"Cornish"
  	],
  	"iso639-2": "cor",
  	"iso639-1": "kw"
  };
  var Corsican = {
  	name: "Corsican",
  	names: [
  		"Corsican"
  	],
  	"iso639-2": "cos",
  	"iso639-1": "co"
  };
  var Cree = {
  	name: "Cree",
  	names: [
  		"Cree"
  	],
  	"iso639-2": "cre",
  	"iso639-1": "cr"
  };
  var Creek = {
  	name: "Creek",
  	names: [
  		"Creek"
  	],
  	"iso639-2": "mus",
  	"iso639-1": null
  };
  var Croatian = {
  	name: "Croatian",
  	names: [
  		"Croatian"
  	],
  	"iso639-2": "hrv",
  	"iso639-1": "hr"
  };
  var Czech = {
  	name: "Czech",
  	names: [
  		"Czech"
  	],
  	"iso639-2": "cze/ces",
  	"iso639-1": "cs"
  };
  var Dakota = {
  	name: "Dakota",
  	names: [
  		"Dakota"
  	],
  	"iso639-2": "dak",
  	"iso639-1": null
  };
  var Danish = {
  	name: "Danish",
  	names: [
  		"Danish"
  	],
  	"iso639-2": "dan",
  	"iso639-1": "da"
  };
  var Dargwa = {
  	name: "Dargwa",
  	names: [
  		"Dargwa"
  	],
  	"iso639-2": "dar",
  	"iso639-1": null
  };
  var Delaware = {
  	name: "Delaware",
  	names: [
  		"Delaware"
  	],
  	"iso639-2": "del",
  	"iso639-1": null
  };
  var Dhivehi = {
  	name: "Dhivehi",
  	names: [
  		"Divehi",
  		"Dhivehi",
  		"Maldivian"
  	],
  	"iso639-2": "div",
  	"iso639-1": "dv"
  };
  var Dimili = {
  	name: "Dimili",
  	names: [
  		"Zaza",
  		"Dimili",
  		"Dimli",
  		"Kirdki",
  		"Kirmanjki",
  		"Zazaki"
  	],
  	"iso639-2": "zza",
  	"iso639-1": null
  };
  var Dimli = {
  	name: "Dimli",
  	names: [
  		"Zaza",
  		"Dimili",
  		"Dimli",
  		"Kirdki",
  		"Kirmanjki",
  		"Zazaki"
  	],
  	"iso639-2": "zza",
  	"iso639-1": null
  };
  var Dinka = {
  	name: "Dinka",
  	names: [
  		"Dinka"
  	],
  	"iso639-2": "din",
  	"iso639-1": null
  };
  var Divehi = {
  	name: "Divehi",
  	names: [
  		"Divehi",
  		"Dhivehi",
  		"Maldivian"
  	],
  	"iso639-2": "div",
  	"iso639-1": "dv"
  };
  var Dogri = {
  	name: "Dogri",
  	names: [
  		"Dogri"
  	],
  	"iso639-2": "doi",
  	"iso639-1": null
  };
  var Dogrib = {
  	name: "Dogrib",
  	names: [
  		"Dogrib"
  	],
  	"iso639-2": "dgr",
  	"iso639-1": null
  };
  var Duala = {
  	name: "Duala",
  	names: [
  		"Duala"
  	],
  	"iso639-2": "dua",
  	"iso639-1": null
  };
  var Dutch = {
  	name: "Dutch",
  	names: [
  		"Dutch",
  		"Flemish"
  	],
  	"iso639-2": "dut/nld",
  	"iso639-1": "nl"
  };
  var Dyula = {
  	name: "Dyula",
  	names: [
  		"Dyula"
  	],
  	"iso639-2": "dyu",
  	"iso639-1": null
  };
  var Dzongkha = {
  	name: "Dzongkha",
  	names: [
  		"Dzongkha"
  	],
  	"iso639-2": "dzo",
  	"iso639-1": "dz"
  };
  var Edo = {
  	name: "Edo",
  	names: [
  		"Bini",
  		"Edo"
  	],
  	"iso639-2": "bin",
  	"iso639-1": null
  };
  var Efik = {
  	name: "Efik",
  	names: [
  		"Efik"
  	],
  	"iso639-2": "efi",
  	"iso639-1": null
  };
  var Ekajuk = {
  	name: "Ekajuk",
  	names: [
  		"Ekajuk"
  	],
  	"iso639-2": "eka",
  	"iso639-1": null
  };
  var Elamite = {
  	name: "Elamite",
  	names: [
  		"Elamite"
  	],
  	"iso639-2": "elx",
  	"iso639-1": null
  };
  var English = {
  	name: "English",
  	names: [
  		"English"
  	],
  	"iso639-2": "eng",
  	"iso639-1": "en"
  };
  var Erzya = {
  	name: "Erzya",
  	names: [
  		"Erzya"
  	],
  	"iso639-2": "myv",
  	"iso639-1": null
  };
  var Esperanto = {
  	name: "Esperanto",
  	names: [
  		"Esperanto"
  	],
  	"iso639-2": "epo",
  	"iso639-1": "eo"
  };
  var Estonian = {
  	name: "Estonian",
  	names: [
  		"Estonian"
  	],
  	"iso639-2": "est",
  	"iso639-1": "et"
  };
  var Ewe = {
  	name: "Ewe",
  	names: [
  		"Ewe"
  	],
  	"iso639-2": "ewe",
  	"iso639-1": "ee"
  };
  var Ewondo = {
  	name: "Ewondo",
  	names: [
  		"Ewondo"
  	],
  	"iso639-2": "ewo",
  	"iso639-1": null
  };
  var Fang = {
  	name: "Fang",
  	names: [
  		"Fang"
  	],
  	"iso639-2": "fan",
  	"iso639-1": null
  };
  var Fanti = {
  	name: "Fanti",
  	names: [
  		"Fanti"
  	],
  	"iso639-2": "fat",
  	"iso639-1": null
  };
  var Faroese = {
  	name: "Faroese",
  	names: [
  		"Faroese"
  	],
  	"iso639-2": "fao",
  	"iso639-1": "fo"
  };
  var Fijian = {
  	name: "Fijian",
  	names: [
  		"Fijian"
  	],
  	"iso639-2": "fij",
  	"iso639-1": "fj"
  };
  var Filipino = {
  	name: "Filipino",
  	names: [
  		"Filipino",
  		"Pilipino"
  	],
  	"iso639-2": "fil",
  	"iso639-1": null
  };
  var Finnish = {
  	name: "Finnish",
  	names: [
  		"Finnish"
  	],
  	"iso639-2": "fin",
  	"iso639-1": "fi"
  };
  var Flemish = {
  	name: "Flemish",
  	names: [
  		"Dutch",
  		"Flemish"
  	],
  	"iso639-2": "dut/nld",
  	"iso639-1": "nl"
  };
  var Fon = {
  	name: "Fon",
  	names: [
  		"Fon"
  	],
  	"iso639-2": "fon",
  	"iso639-1": null
  };
  var French = {
  	name: "French",
  	names: [
  		"French"
  	],
  	"iso639-2": "fre/fra",
  	"iso639-1": "fr"
  };
  var Friulian = {
  	name: "Friulian",
  	names: [
  		"Friulian"
  	],
  	"iso639-2": "fur",
  	"iso639-1": null
  };
  var Fulah = {
  	name: "Fulah",
  	names: [
  		"Fulah"
  	],
  	"iso639-2": "ful",
  	"iso639-1": "ff"
  };
  var Ga = {
  	name: "Ga",
  	names: [
  		"Ga"
  	],
  	"iso639-2": "gaa",
  	"iso639-1": null
  };
  var Gaelic = {
  	name: "Gaelic",
  	names: [
  		"Gaelic",
  		"Scottish Gaelic"
  	],
  	"iso639-2": "gla",
  	"iso639-1": "gd"
  };
  var Galician = {
  	name: "Galician",
  	names: [
  		"Galician"
  	],
  	"iso639-2": "glg",
  	"iso639-1": "gl"
  };
  var Ganda = {
  	name: "Ganda",
  	names: [
  		"Ganda"
  	],
  	"iso639-2": "lug",
  	"iso639-1": "lg"
  };
  var Gayo = {
  	name: "Gayo",
  	names: [
  		"Gayo"
  	],
  	"iso639-2": "gay",
  	"iso639-1": null
  };
  var Gbaya = {
  	name: "Gbaya",
  	names: [
  		"Gbaya"
  	],
  	"iso639-2": "gba",
  	"iso639-1": null
  };
  var Geez = {
  	name: "Geez",
  	names: [
  		"Geez"
  	],
  	"iso639-2": "gez",
  	"iso639-1": null
  };
  var Georgian = {
  	name: "Georgian",
  	names: [
  		"Georgian"
  	],
  	"iso639-2": "geo/kat",
  	"iso639-1": "ka"
  };
  var German = {
  	name: "German",
  	names: [
  		"German"
  	],
  	"iso639-2": "ger/deu",
  	"iso639-1": "de"
  };
  var Gikuyu = {
  	name: "Gikuyu",
  	names: [
  		"Kikuyu",
  		"Gikuyu"
  	],
  	"iso639-2": "kik",
  	"iso639-1": "ki"
  };
  var Gilbertese = {
  	name: "Gilbertese",
  	names: [
  		"Gilbertese"
  	],
  	"iso639-2": "gil",
  	"iso639-1": null
  };
  var Gondi = {
  	name: "Gondi",
  	names: [
  		"Gondi"
  	],
  	"iso639-2": "gon",
  	"iso639-1": null
  };
  var Gorontalo = {
  	name: "Gorontalo",
  	names: [
  		"Gorontalo"
  	],
  	"iso639-2": "gor",
  	"iso639-1": null
  };
  var Gothic = {
  	name: "Gothic",
  	names: [
  		"Gothic"
  	],
  	"iso639-2": "got",
  	"iso639-1": null
  };
  var Grebo = {
  	name: "Grebo",
  	names: [
  		"Grebo"
  	],
  	"iso639-2": "grb",
  	"iso639-1": null
  };
  var Greenlandic = {
  	name: "Greenlandic",
  	names: [
  		"Kalaallisut",
  		"Greenlandic"
  	],
  	"iso639-2": "kal",
  	"iso639-1": "kl"
  };
  var Guarani = {
  	name: "Guarani",
  	names: [
  		"Guarani"
  	],
  	"iso639-2": "grn",
  	"iso639-1": "gn"
  };
  var Gujarati = {
  	name: "Gujarati",
  	names: [
  		"Gujarati"
  	],
  	"iso639-2": "guj",
  	"iso639-1": "gu"
  };
  var Haida = {
  	name: "Haida",
  	names: [
  		"Haida"
  	],
  	"iso639-2": "hai",
  	"iso639-1": null
  };
  var Haitian = {
  	name: "Haitian",
  	names: [
  		"Haitian",
  		"Haitian Creole"
  	],
  	"iso639-2": "hat",
  	"iso639-1": "ht"
  };
  var Hausa = {
  	name: "Hausa",
  	names: [
  		"Hausa"
  	],
  	"iso639-2": "hau",
  	"iso639-1": "ha"
  };
  var Hawaiian = {
  	name: "Hawaiian",
  	names: [
  		"Hawaiian"
  	],
  	"iso639-2": "haw",
  	"iso639-1": null
  };
  var Hebrew = {
  	name: "Hebrew",
  	names: [
  		"Hebrew"
  	],
  	"iso639-2": "heb",
  	"iso639-1": "he"
  };
  var Herero = {
  	name: "Herero",
  	names: [
  		"Herero"
  	],
  	"iso639-2": "her",
  	"iso639-1": "hz"
  };
  var Hiligaynon = {
  	name: "Hiligaynon",
  	names: [
  		"Hiligaynon"
  	],
  	"iso639-2": "hil",
  	"iso639-1": null
  };
  var Hindi = {
  	name: "Hindi",
  	names: [
  		"Hindi"
  	],
  	"iso639-2": "hin",
  	"iso639-1": "hi"
  };
  var Hittite = {
  	name: "Hittite",
  	names: [
  		"Hittite"
  	],
  	"iso639-2": "hit",
  	"iso639-1": null
  };
  var Hmong = {
  	name: "Hmong",
  	names: [
  		"Hmong",
  		"Mong"
  	],
  	"iso639-2": "hmn",
  	"iso639-1": null
  };
  var Hungarian = {
  	name: "Hungarian",
  	names: [
  		"Hungarian"
  	],
  	"iso639-2": "hun",
  	"iso639-1": "hu"
  };
  var Hupa = {
  	name: "Hupa",
  	names: [
  		"Hupa"
  	],
  	"iso639-2": "hup",
  	"iso639-1": null
  };
  var Iban = {
  	name: "Iban",
  	names: [
  		"Iban"
  	],
  	"iso639-2": "iba",
  	"iso639-1": null
  };
  var Icelandic = {
  	name: "Icelandic",
  	names: [
  		"Icelandic"
  	],
  	"iso639-2": "ice/isl",
  	"iso639-1": "is"
  };
  var Ido = {
  	name: "Ido",
  	names: [
  		"Ido"
  	],
  	"iso639-2": "ido",
  	"iso639-1": "io"
  };
  var Igbo = {
  	name: "Igbo",
  	names: [
  		"Igbo"
  	],
  	"iso639-2": "ibo",
  	"iso639-1": "ig"
  };
  var Iloko = {
  	name: "Iloko",
  	names: [
  		"Iloko"
  	],
  	"iso639-2": "ilo",
  	"iso639-1": null
  };
  var Indonesian = {
  	name: "Indonesian",
  	names: [
  		"Indonesian"
  	],
  	"iso639-2": "ind",
  	"iso639-1": "id"
  };
  var Ingush = {
  	name: "Ingush",
  	names: [
  		"Ingush"
  	],
  	"iso639-2": "inh",
  	"iso639-1": null
  };
  var Interlingue = {
  	name: "Interlingue",
  	names: [
  		"Interlingue",
  		"Occidental"
  	],
  	"iso639-2": "ile",
  	"iso639-1": "ie"
  };
  var Inuktitut = {
  	name: "Inuktitut",
  	names: [
  		"Inuktitut"
  	],
  	"iso639-2": "iku",
  	"iso639-1": "iu"
  };
  var Inupiaq = {
  	name: "Inupiaq",
  	names: [
  		"Inupiaq"
  	],
  	"iso639-2": "ipk",
  	"iso639-1": "ik"
  };
  var Irish = {
  	name: "Irish",
  	names: [
  		"Irish"
  	],
  	"iso639-2": "gle",
  	"iso639-1": "ga"
  };
  var Italian = {
  	name: "Italian",
  	names: [
  		"Italian"
  	],
  	"iso639-2": "ita",
  	"iso639-1": "it"
  };
  var Japanese = {
  	name: "Japanese",
  	names: [
  		"Japanese"
  	],
  	"iso639-2": "jpn",
  	"iso639-1": "ja"
  };
  var Javanese = {
  	name: "Javanese",
  	names: [
  		"Javanese"
  	],
  	"iso639-2": "jav",
  	"iso639-1": "jv"
  };
  var Jingpho = {
  	name: "Jingpho",
  	names: [
  		"Kachin",
  		"Jingpho"
  	],
  	"iso639-2": "kac",
  	"iso639-1": null
  };
  var Kabardian = {
  	name: "Kabardian",
  	names: [
  		"Kabardian"
  	],
  	"iso639-2": "kbd",
  	"iso639-1": null
  };
  var Kabyle = {
  	name: "Kabyle",
  	names: [
  		"Kabyle"
  	],
  	"iso639-2": "kab",
  	"iso639-1": null
  };
  var Kachin = {
  	name: "Kachin",
  	names: [
  		"Kachin",
  		"Jingpho"
  	],
  	"iso639-2": "kac",
  	"iso639-1": null
  };
  var Kalaallisut = {
  	name: "Kalaallisut",
  	names: [
  		"Kalaallisut",
  		"Greenlandic"
  	],
  	"iso639-2": "kal",
  	"iso639-1": "kl"
  };
  var Kalmyk = {
  	name: "Kalmyk",
  	names: [
  		"Kalmyk",
  		"Oirat"
  	],
  	"iso639-2": "xal",
  	"iso639-1": null
  };
  var Kamba = {
  	name: "Kamba",
  	names: [
  		"Kamba"
  	],
  	"iso639-2": "kam",
  	"iso639-1": null
  };
  var Kannada = {
  	name: "Kannada",
  	names: [
  		"Kannada"
  	],
  	"iso639-2": "kan",
  	"iso639-1": "kn"
  };
  var Kanuri = {
  	name: "Kanuri",
  	names: [
  		"Kanuri"
  	],
  	"iso639-2": "kau",
  	"iso639-1": "kr"
  };
  var Kapampangan = {
  	name: "Kapampangan",
  	names: [
  		"Pampanga",
  		"Kapampangan"
  	],
  	"iso639-2": "pam",
  	"iso639-1": null
  };
  var Karelian = {
  	name: "Karelian",
  	names: [
  		"Karelian"
  	],
  	"iso639-2": "krl",
  	"iso639-1": null
  };
  var Kashmiri = {
  	name: "Kashmiri",
  	names: [
  		"Kashmiri"
  	],
  	"iso639-2": "kas",
  	"iso639-1": "ks"
  };
  var Kashubian = {
  	name: "Kashubian",
  	names: [
  		"Kashubian"
  	],
  	"iso639-2": "csb",
  	"iso639-1": null
  };
  var Kawi = {
  	name: "Kawi",
  	names: [
  		"Kawi"
  	],
  	"iso639-2": "kaw",
  	"iso639-1": null
  };
  var Kazakh = {
  	name: "Kazakh",
  	names: [
  		"Kazakh"
  	],
  	"iso639-2": "kaz",
  	"iso639-1": "kk"
  };
  var Khasi = {
  	name: "Khasi",
  	names: [
  		"Khasi"
  	],
  	"iso639-2": "kha",
  	"iso639-1": null
  };
  var Khotanese = {
  	name: "Khotanese",
  	names: [
  		"Khotanese",
  		"Sakan"
  	],
  	"iso639-2": "kho",
  	"iso639-1": null
  };
  var Kikuyu = {
  	name: "Kikuyu",
  	names: [
  		"Kikuyu",
  		"Gikuyu"
  	],
  	"iso639-2": "kik",
  	"iso639-1": "ki"
  };
  var Kimbundu = {
  	name: "Kimbundu",
  	names: [
  		"Kimbundu"
  	],
  	"iso639-2": "kmb",
  	"iso639-1": null
  };
  var Kinyarwanda = {
  	name: "Kinyarwanda",
  	names: [
  		"Kinyarwanda"
  	],
  	"iso639-2": "kin",
  	"iso639-1": "rw"
  };
  var Kirdki = {
  	name: "Kirdki",
  	names: [
  		"Zaza",
  		"Dimili",
  		"Dimli",
  		"Kirdki",
  		"Kirmanjki",
  		"Zazaki"
  	],
  	"iso639-2": "zza",
  	"iso639-1": null
  };
  var Kirghiz = {
  	name: "Kirghiz",
  	names: [
  		"Kirghiz",
  		"Kyrgyz"
  	],
  	"iso639-2": "kir",
  	"iso639-1": "ky"
  };
  var Kirmanjki = {
  	name: "Kirmanjki",
  	names: [
  		"Zaza",
  		"Dimili",
  		"Dimli",
  		"Kirdki",
  		"Kirmanjki",
  		"Zazaki"
  	],
  	"iso639-2": "zza",
  	"iso639-1": null
  };
  var Klingon = {
  	name: "Klingon",
  	names: [
  		"Klingon",
  		"tlhIngan-Hol"
  	],
  	"iso639-2": "tlh",
  	"iso639-1": null
  };
  var Komi = {
  	name: "Komi",
  	names: [
  		"Komi"
  	],
  	"iso639-2": "kom",
  	"iso639-1": "kv"
  };
  var Kongo = {
  	name: "Kongo",
  	names: [
  		"Kongo"
  	],
  	"iso639-2": "kon",
  	"iso639-1": "kg"
  };
  var Konkani = {
  	name: "Konkani",
  	names: [
  		"Konkani"
  	],
  	"iso639-2": "kok",
  	"iso639-1": null
  };
  var Korean = {
  	name: "Korean",
  	names: [
  		"Korean"
  	],
  	"iso639-2": "kor",
  	"iso639-1": "ko"
  };
  var Kosraean = {
  	name: "Kosraean",
  	names: [
  		"Kosraean"
  	],
  	"iso639-2": "kos",
  	"iso639-1": null
  };
  var Kpelle = {
  	name: "Kpelle",
  	names: [
  		"Kpelle"
  	],
  	"iso639-2": "kpe",
  	"iso639-1": null
  };
  var Kuanyama = {
  	name: "Kuanyama",
  	names: [
  		"Kuanyama",
  		"Kwanyama"
  	],
  	"iso639-2": "kua",
  	"iso639-1": "kj"
  };
  var Kumyk = {
  	name: "Kumyk",
  	names: [
  		"Kumyk"
  	],
  	"iso639-2": "kum",
  	"iso639-1": null
  };
  var Kurdish = {
  	name: "Kurdish",
  	names: [
  		"Kurdish"
  	],
  	"iso639-2": "kur",
  	"iso639-1": "ku"
  };
  var Kurukh = {
  	name: "Kurukh",
  	names: [
  		"Kurukh"
  	],
  	"iso639-2": "kru",
  	"iso639-1": null
  };
  var Kutenai = {
  	name: "Kutenai",
  	names: [
  		"Kutenai"
  	],
  	"iso639-2": "kut",
  	"iso639-1": null
  };
  var Kwanyama = {
  	name: "Kwanyama",
  	names: [
  		"Kuanyama",
  		"Kwanyama"
  	],
  	"iso639-2": "kua",
  	"iso639-1": "kj"
  };
  var Kyrgyz = {
  	name: "Kyrgyz",
  	names: [
  		"Kirghiz",
  		"Kyrgyz"
  	],
  	"iso639-2": "kir",
  	"iso639-1": "ky"
  };
  var Ladino = {
  	name: "Ladino",
  	names: [
  		"Ladino"
  	],
  	"iso639-2": "lad",
  	"iso639-1": null
  };
  var Lahnda = {
  	name: "Lahnda",
  	names: [
  		"Lahnda"
  	],
  	"iso639-2": "lah",
  	"iso639-1": null
  };
  var Lamba = {
  	name: "Lamba",
  	names: [
  		"Lamba"
  	],
  	"iso639-2": "lam",
  	"iso639-1": null
  };
  var Lao = {
  	name: "Lao",
  	names: [
  		"Lao"
  	],
  	"iso639-2": "lao",
  	"iso639-1": "lo"
  };
  var Latin = {
  	name: "Latin",
  	names: [
  		"Latin"
  	],
  	"iso639-2": "lat",
  	"iso639-1": "la"
  };
  var Latvian = {
  	name: "Latvian",
  	names: [
  		"Latvian"
  	],
  	"iso639-2": "lav",
  	"iso639-1": "lv"
  };
  var Leonese = {
  	name: "Leonese",
  	names: [
  		"Asturian",
  		"Bable",
  		"Leonese",
  		"Asturleonese"
  	],
  	"iso639-2": "ast",
  	"iso639-1": null
  };
  var Letzeburgesch = {
  	name: "Letzeburgesch",
  	names: [
  		"Luxembourgish",
  		"Letzeburgesch"
  	],
  	"iso639-2": "ltz",
  	"iso639-1": "lb"
  };
  var Lezghian = {
  	name: "Lezghian",
  	names: [
  		"Lezghian"
  	],
  	"iso639-2": "lez",
  	"iso639-1": null
  };
  var Limburgan = {
  	name: "Limburgan",
  	names: [
  		"Limburgan",
  		"Limburger",
  		"Limburgish"
  	],
  	"iso639-2": "lim",
  	"iso639-1": "li"
  };
  var Limburger = {
  	name: "Limburger",
  	names: [
  		"Limburgan",
  		"Limburger",
  		"Limburgish"
  	],
  	"iso639-2": "lim",
  	"iso639-1": "li"
  };
  var Limburgish = {
  	name: "Limburgish",
  	names: [
  		"Limburgan",
  		"Limburger",
  		"Limburgish"
  	],
  	"iso639-2": "lim",
  	"iso639-1": "li"
  };
  var Lingala = {
  	name: "Lingala",
  	names: [
  		"Lingala"
  	],
  	"iso639-2": "lin",
  	"iso639-1": "ln"
  };
  var Lithuanian = {
  	name: "Lithuanian",
  	names: [
  		"Lithuanian"
  	],
  	"iso639-2": "lit",
  	"iso639-1": "lt"
  };
  var Lojban = {
  	name: "Lojban",
  	names: [
  		"Lojban"
  	],
  	"iso639-2": "jbo",
  	"iso639-1": null
  };
  var Lozi = {
  	name: "Lozi",
  	names: [
  		"Lozi"
  	],
  	"iso639-2": "loz",
  	"iso639-1": null
  };
  var Luiseno = {
  	name: "Luiseno",
  	names: [
  		"Luiseno"
  	],
  	"iso639-2": "lui",
  	"iso639-1": null
  };
  var Lunda = {
  	name: "Lunda",
  	names: [
  		"Lunda"
  	],
  	"iso639-2": "lun",
  	"iso639-1": null
  };
  var Lushai = {
  	name: "Lushai",
  	names: [
  		"Lushai"
  	],
  	"iso639-2": "lus",
  	"iso639-1": null
  };
  var Luxembourgish = {
  	name: "Luxembourgish",
  	names: [
  		"Luxembourgish",
  		"Letzeburgesch"
  	],
  	"iso639-2": "ltz",
  	"iso639-1": "lb"
  };
  var Macedonian = {
  	name: "Macedonian",
  	names: [
  		"Macedonian"
  	],
  	"iso639-2": "mac/mkd",
  	"iso639-1": "mk"
  };
  var Madurese = {
  	name: "Madurese",
  	names: [
  		"Madurese"
  	],
  	"iso639-2": "mad",
  	"iso639-1": null
  };
  var Magahi = {
  	name: "Magahi",
  	names: [
  		"Magahi"
  	],
  	"iso639-2": "mag",
  	"iso639-1": null
  };
  var Maithili = {
  	name: "Maithili",
  	names: [
  		"Maithili"
  	],
  	"iso639-2": "mai",
  	"iso639-1": null
  };
  var Makasar = {
  	name: "Makasar",
  	names: [
  		"Makasar"
  	],
  	"iso639-2": "mak",
  	"iso639-1": null
  };
  var Malagasy = {
  	name: "Malagasy",
  	names: [
  		"Malagasy"
  	],
  	"iso639-2": "mlg",
  	"iso639-1": "mg"
  };
  var Malay = {
  	name: "Malay",
  	names: [
  		"Malay"
  	],
  	"iso639-2": "may/msa",
  	"iso639-1": "ms"
  };
  var Malayalam = {
  	name: "Malayalam",
  	names: [
  		"Malayalam"
  	],
  	"iso639-2": "mal",
  	"iso639-1": "ml"
  };
  var Maldivian = {
  	name: "Maldivian",
  	names: [
  		"Divehi",
  		"Dhivehi",
  		"Maldivian"
  	],
  	"iso639-2": "div",
  	"iso639-1": "dv"
  };
  var Maltese = {
  	name: "Maltese",
  	names: [
  		"Maltese"
  	],
  	"iso639-2": "mlt",
  	"iso639-1": "mt"
  };
  var Manchu = {
  	name: "Manchu",
  	names: [
  		"Manchu"
  	],
  	"iso639-2": "mnc",
  	"iso639-1": null
  };
  var Mandar = {
  	name: "Mandar",
  	names: [
  		"Mandar"
  	],
  	"iso639-2": "mdr",
  	"iso639-1": null
  };
  var Mandingo = {
  	name: "Mandingo",
  	names: [
  		"Mandingo"
  	],
  	"iso639-2": "man",
  	"iso639-1": null
  };
  var Manipuri = {
  	name: "Manipuri",
  	names: [
  		"Manipuri"
  	],
  	"iso639-2": "mni",
  	"iso639-1": null
  };
  var Manx = {
  	name: "Manx",
  	names: [
  		"Manx"
  	],
  	"iso639-2": "glv",
  	"iso639-1": "gv"
  };
  var Maori = {
  	name: "Maori",
  	names: [
  		"Maori"
  	],
  	"iso639-2": "mao/mri",
  	"iso639-1": "mi"
  };
  var Mapuche = {
  	name: "Mapuche",
  	names: [
  		"Mapudungun",
  		"Mapuche"
  	],
  	"iso639-2": "arn",
  	"iso639-1": null
  };
  var Mapudungun = {
  	name: "Mapudungun",
  	names: [
  		"Mapudungun",
  		"Mapuche"
  	],
  	"iso639-2": "arn",
  	"iso639-1": null
  };
  var Marathi = {
  	name: "Marathi",
  	names: [
  		"Marathi"
  	],
  	"iso639-2": "mar",
  	"iso639-1": "mr"
  };
  var Mari = {
  	name: "Mari",
  	names: [
  		"Mari"
  	],
  	"iso639-2": "chm",
  	"iso639-1": null
  };
  var Marshallese = {
  	name: "Marshallese",
  	names: [
  		"Marshallese"
  	],
  	"iso639-2": "mah",
  	"iso639-1": "mh"
  };
  var Marwari = {
  	name: "Marwari",
  	names: [
  		"Marwari"
  	],
  	"iso639-2": "mwr",
  	"iso639-1": null
  };
  var Masai = {
  	name: "Masai",
  	names: [
  		"Masai"
  	],
  	"iso639-2": "mas",
  	"iso639-1": null
  };
  var Mende = {
  	name: "Mende",
  	names: [
  		"Mende"
  	],
  	"iso639-2": "men",
  	"iso639-1": null
  };
  var Micmac = {
  	name: "Micmac",
  	names: [
  		"Mi'kmaq",
  		"Micmac"
  	],
  	"iso639-2": "mic",
  	"iso639-1": null
  };
  var Minangkabau = {
  	name: "Minangkabau",
  	names: [
  		"Minangkabau"
  	],
  	"iso639-2": "min",
  	"iso639-1": null
  };
  var Mirandese = {
  	name: "Mirandese",
  	names: [
  		"Mirandese"
  	],
  	"iso639-2": "mwl",
  	"iso639-1": null
  };
  var Mohawk = {
  	name: "Mohawk",
  	names: [
  		"Mohawk"
  	],
  	"iso639-2": "moh",
  	"iso639-1": null
  };
  var Moksha = {
  	name: "Moksha",
  	names: [
  		"Moksha"
  	],
  	"iso639-2": "mdf",
  	"iso639-1": null
  };
  var Moldavian = {
  	name: "Moldavian",
  	names: [
  		"Romanian",
  		"Moldavian",
  		"Moldovan"
  	],
  	"iso639-2": "rum/ron",
  	"iso639-1": "ro"
  };
  var Moldovan = {
  	name: "Moldovan",
  	names: [
  		"Romanian",
  		"Moldavian",
  		"Moldovan"
  	],
  	"iso639-2": "rum/ron",
  	"iso639-1": "ro"
  };
  var Mong = {
  	name: "Mong",
  	names: [
  		"Hmong",
  		"Mong"
  	],
  	"iso639-2": "hmn",
  	"iso639-1": null
  };
  var Mongo = {
  	name: "Mongo",
  	names: [
  		"Mongo"
  	],
  	"iso639-2": "lol",
  	"iso639-1": null
  };
  var Mongolian = {
  	name: "Mongolian",
  	names: [
  		"Mongolian"
  	],
  	"iso639-2": "mon",
  	"iso639-1": "mn"
  };
  var Montenegrin = {
  	name: "Montenegrin",
  	names: [
  		"Montenegrin"
  	],
  	"iso639-2": "cnr",
  	"iso639-1": null
  };
  var Mossi = {
  	name: "Mossi",
  	names: [
  		"Mossi"
  	],
  	"iso639-2": "mos",
  	"iso639-1": null
  };
  var Nauru = {
  	name: "Nauru",
  	names: [
  		"Nauru"
  	],
  	"iso639-2": "nau",
  	"iso639-1": "na"
  };
  var Navaho = {
  	name: "Navaho",
  	names: [
  		"Navajo",
  		"Navaho"
  	],
  	"iso639-2": "nav",
  	"iso639-1": "nv"
  };
  var Navajo = {
  	name: "Navajo",
  	names: [
  		"Navajo",
  		"Navaho"
  	],
  	"iso639-2": "nav",
  	"iso639-1": "nv"
  };
  var Ndonga = {
  	name: "Ndonga",
  	names: [
  		"Ndonga"
  	],
  	"iso639-2": "ndo",
  	"iso639-1": "ng"
  };
  var Neapolitan = {
  	name: "Neapolitan",
  	names: [
  		"Neapolitan"
  	],
  	"iso639-2": "nap",
  	"iso639-1": null
  };
  var Nepali = {
  	name: "Nepali",
  	names: [
  		"Nepali"
  	],
  	"iso639-2": "nep",
  	"iso639-1": "ne"
  };
  var Newari = {
  	name: "Newari",
  	names: [
  		"Nepal Bhasa",
  		"Newari"
  	],
  	"iso639-2": "new",
  	"iso639-1": null
  };
  var Nias = {
  	name: "Nias",
  	names: [
  		"Nias"
  	],
  	"iso639-2": "nia",
  	"iso639-1": null
  };
  var Niuean = {
  	name: "Niuean",
  	names: [
  		"Niuean"
  	],
  	"iso639-2": "niu",
  	"iso639-1": null
  };
  var Nogai = {
  	name: "Nogai",
  	names: [
  		"Nogai"
  	],
  	"iso639-2": "nog",
  	"iso639-1": null
  };
  var Norwegian = {
  	name: "Norwegian",
  	names: [
  		"Norwegian"
  	],
  	"iso639-2": "nor",
  	"iso639-1": "no"
  };
  var Nuosu = {
  	name: "Nuosu",
  	names: [
  		"Sichuan Yi",
  		"Nuosu"
  	],
  	"iso639-2": "iii",
  	"iso639-1": "ii"
  };
  var Nyamwezi = {
  	name: "Nyamwezi",
  	names: [
  		"Nyamwezi"
  	],
  	"iso639-2": "nym",
  	"iso639-1": null
  };
  var Nyanja = {
  	name: "Nyanja",
  	names: [
  		"Chichewa",
  		"Chewa",
  		"Nyanja"
  	],
  	"iso639-2": "nya",
  	"iso639-1": "ny"
  };
  var Nyankole = {
  	name: "Nyankole",
  	names: [
  		"Nyankole"
  	],
  	"iso639-2": "nyn",
  	"iso639-1": null
  };
  var Nyoro = {
  	name: "Nyoro",
  	names: [
  		"Nyoro"
  	],
  	"iso639-2": "nyo",
  	"iso639-1": null
  };
  var Nzima = {
  	name: "Nzima",
  	names: [
  		"Nzima"
  	],
  	"iso639-2": "nzi",
  	"iso639-1": null
  };
  var Occidental = {
  	name: "Occidental",
  	names: [
  		"Interlingue",
  		"Occidental"
  	],
  	"iso639-2": "ile",
  	"iso639-1": "ie"
  };
  var Oirat = {
  	name: "Oirat",
  	names: [
  		"Kalmyk",
  		"Oirat"
  	],
  	"iso639-2": "xal",
  	"iso639-1": null
  };
  var Ojibwa = {
  	name: "Ojibwa",
  	names: [
  		"Ojibwa"
  	],
  	"iso639-2": "oji",
  	"iso639-1": "oj"
  };
  var Oriya = {
  	name: "Oriya",
  	names: [
  		"Oriya"
  	],
  	"iso639-2": "ori",
  	"iso639-1": "or"
  };
  var Oromo = {
  	name: "Oromo",
  	names: [
  		"Oromo"
  	],
  	"iso639-2": "orm",
  	"iso639-1": "om"
  };
  var Osage = {
  	name: "Osage",
  	names: [
  		"Osage"
  	],
  	"iso639-2": "osa",
  	"iso639-1": null
  };
  var Ossetian = {
  	name: "Ossetian",
  	names: [
  		"Ossetian",
  		"Ossetic"
  	],
  	"iso639-2": "oss",
  	"iso639-1": "os"
  };
  var Ossetic = {
  	name: "Ossetic",
  	names: [
  		"Ossetian",
  		"Ossetic"
  	],
  	"iso639-2": "oss",
  	"iso639-1": "os"
  };
  var Pahlavi = {
  	name: "Pahlavi",
  	names: [
  		"Pahlavi"
  	],
  	"iso639-2": "pal",
  	"iso639-1": null
  };
  var Palauan = {
  	name: "Palauan",
  	names: [
  		"Palauan"
  	],
  	"iso639-2": "pau",
  	"iso639-1": null
  };
  var Pali = {
  	name: "Pali",
  	names: [
  		"Pali"
  	],
  	"iso639-2": "pli",
  	"iso639-1": "pi"
  };
  var Pampanga = {
  	name: "Pampanga",
  	names: [
  		"Pampanga",
  		"Kapampangan"
  	],
  	"iso639-2": "pam",
  	"iso639-1": null
  };
  var Pangasinan = {
  	name: "Pangasinan",
  	names: [
  		"Pangasinan"
  	],
  	"iso639-2": "pag",
  	"iso639-1": null
  };
  var Panjabi = {
  	name: "Panjabi",
  	names: [
  		"Panjabi",
  		"Punjabi"
  	],
  	"iso639-2": "pan",
  	"iso639-1": "pa"
  };
  var Papiamento = {
  	name: "Papiamento",
  	names: [
  		"Papiamento"
  	],
  	"iso639-2": "pap",
  	"iso639-1": null
  };
  var Pashto = {
  	name: "Pashto",
  	names: [
  		"Pushto",
  		"Pashto"
  	],
  	"iso639-2": "pus",
  	"iso639-1": "ps"
  };
  var Pedi = {
  	name: "Pedi",
  	names: [
  		"Pedi",
  		"Sepedi",
  		"Northern Sotho"
  	],
  	"iso639-2": "nso",
  	"iso639-1": null
  };
  var Persian = {
  	name: "Persian",
  	names: [
  		"Persian"
  	],
  	"iso639-2": "per/fas",
  	"iso639-1": "fa"
  };
  var Phoenician = {
  	name: "Phoenician",
  	names: [
  		"Phoenician"
  	],
  	"iso639-2": "phn",
  	"iso639-1": null
  };
  var Pilipino = {
  	name: "Pilipino",
  	names: [
  		"Filipino",
  		"Pilipino"
  	],
  	"iso639-2": "fil",
  	"iso639-1": null
  };
  var Pohnpeian = {
  	name: "Pohnpeian",
  	names: [
  		"Pohnpeian"
  	],
  	"iso639-2": "pon",
  	"iso639-1": null
  };
  var Polish = {
  	name: "Polish",
  	names: [
  		"Polish"
  	],
  	"iso639-2": "pol",
  	"iso639-1": "pl"
  };
  var Portuguese = {
  	name: "Portuguese",
  	names: [
  		"Portuguese"
  	],
  	"iso639-2": "por",
  	"iso639-1": "pt"
  };
  var Punjabi = {
  	name: "Punjabi",
  	names: [
  		"Panjabi",
  		"Punjabi"
  	],
  	"iso639-2": "pan",
  	"iso639-1": "pa"
  };
  var Pushto = {
  	name: "Pushto",
  	names: [
  		"Pushto",
  		"Pashto"
  	],
  	"iso639-2": "pus",
  	"iso639-1": "ps"
  };
  var Quechua = {
  	name: "Quechua",
  	names: [
  		"Quechua"
  	],
  	"iso639-2": "que",
  	"iso639-1": "qu"
  };
  var Rajasthani = {
  	name: "Rajasthani",
  	names: [
  		"Rajasthani"
  	],
  	"iso639-2": "raj",
  	"iso639-1": null
  };
  var Rapanui = {
  	name: "Rapanui",
  	names: [
  		"Rapanui"
  	],
  	"iso639-2": "rap",
  	"iso639-1": null
  };
  var Rarotongan = {
  	name: "Rarotongan",
  	names: [
  		"Rarotongan",
  		"Cook Islands Maori"
  	],
  	"iso639-2": "rar",
  	"iso639-1": null
  };
  var Romanian = {
  	name: "Romanian",
  	names: [
  		"Romanian",
  		"Moldavian",
  		"Moldovan"
  	],
  	"iso639-2": "rum/ron",
  	"iso639-1": "ro"
  };
  var Romansh = {
  	name: "Romansh",
  	names: [
  		"Romansh"
  	],
  	"iso639-2": "roh",
  	"iso639-1": "rm"
  };
  var Romany = {
  	name: "Romany",
  	names: [
  		"Romany"
  	],
  	"iso639-2": "rom",
  	"iso639-1": null
  };
  var Rundi = {
  	name: "Rundi",
  	names: [
  		"Rundi"
  	],
  	"iso639-2": "run",
  	"iso639-1": "rn"
  };
  var Russian = {
  	name: "Russian",
  	names: [
  		"Russian"
  	],
  	"iso639-2": "rus",
  	"iso639-1": "ru"
  };
  var Sakan = {
  	name: "Sakan",
  	names: [
  		"Khotanese",
  		"Sakan"
  	],
  	"iso639-2": "kho",
  	"iso639-1": null
  };
  var Samoan = {
  	name: "Samoan",
  	names: [
  		"Samoan"
  	],
  	"iso639-2": "smo",
  	"iso639-1": "sm"
  };
  var Sandawe = {
  	name: "Sandawe",
  	names: [
  		"Sandawe"
  	],
  	"iso639-2": "sad",
  	"iso639-1": null
  };
  var Sango = {
  	name: "Sango",
  	names: [
  		"Sango"
  	],
  	"iso639-2": "sag",
  	"iso639-1": "sg"
  };
  var Sanskrit = {
  	name: "Sanskrit",
  	names: [
  		"Sanskrit"
  	],
  	"iso639-2": "san",
  	"iso639-1": "sa"
  };
  var Santali = {
  	name: "Santali",
  	names: [
  		"Santali"
  	],
  	"iso639-2": "sat",
  	"iso639-1": null
  };
  var Sardinian = {
  	name: "Sardinian",
  	names: [
  		"Sardinian"
  	],
  	"iso639-2": "srd",
  	"iso639-1": "sc"
  };
  var Sasak = {
  	name: "Sasak",
  	names: [
  		"Sasak"
  	],
  	"iso639-2": "sas",
  	"iso639-1": null
  };
  var Scots = {
  	name: "Scots",
  	names: [
  		"Scots"
  	],
  	"iso639-2": "sco",
  	"iso639-1": null
  };
  var Selkup = {
  	name: "Selkup",
  	names: [
  		"Selkup"
  	],
  	"iso639-2": "sel",
  	"iso639-1": null
  };
  var Sepedi = {
  	name: "Sepedi",
  	names: [
  		"Pedi",
  		"Sepedi",
  		"Northern Sotho"
  	],
  	"iso639-2": "nso",
  	"iso639-1": null
  };
  var Serbian = {
  	name: "Serbian",
  	names: [
  		"Serbian"
  	],
  	"iso639-2": "srp",
  	"iso639-1": "sr"
  };
  var Serer = {
  	name: "Serer",
  	names: [
  		"Serer"
  	],
  	"iso639-2": "srr",
  	"iso639-1": null
  };
  var Shan = {
  	name: "Shan",
  	names: [
  		"Shan"
  	],
  	"iso639-2": "shn",
  	"iso639-1": null
  };
  var Shona = {
  	name: "Shona",
  	names: [
  		"Shona"
  	],
  	"iso639-2": "sna",
  	"iso639-1": "sn"
  };
  var Sicilian = {
  	name: "Sicilian",
  	names: [
  		"Sicilian"
  	],
  	"iso639-2": "scn",
  	"iso639-1": null
  };
  var Sidamo = {
  	name: "Sidamo",
  	names: [
  		"Sidamo"
  	],
  	"iso639-2": "sid",
  	"iso639-1": null
  };
  var Siksika = {
  	name: "Siksika",
  	names: [
  		"Siksika"
  	],
  	"iso639-2": "bla",
  	"iso639-1": null
  };
  var Sindhi = {
  	name: "Sindhi",
  	names: [
  		"Sindhi"
  	],
  	"iso639-2": "snd",
  	"iso639-1": "sd"
  };
  var Sinhala = {
  	name: "Sinhala",
  	names: [
  		"Sinhala",
  		"Sinhalese"
  	],
  	"iso639-2": "sin",
  	"iso639-1": "si"
  };
  var Sinhalese = {
  	name: "Sinhalese",
  	names: [
  		"Sinhala",
  		"Sinhalese"
  	],
  	"iso639-2": "sin",
  	"iso639-1": "si"
  };
  var Slovak = {
  	name: "Slovak",
  	names: [
  		"Slovak"
  	],
  	"iso639-2": "slo/slk",
  	"iso639-1": "sk"
  };
  var Slovenian = {
  	name: "Slovenian",
  	names: [
  		"Slovenian"
  	],
  	"iso639-2": "slv",
  	"iso639-1": "sl"
  };
  var Sogdian = {
  	name: "Sogdian",
  	names: [
  		"Sogdian"
  	],
  	"iso639-2": "sog",
  	"iso639-1": null
  };
  var Somali = {
  	name: "Somali",
  	names: [
  		"Somali"
  	],
  	"iso639-2": "som",
  	"iso639-1": "so"
  };
  var Soninke = {
  	name: "Soninke",
  	names: [
  		"Soninke"
  	],
  	"iso639-2": "snk",
  	"iso639-1": null
  };
  var Spanish = {
  	name: "Spanish",
  	names: [
  		"Spanish",
  		"Castilian"
  	],
  	"iso639-2": "spa",
  	"iso639-1": "es"
  };
  var Sukuma = {
  	name: "Sukuma",
  	names: [
  		"Sukuma"
  	],
  	"iso639-2": "suk",
  	"iso639-1": null
  };
  var Sumerian = {
  	name: "Sumerian",
  	names: [
  		"Sumerian"
  	],
  	"iso639-2": "sux",
  	"iso639-1": null
  };
  var Sundanese = {
  	name: "Sundanese",
  	names: [
  		"Sundanese"
  	],
  	"iso639-2": "sun",
  	"iso639-1": "su"
  };
  var Susu = {
  	name: "Susu",
  	names: [
  		"Susu"
  	],
  	"iso639-2": "sus",
  	"iso639-1": null
  };
  var Swahili = {
  	name: "Swahili",
  	names: [
  		"Swahili"
  	],
  	"iso639-2": "swa",
  	"iso639-1": "sw"
  };
  var Swati = {
  	name: "Swati",
  	names: [
  		"Swati"
  	],
  	"iso639-2": "ssw",
  	"iso639-1": "ss"
  };
  var Swedish = {
  	name: "Swedish",
  	names: [
  		"Swedish"
  	],
  	"iso639-2": "swe",
  	"iso639-1": "sv"
  };
  var Syriac = {
  	name: "Syriac",
  	names: [
  		"Syriac"
  	],
  	"iso639-2": "syr",
  	"iso639-1": null
  };
  var Tagalog = {
  	name: "Tagalog",
  	names: [
  		"Tagalog"
  	],
  	"iso639-2": "tgl",
  	"iso639-1": "tl"
  };
  var Tahitian = {
  	name: "Tahitian",
  	names: [
  		"Tahitian"
  	],
  	"iso639-2": "tah",
  	"iso639-1": "ty"
  };
  var Tajik = {
  	name: "Tajik",
  	names: [
  		"Tajik"
  	],
  	"iso639-2": "tgk",
  	"iso639-1": "tg"
  };
  var Tamashek = {
  	name: "Tamashek",
  	names: [
  		"Tamashek"
  	],
  	"iso639-2": "tmh",
  	"iso639-1": null
  };
  var Tamil = {
  	name: "Tamil",
  	names: [
  		"Tamil"
  	],
  	"iso639-2": "tam",
  	"iso639-1": "ta"
  };
  var Tatar = {
  	name: "Tatar",
  	names: [
  		"Tatar"
  	],
  	"iso639-2": "tat",
  	"iso639-1": "tt"
  };
  var Telugu = {
  	name: "Telugu",
  	names: [
  		"Telugu"
  	],
  	"iso639-2": "tel",
  	"iso639-1": "te"
  };
  var Tereno = {
  	name: "Tereno",
  	names: [
  		"Tereno"
  	],
  	"iso639-2": "ter",
  	"iso639-1": null
  };
  var Tetum = {
  	name: "Tetum",
  	names: [
  		"Tetum"
  	],
  	"iso639-2": "tet",
  	"iso639-1": null
  };
  var Thai = {
  	name: "Thai",
  	names: [
  		"Thai"
  	],
  	"iso639-2": "tha",
  	"iso639-1": "th"
  };
  var Tibetan = {
  	name: "Tibetan",
  	names: [
  		"Tibetan"
  	],
  	"iso639-2": "tib/bod",
  	"iso639-1": "bo"
  };
  var Tigre = {
  	name: "Tigre",
  	names: [
  		"Tigre"
  	],
  	"iso639-2": "tig",
  	"iso639-1": null
  };
  var Tigrinya = {
  	name: "Tigrinya",
  	names: [
  		"Tigrinya"
  	],
  	"iso639-2": "tir",
  	"iso639-1": "ti"
  };
  var Timne = {
  	name: "Timne",
  	names: [
  		"Timne"
  	],
  	"iso639-2": "tem",
  	"iso639-1": null
  };
  var Tiv = {
  	name: "Tiv",
  	names: [
  		"Tiv"
  	],
  	"iso639-2": "tiv",
  	"iso639-1": null
  };
  var Tlingit = {
  	name: "Tlingit",
  	names: [
  		"Tlingit"
  	],
  	"iso639-2": "tli",
  	"iso639-1": null
  };
  var Tokelau = {
  	name: "Tokelau",
  	names: [
  		"Tokelau"
  	],
  	"iso639-2": "tkl",
  	"iso639-1": null
  };
  var Tsimshian = {
  	name: "Tsimshian",
  	names: [
  		"Tsimshian"
  	],
  	"iso639-2": "tsi",
  	"iso639-1": null
  };
  var Tsonga = {
  	name: "Tsonga",
  	names: [
  		"Tsonga"
  	],
  	"iso639-2": "tso",
  	"iso639-1": "ts"
  };
  var Tswana = {
  	name: "Tswana",
  	names: [
  		"Tswana"
  	],
  	"iso639-2": "tsn",
  	"iso639-1": "tn"
  };
  var Tumbuka = {
  	name: "Tumbuka",
  	names: [
  		"Tumbuka"
  	],
  	"iso639-2": "tum",
  	"iso639-1": null
  };
  var Turkish = {
  	name: "Turkish",
  	names: [
  		"Turkish"
  	],
  	"iso639-2": "tur",
  	"iso639-1": "tr"
  };
  var Turkmen = {
  	name: "Turkmen",
  	names: [
  		"Turkmen"
  	],
  	"iso639-2": "tuk",
  	"iso639-1": "tk"
  };
  var Tuvalu = {
  	name: "Tuvalu",
  	names: [
  		"Tuvalu"
  	],
  	"iso639-2": "tvl",
  	"iso639-1": null
  };
  var Tuvinian = {
  	name: "Tuvinian",
  	names: [
  		"Tuvinian"
  	],
  	"iso639-2": "tyv",
  	"iso639-1": null
  };
  var Twi = {
  	name: "Twi",
  	names: [
  		"Twi"
  	],
  	"iso639-2": "twi",
  	"iso639-1": "tw"
  };
  var Udmurt = {
  	name: "Udmurt",
  	names: [
  		"Udmurt"
  	],
  	"iso639-2": "udm",
  	"iso639-1": null
  };
  var Ugaritic = {
  	name: "Ugaritic",
  	names: [
  		"Ugaritic"
  	],
  	"iso639-2": "uga",
  	"iso639-1": null
  };
  var Uighur = {
  	name: "Uighur",
  	names: [
  		"Uighur",
  		"Uyghur"
  	],
  	"iso639-2": "uig",
  	"iso639-1": "ug"
  };
  var Ukrainian = {
  	name: "Ukrainian",
  	names: [
  		"Ukrainian"
  	],
  	"iso639-2": "ukr",
  	"iso639-1": "uk"
  };
  var Umbundu = {
  	name: "Umbundu",
  	names: [
  		"Umbundu"
  	],
  	"iso639-2": "umb",
  	"iso639-1": null
  };
  var Undetermined = {
  	name: "Undetermined",
  	names: [
  		"Undetermined"
  	],
  	"iso639-2": "und",
  	"iso639-1": null
  };
  var Urdu = {
  	name: "Urdu",
  	names: [
  		"Urdu"
  	],
  	"iso639-2": "urd",
  	"iso639-1": "ur"
  };
  var Uyghur = {
  	name: "Uyghur",
  	names: [
  		"Uighur",
  		"Uyghur"
  	],
  	"iso639-2": "uig",
  	"iso639-1": "ug"
  };
  var Uzbek = {
  	name: "Uzbek",
  	names: [
  		"Uzbek"
  	],
  	"iso639-2": "uzb",
  	"iso639-1": "uz"
  };
  var Vai = {
  	name: "Vai",
  	names: [
  		"Vai"
  	],
  	"iso639-2": "vai",
  	"iso639-1": null
  };
  var Valencian = {
  	name: "Valencian",
  	names: [
  		"Catalan",
  		"Valencian"
  	],
  	"iso639-2": "cat",
  	"iso639-1": "ca"
  };
  var Venda = {
  	name: "Venda",
  	names: [
  		"Venda"
  	],
  	"iso639-2": "ven",
  	"iso639-1": "ve"
  };
  var Vietnamese = {
  	name: "Vietnamese",
  	names: [
  		"Vietnamese"
  	],
  	"iso639-2": "vie",
  	"iso639-1": "vi"
  };
  var Votic = {
  	name: "Votic",
  	names: [
  		"Votic"
  	],
  	"iso639-2": "vot",
  	"iso639-1": null
  };
  var Walloon = {
  	name: "Walloon",
  	names: [
  		"Walloon"
  	],
  	"iso639-2": "wln",
  	"iso639-1": "wa"
  };
  var Waray = {
  	name: "Waray",
  	names: [
  		"Waray"
  	],
  	"iso639-2": "war",
  	"iso639-1": null
  };
  var Washo = {
  	name: "Washo",
  	names: [
  		"Washo"
  	],
  	"iso639-2": "was",
  	"iso639-1": null
  };
  var Welsh = {
  	name: "Welsh",
  	names: [
  		"Welsh"
  	],
  	"iso639-2": "wel/cym",
  	"iso639-1": "cy"
  };
  var Wolaitta = {
  	name: "Wolaitta",
  	names: [
  		"Wolaitta",
  		"Wolaytta"
  	],
  	"iso639-2": "wal",
  	"iso639-1": null
  };
  var Wolaytta = {
  	name: "Wolaytta",
  	names: [
  		"Wolaitta",
  		"Wolaytta"
  	],
  	"iso639-2": "wal",
  	"iso639-1": null
  };
  var Wolof = {
  	name: "Wolof",
  	names: [
  		"Wolof"
  	],
  	"iso639-2": "wol",
  	"iso639-1": "wo"
  };
  var Xhosa = {
  	name: "Xhosa",
  	names: [
  		"Xhosa"
  	],
  	"iso639-2": "xho",
  	"iso639-1": "xh"
  };
  var Yakut = {
  	name: "Yakut",
  	names: [
  		"Yakut"
  	],
  	"iso639-2": "sah",
  	"iso639-1": null
  };
  var Yao = {
  	name: "Yao",
  	names: [
  		"Yao"
  	],
  	"iso639-2": "yao",
  	"iso639-1": null
  };
  var Yapese = {
  	name: "Yapese",
  	names: [
  		"Yapese"
  	],
  	"iso639-2": "yap",
  	"iso639-1": null
  };
  var Yiddish = {
  	name: "Yiddish",
  	names: [
  		"Yiddish"
  	],
  	"iso639-2": "yid",
  	"iso639-1": "yi"
  };
  var Yoruba = {
  	name: "Yoruba",
  	names: [
  		"Yoruba"
  	],
  	"iso639-2": "yor",
  	"iso639-1": "yo"
  };
  var Zapotec = {
  	name: "Zapotec",
  	names: [
  		"Zapotec"
  	],
  	"iso639-2": "zap",
  	"iso639-1": null
  };
  var Zaza = {
  	name: "Zaza",
  	names: [
  		"Zaza",
  		"Dimili",
  		"Dimli",
  		"Kirdki",
  		"Kirmanjki",
  		"Zazaki"
  	],
  	"iso639-2": "zza",
  	"iso639-1": null
  };
  var Zazaki = {
  	name: "Zazaki",
  	names: [
  		"Zaza",
  		"Dimili",
  		"Dimli",
  		"Kirdki",
  		"Kirmanjki",
  		"Zazaki"
  	],
  	"iso639-2": "zza",
  	"iso639-1": null
  };
  var Zenaga = {
  	name: "Zenaga",
  	names: [
  		"Zenaga"
  	],
  	"iso639-2": "zen",
  	"iso639-1": null
  };
  var Zhuang = {
  	name: "Zhuang",
  	names: [
  		"Zhuang",
  		"Chuang"
  	],
  	"iso639-2": "zha",
  	"iso639-1": "za"
  };
  var Zulu = {
  	name: "Zulu",
  	names: [
  		"Zulu"
  	],
  	"iso639-2": "zul",
  	"iso639-1": "zu"
  };
  var Zuni = {
  	name: "Zuni",
  	names: [
  		"Zuni"
  	],
  	"iso639-2": "zun",
  	"iso639-1": null
  };
  var iso = {
  	Abkhazian: Abkhazian,
  	Achinese: Achinese,
  	Acoli: Acoli,
  	Adangme: Adangme,
  	Adygei: Adygei,
  	Adyghe: Adyghe,
  	Afar: Afar,
  	Afrihili: Afrihili,
  	Afrikaans: Afrikaans,
  	"Afro-Asiatic languages": {
  	name: "Afro-Asiatic languages",
  	names: [
  		"Afro-Asiatic languages"
  	],
  	"iso639-2": "afa",
  	"iso639-1": null
  },
  	Ainu: Ainu,
  	Akan: Akan,
  	Akkadian: Akkadian,
  	Albanian: Albanian,
  	Alemannic: Alemannic,
  	Aleut: Aleut,
  	"Algonquian languages": {
  	name: "Algonquian languages",
  	names: [
  		"Algonquian languages"
  	],
  	"iso639-2": "alg",
  	"iso639-1": null
  },
  	Alsatian: Alsatian,
  	"Altaic languages": {
  	name: "Altaic languages",
  	names: [
  		"Altaic languages"
  	],
  	"iso639-2": "tut",
  	"iso639-1": null
  },
  	Amharic: Amharic,
  	Angika: Angika,
  	"Apache languages": {
  	name: "Apache languages",
  	names: [
  		"Apache languages"
  	],
  	"iso639-2": "apa",
  	"iso639-1": null
  },
  	Arabic: Arabic,
  	Aragonese: Aragonese,
  	Arapaho: Arapaho,
  	Arawak: Arawak,
  	Armenian: Armenian,
  	Aromanian: Aromanian,
  	"Artificial languages": {
  	name: "Artificial languages",
  	names: [
  		"Artificial languages"
  	],
  	"iso639-2": "art",
  	"iso639-1": null
  },
  	Arumanian: Arumanian,
  	Assamese: Assamese,
  	Asturian: Asturian,
  	Asturleonese: Asturleonese,
  	"Athapascan languages": {
  	name: "Athapascan languages",
  	names: [
  		"Athapascan languages"
  	],
  	"iso639-2": "ath",
  	"iso639-1": null
  },
  	"Australian languages": {
  	name: "Australian languages",
  	names: [
  		"Australian languages"
  	],
  	"iso639-2": "aus",
  	"iso639-1": null
  },
  	"Austronesian languages": {
  	name: "Austronesian languages",
  	names: [
  		"Austronesian languages"
  	],
  	"iso639-2": "map",
  	"iso639-1": null
  },
  	Avaric: Avaric,
  	Avestan: Avestan,
  	Awadhi: Awadhi,
  	Aymara: Aymara,
  	Azerbaijani: Azerbaijani,
  	Bable: Bable,
  	Balinese: Balinese,
  	"Baltic languages": {
  	name: "Baltic languages",
  	names: [
  		"Baltic languages"
  	],
  	"iso639-2": "bat",
  	"iso639-1": null
  },
  	Baluchi: Baluchi,
  	Bambara: Bambara,
  	"Bamileke languages": {
  	name: "Bamileke languages",
  	names: [
  		"Bamileke languages"
  	],
  	"iso639-2": "bai",
  	"iso639-1": null
  },
  	"Banda languages": {
  	name: "Banda languages",
  	names: [
  		"Banda languages"
  	],
  	"iso639-2": "bad",
  	"iso639-1": null
  },
  	"Bantu languages": {
  	name: "Bantu languages",
  	names: [
  		"Bantu languages"
  	],
  	"iso639-2": "bnt",
  	"iso639-1": null
  },
  	Basa: Basa,
  	Bashkir: Bashkir,
  	Basque: Basque,
  	"Batak languages": {
  	name: "Batak languages",
  	names: [
  		"Batak languages"
  	],
  	"iso639-2": "btk",
  	"iso639-1": null
  },
  	Bedawiyet: Bedawiyet,
  	Beja: Beja,
  	Belarusian: Belarusian,
  	Bemba: Bemba,
  	Bengali: Bengali,
  	"Berber languages": {
  	name: "Berber languages",
  	names: [
  		"Berber languages"
  	],
  	"iso639-2": "ber",
  	"iso639-1": null
  },
  	Bhojpuri: Bhojpuri,
  	"Bihari languages": {
  	name: "Bihari languages",
  	names: [
  		"Bihari languages"
  	],
  	"iso639-2": "bih",
  	"iso639-1": "bh"
  },
  	Bikol: Bikol,
  	Bilin: Bilin,
  	Bini: Bini,
  	Bislama: Bislama,
  	Blin: Blin,
  	Bliss: Bliss,
  	Blissymbolics: Blissymbolics,
  	Blissymbols: Blissymbols,
  	"Bokml, Norwegian": {
  	name: "Bokml, Norwegian",
  	names: [
  		"Bokml, Norwegian",
  		"Norwegian Bokml"
  	],
  	"iso639-2": "nob",
  	"iso639-1": "nb"
  },
  	Bosnian: Bosnian,
  	Braj: Braj,
  	Breton: Breton,
  	Buginese: Buginese,
  	Bulgarian: Bulgarian,
  	Buriat: Buriat,
  	Burmese: Burmese,
  	Caddo: Caddo,
  	Castilian: Castilian,
  	Catalan: Catalan,
  	"Caucasian languages": {
  	name: "Caucasian languages",
  	names: [
  		"Caucasian languages"
  	],
  	"iso639-2": "cau",
  	"iso639-1": null
  },
  	Cebuano: Cebuano,
  	"Celtic languages": {
  	name: "Celtic languages",
  	names: [
  		"Celtic languages"
  	],
  	"iso639-2": "cel",
  	"iso639-1": null
  },
  	"Central American Indian languages": {
  	name: "Central American Indian languages",
  	names: [
  		"Central American Indian languages"
  	],
  	"iso639-2": "cai",
  	"iso639-1": null
  },
  	"Central Khmer": {
  	name: "Central Khmer",
  	names: [
  		"Central Khmer"
  	],
  	"iso639-2": "khm",
  	"iso639-1": "km"
  },
  	Chagatai: Chagatai,
  	"Chamic languages": {
  	name: "Chamic languages",
  	names: [
  		"Chamic languages"
  	],
  	"iso639-2": "cmc",
  	"iso639-1": null
  },
  	Chamorro: Chamorro,
  	Chechen: Chechen,
  	Cherokee: Cherokee,
  	Chewa: Chewa,
  	Cheyenne: Cheyenne,
  	Chibcha: Chibcha,
  	Chichewa: Chichewa,
  	Chinese: Chinese,
  	"Chinook jargon": {
  	name: "Chinook jargon",
  	names: [
  		"Chinook jargon"
  	],
  	"iso639-2": "chn",
  	"iso639-1": null
  },
  	Chipewyan: Chipewyan,
  	Choctaw: Choctaw,
  	Chuang: Chuang,
  	"Church Slavic": {
  	name: "Church Slavic",
  	names: [
  		"Church Slavic",
  		"Old Slavonic",
  		"Church Slavonic",
  		"Old Bulgarian",
  		"Old Church Slavonic"
  	],
  	"iso639-2": "chu",
  	"iso639-1": "cu"
  },
  	"Church Slavonic": {
  	name: "Church Slavonic",
  	names: [
  		"Church Slavic",
  		"Old Slavonic",
  		"Church Slavonic",
  		"Old Bulgarian",
  		"Old Church Slavonic"
  	],
  	"iso639-2": "chu",
  	"iso639-1": "cu"
  },
  	Chuukese: Chuukese,
  	Chuvash: Chuvash,
  	"Classical Nepal Bhasa": {
  	name: "Classical Nepal Bhasa",
  	names: [
  		"Classical Newari",
  		"Old Newari",
  		"Classical Nepal Bhasa"
  	],
  	"iso639-2": "nwc",
  	"iso639-1": null
  },
  	"Classical Newari": {
  	name: "Classical Newari",
  	names: [
  		"Classical Newari",
  		"Old Newari",
  		"Classical Nepal Bhasa"
  	],
  	"iso639-2": "nwc",
  	"iso639-1": null
  },
  	"Classical Syriac": {
  	name: "Classical Syriac",
  	names: [
  		"Classical Syriac"
  	],
  	"iso639-2": "syc",
  	"iso639-1": null
  },
  	"Cook Islands Maori": {
  	name: "Cook Islands Maori",
  	names: [
  		"Rarotongan",
  		"Cook Islands Maori"
  	],
  	"iso639-2": "rar",
  	"iso639-1": null
  },
  	Coptic: Coptic,
  	Cornish: Cornish,
  	Corsican: Corsican,
  	Cree: Cree,
  	Creek: Creek,
  	"Creoles and pidgins": {
  	name: "Creoles and pidgins",
  	names: [
  		"Creoles and pidgins"
  	],
  	"iso639-2": "crp",
  	"iso639-1": null
  },
  	"Creoles and pidgins, English based": {
  	name: "Creoles and pidgins, English based",
  	names: [
  		"Creoles and pidgins, English based"
  	],
  	"iso639-2": "cpe",
  	"iso639-1": null
  },
  	"Creoles and pidgins, French-based": {
  	name: "Creoles and pidgins, French-based",
  	names: [
  		"Creoles and pidgins, French-based"
  	],
  	"iso639-2": "cpf",
  	"iso639-1": null
  },
  	"Creoles and pidgins, Portuguese-based": {
  	name: "Creoles and pidgins, Portuguese-based",
  	names: [
  		"Creoles and pidgins, Portuguese-based"
  	],
  	"iso639-2": "cpp",
  	"iso639-1": null
  },
  	"Crimean Tatar": {
  	name: "Crimean Tatar",
  	names: [
  		"Crimean Tatar",
  		"Crimean Turkish"
  	],
  	"iso639-2": "crh",
  	"iso639-1": null
  },
  	"Crimean Turkish": {
  	name: "Crimean Turkish",
  	names: [
  		"Crimean Tatar",
  		"Crimean Turkish"
  	],
  	"iso639-2": "crh",
  	"iso639-1": null
  },
  	Croatian: Croatian,
  	"Cushitic languages": {
  	name: "Cushitic languages",
  	names: [
  		"Cushitic languages"
  	],
  	"iso639-2": "cus",
  	"iso639-1": null
  },
  	Czech: Czech,
  	Dakota: Dakota,
  	Danish: Danish,
  	Dargwa: Dargwa,
  	Delaware: Delaware,
  	"Dene Suline": {
  	name: "Dene Suline",
  	names: [
  		"Chipewyan",
  		"Dene Suline"
  	],
  	"iso639-2": "chp",
  	"iso639-1": null
  },
  	Dhivehi: Dhivehi,
  	Dimili: Dimili,
  	Dimli: Dimli,
  	Dinka: Dinka,
  	Divehi: Divehi,
  	Dogri: Dogri,
  	Dogrib: Dogrib,
  	"Dravidian languages": {
  	name: "Dravidian languages",
  	names: [
  		"Dravidian languages"
  	],
  	"iso639-2": "dra",
  	"iso639-1": null
  },
  	Duala: Duala,
  	Dutch: Dutch,
  	"Dutch, Middle (ca.1050-1350)": {
  	name: "Dutch, Middle (ca.1050-1350)",
  	names: [
  		"Dutch, Middle (ca.1050-1350)"
  	],
  	"iso639-2": "dum",
  	"iso639-1": null
  },
  	Dyula: Dyula,
  	Dzongkha: Dzongkha,
  	"Eastern Frisian": {
  	name: "Eastern Frisian",
  	names: [
  		"Eastern Frisian"
  	],
  	"iso639-2": "frs",
  	"iso639-1": null
  },
  	Edo: Edo,
  	Efik: Efik,
  	"Egyptian (Ancient)": {
  	name: "Egyptian (Ancient)",
  	names: [
  		"Egyptian (Ancient)"
  	],
  	"iso639-2": "egy",
  	"iso639-1": null
  },
  	Ekajuk: Ekajuk,
  	Elamite: Elamite,
  	English: English,
  	"English, Middle (1100-1500)": {
  	name: "English, Middle (1100-1500)",
  	names: [
  		"English, Middle (1100-1500)"
  	],
  	"iso639-2": "enm",
  	"iso639-1": null
  },
  	"English, Old (ca.450-1100)": {
  	name: "English, Old (ca.450-1100)",
  	names: [
  		"English, Old (ca.450-1100)"
  	],
  	"iso639-2": "ang",
  	"iso639-1": null
  },
  	Erzya: Erzya,
  	Esperanto: Esperanto,
  	Estonian: Estonian,
  	Ewe: Ewe,
  	Ewondo: Ewondo,
  	Fang: Fang,
  	Fanti: Fanti,
  	Faroese: Faroese,
  	Fijian: Fijian,
  	Filipino: Filipino,
  	Finnish: Finnish,
  	"Finno-Ugrian languages": {
  	name: "Finno-Ugrian languages",
  	names: [
  		"Finno-Ugrian languages"
  	],
  	"iso639-2": "fiu",
  	"iso639-1": null
  },
  	Flemish: Flemish,
  	Fon: Fon,
  	French: French,
  	"French, Middle (ca.1400-1600)": {
  	name: "French, Middle (ca.1400-1600)",
  	names: [
  		"French, Middle (ca.1400-1600)"
  	],
  	"iso639-2": "frm",
  	"iso639-1": null
  },
  	"French, Old (842-ca.1400)": {
  	name: "French, Old (842-ca.1400)",
  	names: [
  		"French, Old (842-ca.1400)"
  	],
  	"iso639-2": "fro",
  	"iso639-1": null
  },
  	Friulian: Friulian,
  	Fulah: Fulah,
  	Ga: Ga,
  	Gaelic: Gaelic,
  	"Galibi Carib": {
  	name: "Galibi Carib",
  	names: [
  		"Galibi Carib"
  	],
  	"iso639-2": "car",
  	"iso639-1": null
  },
  	Galician: Galician,
  	Ganda: Ganda,
  	Gayo: Gayo,
  	Gbaya: Gbaya,
  	Geez: Geez,
  	Georgian: Georgian,
  	German: German,
  	"German, Low": {
  	name: "German, Low",
  	names: [
  		"Low German",
  		"Low Saxon",
  		"German, Low",
  		"Saxon, Low"
  	],
  	"iso639-2": "nds",
  	"iso639-1": null
  },
  	"German, Middle High (ca.1050-1500)": {
  	name: "German, Middle High (ca.1050-1500)",
  	names: [
  		"German, Middle High (ca.1050-1500)"
  	],
  	"iso639-2": "gmh",
  	"iso639-1": null
  },
  	"German, Old High (ca.750-1050)": {
  	name: "German, Old High (ca.750-1050)",
  	names: [
  		"German, Old High (ca.750-1050)"
  	],
  	"iso639-2": "goh",
  	"iso639-1": null
  },
  	"Germanic languages": {
  	name: "Germanic languages",
  	names: [
  		"Germanic languages"
  	],
  	"iso639-2": "gem",
  	"iso639-1": null
  },
  	Gikuyu: Gikuyu,
  	Gilbertese: Gilbertese,
  	Gondi: Gondi,
  	Gorontalo: Gorontalo,
  	Gothic: Gothic,
  	Grebo: Grebo,
  	"Greek, Ancient (to 1453)": {
  	name: "Greek, Ancient (to 1453)",
  	names: [
  		"Greek, Ancient (to 1453)"
  	],
  	"iso639-2": "grc",
  	"iso639-1": null
  },
  	"Greek, Modern (1453-)": {
  	name: "Greek, Modern (1453-)",
  	names: [
  		"Greek, Modern (1453-)"
  	],
  	"iso639-2": "gre/ell",
  	"iso639-1": "el"
  },
  	Greenlandic: Greenlandic,
  	Guarani: Guarani,
  	Gujarati: Gujarati,
  	"Gwich'in": {
  	name: "Gwich'in",
  	names: [
  		"Gwich'in"
  	],
  	"iso639-2": "gwi",
  	"iso639-1": null
  },
  	Haida: Haida,
  	Haitian: Haitian,
  	"Haitian Creole": {
  	name: "Haitian Creole",
  	names: [
  		"Haitian",
  		"Haitian Creole"
  	],
  	"iso639-2": "hat",
  	"iso639-1": "ht"
  },
  	Hausa: Hausa,
  	Hawaiian: Hawaiian,
  	Hebrew: Hebrew,
  	Herero: Herero,
  	Hiligaynon: Hiligaynon,
  	"Himachali languages": {
  	name: "Himachali languages",
  	names: [
  		"Himachali languages",
  		"Western Pahari languages"
  	],
  	"iso639-2": "him",
  	"iso639-1": null
  },
  	Hindi: Hindi,
  	"Hiri Motu": {
  	name: "Hiri Motu",
  	names: [
  		"Hiri Motu"
  	],
  	"iso639-2": "hmo",
  	"iso639-1": "ho"
  },
  	Hittite: Hittite,
  	Hmong: Hmong,
  	Hungarian: Hungarian,
  	Hupa: Hupa,
  	Iban: Iban,
  	Icelandic: Icelandic,
  	Ido: Ido,
  	Igbo: Igbo,
  	"Ijo languages": {
  	name: "Ijo languages",
  	names: [
  		"Ijo languages"
  	],
  	"iso639-2": "ijo",
  	"iso639-1": null
  },
  	Iloko: Iloko,
  	"Imperial Aramaic (700-300 BCE)": {
  	name: "Imperial Aramaic (700-300 BCE)",
  	names: [
  		"Official Aramaic (700-300 BCE)",
  		"Imperial Aramaic (700-300 BCE)"
  	],
  	"iso639-2": "arc",
  	"iso639-1": null
  },
  	"Inari Sami": {
  	name: "Inari Sami",
  	names: [
  		"Inari Sami"
  	],
  	"iso639-2": "smn",
  	"iso639-1": null
  },
  	"Indic languages": {
  	name: "Indic languages",
  	names: [
  		"Indic languages"
  	],
  	"iso639-2": "inc",
  	"iso639-1": null
  },
  	"Indo-European languages": {
  	name: "Indo-European languages",
  	names: [
  		"Indo-European languages"
  	],
  	"iso639-2": "ine",
  	"iso639-1": null
  },
  	Indonesian: Indonesian,
  	Ingush: Ingush,
  	"Interlingua (International Auxiliary Language Association)": {
  	name: "Interlingua (International Auxiliary Language Association)",
  	names: [
  		"Interlingua (International Auxiliary Language Association)"
  	],
  	"iso639-2": "ina",
  	"iso639-1": "ia"
  },
  	Interlingue: Interlingue,
  	Inuktitut: Inuktitut,
  	Inupiaq: Inupiaq,
  	"Iranian languages": {
  	name: "Iranian languages",
  	names: [
  		"Iranian languages"
  	],
  	"iso639-2": "ira",
  	"iso639-1": null
  },
  	Irish: Irish,
  	"Irish, Middle (900-1200)": {
  	name: "Irish, Middle (900-1200)",
  	names: [
  		"Irish, Middle (900-1200)"
  	],
  	"iso639-2": "mga",
  	"iso639-1": null
  },
  	"Irish, Old (to 900)": {
  	name: "Irish, Old (to 900)",
  	names: [
  		"Irish, Old (to 900)"
  	],
  	"iso639-2": "sga",
  	"iso639-1": null
  },
  	"Iroquoian languages": {
  	name: "Iroquoian languages",
  	names: [
  		"Iroquoian languages"
  	],
  	"iso639-2": "iro",
  	"iso639-1": null
  },
  	Italian: Italian,
  	Japanese: Japanese,
  	Javanese: Javanese,
  	Jingpho: Jingpho,
  	"Judeo-Arabic": {
  	name: "Judeo-Arabic",
  	names: [
  		"Judeo-Arabic"
  	],
  	"iso639-2": "jrb",
  	"iso639-1": null
  },
  	"Judeo-Persian": {
  	name: "Judeo-Persian",
  	names: [
  		"Judeo-Persian"
  	],
  	"iso639-2": "jpr",
  	"iso639-1": null
  },
  	Kabardian: Kabardian,
  	Kabyle: Kabyle,
  	Kachin: Kachin,
  	Kalaallisut: Kalaallisut,
  	Kalmyk: Kalmyk,
  	Kamba: Kamba,
  	Kannada: Kannada,
  	Kanuri: Kanuri,
  	Kapampangan: Kapampangan,
  	"Kara-Kalpak": {
  	name: "Kara-Kalpak",
  	names: [
  		"Kara-Kalpak"
  	],
  	"iso639-2": "kaa",
  	"iso639-1": null
  },
  	"Karachay-Balkar": {
  	name: "Karachay-Balkar",
  	names: [
  		"Karachay-Balkar"
  	],
  	"iso639-2": "krc",
  	"iso639-1": null
  },
  	Karelian: Karelian,
  	"Karen languages": {
  	name: "Karen languages",
  	names: [
  		"Karen languages"
  	],
  	"iso639-2": "kar",
  	"iso639-1": null
  },
  	Kashmiri: Kashmiri,
  	Kashubian: Kashubian,
  	Kawi: Kawi,
  	Kazakh: Kazakh,
  	Khasi: Khasi,
  	"Khoisan languages": {
  	name: "Khoisan languages",
  	names: [
  		"Khoisan languages"
  	],
  	"iso639-2": "khi",
  	"iso639-1": null
  },
  	Khotanese: Khotanese,
  	Kikuyu: Kikuyu,
  	Kimbundu: Kimbundu,
  	Kinyarwanda: Kinyarwanda,
  	Kirdki: Kirdki,
  	Kirghiz: Kirghiz,
  	Kirmanjki: Kirmanjki,
  	Klingon: Klingon,
  	Komi: Komi,
  	Kongo: Kongo,
  	Konkani: Konkani,
  	Korean: Korean,
  	Kosraean: Kosraean,
  	Kpelle: Kpelle,
  	"Kru languages": {
  	name: "Kru languages",
  	names: [
  		"Kru languages"
  	],
  	"iso639-2": "kro",
  	"iso639-1": null
  },
  	Kuanyama: Kuanyama,
  	Kumyk: Kumyk,
  	Kurdish: Kurdish,
  	Kurukh: Kurukh,
  	Kutenai: Kutenai,
  	Kwanyama: Kwanyama,
  	Kyrgyz: Kyrgyz,
  	Ladino: Ladino,
  	Lahnda: Lahnda,
  	Lamba: Lamba,
  	"Land Dayak languages": {
  	name: "Land Dayak languages",
  	names: [
  		"Land Dayak languages"
  	],
  	"iso639-2": "day",
  	"iso639-1": null
  },
  	Lao: Lao,
  	Latin: Latin,
  	Latvian: Latvian,
  	Leonese: Leonese,
  	Letzeburgesch: Letzeburgesch,
  	Lezghian: Lezghian,
  	Limburgan: Limburgan,
  	Limburger: Limburger,
  	Limburgish: Limburgish,
  	Lingala: Lingala,
  	Lithuanian: Lithuanian,
  	Lojban: Lojban,
  	"Low German": {
  	name: "Low German",
  	names: [
  		"Low German",
  		"Low Saxon",
  		"German, Low",
  		"Saxon, Low"
  	],
  	"iso639-2": "nds",
  	"iso639-1": null
  },
  	"Low Saxon": {
  	name: "Low Saxon",
  	names: [
  		"Low German",
  		"Low Saxon",
  		"German, Low",
  		"Saxon, Low"
  	],
  	"iso639-2": "nds",
  	"iso639-1": null
  },
  	"Lower Sorbian": {
  	name: "Lower Sorbian",
  	names: [
  		"Lower Sorbian"
  	],
  	"iso639-2": "dsb",
  	"iso639-1": null
  },
  	Lozi: Lozi,
  	"Luba-Katanga": {
  	name: "Luba-Katanga",
  	names: [
  		"Luba-Katanga"
  	],
  	"iso639-2": "lub",
  	"iso639-1": "lu"
  },
  	"Luba-Lulua": {
  	name: "Luba-Lulua",
  	names: [
  		"Luba-Lulua"
  	],
  	"iso639-2": "lua",
  	"iso639-1": null
  },
  	Luiseno: Luiseno,
  	"Lule Sami": {
  	name: "Lule Sami",
  	names: [
  		"Lule Sami"
  	],
  	"iso639-2": "smj",
  	"iso639-1": null
  },
  	Lunda: Lunda,
  	"Luo (Kenya and Tanzania)": {
  	name: "Luo (Kenya and Tanzania)",
  	names: [
  		"Luo (Kenya and Tanzania)"
  	],
  	"iso639-2": "luo",
  	"iso639-1": null
  },
  	Lushai: Lushai,
  	Luxembourgish: Luxembourgish,
  	"Macedo-Romanian": {
  	name: "Macedo-Romanian",
  	names: [
  		"Aromanian",
  		"Arumanian",
  		"Macedo-Romanian"
  	],
  	"iso639-2": "rup",
  	"iso639-1": null
  },
  	Macedonian: Macedonian,
  	Madurese: Madurese,
  	Magahi: Magahi,
  	Maithili: Maithili,
  	Makasar: Makasar,
  	Malagasy: Malagasy,
  	Malay: Malay,
  	Malayalam: Malayalam,
  	Maldivian: Maldivian,
  	Maltese: Maltese,
  	Manchu: Manchu,
  	Mandar: Mandar,
  	Mandingo: Mandingo,
  	Manipuri: Manipuri,
  	"Manobo languages": {
  	name: "Manobo languages",
  	names: [
  		"Manobo languages"
  	],
  	"iso639-2": "mno",
  	"iso639-1": null
  },
  	Manx: Manx,
  	Maori: Maori,
  	Mapuche: Mapuche,
  	Mapudungun: Mapudungun,
  	Marathi: Marathi,
  	Mari: Mari,
  	Marshallese: Marshallese,
  	Marwari: Marwari,
  	Masai: Masai,
  	"Mayan languages": {
  	name: "Mayan languages",
  	names: [
  		"Mayan languages"
  	],
  	"iso639-2": "myn",
  	"iso639-1": null
  },
  	Mende: Mende,
  	"Mi'kmaq": {
  	name: "Mi'kmaq",
  	names: [
  		"Mi'kmaq",
  		"Micmac"
  	],
  	"iso639-2": "mic",
  	"iso639-1": null
  },
  	Micmac: Micmac,
  	Minangkabau: Minangkabau,
  	Mirandese: Mirandese,
  	Mohawk: Mohawk,
  	Moksha: Moksha,
  	Moldavian: Moldavian,
  	Moldovan: Moldovan,
  	"Mon-Khmer languages": {
  	name: "Mon-Khmer languages",
  	names: [
  		"Mon-Khmer languages"
  	],
  	"iso639-2": "mkh",
  	"iso639-1": null
  },
  	Mong: Mong,
  	Mongo: Mongo,
  	Mongolian: Mongolian,
  	Montenegrin: Montenegrin,
  	Mossi: Mossi,
  	"Multiple languages": {
  	name: "Multiple languages",
  	names: [
  		"Multiple languages"
  	],
  	"iso639-2": "mul",
  	"iso639-1": null
  },
  	"Munda languages": {
  	name: "Munda languages",
  	names: [
  		"Munda languages"
  	],
  	"iso639-2": "mun",
  	"iso639-1": null
  },
  	"N'Ko": {
  	name: "N'Ko",
  	names: [
  		"N'Ko"
  	],
  	"iso639-2": "nqo",
  	"iso639-1": null
  },
  	"Nahuatl languages": {
  	name: "Nahuatl languages",
  	names: [
  		"Nahuatl languages"
  	],
  	"iso639-2": "nah",
  	"iso639-1": null
  },
  	Nauru: Nauru,
  	Navaho: Navaho,
  	Navajo: Navajo,
  	"Ndebele, North": {
  	name: "Ndebele, North",
  	names: [
  		"Ndebele, North",
  		"North Ndebele"
  	],
  	"iso639-2": "nde",
  	"iso639-1": "nd"
  },
  	"Ndebele, South": {
  	name: "Ndebele, South",
  	names: [
  		"Ndebele, South",
  		"South Ndebele"
  	],
  	"iso639-2": "nbl",
  	"iso639-1": "nr"
  },
  	Ndonga: Ndonga,
  	Neapolitan: Neapolitan,
  	"Nepal Bhasa": {
  	name: "Nepal Bhasa",
  	names: [
  		"Nepal Bhasa",
  		"Newari"
  	],
  	"iso639-2": "new",
  	"iso639-1": null
  },
  	Nepali: Nepali,
  	Newari: Newari,
  	Nias: Nias,
  	"Niger-Kordofanian languages": {
  	name: "Niger-Kordofanian languages",
  	names: [
  		"Niger-Kordofanian languages"
  	],
  	"iso639-2": "nic",
  	"iso639-1": null
  },
  	"Nilo-Saharan languages": {
  	name: "Nilo-Saharan languages",
  	names: [
  		"Nilo-Saharan languages"
  	],
  	"iso639-2": "ssa",
  	"iso639-1": null
  },
  	Niuean: Niuean,
  	"No linguistic content": {
  	name: "No linguistic content",
  	names: [
  		"No linguistic content",
  		"Not applicable"
  	],
  	"iso639-2": "zxx",
  	"iso639-1": null
  },
  	Nogai: Nogai,
  	"Norse, Old": {
  	name: "Norse, Old",
  	names: [
  		"Norse, Old"
  	],
  	"iso639-2": "non",
  	"iso639-1": null
  },
  	"North American Indian languages": {
  	name: "North American Indian languages",
  	names: [
  		"North American Indian languages"
  	],
  	"iso639-2": "nai",
  	"iso639-1": null
  },
  	"North Ndebele": {
  	name: "North Ndebele",
  	names: [
  		"Ndebele, North",
  		"North Ndebele"
  	],
  	"iso639-2": "nde",
  	"iso639-1": "nd"
  },
  	"Northern Frisian": {
  	name: "Northern Frisian",
  	names: [
  		"Northern Frisian"
  	],
  	"iso639-2": "frr",
  	"iso639-1": null
  },
  	"Northern Sami": {
  	name: "Northern Sami",
  	names: [
  		"Northern Sami"
  	],
  	"iso639-2": "sme",
  	"iso639-1": "se"
  },
  	"Northern Sotho": {
  	name: "Northern Sotho",
  	names: [
  		"Pedi",
  		"Sepedi",
  		"Northern Sotho"
  	],
  	"iso639-2": "nso",
  	"iso639-1": null
  },
  	Norwegian: Norwegian,
  	"Norwegian Bokml": {
  	name: "Norwegian Bokml",
  	names: [
  		"Bokml, Norwegian",
  		"Norwegian Bokml"
  	],
  	"iso639-2": "nob",
  	"iso639-1": "nb"
  },
  	"Norwegian Nynorsk": {
  	name: "Norwegian Nynorsk",
  	names: [
  		"Norwegian Nynorsk",
  		"Nynorsk, Norwegian"
  	],
  	"iso639-2": "nno",
  	"iso639-1": "nn"
  },
  	"Not applicable": {
  	name: "Not applicable",
  	names: [
  		"No linguistic content",
  		"Not applicable"
  	],
  	"iso639-2": "zxx",
  	"iso639-1": null
  },
  	"Nubian languages": {
  	name: "Nubian languages",
  	names: [
  		"Nubian languages"
  	],
  	"iso639-2": "nub",
  	"iso639-1": null
  },
  	Nuosu: Nuosu,
  	Nyamwezi: Nyamwezi,
  	Nyanja: Nyanja,
  	Nyankole: Nyankole,
  	"Nynorsk, Norwegian": {
  	name: "Nynorsk, Norwegian",
  	names: [
  		"Norwegian Nynorsk",
  		"Nynorsk, Norwegian"
  	],
  	"iso639-2": "nno",
  	"iso639-1": "nn"
  },
  	Nyoro: Nyoro,
  	Nzima: Nzima,
  	Occidental: Occidental,
  	"Occitan (post 1500)": {
  	name: "Occitan (post 1500)",
  	names: [
  		"Occitan (post 1500)"
  	],
  	"iso639-2": "oci",
  	"iso639-1": "oc"
  },
  	"Occitan, Old (to 1500)": {
  	name: "Occitan, Old (to 1500)",
  	names: [
  		"Provenal, Old (to 1500)",
  		"Occitan, Old (to 1500)"
  	],
  	"iso639-2": "pro",
  	"iso639-1": null
  },
  	"Official Aramaic (700-300 BCE)": {
  	name: "Official Aramaic (700-300 BCE)",
  	names: [
  		"Official Aramaic (700-300 BCE)",
  		"Imperial Aramaic (700-300 BCE)"
  	],
  	"iso639-2": "arc",
  	"iso639-1": null
  },
  	Oirat: Oirat,
  	Ojibwa: Ojibwa,
  	"Old Bulgarian": {
  	name: "Old Bulgarian",
  	names: [
  		"Church Slavic",
  		"Old Slavonic",
  		"Church Slavonic",
  		"Old Bulgarian",
  		"Old Church Slavonic"
  	],
  	"iso639-2": "chu",
  	"iso639-1": "cu"
  },
  	"Old Church Slavonic": {
  	name: "Old Church Slavonic",
  	names: [
  		"Church Slavic",
  		"Old Slavonic",
  		"Church Slavonic",
  		"Old Bulgarian",
  		"Old Church Slavonic"
  	],
  	"iso639-2": "chu",
  	"iso639-1": "cu"
  },
  	"Old Newari": {
  	name: "Old Newari",
  	names: [
  		"Classical Newari",
  		"Old Newari",
  		"Classical Nepal Bhasa"
  	],
  	"iso639-2": "nwc",
  	"iso639-1": null
  },
  	"Old Slavonic": {
  	name: "Old Slavonic",
  	names: [
  		"Church Slavic",
  		"Old Slavonic",
  		"Church Slavonic",
  		"Old Bulgarian",
  		"Old Church Slavonic"
  	],
  	"iso639-2": "chu",
  	"iso639-1": "cu"
  },
  	Oriya: Oriya,
  	Oromo: Oromo,
  	Osage: Osage,
  	Ossetian: Ossetian,
  	Ossetic: Ossetic,
  	"Otomian languages": {
  	name: "Otomian languages",
  	names: [
  		"Otomian languages"
  	],
  	"iso639-2": "oto",
  	"iso639-1": null
  },
  	Pahlavi: Pahlavi,
  	Palauan: Palauan,
  	Pali: Pali,
  	Pampanga: Pampanga,
  	Pangasinan: Pangasinan,
  	Panjabi: Panjabi,
  	Papiamento: Papiamento,
  	"Papuan languages": {
  	name: "Papuan languages",
  	names: [
  		"Papuan languages"
  	],
  	"iso639-2": "paa",
  	"iso639-1": null
  },
  	Pashto: Pashto,
  	Pedi: Pedi,
  	Persian: Persian,
  	"Persian, Old (ca.600-400 B.C.)": {
  	name: "Persian, Old (ca.600-400 B.C.)",
  	names: [
  		"Persian, Old (ca.600-400 B.C.)"
  	],
  	"iso639-2": "peo",
  	"iso639-1": null
  },
  	"Philippine languages": {
  	name: "Philippine languages",
  	names: [
  		"Philippine languages"
  	],
  	"iso639-2": "phi",
  	"iso639-1": null
  },
  	Phoenician: Phoenician,
  	Pilipino: Pilipino,
  	Pohnpeian: Pohnpeian,
  	Polish: Polish,
  	Portuguese: Portuguese,
  	"Prakrit languages": {
  	name: "Prakrit languages",
  	names: [
  		"Prakrit languages"
  	],
  	"iso639-2": "pra",
  	"iso639-1": null
  },
  	"Provenal, Old (to 1500)": {
  	name: "Provenal, Old (to 1500)",
  	names: [
  		"Provenal, Old (to 1500)",
  		"Occitan, Old (to 1500)"
  	],
  	"iso639-2": "pro",
  	"iso639-1": null
  },
  	Punjabi: Punjabi,
  	Pushto: Pushto,
  	Quechua: Quechua,
  	Rajasthani: Rajasthani,
  	Rapanui: Rapanui,
  	Rarotongan: Rarotongan,
  	"Reserved for local use": {
  	name: "Reserved for local use",
  	names: [
  		"Reserved for local use"
  	],
  	"iso639-2": "qaa-qtz",
  	"iso639-1": null
  },
  	"Romance languages": {
  	name: "Romance languages",
  	names: [
  		"Romance languages"
  	],
  	"iso639-2": "roa",
  	"iso639-1": null
  },
  	Romanian: Romanian,
  	Romansh: Romansh,
  	Romany: Romany,
  	Rundi: Rundi,
  	Russian: Russian,
  	Sakan: Sakan,
  	"Salishan languages": {
  	name: "Salishan languages",
  	names: [
  		"Salishan languages"
  	],
  	"iso639-2": "sal",
  	"iso639-1": null
  },
  	"Samaritan Aramaic": {
  	name: "Samaritan Aramaic",
  	names: [
  		"Samaritan Aramaic"
  	],
  	"iso639-2": "sam",
  	"iso639-1": null
  },
  	"Sami languages": {
  	name: "Sami languages",
  	names: [
  		"Sami languages"
  	],
  	"iso639-2": "smi",
  	"iso639-1": null
  },
  	Samoan: Samoan,
  	Sandawe: Sandawe,
  	Sango: Sango,
  	Sanskrit: Sanskrit,
  	Santali: Santali,
  	Sardinian: Sardinian,
  	Sasak: Sasak,
  	"Saxon, Low": {
  	name: "Saxon, Low",
  	names: [
  		"Low German",
  		"Low Saxon",
  		"German, Low",
  		"Saxon, Low"
  	],
  	"iso639-2": "nds",
  	"iso639-1": null
  },
  	Scots: Scots,
  	"Scottish Gaelic": {
  	name: "Scottish Gaelic",
  	names: [
  		"Gaelic",
  		"Scottish Gaelic"
  	],
  	"iso639-2": "gla",
  	"iso639-1": "gd"
  },
  	Selkup: Selkup,
  	"Semitic languages": {
  	name: "Semitic languages",
  	names: [
  		"Semitic languages"
  	],
  	"iso639-2": "sem",
  	"iso639-1": null
  },
  	Sepedi: Sepedi,
  	Serbian: Serbian,
  	Serer: Serer,
  	Shan: Shan,
  	Shona: Shona,
  	"Sichuan Yi": {
  	name: "Sichuan Yi",
  	names: [
  		"Sichuan Yi",
  		"Nuosu"
  	],
  	"iso639-2": "iii",
  	"iso639-1": "ii"
  },
  	Sicilian: Sicilian,
  	Sidamo: Sidamo,
  	"Sign Languages": {
  	name: "Sign Languages",
  	names: [
  		"Sign Languages"
  	],
  	"iso639-2": "sgn",
  	"iso639-1": null
  },
  	Siksika: Siksika,
  	Sindhi: Sindhi,
  	Sinhala: Sinhala,
  	Sinhalese: Sinhalese,
  	"Sino-Tibetan languages": {
  	name: "Sino-Tibetan languages",
  	names: [
  		"Sino-Tibetan languages"
  	],
  	"iso639-2": "sit",
  	"iso639-1": null
  },
  	"Siouan languages": {
  	name: "Siouan languages",
  	names: [
  		"Siouan languages"
  	],
  	"iso639-2": "sio",
  	"iso639-1": null
  },
  	"Skolt Sami": {
  	name: "Skolt Sami",
  	names: [
  		"Skolt Sami"
  	],
  	"iso639-2": "sms",
  	"iso639-1": null
  },
  	"Slave (Athapascan)": {
  	name: "Slave (Athapascan)",
  	names: [
  		"Slave (Athapascan)"
  	],
  	"iso639-2": "den",
  	"iso639-1": null
  },
  	"Slavic languages": {
  	name: "Slavic languages",
  	names: [
  		"Slavic languages"
  	],
  	"iso639-2": "sla",
  	"iso639-1": null
  },
  	Slovak: Slovak,
  	Slovenian: Slovenian,
  	Sogdian: Sogdian,
  	Somali: Somali,
  	"Songhai languages": {
  	name: "Songhai languages",
  	names: [
  		"Songhai languages"
  	],
  	"iso639-2": "son",
  	"iso639-1": null
  },
  	Soninke: Soninke,
  	"Sorbian languages": {
  	name: "Sorbian languages",
  	names: [
  		"Sorbian languages"
  	],
  	"iso639-2": "wen",
  	"iso639-1": null
  },
  	"Sotho, Northern": {
  	name: "Sotho, Northern",
  	names: [
  		"Pedi",
  		"Sepedi",
  		"Northern Sotho"
  	],
  	"iso639-2": "nso",
  	"iso639-1": null
  },
  	"Sotho, Southern": {
  	name: "Sotho, Southern",
  	names: [
  		"Sotho, Southern"
  	],
  	"iso639-2": "sot",
  	"iso639-1": "st"
  },
  	"South American Indian languages": {
  	name: "South American Indian languages",
  	names: [
  		"South American Indian languages"
  	],
  	"iso639-2": "sai",
  	"iso639-1": null
  },
  	"South Ndebele": {
  	name: "South Ndebele",
  	names: [
  		"Ndebele, South",
  		"South Ndebele"
  	],
  	"iso639-2": "nbl",
  	"iso639-1": "nr"
  },
  	"Southern Altai": {
  	name: "Southern Altai",
  	names: [
  		"Southern Altai"
  	],
  	"iso639-2": "alt",
  	"iso639-1": null
  },
  	"Southern Sami": {
  	name: "Southern Sami",
  	names: [
  		"Southern Sami"
  	],
  	"iso639-2": "sma",
  	"iso639-1": null
  },
  	Spanish: Spanish,
  	"Sranan Tongo": {
  	name: "Sranan Tongo",
  	names: [
  		"Sranan Tongo"
  	],
  	"iso639-2": "srn",
  	"iso639-1": null
  },
  	"Standard Moroccan Tamazight": {
  	name: "Standard Moroccan Tamazight",
  	names: [
  		"Standard Moroccan Tamazight"
  	],
  	"iso639-2": "zgh",
  	"iso639-1": null
  },
  	Sukuma: Sukuma,
  	Sumerian: Sumerian,
  	Sundanese: Sundanese,
  	Susu: Susu,
  	Swahili: Swahili,
  	Swati: Swati,
  	Swedish: Swedish,
  	"Swiss German": {
  	name: "Swiss German",
  	names: [
  		"Swiss German",
  		"Alemannic",
  		"Alsatian"
  	],
  	"iso639-2": "gsw",
  	"iso639-1": null
  },
  	Syriac: Syriac,
  	Tagalog: Tagalog,
  	Tahitian: Tahitian,
  	"Tai languages": {
  	name: "Tai languages",
  	names: [
  		"Tai languages"
  	],
  	"iso639-2": "tai",
  	"iso639-1": null
  },
  	Tajik: Tajik,
  	Tamashek: Tamashek,
  	Tamil: Tamil,
  	Tatar: Tatar,
  	Telugu: Telugu,
  	Tereno: Tereno,
  	Tetum: Tetum,
  	Thai: Thai,
  	Tibetan: Tibetan,
  	Tigre: Tigre,
  	Tigrinya: Tigrinya,
  	Timne: Timne,
  	Tiv: Tiv,
  	"tlhIngan-Hol": {
  	name: "tlhIngan-Hol",
  	names: [
  		"Klingon",
  		"tlhIngan-Hol"
  	],
  	"iso639-2": "tlh",
  	"iso639-1": null
  },
  	Tlingit: Tlingit,
  	"Tok Pisin": {
  	name: "Tok Pisin",
  	names: [
  		"Tok Pisin"
  	],
  	"iso639-2": "tpi",
  	"iso639-1": null
  },
  	Tokelau: Tokelau,
  	"Tonga (Nyasa)": {
  	name: "Tonga (Nyasa)",
  	names: [
  		"Tonga (Nyasa)"
  	],
  	"iso639-2": "tog",
  	"iso639-1": null
  },
  	"Tonga (Tonga Islands)": {
  	name: "Tonga (Tonga Islands)",
  	names: [
  		"Tonga (Tonga Islands)"
  	],
  	"iso639-2": "ton",
  	"iso639-1": "to"
  },
  	Tsimshian: Tsimshian,
  	Tsonga: Tsonga,
  	Tswana: Tswana,
  	Tumbuka: Tumbuka,
  	"Tupi languages": {
  	name: "Tupi languages",
  	names: [
  		"Tupi languages"
  	],
  	"iso639-2": "tup",
  	"iso639-1": null
  },
  	Turkish: Turkish,
  	"Turkish, Ottoman (1500-1928)": {
  	name: "Turkish, Ottoman (1500-1928)",
  	names: [
  		"Turkish, Ottoman (1500-1928)"
  	],
  	"iso639-2": "ota",
  	"iso639-1": null
  },
  	Turkmen: Turkmen,
  	Tuvalu: Tuvalu,
  	Tuvinian: Tuvinian,
  	Twi: Twi,
  	Udmurt: Udmurt,
  	Ugaritic: Ugaritic,
  	Uighur: Uighur,
  	Ukrainian: Ukrainian,
  	Umbundu: Umbundu,
  	"Uncoded languages": {
  	name: "Uncoded languages",
  	names: [
  		"Uncoded languages"
  	],
  	"iso639-2": "mis",
  	"iso639-1": null
  },
  	Undetermined: Undetermined,
  	"Upper Sorbian": {
  	name: "Upper Sorbian",
  	names: [
  		"Upper Sorbian"
  	],
  	"iso639-2": "hsb",
  	"iso639-1": null
  },
  	Urdu: Urdu,
  	Uyghur: Uyghur,
  	Uzbek: Uzbek,
  	Vai: Vai,
  	Valencian: Valencian,
  	Venda: Venda,
  	Vietnamese: Vietnamese,
  	"Volapk": {
  	name: "Volapk",
  	names: [
  		"Volapk"
  	],
  	"iso639-2": "vol",
  	"iso639-1": "vo"
  },
  	Votic: Votic,
  	"Wakashan languages": {
  	name: "Wakashan languages",
  	names: [
  		"Wakashan languages"
  	],
  	"iso639-2": "wak",
  	"iso639-1": null
  },
  	Walloon: Walloon,
  	Waray: Waray,
  	Washo: Washo,
  	Welsh: Welsh,
  	"Western Frisian": {
  	name: "Western Frisian",
  	names: [
  		"Western Frisian"
  	],
  	"iso639-2": "fry",
  	"iso639-1": "fy"
  },
  	"Western Pahari languages": {
  	name: "Western Pahari languages",
  	names: [
  		"Himachali languages",
  		"Western Pahari languages"
  	],
  	"iso639-2": "him",
  	"iso639-1": null
  },
  	Wolaitta: Wolaitta,
  	Wolaytta: Wolaytta,
  	Wolof: Wolof,
  	Xhosa: Xhosa,
  	Yakut: Yakut,
  	Yao: Yao,
  	Yapese: Yapese,
  	Yiddish: Yiddish,
  	Yoruba: Yoruba,
  	"Yupik languages": {
  	name: "Yupik languages",
  	names: [
  		"Yupik languages"
  	],
  	"iso639-2": "ypk",
  	"iso639-1": null
  },
  	"Zande languages": {
  	name: "Zande languages",
  	names: [
  		"Zande languages"
  	],
  	"iso639-2": "znd",
  	"iso639-1": null
  },
  	Zapotec: Zapotec,
  	Zaza: Zaza,
  	Zazaki: Zazaki,
  	Zenaga: Zenaga,
  	Zhuang: Zhuang,
  	Zulu: Zulu,
  	Zuni: Zuni
  };

  function _defineProperty$1(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }
  var locales = [];
  var isoKeys = Object.keys(iso);
  Object.keys(lcid).map(function (id) {
    var locale = lcid[id];
    var isoLanguage = isoKeys.find(function (name) {
      return name.toLowerCase() === locale.language.toLowerCase();
    });

    if (locale.location && isoLanguage) {
      var _locales$push;

      locales.push((_locales$push = {}, _defineProperty$1(_locales$push, "name", locale.language), _defineProperty$1(_locales$push, "location", locale.location), _defineProperty$1(_locales$push, "tag", locale.tag), _defineProperty$1(_locales$push, "lcid", locale.id), _defineProperty$1(_locales$push, "iso639-2", iso[isoLanguage]["iso639-2"]), _defineProperty$1(_locales$push, "iso639-1", iso[isoLanguage]["iso639-1"]), _locales$push));
    }
  });
  var defaultLocales = {
    ar: "ar-SA",
    ca: "ca-ES",
    da: "da-DK",
    en: "en-US",
    ko: "ko-KR",
    pa: "pa-IN",
    pt: "pt-BR",
    sv: "sv-SE"
  };
  /**
   * Converts a 2-digit language into a full language-LOCATION locale.
   * @param {String} locale
   */

  function findLocale (locale) {
    if (typeof locale !== "string" || locale.length === 5) return locale;
    if (defaultLocales[locale]) return defaultLocales[locale];
    var list = locales.filter(function (d) {
      return d["iso639-1"] === locale;
    });
    if (!list.length) return locale;else if (list.length === 1) return list[0].tag;else if (list.find(function (d) {
      return d.tag === "".concat(locale, "-").concat(locale.toUpperCase());
    })) return "".concat(locale, "-").concat(locale.toUpperCase());else return list[0].tag;
  }

  /**
      @function s
      @desc Returns 4 random characters, used for constructing unique identifiers.
      @private
  */
  function s() {
    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
  }
  /**
      @function uuid
      @summary Returns a unique identifier.
  */


  function uuid () {
    return "".concat(s()).concat(s(), "-").concat(s(), "-").concat(s(), "-").concat(s(), "-").concat(s()).concat(s()).concat(s());
  }

  /**
      @constant RESET
      @desc String constant used to reset an individual config property.
  */
  var RESET = "D3PLUS-COMMON-RESET";

  var esES = {
    "and": "y",
    "Back": "Atrs",
    "Click to Expand": "Clic para Ampliar",
    "Click to Hide": "Clic para Ocultar",
    "Click to Highlight": "Clic para Resaltar",
    "Click to Reset": "Clic para Restablecer",
    "Download": "Descargar",
    "Loading Visualization": "Cargando Visualizacin",
    "No Data Available": "Datos No Disponibles",
    "Powered by D3plus": "Funciona con D3plus",
    "Share": "Porcentaje",
    "Shift+Click to Hide": "Mays+Clic para Ocultar",
    "Total": "Total",
    "Values": "Valores"
  };

  var dictionaries = {
    "es-ES": esES
  };

  function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties(Constructor, staticProps);
    return Constructor;
  }
  /**
      @desc Recursive function that resets nested Object configs.
      @param {Object} obj
      @param {Object} defaults
      @private
  */

  function nestedReset(obj, defaults) {
    if (isObject(obj)) {
      for (var nestedKey in obj) {
        if ({}.hasOwnProperty.call(obj, nestedKey) && !nestedKey.startsWith("_")) {
          var defaultValue = defaults && isObject(defaults) ? defaults[nestedKey] : undefined;

          if (obj[nestedKey] === RESET) {
            if (defaultValue) obj[nestedKey] = defaultValue;else delete obj[nestedKey];
          } else if (isObject(obj[nestedKey])) {
            nestedReset(obj[nestedKey], defaultValue);
          }
        }
      }
    }
  }
  /**
   * @desc finds all prototype methods of a class and it's parent classes
   * @param {*} obj
   * @private
   */


  function getAllMethods(obj) {
    var props = [];

    do {
      props = props.concat(Object.getOwnPropertyNames(obj));
      obj = Object.getPrototypeOf(obj);
    } while (obj && obj !== Object.prototype);

    return props.filter(function (e) {
      return e.indexOf("_") !== 0 && !["config", "constructor", "render"].includes(e);
    });
  }
  /**
      @class BaseClass
      @summary An abstract class that contains some global methods and functionality.
  */


  var BaseClass =
  /*#__PURE__*/
  function () {
    /**
        @memberof BaseClass
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */
    function BaseClass() {
      var _this = this;

      _classCallCheck(this, BaseClass);

      this._locale = "en-US";
      this._on = {};

      this._translate = function (d) {
        var locale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _this._locale;
        var dictionary = dictionaries[locale];
        return dictionary && dictionary[d] ? dictionary[d] : d;
      };

      this._uuid = uuid();
    }
    /**
        @memberof BaseClass
        @desc If *value* is specified, sets the methods that correspond to the key/value pairs and returns this class. If *value* is not specified, returns the current configuration.
        @param {Object} [*value*]
        @chainable
    */


    _createClass(BaseClass, [{
      key: "config",
      value: function config(_) {
        var _this2 = this;

        if (!this._configDefault) {
          var config = {};
          getAllMethods(this.__proto__).forEach(function (k) {
            var v = _this2[k]();

            config[k] = isObject(v) ? assign({}, v) : v;
          });
          this._configDefault = config;
        }

        if (arguments.length) {
          for (var k in _) {
            if ({}.hasOwnProperty.call(_, k) && k in this) {
              var v = _[k];

              if (v === RESET) {
                if (k === "on") this._on = this._configDefault[k];else this[k](this._configDefault[k]);
              } else {
                nestedReset(v, this._configDefault[k]);
                this[k](v);
              }
            }
          }

          return this;
        } else {
          var _config = {};
          getAllMethods(this.__proto__).forEach(function (k) {
            _config[k] = _this2[k]();
          });
          return _config;
        }
      }
      /**
          @memberof BaseClass
          @desc Sets the locale used for all text and number formatting. This method supports the locales defined in [d3plus-format](https://github.com/d3plus/d3plus-format/blob/master/src/locale.js). The locale can be defined as a complex Object (like in d3plus-format), a locale code (like "en-US"), or a 2-digit language code (like "en"). If a 2-digit code is provided, the "findLocale" function is used to identify the most approximate locale from d3plus-format.
          @param {Object|String} [*value* = "en-US"]
          @chainable
          @example
          {
            separator: "",
            suffixes: ["y", "z", "a", "f", "p", "n", "", "m", "", "k", "M", "B", "t", "q", "Q", "Z", "Y"],
            grouping: [3],
            delimiters: {
              thousands: ",",
              decimal: "."
            },
            currency: ["$", ""]
          }
      */

    }, {
      key: "locale",
      value: function locale(_) {
        return arguments.length ? (this._locale = findLocale(_), this) : this._locale;
      }
      /**
          @memberof BaseClass
          @desc Adds or removes a *listener* to each object for the specified event *typenames*. If a *listener* is not specified, returns the currently assigned listener for the specified event *typename*. Mirrors the core [d3-selection](https://github.com/d3/d3-selection#selection_on) behavior.
          @param {String} [*typenames*]
          @param {Function} [*listener*]
          @chainable
          @example <caption>By default, listeners apply globally to all objects, however, passing a namespace with the class name gives control over specific elements:</caption>
      new Plot
      .on("click.Shape", function(d) {
        console.log("data for shape clicked:", d);
      })
      .on("click.Legend", function(d) {
        console.log("data for legend clicked:", d);
      })
      */

    }, {
      key: "on",
      value: function on(_, f) {
        return arguments.length === 2 ? (this._on[_] = f, this) : arguments.length ? typeof _ === "string" ? this._on[_] : (this._on = Object.assign({}, this._on, _), this) : this._on;
      }
      /**
          @memberof BaseClass
          @desc Defines how informational text strings should be displayed. By default, this function will try to find the string in question (which is the first argument provided to this function) inside of an internally managed translation Object. If you'd like to override to use custom text, simply pass this method your own custom formatting function.
          @param {Function} [*value*]
          @chainable
          @example <caption>For example, if we wanted to only change the string "Back" and allow all other string to return in English:</caption>
      .translate(function(d) {
      return d === "Back" ? "Get outta here" : d;
      })
      */

    }, {
      key: "translate",
      value: function translate(_) {
        return arguments.length ? (this._translate = _, this) : this._translate;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for each shape and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "shapeConfig",
      value: function shapeConfig(_) {
        return arguments.length ? (this._shapeConfig = assign(this._shapeConfig, _), this) : this._shapeConfig;
      }
    }]);

    return BaseClass;
  }();

  /**
      @function closest
      @desc Finds the closest numeric value in an array.
      @param {Number} n The number value to use when searching the array.
      @param {Array} arr The array of values to test against.
  */
  function closest (n) {
    var arr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    if (!arr || !(arr instanceof Array) || !arr.length) return undefined;
    return arr.reduce(function (prev, curr) {
      return Math.abs(curr - n) < Math.abs(prev - n) ? curr : prev;
    });
  }

  function _typeof$2(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$2 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$2 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$2(obj);
  }
  /**
      @function configPrep
      @desc Preps a config object for d3plus data, and optionally bubbles up a specific nested type. When using this function, you must bind a d3plus class' `this` context.
      @param {Object} [config = this._shapeConfig] The configuration object to parse.
      @param {String} [type = "shape"] The event classifier to user for "on" events. For example, the default event type of "shape" will apply all events in the "on" config object with that key, like "click.shape" and "mouseleave.shape", in addition to any gloval events like "click" and "mouseleave".
      @param {String} [nest] An optional nested key to bubble up to the parent config level.
  */


  function configPrep() {
    var _this = this;

    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._shapeConfig;
    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "shape";
    var nest = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var newConfig = {
      duration: this._duration,
      on: {}
    };

    var wrapFunction = function wrapFunction(func) {
      return function (d, i, s) {
        var parent;

        while (d.__d3plus__) {
          if (parent) d.__d3plusParent__ = parent;
          parent = d;
          i = d.i;
          d = d.data || d.feature;
        }

        return func.bind(_this)(d, i, s || parent);
      };
    };

    var parseEvents = function parseEvents(newObj, on) {
      for (var event in on) {
        if ({}.hasOwnProperty.call(on, event) && !event.includes(".") || event.includes(".".concat(type))) {
          newObj.on[event] = wrapFunction(on[event]);
        }
      }
    };

    var arrayEval = function arrayEval(arr) {
      return arr.map(function (d) {
        if (d instanceof Array) return arrayEval(d);else if (_typeof$2(d) === "object") return keyEval({}, d);else if (typeof d === "function") return wrapFunction(d);else return d;
      });
    };

    var keyEval = function keyEval(newObj, obj) {
      for (var key in obj) {
        if ({}.hasOwnProperty.call(obj, key)) {
          if (key === "on") parseEvents(newObj, obj[key]);else if (typeof obj[key] === "function") {
            newObj[key] = wrapFunction(obj[key]);
          } else if (obj[key] instanceof Array) {
            newObj[key] = arrayEval(obj[key]);
          } else if (_typeof$2(obj[key]) === "object") {
            newObj[key] = {
              on: {}
            };
            keyEval(newObj[key], obj[key]);
          } else newObj[key] = obj[key];
        }
      }
    };

    keyEval(newConfig, config);
    if (this._on) parseEvents(newConfig, this._on);

    if (nest && config[nest]) {
      keyEval(newConfig, config[nest]);
      if (config[nest].on) parseEvents(newConfig, config[nest].on);
    }

    return newConfig;
  }

  /**
      @function constant
      @desc Wraps non-function variables in a simple return function.
      @param {Array|Number|Object|String} value The value to be returned from the function.
      @example <caption>this</caption>
  constant(42);
      @example <caption>returns this</caption>
  function() {
    return 42;
  }
  */
  function constant$3 (value) {
    return function constant() {
      return value;
    };
  }

  /**
      @function elem
      @desc Manages the enter/update/exit pattern for a single DOM element.
      @param {String} selector A D3 selector, which must include the tagname and a class and/or ID.
      @param {Object} params Additional parameters.
      @param {Boolean} [params.condition = true] Whether or not the element should be rendered (or removed).
      @param {Object} [params.enter = {}] A collection of key/value pairs that map to attributes to be given on enter.
      @param {Object} [params.exit = {}] A collection of key/value pairs that map to attributes to be given on exit.
      @param {D3Selection} [params.parent = d3.select("body")] The parent element for this new element to be appended to.
      @param {D3Transition} [params.transition = d3.transition().duration(0)] The transition to use when animated the different life cycle stages.
      @param {Object} [params.update = {}] A collection of key/value pairs that map to attributes to be given on update.
  */

  function elem (selector, p) {
    // overrides default params
    p = Object.assign({}, {
      condition: true,
      enter: {},
      exit: {},
      parent: _select("body"),
      transition: transition().duration(0),
      update: {}
    }, p);
    var className = /\.([^#]+)/g.exec(selector),
        id = /#([^\.]+)/g.exec(selector),
        tag = /^([^.^#]+)/g.exec(selector)[1];
    var elem = p.parent.selectAll(selector.includes(":") ? selector.split(":")[1] : selector).data(p.condition ? [null] : []);
    var enter = elem.enter().append(tag).call(attrize, p.enter);
    if (id) enter.attr("id", id[1]);
    if (className) enter.attr("class", className[1]);
    elem.exit().transition(p.transition).call(attrize, p.exit).remove();
    var update = enter.merge(elem);
    update.transition(p.transition).call(attrize, p.update);
    return update;
  }

  /**
      @function unique
      @desc ES5 implementation to reduce an Array of values to unique instances.
      @param {Array} objects The Array of objects to be filtered.
      @example <caption>this</caption>
  unique(["apple", "banana", "apple"]);
      @example <caption>returns this</caption>
  ["apple", "banana"]
  */
  function unique (arr) {
    return arr.filter(function (k, i, a) {
      return a.indexOf(k) === i;
    });
  }

  /**
      @function merge
      @desc Combines an Array of Objects together and returns a new Object.
      @param {Array} objects The Array of objects to be merged together.
      @param {Object} aggs An object containing specific aggregation methods (functions) for each key type. By default, numbers are summed and strings are returned as an array of unique values.
      @example <caption>this</caption>
  merge([
    {id: "foo", group: "A", value: 10, links: [1, 2]},
    {id: "bar", group: "A", value: 20, links: [1, 3]}
  ]);
      @example <caption>returns this</caption>
  {id: ["bar", "foo"], group: "A", value: 30, links: [1, 2, 3]}
  */

  function objectMerge(objects) {
    var aggs = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var availableKeys = unique(merge(objects.map(function (o) {
      return keys(o);
    }))),
        newObject = {};
    availableKeys.forEach(function (k) {
      var values = objects.map(function (o) {
        return o[k];
      });
      var value;
      if (aggs[k]) value = aggs[k](values);else {
        var types = values.map(function (v) {
          return v || v === false ? v.constructor : v;
        }).filter(function (v) {
          return v !== void 0;
        });
        if (!types.length) value = undefined;else if (types.indexOf(Array) >= 0) {
          value = merge(values.map(function (v) {
            return v instanceof Array ? v : [v];
          }));
          value = unique(value);
          if (value.length === 1) value = value[0];
        } else if (types.indexOf(String) >= 0) {
          value = unique(values);
          if (value.length === 1) value = value[0];
        } else if (types.indexOf(Number) >= 0) value = sum(values);else if (types.indexOf(Object) >= 0) {
          value = unique(values.filter(function (v) {
            return v;
          }));
          if (value.length === 1) value = value[0];else value = objectMerge(value);
        } else {
          value = unique(values.filter(function (v) {
            return v !== void 0;
          }));
          if (value.length === 1) value = value[0];
        }
      }
      newObject[k] = value;
    });
    return newObject;
  }

  /**
   @function parseSides
   @desc Converts a string of directional CSS shorthand values into an object with the values expanded.
   @param {String|Number} sides The CSS shorthand string to expand.
   */
  function parseSides (sides) {
    var values;
    if (typeof sides === "number") values = [sides];else values = sides.split(/\s+/);
    if (values.length === 1) values = [values[0], values[0], values[0], values[0]];else if (values.length === 2) values = values.concat(values);else if (values.length === 3) values.push(values[1]);
    return ["top", "right", "bottom", "left"].reduce(function (acc, direction, i) {
      var value = parseFloat(values[i]);
      acc[direction] = value || 0;
      return acc;
    }, {});
  }

  /**
      @function prefix
      @desc Returns the appropriate CSS vendor prefix, given the current browser.
  */
  function prefix$1 () {
    if ("-webkit-transform" in document.body.style) return "-webkit-";else if ("-moz-transform" in document.body.style) return "-moz-";else if ("-ms-transform" in document.body.style) return "-ms-";else if ("-o-transform" in document.body.style) return "-o-";else return "";
  }

  /**
      @function stylize
      @desc Applies each key/value in an object as a style.
      @param {D3selection} elem The D3 element to apply the styles to.
      @param {Object} styles An object of key/value style pairs.
  */
  function stylize (e) {
    var s = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    for (var k in s) {
      if ({}.hasOwnProperty.call(s, k)) e.style(k, s[k]);
    }
  }

  /**
      @namespace {Object} formatLocale
      @desc A set of default locale formatters used when assigning suffixes and currency in numbers.
        *
        * | Name | Default | Description |
        * |---|---|---|
        * | separator | "" | Separation between the number with the suffix. |
        * | suffixes | [] | List of suffixes used to format numbers. |
        * | grouping | [3] | The array of group sizes, |
        * | delimiters | {thousands: ",", decimal: "."} | Decimal and group separators. |
        * | currency | ["$", ""] | The currency prefix and suffix. |
  */
  var formatLocale$2 = {
    "en-GB": {
      separator: "",
      suffixes: ["y", "z", "a", "f", "p", "n", "", "m", "", "k", "M", "B", "t", "q", "Q", "Z", "Y"],
      grouping: [3],
      delimiters: {
        thousands: ",",
        decimal: "."
      },
      currency: ["", ""]
    },
    "en-US": {
      separator: "",
      suffixes: ["y", "z", "a", "f", "p", "n", "", "m", "", "k", "M", "B", "t", "q", "Q", "Z", "Y"],
      grouping: [3],
      delimiters: {
        thousands: ",",
        decimal: "."
      },
      currency: ["$", ""]
    },
    "es-CL": {
      separator: "",
      suffixes: ["y", "z", "a", "f", "p", "n", "", "m", "", "k", "M", "MM", "B", "T", "Q", "Z", "Y"],
      grouping: [3],
      delimiters: {
        thousands: ".",
        decimal: ","
      },
      currency: ["$", ""]
    },
    "es-MX": {
      separator: "",
      suffixes: ["y", "z", "a", "f", "p", "n", "", "m", "", "k", "M", "MM", "B", "T", "Q", "Z", "Y"],
      grouping: [3],
      delimiters: {
        thousands: ",",
        decimal: "."
      },
      currency: ["$", ""]
    },
    "es-ES": {
      separator: "",
      suffixes: ["y", "z", "a", "f", "p", "n", "", "m", "", "k", "mm", "b", "t", "q", "Q", "Z", "Y"],
      grouping: [3],
      delimiters: {
        thousands: ".",
        decimal: ","
      },
      currency: ["", ""]
    },
    "et-EE": {
      separator: " ",
      suffixes: ["y", "z", "a", "f", "p", "n", "", "m", "", "tuhat", "miljonit", "miljardit", "triljonit", "q", "Q", "Z", "Y"],
      grouping: [3],
      delimiters: {
        thousands: " ",
        decimal: ","
      },
      currency: ["", "eurot"]
    },
    "fr-FR": {
      suffixes: ["y", "z", "a", "f", "p", "n", "", "m", "", "k", "m", "b", "t", "q", "Q", "Z", "Y"],
      grouping: [3],
      delimiters: {
        thousands: " ",
        decimal: ","
      },
      currency: ["", ""]
    }
  };

  function _typeof$3(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$3 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$3 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$3(obj);
  }

  var round = function round(x, n) {
    return parseFloat(Math.round(x * Math.pow(10, n)) / Math.pow(10, n)).toFixed(n);
  };
  /**
   * @private
  */


  function formatSuffix(value, precision, suffixes) {
    var i = 0;

    if (value) {
      if (value < 0) value *= -1;
      i = 1 + Math.floor(1e-12 + Math.log(value) / Math.LN10);
      i = Math.max(-24, Math.min(24, Math.floor((i - 1) / 3) * 3));
    }

    var d = suffixes[8 + i / 3];
    return {
      number: round(d.scale(value), precision),
      symbol: d.symbol
    };
  }
  /**
   * @private
  */


  function parseSuffixes(d, i) {
    var k = Math.pow(10, Math.abs(8 - i) * 3);
    return {
      scale: i > 8 ? function (d) {
        return d / k;
      } : function (d) {
        return d * k;
      },
      symbol: d
    };
  }
  /**
      @function formatAbbreviate
      @desc Formats a number to an appropriate number of decimal places and rounding, adding suffixes if applicable (ie. `1200000` to `"1.2M"`).
      @param {Number|String} n The number to be formatted.
      @param {Object|String} locale The locale config to be used. If *value* is an object, the function will format the numbers according the object. The object must include `suffixes`, `delimiter` and `currency` properties.
      @returns {String}
  */


  function formatAbbreviate (n) {
    var locale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "en-US";
    var precision = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;
    if (isFinite(n)) n *= 1;else return "N/A";
    var negative = n < 0;
    var length = n.toString().split(".")[0].replace("-", "").length,
        localeConfig = _typeof$3(locale) === "object" ? locale : formatLocale$2[locale] || formatLocale$2["en-US"],
        suffixes = localeConfig.suffixes.map(parseSuffixes);
    var decimal = localeConfig.delimiters.decimal || ".",
        separator = localeConfig.separator || "",
        thousands = localeConfig.delimiters.thousands || ",";
    var d3plusFormatLocale = formatLocale$1({
      currency: localeConfig.currency || ["$", ""],
      decimal: decimal,
      grouping: localeConfig.grouping || [3],
      thousands: thousands
    });
    var val;
    if (precision) val = d3plusFormatLocale.format(precision)(n);else if (n === 0) val = "0";else if (length >= 3) {
      var f = formatSuffix(d3plusFormatLocale.format(".3r")(n), 2, suffixes);
      var num = parseFloat(f.number).toString().replace(".", decimal);
      var _char = f.symbol;
      val = "".concat(num).concat(separator).concat(_char);
    } else if (length === 3) val = d3plusFormatLocale.format(",f")(n);else if (n < 1 && n > -1) val = d3plusFormatLocale.format(".2g")(n);else val = d3plusFormatLocale.format(".3g")(n);
    return "".concat(negative && val.charAt(0) !== "-" ? "-" : "").concat(val).replace(/(\.[1-9]*)[0]*$/g, "$1") // removes any trailing zeros
    .replace(/[.]$/g, ""); // removes any trailing decimal point
  }

  function _classCallCheck$1(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$1(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$1(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$1(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$1(Constructor, staticProps);
    return Constructor;
  }
  /**
      @class Image
      @desc Creates SVG images based on an array of data.
      @example <caption>a sample row of data</caption>
  var data = {"url": "file.png", "width": "100", "height": "50"};
  @example <caption>passed to the generator</caption>
  new Image().data([data]).render();
  @example <caption>creates the following</caption>
  <image class="d3plus-Image" opacity="1" href="file.png" width="100" height="50" x="0" y="0"></image>
  @example <caption>this is shorthand for the following</caption>
  image().data([data])();
  @example <caption>which also allows a post-draw callback function</caption>
  image().data([data])(function() { alert("draw complete!"); })
  */

  var Image$1 =
  /*#__PURE__*/
  function () {
    /**
        @memberof Image
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */
    function Image() {
      _classCallCheck$1(this, Image);

      this._duration = 600;
      this._height = accessor("height");
      this._id = accessor("id");
      this._opacity = constant$3(1);
      this._pointerEvents = constant$3("auto");
      this._select;
      this._url = accessor("url");
      this._width = accessor("width");
      this._x = accessor("x", 0);
      this._y = accessor("y", 0);
    }
    /**
        @memberof Image
        @desc Renders the current Image to the page. If a *callback* is specified, it will be called once the images are done drawing.
        @param {Function} [*callback*]
        @chainable
    */


    _createClass$1(Image, [{
      key: "render",
      value: function render(callback) {
        var _this = this;

        if (this._select === void 0) this.select(_select("body").append("svg").style("width", "".concat(window.innerWidth, "px")).style("height", "".concat(window.innerHeight, "px")).style("display", "block").node());

        var images = this._select.selectAll(".d3plus-Image").data(this._data, this._id);

        var enter = images.enter().append("image").attr("class", "d3plus-Image").attr("opacity", 0).attr("width", 0).attr("height", 0).attr("x", function (d, i) {
          return _this._x(d, i) + _this._width(d, i) / 2;
        }).attr("y", function (d, i) {
          return _this._y(d, i) + _this._height(d, i) / 2;
        });
        var t = transition().duration(this._duration),
            that = this,
            update = enter.merge(images);
        update.attr("xlink:href", this._url).style("pointer-events", this._pointerEvents).transition(t).attr("opacity", this._opacity).attr("width", function (d, i) {
          return _this._width(d, i);
        }).attr("height", function (d, i) {
          return _this._height(d, i);
        }).attr("x", function (d, i) {
          return _this._x(d, i);
        }).attr("y", function (d, i) {
          return _this._y(d, i);
        }).each(function (d, i) {
          var image = _select(this),
              link = that._url(d, i);

          var fullAddress = link.indexOf("http://") === 0 || link.indexOf("https://") === 0;

          if (!fullAddress || link.indexOf(window.location.hostname) === 0) {
            var img = new Image();
            img.src = link;
            img.crossOrigin = "Anonymous";

            img.onload = function () {
              var canvas = document.createElement("canvas");
              canvas.width = this.width;
              canvas.height = this.height;
              var context = canvas.getContext("2d");
              context.drawImage(this, 0, 0);
              image.attr("xlink:href", canvas.toDataURL("image/png"));
            };
          }
        });
        images.exit().transition(t).attr("width", function (d, i) {
          return _this._width(d, i);
        }).attr("height", function (d, i) {
          return _this._height(d, i);
        }).attr("x", function (d, i) {
          return _this._x(d, i);
        }).attr("y", function (d, i) {
          return _this._y(d, i);
        }).attr("opacity", 0).remove();
        if (callback) setTimeout(callback, this._duration + 100);
        return this;
      }
      /**
          @memberof Image
          @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array. An <image> tag will be drawn for each object in the array.
          @param {Array} [*data* = []]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof Image
          @desc If *ms* is specified, sets the animation duration to the specified number and returns the current class instance. If *ms* is not specified, returns the current animation duration.
          @param {Number} [*ms* = 600]
          @chainable
      */

    }, {
      key: "duration",
      value: function duration(_) {
        return arguments.length ? (this._duration = _, this) : this._duration;
      }
      /**
          @memberof Image
          @desc If *value* is specified, sets the height accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.height;
      }
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = typeof _ === "function" ? _ : constant$3(_), this) : this._height;
      }
      /**
          @memberof Image
          @desc If *value* is specified, sets the id accessor to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
          @example
      function(d) {
      return d.id;
      }
      */

    }, {
      key: "id",
      value: function id(_) {
        return arguments.length ? (this._id = _, this) : this._id;
      }
      /**
          @memberof Image
          @desc Sets the opacity of the image.
          @param {Number} [*value* = 1]
          @chainable
      */

    }, {
      key: "opacity",
      value: function opacity(_) {
        return arguments.length ? (this._opacity = typeof _ === "function" ? _ : constant$3(_), this) : this._opacity;
      }
      /**
          @memberof Image
          @desc If *value* is specified, sets the pointer-events accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value* = "auto"]
          @chainable
      */

    }, {
      key: "pointerEvents",
      value: function pointerEvents(_) {
        return arguments.length ? (this._pointerEvents = typeof _ === "function" ? _ : constant$3(_), this) : this._pointerEvents;
      }
      /**
          @memberof Image
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.
          @param {String|HTMLElement} [*selector* = d3.select("body").append("svg")]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
          @memberof Image
          @desc If *value* is specified, sets the URL accessor to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
          @example
      function(d) {
      return d.url;
      }
      */

    }, {
      key: "url",
      value: function url(_) {
        return arguments.length ? (this._url = _, this) : this._url;
      }
      /**
          @memberof Image
          @desc If *value* is specified, sets the width accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.width;
      }
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = typeof _ === "function" ? _ : constant$3(_), this) : this._width;
      }
      /**
          @memberof Image
          @desc If *value* is specified, sets the x accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.x || 0;
      }
      */

    }, {
      key: "x",
      value: function x(_) {
        return arguments.length ? (this._x = typeof _ === "function" ? _ : constant$3(_), this) : this._x;
      }
      /**
          @memberof Image
          @desc If *value* is specified, sets the y accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.y || 0;
      }
      */

    }, {
      key: "y",
      value: function y(_) {
        return arguments.length ? (this._y = typeof _ === "function" ? _ : constant$3(_), this) : this._y;
      }
    }]);

    return Image;
  }();

  function define$1 (constructor, factory, prototype) {
    constructor.prototype = factory.prototype = prototype;
    prototype.constructor = constructor;
  }
  function extend$1(parent, definition) {
    var prototype = Object.create(parent.prototype);

    for (var key in definition) {
      prototype[key] = definition[key];
    }

    return prototype;
  }

  function Color$1() {}
  var _darker$1 = 0.7;

  var _brighter$1 = 1 / _darker$1;
  var reI$1 = "\\s*([+-]?\\d+)\\s*",
      reN$1 = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",
      reP$1 = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",
      reHex = /^#([0-9a-f]{3,8})$/,
      reRgbInteger$1 = new RegExp("^rgb\\(" + [reI$1, reI$1, reI$1] + "\\)$"),
      reRgbPercent$1 = new RegExp("^rgb\\(" + [reP$1, reP$1, reP$1] + "\\)$"),
      reRgbaInteger$1 = new RegExp("^rgba\\(" + [reI$1, reI$1, reI$1, reN$1] + "\\)$"),
      reRgbaPercent$1 = new RegExp("^rgba\\(" + [reP$1, reP$1, reP$1, reN$1] + "\\)$"),
      reHslPercent$1 = new RegExp("^hsl\\(" + [reN$1, reP$1, reP$1] + "\\)$"),
      reHslaPercent$1 = new RegExp("^hsla\\(" + [reN$1, reP$1, reP$1, reN$1] + "\\)$");
  var named$1 = {
    aliceblue: 0xf0f8ff,
    antiquewhite: 0xfaebd7,
    aqua: 0x00ffff,
    aquamarine: 0x7fffd4,
    azure: 0xf0ffff,
    beige: 0xf5f5dc,
    bisque: 0xffe4c4,
    black: 0x000000,
    blanchedalmond: 0xffebcd,
    blue: 0x0000ff,
    blueviolet: 0x8a2be2,
    brown: 0xa52a2a,
    burlywood: 0xdeb887,
    cadetblue: 0x5f9ea0,
    chartreuse: 0x7fff00,
    chocolate: 0xd2691e,
    coral: 0xff7f50,
    cornflowerblue: 0x6495ed,
    cornsilk: 0xfff8dc,
    crimson: 0xdc143c,
    cyan: 0x00ffff,
    darkblue: 0x00008b,
    darkcyan: 0x008b8b,
    darkgoldenrod: 0xb8860b,
    darkgray: 0xa9a9a9,
    darkgreen: 0x006400,
    darkgrey: 0xa9a9a9,
    darkkhaki: 0xbdb76b,
    darkmagenta: 0x8b008b,
    darkolivegreen: 0x556b2f,
    darkorange: 0xff8c00,
    darkorchid: 0x9932cc,
    darkred: 0x8b0000,
    darksalmon: 0xe9967a,
    darkseagreen: 0x8fbc8f,
    darkslateblue: 0x483d8b,
    darkslategray: 0x2f4f4f,
    darkslategrey: 0x2f4f4f,
    darkturquoise: 0x00ced1,
    darkviolet: 0x9400d3,
    deeppink: 0xff1493,
    deepskyblue: 0x00bfff,
    dimgray: 0x696969,
    dimgrey: 0x696969,
    dodgerblue: 0x1e90ff,
    firebrick: 0xb22222,
    floralwhite: 0xfffaf0,
    forestgreen: 0x228b22,
    fuchsia: 0xff00ff,
    gainsboro: 0xdcdcdc,
    ghostwhite: 0xf8f8ff,
    gold: 0xffd700,
    goldenrod: 0xdaa520,
    gray: 0x808080,
    green: 0x008000,
    greenyellow: 0xadff2f,
    grey: 0x808080,
    honeydew: 0xf0fff0,
    hotpink: 0xff69b4,
    indianred: 0xcd5c5c,
    indigo: 0x4b0082,
    ivory: 0xfffff0,
    khaki: 0xf0e68c,
    lavender: 0xe6e6fa,
    lavenderblush: 0xfff0f5,
    lawngreen: 0x7cfc00,
    lemonchiffon: 0xfffacd,
    lightblue: 0xadd8e6,
    lightcoral: 0xf08080,
    lightcyan: 0xe0ffff,
    lightgoldenrodyellow: 0xfafad2,
    lightgray: 0xd3d3d3,
    lightgreen: 0x90ee90,
    lightgrey: 0xd3d3d3,
    lightpink: 0xffb6c1,
    lightsalmon: 0xffa07a,
    lightseagreen: 0x20b2aa,
    lightskyblue: 0x87cefa,
    lightslategray: 0x778899,
    lightslategrey: 0x778899,
    lightsteelblue: 0xb0c4de,
    lightyellow: 0xffffe0,
    lime: 0x00ff00,
    limegreen: 0x32cd32,
    linen: 0xfaf0e6,
    magenta: 0xff00ff,
    maroon: 0x800000,
    mediumaquamarine: 0x66cdaa,
    mediumblue: 0x0000cd,
    mediumorchid: 0xba55d3,
    mediumpurple: 0x9370db,
    mediumseagreen: 0x3cb371,
    mediumslateblue: 0x7b68ee,
    mediumspringgreen: 0x00fa9a,
    mediumturquoise: 0x48d1cc,
    mediumvioletred: 0xc71585,
    midnightblue: 0x191970,
    mintcream: 0xf5fffa,
    mistyrose: 0xffe4e1,
    moccasin: 0xffe4b5,
    navajowhite: 0xffdead,
    navy: 0x000080,
    oldlace: 0xfdf5e6,
    olive: 0x808000,
    olivedrab: 0x6b8e23,
    orange: 0xffa500,
    orangered: 0xff4500,
    orchid: 0xda70d6,
    palegoldenrod: 0xeee8aa,
    palegreen: 0x98fb98,
    paleturquoise: 0xafeeee,
    palevioletred: 0xdb7093,
    papayawhip: 0xffefd5,
    peachpuff: 0xffdab9,
    peru: 0xcd853f,
    pink: 0xffc0cb,
    plum: 0xdda0dd,
    powderblue: 0xb0e0e6,
    purple: 0x800080,
    rebeccapurple: 0x663399,
    red: 0xff0000,
    rosybrown: 0xbc8f8f,
    royalblue: 0x4169e1,
    saddlebrown: 0x8b4513,
    salmon: 0xfa8072,
    sandybrown: 0xf4a460,
    seagreen: 0x2e8b57,
    seashell: 0xfff5ee,
    sienna: 0xa0522d,
    silver: 0xc0c0c0,
    skyblue: 0x87ceeb,
    slateblue: 0x6a5acd,
    slategray: 0x708090,
    slategrey: 0x708090,
    snow: 0xfffafa,
    springgreen: 0x00ff7f,
    steelblue: 0x4682b4,
    tan: 0xd2b48c,
    teal: 0x008080,
    thistle: 0xd8bfd8,
    tomato: 0xff6347,
    turquoise: 0x40e0d0,
    violet: 0xee82ee,
    wheat: 0xf5deb3,
    white: 0xffffff,
    whitesmoke: 0xf5f5f5,
    yellow: 0xffff00,
    yellowgreen: 0x9acd32
  };
  define$1(Color$1, color$1, {
    copy: function copy(channels) {
      return Object.assign(new this.constructor(), this, channels);
    },
    displayable: function displayable() {
      return this.rgb().displayable();
    },
    hex: color_formatHex,
    // Deprecated! Use color.formatHex.
    formatHex: color_formatHex,
    formatHsl: color_formatHsl,
    formatRgb: color_formatRgb,
    toString: color_formatRgb
  });

  function color_formatHex() {
    return this.rgb().formatHex();
  }

  function color_formatHsl() {
    return hslConvert$1(this).formatHsl();
  }

  function color_formatRgb() {
    return this.rgb().formatRgb();
  }

  function color$1(format) {
    var m, l;
    format = (format + "").trim().toLowerCase();
    return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn$1(m) // #ff0000
    : l === 3 ? new Rgb$1(m >> 8 & 0xf | m >> 4 & 0xf0, m >> 4 & 0xf | m & 0xf0, (m & 0xf) << 4 | m & 0xf, 1) // #f00
    : l === 8 ? new Rgb$1(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000
    : l === 4 ? new Rgb$1(m >> 12 & 0xf | m >> 8 & 0xf0, m >> 8 & 0xf | m >> 4 & 0xf0, m >> 4 & 0xf | m & 0xf0, ((m & 0xf) << 4 | m & 0xf) / 0xff) // #f000
    : null // invalid hex
    ) : (m = reRgbInteger$1.exec(format)) ? new Rgb$1(m[1], m[2], m[3], 1) // rgb(255, 0, 0)
    : (m = reRgbPercent$1.exec(format)) ? new Rgb$1(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)
    : (m = reRgbaInteger$1.exec(format)) ? rgba$1(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)
    : (m = reRgbaPercent$1.exec(format)) ? rgba$1(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)
    : (m = reHslPercent$1.exec(format)) ? hsla$1(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)
    : (m = reHslaPercent$1.exec(format)) ? hsla$1(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)
    : named$1.hasOwnProperty(format) ? rgbn$1(named$1[format]) // eslint-disable-line no-prototype-builtins
    : format === "transparent" ? new Rgb$1(NaN, NaN, NaN, 0) : null;
  }

  function rgbn$1(n) {
    return new Rgb$1(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);
  }

  function rgba$1(r, g, b, a) {
    if (a <= 0) r = g = b = NaN;
    return new Rgb$1(r, g, b, a);
  }

  function rgbConvert$1(o) {
    if (!(o instanceof Color$1)) o = color$1(o);
    if (!o) return new Rgb$1();
    o = o.rgb();
    return new Rgb$1(o.r, o.g, o.b, o.opacity);
  }
  function rgb$1(r, g, b, opacity) {
    return arguments.length === 1 ? rgbConvert$1(r) : new Rgb$1(r, g, b, opacity == null ? 1 : opacity);
  }
  function Rgb$1(r, g, b, opacity) {
    this.r = +r;
    this.g = +g;
    this.b = +b;
    this.opacity = +opacity;
  }
  define$1(Rgb$1, rgb$1, extend$1(Color$1, {
    brighter: function brighter(k) {
      k = k == null ? _brighter$1 : Math.pow(_brighter$1, k);
      return new Rgb$1(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker$1 : Math.pow(_darker$1, k);
      return new Rgb$1(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    rgb: function rgb() {
      return this;
    },
    displayable: function displayable() {
      return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
    },
    hex: rgb_formatHex,
    // Deprecated! Use color.formatHex.
    formatHex: rgb_formatHex,
    formatRgb: rgb_formatRgb,
    toString: rgb_formatRgb
  }));

  function rgb_formatHex() {
    return "#" + hex(this.r) + hex(this.g) + hex(this.b);
  }

  function rgb_formatRgb() {
    var a = this.opacity;
    a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
    return (a === 1 ? "rgb(" : "rgba(") + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.b) || 0)) + (a === 1 ? ")" : ", " + a + ")");
  }

  function hex(value) {
    value = Math.max(0, Math.min(255, Math.round(value) || 0));
    return (value < 16 ? "0" : "") + value.toString(16);
  }

  function hsla$1(h, s, l, a) {
    if (a <= 0) h = s = l = NaN;else if (l <= 0 || l >= 1) h = s = NaN;else if (s <= 0) h = NaN;
    return new Hsl$1(h, s, l, a);
  }

  function hslConvert$1(o) {
    if (o instanceof Hsl$1) return new Hsl$1(o.h, o.s, o.l, o.opacity);
    if (!(o instanceof Color$1)) o = color$1(o);
    if (!o) return new Hsl$1();
    if (o instanceof Hsl$1) return o;
    o = o.rgb();
    var r = o.r / 255,
        g = o.g / 255,
        b = o.b / 255,
        min = Math.min(r, g, b),
        max = Math.max(r, g, b),
        h = NaN,
        s = max - min,
        l = (max + min) / 2;

    if (s) {
      if (r === max) h = (g - b) / s + (g < b) * 6;else if (g === max) h = (b - r) / s + 2;else h = (r - g) / s + 4;
      s /= l < 0.5 ? max + min : 2 - max - min;
      h *= 60;
    } else {
      s = l > 0 && l < 1 ? 0 : h;
    }

    return new Hsl$1(h, s, l, o.opacity);
  }
  function hsl$1(h, s, l, opacity) {
    return arguments.length === 1 ? hslConvert$1(h) : new Hsl$1(h, s, l, opacity == null ? 1 : opacity);
  }

  function Hsl$1(h, s, l, opacity) {
    this.h = +h;
    this.s = +s;
    this.l = +l;
    this.opacity = +opacity;
  }

  define$1(Hsl$1, hsl$1, extend$1(Color$1, {
    brighter: function brighter(k) {
      k = k == null ? _brighter$1 : Math.pow(_brighter$1, k);
      return new Hsl$1(this.h, this.s, this.l * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker$1 : Math.pow(_darker$1, k);
      return new Hsl$1(this.h, this.s, this.l * k, this.opacity);
    },
    rgb: function rgb() {
      var h = this.h % 360 + (this.h < 0) * 360,
          s = isNaN(h) || isNaN(this.s) ? 0 : this.s,
          l = this.l,
          m2 = l + (l < 0.5 ? l : 1 - l) * s,
          m1 = 2 * l - m2;
      return new Rgb$1(hsl2rgb$1(h >= 240 ? h - 240 : h + 120, m1, m2), hsl2rgb$1(h, m1, m2), hsl2rgb$1(h < 120 ? h + 240 : h - 120, m1, m2), this.opacity);
    },
    displayable: function displayable() {
      return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
    },
    formatHsl: function formatHsl() {
      var a = this.opacity;
      a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
      return (a === 1 ? "hsl(" : "hsla(") + (this.h || 0) + ", " + (this.s || 0) * 100 + "%, " + (this.l || 0) * 100 + "%" + (a === 1 ? ")" : ", " + a + ")");
    }
  }));
  /* From FvD 13.37, CSS Color Module Level 3 */

  function hsl2rgb$1(h, m1, m2) {
    return (h < 60 ? m1 + (m2 - m1) * h / 60 : h < 180 ? m2 : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60 : m1) * 255;
  }

  function define$2 (constructor, factory, prototype) {
    constructor.prototype = factory.prototype = prototype;
    prototype.constructor = constructor;
  }
  function extend$2(parent, definition) {
    var prototype = Object.create(parent.prototype);

    for (var key in definition) {
      prototype[key] = definition[key];
    }

    return prototype;
  }

  function Color$2() {}
  var _darker$2 = 0.7;

  var _brighter$2 = 1 / _darker$2;
  var reI$2 = "\\s*([+-]?\\d+)\\s*",
      reN$2 = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",
      reP$2 = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",
      reHex$1 = /^#([0-9a-f]{3,8})$/,
      reRgbInteger$2 = new RegExp("^rgb\\(" + [reI$2, reI$2, reI$2] + "\\)$"),
      reRgbPercent$2 = new RegExp("^rgb\\(" + [reP$2, reP$2, reP$2] + "\\)$"),
      reRgbaInteger$2 = new RegExp("^rgba\\(" + [reI$2, reI$2, reI$2, reN$2] + "\\)$"),
      reRgbaPercent$2 = new RegExp("^rgba\\(" + [reP$2, reP$2, reP$2, reN$2] + "\\)$"),
      reHslPercent$2 = new RegExp("^hsl\\(" + [reN$2, reP$2, reP$2] + "\\)$"),
      reHslaPercent$2 = new RegExp("^hsla\\(" + [reN$2, reP$2, reP$2, reN$2] + "\\)$");
  var named$2 = {
    aliceblue: 0xf0f8ff,
    antiquewhite: 0xfaebd7,
    aqua: 0x00ffff,
    aquamarine: 0x7fffd4,
    azure: 0xf0ffff,
    beige: 0xf5f5dc,
    bisque: 0xffe4c4,
    black: 0x000000,
    blanchedalmond: 0xffebcd,
    blue: 0x0000ff,
    blueviolet: 0x8a2be2,
    brown: 0xa52a2a,
    burlywood: 0xdeb887,
    cadetblue: 0x5f9ea0,
    chartreuse: 0x7fff00,
    chocolate: 0xd2691e,
    coral: 0xff7f50,
    cornflowerblue: 0x6495ed,
    cornsilk: 0xfff8dc,
    crimson: 0xdc143c,
    cyan: 0x00ffff,
    darkblue: 0x00008b,
    darkcyan: 0x008b8b,
    darkgoldenrod: 0xb8860b,
    darkgray: 0xa9a9a9,
    darkgreen: 0x006400,
    darkgrey: 0xa9a9a9,
    darkkhaki: 0xbdb76b,
    darkmagenta: 0x8b008b,
    darkolivegreen: 0x556b2f,
    darkorange: 0xff8c00,
    darkorchid: 0x9932cc,
    darkred: 0x8b0000,
    darksalmon: 0xe9967a,
    darkseagreen: 0x8fbc8f,
    darkslateblue: 0x483d8b,
    darkslategray: 0x2f4f4f,
    darkslategrey: 0x2f4f4f,
    darkturquoise: 0x00ced1,
    darkviolet: 0x9400d3,
    deeppink: 0xff1493,
    deepskyblue: 0x00bfff,
    dimgray: 0x696969,
    dimgrey: 0x696969,
    dodgerblue: 0x1e90ff,
    firebrick: 0xb22222,
    floralwhite: 0xfffaf0,
    forestgreen: 0x228b22,
    fuchsia: 0xff00ff,
    gainsboro: 0xdcdcdc,
    ghostwhite: 0xf8f8ff,
    gold: 0xffd700,
    goldenrod: 0xdaa520,
    gray: 0x808080,
    green: 0x008000,
    greenyellow: 0xadff2f,
    grey: 0x808080,
    honeydew: 0xf0fff0,
    hotpink: 0xff69b4,
    indianred: 0xcd5c5c,
    indigo: 0x4b0082,
    ivory: 0xfffff0,
    khaki: 0xf0e68c,
    lavender: 0xe6e6fa,
    lavenderblush: 0xfff0f5,
    lawngreen: 0x7cfc00,
    lemonchiffon: 0xfffacd,
    lightblue: 0xadd8e6,
    lightcoral: 0xf08080,
    lightcyan: 0xe0ffff,
    lightgoldenrodyellow: 0xfafad2,
    lightgray: 0xd3d3d3,
    lightgreen: 0x90ee90,
    lightgrey: 0xd3d3d3,
    lightpink: 0xffb6c1,
    lightsalmon: 0xffa07a,
    lightseagreen: 0x20b2aa,
    lightskyblue: 0x87cefa,
    lightslategray: 0x778899,
    lightslategrey: 0x778899,
    lightsteelblue: 0xb0c4de,
    lightyellow: 0xffffe0,
    lime: 0x00ff00,
    limegreen: 0x32cd32,
    linen: 0xfaf0e6,
    magenta: 0xff00ff,
    maroon: 0x800000,
    mediumaquamarine: 0x66cdaa,
    mediumblue: 0x0000cd,
    mediumorchid: 0xba55d3,
    mediumpurple: 0x9370db,
    mediumseagreen: 0x3cb371,
    mediumslateblue: 0x7b68ee,
    mediumspringgreen: 0x00fa9a,
    mediumturquoise: 0x48d1cc,
    mediumvioletred: 0xc71585,
    midnightblue: 0x191970,
    mintcream: 0xf5fffa,
    mistyrose: 0xffe4e1,
    moccasin: 0xffe4b5,
    navajowhite: 0xffdead,
    navy: 0x000080,
    oldlace: 0xfdf5e6,
    olive: 0x808000,
    olivedrab: 0x6b8e23,
    orange: 0xffa500,
    orangered: 0xff4500,
    orchid: 0xda70d6,
    palegoldenrod: 0xeee8aa,
    palegreen: 0x98fb98,
    paleturquoise: 0xafeeee,
    palevioletred: 0xdb7093,
    papayawhip: 0xffefd5,
    peachpuff: 0xffdab9,
    peru: 0xcd853f,
    pink: 0xffc0cb,
    plum: 0xdda0dd,
    powderblue: 0xb0e0e6,
    purple: 0x800080,
    rebeccapurple: 0x663399,
    red: 0xff0000,
    rosybrown: 0xbc8f8f,
    royalblue: 0x4169e1,
    saddlebrown: 0x8b4513,
    salmon: 0xfa8072,
    sandybrown: 0xf4a460,
    seagreen: 0x2e8b57,
    seashell: 0xfff5ee,
    sienna: 0xa0522d,
    silver: 0xc0c0c0,
    skyblue: 0x87ceeb,
    slateblue: 0x6a5acd,
    slategray: 0x708090,
    slategrey: 0x708090,
    snow: 0xfffafa,
    springgreen: 0x00ff7f,
    steelblue: 0x4682b4,
    tan: 0xd2b48c,
    teal: 0x008080,
    thistle: 0xd8bfd8,
    tomato: 0xff6347,
    turquoise: 0x40e0d0,
    violet: 0xee82ee,
    wheat: 0xf5deb3,
    white: 0xffffff,
    whitesmoke: 0xf5f5f5,
    yellow: 0xffff00,
    yellowgreen: 0x9acd32
  };
  define$2(Color$2, color$2, {
    copy: function copy(channels) {
      return Object.assign(new this.constructor(), this, channels);
    },
    displayable: function displayable() {
      return this.rgb().displayable();
    },
    hex: color_formatHex$1,
    // Deprecated! Use color.formatHex.
    formatHex: color_formatHex$1,
    formatHsl: color_formatHsl$1,
    formatRgb: color_formatRgb$1,
    toString: color_formatRgb$1
  });

  function color_formatHex$1() {
    return this.rgb().formatHex();
  }

  function color_formatHsl$1() {
    return hslConvert$2(this).formatHsl();
  }

  function color_formatRgb$1() {
    return this.rgb().formatRgb();
  }

  function color$2(format) {
    var m, l;
    format = (format + "").trim().toLowerCase();
    return (m = reHex$1.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn$2(m) // #ff0000
    : l === 3 ? new Rgb$2(m >> 8 & 0xf | m >> 4 & 0xf0, m >> 4 & 0xf | m & 0xf0, (m & 0xf) << 4 | m & 0xf, 1) // #f00
    : l === 8 ? new Rgb$2(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000
    : l === 4 ? new Rgb$2(m >> 12 & 0xf | m >> 8 & 0xf0, m >> 8 & 0xf | m >> 4 & 0xf0, m >> 4 & 0xf | m & 0xf0, ((m & 0xf) << 4 | m & 0xf) / 0xff) // #f000
    : null // invalid hex
    ) : (m = reRgbInteger$2.exec(format)) ? new Rgb$2(m[1], m[2], m[3], 1) // rgb(255, 0, 0)
    : (m = reRgbPercent$2.exec(format)) ? new Rgb$2(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)
    : (m = reRgbaInteger$2.exec(format)) ? rgba$2(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)
    : (m = reRgbaPercent$2.exec(format)) ? rgba$2(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)
    : (m = reHslPercent$2.exec(format)) ? hsla$2(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)
    : (m = reHslaPercent$2.exec(format)) ? hsla$2(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)
    : named$2.hasOwnProperty(format) ? rgbn$2(named$2[format]) // eslint-disable-line no-prototype-builtins
    : format === "transparent" ? new Rgb$2(NaN, NaN, NaN, 0) : null;
  }

  function rgbn$2(n) {
    return new Rgb$2(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);
  }

  function rgba$2(r, g, b, a) {
    if (a <= 0) r = g = b = NaN;
    return new Rgb$2(r, g, b, a);
  }

  function rgbConvert$2(o) {
    if (!(o instanceof Color$2)) o = color$2(o);
    if (!o) return new Rgb$2();
    o = o.rgb();
    return new Rgb$2(o.r, o.g, o.b, o.opacity);
  }
  function rgb$2(r, g, b, opacity) {
    return arguments.length === 1 ? rgbConvert$2(r) : new Rgb$2(r, g, b, opacity == null ? 1 : opacity);
  }
  function Rgb$2(r, g, b, opacity) {
    this.r = +r;
    this.g = +g;
    this.b = +b;
    this.opacity = +opacity;
  }
  define$2(Rgb$2, rgb$2, extend$2(Color$2, {
    brighter: function brighter(k) {
      k = k == null ? _brighter$2 : Math.pow(_brighter$2, k);
      return new Rgb$2(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker$2 : Math.pow(_darker$2, k);
      return new Rgb$2(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    rgb: function rgb() {
      return this;
    },
    displayable: function displayable() {
      return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
    },
    hex: rgb_formatHex$1,
    // Deprecated! Use color.formatHex.
    formatHex: rgb_formatHex$1,
    formatRgb: rgb_formatRgb$1,
    toString: rgb_formatRgb$1
  }));

  function rgb_formatHex$1() {
    return "#" + hex$1(this.r) + hex$1(this.g) + hex$1(this.b);
  }

  function rgb_formatRgb$1() {
    var a = this.opacity;
    a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
    return (a === 1 ? "rgb(" : "rgba(") + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.b) || 0)) + (a === 1 ? ")" : ", " + a + ")");
  }

  function hex$1(value) {
    value = Math.max(0, Math.min(255, Math.round(value) || 0));
    return (value < 16 ? "0" : "") + value.toString(16);
  }

  function hsla$2(h, s, l, a) {
    if (a <= 0) h = s = l = NaN;else if (l <= 0 || l >= 1) h = s = NaN;else if (s <= 0) h = NaN;
    return new Hsl$2(h, s, l, a);
  }

  function hslConvert$2(o) {
    if (o instanceof Hsl$2) return new Hsl$2(o.h, o.s, o.l, o.opacity);
    if (!(o instanceof Color$2)) o = color$2(o);
    if (!o) return new Hsl$2();
    if (o instanceof Hsl$2) return o;
    o = o.rgb();
    var r = o.r / 255,
        g = o.g / 255,
        b = o.b / 255,
        min = Math.min(r, g, b),
        max = Math.max(r, g, b),
        h = NaN,
        s = max - min,
        l = (max + min) / 2;

    if (s) {
      if (r === max) h = (g - b) / s + (g < b) * 6;else if (g === max) h = (b - r) / s + 2;else h = (r - g) / s + 4;
      s /= l < 0.5 ? max + min : 2 - max - min;
      h *= 60;
    } else {
      s = l > 0 && l < 1 ? 0 : h;
    }

    return new Hsl$2(h, s, l, o.opacity);
  }
  function hsl$2(h, s, l, opacity) {
    return arguments.length === 1 ? hslConvert$2(h) : new Hsl$2(h, s, l, opacity == null ? 1 : opacity);
  }

  function Hsl$2(h, s, l, opacity) {
    this.h = +h;
    this.s = +s;
    this.l = +l;
    this.opacity = +opacity;
  }

  define$2(Hsl$2, hsl$2, extend$2(Color$2, {
    brighter: function brighter(k) {
      k = k == null ? _brighter$2 : Math.pow(_brighter$2, k);
      return new Hsl$2(this.h, this.s, this.l * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker$2 : Math.pow(_darker$2, k);
      return new Hsl$2(this.h, this.s, this.l * k, this.opacity);
    },
    rgb: function rgb() {
      var h = this.h % 360 + (this.h < 0) * 360,
          s = isNaN(h) || isNaN(this.s) ? 0 : this.s,
          l = this.l,
          m2 = l + (l < 0.5 ? l : 1 - l) * s,
          m1 = 2 * l - m2;
      return new Rgb$2(hsl2rgb$2(h >= 240 ? h - 240 : h + 120, m1, m2), hsl2rgb$2(h, m1, m2), hsl2rgb$2(h < 120 ? h + 240 : h - 120, m1, m2), this.opacity);
    },
    displayable: function displayable() {
      return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
    },
    formatHsl: function formatHsl() {
      var a = this.opacity;
      a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
      return (a === 1 ? "hsl(" : "hsla(") + (this.h || 0) + ", " + (this.s || 0) * 100 + "%, " + (this.l || 0) * 100 + "%" + (a === 1 ? ")" : ", " + a + ")");
    }
  }));
  /* From FvD 13.37, CSS Color Module Level 3 */

  function hsl2rgb$2(h, m1, m2) {
    return (h < 60 ? m1 + (m2 - m1) * h / 60 : h < 180 ? m2 : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60 : m1) * 255;
  }

  /**
      @function colorAdd
      @desc Adds two colors together.
      @param {String} c1 The first color, a valid CSS color string.
      @param {String} c2 The second color, also a valid CSS color string.
      @param {String} [o1 = 1] Value from 0 to 1 of the first color's opacity.
      @param {String} [o2 = 1] Value from 0 to 1 of the first color's opacity.
      @returns {String}
  */

  function add (c1, c2) {
    var o1 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
    var o2 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
    c1 = hsl$2(c1);
    c2 = hsl$2(c2);
    var d = Math.abs(c2.h * o2 - c1.h * o1);
    if (d > 180) d -= 360;
    var h = (Math.min(c1.h, c2.h) + d / 2) % 360;
    var l = c1.l + (c2.l * o2 - c1.l * o1) / 2,
        s = c1.s + (c2.s * o2 - c1.s * o1) / 2; // a = o1 + (o2 - o1) / 2;

    if (h < 0) h += 360;
    return hsl$2("hsl(".concat(h, ",").concat(s * 100, "%,").concat(l * 100, "%)")).toString(); // return hsl(`hsl(${h},${s * 100}%,${l * 100}%,${a})`).toString();
  }

  /**
      @namespace {Object} colorDefaults
      @desc A set of default color values used when assigning colors based on data.
        *
        * | Name | Default | Description |
        * |---|---|---|
        * | dark | #444444 | Used in the [contrast](#contrast) function when the color given is very light. |
        * | light | #f7f7f7 | Used in the [contrast](#contrast) function when the color given is very dark. |
        * | missing | #cccccc | Used in the [assign](#assign) function when the value passed is `null` or `undefined`. |
        * | off | #b22200 | Used in the [assign](#assign) function when the value passed is `false`. |
        * | on | #224f20 | Used in the [assign](#assign) function when the value passed is `true`. |
        * | scale | #b22200, #eace3f, #282f6b, #b35c1e, #224f20, #5f487c, #759143, #419391, #993c88, #e89c89, #ffee8d, #afd5e8, #f7ba77, #a5c697, #c5b5e5, #d1d392, #bbefd0, #e099cf | An ordinal scale used in the [assign](#assign) function for non-valid color strings and numbers. |
  */

  var defaults = {
    dark: "#444444",
    light: "#f7f7f7",
    missing: "#cccccc",
    off: "#b22200",
    on: "#224f20",
    scale: ordinal().range(["#b22200", "#282f6b", "#eace3f", "#b35c1e", "#224f20", "#5f487c", "#759143", "#419391", "#993c88", "#e89c89", "#ffee8d", "#afd5e8", "#f7ba77", "#a5c697", "#c5b5e5", "#d1d392", "#bbefd0", "#e099cf"])
  };
  /**
      Returns a color based on a key, whether it is present in a user supplied object or in the default object.
      @returns {String}
      @private
  */

  function getColor(k) {
    var u = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    return k in u ? u[k] : k in defaults ? defaults[k] : defaults.missing;
  }

  /**
      @function colorAssign
      @desc Assigns a color to a value using a predefined set of defaults.
      @param {String} c A valid CSS color string.
      @param {Object} [u = defaults] An object containing overrides of the default colors.
      @returns {String}
  */

  function colorAssign (c) {
    var u = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // If the value is null or undefined, set to grey.

    if ([null, void 0].indexOf(c) >= 0) return getColor("missing", u); // Else if the value is true, set to green.
    else if (c === true) return getColor("on", u); // Else if the value is false, set to red.
      else if (c === false) return getColor("off", u);
    var p = color$2(c); // If the value is not a valid color string, use the color scale.

    if (!p) return getColor("scale", u)(c);
    return c.toString();
  }

  /**
      @function colorContrast
      @desc A set of default color values used when assigning colors based on data.
      @param {String} c A valid CSS color string.
      @param {Object} [u = defaults] An object containing overrides of the default colors.
      @returns {String}
  */

  function colorContrast (c) {
    var u = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    c = rgb$2(c);
    var yiq = (c.r * 299 + c.g * 587 + c.b * 114) / 1000;
    return yiq >= 128 ? getColor("dark", u) : getColor("light", u);
  }

  /**
      @function colorLegible
      @desc Darkens a color so that it will appear legible on a white background.
      @param {String} c A valid CSS color string.
      @returns {String}
  */

  function colorLegible (c) {
    c = hsl$2(c);

    if (c.l > 0.45) {
      if (c.s > 0.8) c.s = 0.8;
      c.l = 0.45;
    }

    return c.toString();
  }

  /**
      @function colorLighter
      @desc Similar to d3.color.brighter, except that this also reduces saturation so that colors don't appear neon.
      @param {String} c A valid CSS color string.
      @param {String} [i = 0.5] A value from 0 to 1 dictating the strength of the function.
      @returns {String}
  */

  function colorLighter (c) {
    var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.5;
    c = hsl$2(c);
    i *= 1 - c.l;
    c.l += i;
    c.s -= i;
    return c.toString();
  }

  /**
      @function colorSubtract
      @desc Subtracts one color from another.
      @param {String} c1 The base color, a valid CSS color string.
      @param {String} c2 The color to remove from the base color, also a valid CSS color string.
      @param {String} [o1 = 1] Value from 0 to 1 of the first color's opacity.
      @param {String} [o2 = 1] Value from 0 to 1 of the first color's opacity.
      @returns {String}
  */

  function subtract (c1, c2) {
    var o1 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
    var o2 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
    c1 = hsl$2(c1);
    c2 = hsl$2(c2);
    var d = c2.h * o2 - c1.h * o1;
    if (Math.abs(d) > 180) d -= 360;
    var h = (c1.h - d) % 360;
    var l = c1.l - (c2.l * o2 - c1.l * o1) / 2,
        s = c1.s - (c2.s * o2 - c1.s * o1) / 2; // a = o1 - (o2 - o1) / 2;

    if (h < 0) h += 360;
    return hsl$2("hsl(".concat(h, ",").concat(s * 100, "%,").concat(l * 100, "%)")).toString(); // return hsl(`hsl(${h},${s * 100}%,${l * 100}%,${a})`).toString();
  }

  var pi = Math.PI,
      tau = 2 * pi,
      epsilon = 1e-6,
      tauEpsilon = tau - epsilon;

  function Path() {
    this._x0 = this._y0 = // start of current subpath
    this._x1 = this._y1 = null; // end of current subpath

    this._ = "";
  }

  function path() {
    return new Path();
  }

  Path.prototype = path.prototype = {
    constructor: Path,
    moveTo: function moveTo(x, y) {
      this._ += "M" + (this._x0 = this._x1 = +x) + "," + (this._y0 = this._y1 = +y);
    },
    closePath: function closePath() {
      if (this._x1 !== null) {
        this._x1 = this._x0, this._y1 = this._y0;
        this._ += "Z";
      }
    },
    lineTo: function lineTo(x, y) {
      this._ += "L" + (this._x1 = +x) + "," + (this._y1 = +y);
    },
    quadraticCurveTo: function quadraticCurveTo(x1, y1, x, y) {
      this._ += "Q" + +x1 + "," + +y1 + "," + (this._x1 = +x) + "," + (this._y1 = +y);
    },
    bezierCurveTo: function bezierCurveTo(x1, y1, x2, y2, x, y) {
      this._ += "C" + +x1 + "," + +y1 + "," + +x2 + "," + +y2 + "," + (this._x1 = +x) + "," + (this._y1 = +y);
    },
    arcTo: function arcTo(x1, y1, x2, y2, r) {
      x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;
      var x0 = this._x1,
          y0 = this._y1,
          x21 = x2 - x1,
          y21 = y2 - y1,
          x01 = x0 - x1,
          y01 = y0 - y1,
          l01_2 = x01 * x01 + y01 * y01; // Is the radius negative? Error.

      if (r < 0) throw new Error("negative radius: " + r); // Is this path empty? Move to (x1,y1).

      if (this._x1 === null) {
        this._ += "M" + (this._x1 = x1) + "," + (this._y1 = y1);
      } // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.
      else if (!(l01_2 > epsilon)) ; // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?
        // Equivalently, is (x1,y1) coincident with (x2,y2)?
        // Or, is the radius zero? Line to (x1,y1).
        else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {
            this._ += "L" + (this._x1 = x1) + "," + (this._y1 = y1);
          } // Otherwise, draw an arc!
          else {
              var x20 = x2 - x0,
                  y20 = y2 - y0,
                  l21_2 = x21 * x21 + y21 * y21,
                  l20_2 = x20 * x20 + y20 * y20,
                  l21 = Math.sqrt(l21_2),
                  l01 = Math.sqrt(l01_2),
                  l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),
                  t01 = l / l01,
                  t21 = l / l21; // If the start tangent is not coincident with (x0,y0), line to.

              if (Math.abs(t01 - 1) > epsilon) {
                this._ += "L" + (x1 + t01 * x01) + "," + (y1 + t01 * y01);
              }

              this._ += "A" + r + "," + r + ",0,0," + +(y01 * x20 > x01 * y20) + "," + (this._x1 = x1 + t21 * x21) + "," + (this._y1 = y1 + t21 * y21);
            }
    },
    arc: function arc(x, y, r, a0, a1, ccw) {
      x = +x, y = +y, r = +r, ccw = !!ccw;
      var dx = r * Math.cos(a0),
          dy = r * Math.sin(a0),
          x0 = x + dx,
          y0 = y + dy,
          cw = 1 ^ ccw,
          da = ccw ? a0 - a1 : a1 - a0; // Is the radius negative? Error.

      if (r < 0) throw new Error("negative radius: " + r); // Is this path empty? Move to (x0,y0).

      if (this._x1 === null) {
        this._ += "M" + x0 + "," + y0;
      } // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).
      else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {
          this._ += "L" + x0 + "," + y0;
        } // Is this arc empty? Were done.


      if (!r) return; // Does the angle go the wrong way? Flip the direction.

      if (da < 0) da = da % tau + tau; // Is this a complete circle? Draw two arcs to complete the circle.

      if (da > tauEpsilon) {
        this._ += "A" + r + "," + r + ",0,1," + cw + "," + (x - dx) + "," + (y - dy) + "A" + r + "," + r + ",0,1," + cw + "," + (this._x1 = x0) + "," + (this._y1 = y0);
      } // Is this arc non-empty? Draw an arc!
      else if (da > epsilon) {
          this._ += "A" + r + "," + r + ",0," + +(da >= pi) + "," + cw + "," + (this._x1 = x + r * Math.cos(a1)) + "," + (this._y1 = y + r * Math.sin(a1));
        }
    },
    rect: function rect(x, y, w, h) {
      this._ += "M" + (this._x0 = this._x1 = +x) + "," + (this._y0 = this._y1 = +y) + "h" + +w + "v" + +h + "h" + -w + "Z";
    },
    toString: function toString() {
      return this._;
    }
  };

  function constant$4 (x) {
    return function constant() {
      return x;
    };
  }

  var abs = Math.abs;
  var atan2 = Math.atan2;
  var cos = Math.cos;
  var max$1 = Math.max;
  var min$1 = Math.min;
  var sin = Math.sin;
  var sqrt$1 = Math.sqrt;
  var epsilon$1 = 1e-12;
  var pi$1 = Math.PI;
  var halfPi = pi$1 / 2;
  var tau$1 = 2 * pi$1;
  function acos(x) {
    return x > 1 ? 0 : x < -1 ? pi$1 : Math.acos(x);
  }
  function asin(x) {
    return x >= 1 ? halfPi : x <= -1 ? -halfPi : Math.asin(x);
  }

  function arcInnerRadius(d) {
    return d.innerRadius;
  }

  function arcOuterRadius(d) {
    return d.outerRadius;
  }

  function arcStartAngle(d) {
    return d.startAngle;
  }

  function arcEndAngle(d) {
    return d.endAngle;
  }

  function arcPadAngle(d) {
    return d && d.padAngle; // Note: optional!
  }

  function intersect(x0, y0, x1, y1, x2, y2, x3, y3) {
    var x10 = x1 - x0,
        y10 = y1 - y0,
        x32 = x3 - x2,
        y32 = y3 - y2,
        t = y32 * x10 - x32 * y10;
    if (t * t < epsilon$1) return;
    t = (x32 * (y0 - y2) - y32 * (x0 - x2)) / t;
    return [x0 + t * x10, y0 + t * y10];
  } // Compute perpendicular offset line of length rc.
  // http://mathworld.wolfram.com/Circle-LineIntersection.html


  function cornerTangents(x0, y0, x1, y1, r1, rc, cw) {
    var x01 = x0 - x1,
        y01 = y0 - y1,
        lo = (cw ? rc : -rc) / sqrt$1(x01 * x01 + y01 * y01),
        ox = lo * y01,
        oy = -lo * x01,
        x11 = x0 + ox,
        y11 = y0 + oy,
        x10 = x1 + ox,
        y10 = y1 + oy,
        x00 = (x11 + x10) / 2,
        y00 = (y11 + y10) / 2,
        dx = x10 - x11,
        dy = y10 - y11,
        d2 = dx * dx + dy * dy,
        r = r1 - rc,
        D = x11 * y10 - x10 * y11,
        d = (dy < 0 ? -1 : 1) * sqrt$1(max$1(0, r * r * d2 - D * D)),
        cx0 = (D * dy - dx * d) / d2,
        cy0 = (-D * dx - dy * d) / d2,
        cx1 = (D * dy + dx * d) / d2,
        cy1 = (-D * dx + dy * d) / d2,
        dx0 = cx0 - x00,
        dy0 = cy0 - y00,
        dx1 = cx1 - x00,
        dy1 = cy1 - y00; // Pick the closer of the two intersection points.
    // TODO Is there a faster way to determine which intersection to use?

    if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) cx0 = cx1, cy0 = cy1;
    return {
      cx: cx0,
      cy: cy0,
      x01: -ox,
      y01: -oy,
      x11: cx0 * (r1 / r - 1),
      y11: cy0 * (r1 / r - 1)
    };
  }

  function arc () {
    var innerRadius = arcInnerRadius,
        outerRadius = arcOuterRadius,
        cornerRadius = constant$4(0),
        padRadius = null,
        startAngle = arcStartAngle,
        endAngle = arcEndAngle,
        padAngle = arcPadAngle,
        context = null;

    function arc() {
      var buffer,
          r,
          r0 = +innerRadius.apply(this, arguments),
          r1 = +outerRadius.apply(this, arguments),
          a0 = startAngle.apply(this, arguments) - halfPi,
          a1 = endAngle.apply(this, arguments) - halfPi,
          da = abs(a1 - a0),
          cw = a1 > a0;
      if (!context) context = buffer = path(); // Ensure that the outer radius is always larger than the inner radius.

      if (r1 < r0) r = r1, r1 = r0, r0 = r; // Is it a point?

      if (!(r1 > epsilon$1)) context.moveTo(0, 0); // Or is it a circle or annulus?
      else if (da > tau$1 - epsilon$1) {
          context.moveTo(r1 * cos(a0), r1 * sin(a0));
          context.arc(0, 0, r1, a0, a1, !cw);

          if (r0 > epsilon$1) {
            context.moveTo(r0 * cos(a1), r0 * sin(a1));
            context.arc(0, 0, r0, a1, a0, cw);
          }
        } // Or is it a circular or annular sector?
        else {
            var a01 = a0,
                a11 = a1,
                a00 = a0,
                a10 = a1,
                da0 = da,
                da1 = da,
                ap = padAngle.apply(this, arguments) / 2,
                rp = ap > epsilon$1 && (padRadius ? +padRadius.apply(this, arguments) : sqrt$1(r0 * r0 + r1 * r1)),
                rc = min$1(abs(r1 - r0) / 2, +cornerRadius.apply(this, arguments)),
                rc0 = rc,
                rc1 = rc,
                t0,
                t1; // Apply padding? Note that since r1  r0, da1  da0.

            if (rp > epsilon$1) {
              var p0 = asin(rp / r0 * sin(ap)),
                  p1 = asin(rp / r1 * sin(ap));
              if ((da0 -= p0 * 2) > epsilon$1) p0 *= cw ? 1 : -1, a00 += p0, a10 -= p0;else da0 = 0, a00 = a10 = (a0 + a1) / 2;
              if ((da1 -= p1 * 2) > epsilon$1) p1 *= cw ? 1 : -1, a01 += p1, a11 -= p1;else da1 = 0, a01 = a11 = (a0 + a1) / 2;
            }

            var x01 = r1 * cos(a01),
                y01 = r1 * sin(a01),
                x10 = r0 * cos(a10),
                y10 = r0 * sin(a10); // Apply rounded corners?

            if (rc > epsilon$1) {
              var x11 = r1 * cos(a11),
                  y11 = r1 * sin(a11),
                  x00 = r0 * cos(a00),
                  y00 = r0 * sin(a00),
                  oc; // Restrict the corner radius according to the sector angle.

              if (da < pi$1 && (oc = intersect(x01, y01, x00, y00, x11, y11, x10, y10))) {
                var ax = x01 - oc[0],
                    ay = y01 - oc[1],
                    bx = x11 - oc[0],
                    by = y11 - oc[1],
                    kc = 1 / sin(acos((ax * bx + ay * by) / (sqrt$1(ax * ax + ay * ay) * sqrt$1(bx * bx + by * by))) / 2),
                    lc = sqrt$1(oc[0] * oc[0] + oc[1] * oc[1]);
                rc0 = min$1(rc, (r0 - lc) / (kc - 1));
                rc1 = min$1(rc, (r1 - lc) / (kc + 1));
              }
            } // Is the sector collapsed to a line?


            if (!(da1 > epsilon$1)) context.moveTo(x01, y01); // Does the sectors outer ring have rounded corners?
            else if (rc1 > epsilon$1) {
                t0 = cornerTangents(x00, y00, x01, y01, r1, rc1, cw);
                t1 = cornerTangents(x11, y11, x10, y10, r1, rc1, cw);
                context.moveTo(t0.cx + t0.x01, t0.cy + t0.y01); // Have the corners merged?

                if (rc1 < rc) context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw); // Otherwise, draw the two corners and the ring.
                else {
                    context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);
                    context.arc(0, 0, r1, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), !cw);
                    context.arc(t1.cx, t1.cy, rc1, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);
                  }
              } // Or is the outer ring just a circular arc?
              else context.moveTo(x01, y01), context.arc(0, 0, r1, a01, a11, !cw); // Is there no inner ring, and its a circular sector?
            // Or perhaps its an annular sector collapsed due to padding?

            if (!(r0 > epsilon$1) || !(da0 > epsilon$1)) context.lineTo(x10, y10); // Does the sectors inner ring (or point) have rounded corners?
            else if (rc0 > epsilon$1) {
                t0 = cornerTangents(x10, y10, x11, y11, r0, -rc0, cw);
                t1 = cornerTangents(x01, y01, x00, y00, r0, -rc0, cw);
                context.lineTo(t0.cx + t0.x01, t0.cy + t0.y01); // Have the corners merged?

                if (rc0 < rc) context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw); // Otherwise, draw the two corners and the ring.
                else {
                    context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);
                    context.arc(0, 0, r0, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), cw);
                    context.arc(t1.cx, t1.cy, rc0, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);
                  }
              } // Or is the inner ring just a circular arc?
              else context.arc(0, 0, r0, a10, a00, cw);
          }
      context.closePath();
      if (buffer) return context = null, buffer + "" || null;
    }

    arc.centroid = function () {
      var r = (+innerRadius.apply(this, arguments) + +outerRadius.apply(this, arguments)) / 2,
          a = (+startAngle.apply(this, arguments) + +endAngle.apply(this, arguments)) / 2 - pi$1 / 2;
      return [cos(a) * r, sin(a) * r];
    };

    arc.innerRadius = function (_) {
      return arguments.length ? (innerRadius = typeof _ === "function" ? _ : constant$4(+_), arc) : innerRadius;
    };

    arc.outerRadius = function (_) {
      return arguments.length ? (outerRadius = typeof _ === "function" ? _ : constant$4(+_), arc) : outerRadius;
    };

    arc.cornerRadius = function (_) {
      return arguments.length ? (cornerRadius = typeof _ === "function" ? _ : constant$4(+_), arc) : cornerRadius;
    };

    arc.padRadius = function (_) {
      return arguments.length ? (padRadius = _ == null ? null : typeof _ === "function" ? _ : constant$4(+_), arc) : padRadius;
    };

    arc.startAngle = function (_) {
      return arguments.length ? (startAngle = typeof _ === "function" ? _ : constant$4(+_), arc) : startAngle;
    };

    arc.endAngle = function (_) {
      return arguments.length ? (endAngle = typeof _ === "function" ? _ : constant$4(+_), arc) : endAngle;
    };

    arc.padAngle = function (_) {
      return arguments.length ? (padAngle = typeof _ === "function" ? _ : constant$4(+_), arc) : padAngle;
    };

    arc.context = function (_) {
      return arguments.length ? (context = _ == null ? null : _, arc) : context;
    };

    return arc;
  }

  function Linear(context) {
    this._context = context;
  }

  Linear.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      if (this._line || this._line !== 0 && this._point === 1) this._context.closePath();
      this._line = 1 - this._line;
    },
    point: function point(x, y) {
      x = +x, y = +y;

      switch (this._point) {
        case 0:
          this._point = 1;
          this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y);
          break;

        case 1:
          this._point = 2;
        // proceed

        default:
          this._context.lineTo(x, y);

          break;
      }
    }
  };
  function curveLinear (context) {
    return new Linear(context);
  }

  function x(p) {
    return p[0];
  }
  function y(p) {
    return p[1];
  }

  function line () {
    var x$1 = x,
        y$1 = y,
        defined = constant$4(true),
        context = null,
        curve = curveLinear,
        output = null;

    function line(data) {
      var i,
          n = data.length,
          d,
          defined0 = false,
          buffer;
      if (context == null) output = curve(buffer = path());

      for (i = 0; i <= n; ++i) {
        if (!(i < n && defined(d = data[i], i, data)) === defined0) {
          if (defined0 = !defined0) output.lineStart();else output.lineEnd();
        }

        if (defined0) output.point(+x$1(d, i, data), +y$1(d, i, data));
      }

      if (buffer) return output = null, buffer + "" || null;
    }

    line.x = function (_) {
      return arguments.length ? (x$1 = typeof _ === "function" ? _ : constant$4(+_), line) : x$1;
    };

    line.y = function (_) {
      return arguments.length ? (y$1 = typeof _ === "function" ? _ : constant$4(+_), line) : y$1;
    };

    line.defined = function (_) {
      return arguments.length ? (defined = typeof _ === "function" ? _ : constant$4(!!_), line) : defined;
    };

    line.curve = function (_) {
      return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;
    };

    line.context = function (_) {
      return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;
    };

    return line;
  }

  function area () {
    var x0 = x,
        x1 = null,
        y0 = constant$4(0),
        y1 = y,
        defined = constant$4(true),
        context = null,
        curve = curveLinear,
        output = null;

    function area(data) {
      var i,
          j,
          k,
          n = data.length,
          d,
          defined0 = false,
          buffer,
          x0z = new Array(n),
          y0z = new Array(n);
      if (context == null) output = curve(buffer = path());

      for (i = 0; i <= n; ++i) {
        if (!(i < n && defined(d = data[i], i, data)) === defined0) {
          if (defined0 = !defined0) {
            j = i;
            output.areaStart();
            output.lineStart();
          } else {
            output.lineEnd();
            output.lineStart();

            for (k = i - 1; k >= j; --k) {
              output.point(x0z[k], y0z[k]);
            }

            output.lineEnd();
            output.areaEnd();
          }
        }

        if (defined0) {
          x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);
          output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);
        }
      }

      if (buffer) return output = null, buffer + "" || null;
    }

    function arealine() {
      return line().defined(defined).curve(curve).context(context);
    }

    area.x = function (_) {
      return arguments.length ? (x0 = typeof _ === "function" ? _ : constant$4(+_), x1 = null, area) : x0;
    };

    area.x0 = function (_) {
      return arguments.length ? (x0 = typeof _ === "function" ? _ : constant$4(+_), area) : x0;
    };

    area.x1 = function (_) {
      return arguments.length ? (x1 = _ == null ? null : typeof _ === "function" ? _ : constant$4(+_), area) : x1;
    };

    area.y = function (_) {
      return arguments.length ? (y0 = typeof _ === "function" ? _ : constant$4(+_), y1 = null, area) : y0;
    };

    area.y0 = function (_) {
      return arguments.length ? (y0 = typeof _ === "function" ? _ : constant$4(+_), area) : y0;
    };

    area.y1 = function (_) {
      return arguments.length ? (y1 = _ == null ? null : typeof _ === "function" ? _ : constant$4(+_), area) : y1;
    };

    area.lineX0 = area.lineY0 = function () {
      return arealine().x(x0).y(y0);
    };

    area.lineY1 = function () {
      return arealine().x(x0).y(y1);
    };

    area.lineX1 = function () {
      return arealine().x(x1).y(y0);
    };

    area.defined = function (_) {
      return arguments.length ? (defined = typeof _ === "function" ? _ : constant$4(!!_), area) : defined;
    };

    area.curve = function (_) {
      return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;
    };

    area.context = function (_) {
      return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;
    };

    return area;
  }

  function descending (a, b) {
    return b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;
  }

  function identity$4 (d) {
    return d;
  }

  function pie () {
    var value = identity$4,
        sortValues = descending,
        sort = null,
        startAngle = constant$4(0),
        endAngle = constant$4(tau$1),
        padAngle = constant$4(0);

    function pie(data) {
      var i,
          n = data.length,
          j,
          k,
          sum = 0,
          index = new Array(n),
          arcs = new Array(n),
          a0 = +startAngle.apply(this, arguments),
          da = Math.min(tau$1, Math.max(-tau$1, endAngle.apply(this, arguments) - a0)),
          a1,
          p = Math.min(Math.abs(da) / n, padAngle.apply(this, arguments)),
          pa = p * (da < 0 ? -1 : 1),
          v;

      for (i = 0; i < n; ++i) {
        if ((v = arcs[index[i] = i] = +value(data[i], i, data)) > 0) {
          sum += v;
        }
      } // Optionally sort the arcs by previously-computed values or by data.


      if (sortValues != null) index.sort(function (i, j) {
        return sortValues(arcs[i], arcs[j]);
      });else if (sort != null) index.sort(function (i, j) {
        return sort(data[i], data[j]);
      }); // Compute the arcs! They are stored in the original data's order.

      for (i = 0, k = sum ? (da - n * pa) / sum : 0; i < n; ++i, a0 = a1) {
        j = index[i], v = arcs[j], a1 = a0 + (v > 0 ? v * k : 0) + pa, arcs[j] = {
          data: data[j],
          index: i,
          value: v,
          startAngle: a0,
          endAngle: a1,
          padAngle: p
        };
      }

      return arcs;
    }

    pie.value = function (_) {
      return arguments.length ? (value = typeof _ === "function" ? _ : constant$4(+_), pie) : value;
    };

    pie.sortValues = function (_) {
      return arguments.length ? (sortValues = _, sort = null, pie) : sortValues;
    };

    pie.sort = function (_) {
      return arguments.length ? (sort = _, sortValues = null, pie) : sort;
    };

    pie.startAngle = function (_) {
      return arguments.length ? (startAngle = typeof _ === "function" ? _ : constant$4(+_), pie) : startAngle;
    };

    pie.endAngle = function (_) {
      return arguments.length ? (endAngle = typeof _ === "function" ? _ : constant$4(+_), pie) : endAngle;
    };

    pie.padAngle = function (_) {
      return arguments.length ? (padAngle = typeof _ === "function" ? _ : constant$4(+_), pie) : padAngle;
    };

    return pie;
  }

  var curveRadialLinear = curveRadial(curveLinear);

  function Radial(curve) {
    this._curve = curve;
  }

  Radial.prototype = {
    areaStart: function areaStart() {
      this._curve.areaStart();
    },
    areaEnd: function areaEnd() {
      this._curve.areaEnd();
    },
    lineStart: function lineStart() {
      this._curve.lineStart();
    },
    lineEnd: function lineEnd() {
      this._curve.lineEnd();
    },
    point: function point(a, r) {
      this._curve.point(r * Math.sin(a), r * -Math.cos(a));
    }
  };
  function curveRadial(curve) {
    function radial(context) {
      return new Radial(curve(context));
    }

    radial._curve = curve;
    return radial;
  }

  function lineRadial(l) {
    var c = l.curve;
    l.angle = l.x, delete l.x;
    l.radius = l.y, delete l.y;

    l.curve = function (_) {
      return arguments.length ? c(curveRadial(_)) : c()._curve;
    };

    return l;
  }
  function lineRadial$1 () {
    return lineRadial(line().curve(curveRadialLinear));
  }

  function areaRadial () {
    var a = area().curve(curveRadialLinear),
        c = a.curve,
        x0 = a.lineX0,
        x1 = a.lineX1,
        y0 = a.lineY0,
        y1 = a.lineY1;
    a.angle = a.x, delete a.x;
    a.startAngle = a.x0, delete a.x0;
    a.endAngle = a.x1, delete a.x1;
    a.radius = a.y, delete a.y;
    a.innerRadius = a.y0, delete a.y0;
    a.outerRadius = a.y1, delete a.y1;
    a.lineStartAngle = function () {
      return lineRadial(x0());
    }, delete a.lineX0;
    a.lineEndAngle = function () {
      return lineRadial(x1());
    }, delete a.lineX1;
    a.lineInnerRadius = function () {
      return lineRadial(y0());
    }, delete a.lineY0;
    a.lineOuterRadius = function () {
      return lineRadial(y1());
    }, delete a.lineY1;

    a.curve = function (_) {
      return arguments.length ? c(curveRadial(_)) : c()._curve;
    };

    return a;
  }

  function pointRadial (x, y) {
    return [(y = +y) * Math.cos(x -= Math.PI / 2), y * Math.sin(x)];
  }

  var slice$1 = Array.prototype.slice;

  function linkSource(d) {
    return d.source;
  }

  function linkTarget(d) {
    return d.target;
  }

  function link(curve) {
    var source = linkSource,
        target = linkTarget,
        x$1 = x,
        y$1 = y,
        context = null;

    function link() {
      var buffer,
          argv = slice$1.call(arguments),
          s = source.apply(this, argv),
          t = target.apply(this, argv);
      if (!context) context = buffer = path();
      curve(context, +x$1.apply(this, (argv[0] = s, argv)), +y$1.apply(this, argv), +x$1.apply(this, (argv[0] = t, argv)), +y$1.apply(this, argv));
      if (buffer) return context = null, buffer + "" || null;
    }

    link.source = function (_) {
      return arguments.length ? (source = _, link) : source;
    };

    link.target = function (_) {
      return arguments.length ? (target = _, link) : target;
    };

    link.x = function (_) {
      return arguments.length ? (x$1 = typeof _ === "function" ? _ : constant$4(+_), link) : x$1;
    };

    link.y = function (_) {
      return arguments.length ? (y$1 = typeof _ === "function" ? _ : constant$4(+_), link) : y$1;
    };

    link.context = function (_) {
      return arguments.length ? (context = _ == null ? null : _, link) : context;
    };

    return link;
  }

  function curveHorizontal(context, x0, y0, x1, y1) {
    context.moveTo(x0, y0);
    context.bezierCurveTo(x0 = (x0 + x1) / 2, y0, x0, y1, x1, y1);
  }

  function curveVertical(context, x0, y0, x1, y1) {
    context.moveTo(x0, y0);
    context.bezierCurveTo(x0, y0 = (y0 + y1) / 2, x1, y0, x1, y1);
  }

  function curveRadial$1(context, x0, y0, x1, y1) {
    var p0 = pointRadial(x0, y0),
        p1 = pointRadial(x0, y0 = (y0 + y1) / 2),
        p2 = pointRadial(x1, y0),
        p3 = pointRadial(x1, y1);
    context.moveTo(p0[0], p0[1]);
    context.bezierCurveTo(p1[0], p1[1], p2[0], p2[1], p3[0], p3[1]);
  }

  function linkHorizontal() {
    return link(curveHorizontal);
  }
  function linkVertical() {
    return link(curveVertical);
  }
  function linkRadial() {
    var l = link(curveRadial$1);
    l.angle = l.x, delete l.x;
    l.radius = l.y, delete l.y;
    return l;
  }

  var circle = {
    draw: function draw(context, size) {
      var r = Math.sqrt(size / pi$1);
      context.moveTo(r, 0);
      context.arc(0, 0, r, 0, tau$1);
    }
  };

  var cross = {
    draw: function draw(context, size) {
      var r = Math.sqrt(size / 5) / 2;
      context.moveTo(-3 * r, -r);
      context.lineTo(-r, -r);
      context.lineTo(-r, -3 * r);
      context.lineTo(r, -3 * r);
      context.lineTo(r, -r);
      context.lineTo(3 * r, -r);
      context.lineTo(3 * r, r);
      context.lineTo(r, r);
      context.lineTo(r, 3 * r);
      context.lineTo(-r, 3 * r);
      context.lineTo(-r, r);
      context.lineTo(-3 * r, r);
      context.closePath();
    }
  };

  var tan30 = Math.sqrt(1 / 3),
      tan30_2 = tan30 * 2;
  var diamond = {
    draw: function draw(context, size) {
      var y = Math.sqrt(size / tan30_2),
          x = y * tan30;
      context.moveTo(0, -y);
      context.lineTo(x, 0);
      context.lineTo(0, y);
      context.lineTo(-x, 0);
      context.closePath();
    }
  };

  var ka$1 = 0.89081309152928522810,
      kr = Math.sin(pi$1 / 10) / Math.sin(7 * pi$1 / 10),
      kx = Math.sin(tau$1 / 10) * kr,
      ky$1 = -Math.cos(tau$1 / 10) * kr;
  var star = {
    draw: function draw(context, size) {
      var r = Math.sqrt(size * ka$1),
          x = kx * r,
          y = ky$1 * r;
      context.moveTo(0, -r);
      context.lineTo(x, y);

      for (var i = 1; i < 5; ++i) {
        var a = tau$1 * i / 5,
            c = Math.cos(a),
            s = Math.sin(a);
        context.lineTo(s * r, -c * r);
        context.lineTo(c * x - s * y, s * x + c * y);
      }

      context.closePath();
    }
  };

  var square = {
    draw: function draw(context, size) {
      var w = Math.sqrt(size),
          x = -w / 2;
      context.rect(x, x, w, w);
    }
  };

  var sqrt3 = Math.sqrt(3);
  var triangle = {
    draw: function draw(context, size) {
      var y = -Math.sqrt(size / (sqrt3 * 3));
      context.moveTo(0, y * 2);
      context.lineTo(-sqrt3 * y, -y);
      context.lineTo(sqrt3 * y, -y);
      context.closePath();
    }
  };

  var c = -0.5,
      s$1 = Math.sqrt(3) / 2,
      k = 1 / Math.sqrt(12),
      a = (k / 2 + 1) * 3;
  var wye = {
    draw: function draw(context, size) {
      var r = Math.sqrt(size / a),
          x0 = r / 2,
          y0 = r * k,
          x1 = x0,
          y1 = r * k + r,
          x2 = -x1,
          y2 = y1;
      context.moveTo(x0, y0);
      context.lineTo(x1, y1);
      context.lineTo(x2, y2);
      context.lineTo(c * x0 - s$1 * y0, s$1 * x0 + c * y0);
      context.lineTo(c * x1 - s$1 * y1, s$1 * x1 + c * y1);
      context.lineTo(c * x2 - s$1 * y2, s$1 * x2 + c * y2);
      context.lineTo(c * x0 + s$1 * y0, c * y0 - s$1 * x0);
      context.lineTo(c * x1 + s$1 * y1, c * y1 - s$1 * x1);
      context.lineTo(c * x2 + s$1 * y2, c * y2 - s$1 * x2);
      context.closePath();
    }
  };

  var symbols = [circle, cross, diamond, square, star, triangle, wye];
  function symbol () {
    var type = constant$4(circle),
        size = constant$4(64),
        context = null;

    function symbol() {
      var buffer;
      if (!context) context = buffer = path();
      type.apply(this, arguments).draw(context, +size.apply(this, arguments));
      if (buffer) return context = null, buffer + "" || null;
    }

    symbol.type = function (_) {
      return arguments.length ? (type = typeof _ === "function" ? _ : constant$4(_), symbol) : type;
    };

    symbol.size = function (_) {
      return arguments.length ? (size = typeof _ === "function" ? _ : constant$4(+_), symbol) : size;
    };

    symbol.context = function (_) {
      return arguments.length ? (context = _ == null ? null : _, symbol) : context;
    };

    return symbol;
  }

  function noop$1 () {}

  function _point(that, x, y) {
    that._context.bezierCurveTo((2 * that._x0 + that._x1) / 3, (2 * that._y0 + that._y1) / 3, (that._x0 + 2 * that._x1) / 3, (that._y0 + 2 * that._y1) / 3, (that._x0 + 4 * that._x1 + x) / 6, (that._y0 + 4 * that._y1 + y) / 6);
  }
  function Basis(context) {
    this._context = context;
  }
  Basis.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._y0 = this._y1 = NaN;
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      switch (this._point) {
        case 3:
          _point(this, this._x1, this._y1);

        // proceed

        case 2:
          this._context.lineTo(this._x1, this._y1);

          break;
      }

      if (this._line || this._line !== 0 && this._point === 1) this._context.closePath();
      this._line = 1 - this._line;
    },
    point: function point(x, y) {
      x = +x, y = +y;

      switch (this._point) {
        case 0:
          this._point = 1;
          this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y);
          break;

        case 1:
          this._point = 2;
          break;

        case 2:
          this._point = 3;

          this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6);

        // proceed

        default:
          _point(this, x, y);

          break;
      }

      this._x0 = this._x1, this._x1 = x;
      this._y0 = this._y1, this._y1 = y;
    }
  };
  function basis (context) {
    return new Basis(context);
  }

  function BasisClosed(context) {
    this._context = context;
  }

  BasisClosed.prototype = {
    areaStart: noop$1,
    areaEnd: noop$1,
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = NaN;
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      switch (this._point) {
        case 1:
          {
            this._context.moveTo(this._x2, this._y2);

            this._context.closePath();

            break;
          }

        case 2:
          {
            this._context.moveTo((this._x2 + 2 * this._x3) / 3, (this._y2 + 2 * this._y3) / 3);

            this._context.lineTo((this._x3 + 2 * this._x2) / 3, (this._y3 + 2 * this._y2) / 3);

            this._context.closePath();

            break;
          }

        case 3:
          {
            this.point(this._x2, this._y2);
            this.point(this._x3, this._y3);
            this.point(this._x4, this._y4);
            break;
          }
      }
    },
    point: function point(x, y) {
      x = +x, y = +y;

      switch (this._point) {
        case 0:
          this._point = 1;
          this._x2 = x, this._y2 = y;
          break;

        case 1:
          this._point = 2;
          this._x3 = x, this._y3 = y;
          break;

        case 2:
          this._point = 3;
          this._x4 = x, this._y4 = y;

          this._context.moveTo((this._x0 + 4 * this._x1 + x) / 6, (this._y0 + 4 * this._y1 + y) / 6);

          break;

        default:
          _point(this, x, y);

          break;
      }

      this._x0 = this._x1, this._x1 = x;
      this._y0 = this._y1, this._y1 = y;
    }
  };
  function basisClosed (context) {
    return new BasisClosed(context);
  }

  function BasisOpen(context) {
    this._context = context;
  }

  BasisOpen.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._y0 = this._y1 = NaN;
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      if (this._line || this._line !== 0 && this._point === 3) this._context.closePath();
      this._line = 1 - this._line;
    },
    point: function point(x, y) {
      x = +x, y = +y;

      switch (this._point) {
        case 0:
          this._point = 1;
          break;

        case 1:
          this._point = 2;
          break;

        case 2:
          this._point = 3;
          var x0 = (this._x0 + 4 * this._x1 + x) / 6,
              y0 = (this._y0 + 4 * this._y1 + y) / 6;
          this._line ? this._context.lineTo(x0, y0) : this._context.moveTo(x0, y0);
          break;

        case 3:
          this._point = 4;
        // proceed

        default:
          _point(this, x, y);

          break;
      }

      this._x0 = this._x1, this._x1 = x;
      this._y0 = this._y1, this._y1 = y;
    }
  };
  function basisOpen (context) {
    return new BasisOpen(context);
  }

  function Bundle(context, beta) {
    this._basis = new Basis(context);
    this._beta = beta;
  }

  Bundle.prototype = {
    lineStart: function lineStart() {
      this._x = [];
      this._y = [];

      this._basis.lineStart();
    },
    lineEnd: function lineEnd() {
      var x = this._x,
          y = this._y,
          j = x.length - 1;

      if (j > 0) {
        var x0 = x[0],
            y0 = y[0],
            dx = x[j] - x0,
            dy = y[j] - y0,
            i = -1,
            t;

        while (++i <= j) {
          t = i / j;

          this._basis.point(this._beta * x[i] + (1 - this._beta) * (x0 + t * dx), this._beta * y[i] + (1 - this._beta) * (y0 + t * dy));
        }
      }

      this._x = this._y = null;

      this._basis.lineEnd();
    },
    point: function point(x, y) {
      this._x.push(+x);

      this._y.push(+y);
    }
  };
  var bundle = (function custom(beta) {
    function bundle(context) {
      return beta === 1 ? new Basis(context) : new Bundle(context, beta);
    }

    bundle.beta = function (beta) {
      return custom(+beta);
    };

    return bundle;
  })(0.85);

  function _point$1(that, x, y) {
    that._context.bezierCurveTo(that._x1 + that._k * (that._x2 - that._x0), that._y1 + that._k * (that._y2 - that._y0), that._x2 + that._k * (that._x1 - x), that._y2 + that._k * (that._y1 - y), that._x2, that._y2);
  }
  function Cardinal(context, tension) {
    this._context = context;
    this._k = (1 - tension) / 6;
  }
  Cardinal.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._x2 = this._y0 = this._y1 = this._y2 = NaN;
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      switch (this._point) {
        case 2:
          this._context.lineTo(this._x2, this._y2);

          break;

        case 3:
          _point$1(this, this._x1, this._y1);

          break;
      }

      if (this._line || this._line !== 0 && this._point === 1) this._context.closePath();
      this._line = 1 - this._line;
    },
    point: function point(x, y) {
      x = +x, y = +y;

      switch (this._point) {
        case 0:
          this._point = 1;
          this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y);
          break;

        case 1:
          this._point = 2;
          this._x1 = x, this._y1 = y;
          break;

        case 2:
          this._point = 3;
        // proceed

        default:
          _point$1(this, x, y);

          break;
      }

      this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
      this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
    }
  };
  var cardinal = (function custom(tension) {
    function cardinal(context) {
      return new Cardinal(context, tension);
    }

    cardinal.tension = function (tension) {
      return custom(+tension);
    };

    return cardinal;
  })(0);

  function CardinalClosed(context, tension) {
    this._context = context;
    this._k = (1 - tension) / 6;
  }
  CardinalClosed.prototype = {
    areaStart: noop$1,
    areaEnd: noop$1,
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 = this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      switch (this._point) {
        case 1:
          {
            this._context.moveTo(this._x3, this._y3);

            this._context.closePath();

            break;
          }

        case 2:
          {
            this._context.lineTo(this._x3, this._y3);

            this._context.closePath();

            break;
          }

        case 3:
          {
            this.point(this._x3, this._y3);
            this.point(this._x4, this._y4);
            this.point(this._x5, this._y5);
            break;
          }
      }
    },
    point: function point(x, y) {
      x = +x, y = +y;

      switch (this._point) {
        case 0:
          this._point = 1;
          this._x3 = x, this._y3 = y;
          break;

        case 1:
          this._point = 2;

          this._context.moveTo(this._x4 = x, this._y4 = y);

          break;

        case 2:
          this._point = 3;
          this._x5 = x, this._y5 = y;
          break;

        default:
          _point$1(this, x, y);

          break;
      }

      this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
      this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
    }
  };
  var cardinalClosed = (function custom(tension) {
    function cardinal(context) {
      return new CardinalClosed(context, tension);
    }

    cardinal.tension = function (tension) {
      return custom(+tension);
    };

    return cardinal;
  })(0);

  function CardinalOpen(context, tension) {
    this._context = context;
    this._k = (1 - tension) / 6;
  }
  CardinalOpen.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._x2 = this._y0 = this._y1 = this._y2 = NaN;
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      if (this._line || this._line !== 0 && this._point === 3) this._context.closePath();
      this._line = 1 - this._line;
    },
    point: function point(x, y) {
      x = +x, y = +y;

      switch (this._point) {
        case 0:
          this._point = 1;
          break;

        case 1:
          this._point = 2;
          break;

        case 2:
          this._point = 3;
          this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2);
          break;

        case 3:
          this._point = 4;
        // proceed

        default:
          _point$1(this, x, y);

          break;
      }

      this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
      this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
    }
  };
  var cardinalOpen = (function custom(tension) {
    function cardinal(context) {
      return new CardinalOpen(context, tension);
    }

    cardinal.tension = function (tension) {
      return custom(+tension);
    };

    return cardinal;
  })(0);

  function _point$2(that, x, y) {
    var x1 = that._x1,
        y1 = that._y1,
        x2 = that._x2,
        y2 = that._y2;

    if (that._l01_a > epsilon$1) {
      var a = 2 * that._l01_2a + 3 * that._l01_a * that._l12_a + that._l12_2a,
          n = 3 * that._l01_a * (that._l01_a + that._l12_a);
      x1 = (x1 * a - that._x0 * that._l12_2a + that._x2 * that._l01_2a) / n;
      y1 = (y1 * a - that._y0 * that._l12_2a + that._y2 * that._l01_2a) / n;
    }

    if (that._l23_a > epsilon$1) {
      var b = 2 * that._l23_2a + 3 * that._l23_a * that._l12_a + that._l12_2a,
          m = 3 * that._l23_a * (that._l23_a + that._l12_a);
      x2 = (x2 * b + that._x1 * that._l23_2a - x * that._l12_2a) / m;
      y2 = (y2 * b + that._y1 * that._l23_2a - y * that._l12_2a) / m;
    }

    that._context.bezierCurveTo(x1, y1, x2, y2, that._x2, that._y2);
  }

  function CatmullRom(context, alpha) {
    this._context = context;
    this._alpha = alpha;
  }

  CatmullRom.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._x2 = this._y0 = this._y1 = this._y2 = NaN;
      this._l01_a = this._l12_a = this._l23_a = this._l01_2a = this._l12_2a = this._l23_2a = this._point = 0;
    },
    lineEnd: function lineEnd() {
      switch (this._point) {
        case 2:
          this._context.lineTo(this._x2, this._y2);

          break;

        case 3:
          this.point(this._x2, this._y2);
          break;
      }

      if (this._line || this._line !== 0 && this._point === 1) this._context.closePath();
      this._line = 1 - this._line;
    },
    point: function point(x, y) {
      x = +x, y = +y;

      if (this._point) {
        var x23 = this._x2 - x,
            y23 = this._y2 - y;
        this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));
      }

      switch (this._point) {
        case 0:
          this._point = 1;
          this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y);
          break;

        case 1:
          this._point = 2;
          break;

        case 2:
          this._point = 3;
        // proceed

        default:
          _point$2(this, x, y);

          break;
      }

      this._l01_a = this._l12_a, this._l12_a = this._l23_a;
      this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;
      this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
      this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
    }
  };
  var catmullRom = (function custom(alpha) {
    function catmullRom(context) {
      return alpha ? new CatmullRom(context, alpha) : new Cardinal(context, 0);
    }

    catmullRom.alpha = function (alpha) {
      return custom(+alpha);
    };

    return catmullRom;
  })(0.5);

  function CatmullRomClosed(context, alpha) {
    this._context = context;
    this._alpha = alpha;
  }

  CatmullRomClosed.prototype = {
    areaStart: noop$1,
    areaEnd: noop$1,
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 = this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;
      this._l01_a = this._l12_a = this._l23_a = this._l01_2a = this._l12_2a = this._l23_2a = this._point = 0;
    },
    lineEnd: function lineEnd() {
      switch (this._point) {
        case 1:
          {
            this._context.moveTo(this._x3, this._y3);

            this._context.closePath();

            break;
          }

        case 2:
          {
            this._context.lineTo(this._x3, this._y3);

            this._context.closePath();

            break;
          }

        case 3:
          {
            this.point(this._x3, this._y3);
            this.point(this._x4, this._y4);
            this.point(this._x5, this._y5);
            break;
          }
      }
    },
    point: function point(x, y) {
      x = +x, y = +y;

      if (this._point) {
        var x23 = this._x2 - x,
            y23 = this._y2 - y;
        this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));
      }

      switch (this._point) {
        case 0:
          this._point = 1;
          this._x3 = x, this._y3 = y;
          break;

        case 1:
          this._point = 2;

          this._context.moveTo(this._x4 = x, this._y4 = y);

          break;

        case 2:
          this._point = 3;
          this._x5 = x, this._y5 = y;
          break;

        default:
          _point$2(this, x, y);

          break;
      }

      this._l01_a = this._l12_a, this._l12_a = this._l23_a;
      this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;
      this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
      this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
    }
  };
  var catmullRomClosed = (function custom(alpha) {
    function catmullRom(context) {
      return alpha ? new CatmullRomClosed(context, alpha) : new CardinalClosed(context, 0);
    }

    catmullRom.alpha = function (alpha) {
      return custom(+alpha);
    };

    return catmullRom;
  })(0.5);

  function CatmullRomOpen(context, alpha) {
    this._context = context;
    this._alpha = alpha;
  }

  CatmullRomOpen.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._x2 = this._y0 = this._y1 = this._y2 = NaN;
      this._l01_a = this._l12_a = this._l23_a = this._l01_2a = this._l12_2a = this._l23_2a = this._point = 0;
    },
    lineEnd: function lineEnd() {
      if (this._line || this._line !== 0 && this._point === 3) this._context.closePath();
      this._line = 1 - this._line;
    },
    point: function point(x, y) {
      x = +x, y = +y;

      if (this._point) {
        var x23 = this._x2 - x,
            y23 = this._y2 - y;
        this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));
      }

      switch (this._point) {
        case 0:
          this._point = 1;
          break;

        case 1:
          this._point = 2;
          break;

        case 2:
          this._point = 3;
          this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2);
          break;

        case 3:
          this._point = 4;
        // proceed

        default:
          _point$2(this, x, y);

          break;
      }

      this._l01_a = this._l12_a, this._l12_a = this._l23_a;
      this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;
      this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
      this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
    }
  };
  var catmullRomOpen = (function custom(alpha) {
    function catmullRom(context) {
      return alpha ? new CatmullRomOpen(context, alpha) : new CardinalOpen(context, 0);
    }

    catmullRom.alpha = function (alpha) {
      return custom(+alpha);
    };

    return catmullRom;
  })(0.5);

  function LinearClosed(context) {
    this._context = context;
  }

  LinearClosed.prototype = {
    areaStart: noop$1,
    areaEnd: noop$1,
    lineStart: function lineStart() {
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      if (this._point) this._context.closePath();
    },
    point: function point(x, y) {
      x = +x, y = +y;
      if (this._point) this._context.lineTo(x, y);else this._point = 1, this._context.moveTo(x, y);
    }
  };
  function linearClosed (context) {
    return new LinearClosed(context);
  }

  function sign(x) {
    return x < 0 ? -1 : 1;
  } // Calculate the slopes of the tangents (Hermite-type interpolation) based on
  // the following paper: Steffen, M. 1990. A Simple Method for Monotonic
  // Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.
  // NOV(II), P. 443, 1990.


  function slope3(that, x2, y2) {
    var h0 = that._x1 - that._x0,
        h1 = x2 - that._x1,
        s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),
        s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),
        p = (s0 * h1 + s1 * h0) / (h0 + h1);
    return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;
  } // Calculate a one-sided slope.


  function slope2(that, t) {
    var h = that._x1 - that._x0;
    return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;
  } // According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations
  // "you can express cubic Hermite interpolation in terms of cubic Bzier curves
  // with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1".


  function _point$3(that, t0, t1) {
    var x0 = that._x0,
        y0 = that._y0,
        x1 = that._x1,
        y1 = that._y1,
        dx = (x1 - x0) / 3;

    that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);
  }

  function MonotoneX(context) {
    this._context = context;
  }

  MonotoneX.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x0 = this._x1 = this._y0 = this._y1 = this._t0 = NaN;
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      switch (this._point) {
        case 2:
          this._context.lineTo(this._x1, this._y1);

          break;

        case 3:
          _point$3(this, this._t0, slope2(this, this._t0));

          break;
      }

      if (this._line || this._line !== 0 && this._point === 1) this._context.closePath();
      this._line = 1 - this._line;
    },
    point: function point(x, y) {
      var t1 = NaN;
      x = +x, y = +y;
      if (x === this._x1 && y === this._y1) return; // Ignore coincident points.

      switch (this._point) {
        case 0:
          this._point = 1;
          this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y);
          break;

        case 1:
          this._point = 2;
          break;

        case 2:
          this._point = 3;

          _point$3(this, slope2(this, t1 = slope3(this, x, y)), t1);

          break;

        default:
          _point$3(this, this._t0, t1 = slope3(this, x, y));

          break;
      }

      this._x0 = this._x1, this._x1 = x;
      this._y0 = this._y1, this._y1 = y;
      this._t0 = t1;
    }
  };

  function MonotoneY(context) {
    this._context = new ReflectContext(context);
  }

  (MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function (x, y) {
    MonotoneX.prototype.point.call(this, y, x);
  };

  function ReflectContext(context) {
    this._context = context;
  }

  ReflectContext.prototype = {
    moveTo: function moveTo(x, y) {
      this._context.moveTo(y, x);
    },
    closePath: function closePath() {
      this._context.closePath();
    },
    lineTo: function lineTo(x, y) {
      this._context.lineTo(y, x);
    },
    bezierCurveTo: function bezierCurveTo(x1, y1, x2, y2, x, y) {
      this._context.bezierCurveTo(y1, x1, y2, x2, y, x);
    }
  };
  function monotoneX(context) {
    return new MonotoneX(context);
  }
  function monotoneY(context) {
    return new MonotoneY(context);
  }

  function Natural(context) {
    this._context = context;
  }

  Natural.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x = [];
      this._y = [];
    },
    lineEnd: function lineEnd() {
      var x = this._x,
          y = this._y,
          n = x.length;

      if (n) {
        this._line ? this._context.lineTo(x[0], y[0]) : this._context.moveTo(x[0], y[0]);

        if (n === 2) {
          this._context.lineTo(x[1], y[1]);
        } else {
          var px = controlPoints(x),
              py = controlPoints(y);

          for (var i0 = 0, i1 = 1; i1 < n; ++i0, ++i1) {
            this._context.bezierCurveTo(px[0][i0], py[0][i0], px[1][i0], py[1][i0], x[i1], y[i1]);
          }
        }
      }

      if (this._line || this._line !== 0 && n === 1) this._context.closePath();
      this._line = 1 - this._line;
      this._x = this._y = null;
    },
    point: function point(x, y) {
      this._x.push(+x);

      this._y.push(+y);
    }
  }; // See https://www.particleincell.com/2012/bezier-splines/ for derivation.

  function controlPoints(x) {
    var i,
        n = x.length - 1,
        m,
        a = new Array(n),
        b = new Array(n),
        r = new Array(n);
    a[0] = 0, b[0] = 2, r[0] = x[0] + 2 * x[1];

    for (i = 1; i < n - 1; ++i) {
      a[i] = 1, b[i] = 4, r[i] = 4 * x[i] + 2 * x[i + 1];
    }

    a[n - 1] = 2, b[n - 1] = 7, r[n - 1] = 8 * x[n - 1] + x[n];

    for (i = 1; i < n; ++i) {
      m = a[i] / b[i - 1], b[i] -= m, r[i] -= m * r[i - 1];
    }

    a[n - 1] = r[n - 1] / b[n - 1];

    for (i = n - 2; i >= 0; --i) {
      a[i] = (r[i] - a[i + 1]) / b[i];
    }

    b[n - 1] = (x[n] + a[n - 1]) / 2;

    for (i = 0; i < n - 1; ++i) {
      b[i] = 2 * x[i + 1] - a[i + 1];
    }

    return [a, b];
  }

  function natural (context) {
    return new Natural(context);
  }

  function Step(context, t) {
    this._context = context;
    this._t = t;
  }

  Step.prototype = {
    areaStart: function areaStart() {
      this._line = 0;
    },
    areaEnd: function areaEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._x = this._y = NaN;
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      if (0 < this._t && this._t < 1 && this._point === 2) this._context.lineTo(this._x, this._y);
      if (this._line || this._line !== 0 && this._point === 1) this._context.closePath();
      if (this._line >= 0) this._t = 1 - this._t, this._line = 1 - this._line;
    },
    point: function point(x, y) {
      x = +x, y = +y;

      switch (this._point) {
        case 0:
          this._point = 1;
          this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y);
          break;

        case 1:
          this._point = 2;
        // proceed

        default:
          {
            if (this._t <= 0) {
              this._context.lineTo(this._x, y);

              this._context.lineTo(x, y);
            } else {
              var x1 = this._x * (1 - this._t) + x * this._t;

              this._context.lineTo(x1, this._y);

              this._context.lineTo(x1, y);
            }

            break;
          }
      }

      this._x = x, this._y = y;
    }
  };
  function step (context) {
    return new Step(context, 0.5);
  }
  function stepBefore(context) {
    return new Step(context, 0);
  }
  function stepAfter(context) {
    return new Step(context, 1);
  }

  function none$1 (series, order) {
    if (!((n = series.length) > 1)) return;

    for (var i = 1, j, s0, s1 = series[order[0]], n, m = s1.length; i < n; ++i) {
      s0 = s1, s1 = series[order[i]];

      for (j = 0; j < m; ++j) {
        s1[j][1] += s1[j][0] = isNaN(s0[j][1]) ? s0[j][0] : s0[j][1];
      }
    }
  }

  function none$2 (series) {
    var n = series.length,
        o = new Array(n);

    while (--n >= 0) {
      o[n] = n;
    }

    return o;
  }

  function stackValue(d, key) {
    return d[key];
  }

  function stack () {
    var keys = constant$4([]),
        order = none$2,
        offset = none$1,
        value = stackValue;

    function stack(data) {
      var kz = keys.apply(this, arguments),
          i,
          m = data.length,
          n = kz.length,
          sz = new Array(n),
          oz;

      for (i = 0; i < n; ++i) {
        for (var ki = kz[i], si = sz[i] = new Array(m), j = 0, sij; j < m; ++j) {
          si[j] = sij = [0, +value(data[j], ki, j, data)];
          sij.data = data[j];
        }

        si.key = ki;
      }

      for (i = 0, oz = order(sz); i < n; ++i) {
        sz[oz[i]].index = i;
      }

      offset(sz, oz);
      return sz;
    }

    stack.keys = function (_) {
      return arguments.length ? (keys = typeof _ === "function" ? _ : constant$4(slice$1.call(_)), stack) : keys;
    };

    stack.value = function (_) {
      return arguments.length ? (value = typeof _ === "function" ? _ : constant$4(+_), stack) : value;
    };

    stack.order = function (_) {
      return arguments.length ? (order = _ == null ? none$2 : typeof _ === "function" ? _ : constant$4(slice$1.call(_)), stack) : order;
    };

    stack.offset = function (_) {
      return arguments.length ? (offset = _ == null ? none$1 : _, stack) : offset;
    };

    return stack;
  }

  function expand (series, order) {
    if (!((n = series.length) > 0)) return;

    for (var i, n, j = 0, m = series[0].length, y; j < m; ++j) {
      for (y = i = 0; i < n; ++i) {
        y += series[i][j][1] || 0;
      }

      if (y) for (i = 0; i < n; ++i) {
        series[i][j][1] /= y;
      }
    }

    none$1(series, order);
  }

  function diverging$1 (series, order) {
    if (!((n = series.length) > 0)) return;

    for (var i, j = 0, d, dy, yp, yn, n, m = series[order[0]].length; j < m; ++j) {
      for (yp = yn = 0, i = 0; i < n; ++i) {
        if ((dy = (d = series[order[i]][j])[1] - d[0]) > 0) {
          d[0] = yp, d[1] = yp += dy;
        } else if (dy < 0) {
          d[1] = yn, d[0] = yn += dy;
        } else {
          d[0] = 0, d[1] = dy;
        }
      }
    }
  }

  function silhouette (series, order) {
    if (!((n = series.length) > 0)) return;

    for (var j = 0, s0 = series[order[0]], n, m = s0.length; j < m; ++j) {
      for (var i = 0, y = 0; i < n; ++i) {
        y += series[i][j][1] || 0;
      }

      s0[j][1] += s0[j][0] = -y / 2;
    }

    none$1(series, order);
  }

  function wiggle (series, order) {
    if (!((n = series.length) > 0) || !((m = (s0 = series[order[0]]).length) > 0)) return;

    for (var y = 0, j = 1, s0, m, n; j < m; ++j) {
      for (var i = 0, s1 = 0, s2 = 0; i < n; ++i) {
        var si = series[order[i]],
            sij0 = si[j][1] || 0,
            sij1 = si[j - 1][1] || 0,
            s3 = (sij0 - sij1) / 2;

        for (var k = 0; k < i; ++k) {
          var sk = series[order[k]],
              skj0 = sk[j][1] || 0,
              skj1 = sk[j - 1][1] || 0;
          s3 += skj0 - skj1;
        }

        s1 += sij0, s2 += s3 * sij0;
      }

      s0[j - 1][1] += s0[j - 1][0] = y;
      if (s1) y -= s2 / s1;
    }

    s0[j - 1][1] += s0[j - 1][0] = y;
    none$1(series, order);
  }

  function appearance (series) {
    var peaks = series.map(peak);
    return none$2(series).sort(function (a, b) {
      return peaks[a] - peaks[b];
    });
  }

  function peak(series) {
    var i = -1,
        j = 0,
        n = series.length,
        vi,
        vj = -Infinity;

    while (++i < n) {
      if ((vi = +series[i][1]) > vj) vj = vi, j = i;
    }

    return j;
  }

  function ascending$2 (series) {
    var sums = series.map(sum$1);
    return none$2(series).sort(function (a, b) {
      return sums[a] - sums[b];
    });
  }
  function sum$1(series) {
    var s = 0,
        i = -1,
        n = series.length,
        v;

    while (++i < n) {
      if (v = +series[i][1]) s += v;
    }

    return s;
  }

  function descending$1 (series) {
    return ascending$2(series).reverse();
  }

  function insideOut (series) {
    var n = series.length,
        i,
        j,
        sums = series.map(sum$1),
        order = appearance(series),
        top = 0,
        bottom = 0,
        tops = [],
        bottoms = [];

    for (i = 0; i < n; ++i) {
      j = order[i];

      if (top < bottom) {
        top += sums[j];
        tops.push(j);
      } else {
        bottom += sums[j];
        bottoms.push(j);
      }
    }

    return bottoms.reverse().concat(tops);
  }

  function reverse (series) {
    return none$2(series).reverse();
  }



  var d3Shape = /*#__PURE__*/Object.freeze({
    __proto__: null,
    arc: arc,
    area: area,
    line: line,
    pie: pie,
    areaRadial: areaRadial,
    radialArea: areaRadial,
    lineRadial: lineRadial$1,
    radialLine: lineRadial$1,
    pointRadial: pointRadial,
    linkHorizontal: linkHorizontal,
    linkVertical: linkVertical,
    linkRadial: linkRadial,
    symbol: symbol,
    symbols: symbols,
    symbolCircle: circle,
    symbolCross: cross,
    symbolDiamond: diamond,
    symbolSquare: square,
    symbolStar: star,
    symbolTriangle: triangle,
    symbolWye: wye,
    curveBasisClosed: basisClosed,
    curveBasisOpen: basisOpen,
    curveBasis: basis,
    curveBundle: bundle,
    curveCardinalClosed: cardinalClosed,
    curveCardinalOpen: cardinalOpen,
    curveCardinal: cardinal,
    curveCatmullRomClosed: catmullRomClosed,
    curveCatmullRomOpen: catmullRomOpen,
    curveCatmullRom: catmullRom,
    curveLinearClosed: linearClosed,
    curveLinear: curveLinear,
    curveMonotoneX: monotoneX,
    curveMonotoneY: monotoneY,
    curveNatural: natural,
    curveStep: step,
    curveStepAfter: stepAfter,
    curveStepBefore: stepBefore,
    stack: stack,
    stackOffsetExpand: expand,
    stackOffsetDiverging: diverging$1,
    stackOffsetNone: none$1,
    stackOffsetSilhouette: silhouette,
    stackOffsetWiggle: wiggle,
    stackOrderAppearance: appearance,
    stackOrderAscending: ascending$2,
    stackOrderDescending: descending$1,
    stackOrderInsideOut: insideOut,
    stackOrderNone: none$2,
    stackOrderReverse: reverse
  });

  /**
   * Strips HTML and "un-escapes" escape characters.
   * @param {String} input
   */
  function htmlDecode(input) {
    if (input.replace(/\s+/g, "") === "") return input;
    var doc = new DOMParser().parseFromString(input.replace(/<[^>]+>/g, ""), "text/html");
    return doc.documentElement ? doc.documentElement.textContent : input;
  }
  /**
      @function textWidth
      @desc Given a text string, returns the predicted pixel width of the string when placed into DOM.
      @param {String|Array} text Can be either a single string or an array of strings to analyze.
      @param {Object} [style] An object of CSS font styles to apply. Accepts any of the valid [CSS font property](http://www.w3schools.com/cssref/pr_font_font.asp) values.
  */


  function textWidth (text, style) {
    style = Object.assign({
      "font-size": 10,
      "font-family": "sans-serif",
      "font-style": "normal",
      "font-weight": 400,
      "font-variant": "normal"
    }, style);
    var context = document.createElement("canvas").getContext("2d");
    var font = [];
    font.push(style["font-style"]);
    font.push(style["font-variant"]);
    font.push(style["font-weight"]);
    font.push(typeof style["font-size"] === "string" ? style["font-size"] : "".concat(style["font-size"], "px"));
    font.push(style["font-family"]);
    context.font = font.join(" ");
    if (text instanceof Array) return text.map(function (t) {
      return context.measureText(htmlDecode(t)).width;
    });
    return context.measureText(htmlDecode(text)).width;
  }

  /**
      @function trim
      @desc Cross-browser implementation of [trim](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim).
      @param {String} str
  */
  function trim(str) {
    return str.toString().replace(/^\s+|\s+$/g, "");
  }
  /**
      @function trimLeft
      @desc Cross-browser implementation of [trimLeft](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/TrimLeft).
      @param {String} str
  */


  function trimLeft(str) {
    return str.toString().replace(/^\s+/, "");
  }
  /**
      @function trimRight
      @desc Cross-browser implementation of [trimRight](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/TrimRight).
      @param {String} str
  */


  function trimRight(str) {
    return str.toString().replace(/\s+$/, "");
  }

  var alpha = "abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890",
      checked = {},
      height = 32;
  var dejavu, macos, monospace, proportional;
  /**
      @function fontExists
      @desc Given either a single font-family or a list of fonts, returns the name of the first font that can be rendered, or `false` if none are installed on the user's machine.
      @param {String|Array} font Can be either a valid CSS font-family string (single or comma-separated names) or an Array of string names.
  */

  var fontExists = function fontExists(font) {
    if (!dejavu) {
      dejavu = textWidth(alpha, {
        "font-family": "DejaVuSans",
        "font-size": height
      });
      macos = textWidth(alpha, {
        "font-family": "-apple-system",
        "font-size": height
      });
      monospace = textWidth(alpha, {
        "font-family": "monospace",
        "font-size": height
      });
      proportional = textWidth(alpha, {
        "font-family": "sans-serif",
        "font-size": height
      });
    }

    if (!(font instanceof Array)) font = font.split(",");
    font = font.map(function (f) {
      return trim(f);
    });

    for (var i = 0; i < font.length; i++) {
      var fam = font[i];
      if (checked[fam] || ["-apple-system", "monospace", "sans-serif", "DejaVuSans"].includes(fam)) return fam;else if (checked[fam] === false) continue;
      var width = textWidth(alpha, {
        "font-family": fam,
        "font-size": height
      });
      checked[fam] = width !== monospace;
      if (checked[fam]) checked[fam] = width !== proportional;
      if (macos && checked[fam]) checked[fam] = width !== macos;
      if (dejavu && checked[fam]) checked[fam] = width !== dejavu;
      if (checked[fam]) return fam;
    }

    return false;
  };

  /**
      @function rtl
      @desc Returns `true` if the HTML or body element has either the "dir" HTML attribute or the "direction" CSS property set to "rtl".
  */

  var detectRTL = (function () {
    return _select("html").attr("dir") === "rtl" || _select("body").attr("dir") === "rtl" || _select("html").style("direction") === "rtl" || _select("body").style("direction") === "rtl";
  });

  /**
      @function stringify
      @desc Coerces value into a String.
      @param {String} value
  */
  function stringify (value) {
    if (value === void 0) value = "undefined";else if (!(typeof value === "string" || value instanceof String)) value = JSON.stringify(value);
    return value;
  }

  // great unicode list: http://asecuritysite.com/coding/asc2
  var diacritics = [[/[\300-\305]/g, "A"], [/[\340-\345]/g, "a"], [/[\306]/g, "AE"], [/[\346]/g, "ae"], [/[\337]/g, "B"], [/[\307]/g, "C"], [/[\347]/g, "c"], [/[\320\336\376]/g, "D"], [/[\360]/g, "d"], [/[\310-\313]/g, "E"], [/[\350-\353]/g, "e"], [/[\314-\317]/g, "I"], [/[\354-\357]/g, "i"], [/[\321]/g, "N"], [/[\361]/g, "n"], [/[\322-\326\330]/g, "O"], [/[\362-\366\370]/g, "o"], [/[\331-\334]/g, "U"], [/[\371-\374]/g, "u"], [/[\327]/g, "x"], [/[\335]/g, "Y"], [/[\375\377]/g, "y"]];
  /**
      @function strip
      @desc Removes all non ASCII characters from a string.
      @param {String} value
  */

  function strip (value) {
    return "".concat(value).replace(/[^A-Za-z0-9\-_]/g, function (_char) {
      if (_char === " ") return "-";
      var ret = false;

      for (var d = 0; d < diacritics.length; d++) {
        if (new RegExp(diacritics[d][0]).test(_char)) {
          ret = diacritics[d][1];
          break;
        }
      }

      return ret || "";
    });
  }

  // scraped from http://www.fileformat.info/info/unicode/category/Mc/list.htm
  // and http://www.fileformat.info/info/unicode/category/Mn/list.htm
  // JSON.stringify([].slice.call(document.getElementsByClassName("table-list")[0].getElementsByTagName("tr")).filter(function(d){ return d.getElementsByTagName("a").length && d.getElementsByTagName("a")[0].innerHTML.length === 6; }).map(function(d){ return d.getElementsByTagName("a")[0].innerHTML.replace("U", "u").replace("+", ""); }).sort());
  // The following unicode characters combine to form new characters and should never be split from surrounding characters.
  var a$1 = ["u0903", "u093B", "u093E", "u093F", "u0940", "u0949", "u094A", "u094B", "u094C", "u094E", "u094F", "u0982", "u0983", "u09BE", "u09BF", "u09C0", "u09C7", "u09C8", "u09CB", "u09CC", "u09D7", "u0A03", "u0A3E", "u0A3F", "u0A40", "u0A83", "u0ABE", "u0ABF", "u0AC0", "u0AC9", "u0ACB", "u0ACC", "u0B02", "u0B03", "u0B3E", "u0B40", "u0B47", "u0B48", "u0B4B", "u0B4C", "u0B57", "u0BBE", "u0BBF", "u0BC1", "u0BC2", "u0BC6", "u0BC7", "u0BC8", "u0BCA", "u0BCB", "u0BCC", "u0BD7", "u0C01", "u0C02", "u0C03", "u0C41", "u0C42", "u0C43", "u0C44", "u0C82", "u0C83", "u0CBE", "u0CC0", "u0CC1", "u0CC2", "u0CC3", "u0CC4", "u0CC7", "u0CC8", "u0CCA", "u0CCB", "u0CD5", "u0CD6", "u0D02", "u0D03", "u0D3E", "u0D3F", "u0D40", "u0D46", "u0D47", "u0D48", "u0D4A", "u0D4B", "u0D4C", "u0D57", "u0D82", "u0D83", "u0DCF", "u0DD0", "u0DD1", "u0DD8", "u0DD9", "u0DDA", "u0DDB", "u0DDC", "u0DDD", "u0DDE", "u0DDF", "u0DF2", "u0DF3", "u0F3E", "u0F3F", "u0F7F", "u102B", "u102C", "u1031", "u1038", "u103B", "u103C", "u1056", "u1057", "u1062", "u1063", "u1064", "u1067", "u1068", "u1069", "u106A", "u106B", "u106C", "u106D", "u1083", "u1084", "u1087", "u1088", "u1089", "u108A", "u108B", "u108C", "u108F", "u109A", "u109B", "u109C", "u17B6", "u17BE", "u17BF", "u17C0", "u17C1", "u17C2", "u17C3", "u17C4", "u17C5", "u17C7", "u17C8", "u1923", "u1924", "u1925", "u1926", "u1929", "u192A", "u192B", "u1930", "u1931", "u1933", "u1934", "u1935", "u1936", "u1937", "u1938", "u1A19", "u1A1A", "u1A55", "u1A57", "u1A61", "u1A63", "u1A64", "u1A6D", "u1A6E", "u1A6F", "u1A70", "u1A71", "u1A72", "u1B04", "u1B35", "u1B3B", "u1B3D", "u1B3E", "u1B3F", "u1B40", "u1B41", "u1B43", "u1B44", "u1B82", "u1BA1", "u1BA6", "u1BA7", "u1BAA", "u1BE7", "u1BEA", "u1BEB", "u1BEC", "u1BEE", "u1BF2", "u1BF3", "u1C24", "u1C25", "u1C26", "u1C27", "u1C28", "u1C29", "u1C2A", "u1C2B", "u1C34", "u1C35", "u1CE1", "u1CF2", "u1CF3", "u302E", "u302F", "uA823", "uA824", "uA827", "uA880", "uA881", "uA8B4", "uA8B5", "uA8B6", "uA8B7", "uA8B8", "uA8B9", "uA8BA", "uA8BB", "uA8BC", "uA8BD", "uA8BE", "uA8BF", "uA8C0", "uA8C1", "uA8C2", "uA8C3", "uA952", "uA953", "uA983", "uA9B4", "uA9B5", "uA9BA", "uA9BB", "uA9BD", "uA9BE", "uA9BF", "uA9C0", "uAA2F", "uAA30", "uAA33", "uAA34", "uAA4D", "uAA7B", "uAA7D", "uAAEB", "uAAEE", "uAAEF", "uAAF5", "uABE3", "uABE4", "uABE6", "uABE7", "uABE9", "uABEA", "uABEC"];
  var b = ["u0300", "u0301", "u0302", "u0303", "u0304", "u0305", "u0306", "u0307", "u0308", "u0309", "u030A", "u030B", "u030C", "u030D", "u030E", "u030F", "u0310", "u0311", "u0312", "u0313", "u0314", "u0315", "u0316", "u0317", "u0318", "u0319", "u031A", "u031B", "u031C", "u031D", "u031E", "u031F", "u0320", "u0321", "u0322", "u0323", "u0324", "u0325", "u0326", "u0327", "u0328", "u0329", "u032A", "u032B", "u032C", "u032D", "u032E", "u032F", "u0330", "u0331", "u0332", "u0333", "u0334", "u0335", "u0336", "u0337", "u0338", "u0339", "u033A", "u033B", "u033C", "u033D", "u033E", "u033F", "u0340", "u0341", "u0342", "u0343", "u0344", "u0345", "u0346", "u0347", "u0348", "u0349", "u034A", "u034B", "u034C", "u034D", "u034E", "u034F", "u0350", "u0351", "u0352", "u0353", "u0354", "u0355", "u0356", "u0357", "u0358", "u0359", "u035A", "u035B", "u035C", "u035D", "u035E", "u035F", "u0360", "u0361", "u0362", "u0363", "u0364", "u0365", "u0366", "u0367", "u0368", "u0369", "u036A", "u036B", "u036C", "u036D", "u036E", "u036F", "u0483", "u0484", "u0485", "u0486", "u0487", "u0591", "u0592", "u0593", "u0594", "u0595", "u0596", "u0597", "u0598", "u0599", "u059A", "u059B", "u059C", "u059D", "u059E", "u059F", "u05A0", "u05A1", "u05A2", "u05A3", "u05A4", "u05A5", "u05A6", "u05A7", "u05A8", "u05A9", "u05AA", "u05AB", "u05AC", "u05AD", "u05AE", "u05AF", "u05B0", "u05B1", "u05B2", "u05B3", "u05B4", "u05B5", "u05B6", "u05B7", "u05B8", "u05B9", "u05BA", "u05BB", "u05BC", "u05BD", "u05BF", "u05C1", "u05C2", "u05C4", "u05C5", "u05C7", "u0610", "u0611", "u0612", "u0613", "u0614", "u0615", "u0616", "u0617", "u0618", "u0619", "u061A", "u064B", "u064C", "u064D", "u064E", "u064F", "u0650", "u0651", "u0652", "u0653", "u0654", "u0655", "u0656", "u0657", "u0658", "u0659", "u065A", "u065B", "u065C", "u065D", "u065E", "u065F", "u0670", "u06D6", "u06D7", "u06D8", "u06D9", "u06DA", "u06DB", "u06DC", "u06DF", "u06E0", "u06E1", "u06E2", "u06E3", "u06E4", "u06E7", "u06E8", "u06EA", "u06EB", "u06EC", "u06ED", "u0711", "u0730", "u0731", "u0732", "u0733", "u0734", "u0735", "u0736", "u0737", "u0738", "u0739", "u073A", "u073B", "u073C", "u073D", "u073E", "u073F", "u0740", "u0741", "u0742", "u0743", "u0744", "u0745", "u0746", "u0747", "u0748", "u0749", "u074A", "u07A6", "u07A7", "u07A8", "u07A9", "u07AA", "u07AB", "u07AC", "u07AD", "u07AE", "u07AF", "u07B0", "u07EB", "u07EC", "u07ED", "u07EE", "u07EF", "u07F0", "u07F1", "u07F2", "u07F3", "u0816", "u0817", "u0818", "u0819", "u081B", "u081C", "u081D", "u081E", "u081F", "u0820", "u0821", "u0822", "u0823", "u0825", "u0826", "u0827", "u0829", "u082A", "u082B", "u082C", "u082D", "u0859", "u085A", "u085B", "u08E3", "u08E4", "u08E5", "u08E6", "u08E7", "u08E8", "u08E9", "u08EA", "u08EB", "u08EC", "u08ED", "u08EE", "u08EF", "u08F0", "u08F1", "u08F2", "u08F3", "u08F4", "u08F5", "u08F6", "u08F7", "u08F8", "u08F9", "u08FA", "u08FB", "u08FC", "u08FD", "u08FE", "u08FF", "u0900", "u0901", "u0902", "u093A", "u093C", "u0941", "u0942", "u0943", "u0944", "u0945", "u0946", "u0947", "u0948", "u094D", "u0951", "u0952", "u0953", "u0954", "u0955", "u0956", "u0957", "u0962", "u0963", "u0981", "u09BC", "u09C1", "u09C2", "u09C3", "u09C4", "u09CD", "u09E2", "u09E3", "u0A01", "u0A02", "u0A3C", "u0A41", "u0A42", "u0A47", "u0A48", "u0A4B", "u0A4C", "u0A4D", "u0A51", "u0A70", "u0A71", "u0A75", "u0A81", "u0A82", "u0ABC", "u0AC1", "u0AC2", "u0AC3", "u0AC4", "u0AC5", "u0AC7", "u0AC8", "u0ACD", "u0AE2", "u0AE3", "u0B01", "u0B3C", "u0B3F", "u0B41", "u0B42", "u0B43", "u0B44", "u0B4D", "u0B56", "u0B62", "u0B63", "u0B82", "u0BC0", "u0BCD", "u0C00", "u0C3E", "u0C3F", "u0C40", "u0C46", "u0C47", "u0C48", "u0C4A", "u0C4B", "u0C4C", "u0C4D", "u0C55", "u0C56", "u0C62", "u0C63", "u0C81", "u0CBC", "u0CBF", "u0CC6", "u0CCC", "u0CCD", "u0CE2", "u0CE3", "u0D01", "u0D41", "u0D42", "u0D43", "u0D44", "u0D4D", "u0D62", "u0D63", "u0DCA", "u0DD2", "u0DD3", "u0DD4", "u0DD6", "u0E31", "u0E34", "u0E35", "u0E36", "u0E37", "u0E38", "u0E39", "u0E3A", "u0E47", "u0E48", "u0E49", "u0E4A", "u0E4B", "u0E4C", "u0E4D", "u0E4E", "u0EB1", "u0EB4", "u0EB5", "u0EB6", "u0EB7", "u0EB8", "u0EB9", "u0EBB", "u0EBC", "u0EC8", "u0EC9", "u0ECA", "u0ECB", "u0ECC", "u0ECD", "u0F18", "u0F19", "u0F35", "u0F37", "u0F39", "u0F71", "u0F72", "u0F73", "u0F74", "u0F75", "u0F76", "u0F77", "u0F78", "u0F79", "u0F7A", "u0F7B", "u0F7C", "u0F7D", "u0F7E", "u0F80", "u0F81", "u0F82", "u0F83", "u0F84", "u0F86", "u0F87", "u0F8D", "u0F8E", "u0F8F", "u0F90", "u0F91", "u0F92", "u0F93", "u0F94", "u0F95", "u0F96", "u0F97", "u0F99", "u0F9A", "u0F9B", "u0F9C", "u0F9D", "u0F9E", "u0F9F", "u0FA0", "u0FA1", "u0FA2", "u0FA3", "u0FA4", "u0FA5", "u0FA6", "u0FA7", "u0FA8", "u0FA9", "u0FAA", "u0FAB", "u0FAC", "u0FAD", "u0FAE", "u0FAF", "u0FB0", "u0FB1", "u0FB2", "u0FB3", "u0FB4", "u0FB5", "u0FB6", "u0FB7", "u0FB8", "u0FB9", "u0FBA", "u0FBB", "u0FBC", "u0FC6", "u102D", "u102E", "u102F", "u1030", "u1032", "u1033", "u1034", "u1035", "u1036", "u1037", "u1039", "u103A", "u103D", "u103E", "u1058", "u1059", "u105E", "u105F", "u1060", "u1071", "u1072", "u1073", "u1074", "u1082", "u1085", "u1086", "u108D", "u109D", "u135D", "u135E", "u135F", "u1712", "u1713", "u1714", "u1732", "u1733", "u1734", "u1752", "u1753", "u1772", "u1773", "u17B4", "u17B5", "u17B7", "u17B8", "u17B9", "u17BA", "u17BB", "u17BC", "u17BD", "u17C6", "u17C9", "u17CA", "u17CB", "u17CC", "u17CD", "u17CE", "u17CF", "u17D0", "u17D1", "u17D2", "u17D3", "u17DD", "u180B", "u180C", "u180D", "u18A9", "u1920", "u1921", "u1922", "u1927", "u1928", "u1932", "u1939", "u193A", "u193B", "u1A17", "u1A18", "u1A1B", "u1A56", "u1A58", "u1A59", "u1A5A", "u1A5B", "u1A5C", "u1A5D", "u1A5E", "u1A60", "u1A62", "u1A65", "u1A66", "u1A67", "u1A68", "u1A69", "u1A6A", "u1A6B", "u1A6C", "u1A73", "u1A74", "u1A75", "u1A76", "u1A77", "u1A78", "u1A79", "u1A7A", "u1A7B", "u1A7C", "u1A7F", "u1AB0", "u1AB1", "u1AB2", "u1AB3", "u1AB4", "u1AB5", "u1AB6", "u1AB7", "u1AB8", "u1AB9", "u1ABA", "u1ABB", "u1ABC", "u1ABD", "u1B00", "u1B01", "u1B02", "u1B03", "u1B34", "u1B36", "u1B37", "u1B38", "u1B39", "u1B3A", "u1B3C", "u1B42", "u1B6B", "u1B6C", "u1B6D", "u1B6E", "u1B6F", "u1B70", "u1B71", "u1B72", "u1B73", "u1B80", "u1B81", "u1BA2", "u1BA3", "u1BA4", "u1BA5", "u1BA8", "u1BA9", "u1BAB", "u1BAC", "u1BAD", "u1BE6", "u1BE8", "u1BE9", "u1BED", "u1BEF", "u1BF0", "u1BF1", "u1C2C", "u1C2D", "u1C2E", "u1C2F", "u1C30", "u1C31", "u1C32", "u1C33", "u1C36", "u1C37", "u1CD0", "u1CD1", "u1CD2", "u1CD4", "u1CD5", "u1CD6", "u1CD7", "u1CD8", "u1CD9", "u1CDA", "u1CDB", "u1CDC", "u1CDD", "u1CDE", "u1CDF", "u1CE0", "u1CE2", "u1CE3", "u1CE4", "u1CE5", "u1CE6", "u1CE7", "u1CE8", "u1CED", "u1CF4", "u1CF8", "u1CF9", "u1DC0", "u1DC1", "u1DC2", "u1DC3", "u1DC4", "u1DC5", "u1DC6", "u1DC7", "u1DC8", "u1DC9", "u1DCA", "u1DCB", "u1DCC", "u1DCD", "u1DCE", "u1DCF", "u1DD0", "u1DD1", "u1DD2", "u1DD3", "u1DD4", "u1DD5", "u1DD6", "u1DD7", "u1DD8", "u1DD9", "u1DDA", "u1DDB", "u1DDC", "u1DDD", "u1DDE", "u1DDF", "u1DE0", "u1DE1", "u1DE2", "u1DE3", "u1DE4", "u1DE5", "u1DE6", "u1DE7", "u1DE8", "u1DE9", "u1DEA", "u1DEB", "u1DEC", "u1DED", "u1DEE", "u1DEF", "u1DF0", "u1DF1", "u1DF2", "u1DF3", "u1DF4", "u1DF5", "u1DFC", "u1DFD", "u1DFE", "u1DFF", "u20D0", "u20D1", "u20D2", "u20D3", "u20D4", "u20D5", "u20D6", "u20D7", "u20D8", "u20D9", "u20DA", "u20DB", "u20DC", "u20E1", "u20E5", "u20E6", "u20E7", "u20E8", "u20E9", "u20EA", "u20EB", "u20EC", "u20ED", "u20EE", "u20EF", "u20F0", "u2CEF", "u2CF0", "u2CF1", "u2D7F", "u2DE0", "u2DE1", "u2DE2", "u2DE3", "u2DE4", "u2DE5", "u2DE6", "u2DE7", "u2DE8", "u2DE9", "u2DEA", "u2DEB", "u2DEC", "u2DED", "u2DEE", "u2DEF", "u2DF0", "u2DF1", "u2DF2", "u2DF3", "u2DF4", "u2DF5", "u2DF6", "u2DF7", "u2DF8", "u2DF9", "u2DFA", "u2DFB", "u2DFC", "u2DFD", "u2DFE", "u2DFF", "u302A", "u302B", "u302C", "u302D", "u3099", "u309A", "uA66F", "uA674", "uA675", "uA676", "uA677", "uA678", "uA679", "uA67A", "uA67B", "uA67C", "uA67D", "uA69E", "uA69F", "uA6F0", "uA6F1", "uA802", "uA806", "uA80B", "uA825", "uA826", "uA8C4", "uA8E0", "uA8E1", "uA8E2", "uA8E3", "uA8E4", "uA8E5", "uA8E6", "uA8E7", "uA8E8", "uA8E9", "uA8EA", "uA8EB", "uA8EC", "uA8ED", "uA8EE", "uA8EF", "uA8F0", "uA8F1", "uA926", "uA927", "uA928", "uA929", "uA92A", "uA92B", "uA92C", "uA92D", "uA947", "uA948", "uA949", "uA94A", "uA94B", "uA94C", "uA94D", "uA94E", "uA94F", "uA950", "uA951", "uA980", "uA981", "uA982", "uA9B3", "uA9B6", "uA9B7", "uA9B8", "uA9B9", "uA9BC", "uA9E5", "uAA29", "uAA2A", "uAA2B", "uAA2C", "uAA2D", "uAA2E", "uAA31", "uAA32", "uAA35", "uAA36", "uAA43", "uAA4C", "uAA7C", "uAAB0", "uAAB2", "uAAB3", "uAAB4", "uAAB7", "uAAB8", "uAABE", "uAABF", "uAAC1", "uAAEC", "uAAED", "uAAF6", "uABE5", "uABE8", "uABED", "uFB1E", "uFE00", "uFE01", "uFE02", "uFE03", "uFE04", "uFE05", "uFE06", "uFE07", "uFE08", "uFE09", "uFE0A", "uFE0B", "uFE0C", "uFE0D", "uFE0E", "uFE0F", "uFE20", "uFE21", "uFE22", "uFE23", "uFE24", "uFE25", "uFE26", "uFE27", "uFE28", "uFE29", "uFE2A", "uFE2B", "uFE2C", "uFE2D", "uFE2E", "uFE2F"];
  var combiningMarks = a$1.concat(b);

  var splitChars = ["-", ";", ":", "&", "|", "u0E2F", // thai character pairannoi
  "u0EAF", // lao ellipsis
  "u0EC6", // lao ko la (word repetition)
  "u0ECC", // lao cancellation mark
  "u104A", // myanmar sign little section
  "u104B", // myanmar sign section
  "u104C", // myanmar symbol locative
  "u104D", // myanmar symbol completed
  "u104E", // myanmar symbol aforementioned
  "u104F", // myanmar symbol genitive
  "u2013", // en dash
  "u2014", // em dash
  "u2027", // simplified chinese hyphenation point
  "u3000", // simplified chinese ideographic space
  "u3001", // simplified chinese ideographic comma
  "u3002", // simplified chinese ideographic full stop
  "uFF0C", // full-width comma
  "uFF5E" // wave dash
  ];
  var prefixChars = ["'", "<", "(", "{", "[", "u00AB", // left-pointing double angle quotation mark
  "u300A", // left double angle bracket
  "u3008" // left angle bracket
  ];
  var suffixChars = ["'", ">", ")", "}", "]", ".", "!", "?", "/", "u00BB", // right-pointing double angle quotation mark
  "u300B", // right double angle bracket
  "u3009" // right angle bracket
  ].concat(splitChars);
  var burmeseRange = "\u1000-\u102A\u103F-\u1049\u1050-\u1055";
  var japaneseRange = "\u3040-\u309F\u30A0-\u30FF\uFF00-\uFF0B\uFF0D-\uFF5D\uFF5F-\uFF9F\u3400-\u4DBF";
  var chineseRange = "\u3400-\u9FBF";
  var laoRange = "\u0E81-\u0EAE\u0EB0-\u0EC4\u0EC8-\u0ECB\u0ECD-\u0EDD";
  var noSpaceRange = burmeseRange + chineseRange + japaneseRange + laoRange;
  var splitWords = new RegExp("(\\".concat(splitChars.join("|\\"), ")*[^\\s|\\").concat(splitChars.join("|\\"), "]*(\\").concat(splitChars.join("|\\"), ")*"), "g");
  var noSpaceLanguage = new RegExp("[".concat(noSpaceRange, "]"));
  var splitAllChars = new RegExp("(\\".concat(prefixChars.join("|\\"), ")*[").concat(noSpaceRange, "](\\").concat(suffixChars.join("|\\"), "|\\").concat(combiningMarks.join("|\\"), ")*|[a-z0-9]+"), "gi");
  /**
      @function textSplit
      @desc Splits a given sentence into an array of words.
      @param {String} sentence
  */

  function textSplit (sentence) {
    if (!noSpaceLanguage.test(sentence)) return stringify(sentence).match(splitWords).filter(function (w) {
      return w.length;
    });
    return merge(stringify(sentence).match(splitWords).map(function (d) {
      if (noSpaceLanguage.test(d)) return d.match(splitAllChars);
      return [d];
    }));
  }

  /**
      @function textWrap
      @desc Based on the defined styles and dimensions, breaks a string into an array of strings for each line of text.
  */

  function textWrap () {
    var fontFamily = "sans-serif",
        fontSize = 10,
        fontWeight = 400,
        height = 200,
        lineHeight,
        maxLines = null,
        overflow = false,
        split = textSplit,
        width = 200;
    /**
        The inner return object and wraps the text and returns the line data array.
        @private
    */

    function textWrap(sentence) {
      sentence = stringify(sentence);
      if (lineHeight === void 0) lineHeight = Math.ceil(fontSize * 1.4);
      var words = split(sentence);
      var style = {
        "font-family": fontFamily,
        "font-size": fontSize,
        "font-weight": fontWeight,
        "line-height": lineHeight
      };
      var line = 1,
          textProg = "",
          truncated = false,
          widthProg = 0;
      var lineData = [],
          sizes = textWidth(words, style),
          space = textWidth(" ", style);

      for (var i = 0; i < words.length; i++) {
        var word = words[i];
        var wordWidth = sizes[words.indexOf(word)];
        word += sentence.slice(textProg.length + word.length).match("^( |\n)*", "g")[0];

        if (textProg.slice(-1) === "\n" || widthProg + wordWidth > width) {
          if (!i && !overflow) {
            truncated = true;
            break;
          }

          if (lineData.length >= line) lineData[line - 1] = trimRight(lineData[line - 1]);
          line++;

          if (lineHeight * line > height || wordWidth > width && !overflow || maxLines && line > maxLines) {
            truncated = true;
            break;
          }

          widthProg = 0;
          lineData.push(word);
        } else if (!i) lineData[0] = word;else lineData[line - 1] += word;

        textProg += word;
        widthProg += wordWidth;
        widthProg += word.match(/[\s]*$/g)[0].length * space;
      }

      return {
        lines: lineData,
        sentence: sentence,
        truncated: truncated,
        widths: textWidth(lineData, style),
        words: words
      };
    }
    /**
        @memberof textWrap
        @desc If *value* is specified, sets the font family accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current font family.
        @param {Function|String} [*value* = "sans-serif"]
    */


    textWrap.fontFamily = function (_) {
      return arguments.length ? (fontFamily = _, textWrap) : fontFamily;
    };
    /**
        @memberof textWrap
        @desc If *value* is specified, sets the font size accessor to the specified function or number and returns this generator. If *value* is not specified, returns the current font size.
        @param {Function|Number} [*value* = 10]
    */


    textWrap.fontSize = function (_) {
      return arguments.length ? (fontSize = _, textWrap) : fontSize;
    };
    /**
        @memberof textWrap
        @desc If *value* is specified, sets the font weight accessor to the specified function or number and returns this generator. If *value* is not specified, returns the current font weight.
        @param {Function|Number|String} [*value* = 400]
    */


    textWrap.fontWeight = function (_) {
      return arguments.length ? (fontWeight = _, textWrap) : fontWeight;
    };
    /**
        @memberof textWrap
        @desc If *value* is specified, sets height limit to the specified value and returns this generator. If *value* is not specified, returns the current value.
        @param {Number} [*value* = 200]
    */


    textWrap.height = function (_) {
      return arguments.length ? (height = _, textWrap) : height;
    };
    /**
        @memberof textWrap
        @desc If *value* is specified, sets the line height accessor to the specified function or number and returns this generator. If *value* is not specified, returns the current line height accessor, which is 1.1 times the [font size](#textWrap.fontSize) by default.
        @param {Function|Number} [*value*]
    */


    textWrap.lineHeight = function (_) {
      return arguments.length ? (lineHeight = _, textWrap) : lineHeight;
    };
    /**
        @memberof textWrap
        @desc If *value* is specified, sets the maximum number of lines allowed when wrapping.
        @param {Function|Number} [*value*]
    */


    textWrap.maxLines = function (_) {
      return arguments.length ? (maxLines = _, textWrap) : maxLines;
    };
    /**
        @memberof textWrap
        @desc If *value* is specified, sets the overflow to the specified boolean and returns this generator. If *value* is not specified, returns the current overflow value.
        @param {Boolean} [*value* = false]
    */


    textWrap.overflow = function (_) {
      return arguments.length ? (overflow = _, textWrap) : overflow;
    };
    /**
        @memberof textWrap
        @desc If *value* is specified, sets the word split function to the specified function and returns this generator. If *value* is not specified, returns the current word split function.
        @param {Function} [*value*] A function that, when passed a string, is expected to return that string split into an array of words to textWrap. The default split function splits strings on the following characters: `-`, `/`, `;`, `:`, `&`
    */


    textWrap.split = function (_) {
      return arguments.length ? (split = _, textWrap) : split;
    };
    /**
        @memberof textWrap
        @desc If *value* is specified, sets width limit to the specified value and returns this generator. If *value* is not specified, returns the current value.
        @param {Number} [*value* = 200]
    */


    textWrap.width = function (_) {
      return arguments.length ? (width = _, textWrap) : width;
    };

    return textWrap;
  }

  function _typeof$4(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$4 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$4 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$4(obj);
  }

  function _classCallCheck$2(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$2(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$2(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$2(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$2(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn(self, call) {
    if (call && (_typeof$4(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized(self);
  }

  function _assertThisInitialized(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf(o) {
    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf(o);
  }

  function _inherits(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf(subClass, superClass);
  }

  function _setPrototypeOf(o, p) {
    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf(o, p);
  }
  var defaultHtmlLookup = {
    i: "font-style: italic;",
    em: "font-style: italic;",
    b: "font-weight: bold;",
    strong: "font-weight: bold;"
  };
  /**
      @class TextBox
      @extends external:BaseClass
      @desc Creates a wrapped text box for each point in an array of data. See [this example](https://d3plus.org/examples/d3plus-text/getting-started/) for help getting started using the TextBox class.
  */

  var TextBox =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits(TextBox, _BaseClass);
    /**
        @memberof TextBox
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function TextBox() {
      var _this;

      _classCallCheck$2(this, TextBox);

      _this = _possibleConstructorReturn(this, _getPrototypeOf(TextBox).call(this));
      _this._ariaHidden = constant$3("false");
      _this._delay = 0;
      _this._duration = 0;

      _this._ellipsis = function (text, line) {
        return line ? "".concat(text.replace(/\.|,$/g, ""), "...") : "";
      };

      _this._fontColor = constant$3("black");
      _this._fontFamily = constant$3(["Roboto", "Helvetica Neue", "HelveticaNeue", "Helvetica", "Arial", "sans-serif"]);
      _this._fontMax = constant$3(50);
      _this._fontMin = constant$3(8);
      _this._fontOpacity = constant$3(1);
      _this._fontResize = constant$3(false);
      _this._fontSize = constant$3(10);
      _this._fontWeight = constant$3(400);
      _this._height = accessor("height", 200);
      _this._html = defaultHtmlLookup;

      _this._id = function (d, i) {
        return d.id || "".concat(i);
      };

      _this._lineHeight = function (d, i) {
        return _this._fontSize(d, i) * 1.2;
      };

      _this._maxLines = constant$3(null);
      _this._on = {};
      _this._overflow = constant$3(false);
      _this._padding = constant$3(0);
      _this._pointerEvents = constant$3("auto");
      _this._rotate = constant$3(0);

      _this._rotateAnchor = function (d) {
        return [d.w / 2, d.h / 2];
      };

      _this._split = textSplit;
      _this._text = accessor("text");
      _this._textAnchor = constant$3("start");
      _this._verticalAlign = constant$3("top");
      _this._width = accessor("width", 200);
      _this._x = accessor("x", 0);
      _this._y = accessor("y", 0);
      return _this;
    }
    /**
        @memberof TextBox
        @desc Renders the text boxes. If a *callback* is specified, it will be called once the shapes are done drawing.
        @param {Function} [*callback* = undefined]
    */


    _createClass$2(TextBox, [{
      key: "render",
      value: function render(callback) {
        var _this2 = this;

        if (this._select === void 0) this.select(_select("body").append("svg").style("width", "".concat(window.innerWidth, "px")).style("height", "".concat(window.innerHeight, "px")).node());
        var that = this;

        var boxes = this._select.selectAll(".d3plus-textBox").data(this._data.reduce(function (arr, d, i) {
          var t = _this2._text(d, i);

          if (t === void 0) return arr;
          t = trim(t);

          var resize = _this2._fontResize(d, i);

          var lHRatio = _this2._lineHeight(d, i) / _this2._fontSize(d, i);

          var fS = resize ? _this2._fontMax(d, i) : _this2._fontSize(d, i),
              lH = resize ? fS * lHRatio : _this2._lineHeight(d, i),
              line = 1,
              lineData = [],
              sizes,
              wrapResults;
          var style = {
            "font-family": fontExists(_this2._fontFamily(d, i)),
            "font-size": fS,
            "font-weight": _this2._fontWeight(d, i),
            "line-height": lH
          };
          var padding = parseSides(_this2._padding(d, i));
          var h = _this2._height(d, i) - (padding.top + padding.bottom),
              w = _this2._width(d, i) - (padding.left + padding.right);
          var wrapper = textWrap().fontFamily(style["font-family"]).fontSize(fS).fontWeight(style["font-weight"]).lineHeight(lH).maxLines(_this2._maxLines(d, i)).height(h).overflow(_this2._overflow(d, i)).width(w).split(_this2._split);

          var fMax = _this2._fontMax(d, i),
              fMin = _this2._fontMin(d, i),
              vA = _this2._verticalAlign(d, i),
              words = _this2._split(t, i);
          /**
              Figures out the lineData to be used for wrapping.
              @private
          */


          function checkSize() {
            var truncate = function truncate() {
              if (line < 1) lineData = [that._ellipsis("", line)];else lineData[line - 1] = that._ellipsis(lineData[line - 1], line);
            }; // Constraint the font size


            fS = max([fS, fMin]);
            fS = min([fS, fMax]);

            if (resize) {
              lH = fS * lHRatio;
              wrapper.fontSize(fS).lineHeight(lH);
              style["font-size"] = fS;
              style["line-height"] = lH;
            }

            wrapResults = wrapper(t);
            lineData = wrapResults.lines.filter(function (l) {
              return l !== "";
            });
            line = lineData.length;

            if (wrapResults.truncated) {
              if (resize) {
                fS--;

                if (fS < fMin) {
                  fS = fMin;
                  truncate();
                  return;
                } else checkSize();
              } else truncate();
            }
          }

          if (w > fMin && (h > lH || resize && h > fMin * lHRatio)) {
            if (resize) {
              sizes = textWidth(words, style);
              var areaMod = 1.165 + w / h * 0.1,
                  boxArea = w * h,
                  maxWidth = max(sizes),
                  textArea = sum(sizes, function (d) {
                return d * lH;
              }) * areaMod;

              if (maxWidth > w || textArea > boxArea) {
                var areaRatio = Math.sqrt(boxArea / textArea),
                    widthRatio = w / maxWidth;
                var sizeRatio = min([areaRatio, widthRatio]);
                fS = Math.floor(fS * sizeRatio);
              }

              var heightMax = Math.floor(h * 0.8);
              if (fS > heightMax) fS = heightMax;
            }

            checkSize();
          }

          if (lineData.length) {
            var tH = line * lH;

            var r = _this2._rotate(d, i);

            var yP = r === 0 ? vA === "top" ? 0 : vA === "middle" ? h / 2 - tH / 2 : h - tH : 0;
            yP -= lH * 0.1;
            arr.push({
              aH: _this2._ariaHidden(d, i),
              data: d,
              i: i,
              lines: lineData,
              fC: _this2._fontColor(d, i),
              fF: style["font-family"],
              fO: _this2._fontOpacity(d, i),
              fW: style["font-weight"],
              id: _this2._id(d, i),
              tA: _this2._textAnchor(d, i),
              vA: _this2._verticalAlign(d, i),
              widths: wrapResults.widths,
              fS: fS,
              lH: lH,
              w: w,
              h: h,
              r: r,
              x: _this2._x(d, i) + padding.left,
              y: _this2._y(d, i) + yP + padding.top
            });
          }

          return arr;
        }, []), function (d) {
          return _this2._id(d.data, d.i);
        });

        var t = transition().duration(this._duration);

        if (this._duration === 0) {
          boxes.exit().remove();
        } else {
          boxes.exit().transition().delay(this._duration).remove();
          boxes.exit().selectAll("text").transition(t).attr("opacity", 0).style("opacity", 0);
        }
        /**
         * Applies translate and rotate to a text element.
         * @param {D3Selection} text
         * @private
         */


        function rotate(text) {
          text.attr("transform", function (d, i) {
            var rotateAnchor = that._rotateAnchor(d, i);

            return "translate(".concat(d.x, ", ").concat(d.y, ") rotate(").concat(d.r, ", ").concat(rotateAnchor[0], ", ").concat(rotateAnchor[1], ")");
          });
        }

        var update = boxes.enter().append("g").attr("class", "d3plus-textBox").attr("id", function (d) {
          return "d3plus-textBox-".concat(strip(d.id));
        }).call(rotate).merge(boxes);
        var rtl = detectRTL();
        update.style("pointer-events", function (d) {
          return _this2._pointerEvents(d.data, d.i);
        }).each(function (d) {
          /**
              Sets the inner text content of each <text> element.
              @private
          */
          function textContent(text) {
            text[that._html ? "html" : "text"](function (t) {
              return trimRight(t).replace(/&([^\;&]*)/g, function (str, a) {
                return a === "amp" ? str : "&amp;".concat(a);
              }) // replaces all non-HTML ampersands with escaped entity
              .replace(/<([^A-z^/]+)/g, function (str, a) {
                return "&lt;".concat(a);
              }).replace(/<$/g, "&lt;") // replaces all non-HTML left angle brackets with escaped entity
              .replace(/(<[^>^\/]+>)([^<^>]+)$/g, function (str, a, b) {
                return "".concat(a).concat(b).concat(a.replace("<", "</"));
              }) // ands end tag to lines before mid-HTML break
              .replace(/^([^<^>]+)(<\/[^>]+>)/g, function (str, a, b) {
                return "".concat(b.replace("</", "<")).concat(a).concat(b);
              }) // ands start tag to lines after mid-HTML break
              .replace(/<([A-z]+)[^>]*>([^<^>]+)<\/[^>]+>/g, function (str, a, b) {
                var tag = that._html[a] ? "<tspan style=\"".concat(that._html[a], "\">") : "";
                return "".concat(tag.length ? tag : "").concat(b).concat(tag.length ? "</tspan>" : "");
              });
            });
          }
          /**
              Styles to apply to each <text> element.
              @private
          */


          function textStyle(text) {
            text.attr("aria-hidden", d.aH).attr("dir", rtl ? "rtl" : "ltr").attr("fill", d.fC).attr("text-anchor", d.tA).attr("font-family", d.fF).style("font-family", d.fF).attr("font-size", "".concat(d.fS, "px")).style("font-size", "".concat(d.fS, "px")).attr("font-weight", d.fW).style("font-weight", d.fW).attr("x", "".concat(d.tA === "middle" ? d.w / 2 : rtl ? d.tA === "start" ? d.w : 0 : d.tA === "end" ? d.w : 2 * Math.sin(Math.PI * d.r / 180), "px")).attr("y", function (t, i) {
              return d.r === 0 || d.vA === "top" ? "".concat((i + 1) * d.lH - (d.lH - d.fS), "px") : d.vA === "middle" ? "".concat((d.h + d.fS) / 2 - (d.lH - d.fS) + (i - d.lines.length / 2 + 0.5) * d.lH, "px") : "".concat(d.h - 2 * (d.lH - d.fS) - (d.lines.length - (i + 1)) * d.lH + 2 * Math.cos(Math.PI * d.r / 180), "px");
            });
          }

          var texts = _select(this).selectAll("text").data(d.lines);

          if (that._duration === 0) {
            texts.call(textContent).call(textStyle);
            texts.exit().remove();
            texts.enter().append("text").attr("dominant-baseline", "alphabetic").style("baseline-shift", "0%").attr("unicode-bidi", "bidi-override").call(textContent).call(textStyle).attr("opacity", d.fO).style("opacity", d.fO);
          } else {
            texts.call(textContent).transition(t).call(textStyle);
            texts.exit().transition(t).attr("opacity", 0).remove();
            texts.enter().append("text").attr("dominant-baseline", "alphabetic").style("baseline-shift", "0%").attr("opacity", 0).style("opacity", 0).call(textContent).call(textStyle).merge(texts).transition(t).delay(that._delay).call(textStyle).attr("opacity", d.fO).style("opacity", d.fO);
          }
        }).transition(t).call(rotate);
        var events = Object.keys(this._on),
            on = events.reduce(function (obj, e) {
          obj[e] = function (d, i) {
            return _this2._on[e](d.data, i);
          };

          return obj;
        }, {});

        for (var e = 0; e < events.length; e++) {
          update.on(events[e], on[events[e]]);
        }

        if (callback) setTimeout(callback, this._duration + 100);
        return this;
      }
      /**
          @memberof TextBox
          @desc If *value* is specified, sets the aria-hidden attribute to the specified function or string and returns the current class instance.
          @param {Function|String} *value*
          @chainable
      */

    }, {
      key: "ariaHidden",
      value: function ariaHidden(_) {
        return _ !== undefined ? (this._ariaHidden = typeof _ === "function" ? _ : constant$3(_), this) : this._ariaHidden;
      }
      /**
          @memberof TextBox
          @desc Sets the data array to the specified array. A text box will be drawn for each object in the array.
          @param {Array} [*data* = []]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof TextBox
          @desc Sets the animation delay to the specified number in milliseconds.
          @param {Number} [*value* = 0]
          @chainable
      */

    }, {
      key: "delay",
      value: function delay(_) {
        return arguments.length ? (this._delay = _, this) : this._delay;
      }
      /**
          @memberof TextBox
          @desc Sets the animation duration to the specified number in milliseconds.
          @param {Number} [*value* = 0]
          @chainable
      */

    }, {
      key: "duration",
      value: function duration(_) {
        return arguments.length ? (this._duration = _, this) : this._duration;
      }
      /**
          @memberof TextBox
          @desc Sets the function that handles what to do when a line is truncated. It should return the new value for the line, and is passed 2 arguments: the String of text for the line in question, and the number of the line. By default, an ellipsis is added to the end of any line except if it is the first word that cannot fit (in that case, an empty string is returned).
          @param {Function|String} [*value*]
          @chainable
          @example <caption>default accessor</caption>
      function(text, line) {
      return line ? text.replace(/\.|,$/g, "") + "..." : "";
      }
      */

    }, {
      key: "ellipsis",
      value: function ellipsis(_) {
        return arguments.length ? (this._ellipsis = typeof _ === "function" ? _ : constant$3(_), this) : this._ellipsis;
      }
      /**
          @memberof TextBox
          @desc Sets the font color to the specified accessor function or static string, which is inferred from the [DOM selection](#textBox.select) by default.
          @param {Function|String} [*value* = "black"]
          @chainable
      */

    }, {
      key: "fontColor",
      value: function fontColor(_) {
        return arguments.length ? (this._fontColor = typeof _ === "function" ? _ : constant$3(_), this) : this._fontColor;
      }
      /**
          @memberof TextBox
          @desc Defines the font-family to be used. The value passed can be either a *String* name of a font, a comma-separated list of font-family fallbacks, an *Array* of fallbacks, or a *Function* that returns either a *String* or an *Array*. If supplying multiple fallback fonts, the [fontExists](#fontExists) function will be used to determine the first available font on the client's machine.
          @param {Array|Function|String} [*value* = ["Roboto", "Helvetica Neue", "HelveticaNeue", "Helvetica", "Arial", "sans-serif"]]
          @chainable
      */

    }, {
      key: "fontFamily",
      value: function fontFamily(_) {
        return arguments.length ? (this._fontFamily = typeof _ === "function" ? _ : constant$3(_), this) : this._fontFamily;
      }
      /**
          @memberof TextBox
          @desc Sets the maximum font size to the specified accessor function or static number (which corresponds to pixel units), which is used when [dynamically resizing fonts](#textBox.fontResize).
          @param {Function|Number} [*value* = 50]
          @chainable
      */

    }, {
      key: "fontMax",
      value: function fontMax(_) {
        return arguments.length ? (this._fontMax = typeof _ === "function" ? _ : constant$3(_), this) : this._fontMax;
      }
      /**
          @memberof TextBox
          @desc Sets the minimum font size to the specified accessor function or static number (which corresponds to pixel units), which is used when [dynamically resizing fonts](#textBox.fontResize).
          @param {Function|Number} [*value* = 8]
          @chainable
      */

    }, {
      key: "fontMin",
      value: function fontMin(_) {
        return arguments.length ? (this._fontMin = typeof _ === "function" ? _ : constant$3(_), this) : this._fontMin;
      }
      /**
          @memberof TextBox
          @desc Sets the font opacity to the specified accessor function or static number between 0 and 1.
          @param {Function|Number} [*value* = 1]
          @chainable
       */

    }, {
      key: "fontOpacity",
      value: function fontOpacity(_) {
        return arguments.length ? (this._fontOpacity = typeof _ === "function" ? _ : constant$3(_), this) : this._fontOpacity;
      }
      /**
          @memberof TextBox
          @desc Toggles font resizing, which can either be defined as a static boolean for all data points, or an accessor function that returns a boolean. See [this example](http://d3plus.org/examples/d3plus-text/resizing-text/) for a side-by-side comparison.
          @param {Function|Boolean} [*value* = false]
          @chainable
      */

    }, {
      key: "fontResize",
      value: function fontResize(_) {
        return arguments.length ? (this._fontResize = typeof _ === "function" ? _ : constant$3(_), this) : this._fontResize;
      }
      /**
          @memberof TextBox
          @desc Sets the font size to the specified accessor function or static number (which corresponds to pixel units), which is inferred from the [DOM selection](#textBox.select) by default.
          @param {Function|Number} [*value* = 10]
          @chainable
      */

    }, {
      key: "fontSize",
      value: function fontSize(_) {
        return arguments.length ? (this._fontSize = typeof _ === "function" ? _ : constant$3(_), this) : this._fontSize;
      }
      /**
          @memberof TextBox
          @desc Sets the font weight to the specified accessor function or static number, which is inferred from the [DOM selection](#textBox.select) by default.
          @param {Function|Number|String} [*value* = 400]
          @chainable
      */

    }, {
      key: "fontWeight",
      value: function fontWeight(_) {
        return arguments.length ? (this._fontWeight = typeof _ === "function" ? _ : constant$3(_), this) : this._fontWeight;
      }
      /**
          @memberof TextBox
          @desc Sets the height for each box to the specified accessor function or static number.
          @param {Function|Number} [*value*]
          @chainable
          @example <caption>default accessor</caption>
      function(d) {
      return d.height || 200;
      }
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = typeof _ === "function" ? _ : constant$3(_), this) : this._height;
      }
      /**
          @memberof TextBox
          @desc Configures the ability to render simple HTML tags. Defaults to supporting `<b>`, `<strong>`, `<i>`, and `<em>`, set to false to disable or provide a mapping of tags to svg styles
          @param {Object|Boolean} [*value* = {
                    i: 'font-style: italic;',
                    em: 'font-style: italic;',
                    b: 'font-weight: bold;',
                    strong: 'font-weight: bold;'
                }]
          @chainable
      */

    }, {
      key: "html",
      value: function html(_) {
        return arguments.length ? (this._html = typeof _ === "boolean" ? _ ? defaultHtmlLookup : false : _, this) : this._html;
      }
      /**
          @memberof TextBox
          @desc Defines the unique id for each box to the specified accessor function or static number.
          @param {Function|Number} [*value*]
          @chainable
          @example <caption>default accessor</caption>
      function(d, i) {
      return d.id || i + "";
      }
      */

    }, {
      key: "id",
      value: function id(_) {
        return arguments.length ? (this._id = typeof _ === "function" ? _ : constant$3(_), this) : this._id;
      }
      /**
          @memberof TextBox
          @desc Sets the line height to the specified accessor function or static number, which is 1.2 times the [font size](#textBox.fontSize) by default.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "lineHeight",
      value: function lineHeight(_) {
        return arguments.length ? (this._lineHeight = typeof _ === "function" ? _ : constant$3(_), this) : this._lineHeight;
      }
      /**
          @memberof TextBox
          @desc Restricts the maximum number of lines to wrap onto, which is null (unlimited) by default.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "maxLines",
      value: function maxLines(_) {
        return arguments.length ? (this._maxLines = typeof _ === "function" ? _ : constant$3(_), this) : this._maxLines;
      }
      /**
          @memberof TextBox
          @desc Sets the text overflow to the specified accessor function or static boolean.
          @param {Function|Boolean} [*value* = false]
          @chainable
      */

    }, {
      key: "overflow",
      value: function overflow(_) {
        return arguments.length ? (this._overflow = typeof _ === "function" ? _ : constant$3(_), this) : this._overflow;
      }
      /**
          @memberof TextBox
          @desc Sets the padding to the specified accessor function, CSS shorthand string, or static number, which is 0 by default.
          @param {Function|Number|String} [*value*]
          @chainable
      */

    }, {
      key: "padding",
      value: function padding(_) {
        return arguments.length ? (this._padding = typeof _ === "function" ? _ : constant$3(_), this) : this._padding;
      }
      /**
          @memberof TextBox
          @desc Sets the pointer-events to the specified accessor function or static string.
          @param {Function|String} [*value* = "auto"]
          @chainable
      */

    }, {
      key: "pointerEvents",
      value: function pointerEvents(_) {
        return arguments.length ? (this._pointerEvents = typeof _ === "function" ? _ : constant$3(_), this) : this._pointerEvents;
      }
      /**
          @memberof TextBox
          @desc Sets the rotate percentage for each box to the specified accessor function or static string.
          @param {Function|Number} [*value* = 0]
          @chainable
      */

    }, {
      key: "rotate",
      value: function rotate(_) {
        return arguments.length ? (this._rotate = typeof _ === "function" ? _ : constant$3(_), this) : this._rotate;
      }
      /**
          @memberof TextBox
          @desc Sets the anchor point around which to rotate the text box.
          @param {Function|Number[]}
          @chainable
       */

    }, {
      key: "rotateAnchor",
      value: function rotateAnchor(_) {
        return arguments.length ? (this._rotateAnchor = typeof _ === "function" ? _ : constant$3(_), this) : this._rotateAnchor;
      }
      /**
          @memberof TextBox
          @desc Sets the SVG container element to the specified d3 selector or DOM element. If not explicitly specified, an SVG element will be added to the page for use.
          @param {String|HTMLElement} [*selector*]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
          @memberof TextBox
          @desc Sets the word split behavior to the specified function, which when passed a string is expected to return that string split into an array of words.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "split",
      value: function split(_) {
        return arguments.length ? (this._split = _, this) : this._split;
      }
      /**
          @memberof TextBox
          @desc Sets the text for each box to the specified accessor function or static string.
          @param {Function|String} [*value*]
          @chainable
          @example <caption>default accessor</caption>
      function(d) {
      return d.text;
      }
      */

    }, {
      key: "text",
      value: function text(_) {
        return arguments.length ? (this._text = typeof _ === "function" ? _ : constant$3(_), this) : this._text;
      }
      /**
          @memberof TextBox
          @desc Sets the horizontal text anchor to the specified accessor function or static string, whose values are analagous to the SVG [text-anchor](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/text-anchor) property.
          @param {Function|String} [*value* = "start"]
          @chainable
      */

    }, {
      key: "textAnchor",
      value: function textAnchor(_) {
        return arguments.length ? (this._textAnchor = typeof _ === "function" ? _ : constant$3(_), this) : this._textAnchor;
      }
      /**
          @memberof TextBox
          @desc Sets the vertical alignment to the specified accessor function or static string. Accepts `"top"`, `"middle"`, and `"bottom"`.
          @param {Function|String} [*value* = "top"]
          @chainable
      */

    }, {
      key: "verticalAlign",
      value: function verticalAlign(_) {
        return arguments.length ? (this._verticalAlign = typeof _ === "function" ? _ : constant$3(_), this) : this._verticalAlign;
      }
      /**
          @memberof TextBox
          @desc Sets the width for each box to the specified accessor function or static number.
          @param {Function|Number} [*value*]
          @chainable
          @example <caption>default accessor</caption>
      function(d) {
      return d.width || 200;
      }
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = typeof _ === "function" ? _ : constant$3(_), this) : this._width;
      }
      /**
          @memberof TextBox
          @desc Sets the x position for each box to the specified accessor function or static number. The number given should correspond to the left side of the textBox.
          @param {Function|Number} [*value*]
          @chainable
          @example <caption>default accessor</caption>
      function(d) {
      return d.x || 0;
      }
      */

    }, {
      key: "x",
      value: function x(_) {
        return arguments.length ? (this._x = typeof _ === "function" ? _ : constant$3(_), this) : this._x;
      }
      /**
          @memberof TextBox
          @desc Sets the y position for each box to the specified accessor function or static number. The number given should correspond to the top side of the textBox.
          @param {Function|Number} [*value*]
          @chainable
          @example <caption>default accessor</caption>
      function(d) {
      return d.y || 0;
      }
      */

    }, {
      key: "y",
      value: function y(_) {
        return arguments.length ? (this._y = typeof _ === "function" ? _ : constant$3(_), this) : this._y;
      }
    }]);

    return TextBox;
  }(BaseClass);

  var lowercase = ["a", "an", "and", "as", "at", "but", "by", "for", "from", "if", "in", "into", "near", "nor", "of", "on", "onto", "or", "per", "that", "the", "to", "with", "via", "vs", "vs."];
  var uppercase = ["CEO", "CFO", "CNC", "COO", "CPU", "GDP", "HVAC", "ID", "IT", "R&D", "TV", "UI"];
  /**
      @function titleCase
      @desc Capitalizes the first letter of each word in a phrase/sentence.
      @param {String} str The string to apply the title case logic.
  */

  function titleCase (str) {
    if (str === void 0) return "";
    var smalls = lowercase.map(function (s) {
      return s.toLowerCase();
    });
    var bigs = uppercase.slice();
    bigs = bigs.concat(bigs.map(function (b) {
      return "".concat(b, "s");
    }));
    var biglow = bigs.map(function (b) {
      return b.toLowerCase();
    });
    var split = textSplit(str);
    return split.map(function (s, i) {
      if (s) {
        var lower = s.toLowerCase();
        var stripped = suffixChars.includes(lower.charAt(lower.length - 1)) ? lower.slice(0, -1) : lower;
        var bigindex = biglow.indexOf(stripped);
        if (bigindex >= 0) return bigs[bigindex];else if (smalls.includes(stripped) && i !== 0 && i !== split.length - 1) return lower;else return s.charAt(0).toUpperCase() + s.substr(1).toLowerCase();
      } else return "";
    }).reduce(function (ret, s, i) {
      if (i && str.charAt(ret.length) === " ") ret += " ";
      ret += s;
      return ret;
    }, "");
  }

  /**
      @function pointDistanceSquared
      @desc Returns the squared euclidean distance between two points.
      @param {Array} p1 The first point, which should always be an `[x, y]` formatted Array.
      @param {Array} p2 The second point, which should always be an `[x, y]` formatted Array.
      @returns {Number}
  */
  var pointDistanceSquared = (function (p1, p2) {
    var dx = p2[0] - p1[0],
        dy = p2[1] - p1[1];
    return dx * dx + dy * dy;
  });

  /**
      @function pointDistance
      @desc Calculates the pixel distance between two points.
      @param {Array} p1 The first point, which should always be an `[x, y]` formatted Array.
      @param {Array} p2 The second point, which should always be an `[x, y]` formatted Array.
      @returns {Number}
  */

  var pointDistance = (function (p1, p2) {
    return Math.sqrt(pointDistanceSquared(p1, p2));
  });

  function _typeof$5(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$5 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$5 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$5(obj);
  }

  function _classCallCheck$3(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$3(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$3(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$3(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$3(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$1(self, call) {
    if (call && (_typeof$5(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$1(self);
  }

  function _assertThisInitialized$1(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$1(o) {
    _getPrototypeOf$1 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$1(o);
  }

  function _inherits$1(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$1(subClass, superClass);
  }

  function _setPrototypeOf$1(o, p) {
    _setPrototypeOf$1 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$1(o, p);
  }
  /**
      @class Shape
      @extends external:BaseClass
      @desc An abstracted class for generating shapes.
  */

  var Shape =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$1(Shape, _BaseClass);
    /**
        @memberof Shape
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Shape() {
      var _this;

      var tagName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "g";

      _classCallCheck$3(this, Shape);

      _this = _possibleConstructorReturn$1(this, _getPrototypeOf$1(Shape).call(this));
      _this._activeOpacity = 0.25;
      _this._activeStyle = {
        "stroke": function stroke(d, i) {
          var c = _this._fill(d, i);

          if (["transparent", "none"].includes(c)) c = _this._stroke(d, i);
          return color$1(c).darker(1);
        },
        "stroke-width": function strokeWidth(d, i) {
          var s = _this._strokeWidth(d, i) || 1;
          return s * 3;
        }
      };
      _this._ariaLabel = constant$3("");
      _this._backgroundImage = constant$3(false);
      _this._backgroundImageClass = new Image$1();
      _this._data = [];
      _this._duration = 600;
      _this._fill = constant$3("black");
      _this._fillOpacity = constant$3(1);
      _this._hoverOpacity = 0.5;
      _this._hoverStyle = {
        "stroke": function stroke(d, i) {
          var c = _this._fill(d, i);

          if (["transparent", "none"].includes(c)) c = _this._stroke(d, i);
          return color$1(c).darker(0.5);
        },
        "stroke-width": function strokeWidth(d, i) {
          var s = _this._strokeWidth(d, i) || 1;
          return s * 2;
        }
      };

      _this._id = function (d, i) {
        return d.id !== void 0 ? d.id : i;
      };

      _this._label = constant$3(false);
      _this._labelClass = new TextBox();
      _this._labelConfig = {
        fontColor: function fontColor(d, i) {
          return colorContrast(_this._fill(d, i));
        },
        fontSize: 12,
        padding: 5
      };
      _this._name = "Shape";
      _this._opacity = constant$3(1);
      _this._pointerEvents = constant$3("visiblePainted");
      _this._role = constant$3("presentation");
      _this._rotate = constant$3(0);
      _this._rx = constant$3(0);
      _this._ry = constant$3(0);
      _this._scale = constant$3(1);
      _this._shapeRendering = constant$3("geometricPrecision");

      _this._stroke = function (d, i) {
        return color$1(_this._fill(d, i)).darker(1);
      };

      _this._strokeDasharray = constant$3("0");
      _this._strokeLinecap = constant$3("butt");
      _this._strokeOpacity = constant$3(1);
      _this._strokeWidth = constant$3(0);
      _this._tagName = tagName;
      _this._textAnchor = constant$3("start");
      _this._vectorEffect = constant$3("non-scaling-stroke");
      _this._verticalAlign = constant$3("top");
      _this._x = accessor("x", 0);
      _this._y = accessor("y", 0);
      return _this;
    }
    /**
        @memberof Shape
        @desc Given a specific data point and index, returns the aesthetic properties of the shape.
        @param {Object} *data point*
        @param {Number} *index*
        @private
    */


    _createClass$3(Shape, [{
      key: "_aes",
      value: function _aes() {
        return {};
      }
      /**
          @memberof Shape
          @desc Adds event listeners to each shape group or hit area.
          @param {D3Selection} *update* The update cycle of the data binding.
          @private
      */

    }, {
      key: "_applyEvents",
      value: function _applyEvents(handler) {
        var _this2 = this;

        var events = Object.keys(this._on);

        var _loop = function _loop(e) {
          handler.on(events[e], function (d, i) {
            if (!_this2._on[events[e]]) return;
            if (d.i !== void 0) i = d.i;

            if (d.nested && d.values) {
              var cursor = mouse(_this2._select.node()),
                  values = d.values.map(function (d) {
                return pointDistance(cursor, [_this2._x(d, i), _this2._y(d, i)]);
              });
              d = d.values[values.indexOf(min(values))];
            }

            _this2._on[events[e]].bind(_this2)(d, i);
          });
        };

        for (var e = 0; e < events.length; e++) {
          _loop(e);
        }
      }
      /**
          @memberof Shape
          @desc Provides the updated styling to the given shape elements.
          @param {HTMLElement} *elem*
          @param {Object} *style*
          @private
      */

    }, {
      key: "_updateStyle",
      value: function _updateStyle(elem, style) {
        var that = this;
        if (elem.size() && elem.node().tagName === "g") elem = elem.selectAll("*");
        /**
            @desc Determines whether a shape is a nested collection of data points, and uses the appropriate data and index for the given function context.
            @param {Object} *d* data point
            @param {Number} *i* index
            @private
        */

        function styleLogic(d, i) {
          return typeof this !== "function" ? this : d.nested && d.key && d.values ? this(d.values[0], that._data.indexOf(d.values[0])) : this(d, i);
        }

        var styleObject = {};

        for (var key in style) {
          if ({}.hasOwnProperty.call(style, key)) {
            styleObject[key] = styleLogic.bind(style[key]);
          }
        }

        elem.transition().duration(0).call(attrize, styleObject);
      }
      /**
          @memberof Shape
          @desc Provides the default styling to the shape elements.
          @param {HTMLElement} *elem*
          @private
      */

    }, {
      key: "_applyStyle",
      value: function _applyStyle(elem) {
        var that = this;
        if (elem.size() && elem.node().tagName === "g") elem = elem.selectAll("*");
        /**
            @desc Determines whether a shape is a nested collection of data points, and uses the appropriate data and index for the given function context.
            @param {Object} *d* data point
            @param {Number} *i* index
            @private
        */

        function styleLogic(d, i) {
          return typeof this !== "function" ? this : d.nested && d.key && d.values ? this(d.values[0], that._data.indexOf(d.values[0])) : this(d, i);
        }

        elem.attr("fill", styleLogic.bind(this._fill)).attr("fill-opacity", styleLogic.bind(this._fillOpacity)).attr("rx", styleLogic.bind(this._rx)).attr("ry", styleLogic.bind(this._ry)).attr("stroke", styleLogic.bind(this._stroke)).attr("stroke-dasharray", styleLogic.bind(this._strokeDasharray)).attr("stroke-linecap", styleLogic.bind(this._strokeLinecap)).attr("stroke-opacity", styleLogic.bind(this._strokeOpacity)).attr("stroke-width", styleLogic.bind(this._strokeWidth)).attr("vector-effect", styleLogic.bind(this._vectorEffect));
      }
      /**
          @memberof Shape
          @desc Calculates the transform for the group elements.
          @param {HTMLElement} *elem*
          @private
      */

    }, {
      key: "_applyTransform",
      value: function _applyTransform(elem) {
        var _this3 = this;

        elem.attr("transform", function (d, i) {
          return "\n        translate(".concat(d.__d3plusShape__ ? d.translate ? d.translate : "".concat(_this3._x(d.data, d.i), ",").concat(_this3._y(d.data, d.i)) : "".concat(_this3._x(d, i), ",").concat(_this3._y(d, i)), ")\n        scale(").concat(d.__d3plusShape__ ? d.scale || _this3._scale(d.data, d.i) : _this3._scale(d, i), ")\n        rotate(").concat(d.__d3plusShape__ ? d.rotate ? d.rotate : _this3._rotate(d.data || d, d.i) : _this3._rotate(d.data || d, d.i), ")");
        });
      }
      /**
          @memberof Shape
          @desc Checks for nested data and uses the appropriate variables for accessor functions.
          @param {HTMLElement} *elem*
          @private
      */

    }, {
      key: "_nestWrapper",
      value: function _nestWrapper(method) {
        return function (d, i) {
          return method(d.__d3plusShape__ ? d.data : d, d.__d3plusShape__ ? d.i : i);
        };
      }
      /**
          @memberof Shape
          @desc Modifies existing shapes to show active status.
          @private
      */

    }, {
      key: "_renderActive",
      value: function _renderActive() {
        var that = this;

        this._group.selectAll(".d3plus-Shape, .d3plus-Image, .d3plus-textBox").each(function (d, i) {
          if (!d) d = {};
          if (!d.parentNode) d.parentNode = this.parentNode;
          var parent = d.parentNode;
          if (_select(this).classed("d3plus-textBox")) d = d.data;

          if (d.__d3plusShape__ || d.__d3plus__) {
            while (d && (d.__d3plusShape__ || d.__d3plus__)) {
              i = d.i;
              d = d.data;
            }
          } else i = that._data.indexOf(d);

          var group = !that._active || typeof that._active !== "function" || !that._active(d, i) ? parent : that._activeGroup.node();

          if (group !== this.parentNode) {
            group.appendChild(this);

            if (this.className.baseVal.includes("d3plus-Shape")) {
              if (parent === group) _select(this).call(that._applyStyle.bind(that));else _select(this).call(that._updateStyle.bind(that, _select(this), that._activeStyle));
            }
          }
        }); // this._renderImage();
        // this._renderLabels();


        this._group.selectAll("g.d3plus-".concat(this._name, "-shape, g.d3plus-").concat(this._name, "-image, g.d3plus-").concat(this._name, "-text")).attr("opacity", this._hover ? this._hoverOpacity : this._active ? this._activeOpacity : 1);
      }
      /**
          @memberof Shape
          @desc Modifies existing shapes to show hover status.
          @private
      */

    }, {
      key: "_renderHover",
      value: function _renderHover() {
        var that = this;

        this._group.selectAll("g.d3plus-".concat(this._name, "-shape, g.d3plus-").concat(this._name, "-image, g.d3plus-").concat(this._name, "-text, g.d3plus-").concat(this._name, "-hover")).selectAll(".d3plus-Shape, .d3plus-Image, .d3plus-textBox").each(function (d, i) {
          if (!d) d = {};
          if (!d.parentNode) d.parentNode = this.parentNode;
          var parent = d.parentNode;
          if (_select(this).classed("d3plus-textBox")) d = d.data;

          if (d.__d3plusShape__ || d.__d3plus__) {
            while (d && (d.__d3plusShape__ || d.__d3plus__)) {
              i = d.i;
              d = d.data;
            }
          } else i = that._data.indexOf(d);

          var group = !that._hover || typeof that._hover !== "function" || !that._hover(d, i) ? parent : that._hoverGroup.node();
          if (group !== this.parentNode) group.appendChild(this);

          if (this.className.baseVal.includes("d3plus-Shape")) {
            if (parent === group) _select(this).call(that._applyStyle.bind(that));else _select(this).call(that._updateStyle.bind(that, _select(this), that._hoverStyle));
          }
        }); // this._renderImage();
        // this._renderLabels();


        this._group.selectAll("g.d3plus-".concat(this._name, "-shape, g.d3plus-").concat(this._name, "-image, g.d3plus-").concat(this._name, "-text")).attr("opacity", this._hover ? this._hoverOpacity : this._active ? this._activeOpacity : 1);
      }
      /**
          @memberof Shape
          @desc Adds background image to each shape group.
          @private
      */

    }, {
      key: "_renderImage",
      value: function _renderImage() {
        var _this4 = this;

        var imageData = [];

        this._update.merge(this._enter).data().forEach(function (datum, i) {
          var aes = _this4._aes(datum, i);

          if (aes.r || aes.width && aes.height) {
            var d = datum;

            if (datum.nested && datum.key && datum.values) {
              d = datum.values[0];
              i = _this4._data.indexOf(d);
            }

            var height = aes.r ? aes.r * 2 : aes.height,
                url = _this4._backgroundImage(d, i),
                width = aes.r ? aes.r * 2 : aes.width;

            if (url) {
              var x = d.__d3plusShape__ ? d.translate ? d.translate[0] : _this4._x(d.data, d.i) : _this4._x(d, i),
                  y = d.__d3plusShape__ ? d.translate ? d.translate[1] : _this4._y(d.data, d.i) : _this4._y(d, i);
              if (aes.x) x += aes.x;
              if (aes.y) y += aes.y;

              if (d.__d3plusShape__) {
                d = d.data;
                i = d.i;
              }

              imageData.push({
                __d3plus__: true,
                data: d,
                height: height,
                i: i,
                id: _this4._id(d, i),
                url: url,
                width: width,
                x: x + -width / 2,
                y: y + -height / 2
              });
            }
          }
        });

        this._backgroundImageClass.data(imageData).duration(this._duration).opacity(this._nestWrapper(this._opacity)).pointerEvents("none").select(elem("g.d3plus-".concat(this._name, "-image"), {
          parent: this._group,
          update: {
            opacity: this._active ? this._activeOpacity : 1
          }
        }).node()).render();
      }
      /**
          @memberof Shape
          @desc Adds labels to each shape group.
          @private
      */

    }, {
      key: "_renderLabels",
      value: function _renderLabels() {
        var _this5 = this;

        var labelData = [];

        this._update.merge(this._enter).data().forEach(function (datum, i) {
          var d = datum;

          if (datum.nested && datum.key && datum.values) {
            d = datum.values[0];
            i = _this5._data.indexOf(d);
          }

          var labels = _this5._label(d, i);

          if (_this5._labelBounds && labels !== false && labels !== undefined && labels !== null) {
            var bounds = _this5._labelBounds(d, i, _this5._aes(datum, i));

            if (bounds) {
              if (labels.constructor !== Array) labels = [labels];
              var x = d.__d3plusShape__ ? d.translate ? d.translate[0] : _this5._x(d.data, d.i) : _this5._x(d, i),
                  y = d.__d3plusShape__ ? d.translate ? d.translate[1] : _this5._y(d.data, d.i) : _this5._y(d, i);

              if (d.__d3plusShape__) {
                d = d.data;
                i = d.i;
              }

              for (var l = 0; l < labels.length; l++) {
                var b = bounds.constructor === Array ? bounds[l] : Object.assign({}, bounds);

                var rotate = _this5._rotate(d, i);

                var r = d.labelConfig && d.labelConfig.rotate ? d.labelConfig.rotate : bounds.angle !== undefined ? bounds.angle : 0;
                r += rotate;
                var rotateAnchor = rotate !== 0 ? [b.x * -1 || 0, b.y * -1 || 0] : [b.width / 2, b.height / 2];
                labelData.push({
                  __d3plus__: true,
                  data: d,
                  height: b.height,
                  l: l,
                  id: "".concat(_this5._id(d, i), "_").concat(l),
                  r: r,
                  rotateAnchor: rotateAnchor,
                  text: labels[l],
                  width: b.width,
                  x: x + b.x,
                  y: y + b.y
                });
              }
            }
          }
        });

        this._labelClass.data(labelData).duration(this._duration).fontOpacity(this._nestWrapper(this._opacity)).pointerEvents("none").rotate(function (d) {
          return d.__d3plus__ ? d.r : d.data.r;
        }).rotateAnchor(function (d) {
          return d.__d3plus__ ? d.rotateAnchor : d.data.rotateAnchor;
        }).select(elem("g.d3plus-".concat(this._name, "-text"), {
          parent: this._group,
          update: {
            opacity: this._active ? this._activeOpacity : 1
          }
        }).node()).config(configPrep.bind(this)(this._labelConfig)).render();
      }
      /**
          @memberof Shape
          @desc Renders the current Shape to the page. If a *callback* is specified, it will be called once the shapes are done drawing.
          @param {Function} [*callback*]
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        var _this6 = this;

        if (this._select === void 0) {
          this.select(_select("body").append("svg").style("width", "".concat(window.innerWidth, "px")).style("height", "".concat(window.innerHeight, "px")).style("display", "block").node());
        }

        this._transition = transition().duration(this._duration);
        var data = this._data,
            key = this._id;

        if (this._dataFilter) {
          data = this._dataFilter(data);
          if (data.key) key = data.key;
        }

        if (this._sort) {
          data = data.sort(function (a, b) {
            while (a.__d3plusShape__ || a.__d3plus__) {
              a = a.data;
            }

            while (b.__d3plusShape__ || b.__d3plus__) {
              b = b.data;
            }

            return _this6._sort(a, b);
          });
        }

        selectAll("g.d3plus-".concat(this._name, "-hover > *, g.d3plus-").concat(this._name, "-active > *")).each(function (d) {
          if (d && d.parentNode) d.parentNode.appendChild(this);else this.parentNode.removeChild(this);
        }); // Makes the update state of the group selection accessible.

        this._group = elem("g.d3plus-".concat(this._name, "-group"), {
          parent: this._select
        });
        var update = this._update = elem("g.d3plus-".concat(this._name, "-shape"), {
          parent: this._group,
          update: {
            opacity: this._active ? this._activeOpacity : 1
          }
        }).selectAll(".d3plus-".concat(this._name)).data(data, key); // Orders and transforms the updating Shapes.

        update.order();

        if (this._duration) {
          update.transition(this._transition).call(this._applyTransform.bind(this));
        } else {
          update.call(this._applyTransform.bind(this));
        } // Makes the enter state of the group selection accessible.


        var enter = this._enter = update.enter().append(this._tagName).attr("class", function (d, i) {
          return "d3plus-Shape d3plus-".concat(_this6._name, " d3plus-id-").concat(strip(_this6._nestWrapper(_this6._id)(d, i)));
        }).call(this._applyTransform.bind(this)).attr("aria-label", this._ariaLabel).attr("role", this._role).attr("opacity", this._nestWrapper(this._opacity));
        var enterUpdate = enter.merge(update);
        var enterUpdateRender = enterUpdate.attr("shape-rendering", this._nestWrapper(this._shapeRendering));

        if (this._duration) {
          enterUpdateRender = enterUpdateRender.attr("pointer-events", "none").transition(this._transition).transition().delay(100).attr("pointer-events", this._pointerEvents);
        }

        enterUpdateRender.attr("opacity", this._nestWrapper(this._opacity)); // Makes the exit state of the group selection accessible.

        var exit = this._exit = update.exit();
        if (this._duration) exit.transition().delay(this._duration).remove();else exit.remove();

        this._renderImage();

        this._renderLabels();

        this._hoverGroup = elem("g.d3plus-".concat(this._name, "-hover"), {
          parent: this._group
        });
        this._activeGroup = elem("g.d3plus-".concat(this._name, "-active"), {
          parent: this._group
        });

        var hitAreas = this._group.selectAll(".d3plus-HitArea").data(this._hitArea ? data : [], key);

        hitAreas.order().call(this._applyTransform.bind(this));
        var isLine = this._name === "Line";
        isLine && this._path.curve(d3Shape["curve".concat(this._curve.charAt(0).toUpperCase()).concat(this._curve.slice(1))]).defined(this._defined).x(this._x).y(this._y);
        var hitEnter = hitAreas.enter().append(isLine ? "path" : "rect").attr("class", function (d, i) {
          return "d3plus-HitArea d3plus-id-".concat(strip(_this6._nestWrapper(_this6._id)(d, i)));
        }).attr("fill", "black").attr("stroke", "black").attr("pointer-events", "painted").attr("opacity", 0).call(this._applyTransform.bind(this));
        var that = this;
        var hitUpdates = hitAreas.merge(hitEnter).each(function (d) {
          var i = that._data.indexOf(d);

          var h = that._hitArea(d, i, that._aes(d, i));

          return h && !(that._name === "Line" && parseFloat(that._strokeWidth(d, i)) > 10) ? _select(this).call(attrize, h) : _select(this).remove();
        });
        hitAreas.exit().remove();

        this._applyEvents(this._hitArea ? hitUpdates : enterUpdate);

        setTimeout(function () {
          if (_this6._active) _this6._renderActive();else if (_this6._hover) _this6._renderHover();
          if (callback) callback();
        }, this._duration + 100);
        return this;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the highlight accessor to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "active",
      value: function active(_) {
        if (!arguments.length || _ === undefined) return this._active;
        this._active = _;

        if (this._group) {
          // this._renderImage();
          // this._renderLabels();
          this._renderActive();
        }

        return this;
      }
      /**
          @memberof Shape
          @desc When shapes are active, this is the opacity of any shape that is not active.
          @param {Number} *value* = 0.25
          @chainable
      */

    }, {
      key: "activeOpacity",
      value: function activeOpacity(_) {
        return arguments.length ? (this._activeOpacity = _, this) : this._activeOpacity;
      }
      /**
          @memberof Shape
          @desc The style to apply to active shapes.
          @param {Object} *value*
          @chainable
      */

    }, {
      key: "activeStyle",
      value: function activeStyle(_) {
        return arguments.length ? (this._activeStyle = assign({}, this._activeStyle, _), this) : this._activeStyle;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the aria-label attribute to the specified function or string and returns the current class instance.
          @param {Function|String} *value*
          @chainable
      */

    }, {
      key: "ariaLabel",
      value: function ariaLabel(_) {
        return _ !== undefined ? (this._ariaLabel = typeof _ === "function" ? _ : constant$3(_), this) : this._ariaLabel;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the background-image accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value* = false]
          @chainable
      */

    }, {
      key: "backgroundImage",
      value: function backgroundImage(_) {
        return arguments.length ? (this._backgroundImage = typeof _ === "function" ? _ : constant$3(_), this) : this._backgroundImage;
      }
      /**
          @memberof Shape
          @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array. A shape will be drawn for each object in the array.
          @param {Array} [*data* = []]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof Shape
          @desc If *ms* is specified, sets the animation duration to the specified number and returns the current class instance. If *ms* is not specified, returns the current animation duration.
          @param {Number} [*ms* = 600]
          @chainable
      */

    }, {
      key: "duration",
      value: function duration(_) {
        return arguments.length ? (this._duration = _, this) : this._duration;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the fill accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value* = "black"]
          @chainable
      */

    }, {
      key: "fill",
      value: function fill(_) {
        return arguments.length ? (this._fill = typeof _ === "function" ? _ : constant$3(_), this) : this._fill;
      }
      /**
          @memberof Shape
          @desc Defines the "fill-opacity" attribute for the shapes.
          @param {Function|Number} [*value* = 1]
          @chainable
      */

    }, {
      key: "fillOpacity",
      value: function fillOpacity(_) {
        return arguments.length ? (this._fillOpacity = typeof _ === "function" ? _ : constant$3(_), this) : this._fillOpacity;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the highlight accessor to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "hover",
      value: function hover(_) {
        if (!arguments.length || _ === void 0) return this._hover;
        this._hover = _;

        if (this._group) {
          // this._renderImage();
          // this._renderLabels();
          this._renderHover();
        }

        return this;
      }
      /**
          @memberof Shape
          @desc The style to apply to hovered shapes.
          @param {Object} *value*
          @chainable
       */

    }, {
      key: "hoverStyle",
      value: function hoverStyle(_) {
        return arguments.length ? (this._hoverStyle = assign({}, this._hoverStyle, _), this) : this._hoverStyle;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the hover opacity to the specified function and returns the current class instance.
          @param {Number} [*value* = 0.5]
          @chainable
      */

    }, {
      key: "hoverOpacity",
      value: function hoverOpacity(_) {
        return arguments.length ? (this._hoverOpacity = _, this) : this._hoverOpacity;
      }
      /**
          @memberof Shape
          @desc If *bounds* is specified, sets the mouse hit area to the specified function and returns the current class instance. If *bounds* is not specified, returns the current mouse hit area accessor.
          @param {Function} [*bounds*] The given function is passed the data point, index, and internally defined properties of the shape and should return an object containing the following values: `width`, `height`, `x`, `y`.
          @chainable
          @example
      function(d, i, shape) {
      return {
        "width": shape.width,
        "height": shape.height,
        "x": -shape.width / 2,
        "y": -shape.height / 2
      };
      }
      */

    }, {
      key: "hitArea",
      value: function hitArea(_) {
        return arguments.length ? (this._hitArea = typeof _ === "function" ? _ : constant$3(_), this) : this._hitArea;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the id accessor to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "id",
      value: function id(_) {
        return arguments.length ? (this._id = _, this) : this._id;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the label accessor to the specified function or string and returns the current class instance.
          @param {Function|String|Array} [*value*]
          @chainable
      */

    }, {
      key: "label",
      value: function label(_) {
        return arguments.length ? (this._label = typeof _ === "function" ? _ : constant$3(_), this) : this._label;
      }
      /**
          @memberof Shape
          @desc If *bounds* is specified, sets the label bounds to the specified function and returns the current class instance. If *bounds* is not specified, returns the current inner bounds accessor.
          @param {Function} [*bounds*] The given function is passed the data point, index, and internally defined properties of the shape and should return an object containing the following values: `width`, `height`, `x`, `y`. If an array is returned from the function, each value will be used in conjunction with each label.
          @chainable
          @example
      function(d, i, shape) {
      return {
        "width": shape.width,
        "height": shape.height,
        "x": -shape.width / 2,
        "y": -shape.height / 2
      };
      }
      */

    }, {
      key: "labelBounds",
      value: function labelBounds(_) {
        return arguments.length ? (this._labelBounds = typeof _ === "function" ? _ : constant$3(_), this) : this._labelBounds;
      }
      /**
          @memberof Shape
          @desc A pass-through to the config method of the TextBox class used to create a shape's labels.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "labelConfig",
      value: function labelConfig(_) {
        return arguments.length ? (this._labelConfig = assign(this._labelConfig, _), this) : this._labelConfig;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the opacity accessor to the specified function or number and returns the current class instance.
          @param {Number} [*value* = 1]
          @chainable
      */

    }, {
      key: "opacity",
      value: function opacity(_) {
        return arguments.length ? (this._opacity = typeof _ === "function" ? _ : constant$3(_), this) : this._opacity;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the pointerEvents accessor to the specified function or string and returns the current class instance.
          @param {String} [*value*]
          @chainable
       */

    }, {
      key: "pointerEvents",
      value: function pointerEvents(_) {
        return arguments.length ? (this._pointerEvents = typeof _ === "function" ? _ : constant$3(_), this) : this._pointerEvents;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the role attribute to the specified function or string and returns the current class instance.
          @param {Function|String} *value*
          @chainable
      */

    }, {
      key: "role",
      value: function role(_) {
        return _ !== undefined ? (this._role = typeof _ === "function" ? _ : constant$3(_), this) : this._role;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the rotate accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value* = 0]
          @chainable
       */

    }, {
      key: "rotate",
      value: function rotate(_) {
        return arguments.length ? (this._rotate = typeof _ === "function" ? _ : constant$3(_), this) : this._rotate;
      }
      /**
          @memberof Shape
          @desc Defines the "rx" attribute for the shapes.
          @param {Function|Number} [*value* = 0]
          @chainable
      */

    }, {
      key: "rx",
      value: function rx(_) {
        return arguments.length ? (this._rx = typeof _ === "function" ? _ : constant$3(_), this) : this._rx;
      }
      /**
          @memberof Shape
          @desc Defines the "rx" attribute for the shapes.
          @param {Function|Number} [*value* = 0]
          @chainable
      */

    }, {
      key: "ry",
      value: function ry(_) {
        return arguments.length ? (this._ry = typeof _ === "function" ? _ : constant$3(_), this) : this._ry;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the scale accessor to the specified function or string and returns the current class instance.
          @param {Function|Number} [*value* = 1]
          @chainable
      */

    }, {
      key: "scale",
      value: function scale(_) {
        return arguments.length ? (this._scale = typeof _ === "function" ? _ : constant$3(_), this) : this._scale;
      }
      /**
          @memberof Shape
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.
          @param {String|HTMLElement} [*selector* = d3.select("body").append("svg")]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the shape-rendering accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value* = "geometricPrecision"]
          @chainable
          @example
      function(d) {
      return d.x;
      }
      */

    }, {
      key: "shapeRendering",
      value: function shapeRendering(_) {
        return arguments.length ? (this._shapeRendering = typeof _ === "function" ? _ : constant$3(_), this) : this._shapeRendering;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the sort comparator to the specified function and returns the current class instance.
          @param {false|Function} [*value* = []]
          @chainable
      */

    }, {
      key: "sort",
      value: function sort(_) {
        return arguments.length ? (this._sort = _, this) : this._sort;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the stroke accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value* = "black"]
          @chainable
      */

    }, {
      key: "stroke",
      value: function stroke(_) {
        return arguments.length ? (this._stroke = typeof _ === "function" ? _ : constant$3(_), this) : this._stroke;
      }
      /**
          @memberof Shape
          @desc Defines the "stroke-dasharray" attribute for the shapes.
          @param {Function|String} [*value* = "1"]
          @chainable
      */

    }, {
      key: "strokeDasharray",
      value: function strokeDasharray(_) {
        return arguments.length ? (this._strokeDasharray = typeof _ === "function" ? _ : constant$3(_), this) : this._strokeDasharray;
      }
      /**
          @memberof Shape
          @desc Defines the "stroke-linecap" attribute for the shapes. Accepted values are `"butt"`, `"round"`, and `"square"`.
          @param {Function|String} [*value* = "butt"]
          @chainable
      */

    }, {
      key: "strokeLinecap",
      value: function strokeLinecap(_) {
        return arguments.length ? (this._strokeLinecap = typeof _ === "function" ? _ : constant$3(_), this) : this._strokeLinecap;
      }
      /**
          @memberof Shape
          @desc Defines the "stroke-opacity" attribute for the shapes.
          @param {Function|Number} [*value* = 1]
          @chainable
      */

    }, {
      key: "strokeOpacity",
      value: function strokeOpacity(_) {
        return arguments.length ? (this._strokeOpacity = typeof _ === "function" ? _ : constant$3(_), this) : this._strokeOpacity;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the stroke-width accessor to the specified function or string and returns the current class instance.
          @param {Function|Number} [*value* = 0]
          @chainable
      */

    }, {
      key: "strokeWidth",
      value: function strokeWidth(_) {
        return arguments.length ? (this._strokeWidth = typeof _ === "function" ? _ : constant$3(_), this) : this._strokeWidth;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the text-anchor accessor to the specified function or string and returns the current class instance.
          @param {Function|String|Array} [*value* = "start"]
          @chainable
      */

    }, {
      key: "textAnchor",
      value: function textAnchor(_) {
        return arguments.length ? (this._textAnchor = typeof _ === "function" ? _ : constant$3(_), this) : this._textAnchor;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the vector-effect accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value* = "non-scaling-stroke"]
          @chainable
      */

    }, {
      key: "vectorEffect",
      value: function vectorEffect(_) {
        return arguments.length ? (this._vectorEffect = typeof _ === "function" ? _ : constant$3(_), this) : this._vectorEffect;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the vertical alignment accessor to the specified function or string and returns the current class instance.
          @param {Function|String|Array} [*value* = "start"]
          @chainable
      */

    }, {
      key: "verticalAlign",
      value: function verticalAlign(_) {
        return arguments.length ? (this._verticalAlign = typeof _ === "function" ? _ : constant$3(_), this) : this._verticalAlign;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the x accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.x;
      }
      */

    }, {
      key: "x",
      value: function x(_) {
        return arguments.length ? (this._x = typeof _ === "function" ? _ : constant$3(_), this) : this._x;
      }
      /**
          @memberof Shape
          @desc If *value* is specified, sets the y accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.y;
      }
      */

    }, {
      key: "y",
      value: function y(_) {
        return arguments.length ? (this._y = typeof _ === "function" ? _ : constant$3(_), this) : this._y;
      }
    }]);

    return Shape;
  }(BaseClass);

  /**
   * de Casteljau's algorithm for drawing and splitting bezier curves.
   * Inspired by https://pomax.github.io/bezierinfo/
   *
   * @param {Number[][]} points Array of [x,y] points: [start, control1, control2, ..., end]
   *   The original segment to split.
   * @param {Number} t Where to split the curve (value between [0, 1])
   * @return {Object} An object { left, right } where left is the segment from 0..t and
   *   right is the segment from t..1.
   */
  function decasteljau(points, t) {
    var left = [];
    var right = [];

    function decasteljauRecurse(points, t) {
      if (points.length === 1) {
        left.push(points[0]);
        right.push(points[0]);
      } else {
        var newPoints = Array(points.length - 1);

        for (var i = 0; i < newPoints.length; i++) {
          if (i === 0) {
            left.push(points[0]);
          }

          if (i === newPoints.length - 1) {
            right.push(points[i + 1]);
          }

          newPoints[i] = [(1 - t) * points[i][0] + t * points[i + 1][0], (1 - t) * points[i][1] + t * points[i + 1][1]];
        }

        decasteljauRecurse(newPoints, t);
      }
    }

    if (points.length) {
      decasteljauRecurse(points, t);
    }

    return {
      left: left,
      right: right.reverse()
    };
  }
  /**
   * Convert segments represented as points back into a command object
   *
   * @param {Number[][]} points Array of [x,y] points: [start, control1, control2, ..., end]
   *   Represents a segment
   * @return {Object} A command object representing the segment.
   */


  function pointsToCommand(points) {
    var command = {};

    if (points.length === 4) {
      command.x2 = points[2][0];
      command.y2 = points[2][1];
    }

    if (points.length >= 3) {
      command.x1 = points[1][0];
      command.y1 = points[1][1];
    }

    command.x = points[points.length - 1][0];
    command.y = points[points.length - 1][1];

    if (points.length === 4) {
      // start, control1, control2, end
      command.type = 'C';
    } else if (points.length === 3) {
      // start, control, end
      command.type = 'Q';
    } else {
      // start, end
      command.type = 'L';
    }

    return command;
  }
  /**
   * Runs de Casteljau's algorithm enough times to produce the desired number of segments.
   *
   * @param {Number[][]} points Array of [x,y] points for de Casteljau (the initial segment to split)
   * @param {Number} segmentCount Number of segments to split the original into
   * @return {Number[][][]} Array of segments
   */


  function splitCurveAsPoints(points, segmentCount) {
    segmentCount = segmentCount || 2;
    var segments = [];
    var remainingCurve = points;
    var tIncrement = 1 / segmentCount; // x-----x-----x-----x
    // t=  0.33   0.66   1
    // x-----o-----------x
    // r=  0.33
    //       x-----o-----x
    // r=         0.5  (0.33 / (1 - 0.33))  === tIncrement / (1 - (tIncrement * (i - 1))
    // x-----x-----x-----x----x
    // t=  0.25   0.5   0.75  1
    // x-----o----------------x
    // r=  0.25
    //       x-----o----------x
    // r=         0.33  (0.25 / (1 - 0.25))
    //             x-----o----x
    // r=         0.5  (0.25 / (1 - 0.5))

    for (var i = 0; i < segmentCount - 1; i++) {
      var tRelative = tIncrement / (1 - tIncrement * i);
      var split = decasteljau(remainingCurve, tRelative);
      segments.push(split.left);
      remainingCurve = split.right;
    } // last segment is just to the end from the last point


    segments.push(remainingCurve);
    return segments;
  }
  /**
   * Convert command objects to arrays of points, run de Casteljau's algorithm on it
   * to split into to the desired number of segments.
   *
   * @param {Object} commandStart The start command object
   * @param {Object} commandEnd The end command object
   * @param {Number} segmentCount The number of segments to create
   * @return {Object[]} An array of commands representing the segments in sequence
   */


  function splitCurve(commandStart, commandEnd, segmentCount) {
    var points = [[commandStart.x, commandStart.y]];

    if (commandEnd.x1 != null) {
      points.push([commandEnd.x1, commandEnd.y1]);
    }

    if (commandEnd.x2 != null) {
      points.push([commandEnd.x2, commandEnd.y2]);
    }

    points.push([commandEnd.x, commandEnd.y]);
    return splitCurveAsPoints(points, segmentCount).map(pointsToCommand);
  }

  var commandTokenRegex = /[MLCSTQAHVmlcstqahv]|[\d.-]+/g;
  /**
   * List of params for each command type in a path `d` attribute
   */

  var typeMap = {
    M: ['x', 'y'],
    L: ['x', 'y'],
    H: ['x'],
    V: ['y'],
    C: ['x1', 'y1', 'x2', 'y2', 'x', 'y'],
    S: ['x2', 'y2', 'x', 'y'],
    Q: ['x1', 'y1', 'x', 'y'],
    T: ['x', 'y'],
    A: ['rx', 'ry', 'xAxisRotation', 'largeArcFlag', 'sweepFlag', 'x', 'y']
  }; // Add lower case entries too matching uppercase (e.g. 'm' == 'M')

  Object.keys(typeMap).forEach(function (key) {
    typeMap[key.toLowerCase()] = typeMap[key];
  });

  function arrayOfLength(length, value) {
    var array = Array(length);

    for (var i = 0; i < length; i++) {
      array[i] = value;
    }

    return array;
  }
  /**
   * Converts a command object to a string to be used in a `d` attribute
   * @param {Object} command A command object
   * @return {String} The string for the `d` attribute
   */


  function commandToString(command) {
    return "".concat(command.type).concat(typeMap[command.type].map(function (p) {
      return command[p];
    }).join(','));
  }
  /**
   * Converts command A to have the same type as command B.
   *
   * e.g., L0,5 -> C0,5,0,5,0,5
   *
   * Uses these rules:
   * x1 <- x
   * x2 <- x
   * y1 <- y
   * y2 <- y
   * rx <- 0
   * ry <- 0
   * xAxisRotation <- read from B
   * largeArcFlag <- read from B
   * sweepflag <- read from B
   *
   * @param {Object} aCommand Command object from path `d` attribute
   * @param {Object} bCommand Command object from path `d` attribute to match against
   * @return {Object} aCommand converted to type of bCommand
   */


  function convertToSameType(aCommand, bCommand) {
    var conversionMap = {
      x1: 'x',
      y1: 'y',
      x2: 'x',
      y2: 'y'
    };
    var readFromBKeys = ['xAxisRotation', 'largeArcFlag', 'sweepFlag']; // convert (but ignore M types)

    if (aCommand.type !== bCommand.type && bCommand.type.toUpperCase() !== 'M') {
      var aConverted = {};
      Object.keys(bCommand).forEach(function (bKey) {
        var bValue = bCommand[bKey]; // first read from the A command

        var aValue = aCommand[bKey]; // if it is one of these values, read from B no matter what

        if (aValue === undefined) {
          if (readFromBKeys.includes(bKey)) {
            aValue = bValue;
          } else {
            // if it wasn't in the A command, see if an equivalent was
            if (aValue === undefined && conversionMap[bKey]) {
              aValue = aCommand[conversionMap[bKey]];
            } // if it doesn't have a converted value, use 0


            if (aValue === undefined) {
              aValue = 0;
            }
          }
        }

        aConverted[bKey] = aValue;
      }); // update the type to match B

      aConverted.type = bCommand.type;
      aCommand = aConverted;
    }

    return aCommand;
  }
  /**
   * Interpolate between command objects commandStart and commandEnd segmentCount times.
   * If the types are L, Q, or C then the curves are split as per de Casteljau's algorithm.
   * Otherwise we just copy commandStart segmentCount - 1 times, finally ending with commandEnd.
   *
   * @param {Object} commandStart Command object at the beginning of the segment
   * @param {Object} commandEnd Command object at the end of the segment
   * @param {Number} segmentCount The number of segments to split this into. If only 1
   *   Then [commandEnd] is returned.
   * @return {Object[]} Array of ~segmentCount command objects between commandStart and
   *   commandEnd. (Can be segmentCount+1 objects if commandStart is type M).
   */


  function splitSegment(commandStart, commandEnd, segmentCount) {
    var segments = []; // line, quadratic bezier, or cubic bezier

    if (commandEnd.type === 'L' || commandEnd.type === 'Q' || commandEnd.type === 'C') {
      segments = segments.concat(splitCurve(commandStart, commandEnd, segmentCount)); // general case - just copy the same point
    } else {
      var copyCommand = Object.assign({}, commandStart); // convert M to L

      if (copyCommand.type === 'M') {
        copyCommand.type = 'L';
      }

      segments = segments.concat(arrayOfLength(segmentCount - 1).map(function () {
        return copyCommand;
      }));
      segments.push(commandEnd);
    }

    return segments;
  }
  /**
   * Extends an array of commandsToExtend to the length of the referenceCommands by
   * splitting segments until the number of commands match. Ensures all the actual
   * points of commandsToExtend are in the extended array.
   *
   * @param {Object[]} commandsToExtend The command object array to extend
   * @param {Object[]} referenceCommands The command object array to match in length
   * @param {Function} excludeSegment a function that takes a start command object and
   *   end command object and returns true if the segment should be excluded from splitting.
   * @return {Object[]} The extended commandsToExtend array
   */


  function extend$3(commandsToExtend, referenceCommands, excludeSegment) {
    // compute insertion points:
    // number of segments in the path to extend
    var numSegmentsToExtend = commandsToExtend.length - 1; // number of segments in the reference path.

    var numReferenceSegments = referenceCommands.length - 1; // this value is always between [0, 1].

    var segmentRatio = numSegmentsToExtend / numReferenceSegments; // create a map, mapping segments in referenceCommands to how many points
    // should be added in that segment (should always be >= 1 since we need each
    // point itself).
    // 0 = segment 0-1, 1 = segment 1-2, n-1 = last vertex

    var countPointsPerSegment = arrayOfLength(numReferenceSegments).reduce(function (accum, d, i) {
      var insertIndex = Math.floor(segmentRatio * i); // handle excluding segments

      if (excludeSegment && insertIndex < commandsToExtend.length - 1 && excludeSegment(commandsToExtend[insertIndex], commandsToExtend[insertIndex + 1])) {
        // set the insertIndex to the segment that this point should be added to:
        // round the insertIndex essentially so we split half and half on
        // neighbouring segments. hence the segmentRatio * i < 0.5
        var addToPriorSegment = segmentRatio * i % 1 < 0.5; // only skip segment if we already have 1 point in it (can't entirely remove a segment)

        if (accum[insertIndex]) {
          // TODO - Note this is a naive algorithm that should work for most d3-area use cases
          // but if two adjacent segments are supposed to be skipped, this will not perform as
          // expected. Could be updated to search for nearest segment to place the point in, but
          // will only do that if necessary.
          // add to the prior segment
          if (addToPriorSegment) {
            if (insertIndex > 0) {
              insertIndex -= 1; // not possible to add to previous so adding to next
            } else if (insertIndex < commandsToExtend.length - 1) {
              insertIndex += 1;
            } // add to next segment

          } else if (insertIndex < commandsToExtend.length - 1) {
            insertIndex += 1; // not possible to add to next so adding to previous
          } else if (insertIndex > 0) {
            insertIndex -= 1;
          }
        }
      }

      accum[insertIndex] = (accum[insertIndex] || 0) + 1;
      return accum;
    }, []); // extend each segment to have the correct number of points for a smooth interpolation

    var extended = countPointsPerSegment.reduce(function (extended, segmentCount, i) {
      // if last command, just add `segmentCount` number of times
      if (i === commandsToExtend.length - 1) {
        var lastCommandCopies = arrayOfLength(segmentCount, Object.assign({}, commandsToExtend[commandsToExtend.length - 1])); // convert M to L

        if (lastCommandCopies[0].type === 'M') {
          lastCommandCopies.forEach(function (d) {
            d.type = 'L';
          });
        }

        return extended.concat(lastCommandCopies);
      } // otherwise, split the segment segmentCount times.


      return extended.concat(splitSegment(commandsToExtend[i], commandsToExtend[i + 1], segmentCount));
    }, []); // add in the very first point since splitSegment only adds in the ones after it

    extended.unshift(commandsToExtend[0]);
    return extended;
  }
  /**
   * Takes a path `d` string and converts it into an array of command
   * objects. Drops the `Z` character.
   *
   * @param {String|null} d A path `d` string
   */


  function makeCommands(d) {
    // split into valid tokens
    var tokens = (d || '').match(commandTokenRegex) || [];
    var commands = [];
    var commandArgs;
    var command; // iterate over each token, checking if we are at a new command
    // by presence in the typeMap

    for (var i = 0; i < tokens.length; ++i) {
      commandArgs = typeMap[tokens[i]]; // new command found:

      if (commandArgs) {
        command = {
          type: tokens[i]
        }; // add each of the expected args for this command:

        for (var a = 0; a < commandArgs.length; ++a) {
          command[commandArgs[a]] = +tokens[i + a + 1];
        } // need to increment our token index appropriately since
        // we consumed token args


        i += commandArgs.length;
        commands.push(command);
      }
    }

    return commands;
  }
  /**
   * Interpolate from A to B by extending A and B during interpolation to have
   * the same number of points. This allows for a smooth transition when they
   * have a different number of points.
   *
   * Ignores the `Z` character in paths unless both A and B end with it.
   *
   * @param {String} a The `d` attribute for a path
   * @param {String} b The `d` attribute for a path
   * @param {Function} excludeSegment a function that takes a start command object and
   *   end command object and returns true if the segment should be excluded from splitting.
   * @returns {Function} Interpolation function that maps t ([0, 1]) to a path `d` string.
   */


  function interpolatePath(a, b, excludeSegment) {
    var aCommands = makeCommands(a);
    var bCommands = makeCommands(b);

    if (!aCommands.length && !bCommands.length) {
      return function nullInterpolator() {
        return '';
      };
    } // if A is empty, treat it as if it used to contain just the first point
    // of B. This makes it so the line extends out of from that first point.


    if (!aCommands.length) {
      aCommands.push(bCommands[0]); // otherwise if B is empty, treat it as if it contains the first point
      // of A. This makes it so the line retracts into the first point.
    } else if (!bCommands.length) {
      bCommands.push(aCommands[0]);
    } // extend to match equal size


    var numPointsToExtend = Math.abs(bCommands.length - aCommands.length);

    if (numPointsToExtend !== 0) {
      // B has more points than A, so add points to A before interpolating
      if (bCommands.length > aCommands.length) {
        aCommands = extend$3(aCommands, bCommands, excludeSegment); // else if A has more points than B, add more points to B
      } else if (bCommands.length < aCommands.length) {
        bCommands = extend$3(bCommands, aCommands, excludeSegment);
      }
    } // commands have same length now.
    // convert commands in A to the same type as those in B


    aCommands = aCommands.map(function (aCommand, i) {
      return convertToSameType(aCommand, bCommands[i]);
    }); // create mutable interpolated command objects

    var interpolatedCommands = aCommands.map(function (aCommand) {
      return _objectSpread2({}, aCommand);
    });
    var addZ = (a == null || a[a.length - 1] === 'Z') && (b == null || b[b.length - 1] === 'Z');
    return function pathInterpolator(t) {
      // at 1 return the final value without the extensions used during interpolation
      if (t === 1) {
        return b == null ? '' : b;
      } // interpolate the commands using the mutable interpolated command objs
      // we can skip at t=0 since we copied aCommands to begin


      if (t > 0) {
        for (var i = 0; i < interpolatedCommands.length; ++i) {
          var aCommand = aCommands[i];
          var bCommand = bCommands[i];
          var interpolatedCommand = interpolatedCommands[i];
          var _iteratorNormalCompletion = true;
          var _didIteratorError = false;
          var _iteratorError = undefined;

          try {
            for (var _iterator = typeMap[interpolatedCommand.type][Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
              var arg = _step.value;
              interpolatedCommand[arg] = (1 - t) * aCommand[arg] + t * bCommand[arg]; // do not use floats for flags (#27), round to integer

              if (arg === 'largeArcFlag' || arg === 'sweepFlag') {
                interpolatedCommand[arg] = Math.round(interpolatedCommand[arg]);
              }
            }
          } catch (err) {
            _didIteratorError = true;
            _iteratorError = err;
          } finally {
            try {
              if (!_iteratorNormalCompletion && _iterator["return"] != null) {
                _iterator["return"]();
              }
            } finally {
              if (_didIteratorError) {
                throw _iteratorError;
              }
            }
          }
        }
      } // convert to a string (fastest concat: https://jsperf.com/join-concat/150)


      var interpolatedString = '';
      var _iteratorNormalCompletion2 = true;
      var _didIteratorError2 = false;
      var _iteratorError2 = undefined;

      try {
        for (var _iterator2 = interpolatedCommands[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
          var _interpolatedCommand = _step2.value;
          interpolatedString += commandToString(_interpolatedCommand);
        }
      } catch (err) {
        _didIteratorError2 = true;
        _iteratorError2 = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion2 && _iterator2["return"] != null) {
            _iterator2["return"]();
          }
        } finally {
          if (_didIteratorError2) {
            throw _iteratorError2;
          }
        }
      }

      if (addZ) {
        interpolatedString += 'Z';
      }

      return interpolatedString;
    };
  }

  function polygonArea (polygon) {
    var i = -1,
        n = polygon.length,
        a,
        b = polygon[n - 1],
        area = 0;

    while (++i < n) {
      a = b;
      b = polygon[i];
      area += a[1] * b[0] - a[0] * b[1];
    }

    return area / 2;
  }

  function polygonCentroid (polygon) {
    var i = -1,
        n = polygon.length,
        x = 0,
        y = 0,
        a,
        b = polygon[n - 1],
        c,
        k = 0;

    while (++i < n) {
      a = b;
      b = polygon[i];
      k += c = a[0] * b[1] - b[0] * a[1];
      x += (a[0] + b[0]) * c;
      y += (a[1] + b[1]) * c;
    }

    return k *= 3, [x / k, y / k];
  }

  // Returns the 2D cross product of AB and AC vectors, i.e., the z-component of
  // the 3D cross product in a quadrant I Cartesian coordinate system (+x is
  // right, +y is up). Returns a positive value if ABC is counter-clockwise,
  // negative if clockwise, and zero if the points are collinear.
  function cross$1 (a, b, c) {
    return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]);
  }

  function lexicographicOrder(a, b) {
    return a[0] - b[0] || a[1] - b[1];
  } // Computes the upper convex hull per the monotone chain algorithm.
  // Assumes points.length >= 3, is sorted by x, unique in y.
  // Returns an array of indices into points in left-to-right order.


  function computeUpperHullIndexes(points) {
    var n = points.length,
        indexes = [0, 1],
        size = 2;

    for (var i = 2; i < n; ++i) {
      while (size > 1 && cross$1(points[indexes[size - 2]], points[indexes[size - 1]], points[i]) <= 0) {
        --size;
      }

      indexes[size++] = i;
    }

    return indexes.slice(0, size); // remove popped points
  }

  function polygonHull (points) {
    if ((n = points.length) < 3) return null;
    var i,
        n,
        sortedPoints = new Array(n),
        flippedPoints = new Array(n);

    for (i = 0; i < n; ++i) {
      sortedPoints[i] = [+points[i][0], +points[i][1], i];
    }

    sortedPoints.sort(lexicographicOrder);

    for (i = 0; i < n; ++i) {
      flippedPoints[i] = [sortedPoints[i][0], -sortedPoints[i][1]];
    }

    var upperIndexes = computeUpperHullIndexes(sortedPoints),
        lowerIndexes = computeUpperHullIndexes(flippedPoints); // Construct the hull polygon, removing possible duplicate endpoints.

    var skipLeft = lowerIndexes[0] === upperIndexes[0],
        skipRight = lowerIndexes[lowerIndexes.length - 1] === upperIndexes[upperIndexes.length - 1],
        hull = []; // Add upper hull in right-to-l order.
    // Then add lower hull in left-to-right order.

    for (i = upperIndexes.length - 1; i >= 0; --i) {
      hull.push(points[sortedPoints[upperIndexes[i]][2]]);
    }

    for (i = +skipLeft; i < lowerIndexes.length - skipRight; ++i) {
      hull.push(points[sortedPoints[lowerIndexes[i]][2]]);
    }

    return hull;
  }

  function polygonContains (polygon, point) {
    var n = polygon.length,
        p = polygon[n - 1],
        x = point[0],
        y = point[1],
        x0 = p[0],
        y0 = p[1],
        x1,
        y1,
        inside = false;

    for (var i = 0; i < n; ++i) {
      p = polygon[i], x1 = p[0], y1 = p[1];
      if (y1 > y !== y0 > y && x < (x0 - x1) * (y - y1) / (y0 - y1) + x1) inside = !inside;
      x0 = x1, y0 = y1;
    }

    return inside;
  }

  /**
      @function lineIntersection
      @desc Finds the intersection point (if there is one) of the lines p1q1 and p2q2.
      @param {Array} p1 The first point of the first line segment, which should always be an `[x, y]` formatted Array.
      @param {Array} q1 The second point of the first line segment, which should always be an `[x, y]` formatted Array.
      @param {Array} p2 The first point of the second line segment, which should always be an `[x, y]` formatted Array.
      @param {Array} q2 The second point of the second line segment, which should always be an `[x, y]` formatted Array.
      @returns {Boolean}
  */
  function lineIntersection (p1, q1, p2, q2) {
    // allow for some margins due to numerical errors
    var eps = 1e-9; // find the intersection point between the two infinite lines

    var dx1 = p1[0] - q1[0],
        dx2 = p2[0] - q2[0],
        dy1 = p1[1] - q1[1],
        dy2 = p2[1] - q2[1];
    var denom = dx1 * dy2 - dy1 * dx2;
    if (Math.abs(denom) < eps) return null;
    var cross1 = p1[0] * q1[1] - p1[1] * q1[0],
        cross2 = p2[0] * q2[1] - p2[1] * q2[0];
    var px = (cross1 * dx2 - cross2 * dx1) / denom,
        py = (cross1 * dy2 - cross2 * dy1) / denom;
    return [px, py];
  }

  function _slicedToArray(arr, i) {
    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
  }

  function _nonIterableRest() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance");
  }

  function _iterableToArrayLimit(arr, i) {
    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
      return;
    }

    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _arrayWithHoles(arr) {
    if (Array.isArray(arr)) return arr;
  }
  /**
      @function segmentBoxContains
      @desc Checks whether a point is inside the bounding box of a line segment.
      @param {Array} s1 The first point of the line segment to be used for the bounding box, which should always be an `[x, y]` formatted Array.
      @param {Array} s2 The second point of the line segment to be used for the bounding box, which should always be an `[x, y]` formatted Array.
      @param {Array} p The point to be checked, which should always be an `[x, y]` formatted Array.
      @returns {Boolean}
  */


  function segmentBoxContains (s1, s2, p) {
    var eps = 1e-9,
        _p = _slicedToArray(p, 2),
        px = _p[0],
        py = _p[1];

    return !(px < Math.min(s1[0], s2[0]) - eps || px > Math.max(s1[0], s2[0]) + eps || py < Math.min(s1[1], s2[1]) - eps || py > Math.max(s1[1], s2[1]) + eps);
  }

  /**
      @function segmentsIntersect
      @desc Checks whether the line segments p1q1 && p2q2 intersect.
      @param {Array} p1 The first point of the first line segment, which should always be an `[x, y]` formatted Array.
      @param {Array} q1 The second point of the first line segment, which should always be an `[x, y]` formatted Array.
      @param {Array} p2 The first point of the second line segment, which should always be an `[x, y]` formatted Array.
      @param {Array} q2 The second point of the second line segment, which should always be an `[x, y]` formatted Array.
      @returns {Boolean}
  */

  function segmentsIntersect (p1, q1, p2, q2) {
    var p = lineIntersection(p1, q1, p2, q2);
    if (!p) return false;
    return segmentBoxContains(p1, q1, p) && segmentBoxContains(p2, q2, p);
  }

  /**
      @function polygonInside
      @desc Checks if one polygon is inside another polygon.
      @param {Array} polyA An Array of `[x, y]` points to be used as the inner polygon, checking if it is inside polyA.
      @param {Array} polyB An Array of `[x, y]` points to be used as the containing polygon.
      @returns {Boolean}
  */

  function polygonInside (polyA, polyB) {
    var iA = -1;
    var nA = polyA.length;
    var nB = polyB.length;
    var bA = polyA[nA - 1];

    while (++iA < nA) {
      var aA = bA;
      bA = polyA[iA];
      var iB = -1;
      var bB = polyB[nB - 1];

      while (++iB < nB) {
        var aB = bB;
        bB = polyB[iB];
        if (segmentsIntersect(aA, bA, aB, bB)) return false;
      }
    }

    return polygonContains(polyB, polyA[0]);
  }

  function _slicedToArray$1(arr, i) {
    return _arrayWithHoles$1(arr) || _iterableToArrayLimit$1(arr, i) || _nonIterableRest$1();
  }

  function _nonIterableRest$1() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance");
  }

  function _iterableToArrayLimit$1(arr, i) {
    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
      return;
    }

    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _arrayWithHoles$1(arr) {
    if (Array.isArray(arr)) return arr;
  }
  /**
      @function polygonRayCast
      @desc Gives the two closest intersection points between a ray cast from a point inside a polygon. The two points should lie on opposite sides of the origin.
      @param {Array} poly The polygon to test against, which should be an `[x, y]` formatted Array.
      @param {Array} origin The origin point of the ray to be cast, which should be an `[x, y]` formatted Array.
      @param {Number} [alpha = 0] The angle in radians of the ray.
      @returns {Array} An array containing two values, the closest point on the left and the closest point on the right. If either point cannot be found, that value will be `null`.
  */

  function polygonRayCast (poly, origin) {
    var alpha = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
    var eps = 1e-9;
    origin = [origin[0] + eps * Math.cos(alpha), origin[1] + eps * Math.sin(alpha)];

    var _origin = origin,
        _origin2 = _slicedToArray$1(_origin, 2),
        x0 = _origin2[0],
        y0 = _origin2[1];

    var shiftedOrigin = [x0 + Math.cos(alpha), y0 + Math.sin(alpha)];
    var idx = 0;
    if (Math.abs(shiftedOrigin[0] - x0) < eps) idx = 1;
    var i = -1;
    var n = poly.length;
    var b = poly[n - 1];
    var minSqDistLeft = Number.MAX_VALUE;
    var minSqDistRight = Number.MAX_VALUE;
    var closestPointLeft = null;
    var closestPointRight = null;

    while (++i < n) {
      var a = b;
      b = poly[i];
      var p = lineIntersection(origin, shiftedOrigin, a, b);

      if (p && segmentBoxContains(a, b, p)) {
        var sqDist = pointDistanceSquared(origin, p);

        if (p[idx] < origin[idx]) {
          if (sqDist < minSqDistLeft) {
            minSqDistLeft = sqDist;
            closestPointLeft = p;
          }
        } else if (p[idx] > origin[idx]) {
          if (sqDist < minSqDistRight) {
            minSqDistRight = sqDist;
            closestPointRight = p;
          }
        }
      }
    }

    return [closestPointLeft, closestPointRight];
  }

  /**
      @function pointRotate
      @desc Rotates a point around a given origin.
      @param {Array} p The point to be rotated, which should always be an `[x, y]` formatted Array.
      @param {Number} alpha The angle in radians to rotate.
      @param {Array} [origin = [0, 0]] The origin point of the rotation, which should always be an `[x, y]` formatted Array.
      @returns {Boolean}
  */
  function pointRotate (p, alpha) {
    var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [0, 0];
    var cosAlpha = Math.cos(alpha),
        sinAlpha = Math.sin(alpha),
        xshifted = p[0] - origin[0],
        yshifted = p[1] - origin[1];
    return [cosAlpha * xshifted - sinAlpha * yshifted + origin[0], sinAlpha * xshifted + cosAlpha * yshifted + origin[1]];
  }

  /**
      @function polygonRotate
      @desc Rotates a point around a given origin.
      @param {Array} poly The polygon to be rotated, which should be an Array of `[x, y]` values.
      @param {Number} alpha The angle in radians to rotate.
      @param {Array} [origin = [0, 0]] The origin point of the rotation, which should be an `[x, y]` formatted Array.
      @returns {Boolean}
  */

  var polygonRotate = (function (poly, alpha) {
    var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [0, 0];
    return poly.map(function (p) {
      return pointRotate(p, alpha, origin);
    });
  });

  /**
      @desc square distance from a point to a segment
      @param {Array} point
      @param {Array} segmentAnchor1
      @param {Array} segmentAnchor2
      @private
  */

  function getSqSegDist(p, p1, p2) {
    var x = p1[0],
        y = p1[1];
    var dx = p2[0] - x,
        dy = p2[1] - y;

    if (dx !== 0 || dy !== 0) {
      var t = ((p[0] - x) * dx + (p[1] - y) * dy) / (dx * dx + dy * dy);

      if (t > 1) {
        x = p2[0];
        y = p2[1];
      } else if (t > 0) {
        x += dx * t;
        y += dy * t;
      }
    }

    dx = p[0] - x;
    dy = p[1] - y;
    return dx * dx + dy * dy;
  }
  /**
      @desc basic distance-based simplification
      @param {Array} polygon
      @param {Number} sqTolerance
      @private
  */


  function simplifyRadialDist(poly, sqTolerance) {
    var point,
        prevPoint = poly[0];
    var newPoints = [prevPoint];

    for (var i = 1, len = poly.length; i < len; i++) {
      point = poly[i];

      if (pointDistanceSquared(point, prevPoint) > sqTolerance) {
        newPoints.push(point);
        prevPoint = point;
      }
    }

    if (prevPoint !== point) newPoints.push(point);
    return newPoints;
  }
  /**
      @param {Array} polygon
      @param {Number} first
      @param {Number} last
      @param {Number} sqTolerance
      @param {Array} simplified
      @private
  */


  function simplifyDPStep(poly, first, last, sqTolerance, simplified) {
    var index,
        maxSqDist = sqTolerance;

    for (var i = first + 1; i < last; i++) {
      var sqDist = getSqSegDist(poly[i], poly[first], poly[last]);

      if (sqDist > maxSqDist) {
        index = i;
        maxSqDist = sqDist;
      }
    }

    if (maxSqDist > sqTolerance) {
      if (index - first > 1) simplifyDPStep(poly, first, index, sqTolerance, simplified);
      simplified.push(poly[index]);
      if (last - index > 1) simplifyDPStep(poly, index, last, sqTolerance, simplified);
    }
  }
  /**
      @desc simplification using Ramer-Douglas-Peucker algorithm
      @param {Array} polygon
      @param {Number} sqTolerance
      @private
  */


  function simplifyDouglasPeucker(poly, sqTolerance) {
    var last = poly.length - 1;
    var simplified = [poly[0]];
    simplifyDPStep(poly, 0, last, sqTolerance, simplified);
    simplified.push(poly[last]);
    return simplified;
  }
  /**
      @function largestRect
      @desc Simplifies the points of a polygon using both the Ramer-Douglas-Peucker algorithm and basic distance-based simplification. Adapted to an ES6 module from the excellent [Simplify.js](http://mourner.github.io/simplify-js/).
      @author Vladimir Agafonkin
      @param {Array} poly An Array of points that represent a polygon.
      @param {Number} [tolerance = 1] Affects the amount of simplification (in the same metric as the point coordinates).
      @param {Boolean} [highestQuality = false] Excludes distance-based preprocessing step which leads to highest quality simplification but runs ~10-20 times slower.

  */


  var simplify = (function (poly) {
    var tolerance = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
    var highestQuality = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    if (poly.length <= 2) return poly;
    var sqTolerance = tolerance * tolerance;
    poly = highestQuality ? poly : simplifyRadialDist(poly, sqTolerance);
    poly = simplifyDouglasPeucker(poly, sqTolerance);
    return poly;
  });

  function _slicedToArray$2(arr, i) {
    return _arrayWithHoles$2(arr) || _iterableToArrayLimit$2(arr, i) || _nonIterableRest$2();
  }

  function _nonIterableRest$2() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance");
  }

  function _iterableToArrayLimit$2(arr, i) {
    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
      return;
    }

    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _arrayWithHoles$2(arr) {
    if (Array.isArray(arr)) return arr;
  }

  var aspectRatioStep = 0.5; // step size for the aspect ratio

  var angleStep = 5; // step size for angles (in degrees); has linear impact on running time

  var polyCache = {};
  /**
      @typedef {Object} LargestRect
      @desc The returned Object of the largestRect function.
      @property {Number} width The width of the rectangle
      @property {Number} height The height of the rectangle
      @property {Number} cx The x coordinate of the rectangle's center
      @property {Number} cy The y coordinate of the rectangle's center
      @property {Number} angle The rotation angle of the rectangle in degrees. The anchor of rotation is the center point.
      @property {Number} area The area of the largest rectangle.
      @property {Array} points An array of x/y coordinates for each point in the rectangle, useful for rendering paths.
  */

  /**
      @function largestRect
      @author Daniel Smilkov [dsmilkov@gmail.com]
      @desc An angle of zero means that the longer side of the polygon (the width) will be aligned with the x axis. An angle of 90 and/or -90 means that the longer side of the polygon (the width) will be aligned with the y axis. The value can be a number between -90 and 90 specifying the angle of rotation of the polygon, a string which is parsed to a number, or an array of numbers specifying the possible rotations of the polygon.
      @param {Array} poly An Array of points that represent a polygon.
      @param {Object} [options] An Object that allows for overriding various parameters of the algorithm.
      @param {Number|String|Array} [options.angle = d3.range(-90, 95, 5)] The allowed rotations of the final rectangle.
      @param {Number|String|Array} [options.aspectRatio] The ratio between the width and height of the rectangle. The value can be a number, a string which is parsed to a number, or an array of numbers specifying the possible aspect ratios of the final rectangle.
      @param {Number} [options.maxAspectRatio = 15] The maximum aspect ratio (width/height) allowed for the rectangle. This property should only be used if the aspectRatio is not provided.
      @param {Number} [options.minAspectRatio = 1] The minimum aspect ratio (width/height) allowed for the rectangle. This property should only be used if the aspectRatio is not provided.
      @param {Number} [options.nTries = 20] The number of randomly drawn points inside the polygon which the algorithm explores as possible center points of the maximal rectangle.
      @param {Number} [options.minHeight = 0] The minimum height of the rectangle.
      @param {Number} [options.minWidth = 0] The minimum width of the rectangle.
      @param {Number} [options.tolerance = 0.02] The simplification tolerance factor, between 0 and 1. A larger tolerance corresponds to more extensive simplification.
      @param {Array} [options.origin] The center point of the rectangle. If specified, the rectangle will be fixed at that point, otherwise the algorithm optimizes across all possible points. The given value can be either a two dimensional array specifying the x and y coordinate of the origin or an array of two dimensional points specifying multiple possible center points of the rectangle.
      @param {Boolean} [options.cache] Whether or not to cache the result, which would be used in subsequent calculations to preserve consistency and speed up calculation time.
      @return {LargestRect}
  */

  function largestRect (poly) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    if (poly.length < 3) {
      if (options.verbose) console.error("polygon has to have at least 3 points", poly);
      return null;
    } // For visualization debugging purposes


    var events = []; // User's input normalization

    options = Object.assign({
      angle: range(-90, 90 + angleStep, angleStep),
      cache: true,
      maxAspectRatio: 15,
      minAspectRatio: 1,
      minHeight: 0,
      minWidth: 0,
      nTries: 20,
      tolerance: 0.02,
      verbose: false
    }, options);
    var angles = options.angle instanceof Array ? options.angle : typeof options.angle === "number" ? [options.angle] : typeof options.angle === "string" && !isNaN(options.angle) ? [Number(options.angle)] : [];
    var aspectRatios = options.aspectRatio instanceof Array ? options.aspectRatio : typeof options.aspectRatio === "number" ? [options.aspectRatio] : typeof options.aspectRatio === "string" && !isNaN(options.aspectRatio) ? [Number(options.aspectRatio)] : [];
    var origins = options.origin && options.origin instanceof Array ? options.origin[0] instanceof Array ? options.origin : [options.origin] : [];
    var cacheString;

    if (options.cache) {
      cacheString = merge(poly).join(",");
      cacheString += "-".concat(options.minAspectRatio);
      cacheString += "-".concat(options.maxAspectRatio);
      cacheString += "-".concat(options.minHeight);
      cacheString += "-".concat(options.minWidth);
      cacheString += "-".concat(angles.join(","));
      cacheString += "-".concat(origins.join(","));
      if (polyCache[cacheString]) return polyCache[cacheString];
    }

    var area = Math.abs(polygonArea(poly)); // take absolute value of the signed area

    if (area === 0) {
      if (options.verbose) console.error("polygon has 0 area", poly);
      return null;
    } // get the width of the bounding box of the original polygon to determine tolerance


    var _extent = extent(poly, function (d) {
      return d[0];
    }),
        _extent2 = _slicedToArray$2(_extent, 2),
        minx = _extent2[0],
        maxx = _extent2[1];

    var _extent3 = extent(poly, function (d) {
      return d[1];
    }),
        _extent4 = _slicedToArray$2(_extent3, 2),
        miny = _extent4[0],
        maxy = _extent4[1]; // simplify polygon


    var tolerance = Math.min(maxx - minx, maxy - miny) * options.tolerance;
    if (tolerance > 0) poly = simplify(poly, tolerance);
    if (options.events) events.push({
      type: "simplify",
      poly: poly
    }); // get the width of the bounding box of the simplified polygon

    var _extent5 = extent(poly, function (d) {
      return d[0];
    });

    var _extent6 = _slicedToArray$2(_extent5, 2);

    minx = _extent6[0];
    maxx = _extent6[1];

    var _extent7 = extent(poly, function (d) {
      return d[1];
    });

    var _extent8 = _slicedToArray$2(_extent7, 2);

    miny = _extent8[0];
    maxy = _extent8[1];
    var boxWidth = maxx - minx,
        boxHeight = maxy - miny; // discretize the binary search for optimal width to a resolution of this times the polygon width

    var widthStep = Math.min(boxWidth, boxHeight) / 50; // populate possible center points with random points inside the polygon

    if (!origins.length) {
      // get the centroid of the polygon
      var centroid = polygonCentroid(poly);

      if (!isFinite(centroid[0])) {
        if (options.verbose) console.error("cannot find centroid", poly);
        return null;
      }

      if (polygonContains(poly, centroid)) origins.push(centroid);
      var nTries = options.nTries; // get few more points inside the polygon

      while (nTries) {
        var rndX = Math.random() * boxWidth + minx;
        var rndY = Math.random() * boxHeight + miny;
        var rndPoint = [rndX, rndY];

        if (polygonContains(poly, rndPoint)) {
          origins.push(rndPoint);
        }

        nTries--;
      }
    }

    if (options.events) events.push({
      type: "origins",
      points: origins
    });
    var maxArea = 0;
    var maxRect = null;

    for (var ai = 0; ai < angles.length; ai++) {
      var angle = angles[ai];
      var angleRad = -angle * Math.PI / 180;
      if (options.events) events.push({
        type: "angle",
        angle: angle
      });

      for (var i = 0; i < origins.length; i++) {
        var origOrigin = origins[i]; // generate improved origins

        var _polygonRayCast = polygonRayCast(poly, origOrigin, angleRad),
            _polygonRayCast2 = _slicedToArray$2(_polygonRayCast, 2),
            p1W = _polygonRayCast2[0],
            p2W = _polygonRayCast2[1];

        var _polygonRayCast3 = polygonRayCast(poly, origOrigin, angleRad + Math.PI / 2),
            _polygonRayCast4 = _slicedToArray$2(_polygonRayCast3, 2),
            p1H = _polygonRayCast4[0],
            p2H = _polygonRayCast4[1];

        var modifOrigins = [];
        if (p1W && p2W) modifOrigins.push([(p1W[0] + p2W[0]) / 2, (p1W[1] + p2W[1]) / 2]); // average along with width axis

        if (p1H && p2H) modifOrigins.push([(p1H[0] + p2H[0]) / 2, (p1H[1] + p2H[1]) / 2]); // average along with height axis

        if (options.events) events.push({
          type: "modifOrigin",
          idx: i,
          p1W: p1W,
          p2W: p2W,
          p1H: p1H,
          p2H: p2H,
          modifOrigins: modifOrigins
        });

        for (var _i2 = 0; _i2 < modifOrigins.length; _i2++) {
          var origin = modifOrigins[_i2];
          if (options.events) events.push({
            type: "origin",
            cx: origin[0],
            cy: origin[1]
          });

          var _polygonRayCast5 = polygonRayCast(poly, origin, angleRad),
              _polygonRayCast6 = _slicedToArray$2(_polygonRayCast5, 2),
              _p1W = _polygonRayCast6[0],
              _p2W = _polygonRayCast6[1];

          if (_p1W === null || _p2W === null) continue;
          var minSqDistW = Math.min(pointDistanceSquared(origin, _p1W), pointDistanceSquared(origin, _p2W));
          var maxWidth = 2 * Math.sqrt(minSqDistW);

          var _polygonRayCast7 = polygonRayCast(poly, origin, angleRad + Math.PI / 2),
              _polygonRayCast8 = _slicedToArray$2(_polygonRayCast7, 2),
              _p1H = _polygonRayCast8[0],
              _p2H = _polygonRayCast8[1];

          if (_p1H === null || _p2H === null) continue;
          var minSqDistH = Math.min(pointDistanceSquared(origin, _p1H), pointDistanceSquared(origin, _p2H));
          var maxHeight = 2 * Math.sqrt(minSqDistH);
          if (maxWidth * maxHeight < maxArea) continue;
          var aRatios = aspectRatios;

          if (!aRatios.length) {
            var minAspectRatio = Math.max(options.minAspectRatio, options.minWidth / maxHeight, maxArea / (maxHeight * maxHeight));
            var maxAspectRatio = Math.min(options.maxAspectRatio, maxWidth / options.minHeight, maxWidth * maxWidth / maxArea);
            aRatios = range(minAspectRatio, maxAspectRatio + aspectRatioStep, aspectRatioStep);
          }

          for (var a = 0; a < aRatios.length; a++) {
            var aRatio = aRatios[a]; // do a binary search to find the max width that works

            var left = Math.max(options.minWidth, Math.sqrt(maxArea * aRatio));
            var right = Math.min(maxWidth, maxHeight * aRatio);
            if (right * maxHeight < maxArea) continue;
            if (options.events && right - left >= widthStep) events.push({
              type: "aRatio",
              aRatio: aRatio
            });

            while (right - left >= widthStep) {
              var width = (left + right) / 2;
              var height = width / aRatio;

              var _origin = _slicedToArray$2(origin, 2),
                  cx = _origin[0],
                  cy = _origin[1];

              var rectPoly = [[cx - width / 2, cy - height / 2], [cx + width / 2, cy - height / 2], [cx + width / 2, cy + height / 2], [cx - width / 2, cy + height / 2]];
              rectPoly = polygonRotate(rectPoly, angleRad, origin);
              var insidePoly = polygonInside(rectPoly, poly);

              if (insidePoly) {
                // we know that the area is already greater than the maxArea found so far
                maxArea = width * height;
                rectPoly.push(rectPoly[0]);
                maxRect = {
                  area: maxArea,
                  cx: cx,
                  cy: cy,
                  width: width,
                  height: height,
                  angle: -angle,
                  points: rectPoly
                };
                left = width; // increase the width in the binary search
              } else {
                right = width; // decrease the width in the binary search
              }

              if (options.events) events.push({
                type: "rectangle",
                areaFraction: width * height / area,
                cx: cx,
                cy: cy,
                width: width,
                height: height,
                angle: angle,
                insidePoly: insidePoly
              });
            }
          }
        }
      }
    }

    if (options.cache) {
      polyCache[cacheString] = maxRect;
    }

    return options.events ? Object.assign(maxRect || {}, {
      events: events
    }) : maxRect;
  }

  function _typeof$6(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$6 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$6 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$6(obj);
  }

  function _classCallCheck$4(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$4(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$4(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$4(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$4(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$2(self, call) {
    if (call && (_typeof$6(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$2(self);
  }

  function _assertThisInitialized$2(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get = Reflect.get;
    } else {
      _get = function _get(target, property, receiver) {
        var base = _superPropBase(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get(target, property, receiver || target);
  }

  function _superPropBase(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$2(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$2(o) {
    _getPrototypeOf$2 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$2(o);
  }

  function _inherits$2(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$2(subClass, superClass);
  }

  function _setPrototypeOf$2(o, p) {
    _setPrototypeOf$2 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$2(o, p);
  }
  /**
      @class Area
      @extends Shape
      @desc Creates SVG areas based on an array of data.
  */

  var Area =
  /*#__PURE__*/
  function (_Shape) {
    _inherits$2(Area, _Shape);
    /**
        @memberof Area
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Shape.
        @private
    */


    function Area() {
      var _this;

      _classCallCheck$4(this, Area);

      _this = _possibleConstructorReturn$2(this, _getPrototypeOf$2(Area).call(this));
      _this._curve = "linear";

      _this._defined = function () {
        return true;
      };

      _this._labelBounds = function (d, i, aes) {
        var r = largestRect(aes.points);
        if (!r) return null;
        return {
          angle: r.angle,
          width: r.width,
          height: r.height,
          x: r.cx - r.width / 2 - _this._x(d, i),
          y: r.cy - r.height / 2 - _this._y(d, i)
        };
      };

      _this._labelConfig = Object.assign(_this._labelConfig, {
        textAnchor: "middle",
        verticalAlign: "middle"
      });
      _this._name = "Area";
      _this._x = accessor("x");
      _this._x0 = accessor("x");
      _this._x1 = null;
      _this._y = constant$3(0);
      _this._y0 = constant$3(0);
      _this._y1 = accessor("y");
      return _this;
    }
    /**
        @memberof Area
        @desc Given a specific data point and index, returns the aesthetic properties of the shape.
        @param {Object} *data point*
        @param {Number} *index*
        @private
    */


    _createClass$4(Area, [{
      key: "_aes",
      value: function _aes(d) {
        var _this2 = this;

        var values = d.values.slice().sort(function (a, b) {
          return _this2._y1 ? _this2._x(a) - _this2._x(b) : _this2._y(a) - _this2._y(b);
        });
        var points1 = values.map(function (v, z) {
          return [_this2._x0(v, z), _this2._y0(v, z)];
        });
        var points2 = values.reverse().map(function (v, z) {
          return _this2._y1 ? [_this2._x(v, z), _this2._y1(v, z)] : [_this2._x1(v, z), _this2._y(v, z)];
        });
        var points = points1.concat(points2);
        if (points1[0][1] > points2[0][1]) points = points.reverse();
        points.push(points[0]);
        return {
          points: points
        };
      }
      /**
          @memberof Area
          @desc Filters/manipulates the data array before binding each point to an SVG group.
          @param {Array} [*data* = the data array to be filtered]
          @private
      */

    }, {
      key: "_dataFilter",
      value: function _dataFilter(data) {
        var _this3 = this;

        var areas = nest().key(this._id).entries(data).map(function (d) {
          d.data = objectMerge(d.values);
          d.i = data.indexOf(d.values[0]);
          var x = extent(d.values.map(_this3._x).concat(d.values.map(_this3._x0)).concat(_this3._x1 ? d.values.map(_this3._x1) : []));
          d.xR = x;
          d.width = x[1] - x[0];
          d.x = x[0] + d.width / 2;
          var y = extent(d.values.map(_this3._y).concat(d.values.map(_this3._y0)).concat(_this3._y1 ? d.values.map(_this3._y1) : []));
          d.yR = y;
          d.height = y[1] - y[0];
          d.y = y[0] + d.height / 2;
          d.nested = true;
          d.translate = [d.x, d.y];
          d.__d3plusShape__ = true;
          return d;
        });

        areas.key = function (d) {
          return d.key;
        };

        return areas;
      }
      /**
          @memberof Area
          @desc Draws the area polygons.
          @param {Function} [*callback*]
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        var _this4 = this;

        _get(_getPrototypeOf$2(Area.prototype), "render", this).call(this, callback);

        var path = this._path = area().defined(this._defined).curve(d3Shape["curve".concat(this._curve.charAt(0).toUpperCase()).concat(this._curve.slice(1))]).x(this._x).x0(this._x0).x1(this._x1).y(this._y).y0(this._y0).y1(this._y1);
        var exitPath = area().defined(function (d) {
          return d;
        }).curve(d3Shape["curve".concat(this._curve.charAt(0).toUpperCase()).concat(this._curve.slice(1))]).x(this._x).y(this._y).x0(function (d, i) {
          return _this4._x1 ? _this4._x0(d, i) + (_this4._x1(d, i) - _this4._x0(d, i)) / 2 : _this4._x0(d, i);
        }).x1(function (d, i) {
          return _this4._x1 ? _this4._x0(d, i) + (_this4._x1(d, i) - _this4._x0(d, i)) / 2 : _this4._x0(d, i);
        }).y0(function (d, i) {
          return _this4._y1 ? _this4._y0(d, i) + (_this4._y1(d, i) - _this4._y0(d, i)) / 2 : _this4._y0(d, i);
        }).y1(function (d, i) {
          return _this4._y1 ? _this4._y0(d, i) + (_this4._y1(d, i) - _this4._y0(d, i)) / 2 : _this4._y0(d, i);
        });

        this._enter.append("path").attr("transform", function (d) {
          return "translate(".concat(-d.xR[0] - d.width / 2, ", ").concat(-d.yR[0] - d.height / 2, ")");
        }).attr("d", function (d) {
          return exitPath(d.values);
        }).call(this._applyStyle.bind(this)).transition(this._transition).attrTween("d", function (d) {
          return interpolatePath(_select(this).attr("d"), path(d.values));
        });

        this._update.select("path").transition(this._transition).attr("transform", function (d) {
          return "translate(".concat(-d.xR[0] - d.width / 2, ", ").concat(-d.yR[0] - d.height / 2, ")");
        }).attrTween("d", function (d) {
          return interpolatePath(_select(this).attr("d"), path(d.values));
        }).call(this._applyStyle.bind(this));

        this._exit.select("path").transition(this._transition).attrTween("d", function (d) {
          return interpolatePath(_select(this).attr("d"), exitPath(d.values));
        });

        return this;
      }
      /**
          @memberof Area
          @desc If *value* is specified, sets the area curve to the specified string and returns the current class instance. If *value* is not specified, returns the current area curve.
          @param {String} [*value* = "linear"]
          @chainable
      */

    }, {
      key: "curve",
      value: function curve(_) {
        return arguments.length ? (this._curve = _, this) : this._curve;
      }
      /**
          @memberof Area
          @desc If *value* is specified, sets the defined accessor to the specified function and returns the current class instance. If *value* is not specified, returns the current defined accessor.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "defined",
      value: function defined(_) {
        return arguments.length ? (this._defined = _, this) : this._defined;
      }
      /**
          @memberof Area
          @desc If *value* is specified, sets the x accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current x accessor.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "x",
      value: function x(_) {
        if (!arguments.length) return this._x;
        this._x = typeof _ === "function" ? _ : constant$3(_);
        this._x0 = this._x;
        return this;
      }
      /**
          @memberof Area
          @desc If *value* is specified, sets the x0 accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current x0 accessor.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "x0",
      value: function x0(_) {
        if (!arguments.length) return this._x0;
        this._x0 = typeof _ === "function" ? _ : constant$3(_);
        this._x = this._x0;
        return this;
      }
      /**
          @memberof Area
          @desc If *value* is specified, sets the x1 accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current x1 accessor.
          @param {Function|Number|null} [*value*]
          @chainable
      */

    }, {
      key: "x1",
      value: function x1(_) {
        return arguments.length ? (this._x1 = typeof _ === "function" || _ === null ? _ : constant$3(_), this) : this._x1;
      }
      /**
          @memberof Area
          @desc If *value* is specified, sets the y accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current y accessor.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "y",
      value: function y(_) {
        if (!arguments.length) return this._y;
        this._y = typeof _ === "function" ? _ : constant$3(_);
        this._y0 = this._y;
        return this;
      }
      /**
          @memberof Area
          @desc If *value* is specified, sets the y0 accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current y0 accessor.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "y0",
      value: function y0(_) {
        if (!arguments.length) return this._y0;
        this._y0 = typeof _ === "function" ? _ : constant$3(_);
        this._y = this._y0;
        return this;
      }
      /**
          @memberof Area
          @desc If *value* is specified, sets the y1 accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current y1 accessor.
          @param {Function|Number|null} [*value*]
          @chainable
      */

    }, {
      key: "y1",
      value: function y1(_) {
        return arguments.length ? (this._y1 = typeof _ === "function" || _ === null ? _ : constant$3(_), this) : this._y1;
      }
    }]);

    return Area;
  }(Shape);

  function _typeof$7(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$7 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$7 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$7(obj);
  }

  function _classCallCheck$5(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$5(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$5(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$5(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$5(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$3(self, call) {
    if (call && (_typeof$7(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$3(self);
  }

  function _assertThisInitialized$3(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$1(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$1 = Reflect.get;
    } else {
      _get$1 = function _get(target, property, receiver) {
        var base = _superPropBase$1(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$1(target, property, receiver || target);
  }

  function _superPropBase$1(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$3(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$3(o) {
    _getPrototypeOf$3 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$3(o);
  }

  function _inherits$3(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$3(subClass, superClass);
  }

  function _setPrototypeOf$3(o, p) {
    _setPrototypeOf$3 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$3(o, p);
  }
  /**
      @class Bar
      @extends Shape
      @desc Creates SVG areas based on an array of data.
  */

  var Bar =
  /*#__PURE__*/
  function (_Shape) {
    _inherits$3(Bar, _Shape);
    /**
        @memberof Bar
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Shape.
        @private
    */


    function Bar() {
      var _this;

      _classCallCheck$5(this, Bar);

      _this = _possibleConstructorReturn$3(this, _getPrototypeOf$3(Bar).call(this, "rect"));
      _this._name = "Bar";
      _this._height = constant$3(10);

      _this._labelBounds = function (d, i, s) {
        return {
          width: s.width,
          height: s.height,
          x: _this._x1 !== null ? _this._getX(d, i) : -s.width / 2,
          y: _this._x1 === null ? _this._getY(d, i) : -s.height / 2
        };
      };

      _this._width = constant$3(10);
      _this._x = accessor("x");
      _this._x0 = accessor("x");
      _this._x1 = null;
      _this._y = constant$3(0);
      _this._y0 = constant$3(0);
      _this._y1 = accessor("y");
      return _this;
    }
    /**
        @memberof Bar
        @desc Draws the bars.
        @param {Function} [*callback*]
        @chainable
    */


    _createClass$5(Bar, [{
      key: "render",
      value: function render(callback) {
        var _this2 = this;

        _get$1(_getPrototypeOf$3(Bar.prototype), "render", this).call(this, callback);

        var enter = this._enter.attr("width", function (d, i) {
          return _this2._x1 === null ? _this2._getWidth(d, i) : 0;
        }).attr("height", function (d, i) {
          return _this2._x1 !== null ? _this2._getHeight(d, i) : 0;
        }).attr("x", function (d, i) {
          return _this2._x1 === null ? -_this2._getWidth(d, i) / 2 : 0;
        }).attr("y", function (d, i) {
          return _this2._x1 !== null ? -_this2._getHeight(d, i) / 2 : 0;
        }).call(this._applyStyle.bind(this));

        var update = this._update;

        if (this._duration) {
          enter = enter.transition(this._transition);
          update = update.transition(this._transition);

          this._exit.transition(this._transition).attr("width", function (d, i) {
            return _this2._x1 === null ? _this2._getWidth(d, i) : 0;
          }).attr("height", function (d, i) {
            return _this2._x1 !== null ? _this2._getHeight(d, i) : 0;
          }).attr("x", function (d, i) {
            return _this2._x1 === null ? -_this2._getWidth(d, i) / 2 : 0;
          }).attr("y", function (d, i) {
            return _this2._x1 !== null ? -_this2._getHeight(d, i) / 2 : 0;
          });
        }

        enter.call(this._applyPosition.bind(this));
        update.call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));
        return this;
      }
      /**
          @memberof Bar
          @desc Given a specific data point and index, returns the aesthetic properties of the shape.
          @param {Object} *data point*
          @param {Number} *index*
          @private
      */

    }, {
      key: "_aes",
      value: function _aes(d, i) {
        return {
          height: this._getHeight(d, i),
          width: this._getWidth(d, i)
        };
      }
      /**
          @memberof Bar
          @desc Provides the default positioning to the <rect> elements.
          @param {D3Selection} *elem*
          @private
      */

    }, {
      key: "_applyPosition",
      value: function _applyPosition(elem) {
        var _this3 = this;

        elem.attr("width", function (d, i) {
          return _this3._getWidth(d, i);
        }).attr("height", function (d, i) {
          return _this3._getHeight(d, i);
        }).attr("x", function (d, i) {
          return _this3._x1 !== null ? _this3._getX(d, i) : -_this3._getWidth(d, i) / 2;
        }).attr("y", function (d, i) {
          return _this3._x1 === null ? _this3._getY(d, i) : -_this3._getHeight(d, i) / 2;
        });
      }
      /**
          @memberof Bar
          @desc Calculates the height of the <rect> by assessing the x and y properties.
          @param {Object} *d*
          @param {Number} *i*
          @private
      */

    }, {
      key: "_getHeight",
      value: function _getHeight(d, i) {
        if (this._x1 !== null) return this._height(d, i);
        return Math.abs(this._y1(d, i) - this._y(d, i));
      }
      /**
          @memberof Bar
          @desc Calculates the width of the <rect> by assessing the x and y properties.
          @param {Object} *d*
          @param {Number} *i*
          @private
      */

    }, {
      key: "_getWidth",
      value: function _getWidth(d, i) {
        if (this._x1 === null) return this._width(d, i);
        return Math.abs(this._x1(d, i) - this._x(d, i));
      }
      /**
          @memberof Bar
          @desc Calculates the x of the <rect> by assessing the x and width properties.
          @param {Object} *d*
          @param {Number} *i*
          @private
      */

    }, {
      key: "_getX",
      value: function _getX(d, i) {
        var w = this._x1 === null ? this._x(d, i) : this._x1(d, i) - this._x(d, i);
        if (w < 0) return w;else return 0;
      }
      /**
          @memberof Bar
          @desc Calculates the y of the <rect> by assessing the y and height properties.
          @param {Object} *d*
          @param {Number} *i*
          @private
      */

    }, {
      key: "_getY",
      value: function _getY(d, i) {
        var h = this._x1 !== null ? this._y(d, i) : this._y1(d, i) - this._y(d, i);
        if (h < 0) return h;else return 0;
      }
      /**
          @memberof Bar
          @desc If *value* is specified, sets the height accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.height;
      }
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = typeof _ === "function" ? _ : constant$3(_), this) : this._height;
      }
      /**
          @memberof Bar
          @desc If *value* is specified, sets the width accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.width;
      }
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = typeof _ === "function" ? _ : constant$3(_), this) : this._width;
      }
      /**
          @memberof Bar
          @desc If *value* is specified, sets the x0 accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "x0",
      value: function x0(_) {
        if (!arguments.length) return this._x0;
        this._x0 = typeof _ === "function" ? _ : constant$3(_);
        this._x = this._x0;
        return this;
      }
      /**
          @memberof Bar
          @desc If *value* is specified, sets the x1 accessor to the specified function or number and returns the current class instance.
          @param {Function|Number|null} [*value*]
          @chainable
      */

    }, {
      key: "x1",
      value: function x1(_) {
        return arguments.length ? (this._x1 = typeof _ === "function" || _ === null ? _ : constant$3(_), this) : this._x1;
      }
      /**
          @memberof Bar
          @desc If *value* is specified, sets the y0 accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "y0",
      value: function y0(_) {
        if (!arguments.length) return this._y0;
        this._y0 = typeof _ === "function" ? _ : constant$3(_);
        this._y = this._y0;
        return this;
      }
      /**
          @memberof Bar
          @desc If *value* is specified, sets the y1 accessor to the specified function or number and returns the current class instance.
          @param {Function|Number|null} [*value*]
          @chainable
      */

    }, {
      key: "y1",
      value: function y1(_) {
        return arguments.length ? (this._y1 = typeof _ === "function" || _ === null ? _ : constant$3(_), this) : this._y1;
      }
    }]);

    return Bar;
  }(Shape);

  function _typeof$8(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$8 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$8 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$8(obj);
  }

  function _classCallCheck$6(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$6(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$6(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$6(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$6(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$4(self, call) {
    if (call && (_typeof$8(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$4(self);
  }

  function _assertThisInitialized$4(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$2(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$2 = Reflect.get;
    } else {
      _get$2 = function _get(target, property, receiver) {
        var base = _superPropBase$2(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$2(target, property, receiver || target);
  }

  function _superPropBase$2(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$4(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$4(o) {
    _getPrototypeOf$4 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$4(o);
  }

  function _inherits$4(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$4(subClass, superClass);
  }

  function _setPrototypeOf$4(o, p) {
    _setPrototypeOf$4 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$4(o, p);
  }
  /**
      @class Circle
      @extends Shape
      @desc Creates SVG circles based on an array of data.
  */

  var Circle =
  /*#__PURE__*/
  function (_Shape) {
    _inherits$4(Circle, _Shape);
    /**
        @memberof Circle
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Shape.
        @private
    */


    function Circle() {
      var _this;

      _classCallCheck$6(this, Circle);

      _this = _possibleConstructorReturn$4(this, _getPrototypeOf$4(Circle).call(this, "circle"));

      _this._labelBounds = function (d, i, s) {
        return {
          width: s.r * 1.5,
          height: s.r * 1.5,
          x: -s.r * 0.75,
          y: -s.r * 0.75
        };
      };

      _this._labelConfig = assign(_this._labelConfig, {
        textAnchor: "middle",
        verticalAlign: "middle"
      });
      _this._name = "Circle";
      _this._r = accessor("r");
      return _this;
    }
    /**
        @memberof Circle
        @desc Provides the default positioning to the <rect> elements.
        @private
    */


    _createClass$6(Circle, [{
      key: "_applyPosition",
      value: function _applyPosition(elem) {
        var _this2 = this;

        elem.attr("r", function (d, i) {
          return _this2._r(d, i);
        }).attr("x", function (d, i) {
          return -_this2._r(d, i) / 2;
        }).attr("y", function (d, i) {
          return -_this2._r(d, i) / 2;
        });
      }
      /**
          @memberof Circle
          @desc Draws the circles.
          @param {Function} [*callback*]
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        _get$2(_getPrototypeOf$4(Circle.prototype), "render", this).call(this, callback);

        var enter = this._enter.call(this._applyStyle.bind(this));

        var update = this._update;

        if (this._duration) {
          enter.attr("r", 0).attr("x", 0).attr("y", 0).transition(this._transition).call(this._applyPosition.bind(this));
          update = update.transition(this._transition);

          this._exit.transition(this._transition).attr("r", 0).attr("x", 0).attr("y", 0);
        } else {
          enter.call(this._applyPosition.bind(this));
        }

        update.call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));
        return this;
      }
      /**
          @memberof Circle
          @desc Given a specific data point and index, returns the aesthetic properties of the shape.
          @param {Object} *data point*
          @param {Number} *index*
          @private
      */

    }, {
      key: "_aes",
      value: function _aes(d, i) {
        return {
          r: this._r(d, i)
        };
      }
      /**
          @memberof Circle
          @desc If *value* is specified, sets the radius accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.r;
      }
      */

    }, {
      key: "r",
      value: function r(_) {
        return arguments.length ? (this._r = typeof _ === "function" ? _ : constant$3(_), this) : this._r;
      }
    }]);

    return Circle;
  }(Shape);

  function _typeof$9(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$9 = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$9 = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$9(obj);
  }

  function _classCallCheck$7(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$7(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$7(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$7(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$7(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$5(self, call) {
    if (call && (_typeof$9(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$5(self);
  }

  function _assertThisInitialized$5(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$3(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$3 = Reflect.get;
    } else {
      _get$3 = function _get(target, property, receiver) {
        var base = _superPropBase$3(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$3(target, property, receiver || target);
  }

  function _superPropBase$3(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$5(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$5(o) {
    _getPrototypeOf$5 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$5(o);
  }

  function _inherits$5(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$5(subClass, superClass);
  }

  function _setPrototypeOf$5(o, p) {
    _setPrototypeOf$5 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$5(o, p);
  }
  /**
      @class Rect
      @extends Shape
      @desc Creates SVG rectangles based on an array of data. See [this example](https://d3plus.org/examples/d3plus-shape/getting-started/) for help getting started using the rectangle generator.
  */

  var Rect =
  /*#__PURE__*/
  function (_Shape) {
    _inherits$5(Rect, _Shape);
    /**
        @memberof Rect
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Shape.
        @private
    */


    function Rect() {
      var _this;

      _classCallCheck$7(this, Rect);

      _this = _possibleConstructorReturn$5(this, _getPrototypeOf$5(Rect).call(this, "rect"));
      _this._height = accessor("height");

      _this._labelBounds = function (d, i, s) {
        return {
          width: s.width,
          height: s.height,
          x: -s.width / 2,
          y: -s.height / 2
        };
      };

      _this._name = "Rect";
      _this._width = accessor("width");
      return _this;
    }
    /**
        @memberof Rect
        @desc Draws the rectangles.
        @param {Function} [*callback*]
        @chainable
    */


    _createClass$7(Rect, [{
      key: "render",
      value: function render(callback) {
        _get$3(_getPrototypeOf$5(Rect.prototype), "render", this).call(this, callback);

        var enter = this._enter.attr("width", 0).attr("height", 0).attr("x", 0).attr("y", 0).call(this._applyStyle.bind(this));

        var update = this._update;

        if (this._duration) {
          enter = enter.transition(this._transition);
          update = update.transition(this._transition);

          this._exit.transition(this._transition).attr("width", 0).attr("height", 0).attr("x", 0).attr("y", 0);
        }

        enter.call(this._applyPosition.bind(this));
        update.call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));
        return this;
      }
      /**
          @memberof Rect
          @desc Given a specific data point and index, returns the aesthetic properties of the shape.
          @param {Object} *data point*
          @param {Number} *index*
          @private
      */

    }, {
      key: "_aes",
      value: function _aes(d, i) {
        return {
          width: this._width(d, i),
          height: this._height(d, i)
        };
      }
      /**
          @memberof Rect
          @desc Provides the default positioning to the <rect> elements.
          @param {D3Selection} *elem*
          @private
      */

    }, {
      key: "_applyPosition",
      value: function _applyPosition(elem) {
        var _this2 = this;

        elem.attr("width", function (d, i) {
          return _this2._width(d, i);
        }).attr("height", function (d, i) {
          return _this2._height(d, i);
        }).attr("x", function (d, i) {
          return -_this2._width(d, i) / 2;
        }).attr("y", function (d, i) {
          return -_this2._height(d, i) / 2;
        });
      }
      /**
          @memberof Rect
          @desc If *value* is specified, sets the height accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.height;
      }
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = typeof _ === "function" ? _ : constant$3(_), this) : this._height;
      }
      /**
          @memberof Rect
          @desc If *value* is specified, sets the width accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.width;
      }
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = typeof _ === "function" ? _ : constant$3(_), this) : this._width;
      }
    }]);

    return Rect;
  }(Shape);

  function _typeof$a(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$a = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$a = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$a(obj);
  }

  function _classCallCheck$8(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$8(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$8(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$8(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$8(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$6(self, call) {
    if (call && (_typeof$a(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$6(self);
  }

  function _assertThisInitialized$6(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$4(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$4 = Reflect.get;
    } else {
      _get$4 = function _get(target, property, receiver) {
        var base = _superPropBase$4(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$4(target, property, receiver || target);
  }

  function _superPropBase$4(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$6(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$6(o) {
    _getPrototypeOf$6 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$6(o);
  }

  function _inherits$6(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$6(subClass, superClass);
  }

  function _setPrototypeOf$6(o, p) {
    _setPrototypeOf$6 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$6(o, p);
  }
  /**
      @class Line
      @extends Shape
      @desc Creates SVG lines based on an array of data.
  */

  var Line =
  /*#__PURE__*/
  function (_Shape) {
    _inherits$6(Line, _Shape);
    /**
        @memberof Line
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Shape.
        @private
    */


    function Line() {
      var _this;

      _classCallCheck$8(this, Line);

      _this = _possibleConstructorReturn$6(this, _getPrototypeOf$6(Line).call(this));
      _this._curve = "linear";

      _this._defined = function (d) {
        return d;
      };

      _this._fill = constant$3("none");
      _this._hitArea = constant$3({
        "d": function d(_d) {
          return _this._path(_d.values);
        },
        "fill": "none",
        "stroke-width": 10,
        "transform": null
      });
      _this._name = "Line";
      _this._path = line();
      _this._stroke = constant$3("black");
      _this._strokeWidth = constant$3(1);
      return _this;
    }
    /**
        @memberof Line
        @desc Filters/manipulates the data array before binding each point to an SVG group.
        @param {Array} [*data* = the data array to be filtered]
        @private
    */


    _createClass$8(Line, [{
      key: "_dataFilter",
      value: function _dataFilter(data) {
        var _this2 = this;

        var lines = nest().key(this._id).entries(data).map(function (d) {
          d.data = objectMerge(d.values);
          d.i = data.indexOf(d.values[0]);
          var x = extent(d.values, _this2._x);
          d.xR = x;
          d.width = x[1] - x[0];
          d.x = x[0] + d.width / 2;
          var y = extent(d.values, _this2._y);
          d.yR = y;
          d.height = y[1] - y[0];
          d.y = y[0] + d.height / 2;
          d.nested = true;
          d.translate = [d.x, d.y];
          d.__d3plusShape__ = true;
          return d;
        });

        lines.key = function (d) {
          return d.key;
        };

        return lines;
      }
      /**
          @memberof Line
          @desc Draws the lines.
          @param {Function} [*callback*]
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        var _this3 = this;

        _get$4(_getPrototypeOf$6(Line.prototype), "render", this).call(this, callback);

        var that = this;
        /**
            @desc Calculates the stroke-dasharray used for animations
            @param {Object} *d* data point
            @private
        */

        function calculateStrokeDashArray(d) {
          d.initialLength = this.getTotalLength();

          var strokeArray = that._strokeDasharray(d.values[0], that._data.indexOf(d.values[0])).split(" ").map(Number);

          if (strokeArray.length === 1 && strokeArray[0] === 0) strokeArray = [d.initialLength];else if (strokeArray.length === 1) strokeArray.push(strokeArray[0]);else if (strokeArray.length % 2) strokeArray = strokeArray.concat(strokeArray);
          var newStrokeArray = [];
          var strokeLength = 0;

          while (strokeLength < d.initialLength) {
            for (var i = 0; i < strokeArray.length; i++) {
              var num = strokeArray[i];
              strokeLength += num;
              newStrokeArray.push(num);
              if (strokeLength >= d.initialLength) break;
            }
          }

          if (newStrokeArray.length > 1 && newStrokeArray.length % 2) newStrokeArray.pop();
          newStrokeArray[newStrokeArray.length - 1] += d.initialLength - sum(newStrokeArray);
          if (newStrokeArray.length % 2 === 0) newStrokeArray.push(0);
          d.initialStrokeArray = newStrokeArray.join(" ");
        }

        this._path.curve(d3Shape["curve".concat(this._curve.charAt(0).toUpperCase()).concat(this._curve.slice(1))]).defined(this._defined).x(this._x).y(this._y);

        var enter = this._enter.append("path").attr("transform", function (d) {
          return "translate(".concat(-d.xR[0] - d.width / 2, ", ").concat(-d.yR[0] - d.height / 2, ")");
        }).attr("d", function (d) {
          return _this3._path(d.values);
        }).call(this._applyStyle.bind(this));

        var update = this._update.select("path").attr("stroke-dasharray", function (d) {
          return that._strokeDasharray(d.values[0], that._data.indexOf(d.values[0]));
        });

        if (this._duration) {
          enter.each(calculateStrokeDashArray).attr("stroke-dasharray", function (d) {
            return "".concat(d.initialStrokeArray, " ").concat(d.initialLength);
          }).attr("stroke-dashoffset", function (d) {
            return d.initialLength;
          }).transition(this._transition).attr("stroke-dashoffset", 0);
          update = update.transition(this._transition).attrTween("d", function (d) {
            return interpolatePath(_select(this).attr("d"), that._path(d.values));
          });

          this._exit.selectAll("path").each(calculateStrokeDashArray).attr("stroke-dasharray", function (d) {
            return "".concat(d.initialStrokeArray, " ").concat(d.initialLength);
          }).transition(this._transition).attr("stroke-dashoffset", function (d) {
            return -d.initialLength;
          });
        } else {
          update = update.attr("d", function (d) {
            return that._path(d.values);
          });
        }

        update.attr("transform", function (d) {
          return "translate(".concat(-d.xR[0] - d.width / 2, ", ").concat(-d.yR[0] - d.height / 2, ")");
        }).call(this._applyStyle.bind(this));
        return this;
      }
      /**
          @memberof Line
          @desc Given a specific data point and index, returns the aesthetic properties of the shape.
          @param {Object} *data point*
          @param {Number} *index*
          @private
      */

    }, {
      key: "_aes",
      value: function _aes(d, i) {
        var _this4 = this;

        return {
          points: d.values.map(function (p) {
            return [_this4._x(p, i), _this4._y(p, i)];
          })
        };
      }
      /**
          @memberof Line
          @desc If *value* is specified, sets the line curve to the specified string and returns the current class instance. If *value* is not specified, returns the current line curve.
          @param {String} [*value* = "linear"]
          @chainable
      */

    }, {
      key: "curve",
      value: function curve(_) {
        return arguments.length ? (this._curve = _, this) : this._curve;
      }
      /**
          @memberof Line
          @desc If *value* is specified, sets the defined accessor to the specified function and returns the current class instance. If *value* is not specified, returns the current defined accessor.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "defined",
      value: function defined(_) {
        return arguments.length ? (this._defined = _, this) : this._defined;
      }
    }]);

    return Line;
  }(Shape);

  function _typeof$b(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$b = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$b = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$b(obj);
  }

  function _classCallCheck$9(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$9(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$9(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$9(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$9(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$7(self, call) {
    if (call && (_typeof$b(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$7(self);
  }

  function _assertThisInitialized$7(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$7(o) {
    _getPrototypeOf$7 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$7(o);
  }

  function _inherits$7(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$7(subClass, superClass);
  }

  function _setPrototypeOf$7(o, p) {
    _setPrototypeOf$7 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$7(o, p);
  }
  var shapes = {
    Circle: Circle,
    Rect: Rect
  };
  /**
      @class Whisker
      @extends BaseClass
      @desc Creates SVG whisker based on an array of data.
  */

  var Whisker =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$7(Whisker, _BaseClass);
    /**
        @memberof Whisker
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from BaseClass.
        @private
    */


    function Whisker() {
      var _this;

      _classCallCheck$9(this, Whisker);

      _this = _possibleConstructorReturn$7(this, _getPrototypeOf$7(Whisker).call(this));
      _this._endpoint = accessor("endpoint", "Rect");
      _this._endpointConfig = {
        Circle: {
          r: accessor("r", 5)
        }
      };
      _this._length = accessor("length", 25);
      _this._lineConfig = {};
      _this._orient = accessor("orient", "top");
      _this._x = accessor("x", 0);
      _this._y = accessor("y", 0);
      return _this;
    }
    /**
        @memberof Whisker
        @desc Draws the whisker.
        @param {Function} [*callback*]
        @chainable
    */


    _createClass$9(Whisker, [{
      key: "render",
      value: function render(callback) {
        var _this2 = this;

        if (this._select === void 0) {
          this.select(_select("body").append("svg").style("width", "".concat(window.innerWidth, "px")).style("height", "".concat(window.innerHeight, "px")).style("display", "block").node());
        }

        var lineData = [];

        this._data.forEach(function (d, i) {
          var orient = _this2._orient(d, i);

          var x = _this2._x(d, i);

          var y = _this2._y(d, i);

          var endpointX = x;
          if (orient === "left") endpointX -= _this2._length(d, i);else if (orient === "right") endpointX += _this2._length(d, i);
          var endpointY = y;
          if (orient === "top") endpointY -= _this2._length(d, i);else if (orient === "bottom") endpointY += _this2._length(d, i);
          lineData.push({
            __d3plus__: true,
            data: d,
            i: i,
            id: i,
            x: x,
            y: y
          });
          lineData.push({
            __d3plus__: true,
            data: d,
            i: i,
            id: i,
            x: endpointX,
            y: endpointY
          });
        }); // Draw whisker line.


        this._line = new Line().data(lineData).select(elem("g.d3plus-Whisker", {
          parent: this._select
        }).node()).config(configPrep.bind(this)(this._lineConfig, "shape")).render(callback);

        var whiskerData = this._data.map(function (d, i) {
          var dataObj = {};
          dataObj.__d3plus__ = true;
          dataObj.data = d;
          dataObj.i = i;
          dataObj.endpoint = _this2._endpoint(d, i);
          dataObj.length = _this2._length(d, i);
          dataObj.orient = _this2._orient(d, i);

          var endpointX = _this2._x(d, i);

          if (dataObj.orient === "left") endpointX -= dataObj.length;else if (dataObj.orient === "right") endpointX += dataObj.length;

          var endpointY = _this2._y(d, i);

          if (dataObj.orient === "top") endpointY -= dataObj.length;else if (dataObj.orient === "bottom") endpointY += dataObj.length;
          dataObj.x = endpointX;
          dataObj.y = endpointY;
          return dataObj;
        }); // Draw whisker endpoint.


        this._whiskerEndpoint = [];
        nest().key(function (d) {
          return d.endpoint;
        }).entries(whiskerData).forEach(function (shapeData) {
          var shapeName = shapeData.key;

          _this2._whiskerEndpoint.push(new shapes[shapeName]().data(shapeData.values).select(elem("g.d3plus-Whisker-Endpoint-".concat(shapeName), {
            parent: _this2._select
          }).node()).config({
            height: function height(d) {
              return d.orient === "top" || d.orient === "bottom" ? 5 : 20;
            },
            width: function width(d) {
              return d.orient === "top" || d.orient === "bottom" ? 20 : 5;
            }
          }).config(configPrep.bind(_this2)(_this2._endpointConfig, "shape", shapeName)).render());
        });
        return this;
      }
      /**
          @memberof Whisker
          @desc Sets the highlight accessor to the Shape class's active function.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "active",
      value: function active(_) {
        if (this._line) this._line.active(_);
        if (this._whiskerEndpoint) this._whiskerEndpoint.forEach(function (endPoint) {
          return endPoint.active(_);
        });
      }
      /**
          @memberof Whisker
          @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array.
          @param {Array} [*data* = []]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof Whisker
          @desc If *value* is specified, sets the endpoint accessor to the specified function or string and returns the current class instance.
          @param {Function|String}
          @chainable
      */

    }, {
      key: "endpoint",
      value: function endpoint(_) {
        return arguments.length ? (this._endpoint = typeof _ === "function" ? _ : constant$3(_), this) : this._endpoint;
      }
      /**
          @memberof Whisker
          @desc If *value* is specified, sets the config method for each endpoint and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "endpointConfig",
      value: function endpointConfig(_) {
        return arguments.length ? (this._endpointConfig = assign(this._endpointConfig, _), this) : this._endpointConfig;
      }
      /**
          @memberof Whisker
          @desc Sets the highlight accessor to the Shape class's hover function.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "hover",
      value: function hover(_) {
        if (this._line) this._line.hover(_);
        if (this._whiskerEndpoint) this._whiskerEndpoint.forEach(function (endPoint) {
          return endPoint.hover(_);
        });
      }
      /**
          @memberof Whisker
          @desc If *value* is specified, sets the length accessor for whisker and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "length",
      value: function length(_) {
        return arguments.length ? (this._length = typeof _ === "function" ? _ : constant$3(_), this) : this._length;
      }
      /**
          @memberof Whisker
          @desc If *value* is specified, sets the config method for line shape and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "lineConfig",
      value: function lineConfig(_) {
        return arguments.length ? (this._lineConfig = assign(this._lineConfig, _), this) : this._lineConfig;
      }
      /**
          @memberof Whisker
          @desc If *value* is specified, sets the orientation to the specified value. If *value* is not specified, returns the current orientation.
          @param {Function|String} [*value* = "top"] Accepts "top", "right", "bottom" or "left"
          @chainable
      */

    }, {
      key: "orient",
      value: function orient(_) {
        return arguments.length ? (this._orient = typeof _ === "function" ? _ : constant$3(_), this) : this._orient;
      }
      /**
          @memberof Whisker
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.
          @param {String|HTMLElement} [*selector* = d3.select("body").append("svg")]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
        @memberof Whisker
        @desc If *value* is specified, sets the x axis to the specified function or number and returns the current class instance.
        @param {Function|Number} [*value*]
        @chainable
        @example
      function(d) {
      return d.x;
      }
      */

    }, {
      key: "x",
      value: function x(_) {
        return arguments.length ? (this._x = typeof _ === "function" ? _ : constant$3(_), this) : this._x;
      }
      /**
          @memberof Whisker
          @desc If *value* is specified, sets the y axis to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.y;
      }
      */

    }, {
      key: "y",
      value: function y(_) {
        return arguments.length ? (this._y = typeof _ === "function" ? _ : constant$3(_), this) : this._y;
      }
    }]);

    return Whisker;
  }(BaseClass);

  function _typeof$c(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$c = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$c = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$c(obj);
  }

  function _classCallCheck$a(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$a(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$a(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$a(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$a(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$8(self, call) {
    if (call && (_typeof$c(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$8(self);
  }

  function _assertThisInitialized$8(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$8(o) {
    _getPrototypeOf$8 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$8(o);
  }

  function _inherits$8(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$8(subClass, superClass);
  }

  function _setPrototypeOf$8(o, p) {
    _setPrototypeOf$8 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$8(o, p);
  }
  var shapes$1 = {
    Circle: Circle,
    Rect: Rect
  };
  /**
      @class Box
      @extends BaseClass
      @desc Creates SVG box based on an array of data.
  */

  var Box =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$8(Box, _BaseClass);
    /**
        @memberof Box
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from BaseClass.
        @private
    */


    function Box() {
      var _this;

      _classCallCheck$a(this, Box);

      _this = _possibleConstructorReturn$8(this, _getPrototypeOf$8(Box).call(this));
      _this._medianConfig = {
        fill: constant$3("black")
      };
      _this._orient = accessor("orient", "vertical");
      _this._outlier = accessor("outlier", "Circle");
      _this._outlierConfig = {
        Circle: {
          r: accessor("r", 5)
        },
        Rect: {
          height: function height(d, i) {
            return _this._orient(d, i) === "vertical" ? 5 : 20;
          },
          width: function width(d, i) {
            return _this._orient(d, i) === "vertical" ? 20 : 5;
          }
        }
      };
      _this._rectConfig = {
        fill: constant$3("white"),
        stroke: constant$3("black"),
        strokeWidth: constant$3(1)
      };
      _this._rectWidth = constant$3(50);
      _this._whiskerConfig = {};
      _this._whiskerMode = ["tukey", "tukey"];
      _this._x = accessor("x", 250);
      _this._y = accessor("y", 250);
      return _this;
    }
    /**
        @memberof Box
        @desc Draws the Box.
        @param {Function} [*callback*]
        @chainable
    */


    _createClass$a(Box, [{
      key: "render",
      value: function render() {
        var _this2 = this;

        if (this._select === void 0) {
          this.select(_select("body").append("svg").style("width", "".concat(window.innerWidth, "px")).style("height", "".concat(window.innerHeight, "px")).style("display", "block").node());
        }

        var outlierData = [];
        var filteredData = nest().key(function (d, i) {
          return _this2._orient(d, i) === "vertical" ? _this2._x(d, i) : _this2._y(d, i);
        }).entries(this._data).map(function (d) {
          d.data = objectMerge(d.values);
          d.i = _this2._data.indexOf(d.values[0]);
          d.orient = _this2._orient(d.data, d.i);
          var values = d.values.map(d.orient === "vertical" ? _this2._y : _this2._x);
          values.sort(function (a, b) {
            return a - b;
          });
          d.first = quantile(values, 0.25);
          d.median = quantile(values, 0.50);
          d.third = quantile(values, 0.75);
          var mode = _this2._whiskerMode;

          if (mode[0] === "tukey") {
            d.lowerLimit = d.first - (d.third - d.first) * 1.5;
            if (d.lowerLimit < min(values)) d.lowerLimit = min(values);
          } else if (mode[0] === "extent") d.lowerLimit = min(values);else if (typeof mode[0] === "number") d.lowerLimit = quantile(values, mode[0]);

          if (mode[1] === "tukey") {
            d.upperLimit = d.third + (d.third - d.first) * 1.5;
            if (d.upperLimit > max(values)) d.upperLimit = max(values);
          } else if (mode[1] === "extent") d.upperLimit = max(values);else if (typeof mode[1] === "number") d.upperLimit = quantile(values, mode[1]);

          var rectLength = d.third - d.first; // Compute values for vertical orientation.

          if (d.orient === "vertical") {
            d.height = rectLength;
            d.width = _this2._rectWidth(d.data, d.i);
            d.x = _this2._x(d.data, d.i);
            d.y = d.first + rectLength / 2;
          } else if (d.orient === "horizontal") {
            // Compute values for horizontal orientation.
            d.height = _this2._rectWidth(d.data, d.i);
            d.width = rectLength;
            d.x = d.first + rectLength / 2;
            d.y = _this2._y(d.data, d.i);
          } // Compute data for outliers.


          d.values.forEach(function (eachValue, index) {
            var value = d.orient === "vertical" ? _this2._y(eachValue, index) : _this2._x(eachValue, index);

            if (value < d.lowerLimit || value > d.upperLimit) {
              var dataObj = {};
              dataObj.__d3plus__ = true;
              dataObj.data = eachValue;
              dataObj.i = index;
              dataObj.outlier = _this2._outlier(eachValue, index);

              if (d.orient === "vertical") {
                dataObj.x = d.x;
                dataObj.y = value;
                outlierData.push(dataObj);
              } else if (d.orient === "horizontal") {
                dataObj.y = d.y;
                dataObj.x = value;
                outlierData.push(dataObj);
              }
            }
          });
          d.__d3plus__ = true;
          return d;
        }); // Draw box.

        this._box = new Rect().data(filteredData).x(function (d) {
          return d.x;
        }).y(function (d) {
          return d.y;
        }).select(elem("g.d3plus-Box", {
          parent: this._select
        }).node()).config(configPrep.bind(this)(this._rectConfig, "shape")).render(); // Draw median.

        this._median = new Rect().data(filteredData).x(function (d) {
          return d.orient === "vertical" ? d.x : d.median;
        }).y(function (d) {
          return d.orient === "vertical" ? d.median : d.y;
        }).height(function (d) {
          return d.orient === "vertical" ? 1 : d.height;
        }).width(function (d) {
          return d.orient === "vertical" ? d.width : 1;
        }).select(elem("g.d3plus-Box-Median", {
          parent: this._select
        }).node()).config(configPrep.bind(this)(this._medianConfig, "shape")).render(); // Draw 2 lines using Whisker class.
        // Construct coordinates for whisker startpoints and push it to the whiskerData.

        var whiskerData = [];
        filteredData.forEach(function (d, i) {
          var x = d.x;
          var y = d.y;
          var topLength = d.first - d.lowerLimit;
          var bottomLength = d.upperLimit - d.third;

          if (d.orient === "vertical") {
            var topY = y - d.height / 2;
            var bottomY = y + d.height / 2;
            whiskerData.push({
              __d3plus__: true,
              data: d,
              i: i,
              x: x,
              y: topY,
              length: topLength,
              orient: "top"
            }, {
              __d3plus__: true,
              data: d,
              i: i,
              x: x,
              y: bottomY,
              length: bottomLength,
              orient: "bottom"
            });
          } else if (d.orient === "horizontal") {
            var topX = x + d.width / 2;
            var bottomX = x - d.width / 2;
            whiskerData.push({
              __d3plus__: true,
              data: d,
              i: i,
              x: topX,
              y: y,
              length: bottomLength,
              orient: "right"
            }, {
              __d3plus__: true,
              data: d,
              i: i,
              x: bottomX,
              y: y,
              length: topLength,
              orient: "left"
            });
          }
        }); // Draw whiskers.

        this._whisker = new Whisker().data(whiskerData).select(elem("g.d3plus-Box-Whisker", {
          parent: this._select
        }).node()).config(configPrep.bind(this)(this._whiskerConfig, "shape")).render(); // Draw outliers.

        this._whiskerEndpoint = [];
        nest().key(function (d) {
          return d.outlier;
        }).entries(outlierData).forEach(function (shapeData) {
          var shapeName = shapeData.key;

          _this2._whiskerEndpoint.push(new shapes$1[shapeName]().data(shapeData.values).select(elem("g.d3plus-Box-Outlier-".concat(shapeName), {
            parent: _this2._select
          }).node()).config(configPrep.bind(_this2)(_this2._outlierConfig, "shape", shapeName)).render());
        });
        return this;
      }
      /**
          @memberof Box
          @desc Sets the highlight accessor to the Shape class's active function.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "active",
      value: function active(_) {
        if (this._box) this._box.active(_);
        if (this._median) this._median.active(_);
        if (this._whisker) this._whisker.active(_);
        if (this._whiskerEndpoint) this._whiskerEndpoint.forEach(function (endPoint) {
          return endPoint.active(_);
        });
      }
      /**
          @memberof Box
          @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array.
          @param {Array} [*data* = []]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof Box
          @desc Sets the highlight accessor to the Shape class's hover function.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "hover",
      value: function hover(_) {
        if (this._box) this._box.hover(_);
        if (this._median) this._median.hover(_);
        if (this._whisker) this._whisker.hover(_);
        if (this._whiskerEndpoint) this._whiskerEndpoint.forEach(function (endPoint) {
          return endPoint.hover(_);
        });
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the config method for median and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "medianConfig",
      value: function medianConfig(_) {
        return arguments.length ? (this._medianConfig = assign(this._medianConfig, _), this) : this._medianConfig;
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the orientation to the specified value. If *value* is not specified, returns the current orientation.
          @param {Function|String} [*value* = "vertical"] Accepts "vertical" or "horizontal"
          @chainable
      */

    }, {
      key: "orient",
      value: function orient(_) {
        return arguments.length ? (this._orient = typeof _ === "function" ? _ : constant$3(_), this) : this._orient;
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the outlier accessor to the specified function or string and returns the current class instance.
          @param {Function|String}
          @chainable
      */

    }, {
      key: "outlier",
      value: function outlier(_) {
        return arguments.length ? (this._outlier = typeof _ === "function" ? _ : constant$3(_), this) : this._outlier;
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the config method for each outlier point and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "outlierConfig",
      value: function outlierConfig(_) {
        return arguments.length ? (this._outlierConfig = assign(this._outlierConfig, _), this) : this._outlierConfig;
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the config method for rect shape and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "rectConfig",
      value: function rectConfig(_) {
        return arguments.length ? (this._rectConfig = assign(this._rectConfig, _), this) : this._rectConfig;
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the width accessor to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.width;
      }
      */

    }, {
      key: "rectWidth",
      value: function rectWidth(_) {
        return arguments.length ? (this._rectWidth = typeof _ === "function" ? _ : constant$3(_), this) : this._rectWidth;
      }
      /**
          @memberof Box
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.
          @param {String|HTMLElement} [*selector* = d3.select("body").append("svg")]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the config method for whisker and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "whiskerConfig",
      value: function whiskerConfig(_) {
        return arguments.length ? (this._whiskerConfig = assign(this._whiskerConfig, _), this) : this._whiskerConfig;
      }
      /**
          @memberof Box
          @desc Determines the value used for each whisker. Can be passed a single value to apply for both whiskers, or an Array of 2 values for the lower and upper whiskers (in that order). Accepted values are `"tukey"`, `"extent"`, or a Number representing a quantile.
          @param {String|Number|String[]|Number[]} [*value* = "tukey"]
          @chainable
      */

    }, {
      key: "whiskerMode",
      value: function whiskerMode(_) {
        return arguments.length ? (this._whiskerMode = _ instanceof Array ? _ : [_, _], this) : this._whiskerMode;
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the x axis to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.x;
      }
      */

    }, {
      key: "x",
      value: function x(_) {
        return arguments.length ? (this._x = typeof _ === "function" ? _ : accessor(_), this) : this._x;
      }
      /**
          @memberof Box
          @desc If *value* is specified, sets the y axis to the specified function or number and returns the current class instance.
          @param {Function|Number} [*value*]
          @chainable
          @example
      function(d) {
      return d.y;
      }
      */

    }, {
      key: "y",
      value: function y(_) {
        return arguments.length ? (this._y = typeof _ === "function" ? _ : accessor(_), this) : this._y;
      }
    }]);

    return Box;
  }(BaseClass);

  var pi$2 = Math.PI;
  /**
      @function shapeEdgePoint
      @desc Calculates the x/y position of a point at the edge of a shape, from the center of the shape, given a specified pixel distance and radian angle.
      @param {Number} angle The angle, in radians, of the offset point.
      @param {Number} distance The pixel distance away from the origin.
      @returns {String} [shape = "circle"] The type of shape, which can be either "circle" or "square".
  */

  var shapeEdgePoint = (function (angle, distance) {
    var shape = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : "circle";
    if (angle < 0) angle = pi$2 * 2 + angle;

    if (shape === "square") {
      var diagonal = 45 * (pi$2 / 180);
      var x = 0,
          y = 0;

      if (angle < pi$2 / 2) {
        var tan = Math.tan(angle);
        x += angle < diagonal ? distance : distance / tan;
        y += angle < diagonal ? tan * distance : distance;
      } else if (angle <= pi$2) {
        var _tan = Math.tan(pi$2 - angle);

        x -= angle < pi$2 - diagonal ? distance / _tan : distance;
        y += angle < pi$2 - diagonal ? distance : _tan * distance;
      } else if (angle < diagonal + pi$2) {
        x -= distance;
        y -= Math.tan(angle - pi$2) * distance;
      } else if (angle < 3 * pi$2 / 2) {
        x -= distance / Math.tan(angle - pi$2);
        y -= distance;
      } else if (angle < 2 * pi$2 - diagonal) {
        x += distance / Math.tan(2 * pi$2 - angle);
        y -= distance;
      } else {
        x += distance;
        y -= Math.tan(2 * pi$2 - angle) * distance;
      }

      return [x, y];
    } else if (shape === "circle") {
      return [distance * Math.cos(angle), distance * Math.sin(angle)];
    } else return null;
  });

  var pi$3 = Math.PI;
  /**
      @function path2polygon
      @desc Transforms a path string into an Array of points.
      @param {String} path An SVG string path, commonly the "d" property of a <path> element.
      @param {Number} [segmentLength = 20] The lenght of line segments when converting curves line segments. Higher values lower computation time, but will result in curves that are more rigid.
      @returns {Array}
  */

  var path2polygon = (function (path) {
    var segmentLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 20;
    var poly = [],
        regex = /([MLA])([^MLAZ]+)/ig;
    var match = regex.exec(path);

    while (match !== null) {
      if (["M", "L"].includes(match[1])) poly.push(match[2].split(",").map(Number));else if (match[1] === "A") {
        var points = match[2].split(",").map(Number);
        var last = points.slice(points.length - 2, points.length),
            prev = poly[poly.length - 1],
            radius = points[0],
            width = pointDistance(prev, last);
        var angle = Math.acos((radius * radius + radius * radius - width * width) / (2 * radius * radius));
        if (points[2]) angle = pi$3 * 2 - angle;
        var step = angle / (angle / (pi$3 * 2) * (radius * pi$3 * 2) / segmentLength);
        var start = Math.atan2(-prev[1], -prev[0]) - pi$3;
        var i = step;

        while (i < angle) {
          poly.push(shapeEdgePoint(points[4] ? start + i : start - i, radius));
          i += step;
        }

        poly.push(last);
      }
      match = regex.exec(path);
    }

    return poly;
  });

  function _typeof$d(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$d = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$d = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$d(obj);
  }

  function _classCallCheck$b(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$b(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$b(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$b(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$b(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$9(self, call) {
    if (call && (_typeof$d(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$9(self);
  }

  function _assertThisInitialized$9(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$5(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$5 = Reflect.get;
    } else {
      _get$5 = function _get(target, property, receiver) {
        var base = _superPropBase$5(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$5(target, property, receiver || target);
  }

  function _superPropBase$5(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$9(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$9(o) {
    _getPrototypeOf$9 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$9(o);
  }

  function _inherits$9(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$9(subClass, superClass);
  }

  function _setPrototypeOf$9(o, p) {
    _setPrototypeOf$9 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$9(o, p);
  }
  /**
      @class Path
      @extends Shape
      @desc Creates SVG Paths based on an array of data.
  */

  var Path$1 =
  /*#__PURE__*/
  function (_Shape) {
    _inherits$9(Path, _Shape);
    /**
        @memberof Path
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Shape.
        @private
    */


    function Path() {
      var _this;

      _classCallCheck$b(this, Path);

      _this = _possibleConstructorReturn$9(this, _getPrototypeOf$9(Path).call(this, "path"));
      _this._d = accessor("path");

      _this._labelBounds = function (d, i, aes) {
        var r = largestRect(aes.points, {
          angle: _this._labelConfig.rotate ? _this._labelConfig.rotate(d, i) : 0
        });
        return r ? {
          angle: r.angle,
          width: r.width,
          height: r.height,
          x: r.cx - r.width / 2,
          y: r.cy - r.height / 2
        } : false;
      };

      _this._name = "Path";
      _this._labelConfig = Object.assign(_this._labelConfig, {
        textAnchor: "middle",
        verticalAlign: "middle"
      });
      return _this;
    }
    /**
        @memberof Path
        @desc Given a specific data point and index, returns the aesthetic properties of the shape.
        @param {Object} *data point*
        @param {Number} *index*
        @private
    */


    _createClass$b(Path, [{
      key: "_aes",
      value: function _aes(d, i) {
        return {
          points: path2polygon(this._d(d, i))
        };
      }
      /**
          @memberof Path
          @desc Draws the paths.
          @param {Function} [*callback*]
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        _get$5(_getPrototypeOf$9(Path.prototype), "render", this).call(this, callback);

        var enter = this._enter.attr("d", this._d).call(this._applyStyle.bind(this));

        var update = this._update;

        if (this._duration) {
          enter.attr("opacity", 0).transition(this._transition).attr("opacity", 1);
          update = update.transition(this._transition);

          this._exit.transition(this._transition).attr("opacity", 0);
        }

        update.call(this._applyStyle.bind(this)).attr("d", this._d);
        return this;
      }
      /**
          @memberof Path
          @desc If *value* is specified, sets the "d" attribute accessor to the specified function or number and returns the current class instance.
          @param {Function|String} [*value*]
          @chainable
          @example
      function(d) {
      return d.path;
      }
      */

    }, {
      key: "d",
      value: function d(_) {
        return arguments.length ? (this._d = typeof _ === "function" ? _ : constant$3(_), this) : this._d;
      }
    }]);

    return Path;
  }(Shape);



  var shapes$2 = /*#__PURE__*/Object.freeze({
    __proto__: null,
    Image: Image$1,
    Shape: Shape,
    Area: Area,
    Bar: Bar,
    Box: Box,
    Circle: Circle,
    Line: Line,
    Path: Path$1,
    Rect: Rect,
    Whisker: Whisker,
    largestRect: largestRect,
    lineIntersection: lineIntersection,
    path2polygon: path2polygon,
    pointDistance: pointDistance,
    pointDistanceSquared: pointDistanceSquared,
    pointRotate: pointRotate,
    polygonInside: polygonInside,
    polygonRayCast: polygonRayCast,
    polygonRotate: polygonRotate,
    segmentBoxContains: segmentBoxContains,
    segmentsIntersect: segmentsIntersect,
    shapeEdgePoint: shapeEdgePoint,
    simplify: simplify
  });

  /**
      @function date
      @summary Parses numbers and strings to valid Javascript Date objects.
      @description Returns a javascript Date object for a given a Number (representing either a 4-digit year or milliseconds since epoch) or a String that is in [valid dateString format](http://dygraphs.com/date-formats.html). Besides the 4-digit year parsing, this function is useful when needing to parse negative (BC) years, which the vanilla Date object cannot parse.
      @param {Number|String} *date*
  */
  function date$2 (d) {
    // returns if already Date object
    if (d.constructor === Date) return d; // detects if milliseconds
    else if (d.constructor === Number && "".concat(d).length > 5 && d % 1 === 0) return new Date(d);
    var s = "".concat(d);
    var dayFormat = new RegExp(/^\d{1,2}[./-]\d{1,2}[./-](-*\d{1,4})$/g).exec(s),
        strFormat = new RegExp(/^[A-z]{1,3} [A-z]{1,3} \d{1,2} (-*\d{1,4}) \d{1,2}:\d{1,2}:\d{1,2} [A-z]{1,3}-*\d{1,4} \([A-z]{1,3}\)/g).exec(s); // tests for XX/XX/XXXX format

    if (dayFormat) {
      var year = dayFormat[1];
      if (year.indexOf("-") === 0) s = s.replace(year, year.substr(1));
      var date = new Date(s);
      date.setFullYear(year);
      return date;
    } // tests for full Date object string format
    else if (strFormat) {
        var _year = strFormat[1];
        if (_year.indexOf("-") === 0) s = s.replace(_year, _year.substr(1));

        var _date = new Date(s);

        _date.setFullYear(_year);

        return _date;
      } // detects if only passing a year value
      else if (!s.includes("/") && !s.includes(" ") && (!s.includes("-") || !s.indexOf("-"))) {
          var _date2 = new Date("".concat(s, "/01/01"));

          _date2.setFullYear(d);

          return _date2;
        } // parses string to Date object
        else return new Date(s);
  }

  var locale$2 = {
    "de-DE": {
      dateTime: "%A, der %e. %B %Y, %X",
      date: "%d.%m.%Y",
      time: "%H:%M:%S",
      periods: ["AM", "PM"],
      days: ["Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"],
      shortDays: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
      months: ["Januar", "Februar", "Mrz", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"],
      shortMonths: ["Jan", "Feb", "Mrz", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"]
    },
    "en-GB": {
      dateTime: "%a %e %b %X %Y",
      date: "%d/%m/%Y",
      time: "%H:%M:%S",
      periods: ["AM", "PM"],
      days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
      shortDays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
      months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
      shortMonths: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
    },
    "en-US": {
      dateTime: "%x, %X",
      date: "%-m/%-d/%Y",
      time: "%-I:%M:%S %p",
      periods: ["AM", "PM"],
      days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
      shortDays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
      months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
      shortMonths: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
    },
    "es-ES": {
      dateTime: "%A, %e de %B de %Y, %X",
      date: "%d/%m/%Y",
      time: "%H:%M:%S",
      periods: ["AM", "PM"],
      days: ["domingo", "lunes", "martes", "mircoles", "jueves", "viernes", "sbado"],
      shortDays: ["dom", "lun", "mar", "mi", "jue", "vie", "sb"],
      months: ["enero", "febrero", "marzo", "abril", "mayo", "junio", "julio", "agosto", "septiembre", "octubre", "noviembre", "diciembre"],
      shortMonths: ["ene", "feb", "mar", "abr", "may", "jun", "jul", "ago", "sep", "oct", "nov", "dic"]
    },
    "es-MX": {
      dateTime: "%x, %X",
      date: "%d/%m/%Y",
      time: "%-I:%M:%S %p",
      periods: ["AM", "PM"],
      days: ["domingo", "lunes", "martes", "mircoles", "jueves", "viernes", "sbado"],
      shortDays: ["dom", "lun", "mar", "mi", "jue", "vie", "sb"],
      months: ["enero", "febrero", "marzo", "abril", "mayo", "junio", "julio", "agosto", "septiembre", "octubre", "noviembre", "diciembre"],
      shortMonths: ["ene", "feb", "mar", "abr", "may", "jun", "jul", "ago", "sep", "oct", "nov", "dic"]
    },
    "fr-FR": {
      dateTime: "%A, le %e %B %Y, %X",
      date: "%d/%m/%Y",
      time: "%H:%M:%S",
      periods: ["AM", "PM"],
      days: ["dimanche", "lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi"],
      shortDays: ["dim.", "lun.", "mar.", "mer.", "jeu.", "ven.", "sam."],
      months: ["janvier", "fvrier", "mars", "avril", "mai", "juin", "juillet", "aot", "septembre", "octobre", "novembre", "dcembre"],
      shortMonths: ["janv.", "fvr.", "mars", "avr.", "mai", "juin", "juil.", "aot", "sept.", "oct.", "nov.", "dc."]
    },
    "it-IT": {
      dateTime: "%A %e %B %Y, %X",
      date: "%d/%m/%Y",
      time: "%H:%M:%S",
      periods: ["AM", "PM"],
      days: ["Domenica", "Luned", "Marted", "Mercoled", "Gioved", "Venerd", "Sabato"],
      shortDays: ["Dom", "Lun", "Mar", "Mer", "Gio", "Ven", "Sab"],
      months: ["Gennaio", "Febbraio", "Marzo", "Aprile", "Maggio", "Giugno", "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre"],
      shortMonths: ["Gen", "Feb", "Mar", "Apr", "Mag", "Giu", "Lug", "Ago", "Set", "Ott", "Nov", "Dic"]
    },
    "pt-BR": {
      dateTime: "%A, %e de %B de %Y. %X",
      date: "%d/%m/%Y",
      time: "%H:%M:%S",
      periods: ["AM", "PM"],
      days: ["Domingo", "Segunda", "Tera", "Quarta", "Quinta", "Sexta", "Sbado"],
      shortDays: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sb"],
      months: ["Janeiro", "Fevereiro", "Maro", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"],
      shortMonths: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"]
    }
  };

  function _defineProperty$2(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function _typeof$e(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$e = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$e = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$e(obj);
  }

  function _toConsumableArray(arr) {
    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();
  }

  function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance");
  }

  function _iterableToArray(iter) {
    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter);
  }

  function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) {
      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {
        arr2[i] = arr[i];
      }

      return arr2;
    }
  }

  function _classCallCheck$c(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$c(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$c(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$c(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$c(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$a(self, call) {
    if (call && (_typeof$e(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$a(self);
  }

  function _assertThisInitialized$a(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$a(o) {
    _getPrototypeOf$a = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$a(o);
  }

  function _inherits$a(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$a(subClass, superClass);
  }

  function _setPrototypeOf$a(o, p) {
    _setPrototypeOf$a = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$a(o, p);
  }
  /**
      @class Axis
      @extends external:BaseClass
      @desc Creates an SVG scale based on an array of data.
  */

  var Axis =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$a(Axis, _BaseClass);
    /**
        @memberof Axis
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Axis() {
      var _this;

      _classCallCheck$c(this, Axis);

      _this = _possibleConstructorReturn$a(this, _getPrototypeOf$a(Axis).call(this));
      _this._align = "middle";
      _this._barConfig = {
        "stroke": "#000",
        "stroke-width": 1
      };
      _this._domain = [0, 10];
      _this._duration = 600;
      _this._gridConfig = {
        "stroke": "#ccc",
        "stroke-width": 1
      };
      _this._gridLog = false;
      _this._height = 400;
      _this._labelOffset = true;

      _this.orient("bottom");

      _this._outerBounds = {
        width: 0,
        height: 0,
        x: 0,
        y: 0
      };
      _this._padding = 5;
      _this._paddingInner = 0.1;
      _this._paddingOuter = 0.1;
      _this._rotateLabels = false;
      _this._scale = "linear";
      _this._scalePadding = 0.5;
      _this._shape = "Line";
      _this._shapeConfig = {
        fill: "#000",
        height: function height(d) {
          return d.tick ? 8 : 0;
        },
        label: function label(d) {
          return d.text;
        },
        labelBounds: function labelBounds(d) {
          return d.labelBounds;
        },
        labelConfig: {
          fontColor: "#000",
          fontFamily: new TextBox().fontFamily(),
          fontResize: false,
          fontSize: constant$3(10),
          padding: 0,
          textAnchor: function textAnchor() {
            var rtl = detectRTL();
            return _this._orient === "left" ? rtl ? "start" : "end" : _this._orient === "right" ? rtl ? "end" : "start" : _this._rotateLabels ? _this._orient === "bottom" ? "end" : "start" : "middle";
          },
          verticalAlign: function verticalAlign() {
            return _this._orient === "bottom" ? "top" : _this._orient === "top" ? "bottom" : "middle";
          }
        },
        r: function r(d) {
          return d.tick ? 4 : 0;
        },
        stroke: "#000",
        strokeWidth: 1,
        width: function width(d) {
          return d.tick ? 8 : 0;
        }
      };
      _this._tickSize = 5;
      _this._tickSpecifier = undefined;
      _this._tickSuffix = "normal";
      _this._tickUnit = 0;
      _this._timeLocale = undefined;
      _this._titleClass = new TextBox();
      _this._titleConfig = {
        fontSize: 12,
        textAnchor: "middle"
      };
      _this._width = 400;
      return _this;
    }
    /**
        @memberof Axis
        @desc Sets positioning for the axis bar.
        @param {D3Selection} *bar*
        @private
    */


    _createClass$c(Axis, [{
      key: "_barPosition",
      value: function _barPosition(bar) {
        var _this$_position = this._position,
            height = _this$_position.height,
            x = _this$_position.x,
            y = _this$_position.y,
            opposite = _this$_position.opposite,
            domain = this._getDomain(),
            offset = this._margin[opposite],
            position = ["top", "left"].includes(this._orient) ? this._outerBounds[y] + this._outerBounds[height] - offset : this._outerBounds[y] + offset;

        var x1mod = this._scale === "band" ? this._d3Scale.step() - this._d3Scale.bandwidth() : this._scale === "point" ? this._d3Scale.step() * this._d3Scale.padding() : 0;
        var x2mod = this._scale === "band" ? this._d3Scale.step() : this._scale === "point" ? this._d3Scale.step() * this._d3Scale.padding() : 0;
        bar.call(attrize, this._barConfig).attr("".concat(x, "1"), this._getPosition(domain[0]) - x1mod).attr("".concat(x, "2"), this._getPosition(domain[domain.length - 1]) + x2mod).attr("".concat(y, "1"), position).attr("".concat(y, "2"), position);
      }
      /**
          @memberof Axis
          @desc Returns the scale's domain, taking into account negative and positive log scales.
          @private
      */

    }, {
      key: "_getDomain",
      value: function _getDomain() {
        var ticks = [];
        if (this._d3ScaleNegative) ticks = this._d3ScaleNegative.domain();
        if (this._d3Scale) ticks = ticks.concat(this._d3Scale.domain());
        var domain = ["band", "ordinal", "point"].includes(this._scale) ? ticks : extent(ticks);
        return ticks[0] > ticks[1] ? domain.reverse() : domain;
      }
      /**
          @memberof Axis
          @desc Returns a value's scale position, taking into account negative and positive log scales.
          @param {Number|String} *d*
          @private
      */

    }, {
      key: "_getPosition",
      value: function _getPosition(d) {
        return d < 0 && this._d3ScaleNegative ? this._d3ScaleNegative(d) : this._d3Scale(d);
      }
      /**
          @memberof Axis
          @desc Returns the scale's range, taking into account negative and positive log scales.
          @private
      */

    }, {
      key: "_getRange",
      value: function _getRange() {
        var ticks = [];
        if (this._d3ScaleNegative) ticks = this._d3ScaleNegative.range();
        if (this._d3Scale) ticks = ticks.concat(this._d3Scale.range());
        return ticks[0] > ticks[1] ? extent(ticks).reverse() : extent(ticks);
      }
      /**
          @memberof Axis
          @desc Returns the scale's ticks, taking into account negative and positive log scales.
          @private
      */

    }, {
      key: "_getTicks",
      value: function _getTicks() {
        var tickScale = sqrt().domain([10, 400]).range([10, 50]);
        var ticks = [];

        if (this._d3ScaleNegative) {
          var negativeRange = this._d3ScaleNegative.range();

          var size = negativeRange[1] - negativeRange[0];
          ticks = this._d3ScaleNegative.ticks(Math.floor(size / tickScale(size)));
        }

        if (this._d3Scale) {
          var positiveRange = this._d3Scale.range();

          var _size = positiveRange[1] - positiveRange[0];

          ticks = ticks.concat(this._d3Scale.ticks(Math.floor(_size / tickScale(_size))));
        }

        return ticks;
      }
      /**
          @memberof Axis
          @desc Sets positioning for the grid lines.
          @param {D3Selection} *lines*
          @private
      */

    }, {
      key: "_gridPosition",
      value: function _gridPosition(lines) {
        var last = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

        var _this$_position2 = this._position,
            height = _this$_position2.height,
            x = _this$_position2.x,
            y = _this$_position2.y,
            opposite = _this$_position2.opposite,
            offset = this._margin[opposite],
            position = ["top", "left"].includes(this._orient) ? this._outerBounds[y] + this._outerBounds[height] - offset : this._outerBounds[y] + offset,
            scale = last ? this._lastScale || this._getPosition.bind(this) : this._getPosition.bind(this),
            size = ["top", "left"].includes(this._orient) ? offset : -offset,
            xDiff = this._scale === "band" ? this._d3Scale.bandwidth() / 2 : 0,
            xPos = function xPos(d) {
          return scale(d.id) + xDiff;
        };

        lines.call(attrize, this._gridConfig).attr("".concat(x, "1"), xPos).attr("".concat(x, "2"), xPos).attr("".concat(y, "1"), position).attr("".concat(y, "2"), last ? position : position + size);
      }
      /**
          @memberof Axis
          @desc Renders the current Axis to the page. If a *callback* is specified, it will be called once the legend is done drawing.
          @param {Function} [*callback* = undefined]
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        var _this3 = this,
            _this$_outerBounds;
        /**
         * Creates an SVG element to contain the axis if none
         * has been specified using the "select" method.
         */


        if (this._select === void 0) {
          this.select(_select("body").append("svg").attr("width", "".concat(this._width, "px")).attr("height", "".concat(this._height, "px")).node());
        }

        var timeLocale = this._timeLocale || locale$2[this._locale] || locale$2["en-US"];
        defaultLocale(timeLocale).format();
        var formatDay = timeFormat("%a %d"),
            formatHour = timeFormat("%I %p"),
            formatMillisecond = timeFormat(".%L"),
            formatMinute = timeFormat("%I:%M"),
            formatMonth = timeFormat("%b"),
            formatSecond = timeFormat(":%S"),
            formatWeek = timeFormat("%b %d"),
            formatYear = timeFormat("%Y");
        /**
         * Declares some commonly used variables.
         */

        var _this$_position3 = this._position,
            width = _this$_position3.width,
            height = _this$_position3.height,
            x = _this$_position3.x,
            y = _this$_position3.y,
            horizontal = _this$_position3.horizontal,
            opposite = _this$_position3.opposite,
            clipId = "d3plus-Axis-clip-".concat(this._uuid),
            flip = ["top", "left"].includes(this._orient),
            p = this._padding,
            parent = this._select,
            rangeOuter = [p, this["_".concat(width)] - p],
            t = transition().duration(this._duration);
        var tickValue = this._shape === "Circle" ? this._shapeConfig.r : this._shape === "Rect" ? this._shapeConfig[width] : this._shapeConfig.strokeWidth;
        var tickGet = typeof tickValue !== "function" ? function () {
          return tickValue;
        } : tickValue;
        /**
         * Zeros out the margins for re-calculation.
         */

        var margin = this._margin = {
          top: 0,
          right: 0,
          bottom: 0,
          left: 0
        };
        var labels, range$1, ticks;
        /**
         * (Re)calculates the internal d3 scale
         * @param {} newRange
         */

        function setScale() {
          var _this2 = this;

          var newRange = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._range;
          /**
           * Calculates the internal "range" array to use, including
           * fallbacks if not specified with the "range" method.
           */

          range$1 = newRange ? newRange.slice() : [undefined, undefined];
          var minRange = rangeOuter[0],
              maxRange = rangeOuter[1];

          if (this._range) {
            if (this._range[0] !== undefined) minRange = this._range[0];
            if (this._range[this._range.length - 1] !== undefined) maxRange = this._range[this._range.length - 1];
          }

          if (range$1[0] === undefined || range$1[0] < minRange) range$1[0] = minRange;
          if (range$1[1] === undefined || range$1[1] > maxRange) range$1[1] = maxRange;
          var sizeInner = maxRange - minRange;

          if (this._scale === "ordinal" && this._domain.length > range$1.length) {
            if (newRange === this._range) {
              var buckets = this._domain.length + 1;
              range$1 = range(buckets).map(function (d) {
                return range$1[0] + sizeInner * (d / (buckets - 1));
              }).slice(1, buckets);
              range$1 = range$1.map(function (d) {
                return d - range$1[0] / 2;
              });
            } else {
              var _buckets = this._domain.length;
              var size = range$1[1] - range$1[0];
              range$1 = range(_buckets).map(function (d) {
                return range$1[0] + size * (d / (_buckets - 1));
              });
            }
          } else if (newRange === this._range) {
            var tickScale = sqrt().domain([10, 400]).range([10, 50]);
            var domain = this._scale === "time" ? this._domain.map(date$2) : this._domain;
            var scaleTicks = d3Ticks(domain[0], domain[1], Math.floor(sizeInner / tickScale(sizeInner)));
            ticks = (this._ticks ? this._scale === "time" ? this._ticks.map(date$2) : this._ticks : scaleTicks).slice();
            labels = (this._labels ? this._scale === "time" ? this._labels.map(date$2) : this._labels : scaleTicks).slice();
            var _buckets2 = labels.length;

            if (_buckets2) {
              var pad = Math.ceil(sizeInner / _buckets2 / 2);
              range$1 = [range$1[0] + pad, range$1[1] - pad];
            }
          }
          /**
           * Sets up the initial d3 scale, using this._domain and the
           * previously defined range variable.
           */


          this._d3Scale = scales["scale".concat(this._scale.charAt(0).toUpperCase()).concat(this._scale.slice(1))]().domain(this._scale === "time" ? this._domain.map(date$2) : this._domain);
          if (this._d3Scale.round) this._d3Scale.round(true);
          if (this._d3Scale.padding) this._d3Scale.padding(this._scalePadding);
          if (this._d3Scale.paddingInner) this._d3Scale.paddingInner(this._paddingInner);
          if (this._d3Scale.paddingOuter) this._d3Scale.paddingOuter(this._paddingOuter);
          if (this._d3Scale.rangeRound) this._d3Scale.rangeRound(range$1);else this._d3Scale.range(range$1);
          /**
           * Constructs a separate "negative only" scale for logarithmic
           * domains, as they cannot pass zero.
           */

          this._d3ScaleNegative = null;

          if (this._scale === "log") {
            var _domain = this._d3Scale.domain();

            if (_domain[0] === 0) _domain[0] = 1;
            if (_domain[_domain.length - 1] === 0) _domain[_domain.length - 1] = -1;

            var _range = this._d3Scale.range();

            if (_domain[0] < 0 && _domain[_domain.length - 1] < 0) {
              this._d3ScaleNegative = this._d3Scale.copy().domain(_domain).range(_range);
              this._d3Scale = null;
            } else if (_domain[0] > 0 && _domain[_domain.length - 1] > 0) {
              this._d3Scale.domain(_domain).range(_range);
            } else {
              var percentScale = log().domain([1, _domain[_domain[1] > 0 ? 1 : 0]]).range([0, 1]);
              var leftPercentage = percentScale(Math.abs(_domain[_domain[1] < 0 ? 1 : 0]));
              var zero = leftPercentage / (leftPercentage + 1) * (_range[1] - _range[0]);
              if (_domain[0] > 0) zero = _range[1] - _range[0] - zero;
              this._d3ScaleNegative = this._d3Scale.copy();
              (_domain[0] < 0 ? this._d3Scale : this._d3ScaleNegative).domain([Math.sign(_domain[1]), _domain[1]]).range([_range[0] + zero, _range[1]]);
              (_domain[0] < 0 ? this._d3ScaleNegative : this._d3Scale).domain([_domain[0], Math.sign(_domain[0])]).range([_range[0], _range[0] + zero]);
            }
          }
          /**
           * Determines the of values array to use
           * for the "ticks" and the "labels"
           */


          ticks = (this._ticks ? this._scale === "time" ? this._ticks.map(date$2) : this._ticks : (this._d3Scale ? this._d3Scale.ticks : this._d3ScaleNegative.ticks) ? this._getTicks() : this._domain).slice();
          labels = (this._labels ? this._scale === "time" ? this._labels.map(date$2) : this._labels : (this._d3Scale ? this._d3Scale.ticks : this._d3ScaleNegative.ticks) ? this._getTicks() : ticks).slice();

          if (this._scale === "log") {
            labels = labels.filter(function (t) {
              return Math.abs(t).toString().charAt(0) === "1" && (_this2._d3Scale ? t !== -1 : t !== 1);
            });
          } else if (this._scale === "time") {
            ticks = ticks.map(Number);
            labels = labels.map(Number);
          }

          ticks = ticks.sort(function (a, b) {
            return _this2._getPosition(a) - _this2._getPosition(b);
          });
          labels = labels.sort(function (a, b) {
            return _this2._getPosition(a) - _this2._getPosition(b);
          });
          /**
           * Get the smallest suffix.
           */

          if (this._scale === "linear" && this._tickSuffix === "smallest") {
            var suffixes = labels.filter(function (d) {
              return d >= 1000;
            });

            if (suffixes.length > 0) {
              var _min = Math.min.apply(Math, _toConsumableArray(suffixes));

              var i = 1;

              while (i && i < 7) {
                var n = Math.pow(10, 3 * i);

                if (_min / n >= 1) {
                  this._tickUnit = i;
                  i += 1;
                } else {
                  break;
                }
              }
            }
          }
          /**
           * Removes ticks when they overlap other ticks.
           */


          var pixels = [];
          this._availableTicks = ticks;
          ticks.forEach(function (d, i) {
            var s = tickGet({
              id: d,
              tick: true
            }, i);
            if (_this2._shape === "Circle") s *= 2;

            var t = _this2._getPosition(d);

            if (!pixels.length || Math.abs(closest(t, pixels) - t) > s * 2) pixels.push(t);else pixels.push(false);
          });
          ticks = ticks.filter(function (d, i) {
            return pixels[i] !== false;
          });
          this._visibleTicks = ticks;
        }

        setScale.bind(this)();
        /**
         * Calculates the space available for a given label.
         * @param {Object} datum
         */

        function calculateSpace(datum) {
          var diff = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
          var i = datum.i,
              position = datum.position;

          if (this._scale === "band") {
            return this._d3Scale.bandwidth();
          } else {
            var prevPosition = i - diff < 0 ? textData.length === 1 || !this._range ? rangeOuter[0] : (position - textData[i + diff].position) / 2 - position : position - (position - textData[i - diff].position) / 2;
            var prevSpace = Math.abs(position - prevPosition);
            var nextPosition = i + diff > textData.length - 1 ? textData.length === 1 || !this._range ? rangeOuter[1] : (position - textData[i - diff].position) / 2 - position : position - (position - textData[i + diff].position) / 2;
            var nextSpace = Math.abs(position - nextPosition);
            return min([prevSpace, nextSpace]) * 2;
          }
        }
        /**
         * Constructs the tick formatter function.
         */


        var tickFormat = this._tickFormat ? this._tickFormat : function (d) {
          if (_this3._scale === "log") {
            var _p = Math.round(Math.log(Math.abs(d)) / Math.LN10);

            var _t = Math.abs(d).toString().charAt(0);

            var _n = "10 ".concat("".concat(_p).split("").map(function (c) {
              return ""[c];
            }).join(""));

            if (_t !== "1") _n = "".concat(_t, " x ").concat(_n);
            return d < 0 ? "-".concat(_n) : _n;
          } else if (_this3._scale === "time") {
            return (second(d) < d ? formatMillisecond : minute(d) < d ? formatSecond : hour(d) < d ? formatMinute : day(d) < d ? formatHour : month(d) < d ? sunday(d) < d ? formatDay : formatWeek : year(d) < d ? formatMonth : formatYear)(d);
          } else if (["band", "ordinal", "point"].includes(_this3._scale)) {
            return d;
          }

          var n = _this3._d3Scale.tickFormat ? _this3._d3Scale.tickFormat(labels.length - 1)(d) : d;
          n = n.replace(/[^\d\.\-\+]/g, "") * 1;

          if (isNaN(n)) {
            return n;
          } else if (_this3._scale === "linear" && _this3._tickSuffix === "smallest") {
            var _locale = _typeof$e(_this3._locale) === "object" ? _this3._locale : formatLocale$2[_this3._locale];

            var separator = _locale.separator,
                suffixes = _locale.suffixes;
            var suff = n >= 1000 ? suffixes[_this3._tickUnit + 8] : "";
            var tick = n / Math.pow(10, 3 * _this3._tickUnit);
            var number = formatAbbreviate(tick, _locale, ",.".concat(tick.toString().length, "r"));
            return "".concat(number).concat(separator).concat(suff);
          } else {
            return formatAbbreviate(n, _this3._locale);
          }
        };
        /**
         * Pre-calculates the size of the title, if defined, in order
         * to adjust the internal margins.
         */

        if (this._title) {
          var _this$_titleConfig = this._titleConfig,
              fontFamily = _this$_titleConfig.fontFamily,
              fontSize = _this$_titleConfig.fontSize,
              lineHeight = _this$_titleConfig.lineHeight;
          var titleWrap = textWrap().fontFamily(typeof fontFamily === "function" ? fontFamily() : fontFamily).fontSize(typeof fontSize === "function" ? fontSize() : fontSize).lineHeight(typeof lineHeight === "function" ? lineHeight() : lineHeight).width(range$1[range$1.length - 1] - range$1[0] - p * 2).height(this["_".concat(height)] - this._tickSize - p * 2);
          var lines = titleWrap(this._title).lines.length;
          margin[this._orient] = lines * titleWrap.lineHeight() + p;
        }

        var hBuff = this._shape === "Circle" ? typeof this._shapeConfig.r === "function" ? this._shapeConfig.r({
          tick: true
        }) : this._shapeConfig.r : this._shape === "Rect" ? typeof this._shapeConfig[height] === "function" ? this._shapeConfig[height]({
          tick: true
        }) : this._shapeConfig[height] : this._tickSize,
            wBuff = tickGet({
          tick: true
        });
        if (typeof hBuff === "function") hBuff = max(ticks.map(hBuff));
        if (this._shape === "Rect") hBuff /= 2;
        if (typeof wBuff === "function") wBuff = max(ticks.map(wBuff));
        if (this._shape !== "Circle") wBuff /= 2;
        /**
         * Calculates the space each label would take up, given
         * the provided this._space size.
         */

        var textData = labels.map(function (d, i) {
          var fF = _this3._shapeConfig.labelConfig.fontFamily(d, i),
              fS = _this3._shapeConfig.labelConfig.fontSize(d, i),
              position = _this3._getPosition(d);

          var lineHeight = _this3._shapeConfig.lineHeight ? _this3._shapeConfig.lineHeight(d, i) : fS * 1.4;
          return {
            d: d,
            i: i,
            fF: fF,
            fS: fS,
            lineHeight: lineHeight,
            position: position
          };
        });
        /**
         * Calculates the text wrapping and size of a given textData object.
         * @param {Object} datum
         */

        function calculateLabelSize(datum) {
          var d = datum.d,
              i = datum.i,
              fF = datum.fF,
              fS = datum.fS,
              rotate = datum.rotate,
              space = datum.space;
          var h = rotate ? "width" : "height",
              w = rotate ? "height" : "width";
          var wrap = textWrap().fontFamily(fF).fontSize(fS).lineHeight(this._shapeConfig.lineHeight ? this._shapeConfig.lineHeight(d, i) : undefined)[w](horizontal ? space : min([this._maxSize, this._width]) - hBuff - p - this._margin.left - this._margin.right)[h](horizontal ? min([this._maxSize, this._height]) - hBuff - p - this._margin.top - this._margin.bottom : space);
          var res = wrap(tickFormat(d));
          res.lines = res.lines.filter(function (d) {
            return d !== "";
          });
          res.width = res.lines.length ? Math.ceil(max(res.widths)) + fS / 4 : 0;
          if (res.width % 2) res.width++;
          res.height = res.lines.length ? Math.ceil(res.lines.length * wrap.lineHeight()) + fS / 4 : 0;
          if (res.height % 2) res.height++;
          return res;
        }

        textData = textData.map(function (datum) {
          datum.rotate = _this3._labelRotation;
          datum.space = calculateSpace.bind(_this3)(datum);
          var res = calculateLabelSize.bind(_this3)(datum);
          return Object.assign(res, datum);
        });
        this._rotateLabels = horizontal && this._labelRotation === undefined ? textData.some(function (d) {
          return d.truncated;
        }) : this._labelRotation;

        if (this._rotateLabels) {
          textData = textData.map(function (datum) {
            datum.rotate = true;
            var res = calculateLabelSize.bind(_this3)(datum);
            return Object.assign(datum, res);
          });
        }
        /**
         * "spillover" will contain the pixel spillover of the first and last label,
         * and then adjust the scale range accordingly.
         */


        var spillover = [0, 0];

        for (var index = 0; index < 2; index++) {
          var datum = textData[index ? textData.length - 1 : 0];
          if (!datum) break;
          var _height = datum.height,
              position = datum.position,
              rotate = datum.rotate,
              _width = datum.width;
          var compPosition = index ? rangeOuter[1] : rangeOuter[0];
          var halfSpace = (rotate || !horizontal ? _height : _width) / 2;
          var spill = index ? position + halfSpace - compPosition : position - halfSpace - compPosition;
          spillover[index] = spill;
        }

        var first = range$1[0];
        var last = range$1[range$1.length - 1];
        var newRange = [first - spillover[0], last - spillover[1]];

        if (this._range) {
          if (this._range[0] !== undefined) newRange[0] = this._range[0];
          if (this._range[this._range.length - 1] !== undefined) newRange[1] = this._range[this._range.length - 1];
        }

        if (newRange[0] !== first || newRange[1] !== last) {
          setScale.bind(this)(newRange);
          textData = labels.map(function (d, i) {
            var fF = _this3._shapeConfig.labelConfig.fontFamily(d, i),
                fS = _this3._shapeConfig.labelConfig.fontSize(d, i),
                position = _this3._getPosition(d);

            var lineHeight = _this3._shapeConfig.lineHeight ? _this3._shapeConfig.lineHeight(d, i) : fS * 1.4;
            return {
              d: d,
              i: i,
              fF: fF,
              fS: fS,
              lineHeight: lineHeight,
              position: position
            };
          });
          textData = textData.map(function (datum) {
            datum.rotate = _this3._rotateLabels;
            datum.space = calculateSpace.bind(_this3)(datum);
            var res = calculateLabelSize.bind(_this3)(datum);
            return Object.assign(res, datum);
          });
        }

        var labelHeight = max(textData, function (t) {
          return t.height;
        }) || 0;
        this._rotateLabels = horizontal && this._labelRotation === undefined ? textData.some(function (datum) {
          var i = datum.i,
              height = datum.height,
              position = datum.position,
              truncated = datum.truncated;
          var prev = textData[i - 1];
          return truncated || i && prev.position + prev.height / 2 > position - height / 2;
        }) : this._labelRotation;

        if (this._rotateLabels) {
          var offset = 0;
          textData = textData.map(function (datum) {
            datum.space = calculateSpace.bind(_this3)(datum, 2);
            var res = calculateLabelSize.bind(_this3)(datum);
            datum = Object.assign(datum, res);
            var prev = textData[datum.i - 1];

            if (!prev) {
              offset = 1;
            } else if (prev.position + prev.height / 2 > datum.position) {
              if (offset) {
                datum.offset = prev.width;
                offset = 0;
              } else offset = 1;
            }

            return datum;
          });
        }

        var globalOffset = this._labelOffset ? max(textData, function (d) {
          return d.offset || 0;
        }) : 0;
        textData.forEach(function (datum) {
          return datum.offset = datum.offset ? globalOffset : 0;
        });
        var tBuff = this._shape === "Line" ? 0 : hBuff;
        var bounds = this._outerBounds = (_this$_outerBounds = {}, _defineProperty$2(_this$_outerBounds, height, (max(textData, function (t) {
          return Math.ceil(t[t.rotate || !horizontal ? "width" : "height"] + t.offset);
        }) || 0) + (textData.length ? p : 0)), _defineProperty$2(_this$_outerBounds, width, rangeOuter[rangeOuter.length - 1] - rangeOuter[0]), _defineProperty$2(_this$_outerBounds, x, rangeOuter[0]), _this$_outerBounds);
        margin[this._orient] += hBuff;
        margin[opposite] = this._gridSize !== undefined ? max([this._gridSize, tBuff]) : this["_".concat(height)] - margin[this._orient] - bounds[height] - p;
        bounds[height] += margin[opposite] + margin[this._orient];
        bounds[y] = this._align === "start" ? this._padding : this._align === "end" ? this["_".concat(height)] - bounds[height] - this._padding : this["_".concat(height)] / 2 - bounds[height] / 2;
        var group = elem("g#d3plus-Axis-".concat(this._uuid), {
          parent: parent
        });
        this._group = group;
        var grid = elem("g.grid", {
          parent: group
        }).selectAll("line").data((this._gridSize !== 0 ? this._grid || this._scale === "log" && !this._gridLog ? labels : ticks : []).map(function (d) {
          return {
            id: d
          };
        }), function (d) {
          return d.id;
        });
        grid.exit().transition(t).attr("opacity", 0).call(this._gridPosition.bind(this)).remove();
        grid.enter().append("line").attr("opacity", 0).attr("clip-path", "url(#".concat(clipId, ")")).call(this._gridPosition.bind(this), true).merge(grid).transition(t).attr("opacity", 1).call(this._gridPosition.bind(this));
        var labelOnly = labels.filter(function (d, i) {
          return textData[i].lines.length && !ticks.includes(d);
        });
        var rotated = textData.some(function (d) {
          return d.rotate;
        });
        var tickData = ticks.concat(labelOnly).map(function (d) {
          var _tickConfig;

          var data = textData.find(function (td) {
            return td.d === d;
          });

          var xPos = _this3._getPosition(d);

          var space = data ? data.space : 0;
          var lines = data ? data.lines.length : 1;
          var lineHeight = data ? data.lineHeight : 1;
          var labelOffset = data && _this3._labelOffset ? data.offset : 0;
          var labelWidth = horizontal ? space : bounds.width - margin[_this3._position.opposite] - hBuff - margin[_this3._orient] + p;
          var offset = margin[opposite],
              size = (hBuff + labelOffset) * (flip ? -1 : 1),
              yPos = flip ? bounds[y] + bounds[height] - offset : bounds[y] + offset;
          var tickConfig = (_tickConfig = {
            id: d,
            labelBounds: rotated && data ? {
              x: -data.width / 2 + data.fS / 4,
              y: _this3._orient === "bottom" ? size + p + (data.width - lineHeight * lines) / 2 : size - p * 2 - (data.width + lineHeight * lines) / 2,
              width: data.width,
              height: data.height
            } : {
              x: horizontal ? -space / 2 : _this3._orient === "left" ? -labelWidth - p + size : size + p,
              y: horizontal ? _this3._orient === "bottom" ? size + p : size - p - labelHeight : -space / 2,
              width: horizontal ? space : labelWidth,
              height: horizontal ? labelHeight : space
            },
            rotate: data ? data.rotate : false,
            size: labels.includes(d) ? size : 0,
            text: labels.includes(d) ? tickFormat(d) : false,
            tick: ticks.includes(d)
          }, _defineProperty$2(_tickConfig, x, xPos + (_this3._scale === "band" ? _this3._d3Scale.bandwidth() / 2 : 0)), _defineProperty$2(_tickConfig, y, yPos), _tickConfig);
          return tickConfig;
        });

        if (this._shape === "Line") {
          tickData = tickData.concat(tickData.map(function (d) {
            var dupe = Object.assign({}, d);
            dupe[y] += d.size;
            return dupe;
          }));
        }

        new shapes$2[this._shape]().data(tickData).duration(this._duration).labelConfig({
          ellipsis: function ellipsis(d) {
            return d && d.length ? "".concat(d, "...") : "";
          },
          rotate: function rotate(d) {
            return d.rotate ? -90 : 0;
          }
        }).select(elem("g.ticks", {
          parent: group
        }).node()).config(this._shapeConfig).render();
        var bar = group.selectAll("line.bar").data([null]);
        bar.enter().append("line").attr("class", "bar").attr("opacity", 0).call(this._barPosition.bind(this)).merge(bar).transition(t).attr("opacity", 1).call(this._barPosition.bind(this));

        this._titleClass.data(this._title ? [{
          text: this._title
        }] : []).duration(this._duration).height(margin[this._orient]).rotate(this._orient === "left" ? -90 : this._orient === "right" ? 90 : 0).select(elem("g.d3plus-Axis-title", {
          parent: group
        }).node()).text(function (d) {
          return d.text;
        }).verticalAlign("middle").width(range$1[range$1.length - 1] - range$1[0]).x(horizontal ? range$1[0] : this._orient === "left" ? bounds.x + margin.left / 2 - (range$1[range$1.length - 1] - range$1[0]) / 2 : bounds.x + bounds.width - margin.right / 2 - (range$1[range$1.length - 1] - range$1[0]) / 2).y(horizontal ? this._orient === "bottom" ? bounds.y + bounds.height - margin.bottom : bounds.y : range$1[0] + (range$1[range$1.length - 1] - range$1[0]) / 2 - margin[this._orient] / 2).config(this._titleConfig).render();

        this._lastScale = this._getPosition.bind(this);
        if (callback) setTimeout(callback, this._duration + 100);
        return this;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the horizontal alignment to the specified value and returns the current class instance.
          @param {String} [*value* = "center"] Supports `"left"` and `"center"` and `"right"`.
          @chainable
      */

    }, {
      key: "align",
      value: function align(_) {
        return arguments.length ? (this._align = _, this) : this._align;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the axis line style and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "barConfig",
      value: function barConfig(_) {
        return arguments.length ? (this._barConfig = Object.assign(this._barConfig, _), this) : this._barConfig;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the scale domain of the axis and returns the current class instance.
          @param {Array} [*value* = [0, 10]]
          @chainable
      */

    }, {
      key: "domain",
      value: function domain(_) {
        return arguments.length ? (this._domain = _, this) : this._domain;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the transition duration of the axis and returns the current class instance.
          @param {Number} [*value* = 600]
          @chainable
      */

    }, {
      key: "duration",
      value: function duration(_) {
        return arguments.length ? (this._duration = _, this) : this._duration;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the grid values of the axis and returns the current class instance.
          @param {Array} [*value*]
          @chainable
      */

    }, {
      key: "grid",
      value: function grid(_) {
        return arguments.length ? (this._grid = _, this) : this._grid;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the grid config of the axis and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "gridConfig",
      value: function gridConfig(_) {
        return arguments.length ? (this._gridConfig = Object.assign(this._gridConfig, _), this) : this._gridConfig;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the grid behavior of the axis when scale is logarithmic and returns the current class instance.
          @param {Boolean} [*value* = false]
          @chainable
      */

    }, {
      key: "gridLog",
      value: function gridLog(_) {
        return arguments.length ? (this._gridLog = _, this) : this._gridLog;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the grid size of the axis and returns the current class instance.
          @param {Number} [*value* = undefined]
          @chainable
      */

    }, {
      key: "gridSize",
      value: function gridSize(_) {
        return arguments.length ? (this._gridSize = _, this) : this._gridSize;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the overall height of the axis and returns the current class instance.
          @param {Number} [*value* = 100]
          @chainable
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = _, this) : this._height;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the visible tick labels of the axis and returns the current class instance.
          @param {Array} [*value*]
          @chainable
      */

    }, {
      key: "labels",
      value: function labels(_) {
        return arguments.length ? (this._labels = _, this) : this._labels;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets whether offsets will be used to position some labels further away from the axis in order to allow space for the text.
          @param {Boolean} [*value* = true]
          @chainable
       */

    }, {
      key: "labelOffset",
      value: function labelOffset(_) {
        return arguments.length ? (this._labelOffset = _, this) : this._labelOffset;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets whether whether horizontal axis labels are rotated -90 degrees.
          @param {Boolean}
          @chainable
       */

    }, {
      key: "labelRotation",
      value: function labelRotation(_) {
        return arguments.length ? (this._labelRotation = _, this) : this._labelRotation;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the maximum size allowed for the space that contains the axis tick labels and title.
          @param {Number}
          @chainable
       */

    }, {
      key: "maxSize",
      value: function maxSize(_) {
        return arguments.length ? (this._maxSize = _, this) : this._maxSize;
      }
      /**
          @memberof Axis
          @desc If *orient* is specified, sets the orientation of the shape and returns the current class instance. If *orient* is not specified, returns the current orientation.
          @param {String} [*orient* = "bottom"] Supports `"top"`, `"right"`, `"bottom"`, and `"left"` orientations.
          @chainable
      */

    }, {
      key: "orient",
      value: function orient(_) {
        if (arguments.length) {
          var horizontal = ["top", "bottom"].includes(_),
              opps = {
            top: "bottom",
            right: "left",
            bottom: "top",
            left: "right"
          };
          this._position = {
            horizontal: horizontal,
            width: horizontal ? "width" : "height",
            height: horizontal ? "height" : "width",
            x: horizontal ? "x" : "y",
            y: horizontal ? "y" : "x",
            opposite: opps[_]
          };
          return this._orient = _, this;
        }

        return this._orient;
      }
      /**
          @memberof Axis
          @desc If called after the elements have been drawn to DOM, will returns the outer bounds of the axis content.
          @example
      {"width": 180, "height": 24, "x": 10, "y": 20}
      */

    }, {
      key: "outerBounds",
      value: function outerBounds() {
        return this._outerBounds;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the padding between each tick label to the specified number and returns the current class instance.
          @param {Number} [*value* = 10]
          @chainable
      */

    }, {
      key: "padding",
      value: function padding(_) {
        return arguments.length ? (this._padding = _, this) : this._padding;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the inner padding of band scale to the specified number and returns the current class instance.
          @param {Number} [*value* = 0.1]
          @chainable
      */

    }, {
      key: "paddingInner",
      value: function paddingInner(_) {
        return arguments.length ? (this._paddingInner = _, this) : this._paddingInner;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the outer padding of band scales to the specified number and returns the current class instance.
          @param {Number} [*value* = 0.1]
          @chainable
      */

    }, {
      key: "paddingOuter",
      value: function paddingOuter(_) {
        return arguments.length ? (this._paddingOuter = _, this) : this._paddingOuter;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the scale range (in pixels) of the axis and returns the current class instance. The given array must have 2 values, but one may be `undefined` to allow the default behavior for that value.
          @param {Array} [*value*]
          @chainable
      */

    }, {
      key: "range",
      value: function range(_) {
        return arguments.length ? (this._range = _, this) : this._range;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the scale of the axis and returns the current class instance.
          @param {String} [*value* = "linear"]
          @chainable
      */

    }, {
      key: "scale",
      value: function scale(_) {
        return arguments.length ? (this._scale = _, this) : this._scale;
      }
      /**
          @memberof Axis
          @desc Sets the "padding" property of the scale, often used in point scales.
          @param {Number} [*value* = 0.5]
          @chainable
      */

    }, {
      key: "scalePadding",
      value: function scalePadding(_) {
        return arguments.length ? (this._scalePadding = _, this) : this._scalePadding;
      }
      /**
          @memberof Axis
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.
          @param {String|HTMLElement} [*selector* = d3.select("body").append("svg")]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the tick shape constructor and returns the current class instance.
          @param {String} [*value* = "Line"]
          @chainable
      */

    }, {
      key: "shape",
      value: function shape(_) {
        return arguments.length ? (this._shape = _, this) : this._shape;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the tick style of the axis and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "shapeConfig",
      value: function shapeConfig(_) {
        return arguments.length ? (this._shapeConfig = assign(this._shapeConfig, _), this) : this._shapeConfig;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the tick formatter and returns the current class instance.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "tickFormat",
      value: function tickFormat(_) {
        return arguments.length ? (this._tickFormat = _, this) : this._tickFormat;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the tick values of the axis and returns the current class instance.
          @param {Array} [*value*]
          @chainable
      */

    }, {
      key: "ticks",
      value: function ticks(_) {
        return arguments.length ? (this._ticks = _, this) : this._ticks;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the tick size of the axis and returns the current class instance.
          @param {Number} [*value* = 5]
          @chainable
      */

    }, {
      key: "tickSize",
      value: function tickSize(_) {
        return arguments.length ? (this._tickSize = _, this) : this._tickSize;
      }
      /**
          @memberof Axis
          @desc Sets the tick specifier for the [tickFormat](https://github.com/d3/d3-scale#continuous_tickFormat) function. If this method is called without any arguments, the default tick specifier is returned.
          @param {String} [*value* = undefined]
          @chainable
      */

    }, {
      key: "tickSpecifier",
      value: function tickSpecifier(_) {
        return arguments.length ? (this._tickSpecifier = _, this) : this._tickSpecifier;
      }
      /**
          @memberof Axis
          @desc Sets the behavior of the abbreviations when you are using linear scale. This method accepts two options: "normal" (uses formatAbbreviate to determinate the abbreviation) and "smallest" (uses suffix from the smallest tick as reference in every tick).
          @param {String} [*value* = "normal"]
          @chainable
      */

    }, {
      key: "tickSuffix",
      value: function tickSuffix(_) {
        return arguments.length ? (this._tickSuffix = _, this) : this._tickSuffix;
      }
      /**
          @memberof Axis
          @desc Defines a custom locale object to be used in time scale. This object must include the following properties: dateTime, date, time, periods, days, shortDays, months, shortMonths. For more information, you can revise [d3p.d3-time-format](https://github.com/d3/d3-time-format/blob/master/README.md#timeFormatLocale).
          @param {Object} [*value* = undefined]
          @chainable
      */

    }, {
      key: "timeLocale",
      value: function timeLocale(_) {
        return arguments.length ? (this._timeLocale = _, this) : this._timeLocale;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the title of the axis and returns the current class instance.
          @param {String} [*value*]
          @chainable
      */

    }, {
      key: "title",
      value: function title(_) {
        return arguments.length ? (this._title = _, this) : this._title;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the title configuration of the axis and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "titleConfig",
      value: function titleConfig(_) {
        return arguments.length ? (this._titleConfig = Object.assign(this._titleConfig, _), this) : this._titleConfig;
      }
      /**
          @memberof Axis
          @desc If *value* is specified, sets the overall width of the axis and returns the current class instance.
          @param {Number} [*value* = 400]
          @chainable
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = _, this) : this._width;
      }
    }]);

    return Axis;
  }(BaseClass);

  function _typeof$f(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$f = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$f = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$f(obj);
  }

  function _classCallCheck$d(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$b(self, call) {
    if (call && (_typeof$f(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$b(self);
  }

  function _assertThisInitialized$b(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$b(o) {
    _getPrototypeOf$b = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$b(o);
  }

  function _inherits$b(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$b(subClass, superClass);
  }

  function _setPrototypeOf$b(o, p) {
    _setPrototypeOf$b = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$b(o, p);
  }
  /**
      @class AxisBottom
      @extends Axis
      @desc Shorthand method for creating an axis where the ticks are drawn below the horizontal domain path. Extends all functionality of the base [Axis](#Axis) class.
  */

  var AxisBottom =
  /*#__PURE__*/
  function (_Axis) {
    _inherits$b(AxisBottom, _Axis);
    /**
        @memberof AxisBottom
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Axis.
        @private
    */


    function AxisBottom() {
      var _this;

      _classCallCheck$d(this, AxisBottom);

      _this = _possibleConstructorReturn$b(this, _getPrototypeOf$b(AxisBottom).call(this));

      _this.orient("bottom");

      return _this;
    }

    return AxisBottom;
  }(Axis);

  function _typeof$g(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$g = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$g = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$g(obj);
  }

  function _classCallCheck$e(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$c(self, call) {
    if (call && (_typeof$g(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$c(self);
  }

  function _assertThisInitialized$c(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$c(o) {
    _getPrototypeOf$c = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$c(o);
  }

  function _inherits$c(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$c(subClass, superClass);
  }

  function _setPrototypeOf$c(o, p) {
    _setPrototypeOf$c = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$c(o, p);
  }
  /**
      @class AxisLeft
      @extends Axis
      @desc Shorthand method for creating an axis where the ticks are drawn to the left of the vertical domain path. Extends all functionality of the base [Axis](#Axis) class.
  */

  var AxisLeft =
  /*#__PURE__*/
  function (_Axis) {
    _inherits$c(AxisLeft, _Axis);
    /**
        @memberof AxisLeft
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Axis.
        @private
    */


    function AxisLeft() {
      var _this;

      _classCallCheck$e(this, AxisLeft);

      _this = _possibleConstructorReturn$c(this, _getPrototypeOf$c(AxisLeft).call(this));

      _this.orient("left");

      return _this;
    }

    return AxisLeft;
  }(Axis);

  function _typeof$h(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$h = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$h = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$h(obj);
  }

  function _classCallCheck$f(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$d(self, call) {
    if (call && (_typeof$h(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$d(self);
  }

  function _assertThisInitialized$d(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$d(o) {
    _getPrototypeOf$d = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$d(o);
  }

  function _inherits$d(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$d(subClass, superClass);
  }

  function _setPrototypeOf$d(o, p) {
    _setPrototypeOf$d = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$d(o, p);
  }
  /**
      @class AxisRight
      @extends Axis
      @desc Shorthand method for creating an axis where the ticks are drawn to the right of the vertical domain path. Extends all functionality of the base [Axis](#Axis) class.
  */

  var AxisRight =
  /*#__PURE__*/
  function (_Axis) {
    _inherits$d(AxisRight, _Axis);
    /**
        @memberof AxisRight
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Axis.
        @private
    */


    function AxisRight() {
      var _this;

      _classCallCheck$f(this, AxisRight);

      _this = _possibleConstructorReturn$d(this, _getPrototypeOf$d(AxisRight).call(this));

      _this.orient("right");

      return _this;
    }

    return AxisRight;
  }(Axis);

  function _typeof$i(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$i = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$i = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$i(obj);
  }

  function _classCallCheck$g(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$e(self, call) {
    if (call && (_typeof$i(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$e(self);
  }

  function _assertThisInitialized$e(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$e(o) {
    _getPrototypeOf$e = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$e(o);
  }

  function _inherits$e(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$e(subClass, superClass);
  }

  function _setPrototypeOf$e(o, p) {
    _setPrototypeOf$e = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$e(o, p);
  }
  /**
      @class AxisTop
      @extends Axis
      @desc Shorthand method for creating an axis where the ticks are drawn above the vertical domain path. Extends all functionality of the base [Axis](#Axis) class.
  */

  var AxisTop =
  /*#__PURE__*/
  function (_Axis) {
    _inherits$e(AxisTop, _Axis);
    /**
        @memberof AxisTop
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Axis.
        @private
    */


    function AxisTop() {
      var _this;

      _classCallCheck$g(this, AxisTop);

      _this = _possibleConstructorReturn$e(this, _getPrototypeOf$e(AxisTop).call(this));

      _this.orient("top");

      return _this;
    }

    return AxisTop;
  }(Axis);

  function define$3 (constructor, factory, prototype) {
    constructor.prototype = factory.prototype = prototype;
    prototype.constructor = constructor;
  }
  function extend$4(parent, definition) {
    var prototype = Object.create(parent.prototype);

    for (var key in definition) {
      prototype[key] = definition[key];
    }

    return prototype;
  }

  function Color$3() {}
  var _darker$3 = 0.7;

  var _brighter$3 = 1 / _darker$3;
  var reI$3 = "\\s*([+-]?\\d+)\\s*",
      reN$3 = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",
      reP$3 = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",
      reHex$2 = /^#([0-9a-f]{3,8})$/,
      reRgbInteger$3 = new RegExp("^rgb\\(" + [reI$3, reI$3, reI$3] + "\\)$"),
      reRgbPercent$3 = new RegExp("^rgb\\(" + [reP$3, reP$3, reP$3] + "\\)$"),
      reRgbaInteger$3 = new RegExp("^rgba\\(" + [reI$3, reI$3, reI$3, reN$3] + "\\)$"),
      reRgbaPercent$3 = new RegExp("^rgba\\(" + [reP$3, reP$3, reP$3, reN$3] + "\\)$"),
      reHslPercent$3 = new RegExp("^hsl\\(" + [reN$3, reP$3, reP$3] + "\\)$"),
      reHslaPercent$3 = new RegExp("^hsla\\(" + [reN$3, reP$3, reP$3, reN$3] + "\\)$");
  var named$3 = {
    aliceblue: 0xf0f8ff,
    antiquewhite: 0xfaebd7,
    aqua: 0x00ffff,
    aquamarine: 0x7fffd4,
    azure: 0xf0ffff,
    beige: 0xf5f5dc,
    bisque: 0xffe4c4,
    black: 0x000000,
    blanchedalmond: 0xffebcd,
    blue: 0x0000ff,
    blueviolet: 0x8a2be2,
    brown: 0xa52a2a,
    burlywood: 0xdeb887,
    cadetblue: 0x5f9ea0,
    chartreuse: 0x7fff00,
    chocolate: 0xd2691e,
    coral: 0xff7f50,
    cornflowerblue: 0x6495ed,
    cornsilk: 0xfff8dc,
    crimson: 0xdc143c,
    cyan: 0x00ffff,
    darkblue: 0x00008b,
    darkcyan: 0x008b8b,
    darkgoldenrod: 0xb8860b,
    darkgray: 0xa9a9a9,
    darkgreen: 0x006400,
    darkgrey: 0xa9a9a9,
    darkkhaki: 0xbdb76b,
    darkmagenta: 0x8b008b,
    darkolivegreen: 0x556b2f,
    darkorange: 0xff8c00,
    darkorchid: 0x9932cc,
    darkred: 0x8b0000,
    darksalmon: 0xe9967a,
    darkseagreen: 0x8fbc8f,
    darkslateblue: 0x483d8b,
    darkslategray: 0x2f4f4f,
    darkslategrey: 0x2f4f4f,
    darkturquoise: 0x00ced1,
    darkviolet: 0x9400d3,
    deeppink: 0xff1493,
    deepskyblue: 0x00bfff,
    dimgray: 0x696969,
    dimgrey: 0x696969,
    dodgerblue: 0x1e90ff,
    firebrick: 0xb22222,
    floralwhite: 0xfffaf0,
    forestgreen: 0x228b22,
    fuchsia: 0xff00ff,
    gainsboro: 0xdcdcdc,
    ghostwhite: 0xf8f8ff,
    gold: 0xffd700,
    goldenrod: 0xdaa520,
    gray: 0x808080,
    green: 0x008000,
    greenyellow: 0xadff2f,
    grey: 0x808080,
    honeydew: 0xf0fff0,
    hotpink: 0xff69b4,
    indianred: 0xcd5c5c,
    indigo: 0x4b0082,
    ivory: 0xfffff0,
    khaki: 0xf0e68c,
    lavender: 0xe6e6fa,
    lavenderblush: 0xfff0f5,
    lawngreen: 0x7cfc00,
    lemonchiffon: 0xfffacd,
    lightblue: 0xadd8e6,
    lightcoral: 0xf08080,
    lightcyan: 0xe0ffff,
    lightgoldenrodyellow: 0xfafad2,
    lightgray: 0xd3d3d3,
    lightgreen: 0x90ee90,
    lightgrey: 0xd3d3d3,
    lightpink: 0xffb6c1,
    lightsalmon: 0xffa07a,
    lightseagreen: 0x20b2aa,
    lightskyblue: 0x87cefa,
    lightslategray: 0x778899,
    lightslategrey: 0x778899,
    lightsteelblue: 0xb0c4de,
    lightyellow: 0xffffe0,
    lime: 0x00ff00,
    limegreen: 0x32cd32,
    linen: 0xfaf0e6,
    magenta: 0xff00ff,
    maroon: 0x800000,
    mediumaquamarine: 0x66cdaa,
    mediumblue: 0x0000cd,
    mediumorchid: 0xba55d3,
    mediumpurple: 0x9370db,
    mediumseagreen: 0x3cb371,
    mediumslateblue: 0x7b68ee,
    mediumspringgreen: 0x00fa9a,
    mediumturquoise: 0x48d1cc,
    mediumvioletred: 0xc71585,
    midnightblue: 0x191970,
    mintcream: 0xf5fffa,
    mistyrose: 0xffe4e1,
    moccasin: 0xffe4b5,
    navajowhite: 0xffdead,
    navy: 0x000080,
    oldlace: 0xfdf5e6,
    olive: 0x808000,
    olivedrab: 0x6b8e23,
    orange: 0xffa500,
    orangered: 0xff4500,
    orchid: 0xda70d6,
    palegoldenrod: 0xeee8aa,
    palegreen: 0x98fb98,
    paleturquoise: 0xafeeee,
    palevioletred: 0xdb7093,
    papayawhip: 0xffefd5,
    peachpuff: 0xffdab9,
    peru: 0xcd853f,
    pink: 0xffc0cb,
    plum: 0xdda0dd,
    powderblue: 0xb0e0e6,
    purple: 0x800080,
    rebeccapurple: 0x663399,
    red: 0xff0000,
    rosybrown: 0xbc8f8f,
    royalblue: 0x4169e1,
    saddlebrown: 0x8b4513,
    salmon: 0xfa8072,
    sandybrown: 0xf4a460,
    seagreen: 0x2e8b57,
    seashell: 0xfff5ee,
    sienna: 0xa0522d,
    silver: 0xc0c0c0,
    skyblue: 0x87ceeb,
    slateblue: 0x6a5acd,
    slategray: 0x708090,
    slategrey: 0x708090,
    snow: 0xfffafa,
    springgreen: 0x00ff7f,
    steelblue: 0x4682b4,
    tan: 0xd2b48c,
    teal: 0x008080,
    thistle: 0xd8bfd8,
    tomato: 0xff6347,
    turquoise: 0x40e0d0,
    violet: 0xee82ee,
    wheat: 0xf5deb3,
    white: 0xffffff,
    whitesmoke: 0xf5f5f5,
    yellow: 0xffff00,
    yellowgreen: 0x9acd32
  };
  define$3(Color$3, color$3, {
    copy: function copy(channels) {
      return Object.assign(new this.constructor(), this, channels);
    },
    displayable: function displayable() {
      return this.rgb().displayable();
    },
    hex: color_formatHex$2,
    // Deprecated! Use color.formatHex.
    formatHex: color_formatHex$2,
    formatHsl: color_formatHsl$2,
    formatRgb: color_formatRgb$2,
    toString: color_formatRgb$2
  });

  function color_formatHex$2() {
    return this.rgb().formatHex();
  }

  function color_formatHsl$2() {
    return hslConvert$3(this).formatHsl();
  }

  function color_formatRgb$2() {
    return this.rgb().formatRgb();
  }

  function color$3(format) {
    var m, l;
    format = (format + "").trim().toLowerCase();
    return (m = reHex$2.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn$3(m) // #ff0000
    : l === 3 ? new Rgb$3(m >> 8 & 0xf | m >> 4 & 0xf0, m >> 4 & 0xf | m & 0xf0, (m & 0xf) << 4 | m & 0xf, 1) // #f00
    : l === 8 ? new Rgb$3(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000
    : l === 4 ? new Rgb$3(m >> 12 & 0xf | m >> 8 & 0xf0, m >> 8 & 0xf | m >> 4 & 0xf0, m >> 4 & 0xf | m & 0xf0, ((m & 0xf) << 4 | m & 0xf) / 0xff) // #f000
    : null // invalid hex
    ) : (m = reRgbInteger$3.exec(format)) ? new Rgb$3(m[1], m[2], m[3], 1) // rgb(255, 0, 0)
    : (m = reRgbPercent$3.exec(format)) ? new Rgb$3(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)
    : (m = reRgbaInteger$3.exec(format)) ? rgba$3(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)
    : (m = reRgbaPercent$3.exec(format)) ? rgba$3(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)
    : (m = reHslPercent$3.exec(format)) ? hsla$3(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)
    : (m = reHslaPercent$3.exec(format)) ? hsla$3(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)
    : named$3.hasOwnProperty(format) ? rgbn$3(named$3[format]) // eslint-disable-line no-prototype-builtins
    : format === "transparent" ? new Rgb$3(NaN, NaN, NaN, 0) : null;
  }

  function rgbn$3(n) {
    return new Rgb$3(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);
  }

  function rgba$3(r, g, b, a) {
    if (a <= 0) r = g = b = NaN;
    return new Rgb$3(r, g, b, a);
  }

  function rgbConvert$3(o) {
    if (!(o instanceof Color$3)) o = color$3(o);
    if (!o) return new Rgb$3();
    o = o.rgb();
    return new Rgb$3(o.r, o.g, o.b, o.opacity);
  }
  function rgb$3(r, g, b, opacity) {
    return arguments.length === 1 ? rgbConvert$3(r) : new Rgb$3(r, g, b, opacity == null ? 1 : opacity);
  }
  function Rgb$3(r, g, b, opacity) {
    this.r = +r;
    this.g = +g;
    this.b = +b;
    this.opacity = +opacity;
  }
  define$3(Rgb$3, rgb$3, extend$4(Color$3, {
    brighter: function brighter(k) {
      k = k == null ? _brighter$3 : Math.pow(_brighter$3, k);
      return new Rgb$3(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker$3 : Math.pow(_darker$3, k);
      return new Rgb$3(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    rgb: function rgb() {
      return this;
    },
    displayable: function displayable() {
      return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
    },
    hex: rgb_formatHex$2,
    // Deprecated! Use color.formatHex.
    formatHex: rgb_formatHex$2,
    formatRgb: rgb_formatRgb$2,
    toString: rgb_formatRgb$2
  }));

  function rgb_formatHex$2() {
    return "#" + hex$2(this.r) + hex$2(this.g) + hex$2(this.b);
  }

  function rgb_formatRgb$2() {
    var a = this.opacity;
    a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
    return (a === 1 ? "rgb(" : "rgba(") + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.b) || 0)) + (a === 1 ? ")" : ", " + a + ")");
  }

  function hex$2(value) {
    value = Math.max(0, Math.min(255, Math.round(value) || 0));
    return (value < 16 ? "0" : "") + value.toString(16);
  }

  function hsla$3(h, s, l, a) {
    if (a <= 0) h = s = l = NaN;else if (l <= 0 || l >= 1) h = s = NaN;else if (s <= 0) h = NaN;
    return new Hsl$3(h, s, l, a);
  }

  function hslConvert$3(o) {
    if (o instanceof Hsl$3) return new Hsl$3(o.h, o.s, o.l, o.opacity);
    if (!(o instanceof Color$3)) o = color$3(o);
    if (!o) return new Hsl$3();
    if (o instanceof Hsl$3) return o;
    o = o.rgb();
    var r = o.r / 255,
        g = o.g / 255,
        b = o.b / 255,
        min = Math.min(r, g, b),
        max = Math.max(r, g, b),
        h = NaN,
        s = max - min,
        l = (max + min) / 2;

    if (s) {
      if (r === max) h = (g - b) / s + (g < b) * 6;else if (g === max) h = (b - r) / s + 2;else h = (r - g) / s + 4;
      s /= l < 0.5 ? max + min : 2 - max - min;
      h *= 60;
    } else {
      s = l > 0 && l < 1 ? 0 : h;
    }

    return new Hsl$3(h, s, l, o.opacity);
  }
  function hsl$3(h, s, l, opacity) {
    return arguments.length === 1 ? hslConvert$3(h) : new Hsl$3(h, s, l, opacity == null ? 1 : opacity);
  }

  function Hsl$3(h, s, l, opacity) {
    this.h = +h;
    this.s = +s;
    this.l = +l;
    this.opacity = +opacity;
  }

  define$3(Hsl$3, hsl$3, extend$4(Color$3, {
    brighter: function brighter(k) {
      k = k == null ? _brighter$3 : Math.pow(_brighter$3, k);
      return new Hsl$3(this.h, this.s, this.l * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker$3 : Math.pow(_darker$3, k);
      return new Hsl$3(this.h, this.s, this.l * k, this.opacity);
    },
    rgb: function rgb() {
      var h = this.h % 360 + (this.h < 0) * 360,
          s = isNaN(h) || isNaN(this.s) ? 0 : this.s,
          l = this.l,
          m2 = l + (l < 0.5 ? l : 1 - l) * s,
          m1 = 2 * l - m2;
      return new Rgb$3(hsl2rgb$3(h >= 240 ? h - 240 : h + 120, m1, m2), hsl2rgb$3(h, m1, m2), hsl2rgb$3(h < 120 ? h + 240 : h - 120, m1, m2), this.opacity);
    },
    displayable: function displayable() {
      return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
    },
    formatHsl: function formatHsl() {
      var a = this.opacity;
      a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
      return (a === 1 ? "hsl(" : "hsla(") + (this.h || 0) + ", " + (this.s || 0) * 100 + "%, " + (this.l || 0) * 100 + "%" + (a === 1 ? ")" : ", " + a + ")");
    }
  }));
  /* From FvD 13.37, CSS Color Module Level 3 */

  function hsl2rgb$3(h, m1, m2) {
    return (h < 60 ? m1 + (m2 - m1) * h / 60 : h < 180 ? m2 : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60 : m1) * 255;
  }

  // Adds floating point numbers with twice the normal precision.
  // Reference: J. R. Shewchuk, Adaptive Precision Floating-Point Arithmetic and
  // Fast Robust Geometric Predicates, Discrete & Computational Geometry 18(3)
  // 305363 (1997).
  // Code adapted from GeographicLib by Charles F. F. Karney,
  // http://geographiclib.sourceforge.net/
  function adder () {
    return new Adder();
  }

  function Adder() {
    this.reset();
  }

  Adder.prototype = {
    constructor: Adder,
    reset: function reset() {
      this.s = // rounded value
      this.t = 0; // exact error
    },
    add: function add(y) {
      _add(temp, y, this.t);

      _add(this, temp.s, this.s);

      if (this.s) this.t += temp.t;else this.s = temp.t;
    },
    valueOf: function valueOf() {
      return this.s;
    }
  };
  var temp = new Adder();

  function _add(adder, a, b) {
    var x = adder.s = a + b,
        bv = x - a,
        av = x - bv;
    adder.t = a - av + (b - bv);
  }

  var epsilon$2 = 1e-6;
  var epsilon2$1 = 1e-12;
  var pi$4 = Math.PI;
  var halfPi$1 = pi$4 / 2;
  var quarterPi = pi$4 / 4;
  var tau$2 = pi$4 * 2;
  var degrees$1 = 180 / pi$4;
  var radians = pi$4 / 180;
  var abs$1 = Math.abs;
  var atan = Math.atan;
  var atan2$1 = Math.atan2;
  var cos$1 = Math.cos;
  var ceil = Math.ceil;
  var exp = Math.exp;
  var log$1 = Math.log;
  var pow$1 = Math.pow;
  var sin$1 = Math.sin;
  var sign$1 = Math.sign || function (x) {
    return x > 0 ? 1 : x < 0 ? -1 : 0;
  };
  var sqrt$2 = Math.sqrt;
  var tan = Math.tan;
  function acos$1(x) {
    return x > 1 ? 0 : x < -1 ? pi$4 : Math.acos(x);
  }
  function asin$1(x) {
    return x > 1 ? halfPi$1 : x < -1 ? -halfPi$1 : Math.asin(x);
  }
  function haversin(x) {
    return (x = sin$1(x / 2)) * x;
  }

  function noop$2() {}

  function streamGeometry(geometry, stream) {
    if (geometry && streamGeometryType.hasOwnProperty(geometry.type)) {
      streamGeometryType[geometry.type](geometry, stream);
    }
  }

  var streamObjectType = {
    Feature: function Feature(object, stream) {
      streamGeometry(object.geometry, stream);
    },
    FeatureCollection: function FeatureCollection(object, stream) {
      var features = object.features,
          i = -1,
          n = features.length;

      while (++i < n) {
        streamGeometry(features[i].geometry, stream);
      }
    }
  };
  var streamGeometryType = {
    Sphere: function Sphere(object, stream) {
      stream.sphere();
    },
    Point: function Point(object, stream) {
      object = object.coordinates;
      stream.point(object[0], object[1], object[2]);
    },
    MultiPoint: function MultiPoint(object, stream) {
      var coordinates = object.coordinates,
          i = -1,
          n = coordinates.length;

      while (++i < n) {
        object = coordinates[i], stream.point(object[0], object[1], object[2]);
      }
    },
    LineString: function LineString(object, stream) {
      streamLine(object.coordinates, stream, 0);
    },
    MultiLineString: function MultiLineString(object, stream) {
      var coordinates = object.coordinates,
          i = -1,
          n = coordinates.length;

      while (++i < n) {
        streamLine(coordinates[i], stream, 0);
      }
    },
    Polygon: function Polygon(object, stream) {
      streamPolygon(object.coordinates, stream);
    },
    MultiPolygon: function MultiPolygon(object, stream) {
      var coordinates = object.coordinates,
          i = -1,
          n = coordinates.length;

      while (++i < n) {
        streamPolygon(coordinates[i], stream);
      }
    },
    GeometryCollection: function GeometryCollection(object, stream) {
      var geometries = object.geometries,
          i = -1,
          n = geometries.length;

      while (++i < n) {
        streamGeometry(geometries[i], stream);
      }
    }
  };

  function streamLine(coordinates, stream, closed) {
    var i = -1,
        n = coordinates.length - closed,
        coordinate;
    stream.lineStart();

    while (++i < n) {
      coordinate = coordinates[i], stream.point(coordinate[0], coordinate[1], coordinate[2]);
    }

    stream.lineEnd();
  }

  function streamPolygon(coordinates, stream) {
    var i = -1,
        n = coordinates.length;
    stream.polygonStart();

    while (++i < n) {
      streamLine(coordinates[i], stream, 1);
    }

    stream.polygonEnd();
  }

  function geoStream (object, stream) {
    if (object && streamObjectType.hasOwnProperty(object.type)) {
      streamObjectType[object.type](object, stream);
    } else {
      streamGeometry(object, stream);
    }
  }

  var areaRingSum = adder();
  var areaSum = adder(),
      lambda00,
      phi00,
      lambda0,
      cosPhi0,
      sinPhi0;
  var areaStream = {
    point: noop$2,
    lineStart: noop$2,
    lineEnd: noop$2,
    polygonStart: function polygonStart() {
      areaRingSum.reset();
      areaStream.lineStart = areaRingStart;
      areaStream.lineEnd = areaRingEnd;
    },
    polygonEnd: function polygonEnd() {
      var areaRing = +areaRingSum;
      areaSum.add(areaRing < 0 ? tau$2 + areaRing : areaRing);
      this.lineStart = this.lineEnd = this.point = noop$2;
    },
    sphere: function sphere() {
      areaSum.add(tau$2);
    }
  };

  function areaRingStart() {
    areaStream.point = areaPointFirst;
  }

  function areaRingEnd() {
    areaPoint(lambda00, phi00);
  }

  function areaPointFirst(lambda, phi) {
    areaStream.point = areaPoint;
    lambda00 = lambda, phi00 = phi;
    lambda *= radians, phi *= radians;
    lambda0 = lambda, cosPhi0 = cos$1(phi = phi / 2 + quarterPi), sinPhi0 = sin$1(phi);
  }

  function areaPoint(lambda, phi) {
    lambda *= radians, phi *= radians;
    phi = phi / 2 + quarterPi; // half the angular distance from south pole
    // Spherical excess E for a spherical triangle with vertices: south pole,
    // previous point, current point.  Uses a formula derived from Cagnolis
    // theorem.  See Todhunter, Spherical Trig. (1871), Sec. 103, Eq. (2).

    var dLambda = lambda - lambda0,
        sdLambda = dLambda >= 0 ? 1 : -1,
        adLambda = sdLambda * dLambda,
        cosPhi = cos$1(phi),
        sinPhi = sin$1(phi),
        k = sinPhi0 * sinPhi,
        u = cosPhi0 * cosPhi + k * cos$1(adLambda),
        v = k * sdLambda * sin$1(adLambda);
    areaRingSum.add(atan2$1(v, u)); // Advance the previous points.

    lambda0 = lambda, cosPhi0 = cosPhi, sinPhi0 = sinPhi;
  }

  function area$1 (object) {
    areaSum.reset();
    geoStream(object, areaStream);
    return areaSum * 2;
  }

  function spherical(cartesian) {
    return [atan2$1(cartesian[1], cartesian[0]), asin$1(cartesian[2])];
  }
  function cartesian(spherical) {
    var lambda = spherical[0],
        phi = spherical[1],
        cosPhi = cos$1(phi);
    return [cosPhi * cos$1(lambda), cosPhi * sin$1(lambda), sin$1(phi)];
  }
  function cartesianDot(a, b) {
    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
  }
  function cartesianCross(a, b) {
    return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];
  } // TODO return a

  function cartesianAddInPlace(a, b) {
    a[0] += b[0], a[1] += b[1], a[2] += b[2];
  }
  function cartesianScale(vector, k) {
    return [vector[0] * k, vector[1] * k, vector[2] * k];
  } // TODO return d

  function cartesianNormalizeInPlace(d) {
    var l = sqrt$2(d[0] * d[0] + d[1] * d[1] + d[2] * d[2]);
    d[0] /= l, d[1] /= l, d[2] /= l;
  }

  var lambda0$1,
      phi0,
      lambda1,
      phi1,
      // bounds
  lambda2,
      // previous lambda-coordinate
  lambda00$1,
      phi00$1,
      // first point
  p0,
      // previous 3D point
  deltaSum = adder(),
      ranges,
      range$1;
  var boundsStream = {
    point: boundsPoint,
    lineStart: boundsLineStart,
    lineEnd: boundsLineEnd,
    polygonStart: function polygonStart() {
      boundsStream.point = boundsRingPoint;
      boundsStream.lineStart = boundsRingStart;
      boundsStream.lineEnd = boundsRingEnd;
      deltaSum.reset();
      areaStream.polygonStart();
    },
    polygonEnd: function polygonEnd() {
      areaStream.polygonEnd();
      boundsStream.point = boundsPoint;
      boundsStream.lineStart = boundsLineStart;
      boundsStream.lineEnd = boundsLineEnd;
      if (areaRingSum < 0) lambda0$1 = -(lambda1 = 180), phi0 = -(phi1 = 90);else if (deltaSum > epsilon$2) phi1 = 90;else if (deltaSum < -epsilon$2) phi0 = -90;
      range$1[0] = lambda0$1, range$1[1] = lambda1;
    },
    sphere: function sphere() {
      lambda0$1 = -(lambda1 = 180), phi0 = -(phi1 = 90);
    }
  };

  function boundsPoint(lambda, phi) {
    ranges.push(range$1 = [lambda0$1 = lambda, lambda1 = lambda]);
    if (phi < phi0) phi0 = phi;
    if (phi > phi1) phi1 = phi;
  }

  function linePoint(lambda, phi) {
    var p = cartesian([lambda * radians, phi * radians]);

    if (p0) {
      var normal = cartesianCross(p0, p),
          equatorial = [normal[1], -normal[0], 0],
          inflection = cartesianCross(equatorial, normal);
      cartesianNormalizeInPlace(inflection);
      inflection = spherical(inflection);
      var delta = lambda - lambda2,
          sign = delta > 0 ? 1 : -1,
          lambdai = inflection[0] * degrees$1 * sign,
          phii,
          antimeridian = abs$1(delta) > 180;

      if (antimeridian ^ (sign * lambda2 < lambdai && lambdai < sign * lambda)) {
        phii = inflection[1] * degrees$1;
        if (phii > phi1) phi1 = phii;
      } else if (lambdai = (lambdai + 360) % 360 - 180, antimeridian ^ (sign * lambda2 < lambdai && lambdai < sign * lambda)) {
        phii = -inflection[1] * degrees$1;
        if (phii < phi0) phi0 = phii;
      } else {
        if (phi < phi0) phi0 = phi;
        if (phi > phi1) phi1 = phi;
      }

      if (antimeridian) {
        if (lambda < lambda2) {
          if (angle(lambda0$1, lambda) > angle(lambda0$1, lambda1)) lambda1 = lambda;
        } else {
          if (angle(lambda, lambda1) > angle(lambda0$1, lambda1)) lambda0$1 = lambda;
        }
      } else {
        if (lambda1 >= lambda0$1) {
          if (lambda < lambda0$1) lambda0$1 = lambda;
          if (lambda > lambda1) lambda1 = lambda;
        } else {
          if (lambda > lambda2) {
            if (angle(lambda0$1, lambda) > angle(lambda0$1, lambda1)) lambda1 = lambda;
          } else {
            if (angle(lambda, lambda1) > angle(lambda0$1, lambda1)) lambda0$1 = lambda;
          }
        }
      }
    } else {
      ranges.push(range$1 = [lambda0$1 = lambda, lambda1 = lambda]);
    }

    if (phi < phi0) phi0 = phi;
    if (phi > phi1) phi1 = phi;
    p0 = p, lambda2 = lambda;
  }

  function boundsLineStart() {
    boundsStream.point = linePoint;
  }

  function boundsLineEnd() {
    range$1[0] = lambda0$1, range$1[1] = lambda1;
    boundsStream.point = boundsPoint;
    p0 = null;
  }

  function boundsRingPoint(lambda, phi) {
    if (p0) {
      var delta = lambda - lambda2;
      deltaSum.add(abs$1(delta) > 180 ? delta + (delta > 0 ? 360 : -360) : delta);
    } else {
      lambda00$1 = lambda, phi00$1 = phi;
    }

    areaStream.point(lambda, phi);
    linePoint(lambda, phi);
  }

  function boundsRingStart() {
    areaStream.lineStart();
  }

  function boundsRingEnd() {
    boundsRingPoint(lambda00$1, phi00$1);
    areaStream.lineEnd();
    if (abs$1(deltaSum) > epsilon$2) lambda0$1 = -(lambda1 = 180);
    range$1[0] = lambda0$1, range$1[1] = lambda1;
    p0 = null;
  } // Finds the left-right distance between two longitudes.
  // This is almost the same as (lambda1 - lambda0 + 360) % 360, except that we want
  // the distance between 180 to be 360.


  function angle(lambda0, lambda1) {
    return (lambda1 -= lambda0) < 0 ? lambda1 + 360 : lambda1;
  }

  function rangeCompare(a, b) {
    return a[0] - b[0];
  }

  function rangeContains(range, x) {
    return range[0] <= range[1] ? range[0] <= x && x <= range[1] : x < range[0] || range[1] < x;
  }

  function bounds (feature) {
    var i, n, a, b, merged, deltaMax, delta;
    phi1 = lambda1 = -(lambda0$1 = phi0 = Infinity);
    ranges = [];
    geoStream(feature, boundsStream); // First, sort ranges by their minimum longitudes.

    if (n = ranges.length) {
      ranges.sort(rangeCompare); // Then, merge any ranges that overlap.

      for (i = 1, a = ranges[0], merged = [a]; i < n; ++i) {
        b = ranges[i];

        if (rangeContains(a, b[0]) || rangeContains(a, b[1])) {
          if (angle(a[0], b[1]) > angle(a[0], a[1])) a[1] = b[1];
          if (angle(b[0], a[1]) > angle(a[0], a[1])) a[0] = b[0];
        } else {
          merged.push(a = b);
        }
      } // Finally, find the largest gap between the merged ranges.
      // The final bounding box will be the inverse of this gap.


      for (deltaMax = -Infinity, n = merged.length - 1, i = 0, a = merged[n]; i <= n; a = b, ++i) {
        b = merged[i];
        if ((delta = angle(a[1], b[0])) > deltaMax) deltaMax = delta, lambda0$1 = b[0], lambda1 = a[1];
      }
    }

    ranges = range$1 = null;
    return lambda0$1 === Infinity || phi0 === Infinity ? [[NaN, NaN], [NaN, NaN]] : [[lambda0$1, phi0], [lambda1, phi1]];
  }

  var W0, W1, X0, Y0, Z0, X1, Y1, Z1, X2, Y2, Z2, lambda00$2, phi00$2, // first point
  x0, y0, z0; // previous point

  var centroidStream = {
    sphere: noop$2,
    point: centroidPoint,
    lineStart: centroidLineStart,
    lineEnd: centroidLineEnd,
    polygonStart: function polygonStart() {
      centroidStream.lineStart = centroidRingStart;
      centroidStream.lineEnd = centroidRingEnd;
    },
    polygonEnd: function polygonEnd() {
      centroidStream.lineStart = centroidLineStart;
      centroidStream.lineEnd = centroidLineEnd;
    }
  }; // Arithmetic mean of Cartesian vectors.

  function centroidPoint(lambda, phi) {
    lambda *= radians, phi *= radians;
    var cosPhi = cos$1(phi);
    centroidPointCartesian(cosPhi * cos$1(lambda), cosPhi * sin$1(lambda), sin$1(phi));
  }

  function centroidPointCartesian(x, y, z) {
    ++W0;
    X0 += (x - X0) / W0;
    Y0 += (y - Y0) / W0;
    Z0 += (z - Z0) / W0;
  }

  function centroidLineStart() {
    centroidStream.point = centroidLinePointFirst;
  }

  function centroidLinePointFirst(lambda, phi) {
    lambda *= radians, phi *= radians;
    var cosPhi = cos$1(phi);
    x0 = cosPhi * cos$1(lambda);
    y0 = cosPhi * sin$1(lambda);
    z0 = sin$1(phi);
    centroidStream.point = centroidLinePoint;
    centroidPointCartesian(x0, y0, z0);
  }

  function centroidLinePoint(lambda, phi) {
    lambda *= radians, phi *= radians;
    var cosPhi = cos$1(phi),
        x = cosPhi * cos$1(lambda),
        y = cosPhi * sin$1(lambda),
        z = sin$1(phi),
        w = atan2$1(sqrt$2((w = y0 * z - z0 * y) * w + (w = z0 * x - x0 * z) * w + (w = x0 * y - y0 * x) * w), x0 * x + y0 * y + z0 * z);
    W1 += w;
    X1 += w * (x0 + (x0 = x));
    Y1 += w * (y0 + (y0 = y));
    Z1 += w * (z0 + (z0 = z));
    centroidPointCartesian(x0, y0, z0);
  }

  function centroidLineEnd() {
    centroidStream.point = centroidPoint;
  } // See J. E. Brock, The Inertia Tensor for a Spherical Triangle,
  // J. Applied Mechanics 42, 239 (1975).


  function centroidRingStart() {
    centroidStream.point = centroidRingPointFirst;
  }

  function centroidRingEnd() {
    centroidRingPoint(lambda00$2, phi00$2);
    centroidStream.point = centroidPoint;
  }

  function centroidRingPointFirst(lambda, phi) {
    lambda00$2 = lambda, phi00$2 = phi;
    lambda *= radians, phi *= radians;
    centroidStream.point = centroidRingPoint;
    var cosPhi = cos$1(phi);
    x0 = cosPhi * cos$1(lambda);
    y0 = cosPhi * sin$1(lambda);
    z0 = sin$1(phi);
    centroidPointCartesian(x0, y0, z0);
  }

  function centroidRingPoint(lambda, phi) {
    lambda *= radians, phi *= radians;
    var cosPhi = cos$1(phi),
        x = cosPhi * cos$1(lambda),
        y = cosPhi * sin$1(lambda),
        z = sin$1(phi),
        cx = y0 * z - z0 * y,
        cy = z0 * x - x0 * z,
        cz = x0 * y - y0 * x,
        m = sqrt$2(cx * cx + cy * cy + cz * cz),
        w = asin$1(m),
        // line weight = angle
    v = m && -w / m; // area weight multiplier

    X2 += v * cx;
    Y2 += v * cy;
    Z2 += v * cz;
    W1 += w;
    X1 += w * (x0 + (x0 = x));
    Y1 += w * (y0 + (y0 = y));
    Z1 += w * (z0 + (z0 = z));
    centroidPointCartesian(x0, y0, z0);
  }

  function centroid (object) {
    W0 = W1 = X0 = Y0 = Z0 = X1 = Y1 = Z1 = X2 = Y2 = Z2 = 0;
    geoStream(object, centroidStream);
    var x = X2,
        y = Y2,
        z = Z2,
        m = x * x + y * y + z * z; // If the area-weighted ccentroid is undefined, fall back to length-weighted ccentroid.

    if (m < epsilon2$1) {
      x = X1, y = Y1, z = Z1; // If the feature has zero length, fall back to arithmetic mean of point vectors.

      if (W1 < epsilon$2) x = X0, y = Y0, z = Z0;
      m = x * x + y * y + z * z; // If the feature still has an undefined ccentroid, then return.

      if (m < epsilon2$1) return [NaN, NaN];
    }

    return [atan2$1(y, x) * degrees$1, asin$1(z / sqrt$2(m)) * degrees$1];
  }

  function constant$5 (x) {
    return function () {
      return x;
    };
  }

  function compose (a, b) {
    function compose(x, y) {
      return x = a(x, y), b(x[0], x[1]);
    }

    if (a.invert && b.invert) compose.invert = function (x, y) {
      return x = b.invert(x, y), x && a.invert(x[0], x[1]);
    };
    return compose;
  }

  function rotationIdentity(lambda, phi) {
    return [abs$1(lambda) > pi$4 ? lambda + Math.round(-lambda / tau$2) * tau$2 : lambda, phi];
  }

  rotationIdentity.invert = rotationIdentity;
  function rotateRadians(deltaLambda, deltaPhi, deltaGamma) {
    return (deltaLambda %= tau$2) ? deltaPhi || deltaGamma ? compose(rotationLambda(deltaLambda), rotationPhiGamma(deltaPhi, deltaGamma)) : rotationLambda(deltaLambda) : deltaPhi || deltaGamma ? rotationPhiGamma(deltaPhi, deltaGamma) : rotationIdentity;
  }

  function forwardRotationLambda(deltaLambda) {
    return function (lambda, phi) {
      return lambda += deltaLambda, [lambda > pi$4 ? lambda - tau$2 : lambda < -pi$4 ? lambda + tau$2 : lambda, phi];
    };
  }

  function rotationLambda(deltaLambda) {
    var rotation = forwardRotationLambda(deltaLambda);
    rotation.invert = forwardRotationLambda(-deltaLambda);
    return rotation;
  }

  function rotationPhiGamma(deltaPhi, deltaGamma) {
    var cosDeltaPhi = cos$1(deltaPhi),
        sinDeltaPhi = sin$1(deltaPhi),
        cosDeltaGamma = cos$1(deltaGamma),
        sinDeltaGamma = sin$1(deltaGamma);

    function rotation(lambda, phi) {
      var cosPhi = cos$1(phi),
          x = cos$1(lambda) * cosPhi,
          y = sin$1(lambda) * cosPhi,
          z = sin$1(phi),
          k = z * cosDeltaPhi + x * sinDeltaPhi;
      return [atan2$1(y * cosDeltaGamma - k * sinDeltaGamma, x * cosDeltaPhi - z * sinDeltaPhi), asin$1(k * cosDeltaGamma + y * sinDeltaGamma)];
    }

    rotation.invert = function (lambda, phi) {
      var cosPhi = cos$1(phi),
          x = cos$1(lambda) * cosPhi,
          y = sin$1(lambda) * cosPhi,
          z = sin$1(phi),
          k = z * cosDeltaGamma - y * sinDeltaGamma;
      return [atan2$1(y * cosDeltaGamma + z * sinDeltaGamma, x * cosDeltaPhi + k * sinDeltaPhi), asin$1(k * cosDeltaPhi - x * sinDeltaPhi)];
    };

    return rotation;
  }

  function rotation (rotate) {
    rotate = rotateRadians(rotate[0] * radians, rotate[1] * radians, rotate.length > 2 ? rotate[2] * radians : 0);

    function forward(coordinates) {
      coordinates = rotate(coordinates[0] * radians, coordinates[1] * radians);
      return coordinates[0] *= degrees$1, coordinates[1] *= degrees$1, coordinates;
    }

    forward.invert = function (coordinates) {
      coordinates = rotate.invert(coordinates[0] * radians, coordinates[1] * radians);
      return coordinates[0] *= degrees$1, coordinates[1] *= degrees$1, coordinates;
    };

    return forward;
  }

  function circleStream(stream, radius, delta, direction, t0, t1) {
    if (!delta) return;
    var cosRadius = cos$1(radius),
        sinRadius = sin$1(radius),
        step = direction * delta;

    if (t0 == null) {
      t0 = radius + direction * tau$2;
      t1 = radius - step / 2;
    } else {
      t0 = circleRadius(cosRadius, t0);
      t1 = circleRadius(cosRadius, t1);
      if (direction > 0 ? t0 < t1 : t0 > t1) t0 += direction * tau$2;
    }

    for (var point, t = t0; direction > 0 ? t > t1 : t < t1; t -= step) {
      point = spherical([cosRadius, -sinRadius * cos$1(t), -sinRadius * sin$1(t)]);
      stream.point(point[0], point[1]);
    }
  } // Returns the signed angle of a cartesian point relative to [cosRadius, 0, 0].

  function circleRadius(cosRadius, point) {
    point = cartesian(point), point[0] -= cosRadius;
    cartesianNormalizeInPlace(point);
    var radius = acos$1(-point[1]);
    return ((-point[2] < 0 ? -radius : radius) + tau$2 - epsilon$2) % tau$2;
  }

  function circle$1 () {
    var center = constant$5([0, 0]),
        radius = constant$5(90),
        precision = constant$5(6),
        ring,
        rotate,
        stream = {
      point: point
    };

    function point(x, y) {
      ring.push(x = rotate(x, y));
      x[0] *= degrees$1, x[1] *= degrees$1;
    }

    function circle() {
      var c = center.apply(this, arguments),
          r = radius.apply(this, arguments) * radians,
          p = precision.apply(this, arguments) * radians;
      ring = [];
      rotate = rotateRadians(-c[0] * radians, -c[1] * radians, 0).invert;
      circleStream(stream, r, p, 1);
      c = {
        type: "Polygon",
        coordinates: [ring]
      };
      ring = rotate = null;
      return c;
    }

    circle.center = function (_) {
      return arguments.length ? (center = typeof _ === "function" ? _ : constant$5([+_[0], +_[1]]), circle) : center;
    };

    circle.radius = function (_) {
      return arguments.length ? (radius = typeof _ === "function" ? _ : constant$5(+_), circle) : radius;
    };

    circle.precision = function (_) {
      return arguments.length ? (precision = typeof _ === "function" ? _ : constant$5(+_), circle) : precision;
    };

    return circle;
  }

  function clipBuffer () {
    var lines = [],
        line;
    return {
      point: function point(x, y) {
        line.push([x, y]);
      },
      lineStart: function lineStart() {
        lines.push(line = []);
      },
      lineEnd: noop$2,
      rejoin: function rejoin() {
        if (lines.length > 1) lines.push(lines.pop().concat(lines.shift()));
      },
      result: function result() {
        var result = lines;
        lines = [];
        line = null;
        return result;
      }
    };
  }

  function pointEqual (a, b) {
    return abs$1(a[0] - b[0]) < epsilon$2 && abs$1(a[1] - b[1]) < epsilon$2;
  }

  function Intersection(point, points, other, entry) {
    this.x = point;
    this.z = points;
    this.o = other; // another intersection

    this.e = entry; // is an entry?

    this.v = false; // visited

    this.n = this.p = null; // next & previous
  } // A generalized polygon clipping algorithm: given a polygon that has been cut
  // into its visible line segments, and rejoins the segments by interpolating
  // along the clip edge.


  function clipRejoin (segments, compareIntersection, startInside, interpolate, stream) {
    var subject = [],
        clip = [],
        i,
        n;
    segments.forEach(function (segment) {
      if ((n = segment.length - 1) <= 0) return;
      var n,
          p0 = segment[0],
          p1 = segment[n],
          x; // If the first and last points of a segment are coincident, then treat as a
      // closed ring. TODO if all rings are closed, then the winding order of the
      // exterior ring should be checked.

      if (pointEqual(p0, p1)) {
        stream.lineStart();

        for (i = 0; i < n; ++i) {
          stream.point((p0 = segment[i])[0], p0[1]);
        }

        stream.lineEnd();
        return;
      }

      subject.push(x = new Intersection(p0, segment, null, true));
      clip.push(x.o = new Intersection(p0, null, x, false));
      subject.push(x = new Intersection(p1, segment, null, false));
      clip.push(x.o = new Intersection(p1, null, x, true));
    });
    if (!subject.length) return;
    clip.sort(compareIntersection);
    link$1(subject);
    link$1(clip);

    for (i = 0, n = clip.length; i < n; ++i) {
      clip[i].e = startInside = !startInside;
    }

    var start = subject[0],
        points,
        point;

    while (1) {
      // Find first unvisited intersection.
      var current = start,
          isSubject = true;

      while (current.v) {
        if ((current = current.n) === start) return;
      }

      points = current.z;
      stream.lineStart();

      do {
        current.v = current.o.v = true;

        if (current.e) {
          if (isSubject) {
            for (i = 0, n = points.length; i < n; ++i) {
              stream.point((point = points[i])[0], point[1]);
            }
          } else {
            interpolate(current.x, current.n.x, 1, stream);
          }

          current = current.n;
        } else {
          if (isSubject) {
            points = current.p.z;

            for (i = points.length - 1; i >= 0; --i) {
              stream.point((point = points[i])[0], point[1]);
            }
          } else {
            interpolate(current.x, current.p.x, -1, stream);
          }

          current = current.p;
        }

        current = current.o;
        points = current.z;
        isSubject = !isSubject;
      } while (!current.v);

      stream.lineEnd();
    }
  }

  function link$1(array) {
    if (!(n = array.length)) return;
    var n,
        i = 0,
        a = array[0],
        b;

    while (++i < n) {
      a.n = b = array[i];
      b.p = a;
      a = b;
    }

    a.n = b = array[0];
    b.p = a;
  }

  var sum$2 = adder();

  function longitude(point) {
    if (abs$1(point[0]) <= pi$4) return point[0];else return sign$1(point[0]) * ((abs$1(point[0]) + pi$4) % tau$2 - pi$4);
  }

  function polygonContains$1 (polygon, point) {
    var lambda = longitude(point),
        phi = point[1],
        sinPhi = sin$1(phi),
        normal = [sin$1(lambda), -cos$1(lambda), 0],
        angle = 0,
        winding = 0;
    sum$2.reset();
    if (sinPhi === 1) phi = halfPi$1 + epsilon$2;else if (sinPhi === -1) phi = -halfPi$1 - epsilon$2;

    for (var i = 0, n = polygon.length; i < n; ++i) {
      if (!(m = (ring = polygon[i]).length)) continue;
      var ring,
          m,
          point0 = ring[m - 1],
          lambda0 = longitude(point0),
          phi0 = point0[1] / 2 + quarterPi,
          sinPhi0 = sin$1(phi0),
          cosPhi0 = cos$1(phi0);

      for (var j = 0; j < m; ++j, lambda0 = lambda1, sinPhi0 = sinPhi1, cosPhi0 = cosPhi1, point0 = point1) {
        var point1 = ring[j],
            lambda1 = longitude(point1),
            phi1 = point1[1] / 2 + quarterPi,
            sinPhi1 = sin$1(phi1),
            cosPhi1 = cos$1(phi1),
            delta = lambda1 - lambda0,
            sign = delta >= 0 ? 1 : -1,
            absDelta = sign * delta,
            antimeridian = absDelta > pi$4,
            k = sinPhi0 * sinPhi1;
        sum$2.add(atan2$1(k * sign * sin$1(absDelta), cosPhi0 * cosPhi1 + k * cos$1(absDelta)));
        angle += antimeridian ? delta + sign * tau$2 : delta; // Are the longitudes either side of the points meridian (lambda),
        // and are the latitudes smaller than the parallel (phi)?

        if (antimeridian ^ lambda0 >= lambda ^ lambda1 >= lambda) {
          var arc = cartesianCross(cartesian(point0), cartesian(point1));
          cartesianNormalizeInPlace(arc);
          var intersection = cartesianCross(normal, arc);
          cartesianNormalizeInPlace(intersection);
          var phiArc = (antimeridian ^ delta >= 0 ? -1 : 1) * asin$1(intersection[2]);

          if (phi > phiArc || phi === phiArc && (arc[0] || arc[1])) {
            winding += antimeridian ^ delta >= 0 ? 1 : -1;
          }
        }
      }
    } // First, determine whether the South pole is inside or outside:
    //
    // It is inside if:
    // * the polygon winds around it in a clockwise direction.
    // * the polygon does not (cumulatively) wind around it, but has a negative
    //   (counter-clockwise) area.
    //
    // Second, count the (signed) number of times a segment crosses a lambda
    // from the point to the South pole.  If it is zero, then the point is the
    // same side as the South pole.


    return (angle < -epsilon$2 || angle < epsilon$2 && sum$2 < -epsilon$2) ^ winding & 1;
  }

  function clip (pointVisible, clipLine, interpolate, start) {
    return function (sink) {
      var line = clipLine(sink),
          ringBuffer = clipBuffer(),
          ringSink = clipLine(ringBuffer),
          polygonStarted = false,
          polygon,
          segments,
          ring;
      var clip = {
        point: point,
        lineStart: lineStart,
        lineEnd: lineEnd,
        polygonStart: function polygonStart() {
          clip.point = pointRing;
          clip.lineStart = ringStart;
          clip.lineEnd = ringEnd;
          segments = [];
          polygon = [];
        },
        polygonEnd: function polygonEnd() {
          clip.point = point;
          clip.lineStart = lineStart;
          clip.lineEnd = lineEnd;
          segments = merge(segments);
          var startInside = polygonContains$1(polygon, start);

          if (segments.length) {
            if (!polygonStarted) sink.polygonStart(), polygonStarted = true;
            clipRejoin(segments, compareIntersection, startInside, interpolate, sink);
          } else if (startInside) {
            if (!polygonStarted) sink.polygonStart(), polygonStarted = true;
            sink.lineStart();
            interpolate(null, null, 1, sink);
            sink.lineEnd();
          }

          if (polygonStarted) sink.polygonEnd(), polygonStarted = false;
          segments = polygon = null;
        },
        sphere: function sphere() {
          sink.polygonStart();
          sink.lineStart();
          interpolate(null, null, 1, sink);
          sink.lineEnd();
          sink.polygonEnd();
        }
      };

      function point(lambda, phi) {
        if (pointVisible(lambda, phi)) sink.point(lambda, phi);
      }

      function pointLine(lambda, phi) {
        line.point(lambda, phi);
      }

      function lineStart() {
        clip.point = pointLine;
        line.lineStart();
      }

      function lineEnd() {
        clip.point = point;
        line.lineEnd();
      }

      function pointRing(lambda, phi) {
        ring.push([lambda, phi]);
        ringSink.point(lambda, phi);
      }

      function ringStart() {
        ringSink.lineStart();
        ring = [];
      }

      function ringEnd() {
        pointRing(ring[0][0], ring[0][1]);
        ringSink.lineEnd();
        var clean = ringSink.clean(),
            ringSegments = ringBuffer.result(),
            i,
            n = ringSegments.length,
            m,
            segment,
            point;
        ring.pop();
        polygon.push(ring);
        ring = null;
        if (!n) return; // No intersections.

        if (clean & 1) {
          segment = ringSegments[0];

          if ((m = segment.length - 1) > 0) {
            if (!polygonStarted) sink.polygonStart(), polygonStarted = true;
            sink.lineStart();

            for (i = 0; i < m; ++i) {
              sink.point((point = segment[i])[0], point[1]);
            }

            sink.lineEnd();
          }

          return;
        } // Rejoin connected segments.
        // TODO reuse ringBuffer.rejoin()?


        if (n > 1 && clean & 2) ringSegments.push(ringSegments.pop().concat(ringSegments.shift()));
        segments.push(ringSegments.filter(validSegment));
      }

      return clip;
    };
  }

  function validSegment(segment) {
    return segment.length > 1;
  } // Intersections are sorted along the clip edge. For both antimeridian cutting
  // and circle clipping, the same comparison is used.


  function compareIntersection(a, b) {
    return ((a = a.x)[0] < 0 ? a[1] - halfPi$1 - epsilon$2 : halfPi$1 - a[1]) - ((b = b.x)[0] < 0 ? b[1] - halfPi$1 - epsilon$2 : halfPi$1 - b[1]);
  }

  var clipAntimeridian = clip(function () {
    return true;
  }, clipAntimeridianLine, clipAntimeridianInterpolate, [-pi$4, -halfPi$1]); // Takes a line and cuts into visible segments. Return values: 0 - there were
  // intersections or the line was empty; 1 - no intersections; 2 - there were
  // intersections, and the first and last segments should be rejoined.

  function clipAntimeridianLine(stream) {
    var lambda0 = NaN,
        phi0 = NaN,
        sign0 = NaN,
        _clean; // no intersections


    return {
      lineStart: function lineStart() {
        stream.lineStart();
        _clean = 1;
      },
      point: function point(lambda1, phi1) {
        var sign1 = lambda1 > 0 ? pi$4 : -pi$4,
            delta = abs$1(lambda1 - lambda0);

        if (abs$1(delta - pi$4) < epsilon$2) {
          // line crosses a pole
          stream.point(lambda0, phi0 = (phi0 + phi1) / 2 > 0 ? halfPi$1 : -halfPi$1);
          stream.point(sign0, phi0);
          stream.lineEnd();
          stream.lineStart();
          stream.point(sign1, phi0);
          stream.point(lambda1, phi0);
          _clean = 0;
        } else if (sign0 !== sign1 && delta >= pi$4) {
          // line crosses antimeridian
          if (abs$1(lambda0 - sign0) < epsilon$2) lambda0 -= sign0 * epsilon$2; // handle degeneracies

          if (abs$1(lambda1 - sign1) < epsilon$2) lambda1 -= sign1 * epsilon$2;
          phi0 = clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1);
          stream.point(sign0, phi0);
          stream.lineEnd();
          stream.lineStart();
          stream.point(sign1, phi0);
          _clean = 0;
        }

        stream.point(lambda0 = lambda1, phi0 = phi1);
        sign0 = sign1;
      },
      lineEnd: function lineEnd() {
        stream.lineEnd();
        lambda0 = phi0 = NaN;
      },
      clean: function clean() {
        return 2 - _clean; // if intersections, rejoin first and last segments
      }
    };
  }

  function clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1) {
    var cosPhi0,
        cosPhi1,
        sinLambda0Lambda1 = sin$1(lambda0 - lambda1);
    return abs$1(sinLambda0Lambda1) > epsilon$2 ? atan((sin$1(phi0) * (cosPhi1 = cos$1(phi1)) * sin$1(lambda1) - sin$1(phi1) * (cosPhi0 = cos$1(phi0)) * sin$1(lambda0)) / (cosPhi0 * cosPhi1 * sinLambda0Lambda1)) : (phi0 + phi1) / 2;
  }

  function clipAntimeridianInterpolate(from, to, direction, stream) {
    var phi;

    if (from == null) {
      phi = direction * halfPi$1;
      stream.point(-pi$4, phi);
      stream.point(0, phi);
      stream.point(pi$4, phi);
      stream.point(pi$4, 0);
      stream.point(pi$4, -phi);
      stream.point(0, -phi);
      stream.point(-pi$4, -phi);
      stream.point(-pi$4, 0);
      stream.point(-pi$4, phi);
    } else if (abs$1(from[0] - to[0]) > epsilon$2) {
      var lambda = from[0] < to[0] ? pi$4 : -pi$4;
      phi = direction * lambda / 2;
      stream.point(-lambda, phi);
      stream.point(0, phi);
      stream.point(lambda, phi);
    } else {
      stream.point(to[0], to[1]);
    }
  }

  function clipCircle (radius) {
    var cr = cos$1(radius),
        delta = 6 * radians,
        smallRadius = cr > 0,
        notHemisphere = abs$1(cr) > epsilon$2; // TODO optimise for this common case

    function interpolate(from, to, direction, stream) {
      circleStream(stream, radius, delta, direction, from, to);
    }

    function visible(lambda, phi) {
      return cos$1(lambda) * cos$1(phi) > cr;
    } // Takes a line and cuts into visible segments. Return values used for polygon
    // clipping: 0 - there were intersections or the line was empty; 1 - no
    // intersections 2 - there were intersections, and the first and last segments
    // should be rejoined.


    function clipLine(stream) {
      var point0, // previous point
      c0, // code for previous point
      v0, // visibility of previous point
      v00, // visibility of first point
      _clean; // no intersections


      return {
        lineStart: function lineStart() {
          v00 = v0 = false;
          _clean = 1;
        },
        point: function point(lambda, phi) {
          var point1 = [lambda, phi],
              point2,
              v = visible(lambda, phi),
              c = smallRadius ? v ? 0 : code(lambda, phi) : v ? code(lambda + (lambda < 0 ? pi$4 : -pi$4), phi) : 0;
          if (!point0 && (v00 = v0 = v)) stream.lineStart(); // Handle degeneracies.
          // TODO ignore if not clipping polygons.

          if (v !== v0) {
            point2 = intersect(point0, point1);

            if (!point2 || pointEqual(point0, point2) || pointEqual(point1, point2)) {
              point1[0] += epsilon$2;
              point1[1] += epsilon$2;
              v = visible(point1[0], point1[1]);
            }
          }

          if (v !== v0) {
            _clean = 0;

            if (v) {
              // outside going in
              stream.lineStart();
              point2 = intersect(point1, point0);
              stream.point(point2[0], point2[1]);
            } else {
              // inside going out
              point2 = intersect(point0, point1);
              stream.point(point2[0], point2[1]);
              stream.lineEnd();
            }

            point0 = point2;
          } else if (notHemisphere && point0 && smallRadius ^ v) {
            var t; // If the codes for two points are different, or are both zero,
            // and there this segment intersects with the small circle.

            if (!(c & c0) && (t = intersect(point1, point0, true))) {
              _clean = 0;

              if (smallRadius) {
                stream.lineStart();
                stream.point(t[0][0], t[0][1]);
                stream.point(t[1][0], t[1][1]);
                stream.lineEnd();
              } else {
                stream.point(t[1][0], t[1][1]);
                stream.lineEnd();
                stream.lineStart();
                stream.point(t[0][0], t[0][1]);
              }
            }
          }

          if (v && (!point0 || !pointEqual(point0, point1))) {
            stream.point(point1[0], point1[1]);
          }

          point0 = point1, v0 = v, c0 = c;
        },
        lineEnd: function lineEnd() {
          if (v0) stream.lineEnd();
          point0 = null;
        },
        // Rejoin first and last segments if there were intersections and the first
        // and last points were visible.
        clean: function clean() {
          return _clean | (v00 && v0) << 1;
        }
      };
    } // Intersects the great circle between a and b with the clip circle.


    function intersect(a, b, two) {
      var pa = cartesian(a),
          pb = cartesian(b); // We have two planes, n1.p = d1 and n2.p = d2.
      // Find intersection line p(t) = c1 n1 + c2 n2 + t (n1  n2).

      var n1 = [1, 0, 0],
          // normal
      n2 = cartesianCross(pa, pb),
          n2n2 = cartesianDot(n2, n2),
          n1n2 = n2[0],
          // cartesianDot(n1, n2),
      determinant = n2n2 - n1n2 * n1n2; // Two polar points.

      if (!determinant) return !two && a;
      var c1 = cr * n2n2 / determinant,
          c2 = -cr * n1n2 / determinant,
          n1xn2 = cartesianCross(n1, n2),
          A = cartesianScale(n1, c1),
          B = cartesianScale(n2, c2);
      cartesianAddInPlace(A, B); // Solve |p(t)|^2 = 1.

      var u = n1xn2,
          w = cartesianDot(A, u),
          uu = cartesianDot(u, u),
          t2 = w * w - uu * (cartesianDot(A, A) - 1);
      if (t2 < 0) return;
      var t = sqrt$2(t2),
          q = cartesianScale(u, (-w - t) / uu);
      cartesianAddInPlace(q, A);
      q = spherical(q);
      if (!two) return q; // Two intersection points.

      var lambda0 = a[0],
          lambda1 = b[0],
          phi0 = a[1],
          phi1 = b[1],
          z;
      if (lambda1 < lambda0) z = lambda0, lambda0 = lambda1, lambda1 = z;
      var delta = lambda1 - lambda0,
          polar = abs$1(delta - pi$4) < epsilon$2,
          meridian = polar || delta < epsilon$2;
      if (!polar && phi1 < phi0) z = phi0, phi0 = phi1, phi1 = z; // Check that the first point is between a and b.

      if (meridian ? polar ? phi0 + phi1 > 0 ^ q[1] < (abs$1(q[0] - lambda0) < epsilon$2 ? phi0 : phi1) : phi0 <= q[1] && q[1] <= phi1 : delta > pi$4 ^ (lambda0 <= q[0] && q[0] <= lambda1)) {
        var q1 = cartesianScale(u, (-w + t) / uu);
        cartesianAddInPlace(q1, A);
        return [q, spherical(q1)];
      }
    } // Generates a 4-bit vector representing the location of a point relative to
    // the small circle's bounding box.


    function code(lambda, phi) {
      var r = smallRadius ? radius : pi$4 - radius,
          code = 0;
      if (lambda < -r) code |= 1; // left
      else if (lambda > r) code |= 2; // right

      if (phi < -r) code |= 4; // below
      else if (phi > r) code |= 8; // above

      return code;
    }

    return clip(visible, clipLine, interpolate, smallRadius ? [0, -radius] : [-pi$4, radius - pi$4]);
  }

  function clipLine (a, b, x0, y0, x1, y1) {
    var ax = a[0],
        ay = a[1],
        bx = b[0],
        by = b[1],
        t0 = 0,
        t1 = 1,
        dx = bx - ax,
        dy = by - ay,
        r;
    r = x0 - ax;
    if (!dx && r > 0) return;
    r /= dx;

    if (dx < 0) {
      if (r < t0) return;
      if (r < t1) t1 = r;
    } else if (dx > 0) {
      if (r > t1) return;
      if (r > t0) t0 = r;
    }

    r = x1 - ax;
    if (!dx && r < 0) return;
    r /= dx;

    if (dx < 0) {
      if (r > t1) return;
      if (r > t0) t0 = r;
    } else if (dx > 0) {
      if (r < t0) return;
      if (r < t1) t1 = r;
    }

    r = y0 - ay;
    if (!dy && r > 0) return;
    r /= dy;

    if (dy < 0) {
      if (r < t0) return;
      if (r < t1) t1 = r;
    } else if (dy > 0) {
      if (r > t1) return;
      if (r > t0) t0 = r;
    }

    r = y1 - ay;
    if (!dy && r < 0) return;
    r /= dy;

    if (dy < 0) {
      if (r > t1) return;
      if (r > t0) t0 = r;
    } else if (dy > 0) {
      if (r < t0) return;
      if (r < t1) t1 = r;
    }

    if (t0 > 0) a[0] = ax + t0 * dx, a[1] = ay + t0 * dy;
    if (t1 < 1) b[0] = ax + t1 * dx, b[1] = ay + t1 * dy;
    return true;
  }

  var clipMax = 1e9,
      clipMin = -clipMax; // TODO Use d3-polygons polygonContains here for the ring check?
  // TODO Eliminate duplicate buffering in clipBuffer and polygon.push?

  function clipRectangle(x0, y0, x1, y1) {
    function visible(x, y) {
      return x0 <= x && x <= x1 && y0 <= y && y <= y1;
    }

    function interpolate(from, to, direction, stream) {
      var a = 0,
          a1 = 0;

      if (from == null || (a = corner(from, direction)) !== (a1 = corner(to, direction)) || comparePoint(from, to) < 0 ^ direction > 0) {
        do {
          stream.point(a === 0 || a === 3 ? x0 : x1, a > 1 ? y1 : y0);
        } while ((a = (a + direction + 4) % 4) !== a1);
      } else {
        stream.point(to[0], to[1]);
      }
    }

    function corner(p, direction) {
      return abs$1(p[0] - x0) < epsilon$2 ? direction > 0 ? 0 : 3 : abs$1(p[0] - x1) < epsilon$2 ? direction > 0 ? 2 : 1 : abs$1(p[1] - y0) < epsilon$2 ? direction > 0 ? 1 : 0 : direction > 0 ? 3 : 2; // abs(p[1] - y1) < epsilon
    }

    function compareIntersection(a, b) {
      return comparePoint(a.x, b.x);
    }

    function comparePoint(a, b) {
      var ca = corner(a, 1),
          cb = corner(b, 1);
      return ca !== cb ? ca - cb : ca === 0 ? b[1] - a[1] : ca === 1 ? a[0] - b[0] : ca === 2 ? a[1] - b[1] : b[0] - a[0];
    }

    return function (stream) {
      var activeStream = stream,
          bufferStream = clipBuffer(),
          segments,
          polygon,
          ring,
          x__,
          y__,
          v__,
          // first point
      x_,
          y_,
          v_,
          // previous point
      first,
          clean;
      var clipStream = {
        point: point,
        lineStart: lineStart,
        lineEnd: lineEnd,
        polygonStart: polygonStart,
        polygonEnd: polygonEnd
      };

      function point(x, y) {
        if (visible(x, y)) activeStream.point(x, y);
      }

      function polygonInside() {
        var winding = 0;

        for (var i = 0, n = polygon.length; i < n; ++i) {
          for (var ring = polygon[i], j = 1, m = ring.length, point = ring[0], a0, a1, b0 = point[0], b1 = point[1]; j < m; ++j) {
            a0 = b0, a1 = b1, point = ring[j], b0 = point[0], b1 = point[1];

            if (a1 <= y1) {
              if (b1 > y1 && (b0 - a0) * (y1 - a1) > (b1 - a1) * (x0 - a0)) ++winding;
            } else {
              if (b1 <= y1 && (b0 - a0) * (y1 - a1) < (b1 - a1) * (x0 - a0)) --winding;
            }
          }
        }

        return winding;
      } // Buffer geometry within a polygon and then clip it en masse.


      function polygonStart() {
        activeStream = bufferStream, segments = [], polygon = [], clean = true;
      }

      function polygonEnd() {
        var startInside = polygonInside(),
            cleanInside = clean && startInside,
            visible = (segments = merge(segments)).length;

        if (cleanInside || visible) {
          stream.polygonStart();

          if (cleanInside) {
            stream.lineStart();
            interpolate(null, null, 1, stream);
            stream.lineEnd();
          }

          if (visible) {
            clipRejoin(segments, compareIntersection, startInside, interpolate, stream);
          }

          stream.polygonEnd();
        }

        activeStream = stream, segments = polygon = ring = null;
      }

      function lineStart() {
        clipStream.point = linePoint;
        if (polygon) polygon.push(ring = []);
        first = true;
        v_ = false;
        x_ = y_ = NaN;
      } // TODO rather than special-case polygons, simply handle them separately.
      // Ideally, coincident intersection points should be jittered to avoid
      // clipping issues.


      function lineEnd() {
        if (segments) {
          linePoint(x__, y__);
          if (v__ && v_) bufferStream.rejoin();
          segments.push(bufferStream.result());
        }

        clipStream.point = point;
        if (v_) activeStream.lineEnd();
      }

      function linePoint(x, y) {
        var v = visible(x, y);
        if (polygon) ring.push([x, y]);

        if (first) {
          x__ = x, y__ = y, v__ = v;
          first = false;

          if (v) {
            activeStream.lineStart();
            activeStream.point(x, y);
          }
        } else {
          if (v && v_) activeStream.point(x, y);else {
            var a = [x_ = Math.max(clipMin, Math.min(clipMax, x_)), y_ = Math.max(clipMin, Math.min(clipMax, y_))],
                b = [x = Math.max(clipMin, Math.min(clipMax, x)), y = Math.max(clipMin, Math.min(clipMax, y))];

            if (clipLine(a, b, x0, y0, x1, y1)) {
              if (!v_) {
                activeStream.lineStart();
                activeStream.point(a[0], a[1]);
              }

              activeStream.point(b[0], b[1]);
              if (!v) activeStream.lineEnd();
              clean = false;
            } else if (v) {
              activeStream.lineStart();
              activeStream.point(x, y);
              clean = false;
            }
          }
        }

        x_ = x, y_ = y, v_ = v;
      }

      return clipStream;
    };
  }

  function extent$1 () {
    var x0 = 0,
        y0 = 0,
        x1 = 960,
        y1 = 500,
        cache,
        cacheStream,
        clip;
    return clip = {
      stream: function stream(_stream) {
        return cache && cacheStream === _stream ? cache : cache = clipRectangle(x0, y0, x1, y1)(cacheStream = _stream);
      },
      extent: function extent(_) {
        return arguments.length ? (x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1], cache = cacheStream = null, clip) : [[x0, y0], [x1, y1]];
      }
    };
  }

  var lengthSum = adder(),
      lambda0$2,
      sinPhi0$1,
      cosPhi0$1;
  var lengthStream = {
    sphere: noop$2,
    point: noop$2,
    lineStart: lengthLineStart,
    lineEnd: noop$2,
    polygonStart: noop$2,
    polygonEnd: noop$2
  };

  function lengthLineStart() {
    lengthStream.point = lengthPointFirst;
    lengthStream.lineEnd = lengthLineEnd;
  }

  function lengthLineEnd() {
    lengthStream.point = lengthStream.lineEnd = noop$2;
  }

  function lengthPointFirst(lambda, phi) {
    lambda *= radians, phi *= radians;
    lambda0$2 = lambda, sinPhi0$1 = sin$1(phi), cosPhi0$1 = cos$1(phi);
    lengthStream.point = lengthPoint;
  }

  function lengthPoint(lambda, phi) {
    lambda *= radians, phi *= radians;
    var sinPhi = sin$1(phi),
        cosPhi = cos$1(phi),
        delta = abs$1(lambda - lambda0$2),
        cosDelta = cos$1(delta),
        sinDelta = sin$1(delta),
        x = cosPhi * sinDelta,
        y = cosPhi0$1 * sinPhi - sinPhi0$1 * cosPhi * cosDelta,
        z = sinPhi0$1 * sinPhi + cosPhi0$1 * cosPhi * cosDelta;
    lengthSum.add(atan2$1(sqrt$2(x * x + y * y), z));
    lambda0$2 = lambda, sinPhi0$1 = sinPhi, cosPhi0$1 = cosPhi;
  }

  function length (object) {
    lengthSum.reset();
    geoStream(object, lengthStream);
    return +lengthSum;
  }

  var coordinates = [null, null],
      object$1 = {
    type: "LineString",
    coordinates: coordinates
  };
  function distance (a, b) {
    coordinates[0] = a;
    coordinates[1] = b;
    return length(object$1);
  }

  var containsObjectType = {
    Feature: function Feature(object, point) {
      return containsGeometry(object.geometry, point);
    },
    FeatureCollection: function FeatureCollection(object, point) {
      var features = object.features,
          i = -1,
          n = features.length;

      while (++i < n) {
        if (containsGeometry(features[i].geometry, point)) return true;
      }

      return false;
    }
  };
  var containsGeometryType = {
    Sphere: function Sphere() {
      return true;
    },
    Point: function Point(object, point) {
      return containsPoint(object.coordinates, point);
    },
    MultiPoint: function MultiPoint(object, point) {
      var coordinates = object.coordinates,
          i = -1,
          n = coordinates.length;

      while (++i < n) {
        if (containsPoint(coordinates[i], point)) return true;
      }

      return false;
    },
    LineString: function LineString(object, point) {
      return containsLine(object.coordinates, point);
    },
    MultiLineString: function MultiLineString(object, point) {
      var coordinates = object.coordinates,
          i = -1,
          n = coordinates.length;

      while (++i < n) {
        if (containsLine(coordinates[i], point)) return true;
      }

      return false;
    },
    Polygon: function Polygon(object, point) {
      return containsPolygon(object.coordinates, point);
    },
    MultiPolygon: function MultiPolygon(object, point) {
      var coordinates = object.coordinates,
          i = -1,
          n = coordinates.length;

      while (++i < n) {
        if (containsPolygon(coordinates[i], point)) return true;
      }

      return false;
    },
    GeometryCollection: function GeometryCollection(object, point) {
      var geometries = object.geometries,
          i = -1,
          n = geometries.length;

      while (++i < n) {
        if (containsGeometry(geometries[i], point)) return true;
      }

      return false;
    }
  };

  function containsGeometry(geometry, point) {
    return geometry && containsGeometryType.hasOwnProperty(geometry.type) ? containsGeometryType[geometry.type](geometry, point) : false;
  }

  function containsPoint(coordinates, point) {
    return distance(coordinates, point) === 0;
  }

  function containsLine(coordinates, point) {
    var ao, bo, ab;

    for (var i = 0, n = coordinates.length; i < n; i++) {
      bo = distance(coordinates[i], point);
      if (bo === 0) return true;

      if (i > 0) {
        ab = distance(coordinates[i], coordinates[i - 1]);
        if (ab > 0 && ao <= ab && bo <= ab && (ao + bo - ab) * (1 - Math.pow((ao - bo) / ab, 2)) < epsilon2$1 * ab) return true;
      }

      ao = bo;
    }

    return false;
  }

  function containsPolygon(coordinates, point) {
    return !!polygonContains$1(coordinates.map(ringRadians), pointRadians(point));
  }

  function ringRadians(ring) {
    return ring = ring.map(pointRadians), ring.pop(), ring;
  }

  function pointRadians(point) {
    return [point[0] * radians, point[1] * radians];
  }

  function contains (object, point) {
    return (object && containsObjectType.hasOwnProperty(object.type) ? containsObjectType[object.type] : containsGeometry)(object, point);
  }

  function graticuleX(y0, y1, dy) {
    var y = range(y0, y1 - epsilon$2, dy).concat(y1);
    return function (x) {
      return y.map(function (y) {
        return [x, y];
      });
    };
  }

  function graticuleY(x0, x1, dx) {
    var x = range(x0, x1 - epsilon$2, dx).concat(x1);
    return function (y) {
      return x.map(function (x) {
        return [x, y];
      });
    };
  }

  function graticule() {
    var x1,
        x0,
        X1,
        X0,
        y1,
        y0,
        Y1,
        Y0,
        dx = 10,
        dy = dx,
        DX = 90,
        DY = 360,
        x,
        y,
        X,
        Y,
        precision = 2.5;

    function graticule() {
      return {
        type: "MultiLineString",
        coordinates: lines()
      };
    }

    function lines() {
      return range(ceil(X0 / DX) * DX, X1, DX).map(X).concat(range(ceil(Y0 / DY) * DY, Y1, DY).map(Y)).concat(range(ceil(x0 / dx) * dx, x1, dx).filter(function (x) {
        return abs$1(x % DX) > epsilon$2;
      }).map(x)).concat(range(ceil(y0 / dy) * dy, y1, dy).filter(function (y) {
        return abs$1(y % DY) > epsilon$2;
      }).map(y));
    }

    graticule.lines = function () {
      return lines().map(function (coordinates) {
        return {
          type: "LineString",
          coordinates: coordinates
        };
      });
    };

    graticule.outline = function () {
      return {
        type: "Polygon",
        coordinates: [X(X0).concat(Y(Y1).slice(1), X(X1).reverse().slice(1), Y(Y0).reverse().slice(1))]
      };
    };

    graticule.extent = function (_) {
      if (!arguments.length) return graticule.extentMinor();
      return graticule.extentMajor(_).extentMinor(_);
    };

    graticule.extentMajor = function (_) {
      if (!arguments.length) return [[X0, Y0], [X1, Y1]];
      X0 = +_[0][0], X1 = +_[1][0];
      Y0 = +_[0][1], Y1 = +_[1][1];
      if (X0 > X1) _ = X0, X0 = X1, X1 = _;
      if (Y0 > Y1) _ = Y0, Y0 = Y1, Y1 = _;
      return graticule.precision(precision);
    };

    graticule.extentMinor = function (_) {
      if (!arguments.length) return [[x0, y0], [x1, y1]];
      x0 = +_[0][0], x1 = +_[1][0];
      y0 = +_[0][1], y1 = +_[1][1];
      if (x0 > x1) _ = x0, x0 = x1, x1 = _;
      if (y0 > y1) _ = y0, y0 = y1, y1 = _;
      return graticule.precision(precision);
    };

    graticule.step = function (_) {
      if (!arguments.length) return graticule.stepMinor();
      return graticule.stepMajor(_).stepMinor(_);
    };

    graticule.stepMajor = function (_) {
      if (!arguments.length) return [DX, DY];
      DX = +_[0], DY = +_[1];
      return graticule;
    };

    graticule.stepMinor = function (_) {
      if (!arguments.length) return [dx, dy];
      dx = +_[0], dy = +_[1];
      return graticule;
    };

    graticule.precision = function (_) {
      if (!arguments.length) return precision;
      precision = +_;
      x = graticuleX(y0, y1, 90);
      y = graticuleY(x0, x1, precision);
      X = graticuleX(Y0, Y1, 90);
      Y = graticuleY(X0, X1, precision);
      return graticule;
    };

    return graticule.extentMajor([[-180, -90 + epsilon$2], [180, 90 - epsilon$2]]).extentMinor([[-180, -80 - epsilon$2], [180, 80 + epsilon$2]]);
  }
  function graticule10() {
    return graticule()();
  }

  function interpolate$2 (a, b) {
    var x0 = a[0] * radians,
        y0 = a[1] * radians,
        x1 = b[0] * radians,
        y1 = b[1] * radians,
        cy0 = cos$1(y0),
        sy0 = sin$1(y0),
        cy1 = cos$1(y1),
        sy1 = sin$1(y1),
        kx0 = cy0 * cos$1(x0),
        ky0 = cy0 * sin$1(x0),
        kx1 = cy1 * cos$1(x1),
        ky1 = cy1 * sin$1(x1),
        d = 2 * asin$1(sqrt$2(haversin(y1 - y0) + cy0 * cy1 * haversin(x1 - x0))),
        k = sin$1(d);
    var interpolate = d ? function (t) {
      var B = sin$1(t *= d) / k,
          A = sin$1(d - t) / k,
          x = A * kx0 + B * kx1,
          y = A * ky0 + B * ky1,
          z = A * sy0 + B * sy1;
      return [atan2$1(y, x) * degrees$1, atan2$1(z, sqrt$2(x * x + y * y)) * degrees$1];
    } : function () {
      return [x0 * degrees$1, y0 * degrees$1];
    };
    interpolate.distance = d;
    return interpolate;
  }

  function identity$5 (x) {
    return x;
  }

  var areaSum$1 = adder(),
      areaRingSum$1 = adder(),
      x00,
      y00,
      x0$1,
      y0$1;
  var areaStream$1 = {
    point: noop$2,
    lineStart: noop$2,
    lineEnd: noop$2,
    polygonStart: function polygonStart() {
      areaStream$1.lineStart = areaRingStart$1;
      areaStream$1.lineEnd = areaRingEnd$1;
    },
    polygonEnd: function polygonEnd() {
      areaStream$1.lineStart = areaStream$1.lineEnd = areaStream$1.point = noop$2;
      areaSum$1.add(abs$1(areaRingSum$1));
      areaRingSum$1.reset();
    },
    result: function result() {
      var area = areaSum$1 / 2;
      areaSum$1.reset();
      return area;
    }
  };

  function areaRingStart$1() {
    areaStream$1.point = areaPointFirst$1;
  }

  function areaPointFirst$1(x, y) {
    areaStream$1.point = areaPoint$1;
    x00 = x0$1 = x, y00 = y0$1 = y;
  }

  function areaPoint$1(x, y) {
    areaRingSum$1.add(y0$1 * x - x0$1 * y);
    x0$1 = x, y0$1 = y;
  }

  function areaRingEnd$1() {
    areaPoint$1(x00, y00);
  }

  var x0$2 = Infinity,
      y0$2 = x0$2,
      x1 = -x0$2,
      y1 = x1;
  var boundsStream$1 = {
    point: boundsPoint$1,
    lineStart: noop$2,
    lineEnd: noop$2,
    polygonStart: noop$2,
    polygonEnd: noop$2,
    result: function result() {
      var bounds = [[x0$2, y0$2], [x1, y1]];
      x1 = y1 = -(y0$2 = x0$2 = Infinity);
      return bounds;
    }
  };

  function boundsPoint$1(x, y) {
    if (x < x0$2) x0$2 = x;
    if (x > x1) x1 = x;
    if (y < y0$2) y0$2 = y;
    if (y > y1) y1 = y;
  }

  var X0$1 = 0,
      Y0$1 = 0,
      Z0$1 = 0,
      X1$1 = 0,
      Y1$1 = 0,
      Z1$1 = 0,
      X2$1 = 0,
      Y2$1 = 0,
      Z2$1 = 0,
      x00$1,
      y00$1,
      x0$3,
      y0$3;
  var centroidStream$1 = {
    point: centroidPoint$1,
    lineStart: centroidLineStart$1,
    lineEnd: centroidLineEnd$1,
    polygonStart: function polygonStart() {
      centroidStream$1.lineStart = centroidRingStart$1;
      centroidStream$1.lineEnd = centroidRingEnd$1;
    },
    polygonEnd: function polygonEnd() {
      centroidStream$1.point = centroidPoint$1;
      centroidStream$1.lineStart = centroidLineStart$1;
      centroidStream$1.lineEnd = centroidLineEnd$1;
    },
    result: function result() {
      var centroid = Z2$1 ? [X2$1 / Z2$1, Y2$1 / Z2$1] : Z1$1 ? [X1$1 / Z1$1, Y1$1 / Z1$1] : Z0$1 ? [X0$1 / Z0$1, Y0$1 / Z0$1] : [NaN, NaN];
      X0$1 = Y0$1 = Z0$1 = X1$1 = Y1$1 = Z1$1 = X2$1 = Y2$1 = Z2$1 = 0;
      return centroid;
    }
  };

  function centroidPoint$1(x, y) {
    X0$1 += x;
    Y0$1 += y;
    ++Z0$1;
  }

  function centroidLineStart$1() {
    centroidStream$1.point = centroidPointFirstLine;
  }

  function centroidPointFirstLine(x, y) {
    centroidStream$1.point = centroidPointLine;
    centroidPoint$1(x0$3 = x, y0$3 = y);
  }

  function centroidPointLine(x, y) {
    var dx = x - x0$3,
        dy = y - y0$3,
        z = sqrt$2(dx * dx + dy * dy);
    X1$1 += z * (x0$3 + x) / 2;
    Y1$1 += z * (y0$3 + y) / 2;
    Z1$1 += z;
    centroidPoint$1(x0$3 = x, y0$3 = y);
  }

  function centroidLineEnd$1() {
    centroidStream$1.point = centroidPoint$1;
  }

  function centroidRingStart$1() {
    centroidStream$1.point = centroidPointFirstRing;
  }

  function centroidRingEnd$1() {
    centroidPointRing(x00$1, y00$1);
  }

  function centroidPointFirstRing(x, y) {
    centroidStream$1.point = centroidPointRing;
    centroidPoint$1(x00$1 = x0$3 = x, y00$1 = y0$3 = y);
  }

  function centroidPointRing(x, y) {
    var dx = x - x0$3,
        dy = y - y0$3,
        z = sqrt$2(dx * dx + dy * dy);
    X1$1 += z * (x0$3 + x) / 2;
    Y1$1 += z * (y0$3 + y) / 2;
    Z1$1 += z;
    z = y0$3 * x - x0$3 * y;
    X2$1 += z * (x0$3 + x);
    Y2$1 += z * (y0$3 + y);
    Z2$1 += z * 3;
    centroidPoint$1(x0$3 = x, y0$3 = y);
  }

  function PathContext(context) {
    this._context = context;
  }
  PathContext.prototype = {
    _radius: 4.5,
    pointRadius: function pointRadius(_) {
      return this._radius = _, this;
    },
    polygonStart: function polygonStart() {
      this._line = 0;
    },
    polygonEnd: function polygonEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      if (this._line === 0) this._context.closePath();
      this._point = NaN;
    },
    point: function point(x, y) {
      switch (this._point) {
        case 0:
          {
            this._context.moveTo(x, y);

            this._point = 1;
            break;
          }

        case 1:
          {
            this._context.lineTo(x, y);

            break;
          }

        default:
          {
            this._context.moveTo(x + this._radius, y);

            this._context.arc(x, y, this._radius, 0, tau$2);

            break;
          }
      }
    },
    result: noop$2
  };

  var lengthSum$1 = adder(),
      lengthRing,
      x00$2,
      y00$2,
      x0$4,
      y0$4;
  var lengthStream$1 = {
    point: noop$2,
    lineStart: function lineStart() {
      lengthStream$1.point = lengthPointFirst$1;
    },
    lineEnd: function lineEnd() {
      if (lengthRing) lengthPoint$1(x00$2, y00$2);
      lengthStream$1.point = noop$2;
    },
    polygonStart: function polygonStart() {
      lengthRing = true;
    },
    polygonEnd: function polygonEnd() {
      lengthRing = null;
    },
    result: function result() {
      var length = +lengthSum$1;
      lengthSum$1.reset();
      return length;
    }
  };

  function lengthPointFirst$1(x, y) {
    lengthStream$1.point = lengthPoint$1;
    x00$2 = x0$4 = x, y00$2 = y0$4 = y;
  }

  function lengthPoint$1(x, y) {
    x0$4 -= x, y0$4 -= y;
    lengthSum$1.add(sqrt$2(x0$4 * x0$4 + y0$4 * y0$4));
    x0$4 = x, y0$4 = y;
  }

  function PathString() {
    this._string = [];
  }
  PathString.prototype = {
    _radius: 4.5,
    _circle: circle$2(4.5),
    pointRadius: function pointRadius(_) {
      if ((_ = +_) !== this._radius) this._radius = _, this._circle = null;
      return this;
    },
    polygonStart: function polygonStart() {
      this._line = 0;
    },
    polygonEnd: function polygonEnd() {
      this._line = NaN;
    },
    lineStart: function lineStart() {
      this._point = 0;
    },
    lineEnd: function lineEnd() {
      if (this._line === 0) this._string.push("Z");
      this._point = NaN;
    },
    point: function point(x, y) {
      switch (this._point) {
        case 0:
          {
            this._string.push("M", x, ",", y);

            this._point = 1;
            break;
          }

        case 1:
          {
            this._string.push("L", x, ",", y);

            break;
          }

        default:
          {
            if (this._circle == null) this._circle = circle$2(this._radius);

            this._string.push("M", x, ",", y, this._circle);

            break;
          }
      }
    },
    result: function result() {
      if (this._string.length) {
        var result = this._string.join("");

        this._string = [];
        return result;
      } else {
        return null;
      }
    }
  };

  function circle$2(radius) {
    return "m0," + radius + "a" + radius + "," + radius + " 0 1,1 0," + -2 * radius + "a" + radius + "," + radius + " 0 1,1 0," + 2 * radius + "z";
  }

  function index (projection, context) {
    var pointRadius = 4.5,
        projectionStream,
        contextStream;

    function path(object) {
      if (object) {
        if (typeof pointRadius === "function") contextStream.pointRadius(+pointRadius.apply(this, arguments));
        geoStream(object, projectionStream(contextStream));
      }

      return contextStream.result();
    }

    path.area = function (object) {
      geoStream(object, projectionStream(areaStream$1));
      return areaStream$1.result();
    };

    path.measure = function (object) {
      geoStream(object, projectionStream(lengthStream$1));
      return lengthStream$1.result();
    };

    path.bounds = function (object) {
      geoStream(object, projectionStream(boundsStream$1));
      return boundsStream$1.result();
    };

    path.centroid = function (object) {
      geoStream(object, projectionStream(centroidStream$1));
      return centroidStream$1.result();
    };

    path.projection = function (_) {
      return arguments.length ? (projectionStream = _ == null ? (projection = null, identity$5) : (projection = _).stream, path) : projection;
    };

    path.context = function (_) {
      if (!arguments.length) return context;
      contextStream = _ == null ? (context = null, new PathString()) : new PathContext(context = _);
      if (typeof pointRadius !== "function") contextStream.pointRadius(pointRadius);
      return path;
    };

    path.pointRadius = function (_) {
      if (!arguments.length) return pointRadius;
      pointRadius = typeof _ === "function" ? _ : (contextStream.pointRadius(+_), +_);
      return path;
    };

    return path.projection(projection).context(context);
  }

  function transform (methods) {
    return {
      stream: transformer$3(methods)
    };
  }
  function transformer$3(methods) {
    return function (stream) {
      var s = new TransformStream();

      for (var key in methods) {
        s[key] = methods[key];
      }

      s.stream = stream;
      return s;
    };
  }

  function TransformStream() {}

  TransformStream.prototype = {
    constructor: TransformStream,
    point: function point(x, y) {
      this.stream.point(x, y);
    },
    sphere: function sphere() {
      this.stream.sphere();
    },
    lineStart: function lineStart() {
      this.stream.lineStart();
    },
    lineEnd: function lineEnd() {
      this.stream.lineEnd();
    },
    polygonStart: function polygonStart() {
      this.stream.polygonStart();
    },
    polygonEnd: function polygonEnd() {
      this.stream.polygonEnd();
    }
  };

  function fit(projection, fitBounds, object) {
    var clip = projection.clipExtent && projection.clipExtent();
    projection.scale(150).translate([0, 0]);
    if (clip != null) projection.clipExtent(null);
    geoStream(object, projection.stream(boundsStream$1));
    fitBounds(boundsStream$1.result());
    if (clip != null) projection.clipExtent(clip);
    return projection;
  }

  function fitExtent(projection, extent, object) {
    return fit(projection, function (b) {
      var w = extent[1][0] - extent[0][0],
          h = extent[1][1] - extent[0][1],
          k = Math.min(w / (b[1][0] - b[0][0]), h / (b[1][1] - b[0][1])),
          x = +extent[0][0] + (w - k * (b[1][0] + b[0][0])) / 2,
          y = +extent[0][1] + (h - k * (b[1][1] + b[0][1])) / 2;
      projection.scale(150 * k).translate([x, y]);
    }, object);
  }
  function fitSize(projection, size, object) {
    return fitExtent(projection, [[0, 0], size], object);
  }
  function fitWidth(projection, width, object) {
    return fit(projection, function (b) {
      var w = +width,
          k = w / (b[1][0] - b[0][0]),
          x = (w - k * (b[1][0] + b[0][0])) / 2,
          y = -k * b[0][1];
      projection.scale(150 * k).translate([x, y]);
    }, object);
  }
  function fitHeight(projection, height, object) {
    return fit(projection, function (b) {
      var h = +height,
          k = h / (b[1][1] - b[0][1]),
          x = -k * b[0][0],
          y = (h - k * (b[1][1] + b[0][1])) / 2;
      projection.scale(150 * k).translate([x, y]);
    }, object);
  }

  var maxDepth = 16,
      // maximum depth of subdivision
  cosMinDistance = cos$1(30 * radians); // cos(minimum angular distance)

  function resample (project, delta2) {
    return +delta2 ? resample$1(project, delta2) : resampleNone(project);
  }

  function resampleNone(project) {
    return transformer$3({
      point: function point(x, y) {
        x = project(x, y);
        this.stream.point(x[0], x[1]);
      }
    });
  }

  function resample$1(project, delta2) {
    function resampleLineTo(x0, y0, lambda0, a0, b0, c0, x1, y1, lambda1, a1, b1, c1, depth, stream) {
      var dx = x1 - x0,
          dy = y1 - y0,
          d2 = dx * dx + dy * dy;

      if (d2 > 4 * delta2 && depth--) {
        var a = a0 + a1,
            b = b0 + b1,
            c = c0 + c1,
            m = sqrt$2(a * a + b * b + c * c),
            phi2 = asin$1(c /= m),
            lambda2 = abs$1(abs$1(c) - 1) < epsilon$2 || abs$1(lambda0 - lambda1) < epsilon$2 ? (lambda0 + lambda1) / 2 : atan2$1(b, a),
            p = project(lambda2, phi2),
            x2 = p[0],
            y2 = p[1],
            dx2 = x2 - x0,
            dy2 = y2 - y0,
            dz = dy * dx2 - dx * dy2;

        if (dz * dz / d2 > delta2 // perpendicular projected distance
        || abs$1((dx * dx2 + dy * dy2) / d2 - 0.5) > 0.3 // midpoint close to an end
        || a0 * a1 + b0 * b1 + c0 * c1 < cosMinDistance) {
          // angular distance
          resampleLineTo(x0, y0, lambda0, a0, b0, c0, x2, y2, lambda2, a /= m, b /= m, c, depth, stream);
          stream.point(x2, y2);
          resampleLineTo(x2, y2, lambda2, a, b, c, x1, y1, lambda1, a1, b1, c1, depth, stream);
        }
      }
    }

    return function (stream) {
      var lambda00, x00, y00, a00, b00, c00, // first point
      lambda0, x0, y0, a0, b0, c0; // previous point

      var resampleStream = {
        point: point,
        lineStart: lineStart,
        lineEnd: lineEnd,
        polygonStart: function polygonStart() {
          stream.polygonStart();
          resampleStream.lineStart = ringStart;
        },
        polygonEnd: function polygonEnd() {
          stream.polygonEnd();
          resampleStream.lineStart = lineStart;
        }
      };

      function point(x, y) {
        x = project(x, y);
        stream.point(x[0], x[1]);
      }

      function lineStart() {
        x0 = NaN;
        resampleStream.point = linePoint;
        stream.lineStart();
      }

      function linePoint(lambda, phi) {
        var c = cartesian([lambda, phi]),
            p = project(lambda, phi);
        resampleLineTo(x0, y0, lambda0, a0, b0, c0, x0 = p[0], y0 = p[1], lambda0 = lambda, a0 = c[0], b0 = c[1], c0 = c[2], maxDepth, stream);
        stream.point(x0, y0);
      }

      function lineEnd() {
        resampleStream.point = point;
        stream.lineEnd();
      }

      function ringStart() {
        lineStart();
        resampleStream.point = ringPoint;
        resampleStream.lineEnd = ringEnd;
      }

      function ringPoint(lambda, phi) {
        linePoint(lambda00 = lambda, phi), x00 = x0, y00 = y0, a00 = a0, b00 = b0, c00 = c0;
        resampleStream.point = linePoint;
      }

      function ringEnd() {
        resampleLineTo(x0, y0, lambda0, a0, b0, c0, x00, y00, lambda00, a00, b00, c00, maxDepth, stream);
        resampleStream.lineEnd = lineEnd;
        lineEnd();
      }

      return resampleStream;
    };
  }

  var transformRadians = transformer$3({
    point: function point(x, y) {
      this.stream.point(x * radians, y * radians);
    }
  });

  function transformRotate(rotate) {
    return transformer$3({
      point: function point(x, y) {
        var r = rotate(x, y);
        return this.stream.point(r[0], r[1]);
      }
    });
  }

  function scaleTranslate(k, dx, dy) {
    function transform(x, y) {
      return [dx + k * x, dy - k * y];
    }

    transform.invert = function (x, y) {
      return [(x - dx) / k, (dy - y) / k];
    };

    return transform;
  }

  function scaleTranslateRotate(k, dx, dy, alpha) {
    var cosAlpha = cos$1(alpha),
        sinAlpha = sin$1(alpha),
        a = cosAlpha * k,
        b = sinAlpha * k,
        ai = cosAlpha / k,
        bi = sinAlpha / k,
        ci = (sinAlpha * dy - cosAlpha * dx) / k,
        fi = (sinAlpha * dx + cosAlpha * dy) / k;

    function transform(x, y) {
      return [a * x - b * y + dx, dy - b * x - a * y];
    }

    transform.invert = function (x, y) {
      return [ai * x - bi * y + ci, fi - bi * x - ai * y];
    };

    return transform;
  }

  function projection(project) {
    return projectionMutator(function () {
      return project;
    })();
  }
  function projectionMutator(projectAt) {
    var project,
        k = 150,
        // scale
    x = 480,
        y = 250,
        // translate
    lambda = 0,
        phi = 0,
        // center
    deltaLambda = 0,
        deltaPhi = 0,
        deltaGamma = 0,
        rotate,
        // pre-rotate
    alpha = 0,
        // post-rotate
    theta = null,
        preclip = clipAntimeridian,
        // pre-clip angle
    x0 = null,
        y0,
        x1,
        y1,
        postclip = identity$5,
        // post-clip extent
    delta2 = 0.5,
        // precision
    projectResample,
        projectTransform,
        projectRotateTransform,
        cache,
        cacheStream;

    function projection(point) {
      return projectRotateTransform(point[0] * radians, point[1] * radians);
    }

    function invert(point) {
      point = projectRotateTransform.invert(point[0], point[1]);
      return point && [point[0] * degrees$1, point[1] * degrees$1];
    }

    projection.stream = function (stream) {
      return cache && cacheStream === stream ? cache : cache = transformRadians(transformRotate(rotate)(preclip(projectResample(postclip(cacheStream = stream)))));
    };

    projection.preclip = function (_) {
      return arguments.length ? (preclip = _, theta = undefined, reset()) : preclip;
    };

    projection.postclip = function (_) {
      return arguments.length ? (postclip = _, x0 = y0 = x1 = y1 = null, reset()) : postclip;
    };

    projection.clipAngle = function (_) {
      return arguments.length ? (preclip = +_ ? clipCircle(theta = _ * radians) : (theta = null, clipAntimeridian), reset()) : theta * degrees$1;
    };

    projection.clipExtent = function (_) {
      return arguments.length ? (postclip = _ == null ? (x0 = y0 = x1 = y1 = null, identity$5) : clipRectangle(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reset()) : x0 == null ? null : [[x0, y0], [x1, y1]];
    };

    projection.scale = function (_) {
      return arguments.length ? (k = +_, recenter()) : k;
    };

    projection.translate = function (_) {
      return arguments.length ? (x = +_[0], y = +_[1], recenter()) : [x, y];
    };

    projection.center = function (_) {
      return arguments.length ? (lambda = _[0] % 360 * radians, phi = _[1] % 360 * radians, recenter()) : [lambda * degrees$1, phi * degrees$1];
    };

    projection.rotate = function (_) {
      return arguments.length ? (deltaLambda = _[0] % 360 * radians, deltaPhi = _[1] % 360 * radians, deltaGamma = _.length > 2 ? _[2] % 360 * radians : 0, recenter()) : [deltaLambda * degrees$1, deltaPhi * degrees$1, deltaGamma * degrees$1];
    };

    projection.angle = function (_) {
      return arguments.length ? (alpha = _ % 360 * radians, recenter()) : alpha * degrees$1;
    };

    projection.precision = function (_) {
      return arguments.length ? (projectResample = resample(projectTransform, delta2 = _ * _), reset()) : sqrt$2(delta2);
    };

    projection.fitExtent = function (extent, object) {
      return fitExtent(projection, extent, object);
    };

    projection.fitSize = function (size, object) {
      return fitSize(projection, size, object);
    };

    projection.fitWidth = function (width, object) {
      return fitWidth(projection, width, object);
    };

    projection.fitHeight = function (height, object) {
      return fitHeight(projection, height, object);
    };

    function recenter() {
      var center = scaleTranslateRotate(k, 0, 0, alpha).apply(null, project(lambda, phi)),
          transform = (alpha ? scaleTranslateRotate : scaleTranslate)(k, x - center[0], y - center[1], alpha);
      rotate = rotateRadians(deltaLambda, deltaPhi, deltaGamma);
      projectTransform = compose(project, transform);
      projectRotateTransform = compose(rotate, projectTransform);
      projectResample = resample(projectTransform, delta2);
      return reset();
    }

    function reset() {
      cache = cacheStream = null;
      return projection;
    }

    return function () {
      project = projectAt.apply(this, arguments);
      projection.invert = project.invert && invert;
      return recenter();
    };
  }

  function conicProjection(projectAt) {
    var phi0 = 0,
        phi1 = pi$4 / 3,
        m = projectionMutator(projectAt),
        p = m(phi0, phi1);

    p.parallels = function (_) {
      return arguments.length ? m(phi0 = _[0] * radians, phi1 = _[1] * radians) : [phi0 * degrees$1, phi1 * degrees$1];
    };

    return p;
  }

  function cylindricalEqualAreaRaw(phi0) {
    var cosPhi0 = cos$1(phi0);

    function forward(lambda, phi) {
      return [lambda * cosPhi0, sin$1(phi) / cosPhi0];
    }

    forward.invert = function (x, y) {
      return [x / cosPhi0, asin$1(y * cosPhi0)];
    };

    return forward;
  }

  function conicEqualAreaRaw(y0, y1) {
    var sy0 = sin$1(y0),
        n = (sy0 + sin$1(y1)) / 2; // Are the parallels symmetrical around the Equator?

    if (abs$1(n) < epsilon$2) return cylindricalEqualAreaRaw(y0);
    var c = 1 + sy0 * (2 * n - sy0),
        r0 = sqrt$2(c) / n;

    function project(x, y) {
      var r = sqrt$2(c - 2 * n * sin$1(y)) / n;
      return [r * sin$1(x *= n), r0 - r * cos$1(x)];
    }

    project.invert = function (x, y) {
      var r0y = r0 - y;
      return [atan2$1(x, abs$1(r0y)) / n * sign$1(r0y), asin$1((c - (x * x + r0y * r0y) * n * n) / (2 * n))];
    };

    return project;
  }
  function conicEqualArea () {
    return conicProjection(conicEqualAreaRaw).scale(155.424).center([0, 33.6442]);
  }

  function albers () {
    return conicEqualArea().parallels([29.5, 45.5]).scale(1070).translate([480, 250]).rotate([96, 0]).center([-0.6, 38.7]);
  }

  // as this will avoid emitting interleaving lines and polygons.

  function multiplex(streams) {
    var n = streams.length;
    return {
      point: function point(x, y) {
        var i = -1;

        while (++i < n) {
          streams[i].point(x, y);
        }
      },
      sphere: function sphere() {
        var i = -1;

        while (++i < n) {
          streams[i].sphere();
        }
      },
      lineStart: function lineStart() {
        var i = -1;

        while (++i < n) {
          streams[i].lineStart();
        }
      },
      lineEnd: function lineEnd() {
        var i = -1;

        while (++i < n) {
          streams[i].lineEnd();
        }
      },
      polygonStart: function polygonStart() {
        var i = -1;

        while (++i < n) {
          streams[i].polygonStart();
        }
      },
      polygonEnd: function polygonEnd() {
        var i = -1;

        while (++i < n) {
          streams[i].polygonEnd();
        }
      }
    };
  } // A composite projection for the United States, configured by default for
  // 960500. The projection also works quite well at 960600 if you change the
  // scale to 1285 and adjust the translate accordingly. The set of standard
  // parallels for each region comes from USGS, which is published here:
  // http://egsc.usgs.gov/isb/pubs/MapProjections/projections.html#albers


  function albersUsa () {
    var cache,
        cacheStream,
        lower48 = albers(),
        lower48Point,
        alaska = conicEqualArea().rotate([154, 0]).center([-2, 58.5]).parallels([55, 65]),
        alaskaPoint,
        // EPSG:3338
    hawaii = conicEqualArea().rotate([157, 0]).center([-3, 19.9]).parallels([8, 18]),
        hawaiiPoint,
        // ESRI:102007
    _point,
        pointStream = {
      point: function point(x, y) {
        _point = [x, y];
      }
    };

    function albersUsa(coordinates) {
      var x = coordinates[0],
          y = coordinates[1];
      return _point = null, (lower48Point.point(x, y), _point) || (alaskaPoint.point(x, y), _point) || (hawaiiPoint.point(x, y), _point);
    }

    albersUsa.invert = function (coordinates) {
      var k = lower48.scale(),
          t = lower48.translate(),
          x = (coordinates[0] - t[0]) / k,
          y = (coordinates[1] - t[1]) / k;
      return (y >= 0.120 && y < 0.234 && x >= -0.425 && x < -0.214 ? alaska : y >= 0.166 && y < 0.234 && x >= -0.214 && x < -0.115 ? hawaii : lower48).invert(coordinates);
    };

    albersUsa.stream = function (stream) {
      return cache && cacheStream === stream ? cache : cache = multiplex([lower48.stream(cacheStream = stream), alaska.stream(stream), hawaii.stream(stream)]);
    };

    albersUsa.precision = function (_) {
      if (!arguments.length) return lower48.precision();
      lower48.precision(_), alaska.precision(_), hawaii.precision(_);
      return reset();
    };

    albersUsa.scale = function (_) {
      if (!arguments.length) return lower48.scale();
      lower48.scale(_), alaska.scale(_ * 0.35), hawaii.scale(_);
      return albersUsa.translate(lower48.translate());
    };

    albersUsa.translate = function (_) {
      if (!arguments.length) return lower48.translate();
      var k = lower48.scale(),
          x = +_[0],
          y = +_[1];
      lower48Point = lower48.translate(_).clipExtent([[x - 0.455 * k, y - 0.238 * k], [x + 0.455 * k, y + 0.238 * k]]).stream(pointStream);
      alaskaPoint = alaska.translate([x - 0.307 * k, y + 0.201 * k]).clipExtent([[x - 0.425 * k + epsilon$2, y + 0.120 * k + epsilon$2], [x - 0.214 * k - epsilon$2, y + 0.234 * k - epsilon$2]]).stream(pointStream);
      hawaiiPoint = hawaii.translate([x - 0.205 * k, y + 0.212 * k]).clipExtent([[x - 0.214 * k + epsilon$2, y + 0.166 * k + epsilon$2], [x - 0.115 * k - epsilon$2, y + 0.234 * k - epsilon$2]]).stream(pointStream);
      return reset();
    };

    albersUsa.fitExtent = function (extent, object) {
      return fitExtent(albersUsa, extent, object);
    };

    albersUsa.fitSize = function (size, object) {
      return fitSize(albersUsa, size, object);
    };

    albersUsa.fitWidth = function (width, object) {
      return fitWidth(albersUsa, width, object);
    };

    albersUsa.fitHeight = function (height, object) {
      return fitHeight(albersUsa, height, object);
    };

    function reset() {
      cache = cacheStream = null;
      return albersUsa;
    }

    return albersUsa.scale(1070);
  }

  function azimuthalRaw(scale) {
    return function (x, y) {
      var cx = cos$1(x),
          cy = cos$1(y),
          k = scale(cx * cy);
      return [k * cy * sin$1(x), k * sin$1(y)];
    };
  }
  function azimuthalInvert(angle) {
    return function (x, y) {
      var z = sqrt$2(x * x + y * y),
          c = angle(z),
          sc = sin$1(c),
          cc = cos$1(c);
      return [atan2$1(x * sc, z * cc), asin$1(z && y * sc / z)];
    };
  }

  var azimuthalEqualAreaRaw = azimuthalRaw(function (cxcy) {
    return sqrt$2(2 / (1 + cxcy));
  });
  azimuthalEqualAreaRaw.invert = azimuthalInvert(function (z) {
    return 2 * asin$1(z / 2);
  });
  function azimuthalEqualArea () {
    return projection(azimuthalEqualAreaRaw).scale(124.75).clipAngle(180 - 1e-3);
  }

  var azimuthalEquidistantRaw = azimuthalRaw(function (c) {
    return (c = acos$1(c)) && c / sin$1(c);
  });
  azimuthalEquidistantRaw.invert = azimuthalInvert(function (z) {
    return z;
  });
  function azimuthalEquidistant () {
    return projection(azimuthalEquidistantRaw).scale(79.4188).clipAngle(180 - 1e-3);
  }

  function mercatorRaw(lambda, phi) {
    return [lambda, log$1(tan((halfPi$1 + phi) / 2))];
  }

  mercatorRaw.invert = function (x, y) {
    return [x, 2 * atan(exp(y)) - halfPi$1];
  };

  function mercator () {
    return mercatorProjection(mercatorRaw).scale(961 / tau$2);
  }
  function mercatorProjection(project) {
    var m = projection(project),
        center = m.center,
        scale = m.scale,
        translate = m.translate,
        clipExtent = m.clipExtent,
        x0 = null,
        y0,
        x1,
        y1; // clip extent

    m.scale = function (_) {
      return arguments.length ? (scale(_), reclip()) : scale();
    };

    m.translate = function (_) {
      return arguments.length ? (translate(_), reclip()) : translate();
    };

    m.center = function (_) {
      return arguments.length ? (center(_), reclip()) : center();
    };

    m.clipExtent = function (_) {
      return arguments.length ? (_ == null ? x0 = y0 = x1 = y1 = null : (x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reclip()) : x0 == null ? null : [[x0, y0], [x1, y1]];
    };

    function reclip() {
      var k = pi$4 * scale(),
          t = m(rotation(m.rotate()).invert([0, 0]));
      return clipExtent(x0 == null ? [[t[0] - k, t[1] - k], [t[0] + k, t[1] + k]] : project === mercatorRaw ? [[Math.max(t[0] - k, x0), y0], [Math.min(t[0] + k, x1), y1]] : [[x0, Math.max(t[1] - k, y0)], [x1, Math.min(t[1] + k, y1)]]);
    }

    return reclip();
  }

  function tany(y) {
    return tan((halfPi$1 + y) / 2);
  }

  function conicConformalRaw(y0, y1) {
    var cy0 = cos$1(y0),
        n = y0 === y1 ? sin$1(y0) : log$1(cy0 / cos$1(y1)) / log$1(tany(y1) / tany(y0)),
        f = cy0 * pow$1(tany(y0), n) / n;
    if (!n) return mercatorRaw;

    function project(x, y) {
      if (f > 0) {
        if (y < -halfPi$1 + epsilon$2) y = -halfPi$1 + epsilon$2;
      } else {
        if (y > halfPi$1 - epsilon$2) y = halfPi$1 - epsilon$2;
      }

      var r = f / pow$1(tany(y), n);
      return [r * sin$1(n * x), f - r * cos$1(n * x)];
    }

    project.invert = function (x, y) {
      var fy = f - y,
          r = sign$1(n) * sqrt$2(x * x + fy * fy);
      return [atan2$1(x, abs$1(fy)) / n * sign$1(fy), 2 * atan(pow$1(f / r, 1 / n)) - halfPi$1];
    };

    return project;
  }
  function conicConformal () {
    return conicProjection(conicConformalRaw).scale(109.5).parallels([30, 30]);
  }

  function equirectangularRaw(lambda, phi) {
    return [lambda, phi];
  }
  equirectangularRaw.invert = equirectangularRaw;
  function equirectangular () {
    return projection(equirectangularRaw).scale(152.63);
  }

  function conicEquidistantRaw(y0, y1) {
    var cy0 = cos$1(y0),
        n = y0 === y1 ? sin$1(y0) : (cy0 - cos$1(y1)) / (y1 - y0),
        g = cy0 / n + y0;
    if (abs$1(n) < epsilon$2) return equirectangularRaw;

    function project(x, y) {
      var gy = g - y,
          nx = n * x;
      return [gy * sin$1(nx), g - gy * cos$1(nx)];
    }

    project.invert = function (x, y) {
      var gy = g - y;
      return [atan2$1(x, abs$1(gy)) / n * sign$1(gy), g - sign$1(n) * sqrt$2(x * x + gy * gy)];
    };

    return project;
  }
  function conicEquidistant () {
    return conicProjection(conicEquidistantRaw).scale(131.154).center([0, 13.9389]);
  }

  var A1 = 1.340264,
      A2 = -0.081106,
      A3 = 0.000893,
      A4 = 0.003796,
      M = sqrt$2(3) / 2,
      iterations = 12;
  function equalEarthRaw(lambda, phi) {
    var l = asin$1(M * sin$1(phi)),
        l2 = l * l,
        l6 = l2 * l2 * l2;
    return [lambda * cos$1(l) / (M * (A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2))), l * (A1 + A2 * l2 + l6 * (A3 + A4 * l2))];
  }

  equalEarthRaw.invert = function (x, y) {
    var l = y,
        l2 = l * l,
        l6 = l2 * l2 * l2;

    for (var i = 0, delta, fy, fpy; i < iterations; ++i) {
      fy = l * (A1 + A2 * l2 + l6 * (A3 + A4 * l2)) - y;
      fpy = A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2);
      l -= delta = fy / fpy, l2 = l * l, l6 = l2 * l2 * l2;
      if (abs$1(delta) < epsilon2$1) break;
    }

    return [M * x * (A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2)) / cos$1(l), asin$1(sin$1(l) / M)];
  };

  function equalEarth () {
    return projection(equalEarthRaw).scale(177.158);
  }

  function gnomonicRaw(x, y) {
    var cy = cos$1(y),
        k = cos$1(x) * cy;
    return [cy * sin$1(x) / k, sin$1(y) / k];
  }
  gnomonicRaw.invert = azimuthalInvert(atan);
  function gnomonic () {
    return projection(gnomonicRaw).scale(144.049).clipAngle(60);
  }

  function scaleTranslate$1(kx, ky, tx, ty) {
    return kx === 1 && ky === 1 && tx === 0 && ty === 0 ? identity$5 : transformer$3({
      point: function point(x, y) {
        this.stream.point(x * kx + tx, y * ky + ty);
      }
    });
  }

  function identity$6 () {
    var k = 1,
        tx = 0,
        ty = 0,
        sx = 1,
        sy = 1,
        transform = identity$5,
        // scale, translate and reflect
    x0 = null,
        y0,
        x1,
        y1,
        // clip extent
    _postclip = identity$5,
        cache,
        cacheStream,
        projection;

    function reset() {
      cache = cacheStream = null;
      return projection;
    }

    return projection = {
      stream: function stream(_stream) {
        return cache && cacheStream === _stream ? cache : cache = transform(_postclip(cacheStream = _stream));
      },
      postclip: function postclip(_) {
        return arguments.length ? (_postclip = _, x0 = y0 = x1 = y1 = null, reset()) : _postclip;
      },
      clipExtent: function clipExtent(_) {
        return arguments.length ? (_postclip = _ == null ? (x0 = y0 = x1 = y1 = null, identity$5) : clipRectangle(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reset()) : x0 == null ? null : [[x0, y0], [x1, y1]];
      },
      scale: function scale(_) {
        return arguments.length ? (transform = scaleTranslate$1((k = +_) * sx, k * sy, tx, ty), reset()) : k;
      },
      translate: function translate(_) {
        return arguments.length ? (transform = scaleTranslate$1(k * sx, k * sy, tx = +_[0], ty = +_[1]), reset()) : [tx, ty];
      },
      reflectX: function reflectX(_) {
        return arguments.length ? (transform = scaleTranslate$1(k * (sx = _ ? -1 : 1), k * sy, tx, ty), reset()) : sx < 0;
      },
      reflectY: function reflectY(_) {
        return arguments.length ? (transform = scaleTranslate$1(k * sx, k * (sy = _ ? -1 : 1), tx, ty), reset()) : sy < 0;
      },
      fitExtent: function fitExtent$1(extent, object) {
        return fitExtent(projection, extent, object);
      },
      fitSize: function fitSize$1(size, object) {
        return fitSize(projection, size, object);
      },
      fitWidth: function fitWidth$1(width, object) {
        return fitWidth(projection, width, object);
      },
      fitHeight: function fitHeight$1(height, object) {
        return fitHeight(projection, height, object);
      }
    };
  }

  function naturalEarth1Raw(lambda, phi) {
    var phi2 = phi * phi,
        phi4 = phi2 * phi2;
    return [lambda * (0.8707 - 0.131979 * phi2 + phi4 * (-0.013791 + phi4 * (0.003971 * phi2 - 0.001529 * phi4))), phi * (1.007226 + phi2 * (0.015085 + phi4 * (-0.044475 + 0.028874 * phi2 - 0.005916 * phi4)))];
  }

  naturalEarth1Raw.invert = function (x, y) {
    var phi = y,
        i = 25,
        delta;

    do {
      var phi2 = phi * phi,
          phi4 = phi2 * phi2;
      phi -= delta = (phi * (1.007226 + phi2 * (0.015085 + phi4 * (-0.044475 + 0.028874 * phi2 - 0.005916 * phi4))) - y) / (1.007226 + phi2 * (0.015085 * 3 + phi4 * (-0.044475 * 7 + 0.028874 * 9 * phi2 - 0.005916 * 11 * phi4)));
    } while (abs$1(delta) > epsilon$2 && --i > 0);

    return [x / (0.8707 + (phi2 = phi * phi) * (-0.131979 + phi2 * (-0.013791 + phi2 * phi2 * phi2 * (0.003971 - 0.001529 * phi2)))), phi];
  };

  function naturalEarth1 () {
    return projection(naturalEarth1Raw).scale(175.295);
  }

  function orthographicRaw(x, y) {
    return [cos$1(y) * sin$1(x), sin$1(y)];
  }
  orthographicRaw.invert = azimuthalInvert(asin$1);
  function orthographic () {
    return projection(orthographicRaw).scale(249.5).clipAngle(90 + epsilon$2);
  }

  function stereographicRaw(x, y) {
    var cy = cos$1(y),
        k = 1 + cos$1(x) * cy;
    return [cy * sin$1(x) / k, sin$1(y) / k];
  }
  stereographicRaw.invert = azimuthalInvert(function (z) {
    return 2 * atan(z);
  });
  function stereographic () {
    return projection(stereographicRaw).scale(250).clipAngle(142);
  }

  function transverseMercatorRaw(lambda, phi) {
    return [log$1(tan((halfPi$1 + phi) / 2)), -lambda];
  }

  transverseMercatorRaw.invert = function (x, y) {
    return [-y, 2 * atan(exp(x)) - halfPi$1];
  };

  function transverseMercator () {
    var m = mercatorProjection(transverseMercatorRaw),
        center = m.center,
        rotate = m.rotate;

    m.center = function (_) {
      return arguments.length ? center([-_[1], _[0]]) : (_ = center(), [_[1], -_[0]]);
    };

    m.rotate = function (_) {
      return arguments.length ? rotate([_[0], _[1], _.length > 2 ? _[2] + 90 : 90]) : (_ = rotate(), [_[0], _[1], _[2] - 90]);
    };

    return rotate([0, 0, 90]).scale(159.155);
  }



  var d3Geo = /*#__PURE__*/Object.freeze({
    __proto__: null,
    geoArea: area$1,
    geoBounds: bounds,
    geoCentroid: centroid,
    geoCircle: circle$1,
    geoClipAntimeridian: clipAntimeridian,
    geoClipCircle: clipCircle,
    geoClipExtent: extent$1,
    geoClipRectangle: clipRectangle,
    geoContains: contains,
    geoDistance: distance,
    geoGraticule: graticule,
    geoGraticule10: graticule10,
    geoInterpolate: interpolate$2,
    geoLength: length,
    geoPath: index,
    geoAlbers: albers,
    geoAlbersUsa: albersUsa,
    geoAzimuthalEqualArea: azimuthalEqualArea,
    geoAzimuthalEqualAreaRaw: azimuthalEqualAreaRaw,
    geoAzimuthalEquidistant: azimuthalEquidistant,
    geoAzimuthalEquidistantRaw: azimuthalEquidistantRaw,
    geoConicConformal: conicConformal,
    geoConicConformalRaw: conicConformalRaw,
    geoConicEqualArea: conicEqualArea,
    geoConicEqualAreaRaw: conicEqualAreaRaw,
    geoConicEquidistant: conicEquidistant,
    geoConicEquidistantRaw: conicEquidistantRaw,
    geoEqualEarth: equalEarth,
    geoEqualEarthRaw: equalEarthRaw,
    geoEquirectangular: equirectangular,
    geoEquirectangularRaw: equirectangularRaw,
    geoGnomonic: gnomonic,
    geoGnomonicRaw: gnomonicRaw,
    geoIdentity: identity$6,
    geoProjection: projection,
    geoProjectionMutator: projectionMutator,
    geoMercator: mercator,
    geoMercatorRaw: mercatorRaw,
    geoNaturalEarth1: naturalEarth1,
    geoNaturalEarth1Raw: naturalEarth1Raw,
    geoOrthographic: orthographic,
    geoOrthographicRaw: orthographicRaw,
    geoStereographic: stereographic,
    geoStereographicRaw: stereographicRaw,
    geoTransverseMercator: transverseMercator,
    geoTransverseMercatorRaw: transverseMercatorRaw,
    geoRotation: rotation,
    geoStream: geoStream,
    geoTransform: transform
  });

  function tile () {
    var x0 = 0,
        y0 = 0,
        x1 = 960,
        y1 = 500,
        tx = (x0 + x1) / 2,
        ty = (y0 + y1) / 2,
        scale = 256,
        zoomDelta = 0,
        wrap = true;

    function tile() {
      var z = Math.max(Math.log(scale) / Math.LN2 - 8, 0),
          z0 = Math.round(z + zoomDelta),
          j = 1 << z0,
          k = Math.pow(2, z - z0 + 8),
          x = tx - scale / 2,
          y = ty - scale / 2,
          tiles = [],
          cols = range(Math.max(wrap ? -Infinity : 0, Math.floor((x0 - x) / k)), Math.min(Math.ceil((x1 - x) / k), wrap ? Infinity : j)),
          rows = range(Math.max(0, Math.floor((y0 - y) / k)), Math.min(Math.ceil((y1 - y) / k), j));
      rows.forEach(function (y) {
        cols.forEach(function (x) {
          tiles.push({
            x: (x % j + j) % j,
            y: y,
            z: z0,
            tx: x * 256,
            ty: y * 256
          });
        });
      });
      tiles.translate = [x / k, y / k];
      tiles.scale = k;
      return tiles;
    }

    tile.size = function (_) {
      return arguments.length ? (x0 = y0 = 0, x1 = +_[0], y1 = +_[1], tile) : [x1 - x0, y1 - y0];
    };

    tile.extent = function (_) {
      return arguments.length ? (x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1], tile) : [[x0, y0], [x1, y1]];
    };

    tile.scale = function (_) {
      return arguments.length ? (scale = +_, tile) : scale;
    };

    tile.translate = function (_) {
      return arguments.length ? (tx = +_[0], ty = +_[1], tile) : [tx, ty];
    };

    tile.zoomDelta = function (_) {
      return arguments.length ? (zoomDelta = +_, tile) : zoomDelta;
    };

    tile.wrap = function (_) {
      return arguments.length ? (wrap = _, tile) : wrap;
    };

    return tile;
  }

  function identity$7 (x) {
    return x;
  }

  function transform$1 (transform) {
    if (transform == null) return identity$7;
    var x0,
        y0,
        kx = transform.scale[0],
        ky = transform.scale[1],
        dx = transform.translate[0],
        dy = transform.translate[1];
    return function (input, i) {
      if (!i) x0 = y0 = 0;
      var j = 2,
          n = input.length,
          output = new Array(n);
      output[0] = (x0 += input[0]) * kx + dx;
      output[1] = (y0 += input[1]) * ky + dy;

      while (j < n) {
        output[j] = input[j], ++j;
      }

      return output;
    };
  }

  function reverse$1 (array, n) {
    var t,
        j = array.length,
        i = j - n;

    while (i < --j) {
      t = array[i], array[i++] = array[j], array[j] = t;
    }
  }

  function feature (topology, o) {
    if (typeof o === "string") o = topology.objects[o];
    return o.type === "GeometryCollection" ? {
      type: "FeatureCollection",
      features: o.geometries.map(function (o) {
        return feature$1(topology, o);
      })
    } : feature$1(topology, o);
  }

  function feature$1(topology, o) {
    var id = o.id,
        bbox = o.bbox,
        properties = o.properties == null ? {} : o.properties,
        geometry = object$2(topology, o);
    return id == null && bbox == null ? {
      type: "Feature",
      properties: properties,
      geometry: geometry
    } : bbox == null ? {
      type: "Feature",
      id: id,
      properties: properties,
      geometry: geometry
    } : {
      type: "Feature",
      id: id,
      bbox: bbox,
      properties: properties,
      geometry: geometry
    };
  }

  function object$2(topology, o) {
    var transformPoint = transform$1(topology.transform),
        arcs = topology.arcs;

    function arc(i, points) {
      if (points.length) points.pop();

      for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {
        points.push(transformPoint(a[k], k));
      }

      if (i < 0) reverse$1(points, n);
    }

    function point(p) {
      return transformPoint(p);
    }

    function line(arcs) {
      var points = [];

      for (var i = 0, n = arcs.length; i < n; ++i) {
        arc(arcs[i], points);
      }

      if (points.length < 2) points.push(points[0]); // This should never happen per the specification.

      return points;
    }

    function ring(arcs) {
      var points = line(arcs);

      while (points.length < 4) {
        points.push(points[0]);
      } // This may happen if an arc has only two points.


      return points;
    }

    function polygon(arcs) {
      return arcs.map(ring);
    }

    function geometry(o) {
      var type = o.type,
          coordinates;

      switch (type) {
        case "GeometryCollection":
          return {
            type: type,
            geometries: o.geometries.map(geometry)
          };

        case "Point":
          coordinates = point(o.coordinates);
          break;

        case "MultiPoint":
          coordinates = o.coordinates.map(point);
          break;

        case "LineString":
          coordinates = line(o.arcs);
          break;

        case "MultiLineString":
          coordinates = o.arcs.map(line);
          break;

        case "Polygon":
          coordinates = polygon(o.arcs);
          break;

        case "MultiPolygon":
          coordinates = o.arcs.map(polygon);
          break;

        default:
          return null;
      }

      return {
        type: type,
        coordinates: coordinates
      };
    }

    return geometry(o);
  }

  /**
    @function dataConcat
    @desc Reduce and concat all the elements included in arrayOfArrays if they are arrays. If it is a JSON object try to concat the array under given key data. If the key doesn't exists in object item, a warning message is lauched to the console. You need to implement DataFormat callback to concat the arrays manually.
    @param {Array} arrayOfArray Array of elements
    @param {String} [data = "data"] The key used for the flat data array if exists inside of the JSON object.
  */
  var concat = (function (arrayOfArrays) {
    var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "data";
    return arrayOfArrays.reduce(function (acc, item) {
      var dataArray = [];

      if (Array.isArray(item)) {
        dataArray = item;
      } else {
        if (item[data]) {
          dataArray = item[data];
        } else {
          console.warn("d3plus-viz: Please implement a \"dataFormat\" callback to concat the arrays manually (consider using the d3plus.dataConcat method in your callback). Currently unable to concatenate (using key: \"".concat(data, "\") the following response:"), item);
        }
      }

      return acc.concat(dataArray);
    }, []);
  });

  /**
    @function dataFold
    @desc Given a JSON object where the data values and headers have been split into separate key lookups, this function will combine the data values with the headers and returns one large array of objects.
    @param {Object} json A JSON data Object with `data` and `headers` keys.
    @param {String} [data = "data"] The key used for the flat data array inside of the JSON object.
    @param {String} [headers = "headers"] The key used for the flat headers array inside of the JSON object.
  */
  var fold = (function (json) {
    var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "data";
    var headers = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : "headers";
    return json[data].map(function (data) {
      return json[headers].reduce(function (obj, header, i) {
        return obj[header] = data[i], obj;
      }, {});
    });
  });

  function request (url, callback) {
    var request,
        event = dispatch("beforesend", "progress", "load", "error"),
        _mimeType,
        headers = map(),
        xhr = new XMLHttpRequest(),
        _user = null,
        _password = null,
        _response,
        _responseType,
        _timeout = 0; // If IE does not support CORS, use XDomainRequest.


    if (typeof XDomainRequest !== "undefined" && !("withCredentials" in xhr) && /^(http(s)?:)?\/\//.test(url)) xhr = new XDomainRequest();
    "onload" in xhr ? xhr.onload = xhr.onerror = xhr.ontimeout = respond : xhr.onreadystatechange = function (o) {
      xhr.readyState > 3 && respond(o);
    };

    function respond(o) {
      var status = xhr.status,
          result;

      if (!status && hasResponse(xhr) || status >= 200 && status < 300 || status === 304) {
        if (_response) {
          try {
            result = _response.call(request, xhr);
          } catch (e) {
            event.call("error", request, e);
            return;
          }
        } else {
          result = xhr;
        }

        event.call("load", request, result);
      } else {
        event.call("error", request, o);
      }
    }

    xhr.onprogress = function (e) {
      event.call("progress", request, e);
    };

    request = {
      header: function header(name, value) {
        name = (name + "").toLowerCase();
        if (arguments.length < 2) return headers.get(name);
        if (value == null) headers.remove(name);else headers.set(name, value + "");
        return request;
      },
      // If mimeType is non-null and no Accept header is set, a default is used.
      mimeType: function mimeType(value) {
        if (!arguments.length) return _mimeType;
        _mimeType = value == null ? null : value + "";
        return request;
      },
      // Specifies what type the response value should take;
      // for instance, arraybuffer, blob, document, or text.
      responseType: function responseType(value) {
        if (!arguments.length) return _responseType;
        _responseType = value;
        return request;
      },
      timeout: function timeout(value) {
        if (!arguments.length) return _timeout;
        _timeout = +value;
        return request;
      },
      user: function user(value) {
        return arguments.length < 1 ? _user : (_user = value == null ? null : value + "", request);
      },
      password: function password(value) {
        return arguments.length < 1 ? _password : (_password = value == null ? null : value + "", request);
      },
      // Specify how to convert the response content to a specific type;
      // changes the callback value on "load" events.
      response: function response(value) {
        _response = value;
        return request;
      },
      // Alias for send("GET", ).
      get: function get(data, callback) {
        return request.send("GET", data, callback);
      },
      // Alias for send("POST", ).
      post: function post(data, callback) {
        return request.send("POST", data, callback);
      },
      // If callback is non-null, it will be used for error and load events.
      send: function send(method, data, callback) {
        xhr.open(method, url, true, _user, _password);
        if (_mimeType != null && !headers.has("accept")) headers.set("accept", _mimeType + ",*/*");
        if (xhr.setRequestHeader) headers.each(function (value, name) {
          xhr.setRequestHeader(name, value);
        });
        if (_mimeType != null && xhr.overrideMimeType) xhr.overrideMimeType(_mimeType);
        if (_responseType != null) xhr.responseType = _responseType;
        if (_timeout > 0) xhr.timeout = _timeout;
        if (callback == null && typeof data === "function") callback = data, data = null;
        if (callback != null && callback.length === 1) callback = fixCallback(callback);
        if (callback != null) request.on("error", callback).on("load", function (xhr) {
          callback(null, xhr);
        });
        event.call("beforesend", request, xhr);
        xhr.send(data == null ? null : data);
        return request;
      },
      abort: function abort() {
        xhr.abort();
        return request;
      },
      on: function on() {
        var value = event.on.apply(event, arguments);
        return value === event ? request : value;
      }
    };

    if (callback != null) {
      if (typeof callback !== "function") throw new Error("invalid callback: " + callback);
      return request.get(callback);
    }

    return request;
  }

  function fixCallback(callback) {
    return function (error, xhr) {
      callback(error == null ? xhr : null);
    };
  }

  function hasResponse(xhr) {
    var type = xhr.responseType;
    return type && type !== "text" ? xhr.response // null on error
    : xhr.responseText; // "" on error
  }

  function type (defaultMimeType, response) {
    return function (url, callback) {
      var r = request(url).mimeType(defaultMimeType).response(response);

      if (callback != null) {
        if (typeof callback !== "function") throw new Error("invalid callback: " + callback);
        return r.get(callback);
      }

      return r;
    };
  }

  var json = type("application/json", function (xhr) {
    return JSON.parse(xhr.responseText);
  });

  var text = type("text/plain", function (xhr) {
    return xhr.responseText;
  });

  var EOL = {},
      EOF = {},
      QUOTE = 34,
      NEWLINE = 10,
      RETURN = 13;

  function objectConverter(columns) {
    return new Function("d", "return {" + columns.map(function (name, i) {
      return JSON.stringify(name) + ": d[" + i + "] || \"\"";
    }).join(",") + "}");
  }

  function customConverter(columns, f) {
    var object = objectConverter(columns);
    return function (row, i) {
      return f(object(row), i, columns);
    };
  } // Compute unique columns in order of discovery.


  function inferColumns(rows) {
    var columnSet = Object.create(null),
        columns = [];
    rows.forEach(function (row) {
      for (var column in row) {
        if (!(column in columnSet)) {
          columns.push(columnSet[column] = column);
        }
      }
    });
    return columns;
  }

  function pad$1(value, width) {
    var s = value + "",
        length = s.length;
    return length < width ? new Array(width - length + 1).join(0) + s : s;
  }

  function formatYear$1(year) {
    return year < 0 ? "-" + pad$1(-year, 6) : year > 9999 ? "+" + pad$1(year, 6) : pad$1(year, 4);
  }

  function formatDate(date) {
    var hours = date.getUTCHours(),
        minutes = date.getUTCMinutes(),
        seconds = date.getUTCSeconds(),
        milliseconds = date.getUTCMilliseconds();
    return isNaN(date) ? "Invalid Date" : formatYear$1(date.getUTCFullYear()) + "-" + pad$1(date.getUTCMonth() + 1, 2) + "-" + pad$1(date.getUTCDate(), 2) + (milliseconds ? "T" + pad$1(hours, 2) + ":" + pad$1(minutes, 2) + ":" + pad$1(seconds, 2) + "." + pad$1(milliseconds, 3) + "Z" : seconds ? "T" + pad$1(hours, 2) + ":" + pad$1(minutes, 2) + ":" + pad$1(seconds, 2) + "Z" : minutes || hours ? "T" + pad$1(hours, 2) + ":" + pad$1(minutes, 2) + "Z" : "");
  }

  function dsv (delimiter) {
    var reFormat = new RegExp("[\"" + delimiter + "\n\r]"),
        DELIMITER = delimiter.charCodeAt(0);

    function parse(text, f) {
      var convert,
          columns,
          rows = parseRows(text, function (row, i) {
        if (convert) return convert(row, i - 1);
        columns = row, convert = f ? customConverter(row, f) : objectConverter(row);
      });
      rows.columns = columns || [];
      return rows;
    }

    function parseRows(text, f) {
      var rows = [],
          // output rows
      N = text.length,
          I = 0,
          // current character index
      n = 0,
          // current line number
      t,
          // current token
      eof = N <= 0,
          // current token followed by EOF?
      eol = false; // current token followed by EOL?
      // Strip the trailing newline.

      if (text.charCodeAt(N - 1) === NEWLINE) --N;
      if (text.charCodeAt(N - 1) === RETURN) --N;

      function token() {
        if (eof) return EOF;
        if (eol) return eol = false, EOL; // Unescape quotes.

        var i,
            j = I,
            c;

        if (text.charCodeAt(j) === QUOTE) {
          while (I++ < N && text.charCodeAt(I) !== QUOTE || text.charCodeAt(++I) === QUOTE) {
          }

          if ((i = I) >= N) eof = true;else if ((c = text.charCodeAt(I++)) === NEWLINE) eol = true;else if (c === RETURN) {
            eol = true;
            if (text.charCodeAt(I) === NEWLINE) ++I;
          }
          return text.slice(j + 1, i - 1).replace(/""/g, "\"");
        } // Find next delimiter or newline.


        while (I < N) {
          if ((c = text.charCodeAt(i = I++)) === NEWLINE) eol = true;else if (c === RETURN) {
            eol = true;
            if (text.charCodeAt(I) === NEWLINE) ++I;
          } else if (c !== DELIMITER) continue;
          return text.slice(j, i);
        } // Return last token before EOF.


        return eof = true, text.slice(j, N);
      }

      while ((t = token()) !== EOF) {
        var row = [];

        while (t !== EOL && t !== EOF) {
          row.push(t), t = token();
        }

        if (f && (row = f(row, n++)) == null) continue;
        rows.push(row);
      }

      return rows;
    }

    function preformatBody(rows, columns) {
      return rows.map(function (row) {
        return columns.map(function (column) {
          return formatValue(row[column]);
        }).join(delimiter);
      });
    }

    function format(rows, columns) {
      if (columns == null) columns = inferColumns(rows);
      return [columns.map(formatValue).join(delimiter)].concat(preformatBody(rows, columns)).join("\n");
    }

    function formatBody(rows, columns) {
      if (columns == null) columns = inferColumns(rows);
      return preformatBody(rows, columns).join("\n");
    }

    function formatRows(rows) {
      return rows.map(formatRow).join("\n");
    }

    function formatRow(row) {
      return row.map(formatValue).join(delimiter);
    }

    function formatValue(value) {
      return value == null ? "" : value instanceof Date ? formatDate(value) : reFormat.test(value += "") ? "\"" + value.replace(/"/g, "\"\"") + "\"" : value;
    }

    return {
      parse: parse,
      parseRows: parseRows,
      format: format,
      formatBody: formatBody,
      formatRows: formatRows,
      formatRow: formatRow,
      formatValue: formatValue
    };
  }

  var csv = dsv(",");
  var csvParse = csv.parse;

  var tsv = dsv("\t");
  var tsvParse = tsv.parse;

  function dsv$1 (defaultMimeType, parse) {
    return function (url, row, callback) {
      if (arguments.length < 3) callback = row, row = null;
      var r = request(url).mimeType(defaultMimeType);

      r.row = function (_) {
        return arguments.length ? r.response(responseOf(parse, row = _)) : row;
      };

      r.row(row);
      return callback ? r.get(callback) : r;
    };
  }

  function responseOf(parse, row) {
    return function (request) {
      return parse(request.responseText, row);
    };
  }

  var csv$1 = dsv$1("text/csv", csvParse);

  var tsv$1 = dsv$1("text/tab-separated-values", tsvParse);

  /**
    @function dataLoad
    @desc Loads data from a filepath or URL, converts it to a valid JSON object, and returns it to a callback function.
    @param {Array|String} path The path to the file or url to be loaded. Also support array of paths strings. If an Array of objects is passed, the xhr request logic is skipped.
    @param {Function} [formatter] An optional formatter function that is run on the loaded data.
    @param {String} [key] The key in the `this` context to save the resulting data to.
    @param {Function} [callback] A function that is called when the final data is loaded. It is passed 2 variables, any error present and the data loaded.
  */

  function load (path, formatter, key, callback) {
    var _this = this;

    var parser;

    var getParser = function getParser(path) {
      var ext = path.slice(path.length - 4);

      switch (ext) {
        case ".csv":
          return csv$1;

        case ".tsv":
          return tsv$1;

        case ".txt":
          return text;

        default:
          return json;
      }
    };

    var validateData = function validateData(err, parser, data) {
      if (parser !== json && !err && data && data instanceof Array) {
        data.forEach(function (d) {
          for (var k in d) {
            if (!isNaN(d[k])) d[k] = parseFloat(d[k]);else if (d[k].toLowerCase() === "false") d[k] = false;else if (d[k].toLowerCase() === "true") d[k] = true;else if (d[k].toLowerCase() === "null") d[k] = null;else if (d[k].toLowerCase() === "undefined") d[k] = undefined;
          }
        });
      }

      return data;
    };

    var loadedLength = function loadedLength(loadedArray) {
      return loadedArray.reduce(function (prev, current) {
        return current ? prev + 1 : prev;
      }, 0);
    };

    var getPathIndex = function getPathIndex(url, array) {
      return array.indexOf(url);
    }; // If data param is a single string url or an plain object then convert path to a 1 element array of urls to re-use logic


    if (typeof path === "string") {
      path = [path];
    }

    var isThereAnyString = path.find(function (dataItem) {
      return typeof dataItem === "string";
    });
    var loaded = new Array(path.length);
    var toLoad = []; // If there is a string I'm assuming is a Array to merge, urls or data

    if (isThereAnyString) {
      path.forEach(function (dataItem, ix) {
        if (typeof dataItem !== "string") {
          loaded[ix] = dataItem;
        } else if (typeof dataItem === "string") {
          toLoad.push(dataItem);
        }
      });
    } // Data array itself
    else {
        loaded[0] = path;
      } // Load all urls an combine them with data arrays


    var alreadyLoaded = loadedLength(loaded);
    toLoad.forEach(function (url) {
      parser = getParser(url);
      parser(url, function (err, data) {
        data = err ? [] : data;
        if (data && !(data instanceof Array) && data.data && data.headers) data = fold(data);
        data = validateData(err, parser, data);
        loaded[getPathIndex(url, path)] = data;

        if (loadedLength(loaded) - alreadyLoaded === toLoad.length) {
          // All urls loaded
          // Format data
          data = loadedLength(loaded) === 1 ? loaded[0] : loaded;

          if (formatter) {
            data = formatter(loadedLength(loaded) === 1 ? loaded[0] : loaded);
          } else if (key === "data") {
            data = concat(loaded, "data");
          }

          if (key && "_".concat(key) in _this) _this["_".concat(key)] = data;
          if (_this._cache) _this._lrucache.set(url, data);
          if (callback) callback(err, data);
        }
      });
    }); // If there is no data to Load response is immediately

    if (toLoad.length === 0) {
      loaded = loaded.map(function (data) {
        if (data && !(data instanceof Array) && data.data && data.headers) data = fold(data);
        return data;
      }); // Format data

      var data = loadedLength(loaded) === 1 ? loaded[0] : loaded;

      if (formatter) {
        data = formatter(loadedLength(loaded) === 1 ? loaded[0] : loaded);
      } else if (key === "data") {
        data = concat(loaded, "data");
      }

      if (key && "_".concat(key) in this) this["_".concat(key)] = data;
      if (this._cache) this._lrucache.set(key, data);
      if (callback) callback(null, data);
    }
  }

  function noevent () {
    event$1.preventDefault();
    event$1.stopImmediatePropagation();
  }

  function dragDisable (view) {
    var root = view.document.documentElement,
        selection = _select(view).on("dragstart.drag", noevent, true);

    if ("onselectstart" in root) {
      selection.on("selectstart.drag", noevent, true);
    } else {
      root.__noselect = root.style.MozUserSelect;
      root.style.MozUserSelect = "none";
    }
  }
  function yesdrag(view, noclick) {
    var root = view.document.documentElement,
        selection = _select(view).on("dragstart.drag", null);

    if (noclick) {
      selection.on("click.drag", noevent, true);
      setTimeout(function () {
        selection.on("click.drag", null);
      }, 0);
    }

    if ("onselectstart" in root) {
      selection.on("selectstart.drag", null);
    } else {
      root.style.MozUserSelect = root.__noselect;
      delete root.__noselect;
    }
  }

  function constant$6 (x) {
    return function () {
      return x;
    };
  }

  function BrushEvent (target, type, selection) {
    this.target = target;
    this.type = type;
    this.selection = selection;
  }

  function nopropagation() {
    event$1.stopImmediatePropagation();
  }
  function noevent$1 () {
    event$1.preventDefault();
    event$1.stopImmediatePropagation();
  }

  var MODE_DRAG = {
    name: "drag"
  },
      MODE_SPACE = {
    name: "space"
  },
      MODE_HANDLE = {
    name: "handle"
  },
      MODE_CENTER = {
    name: "center"
  };

  function number1(e) {
    return [+e[0], +e[1]];
  }

  function number2(e) {
    return [number1(e[0]), number1(e[1])];
  }

  function toucher(identifier) {
    return function (target) {
      return touch(target, event$1.touches, identifier);
    };
  }

  var X = {
    name: "x",
    handles: ["w", "e"].map(type$1),
    input: function input(x, e) {
      return x == null ? null : [[+x[0], e[0][1]], [+x[1], e[1][1]]];
    },
    output: function output(xy) {
      return xy && [xy[0][0], xy[1][0]];
    }
  };
  var Y = {
    name: "y",
    handles: ["n", "s"].map(type$1),
    input: function input(y, e) {
      return y == null ? null : [[e[0][0], +y[0]], [e[1][0], +y[1]]];
    },
    output: function output(xy) {
      return xy && [xy[0][1], xy[1][1]];
    }
  };
  var XY = {
    name: "xy",
    handles: ["n", "w", "e", "s", "nw", "ne", "sw", "se"].map(type$1),
    input: function input(xy) {
      return xy == null ? null : number2(xy);
    },
    output: function output(xy) {
      return xy;
    }
  };
  var cursors = {
    overlay: "crosshair",
    selection: "move",
    n: "ns-resize",
    e: "ew-resize",
    s: "ns-resize",
    w: "ew-resize",
    nw: "nwse-resize",
    ne: "nesw-resize",
    se: "nwse-resize",
    sw: "nesw-resize"
  };
  var flipX = {
    e: "w",
    w: "e",
    nw: "ne",
    ne: "nw",
    se: "sw",
    sw: "se"
  };
  var flipY = {
    n: "s",
    s: "n",
    nw: "sw",
    ne: "se",
    se: "ne",
    sw: "nw"
  };
  var signsX = {
    overlay: +1,
    selection: +1,
    n: null,
    e: +1,
    s: null,
    w: -1,
    nw: -1,
    ne: +1,
    se: +1,
    sw: -1
  };
  var signsY = {
    overlay: +1,
    selection: +1,
    n: -1,
    e: null,
    s: +1,
    w: null,
    nw: -1,
    ne: -1,
    se: +1,
    sw: +1
  };

  function type$1(t) {
    return {
      type: t
    };
  } // Ignore right-click, since that should open the context menu.


  function defaultFilter() {
    return !event$1.ctrlKey && !event$1.button;
  }

  function defaultExtent() {
    var svg = this.ownerSVGElement || this;

    if (svg.hasAttribute("viewBox")) {
      svg = svg.viewBox.baseVal;
      return [[svg.x, svg.y], [svg.x + svg.width, svg.y + svg.height]];
    }

    return [[0, 0], [svg.width.baseVal.value, svg.height.baseVal.value]];
  }

  function defaultTouchable() {
    return navigator.maxTouchPoints || "ontouchstart" in this;
  } // Like d3.local, but with the name __brush rather than auto-generated.


  function local(node) {
    while (!node.__brush) {
      if (!(node = node.parentNode)) return;
    }

    return node.__brush;
  }

  function empty$1(extent) {
    return extent[0][0] === extent[1][0] || extent[0][1] === extent[1][1];
  }
  function brush () {
    return brush$1(XY);
  }

  function brush$1(dim) {
    var extent = defaultExtent,
        filter = defaultFilter,
        touchable = defaultTouchable,
        keys = true,
        listeners = dispatch("start", "brush", "end"),
        handleSize = 6,
        touchending;

    function brush(group) {
      var overlay = group.property("__brush", initialize).selectAll(".overlay").data([type$1("overlay")]);
      overlay.enter().append("rect").attr("class", "overlay").attr("pointer-events", "all").attr("cursor", cursors.overlay).merge(overlay).each(function () {
        var extent = local(this).extent;
        _select(this).attr("x", extent[0][0]).attr("y", extent[0][1]).attr("width", extent[1][0] - extent[0][0]).attr("height", extent[1][1] - extent[0][1]);
      });
      group.selectAll(".selection").data([type$1("selection")]).enter().append("rect").attr("class", "selection").attr("cursor", cursors.selection).attr("fill", "#777").attr("fill-opacity", 0.3).attr("stroke", "#fff").attr("shape-rendering", "crispEdges");
      var handle = group.selectAll(".handle").data(dim.handles, function (d) {
        return d.type;
      });
      handle.exit().remove();
      handle.enter().append("rect").attr("class", function (d) {
        return "handle handle--" + d.type;
      }).attr("cursor", function (d) {
        return cursors[d.type];
      });
      group.each(redraw).attr("fill", "none").attr("pointer-events", "all").on("mousedown.brush", started).filter(touchable).on("touchstart.brush", started).on("touchmove.brush", touchmoved).on("touchend.brush touchcancel.brush", touchended).style("touch-action", "none").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
    }

    brush.move = function (group, selection) {
      if (group.selection) {
        group.on("start.brush", function () {
          emitter(this, arguments).beforestart().start();
        }).on("interrupt.brush end.brush", function () {
          emitter(this, arguments).end();
        }).tween("brush", function () {
          var that = this,
              state = that.__brush,
              emit = emitter(that, arguments),
              selection0 = state.selection,
              selection1 = dim.input(typeof selection === "function" ? selection.apply(this, arguments) : selection, state.extent),
              i = interpolate(selection0, selection1);

          function tween(t) {
            state.selection = t === 1 && selection1 === null ? null : i(t);
            redraw.call(that);
            emit.brush();
          }

          return selection0 !== null && selection1 !== null ? tween : tween(1);
        });
      } else {
        group.each(function () {
          var that = this,
              args = arguments,
              state = that.__brush,
              selection1 = dim.input(typeof selection === "function" ? selection.apply(that, args) : selection, state.extent),
              emit = emitter(that, args).beforestart();
          interrupt(that);
          state.selection = selection1 === null ? null : selection1;
          redraw.call(that);
          emit.start().brush().end();
        });
      }
    };

    brush.clear = function (group) {
      brush.move(group, null);
    };

    function redraw() {
      var group = _select(this),
          selection = local(this).selection;

      if (selection) {
        group.selectAll(".selection").style("display", null).attr("x", selection[0][0]).attr("y", selection[0][1]).attr("width", selection[1][0] - selection[0][0]).attr("height", selection[1][1] - selection[0][1]);
        group.selectAll(".handle").style("display", null).attr("x", function (d) {
          return d.type[d.type.length - 1] === "e" ? selection[1][0] - handleSize / 2 : selection[0][0] - handleSize / 2;
        }).attr("y", function (d) {
          return d.type[0] === "s" ? selection[1][1] - handleSize / 2 : selection[0][1] - handleSize / 2;
        }).attr("width", function (d) {
          return d.type === "n" || d.type === "s" ? selection[1][0] - selection[0][0] + handleSize : handleSize;
        }).attr("height", function (d) {
          return d.type === "e" || d.type === "w" ? selection[1][1] - selection[0][1] + handleSize : handleSize;
        });
      } else {
        group.selectAll(".selection,.handle").style("display", "none").attr("x", null).attr("y", null).attr("width", null).attr("height", null);
      }
    }

    function emitter(that, args, clean) {
      return !clean && that.__brush.emitter || new Emitter(that, args);
    }

    function Emitter(that, args) {
      this.that = that;
      this.args = args;
      this.state = that.__brush;
      this.active = 0;
    }

    Emitter.prototype = {
      beforestart: function beforestart() {
        if (++this.active === 1) this.state.emitter = this, this.starting = true;
        return this;
      },
      start: function start() {
        if (this.starting) this.starting = false, this.emit("start");else this.emit("brush");
        return this;
      },
      brush: function brush() {
        this.emit("brush");
        return this;
      },
      end: function end() {
        if (--this.active === 0) delete this.state.emitter, this.emit("end");
        return this;
      },
      emit: function emit(type) {
        customEvent(new BrushEvent(brush, type, dim.output(this.state.selection)), listeners.apply, listeners, [type, this.that, this.args]);
      }
    };

    function started() {
      if (touchending && !event$1.touches) return;
      if (!filter.apply(this, arguments)) return;
      var that = this,
          type = event$1.target.__data__.type,
          mode = (keys && event$1.metaKey ? type = "overlay" : type) === "selection" ? MODE_DRAG : keys && event$1.altKey ? MODE_CENTER : MODE_HANDLE,
          signX = dim === Y ? null : signsX[type],
          signY = dim === X ? null : signsY[type],
          state = local(that),
          extent = state.extent,
          selection = state.selection,
          W = extent[0][0],
          w0,
          w1,
          N = extent[0][1],
          n0,
          n1,
          E = extent[1][0],
          e0,
          e1,
          S = extent[1][1],
          s0,
          s1,
          dx = 0,
          dy = 0,
          moving,
          shifting = signX && signY && keys && event$1.shiftKey,
          lockX,
          lockY,
          pointer = event$1.touches ? toucher(event$1.changedTouches[0].identifier) : mouse,
          point0 = pointer(that),
          point = point0,
          emit = emitter(that, arguments, true).beforestart();

      if (type === "overlay") {
        if (selection) moving = true;
        state.selection = selection = [[w0 = dim === Y ? W : point0[0], n0 = dim === X ? N : point0[1]], [e0 = dim === Y ? E : w0, s0 = dim === X ? S : n0]];
      } else {
        w0 = selection[0][0];
        n0 = selection[0][1];
        e0 = selection[1][0];
        s0 = selection[1][1];
      }

      w1 = w0;
      n1 = n0;
      e1 = e0;
      s1 = s0;
      var group = _select(that).attr("pointer-events", "none");
      var overlay = group.selectAll(".overlay").attr("cursor", cursors[type]);

      if (event$1.touches) {
        emit.moved = moved;
        emit.ended = ended;
      } else {
        var view = _select(event$1.view).on("mousemove.brush", moved, true).on("mouseup.brush", ended, true);
        if (keys) view.on("keydown.brush", keydowned, true).on("keyup.brush", keyupped, true);
        dragDisable(event$1.view);
      }

      nopropagation();
      interrupt(that);
      redraw.call(that);
      emit.start();

      function moved() {
        var point1 = pointer(that);

        if (shifting && !lockX && !lockY) {
          if (Math.abs(point1[0] - point[0]) > Math.abs(point1[1] - point[1])) lockY = true;else lockX = true;
        }

        point = point1;
        moving = true;
        noevent$1();
        move();
      }

      function move() {
        var t;
        dx = point[0] - point0[0];
        dy = point[1] - point0[1];

        switch (mode) {
          case MODE_SPACE:
          case MODE_DRAG:
            {
              if (signX) dx = Math.max(W - w0, Math.min(E - e0, dx)), w1 = w0 + dx, e1 = e0 + dx;
              if (signY) dy = Math.max(N - n0, Math.min(S - s0, dy)), n1 = n0 + dy, s1 = s0 + dy;
              break;
            }

          case MODE_HANDLE:
            {
              if (signX < 0) dx = Math.max(W - w0, Math.min(E - w0, dx)), w1 = w0 + dx, e1 = e0;else if (signX > 0) dx = Math.max(W - e0, Math.min(E - e0, dx)), w1 = w0, e1 = e0 + dx;
              if (signY < 0) dy = Math.max(N - n0, Math.min(S - n0, dy)), n1 = n0 + dy, s1 = s0;else if (signY > 0) dy = Math.max(N - s0, Math.min(S - s0, dy)), n1 = n0, s1 = s0 + dy;
              break;
            }

          case MODE_CENTER:
            {
              if (signX) w1 = Math.max(W, Math.min(E, w0 - dx * signX)), e1 = Math.max(W, Math.min(E, e0 + dx * signX));
              if (signY) n1 = Math.max(N, Math.min(S, n0 - dy * signY)), s1 = Math.max(N, Math.min(S, s0 + dy * signY));
              break;
            }
        }

        if (e1 < w1) {
          signX *= -1;
          t = w0, w0 = e0, e0 = t;
          t = w1, w1 = e1, e1 = t;
          if (type in flipX) overlay.attr("cursor", cursors[type = flipX[type]]);
        }

        if (s1 < n1) {
          signY *= -1;
          t = n0, n0 = s0, s0 = t;
          t = n1, n1 = s1, s1 = t;
          if (type in flipY) overlay.attr("cursor", cursors[type = flipY[type]]);
        }

        if (state.selection) selection = state.selection; // May be set by brush.move!

        if (lockX) w1 = selection[0][0], e1 = selection[1][0];
        if (lockY) n1 = selection[0][1], s1 = selection[1][1];

        if (selection[0][0] !== w1 || selection[0][1] !== n1 || selection[1][0] !== e1 || selection[1][1] !== s1) {
          state.selection = [[w1, n1], [e1, s1]];
          redraw.call(that);
          emit.brush();
        }
      }

      function ended() {
        nopropagation();

        if (event$1.touches) {
          if (event$1.touches.length) return;
          if (touchending) clearTimeout(touchending);
          touchending = setTimeout(function () {
            touchending = null;
          }, 500); // Ghost clicks are delayed!
        } else {
          yesdrag(event$1.view, moving);
          view.on("keydown.brush keyup.brush mousemove.brush mouseup.brush", null);
        }

        group.attr("pointer-events", "all");
        overlay.attr("cursor", cursors.overlay);
        if (state.selection) selection = state.selection; // May be set by brush.move (on start)!

        if (empty$1(selection)) state.selection = null, redraw.call(that);
        emit.end();
      }

      function keydowned() {
        switch (event$1.keyCode) {
          case 16:
            {
              // SHIFT
              shifting = signX && signY;
              break;
            }

          case 18:
            {
              // ALT
              if (mode === MODE_HANDLE) {
                if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;
                if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;
                mode = MODE_CENTER;
                move();
              }

              break;
            }

          case 32:
            {
              // SPACE; takes priority over ALT
              if (mode === MODE_HANDLE || mode === MODE_CENTER) {
                if (signX < 0) e0 = e1 - dx;else if (signX > 0) w0 = w1 - dx;
                if (signY < 0) s0 = s1 - dy;else if (signY > 0) n0 = n1 - dy;
                mode = MODE_SPACE;
                overlay.attr("cursor", cursors.selection);
                move();
              }

              break;
            }

          default:
            return;
        }

        noevent$1();
      }

      function keyupped() {
        switch (event$1.keyCode) {
          case 16:
            {
              // SHIFT
              if (shifting) {
                lockX = lockY = shifting = false;
                move();
              }

              break;
            }

          case 18:
            {
              // ALT
              if (mode === MODE_CENTER) {
                if (signX < 0) e0 = e1;else if (signX > 0) w0 = w1;
                if (signY < 0) s0 = s1;else if (signY > 0) n0 = n1;
                mode = MODE_HANDLE;
                move();
              }

              break;
            }

          case 32:
            {
              // SPACE
              if (mode === MODE_SPACE) {
                if (event$1.altKey) {
                  if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;
                  if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;
                  mode = MODE_CENTER;
                } else {
                  if (signX < 0) e0 = e1;else if (signX > 0) w0 = w1;
                  if (signY < 0) s0 = s1;else if (signY > 0) n0 = n1;
                  mode = MODE_HANDLE;
                }

                overlay.attr("cursor", cursors[type]);
                move();
              }

              break;
            }

          default:
            return;
        }

        noevent$1();
      }
    }

    function touchmoved() {
      emitter(this, arguments).moved();
    }

    function touchended() {
      emitter(this, arguments).ended();
    }

    function initialize() {
      var state = this.__brush || {
        selection: null
      };
      state.extent = number2(extent.apply(this, arguments));
      state.dim = dim;
      return state;
    }

    brush.extent = function (_) {
      return arguments.length ? (extent = typeof _ === "function" ? _ : constant$6(number2(_)), brush) : extent;
    };

    brush.filter = function (_) {
      return arguments.length ? (filter = typeof _ === "function" ? _ : constant$6(!!_), brush) : filter;
    };

    brush.touchable = function (_) {
      return arguments.length ? (touchable = typeof _ === "function" ? _ : constant$6(!!_), brush) : touchable;
    };

    brush.handleSize = function (_) {
      return arguments.length ? (handleSize = +_, brush) : handleSize;
    };

    brush.keyModifiers = function (_) {
      return arguments.length ? (keys = !!_, brush) : keys;
    };

    brush.on = function () {
      var value = listeners.on.apply(listeners, arguments);
      return value === listeners ? brush : value;
    };

    return brush;
  }

  function define$4 (constructor, factory, prototype) {
    constructor.prototype = factory.prototype = prototype;
    prototype.constructor = constructor;
  }
  function extend$5(parent, definition) {
    var prototype = Object.create(parent.prototype);

    for (var key in definition) {
      prototype[key] = definition[key];
    }

    return prototype;
  }

  function Color$4() {}
  var _darker$4 = 0.7;

  var _brighter$4 = 1 / _darker$4;
  var reI$4 = "\\s*([+-]?\\d+)\\s*",
      reN$4 = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",
      reP$4 = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",
      reHex$3 = /^#([0-9a-f]{3,8})$/,
      reRgbInteger$4 = new RegExp("^rgb\\(" + [reI$4, reI$4, reI$4] + "\\)$"),
      reRgbPercent$4 = new RegExp("^rgb\\(" + [reP$4, reP$4, reP$4] + "\\)$"),
      reRgbaInteger$4 = new RegExp("^rgba\\(" + [reI$4, reI$4, reI$4, reN$4] + "\\)$"),
      reRgbaPercent$4 = new RegExp("^rgba\\(" + [reP$4, reP$4, reP$4, reN$4] + "\\)$"),
      reHslPercent$4 = new RegExp("^hsl\\(" + [reN$4, reP$4, reP$4] + "\\)$"),
      reHslaPercent$4 = new RegExp("^hsla\\(" + [reN$4, reP$4, reP$4, reN$4] + "\\)$");
  var named$4 = {
    aliceblue: 0xf0f8ff,
    antiquewhite: 0xfaebd7,
    aqua: 0x00ffff,
    aquamarine: 0x7fffd4,
    azure: 0xf0ffff,
    beige: 0xf5f5dc,
    bisque: 0xffe4c4,
    black: 0x000000,
    blanchedalmond: 0xffebcd,
    blue: 0x0000ff,
    blueviolet: 0x8a2be2,
    brown: 0xa52a2a,
    burlywood: 0xdeb887,
    cadetblue: 0x5f9ea0,
    chartreuse: 0x7fff00,
    chocolate: 0xd2691e,
    coral: 0xff7f50,
    cornflowerblue: 0x6495ed,
    cornsilk: 0xfff8dc,
    crimson: 0xdc143c,
    cyan: 0x00ffff,
    darkblue: 0x00008b,
    darkcyan: 0x008b8b,
    darkgoldenrod: 0xb8860b,
    darkgray: 0xa9a9a9,
    darkgreen: 0x006400,
    darkgrey: 0xa9a9a9,
    darkkhaki: 0xbdb76b,
    darkmagenta: 0x8b008b,
    darkolivegreen: 0x556b2f,
    darkorange: 0xff8c00,
    darkorchid: 0x9932cc,
    darkred: 0x8b0000,
    darksalmon: 0xe9967a,
    darkseagreen: 0x8fbc8f,
    darkslateblue: 0x483d8b,
    darkslategray: 0x2f4f4f,
    darkslategrey: 0x2f4f4f,
    darkturquoise: 0x00ced1,
    darkviolet: 0x9400d3,
    deeppink: 0xff1493,
    deepskyblue: 0x00bfff,
    dimgray: 0x696969,
    dimgrey: 0x696969,
    dodgerblue: 0x1e90ff,
    firebrick: 0xb22222,
    floralwhite: 0xfffaf0,
    forestgreen: 0x228b22,
    fuchsia: 0xff00ff,
    gainsboro: 0xdcdcdc,
    ghostwhite: 0xf8f8ff,
    gold: 0xffd700,
    goldenrod: 0xdaa520,
    gray: 0x808080,
    green: 0x008000,
    greenyellow: 0xadff2f,
    grey: 0x808080,
    honeydew: 0xf0fff0,
    hotpink: 0xff69b4,
    indianred: 0xcd5c5c,
    indigo: 0x4b0082,
    ivory: 0xfffff0,
    khaki: 0xf0e68c,
    lavender: 0xe6e6fa,
    lavenderblush: 0xfff0f5,
    lawngreen: 0x7cfc00,
    lemonchiffon: 0xfffacd,
    lightblue: 0xadd8e6,
    lightcoral: 0xf08080,
    lightcyan: 0xe0ffff,
    lightgoldenrodyellow: 0xfafad2,
    lightgray: 0xd3d3d3,
    lightgreen: 0x90ee90,
    lightgrey: 0xd3d3d3,
    lightpink: 0xffb6c1,
    lightsalmon: 0xffa07a,
    lightseagreen: 0x20b2aa,
    lightskyblue: 0x87cefa,
    lightslategray: 0x778899,
    lightslategrey: 0x778899,
    lightsteelblue: 0xb0c4de,
    lightyellow: 0xffffe0,
    lime: 0x00ff00,
    limegreen: 0x32cd32,
    linen: 0xfaf0e6,
    magenta: 0xff00ff,
    maroon: 0x800000,
    mediumaquamarine: 0x66cdaa,
    mediumblue: 0x0000cd,
    mediumorchid: 0xba55d3,
    mediumpurple: 0x9370db,
    mediumseagreen: 0x3cb371,
    mediumslateblue: 0x7b68ee,
    mediumspringgreen: 0x00fa9a,
    mediumturquoise: 0x48d1cc,
    mediumvioletred: 0xc71585,
    midnightblue: 0x191970,
    mintcream: 0xf5fffa,
    mistyrose: 0xffe4e1,
    moccasin: 0xffe4b5,
    navajowhite: 0xffdead,
    navy: 0x000080,
    oldlace: 0xfdf5e6,
    olive: 0x808000,
    olivedrab: 0x6b8e23,
    orange: 0xffa500,
    orangered: 0xff4500,
    orchid: 0xda70d6,
    palegoldenrod: 0xeee8aa,
    palegreen: 0x98fb98,
    paleturquoise: 0xafeeee,
    palevioletred: 0xdb7093,
    papayawhip: 0xffefd5,
    peachpuff: 0xffdab9,
    peru: 0xcd853f,
    pink: 0xffc0cb,
    plum: 0xdda0dd,
    powderblue: 0xb0e0e6,
    purple: 0x800080,
    rebeccapurple: 0x663399,
    red: 0xff0000,
    rosybrown: 0xbc8f8f,
    royalblue: 0x4169e1,
    saddlebrown: 0x8b4513,
    salmon: 0xfa8072,
    sandybrown: 0xf4a460,
    seagreen: 0x2e8b57,
    seashell: 0xfff5ee,
    sienna: 0xa0522d,
    silver: 0xc0c0c0,
    skyblue: 0x87ceeb,
    slateblue: 0x6a5acd,
    slategray: 0x708090,
    slategrey: 0x708090,
    snow: 0xfffafa,
    springgreen: 0x00ff7f,
    steelblue: 0x4682b4,
    tan: 0xd2b48c,
    teal: 0x008080,
    thistle: 0xd8bfd8,
    tomato: 0xff6347,
    turquoise: 0x40e0d0,
    violet: 0xee82ee,
    wheat: 0xf5deb3,
    white: 0xffffff,
    whitesmoke: 0xf5f5f5,
    yellow: 0xffff00,
    yellowgreen: 0x9acd32
  };
  define$4(Color$4, color$4, {
    copy: function copy(channels) {
      return Object.assign(new this.constructor(), this, channels);
    },
    displayable: function displayable() {
      return this.rgb().displayable();
    },
    hex: color_formatHex$3,
    // Deprecated! Use color.formatHex.
    formatHex: color_formatHex$3,
    formatHsl: color_formatHsl$3,
    formatRgb: color_formatRgb$3,
    toString: color_formatRgb$3
  });

  function color_formatHex$3() {
    return this.rgb().formatHex();
  }

  function color_formatHsl$3() {
    return hslConvert$4(this).formatHsl();
  }

  function color_formatRgb$3() {
    return this.rgb().formatRgb();
  }

  function color$4(format) {
    var m, l;
    format = (format + "").trim().toLowerCase();
    return (m = reHex$3.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn$4(m) // #ff0000
    : l === 3 ? new Rgb$4(m >> 8 & 0xf | m >> 4 & 0xf0, m >> 4 & 0xf | m & 0xf0, (m & 0xf) << 4 | m & 0xf, 1) // #f00
    : l === 8 ? new Rgb$4(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000
    : l === 4 ? new Rgb$4(m >> 12 & 0xf | m >> 8 & 0xf0, m >> 8 & 0xf | m >> 4 & 0xf0, m >> 4 & 0xf | m & 0xf0, ((m & 0xf) << 4 | m & 0xf) / 0xff) // #f000
    : null // invalid hex
    ) : (m = reRgbInteger$4.exec(format)) ? new Rgb$4(m[1], m[2], m[3], 1) // rgb(255, 0, 0)
    : (m = reRgbPercent$4.exec(format)) ? new Rgb$4(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)
    : (m = reRgbaInteger$4.exec(format)) ? rgba$4(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)
    : (m = reRgbaPercent$4.exec(format)) ? rgba$4(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)
    : (m = reHslPercent$4.exec(format)) ? hsla$4(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)
    : (m = reHslaPercent$4.exec(format)) ? hsla$4(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)
    : named$4.hasOwnProperty(format) ? rgbn$4(named$4[format]) // eslint-disable-line no-prototype-builtins
    : format === "transparent" ? new Rgb$4(NaN, NaN, NaN, 0) : null;
  }

  function rgbn$4(n) {
    return new Rgb$4(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);
  }

  function rgba$4(r, g, b, a) {
    if (a <= 0) r = g = b = NaN;
    return new Rgb$4(r, g, b, a);
  }

  function rgbConvert$4(o) {
    if (!(o instanceof Color$4)) o = color$4(o);
    if (!o) return new Rgb$4();
    o = o.rgb();
    return new Rgb$4(o.r, o.g, o.b, o.opacity);
  }
  function rgb$4(r, g, b, opacity) {
    return arguments.length === 1 ? rgbConvert$4(r) : new Rgb$4(r, g, b, opacity == null ? 1 : opacity);
  }
  function Rgb$4(r, g, b, opacity) {
    this.r = +r;
    this.g = +g;
    this.b = +b;
    this.opacity = +opacity;
  }
  define$4(Rgb$4, rgb$4, extend$5(Color$4, {
    brighter: function brighter(k) {
      k = k == null ? _brighter$4 : Math.pow(_brighter$4, k);
      return new Rgb$4(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker$4 : Math.pow(_darker$4, k);
      return new Rgb$4(this.r * k, this.g * k, this.b * k, this.opacity);
    },
    rgb: function rgb() {
      return this;
    },
    displayable: function displayable() {
      return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
    },
    hex: rgb_formatHex$3,
    // Deprecated! Use color.formatHex.
    formatHex: rgb_formatHex$3,
    formatRgb: rgb_formatRgb$3,
    toString: rgb_formatRgb$3
  }));

  function rgb_formatHex$3() {
    return "#" + hex$3(this.r) + hex$3(this.g) + hex$3(this.b);
  }

  function rgb_formatRgb$3() {
    var a = this.opacity;
    a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
    return (a === 1 ? "rgb(" : "rgba(") + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.b) || 0)) + (a === 1 ? ")" : ", " + a + ")");
  }

  function hex$3(value) {
    value = Math.max(0, Math.min(255, Math.round(value) || 0));
    return (value < 16 ? "0" : "") + value.toString(16);
  }

  function hsla$4(h, s, l, a) {
    if (a <= 0) h = s = l = NaN;else if (l <= 0 || l >= 1) h = s = NaN;else if (s <= 0) h = NaN;
    return new Hsl$4(h, s, l, a);
  }

  function hslConvert$4(o) {
    if (o instanceof Hsl$4) return new Hsl$4(o.h, o.s, o.l, o.opacity);
    if (!(o instanceof Color$4)) o = color$4(o);
    if (!o) return new Hsl$4();
    if (o instanceof Hsl$4) return o;
    o = o.rgb();
    var r = o.r / 255,
        g = o.g / 255,
        b = o.b / 255,
        min = Math.min(r, g, b),
        max = Math.max(r, g, b),
        h = NaN,
        s = max - min,
        l = (max + min) / 2;

    if (s) {
      if (r === max) h = (g - b) / s + (g < b) * 6;else if (g === max) h = (b - r) / s + 2;else h = (r - g) / s + 4;
      s /= l < 0.5 ? max + min : 2 - max - min;
      h *= 60;
    } else {
      s = l > 0 && l < 1 ? 0 : h;
    }

    return new Hsl$4(h, s, l, o.opacity);
  }
  function hsl$4(h, s, l, opacity) {
    return arguments.length === 1 ? hslConvert$4(h) : new Hsl$4(h, s, l, opacity == null ? 1 : opacity);
  }

  function Hsl$4(h, s, l, opacity) {
    this.h = +h;
    this.s = +s;
    this.l = +l;
    this.opacity = +opacity;
  }

  define$4(Hsl$4, hsl$4, extend$5(Color$4, {
    brighter: function brighter(k) {
      k = k == null ? _brighter$4 : Math.pow(_brighter$4, k);
      return new Hsl$4(this.h, this.s, this.l * k, this.opacity);
    },
    darker: function darker(k) {
      k = k == null ? _darker$4 : Math.pow(_darker$4, k);
      return new Hsl$4(this.h, this.s, this.l * k, this.opacity);
    },
    rgb: function rgb() {
      var h = this.h % 360 + (this.h < 0) * 360,
          s = isNaN(h) || isNaN(this.s) ? 0 : this.s,
          l = this.l,
          m2 = l + (l < 0.5 ? l : 1 - l) * s,
          m1 = 2 * l - m2;
      return new Rgb$4(hsl2rgb$4(h >= 240 ? h - 240 : h + 120, m1, m2), hsl2rgb$4(h, m1, m2), hsl2rgb$4(h < 120 ? h + 240 : h - 120, m1, m2), this.opacity);
    },
    displayable: function displayable() {
      return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
    },
    formatHsl: function formatHsl() {
      var a = this.opacity;
      a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));
      return (a === 1 ? "hsl(" : "hsla(") + (this.h || 0) + ", " + (this.s || 0) * 100 + "%, " + (this.l || 0) * 100 + "%" + (a === 1 ? ")" : ", " + a + ")");
    }
  }));
  /* From FvD 13.37, CSS Color Module Level 3 */

  function hsl2rgb$4(h, m1, m2) {
    return (h < 60 ? m1 + (m2 - m1) * h / 60 : h < 180 ? m2 : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60 : m1) * 255;
  }

  var slice$2 = [].slice;

  var noabort = {};

  function Queue(size) {
    this._size = size;
    this._call = this._error = null;
    this._tasks = [];
    this._data = [];
    this._waiting = this._active = this._ended = this._start = 0; // inside a synchronous task callback?
  }

  Queue.prototype = queue.prototype = {
    constructor: Queue,
    defer: function defer(callback) {
      if (typeof callback !== "function") throw new Error("invalid callback");
      if (this._call) throw new Error("defer after await");
      if (this._error != null) return this;
      var t = slice$2.call(arguments, 1);
      t.push(callback);
      ++this._waiting, this._tasks.push(t);
      poke$1(this);
      return this;
    },
    abort: function abort() {
      if (this._error == null) _abort(this, new Error("abort"));
      return this;
    },
    "await": function _await(callback) {
      if (typeof callback !== "function") throw new Error("invalid callback");
      if (this._call) throw new Error("multiple await");

      this._call = function (error, results) {
        callback.apply(null, [error].concat(results));
      };

      maybeNotify(this);
      return this;
    },
    awaitAll: function awaitAll(callback) {
      if (typeof callback !== "function") throw new Error("invalid callback");
      if (this._call) throw new Error("multiple await");
      this._call = callback;
      maybeNotify(this);
      return this;
    }
  };

  function poke$1(q) {
    if (!q._start) {
      try {
        start$1(q);
      } // let the current task complete
      catch (e) {
        if (q._tasks[q._ended + q._active - 1]) _abort(q, e); // task errored synchronously
        else if (!q._data) throw e; // await callback errored synchronously
      }
    }
  }

  function start$1(q) {
    while (q._start = q._waiting && q._active < q._size) {
      var i = q._ended + q._active,
          t = q._tasks[i],
          j = t.length - 1,
          c = t[j];
      t[j] = end(q, i);
      --q._waiting, ++q._active;
      t = c.apply(null, t);
      if (!q._tasks[i]) continue; // task finished synchronously

      q._tasks[i] = t || noabort;
    }
  }

  function end(q, i) {
    return function (e, r) {
      if (!q._tasks[i]) return; // ignore multiple callbacks

      --q._active, ++q._ended;
      q._tasks[i] = null;
      if (q._error != null) return; // ignore secondary errors

      if (e != null) {
        _abort(q, e);
      } else {
        q._data[i] = r;
        if (q._waiting) poke$1(q);else maybeNotify(q);
      }
    };
  }

  function _abort(q, e) {
    var i = q._tasks.length,
        t;
    q._error = e; // ignore active callbacks

    q._data = undefined; // allow gc

    q._waiting = NaN; // prevent starting

    while (--i >= 0) {
      if (t = q._tasks[i]) {
        q._tasks[i] = null;

        if (t.abort) {
          try {
            t.abort();
          } catch (e) {
            /* ignore */
          }
        }
      }
    }

    q._active = NaN; // allow notification

    maybeNotify(q);
  }

  function maybeNotify(q) {
    if (!q._active && q._call) {
      var d = q._data;
      q._data = undefined; // allow gc

      q._call(q._error, d);
    }
  }

  function queue(concurrency) {
    if (concurrency == null) concurrency = Infinity;else if (!((concurrency = +concurrency) >= 1)) throw new Error("invalid concurrency");
    return new Queue(concurrency);
  }

  function constant$7 (x) {
    return function () {
      return x;
    };
  }

  function ZoomEvent(target, type, transform) {
    this.target = target;
    this.type = type;
    this.transform = transform;
  }

  function Transform(k, x, y) {
    this.k = k;
    this.x = x;
    this.y = y;
  }
  Transform.prototype = {
    constructor: Transform,
    scale: function scale(k) {
      return k === 1 ? this : new Transform(this.k * k, this.x, this.y);
    },
    translate: function translate(x, y) {
      return x === 0 & y === 0 ? this : new Transform(this.k, this.x + this.k * x, this.y + this.k * y);
    },
    apply: function apply(point) {
      return [point[0] * this.k + this.x, point[1] * this.k + this.y];
    },
    applyX: function applyX(x) {
      return x * this.k + this.x;
    },
    applyY: function applyY(y) {
      return y * this.k + this.y;
    },
    invert: function invert(location) {
      return [(location[0] - this.x) / this.k, (location[1] - this.y) / this.k];
    },
    invertX: function invertX(x) {
      return (x - this.x) / this.k;
    },
    invertY: function invertY(y) {
      return (y - this.y) / this.k;
    },
    rescaleX: function rescaleX(x) {
      return x.copy().domain(x.range().map(this.invertX, this).map(x.invert, x));
    },
    rescaleY: function rescaleY(y) {
      return y.copy().domain(y.range().map(this.invertY, this).map(y.invert, y));
    },
    toString: function toString() {
      return "translate(" + this.x + "," + this.y + ") scale(" + this.k + ")";
    }
  };
  var identity$8 = new Transform(1, 0, 0);
  transform$2.prototype = Transform.prototype;
  function transform$2(node) {
    while (!node.__zoom) {
      if (!(node = node.parentNode)) return identity$8;
    }

    return node.__zoom;
  }

  function nopropagation$1() {
    event$1.stopImmediatePropagation();
  }
  function noevent$2 () {
    event$1.preventDefault();
    event$1.stopImmediatePropagation();
  }

  function defaultFilter$1() {
    return !event$1.ctrlKey && !event$1.button;
  }

  function defaultExtent$1() {
    var e = this;

    if (e instanceof SVGElement) {
      e = e.ownerSVGElement || e;

      if (e.hasAttribute("viewBox")) {
        e = e.viewBox.baseVal;
        return [[e.x, e.y], [e.x + e.width, e.y + e.height]];
      }

      return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];
    }

    return [[0, 0], [e.clientWidth, e.clientHeight]];
  }

  function defaultTransform() {
    return this.__zoom || identity$8;
  }

  function defaultWheelDelta() {
    return -event$1.deltaY * (event$1.deltaMode === 1 ? 0.05 : event$1.deltaMode ? 1 : 0.002);
  }

  function defaultTouchable$1() {
    return navigator.maxTouchPoints || "ontouchstart" in this;
  }

  function defaultConstrain(transform, extent, translateExtent) {
    var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],
        dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],
        dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],
        dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];
    return transform.translate(dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1), dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1));
  }

  function zoom () {
    var filter = defaultFilter$1,
        extent = defaultExtent$1,
        constrain = defaultConstrain,
        wheelDelta = defaultWheelDelta,
        touchable = defaultTouchable$1,
        scaleExtent = [0, Infinity],
        translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],
        duration = 250,
        interpolate = interpolateZoom,
        listeners = dispatch("start", "zoom", "end"),
        touchstarting,
        touchending,
        touchDelay = 500,
        wheelDelay = 150,
        clickDistance2 = 0;

    function zoom(selection) {
      selection.property("__zoom", defaultTransform).on("wheel.zoom", wheeled).on("mousedown.zoom", mousedowned).on("dblclick.zoom", dblclicked).filter(touchable).on("touchstart.zoom", touchstarted).on("touchmove.zoom", touchmoved).on("touchend.zoom touchcancel.zoom", touchended).style("touch-action", "none").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
    }

    zoom.transform = function (collection, transform, point) {
      var selection = collection.selection ? collection.selection() : collection;
      selection.property("__zoom", defaultTransform);

      if (collection !== selection) {
        schedule(collection, transform, point);
      } else {
        selection.interrupt().each(function () {
          gesture(this, arguments).start().zoom(null, typeof transform === "function" ? transform.apply(this, arguments) : transform).end();
        });
      }
    };

    zoom.scaleBy = function (selection, k, p) {
      zoom.scaleTo(selection, function () {
        var k0 = this.__zoom.k,
            k1 = typeof k === "function" ? k.apply(this, arguments) : k;
        return k0 * k1;
      }, p);
    };

    zoom.scaleTo = function (selection, k, p) {
      zoom.transform(selection, function () {
        var e = extent.apply(this, arguments),
            t0 = this.__zoom,
            p0 = p == null ? centroid(e) : typeof p === "function" ? p.apply(this, arguments) : p,
            p1 = t0.invert(p0),
            k1 = typeof k === "function" ? k.apply(this, arguments) : k;
        return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);
      }, p);
    };

    zoom.translateBy = function (selection, x, y) {
      zoom.transform(selection, function () {
        return constrain(this.__zoom.translate(typeof x === "function" ? x.apply(this, arguments) : x, typeof y === "function" ? y.apply(this, arguments) : y), extent.apply(this, arguments), translateExtent);
      });
    };

    zoom.translateTo = function (selection, x, y, p) {
      zoom.transform(selection, function () {
        var e = extent.apply(this, arguments),
            t = this.__zoom,
            p0 = p == null ? centroid(e) : typeof p === "function" ? p.apply(this, arguments) : p;
        return constrain(identity$8.translate(p0[0], p0[1]).scale(t.k).translate(typeof x === "function" ? -x.apply(this, arguments) : -x, typeof y === "function" ? -y.apply(this, arguments) : -y), e, translateExtent);
      }, p);
    };

    function scale(transform, k) {
      k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));
      return k === transform.k ? transform : new Transform(k, transform.x, transform.y);
    }

    function translate(transform, p0, p1) {
      var x = p0[0] - p1[0] * transform.k,
          y = p0[1] - p1[1] * transform.k;
      return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);
    }

    function centroid(extent) {
      return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];
    }

    function schedule(transition, transform, point) {
      transition.on("start.zoom", function () {
        gesture(this, arguments).start();
      }).on("interrupt.zoom end.zoom", function () {
        gesture(this, arguments).end();
      }).tween("zoom", function () {
        var that = this,
            args = arguments,
            g = gesture(that, args),
            e = extent.apply(that, args),
            p = point == null ? centroid(e) : typeof point === "function" ? point.apply(that, args) : point,
            w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),
            a = that.__zoom,
            b = typeof transform === "function" ? transform.apply(that, args) : transform,
            i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));
        return function (t) {
          if (t === 1) t = b; // Avoid rounding error on end.
          else {
              var l = i(t),
                  k = w / l[2];
              t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k);
            }
          g.zoom(null, t);
        };
      });
    }

    function gesture(that, args, clean) {
      return !clean && that.__zooming || new Gesture(that, args);
    }

    function Gesture(that, args) {
      this.that = that;
      this.args = args;
      this.active = 0;
      this.extent = extent.apply(that, args);
      this.taps = 0;
    }

    Gesture.prototype = {
      start: function start() {
        if (++this.active === 1) {
          this.that.__zooming = this;
          this.emit("start");
        }

        return this;
      },
      zoom: function zoom(key, transform) {
        if (this.mouse && key !== "mouse") this.mouse[1] = transform.invert(this.mouse[0]);
        if (this.touch0 && key !== "touch") this.touch0[1] = transform.invert(this.touch0[0]);
        if (this.touch1 && key !== "touch") this.touch1[1] = transform.invert(this.touch1[0]);
        this.that.__zoom = transform;
        this.emit("zoom");
        return this;
      },
      end: function end() {
        if (--this.active === 0) {
          delete this.that.__zooming;
          this.emit("end");
        }

        return this;
      },
      emit: function emit(type) {
        customEvent(new ZoomEvent(zoom, type, this.that.__zoom), listeners.apply, listeners, [type, this.that, this.args]);
      }
    };

    function wheeled() {
      if (!filter.apply(this, arguments)) return;
      var g = gesture(this, arguments),
          t = this.__zoom,
          k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),
          p = mouse(this); // If the mouse is in the same location as before, reuse it.
      // If there were recent wheel events, reset the wheel idle timeout.

      if (g.wheel) {
        if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {
          g.mouse[1] = t.invert(g.mouse[0] = p);
        }

        clearTimeout(g.wheel);
      } // If this wheel event wont trigger a transform change, ignore it.
      else if (t.k === k) return; // Otherwise, capture the mouse point and location at the start.
        else {
            g.mouse = [p, t.invert(p)];
            interrupt(this);
            g.start();
          }

      noevent$2();
      g.wheel = setTimeout(wheelidled, wheelDelay);
      g.zoom("mouse", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));

      function wheelidled() {
        g.wheel = null;
        g.end();
      }
    }

    function mousedowned() {
      if (touchending || !filter.apply(this, arguments)) return;
      var g = gesture(this, arguments, true),
          v = _select(event$1.view).on("mousemove.zoom", mousemoved, true).on("mouseup.zoom", mouseupped, true),
          p = mouse(this),
          x0 = event$1.clientX,
          y0 = event$1.clientY;
      dragDisable(event$1.view);
      nopropagation$1();
      g.mouse = [p, this.__zoom.invert(p)];
      interrupt(this);
      g.start();

      function mousemoved() {
        noevent$2();

        if (!g.moved) {
          var dx = event$1.clientX - x0,
              dy = event$1.clientY - y0;
          g.moved = dx * dx + dy * dy > clickDistance2;
        }

        g.zoom("mouse", constrain(translate(g.that.__zoom, g.mouse[0] = mouse(g.that), g.mouse[1]), g.extent, translateExtent));
      }

      function mouseupped() {
        v.on("mousemove.zoom mouseup.zoom", null);
        yesdrag(event$1.view, g.moved);
        noevent$2();
        g.end();
      }
    }

    function dblclicked() {
      if (!filter.apply(this, arguments)) return;
      var t0 = this.__zoom,
          p0 = mouse(this),
          p1 = t0.invert(p0),
          k1 = t0.k * (event$1.shiftKey ? 0.5 : 2),
          t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, arguments), translateExtent);
      noevent$2();
      if (duration > 0) _select(this).transition().duration(duration).call(schedule, t1, p0);else _select(this).call(zoom.transform, t1);
    }

    function touchstarted() {
      if (!filter.apply(this, arguments)) return;
      var touches = event$1.touches,
          n = touches.length,
          g = gesture(this, arguments, event$1.changedTouches.length === n),
          started,
          i,
          t,
          p;
      nopropagation$1();

      for (i = 0; i < n; ++i) {
        t = touches[i], p = touch(this, touches, t.identifier);
        p = [p, this.__zoom.invert(p), t.identifier];
        if (!g.touch0) g.touch0 = p, started = true, g.taps = 1 + !!touchstarting;else if (!g.touch1 && g.touch0[2] !== p[2]) g.touch1 = p, g.taps = 0;
      }

      if (touchstarting) touchstarting = clearTimeout(touchstarting);

      if (started) {
        if (g.taps < 2) touchstarting = setTimeout(function () {
          touchstarting = null;
        }, touchDelay);
        interrupt(this);
        g.start();
      }
    }

    function touchmoved() {
      if (!this.__zooming) return;
      var g = gesture(this, arguments),
          touches = event$1.changedTouches,
          n = touches.length,
          i,
          t,
          p,
          l;
      noevent$2();
      if (touchstarting) touchstarting = clearTimeout(touchstarting);
      g.taps = 0;

      for (i = 0; i < n; ++i) {
        t = touches[i], p = touch(this, touches, t.identifier);
        if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;
      }

      t = g.that.__zoom;

      if (g.touch1) {
        var p0 = g.touch0[0],
            l0 = g.touch0[1],
            p1 = g.touch1[0],
            l1 = g.touch1[1],
            dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,
            dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;
        t = scale(t, Math.sqrt(dp / dl));
        p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];
        l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];
      } else if (g.touch0) p = g.touch0[0], l = g.touch0[1];else return;

      g.zoom("touch", constrain(translate(t, p, l), g.extent, translateExtent));
    }

    function touchended() {
      if (!this.__zooming) return;
      var g = gesture(this, arguments),
          touches = event$1.changedTouches,
          n = touches.length,
          i,
          t;
      nopropagation$1();
      if (touchending) clearTimeout(touchending);
      touchending = setTimeout(function () {
        touchending = null;
      }, touchDelay);

      for (i = 0; i < n; ++i) {
        t = touches[i];
        if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;
      }

      if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;
      if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);else {
        g.end(); // If this was a dbltap, reroute to the (optional) dblclick.zoom handler.

        if (g.taps === 2) {
          var p = _select(this).on("dblclick.zoom");
          if (p) p.apply(this, arguments);
        }
      }
    }

    zoom.wheelDelta = function (_) {
      return arguments.length ? (wheelDelta = typeof _ === "function" ? _ : constant$7(+_), zoom) : wheelDelta;
    };

    zoom.filter = function (_) {
      return arguments.length ? (filter = typeof _ === "function" ? _ : constant$7(!!_), zoom) : filter;
    };

    zoom.touchable = function (_) {
      return arguments.length ? (touchable = typeof _ === "function" ? _ : constant$7(!!_), zoom) : touchable;
    };

    zoom.extent = function (_) {
      return arguments.length ? (extent = typeof _ === "function" ? _ : constant$7([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;
    };

    zoom.scaleExtent = function (_) {
      return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];
    };

    zoom.translateExtent = function (_) {
      return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];
    };

    zoom.constrain = function (_) {
      return arguments.length ? (constrain = _, zoom) : constrain;
    };

    zoom.duration = function (_) {
      return arguments.length ? (duration = +_, zoom) : duration;
    };

    zoom.interpolate = function (_) {
      return arguments.length ? (interpolate = _, zoom) : interpolate;
    };

    zoom.on = function () {
      var value = listeners.on.apply(listeners, arguments);
      return value === listeners ? zoom : value;
    };

    zoom.clickDistance = function (_) {
      return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);
    };

    return zoom;
  }

  var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

  function commonjsRequire () {
  	throw new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');
  }

  function createCommonjsModule(fn, module) {
  	return module = { exports: {} }, fn(module, module.exports), module.exports;
  }

  var lrucache = createCommonjsModule(function (module) {

    (function (root, factory) {

      {
        module.exports = factory();
      }
    })((typeof window === "undefined" ? "undefined" : _typeof(window)) === 'object' ? window : commonjsGlobal, function () {

      var undef = void 0;

      function LRUCache(capacity) {
        if (!(this instanceof LRUCache)) return new LRUCache(capacity);
        this._LRUCacheState = new CacheState(capacity);
      }

      var proto = LRUCache.prototype;

      proto.get = function (key) {
        var state = this._LRUCacheState;
        var lruEntry = state.hash[key];
        if (!lruEntry) return;
        refresh(state.linkedList, lruEntry);
        return state.data[key];
      };

      proto.set = function (key, value) {
        var state = this._LRUCacheState;
        var lruEntry = state.hash[key];
        if (value === undef) return this;

        if (!lruEntry) {
          state.hash[key] = new LRUEntry(key);
          state.linkedList.length += 1;
          lruEntry = state.hash[key];
        }

        refresh(state.linkedList, lruEntry);
        state.data[key] = value;
        if (state.linkedList.length > state.capacity) this.remove(state.linkedList.end.key);
        return this;
      };

      proto.update = function (key, parseFn) {
        if (this.has(key)) this.set(key, parseFn(this.get(key)));
        return this;
      };

      proto.remove = function (key) {
        var state = this._LRUCacheState;
        var lruEntry = state.hash[key];
        if (!lruEntry) return this;
        if (lruEntry === state.linkedList.head) state.linkedList.head = lruEntry.p;
        if (lruEntry === state.linkedList.end) state.linkedList.end = lruEntry.n;
        link(lruEntry.n, lruEntry.p);
        delete state.hash[key];
        delete state.data[key];
        state.linkedList.length -= 1;
        return this;
      };

      proto.removeAll = function () {
        this._LRUCacheState = new CacheState(this._LRUCacheState.capacity);
        return this;
      };

      proto.info = function () {
        var state = this._LRUCacheState;
        return {
          capacity: state.capacity,
          length: state.linkedList.length
        };
      };

      proto.keys = function () {
        var keys = [];
        var lruEntry = this._LRUCacheState.linkedList.head;

        while (lruEntry) {
          keys.push(lruEntry.key);
          lruEntry = lruEntry.p;
        }

        return keys;
      };

      proto.has = function (key) {
        return !!this._LRUCacheState.hash[key];
      };

      proto.staleKey = function () {
        return this._LRUCacheState.linkedList.end && this._LRUCacheState.linkedList.end.key;
      };

      proto.popStale = function () {
        var staleKey = this.staleKey();
        if (!staleKey) return null;
        var stale = [staleKey, this._LRUCacheState.data[staleKey]];
        this.remove(staleKey);
        return stale;
      };

      function CacheState(capacity) {
        this.capacity = capacity > 0 ? +capacity : Number.MAX_SAFE_INTEGER || Number.MAX_VALUE;
        this.data = Object.create ? Object.create(null) : {};
        this.hash = Object.create ? Object.create(null) : {};
        this.linkedList = new LinkedList();
      }

      function LinkedList() {
        this.length = 0;
        this.head = null;
        this.end = null;
      }

      function LRUEntry(key) {
        this.key = key;
        this.p = null;
        this.n = null;
      } // getputkeyhead


      function refresh(linkedList, entry) {
        if (entry === linkedList.head) return;

        if (!linkedList.end) {
          linkedList.end = entry;
        } else if (linkedList.end === entry) {
          linkedList.end = entry.n;
        }

        link(entry.n, entry.p);
        link(entry, linkedList.head);
        linkedList.head = entry;
        linkedList.head.n = null;
      } // 


      function link(nextEntry, prevEntry) {
        if (nextEntry === prevEntry) return;
        if (nextEntry) nextEntry.p = prevEntry;
        if (prevEntry) prevEntry.n = nextEntry;
      }

      return LRUCache;
    });
  });

  function _typeof$j(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$j = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$j = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$j(obj);
  }

  function _classCallCheck$h(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$d(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$d(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$d(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$d(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$f(self, call) {
    if (call && (_typeof$j(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$f(self);
  }

  function _assertThisInitialized$f(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$f(o) {
    _getPrototypeOf$f = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$f(o);
  }

  function _inherits$f(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$f(subClass, superClass);
  }

  function _setPrototypeOf$f(o, p) {
    _setPrototypeOf$f = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$f(o, p);
  }
  /**
      @class Button
      @extends external:BaseClass
      @desc Creates a set of HTML radio input elements.
  */

  var Button =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$f(Button, _BaseClass);
    /**
        @memberof Button
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Button() {
      var _this;

      _classCallCheck$h(this, Button);

      _this = _possibleConstructorReturn$f(this, _getPrototypeOf$f(Button).call(this));
      _this._buttonStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "14px",
        "margin": "0 5px"
      };
      _this._data = [];
      _this._text = accessor("text");
      _this._value = accessor("value");
      return _this;
    }
    /**
        @memberof Button
        @desc Renders the element to the page.
        @chainable
    */


    _createClass$d(Button, [{
      key: "render",
      value: function render() {
        var _this2 = this;

        if (this._container === void 0) this.container(_select("body").append("div").node());

        var container = this._container.selectAll("div#d3plus-Form-".concat(this._uuid)).data([0]);

        var svg = this._container.node().tagName.toLowerCase() === "foreignobject";
        container = container.enter().append(svg ? "xhtml:div" : "div").attr("id", "d3plus-Form-".concat(this._uuid)).attr("class", "d3plus-Form d3plus-Form-Button").merge(container);
        var button = container.selectAll("button").data(this._data, function (d, i) {
          return _this2._value(d, i);
        });
        button.exit().remove();
        button = button.enter().append("button").attr("class", "d3plus-Button").attr("type", "button").merge(button).call(stylize, this._buttonStyle).html(function (d, i) {
          return _this2._text(d, i);
        });

        for (var event in this._on) {
          if ({}.hasOwnProperty.call(this._on, event)) button.on(event, this._on[event]);
        }

        return this;
      }
      /**
          @memberof Button
          @desc Sets the css styles for the <input type="radio"> elements.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "buttonStyle",
      value: function buttonStyle(_) {
        return arguments.length ? (this._buttonStyle = _, this) : this._buttonStyle;
      }
      /**
          @memberof Button
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element, which is `undefined` by default.
          @param {String|HTMLElement} [*selector*]
          @chainable
      */

    }, {
      key: "container",
      value: function container(_) {
        return arguments.length ? (this._container = _select(_), this) : this._container;
      }
      /**
          @memberof Radio
          @desc Defines the array of values to be created as <button> tags. If no value is passed, the current array is returned.
          @param {Array} [*value* = []]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof Button
          @desc Sets the inner text for each <button> element.
          @param {Function|String} [*value* = function(d) { return d.text; }]
          @chainable
      */

    }, {
      key: "text",
      value: function text(_) {
        return arguments.length ? (this._text = typeof _ === "function" ? _ : constant$3(_), this) : this._text;
      }
      /**
          @memberof Button
          @desc Sets the value for each <button> element.
          @param {Function} [*value* = function(d) { return d.value; }]
          @chainable
      */

    }, {
      key: "value",
      value: function value(_) {
        return arguments.length ? (this._value = _, this) : this._value;
      }
    }]);

    return Button;
  }(BaseClass);

  function _typeof$k(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$k = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$k = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$k(obj);
  }

  function _classCallCheck$i(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$e(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$e(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$e(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$e(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$g(self, call) {
    if (call && (_typeof$k(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$g(self);
  }

  function _assertThisInitialized$g(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$g(o) {
    _getPrototypeOf$g = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$g(o);
  }

  function _inherits$g(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$g(subClass, superClass);
  }

  function _setPrototypeOf$g(o, p) {
    _setPrototypeOf$g = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$g(o, p);
  }
  /**
      @class Radio
      @extends external:BaseClass
      @desc Creates a set of HTML radio input elements.
  */

  var Radio =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$g(Radio, _BaseClass);
    /**
        @memberof Radio
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Radio() {
      var _this;

      _classCallCheck$i(this, Radio);

      _this = _possibleConstructorReturn$g(this, _getPrototypeOf$g(Radio).call(this));
      _this._labelStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "14px",
        "padding-right": "5px"
      };
      _this._legendStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "14px",
        "padding-right": "5px"
      };
      _this._options = [];
      _this._radioStyle = {
        "margin-right": "10px"
      };
      _this._text = accessor("text");
      _this._value = accessor("value");
      return _this;
    }
    /**
        @memberof Radio
        @desc Renders the element to the page.
        @chainable
    */


    _createClass$e(Radio, [{
      key: "render",
      value: function render() {
        var _this2 = this;

        if (this._container === void 0) this.container(_select("body").append("div").node());
        var that = this;

        var container = this._container.selectAll("div#d3plus-Form-".concat(this._uuid)).data([0]);

        var svg = this._container.node().tagName.toLowerCase() === "foreignobject";
        container = container.enter().append(svg ? "xhtml:div" : "div").attr("id", "d3plus-Form-".concat(this._uuid)).attr("class", "d3plus-Form d3plus-Form-Radio").merge(container);
        var radios = container.selectAll("label").data(this._options, function (d, i) {
          return _this2._value(d, i);
        });
        radios.exit().each(function () {
          _select(this.nextSibling).remove();
        }).remove();
        radios = radios.enter().append("label").attr("class", "d3plus-Label").attr("for", function (d, i) {
          return "".concat(_this2._uuid, "-").concat(_this2._value(d, i));
        }).each(function (d, i) {
          var input = document.createElement("input");
          input.setAttribute("type", "radio");
          input.setAttribute("name", "d3plus-Radio-".concat(that._uuid));
          input.setAttribute("id", "".concat(that._uuid, "-").concat(that._value(d, i)));
          input.setAttribute("value", that._value(d, i));
          this.parentNode.insertBefore(input, this.nextSibling);
        }).merge(radios).call(stylize, this._labelStyle).html(function (d, i) {
          return _this2._text(d, i);
        }).each(function (d, i) {
          var checked = that._checked === void 0 ? !i : "".concat(that._value(d, i)) === "".concat(that._checked);
          _select(this).classed("active", checked).style("cursor", checked ? "default" : "pointer");
          var input = _select(this.nextSibling).property("checked", checked).call(stylize, that._radioStyle).style("cursor", checked ? "default" : "pointer").on("change.d3plus", function () {
            that.checked(this.value);
            radios.each(function (d, i) {
              var checked = "".concat(that._value(d, i)) === "".concat(that._checked);
              _select(this).classed("active", checked).style("cursor", checked ? "default" : "pointer");
              _select(this.nextSibling).style("cursor", checked ? "default" : "pointer");
            });
          });

          for (var event in that._on) {
            if ({}.hasOwnProperty.call(that._on, event)) input.on(event, that._on[event]);
          }
        });
        var legend = container.selectAll("legend#d3plus-Legend-".concat(this._uuid)).data(this._legend ? [0] : []);
        legend.exit().remove();
        legend.enter().insert("legend", ".d3plus-Label").attr("id", "d3plus-Legend-".concat(this._uuid)).attr("class", "d3plus-Legend").merge(legend).call(stylize, this._legendStyle).html(this._legend);
        return this;
      }
      /**
          @memberof Radio
          @desc Defines the checked input.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "checked",
      value: function checked(_) {
        return arguments.length ? (this._checked = _, this) : this._checked;
      }
      /**
          @memberof Radio
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element, which is `undefined` by default.
          @param {String|HTMLElement} [*selector*]
          @chainable
      */

    }, {
      key: "container",
      value: function container(_) {
        return arguments.length ? (this._container = _select(_), this) : this._container;
      }
      /**
          @memberof Radio
          @desc Sets the css styles for the <label> element.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "labelStyle",
      value: function labelStyle(_) {
        return arguments.length ? (this._labelStyle = _, this) : this._labelStyle;
      }
      /**
          @memberof Radio
          @desc Creates a <legend> tag for the <select> element.
          @param {String} [*value*]
          @chainable
      */

    }, {
      key: "legend",
      value: function legend(_) {
        return arguments.length ? (this._legend = _, this) : this._legend;
      }
      /**
          @memberof Radio
          @desc Sets the css styles for the <legend> element.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "legendStyle",
      value: function legendStyle(_) {
        return arguments.length ? (this._legendStyle = _, this) : this._legendStyle;
      }
      /**
          @memberof Radio
          @desc Defines the array of values to be used as <option> tags inside of the <select> element. If no value is passed, the current array is returned.
          @param {Array} [*value* = []]
          @chainable
      */

    }, {
      key: "options",
      value: function options(_) {
        return arguments.length ? (this._options = _, this) : this._options;
      }
      /**
          @memberof Radio
          @desc Sets the css styles for the <input type="radio"> elements.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "radioStyle",
      value: function radioStyle(_) {
        return arguments.length ? (this._radioStyle = _, this) : this._radioStyle;
      }
      /**
          @memberof Radio
          @desc Sets the inner text for each <option> element.
          @param {Function|String} [*value* = function(d) { return d.text; }]
          @chainable
      */

    }, {
      key: "text",
      value: function text(_) {
        return arguments.length ? (this._text = typeof _ === "function" ? _ : constant$3(_), this) : this._text;
      }
      /**
          @memberof Radio
          @desc Sets the value for each <option> element.
          @param {Function} [*value* = function(d) { return d.value; }]
          @chainable
      */

    }, {
      key: "value",
      value: function value(_) {
        return arguments.length ? (this._value = _, this) : this._value;
      }
    }]);

    return Radio;
  }(BaseClass);

  function _typeof$l(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$l = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$l = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$l(obj);
  }

  function _classCallCheck$j(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$f(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$f(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$f(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$f(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$h(self, call) {
    if (call && (_typeof$l(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$h(self);
  }

  function _assertThisInitialized$h(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$h(o) {
    _getPrototypeOf$h = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$h(o);
  }

  function _inherits$h(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$h(subClass, superClass);
  }

  function _setPrototypeOf$h(o, p) {
    _setPrototypeOf$h = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$h(o, p);
  }
  /**
      @class Select
      @extends external:BaseClass
      @desc Creates an HTML select element.
  */

  var Select =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$h(Select, _BaseClass);
    /**
        @memberof Select
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Select() {
      var _this;

      _classCallCheck$j(this, Select);

      _this = _possibleConstructorReturn$h(this, _getPrototypeOf$h(Select).call(this));
      _this._labelStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "14px",
        "margin-right": "5px"
      };
      _this._options = [];
      _this._optionStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "14px"
      };
      _this._selectStyle = {
        "background": "#fafafa",
        "border": "1px solid #ccc",
        "border-radius": "0",
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "14px",
        "outline": "0",
        "padding": "3px 5px 4px"
      };
      _this._text = accessor("text");
      _this._value = accessor("value");
      return _this;
    }
    /**
        @memberof Select
        @desc Renders the element to the page.
        @chainable
    */


    _createClass$f(Select, [{
      key: "render",
      value: function render() {
        var _this2 = this;

        if (this._container === void 0) this.container(select("body").append("div").node());
        var that = this;

        var container = this._container.selectAll("div#d3plus-Form-".concat(this._uuid)).data([0]);

        var svg = this._container.node().tagName.toLowerCase() === "foreignobject";
        container = container.enter().append(svg ? "xhtml:div" : "div").attr("id", "d3plus-Form-".concat(this._uuid)).attr("class", "d3plus-Form d3plus-Form-Select").merge(container);
        var select = container.selectAll("select#d3plus-Select-".concat(this._uuid)).data([0]);
        select = select.enter().append("select").attr("id", "d3plus-Select-".concat(this._uuid)).attr("class", "d3plus-Select").merge(select).call(stylize, this._selectStyle).on("change.d3plus", function () {
          that.selected(this.value);
        });

        for (var event in this._on) {
          if ({}.hasOwnProperty.call(this._on, event)) select.on(event, this._on[event]);
        }

        var options = select.selectAll("option").data(this._options, function (d, i) {
          return _this2._value(d, i);
        });
        options.exit().remove();
        options.enter().append("option").attr("class", "d3plus-Option").merge(options).call(stylize, this._optionStyle).attr("value", function (d, i) {
          return _this2._value(d, i);
        }).html(function (d, i) {
          return _this2._text(d, i);
        }).property("selected", function (d, i) {
          return _this2._selected === void 0 ? !i : "".concat(_this2._value(d, i)) === "".concat(_this2._selected);
        });
        var label = container.selectAll("label#d3plus-Label-".concat(this._uuid)).data(this._label ? [0] : []);
        label.exit().remove();
        label.enter().insert("label", "#d3plus-Select-".concat(this._uuid)).attr("id", "d3plus-Label-".concat(this._uuid)).attr("class", "d3plus-Label").attr("for", "d3plus-Select-".concat(this._uuid)).merge(label).call(stylize, this._labelStyle).html(this._label);
        return this;
      }
      /**
          @memberof Select
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element, which is `undefined` by default.
          @param {String|HTMLElement} [*selector*]
          @chainable
      */

    }, {
      key: "container",
      value: function container(_) {
        return arguments.length ? (this._container = _select(_), this) : this._container;
      }
      /**
          @memberof Select
          @desc Creates a <label> tag for the <select> element.
          @param {String} [*value*]
          @chainable
      */

    }, {
      key: "label",
      value: function label(_) {
        return arguments.length ? (this._label = _, this) : this._label;
      }
      /**
          @memberof Select
          @desc Sets the css styles for the <label> element.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "labelStyle",
      value: function labelStyle(_) {
        return arguments.length ? (this._labelStyle = _, this) : this._labelStyle;
      }
      /**
          @memberof Select
          @desc Defines the array of values to be used as <option> tags inside of the <select> element. If no value is passed, the current array is returned.
          @param {Array} [*value* = []]
          @chainable
      */

    }, {
      key: "options",
      value: function options(_) {
        return arguments.length ? (this._options = _, this) : this._options;
      }
      /**
          @memberof Select
          @desc Sets the css styles for the <option> elements.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "optionStyle",
      value: function optionStyle(_) {
        return arguments.length ? (this._optionStyle = _, this) : this._optionStyle;
      }
      /**
          @memberof Select
          @desc Defines the selected option.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "selected",
      value: function selected(_) {
        return arguments.length ? (this._selected = _, this) : this._selected;
      }
      /**
          @memberof Select
          @desc Sets the css styles for the <select> element.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "selectStyle",
      value: function selectStyle(_) {
        return arguments.length ? (this._selectStyle = _, this) : this._selectStyle;
      }
      /**
          @memberof Select
          @desc Sets the inner text for each <option> element.
          @param {Function|String} [*value* = function(d) { return d.text; }]
          @chainable
      */

    }, {
      key: "text",
      value: function text(_) {
        return arguments.length ? (this._text = typeof _ === "function" ? _ : constant$3(_), this) : this._text;
      }
      /**
          @memberof Select
          @desc Sets the value for each <option> element.
          @param {Function} [*value* = function(d) { return d.value; }]
          @chainable
      */

    }, {
      key: "value",
      value: function value(_) {
        return arguments.length ? (this._value = _, this) : this._value;
      }
    }]);

    return Select;
  }(BaseClass);

  /**
      @desc Sort an array of numbers by their numeric value, ensuring that the array is not changed in place.

  This is necessary because the default behavior of .sort in JavaScript is to sort arrays as string values

  [1, 10, 12, 102, 20].sort()
  // output
  [1, 10, 102, 12, 20]

      @param {Array<number>} array input array
      @return {Array<number>} sorted array
      @private
      @example
  numericSort([3, 2, 1]) // => [1, 2, 3]
  */
  function numericSort(array) {
    return array.slice().sort(function (a, b) {
      return a - b;
    });
  }
  /**
      For a sorted input, counting the number of unique values is possible in constant time and constant memory. This is a simple implementation of the algorithm.

      Values are compared with `===`, so objects and non-primitive objects are not handled in any special way.
      @private
      @param {Array} input an array of primitive values.
      @returns {number} count of unique values
      @example
  uniqueCountSorted([1, 2, 3]); // => 3
  uniqueCountSorted([1, 1, 1]); // => 1
  */


  function uniqueCountSorted(input) {
    var lastSeenValue,
        uniqueValueCount = 0;

    for (var i = 0; i < input.length; i++) {
      if (i === 0 || input[i] !== lastSeenValue) {
        lastSeenValue = input[i];
        uniqueValueCount++;
      }
    }

    return uniqueValueCount;
  }
  /**
      Create a new column x row matrix.
      @private
      @param {number} columns
      @param {number} rows
      @return {Array<Array<number>>} matrix
      @example
  makeMatrix(10, 10);
  */


  function makeMatrix(columns, rows) {
    var matrix = [];

    for (var i = 0; i < columns; i++) {
      var column = [];

      for (var j = 0; j < rows; j++) {
        column.push(0);
      }

      matrix.push(column);
    }

    return matrix;
  }
  /**
      Generates incrementally computed values based on the sums and sums of squares for the data array
      @private
      @param {number} j
      @param {number} i
      @param {Array<number>} sums
      @param {Array<number>} sumsOfSquares
      @return {number}
      @example
  ssq(0, 1, [-1, 0, 2], [1, 1, 5]);
  */


  function ssq(j, i, sums, sumsOfSquares) {
    var sji; // s(j, i)

    if (j > 0) {
      var muji = (sums[i] - sums[j - 1]) / (i - j + 1); // mu(j, i)

      sji = sumsOfSquares[i] - sumsOfSquares[j - 1] - (i - j + 1) * muji * muji;
    } else sji = sumsOfSquares[i] - sums[i] * sums[i] / (i + 1);

    if (sji < 0) return 0;
    return sji;
  }
  /**
      Function that recursively divides and conquers computations for cluster j
      @private
      @param {number} iMin Minimum index in cluster to be computed
      @param {number} iMax Maximum index in cluster to be computed
      @param {number} cluster Index of the cluster currently being computed
      @param {Array<Array<number>>} matrix
      @param {Array<Array<number>>} backtrackMatrix
      @param {Array<number>} sums
      @param {Array<number>} sumsOfSquares
  */


  function fillMatrixColumn(iMin, iMax, cluster, matrix, backtrackMatrix, sums, sumsOfSquares) {
    if (iMin > iMax) return; // Start at midpoint between iMin and iMax

    var i = Math.floor((iMin + iMax) / 2);
    matrix[cluster][i] = matrix[cluster - 1][i - 1];
    backtrackMatrix[cluster][i] = i;
    var jlow = cluster; // the lower end for j

    if (iMin > cluster) jlow = Math.max(jlow, backtrackMatrix[cluster][iMin - 1] || 0);
    jlow = Math.max(jlow, backtrackMatrix[cluster - 1][i] || 0);
    var jhigh = i - 1; // the upper end for j

    if (iMax < matrix.length - 1) jhigh = Math.min(jhigh, backtrackMatrix[cluster][iMax + 1] || 0);

    for (var j = jhigh; j >= jlow; --j) {
      var sji = ssq(j, i, sums, sumsOfSquares);
      if (sji + matrix[cluster - 1][jlow - 1] >= matrix[cluster][i]) break; // Examine the lower bound of the cluster border

      var sjlowi = ssq(jlow, i, sums, sumsOfSquares);
      var ssqjlow = sjlowi + matrix[cluster - 1][jlow - 1];

      if (ssqjlow < matrix[cluster][i]) {
        // Shrink the lower bound
        matrix[cluster][i] = ssqjlow;
        backtrackMatrix[cluster][i] = jlow;
      }

      jlow++;
      var ssqj = sji + matrix[cluster - 1][j - 1];

      if (ssqj < matrix[cluster][i]) {
        matrix[cluster][i] = ssqj;
        backtrackMatrix[cluster][i] = j;
      }
    }

    fillMatrixColumn(iMin, i - 1, cluster, matrix, backtrackMatrix, sums, sumsOfSquares);
    fillMatrixColumn(i + 1, iMax, cluster, matrix, backtrackMatrix, sums, sumsOfSquares);
  }
  /**
      Initializes the main matrices used in Ckmeans and kicks off the divide and conquer cluster computation strategy
      @private
      @param {Array<number>} data sorted array of values
      @param {Array<Array<number>>} matrix
      @param {Array<Array<number>>} backtrackMatrix
  */


  function fillMatrices(data, matrix, backtrackMatrix) {
    var nValues = matrix[0] ? matrix[0].length : 0; // Shift values by the median to improve numeric stability

    var shift = data[Math.floor(nValues / 2)]; // Cumulative sum and cumulative sum of squares for all values in data array

    var sums = [];
    var sumsOfSquares = []; // Initialize first column in matrix & backtrackMatrix

    for (var i = 0, shiftedValue = void 0; i < nValues; ++i) {
      shiftedValue = data[i] - shift;

      if (i === 0) {
        sums.push(shiftedValue);
        sumsOfSquares.push(shiftedValue * shiftedValue);
      } else {
        sums.push(sums[i - 1] + shiftedValue);
        sumsOfSquares.push(sumsOfSquares[i - 1] + shiftedValue * shiftedValue);
      } // Initialize for cluster = 0


      matrix[0][i] = ssq(0, i, sums, sumsOfSquares);
      backtrackMatrix[0][i] = 0;
    } // Initialize the rest of the columns


    for (var cluster = 1; cluster < matrix.length; ++cluster) {
      var iMin = nValues - 1;
      if (cluster < matrix.length - 1) iMin = cluster;
      fillMatrixColumn(iMin, nValues - 1, cluster, matrix, backtrackMatrix, sums, sumsOfSquares);
    }
  }
  /**
      @desc Ported to ES6 from the excellent [simple-statistics](https://github.com/simple-statistics/simple-statistics) packages.

  Ckmeans clustering is an improvement on heuristic-based clustering approaches like Jenks. The algorithm was developed in [Haizhou Wang and Mingzhou Song](http://journal.r-project.org/archive/2011-2/RJournal_2011-2_Wang+Song.pdf) as a [dynamic programming](https://en.wikipedia.org/wiki/Dynamic_programming) approach to the problem of clustering numeric data into groups with the least within-group sum-of-squared-deviations.

  Minimizing the difference within groups - what Wang & Song refer to as `withinss`, or within sum-of-squares, means that groups are optimally homogenous within and the data is split into representative groups. This is very useful for visualization, where you may want to represent a continuous variable in discrete color or style groups. This function can provide groups that emphasize differences between data.

  Being a dynamic approach, this algorithm is based on two matrices that store incrementally-computed values for squared deviations and backtracking indexes.

  This implementation is based on Ckmeans 3.4.6, which introduced a new divide and conquer approach that improved runtime from O(kn^2) to O(kn log(n)).

  Unlike the [original implementation](https://cran.r-project.org/web/packages/Ckmeans.1d.dp/index.html), this implementation does not include any code to automatically determine the optimal number of clusters: this information needs to be explicitly provided.

  ### References
  _Ckmeans.1d.dp: Optimal k-means Clustering in One Dimension by Dynamic
  Programming_ Haizhou Wang and Mingzhou Song ISSN 2073-4859 from The R Journal Vol. 3/2, December 2011
      @param {Array<number>} data input data, as an array of number values
      @param {number} nClusters number of desired classes. This cannot be greater than the number of values in the data array.
      @returns {Array<Array<number>>} clustered input
      @example
  ckmeans([-1, 2, -1, 2, 4, 5, 6, -1, 2, -1], 3);
  // The input, clustered into groups of similar numbers.
  //= [[-1, -1, -1, -1], [2, 2, 2], [4, 5, 6]]);
  */


  function ckmeans (data, nClusters) {
    if (nClusters > data.length) {
      throw new Error("Cannot generate more classes than there are data values");
    }

    var sorted = numericSort(data); // we'll use this as the maximum number of clusters

    var uniqueCount = uniqueCountSorted(sorted); // if all of the input values are identical, there's one cluster with all of the input in it.

    if (uniqueCount === 1) {
      return [sorted];
    }

    var backtrackMatrix = makeMatrix(nClusters, sorted.length),
        matrix = makeMatrix(nClusters, sorted.length); // This is a dynamic programming way to solve the problem of minimizing within-cluster sum of squares. It's similar to linear regression in this way, and this calculation incrementally computes the sum of squares that are later read.

    fillMatrices(sorted, matrix, backtrackMatrix); // The real work of Ckmeans clustering happens in the matrix generation: the generated matrices encode all possible clustering combinations, and once they're generated we can solve for the best clustering groups very quickly.

    var clusterRight = backtrackMatrix[0] ? backtrackMatrix[0].length - 1 : 0;
    var clusters = []; // Backtrack the clusters from the dynamic programming matrix. This starts at the bottom-right corner of the matrix (if the top-left is 0, 0), and moves the cluster target with the loop.

    for (var cluster = backtrackMatrix.length - 1; cluster >= 0; cluster--) {
      var clusterLeft = backtrackMatrix[cluster][clusterRight]; // fill the cluster from the sorted input by taking a slice of the array. the backtrack matrix makes this easy - it stores the indexes where the cluster should start and end.

      clusters[cluster] = sorted.slice(clusterLeft, clusterRight + 1);
      if (cluster > 0) clusterRight = clusterLeft - 1;
    }

    return clusters;
  }

  function _typeof$m(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$m = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$m = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$m(obj);
  }

  function _classCallCheck$k(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$g(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$g(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$g(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$g(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$i(self, call) {
    if (call && (_typeof$m(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$i(self);
  }

  function _assertThisInitialized$i(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$i(o) {
    _getPrototypeOf$i = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$i(o);
  }

  function _inherits$i(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$i(subClass, superClass);
  }

  function _setPrototypeOf$i(o, p) {
    _setPrototypeOf$i = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$i(o, p);
  }
  /**
      @class Legend
      @extends external:BaseClass
      @desc Creates an SVG scale based on an array of data. If *data* is specified, immediately draws based on the specified array and returns the current class instance. If *data* is not specified on instantiation, it can be passed/updated after instantiation using the [data](#shape.data) method.
  */

  var Legend =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$i(Legend, _BaseClass);
    /**
        @memberof Legend
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Legend() {
      var _this;

      _classCallCheck$k(this, Legend);

      _this = _possibleConstructorReturn$i(this, _getPrototypeOf$i(Legend).call(this));
      _this._align = "center";
      _this._data = [];
      _this._direction = "row";
      _this._duration = 600;
      _this._height = 200;
      _this._id = accessor("id");
      _this._label = accessor("id");
      _this._lineData = [];
      _this._outerBounds = {
        width: 0,
        height: 0,
        x: 0,
        y: 0
      };
      _this._padding = 5;
      _this._shape = constant$3("Rect");
      _this._shapes = [];
      _this._shapeConfig = {
        duration: _this._duration,
        fill: accessor("color"),
        height: constant$3(10),
        hitArea: function hitArea(dd, i) {
          var d = _this._lineData[i],
              h = max([d.height, d.shapeHeight]);
          return {
            width: d.width + d.shapeWidth,
            height: h,
            x: -d.shapeWidth / 2,
            y: -h / 2
          };
        },
        labelBounds: function labelBounds(dd, i) {
          var d = _this._lineData[i];
          var x = d.shapeWidth;
          if (d.shape === "Circle") x -= d.shapeR;
          var height = max([d.shapeHeight, d.height]);
          return {
            width: d.width,
            height: height,
            x: x,
            y: -height / 2
          };
        },
        labelConfig: {
          fontColor: constant$3("#444"),
          fontFamily: new TextBox().fontFamily(),
          fontResize: false,
          fontSize: constant$3(10),
          verticalAlign: "middle"
        },
        opacity: 1,
        r: constant$3(5),
        width: constant$3(10),
        x: function x(d, i) {
          var datum = _this._lineData[i];
          var y = datum.y;
          var pad = _this._align === "left" || _this._align === "right" && _this._direction === "column" ? 0 : _this._align === "center" ? (_this._outerBounds.width - _this._rowWidth(_this._lineData.filter(function (l) {
            return y === l.y;
          }))) / 2 : _this._outerBounds.width - _this._rowWidth(_this._lineData.filter(function (l) {
            return y === l.y;
          }));

          var prevWords = _this._lineData.slice(0, i).filter(function (l) {
            return y === l.y;
          });

          return _this._rowWidth(prevWords) + _this._padding * (prevWords.length ? datum.sentence ? 2 : 1 : 0) + _this._outerBounds.x + datum.shapeWidth / 2 + pad;
        },
        y: function y(d, i) {
          var ld = _this._lineData[i];
          return ld.y + _this._titleHeight + _this._outerBounds.y + max(_this._lineData.filter(function (l) {
            return ld.y === l.y;
          }).map(function (l) {
            return l.height;
          }).concat(_this._data.map(function (l, x) {
            return _this._fetchConfig("height", l, x);
          }))) / 2;
        }
      };
      _this._titleClass = new TextBox();
      _this._titleConfig = {};
      _this._verticalAlign = "middle";
      _this._width = 400;
      return _this;
    }

    _createClass$g(Legend, [{
      key: "_fetchConfig",
      value: function _fetchConfig(key, d, i) {
        var val = this._shapeConfig[key] || this._shapeConfig.labelConfig[key];
        if (!val && key === "lineHeight") return this._fetchConfig("fontSize", d, i) * 1.4;
        return typeof val === "function" ? val(d, i) : val;
      }
    }, {
      key: "_rowHeight",
      value: function _rowHeight(row) {
        return max(row.map(function (d) {
          return d.height;
        }).concat(row.map(function (d) {
          return d.shapeHeight;
        }))) + this._padding;
      }
    }, {
      key: "_rowWidth",
      value: function _rowWidth(row) {
        var _this2 = this;

        return sum(row.map(function (d, i) {
          var p = _this2._padding * (i === row.length - 1 ? 0 : d.width ? 2 : 1);
          return d.shapeWidth + d.width + p;
        }));
      }
      /**
          @memberof Legend
          @desc Renders the current Legend to the page. If a *callback* is specified, it will be called once the legend is done drawing.
          @param {Function} [*callback* = undefined]
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        var _this3 = this;

        if (this._select === void 0) this.select(_select("body").append("svg").attr("width", "".concat(this._width, "px")).attr("height", "".concat(this._height, "px")).node()); // Shape <g> Group

        this._group = elem("g.d3plus-Legend", {
          parent: this._select
        });
        var availableHeight = this._height;
        this._titleHeight = 0;
        this._titleWidth = 0;

        if (this._title) {
          var f = this._titleConfig.fontFamily || this._titleClass.fontFamily()(),
              s = this._titleConfig.fontSize || this._titleClass.fontSize()();

          var lH = lH = this._titleConfig.lineHeight || this._titleClass.lineHeight();

          lH = lH ? lH() : s * 1.4;
          var res = textWrap().fontFamily(f).fontSize(s).lineHeight(lH).width(this._width).height(this._height)(this._title);
          this._titleHeight = lH + res.lines.length + this._padding;
          this._titleWidth = max(res.widths);
          availableHeight -= this._titleHeight;
        } // Calculate Text Sizes


        this._lineData = this._data.map(function (d, i) {
          var label = _this3._label(d, i);

          var shape = _this3._shape(d, i);

          var r = _this3._fetchConfig("r", d, i);

          var res = {
            data: d,
            i: i,
            id: _this3._id(d, i),
            shape: shape,
            shapeR: r,
            shapeWidth: shape === "Circle" ? r * 2 : _this3._fetchConfig("width", d, i),
            shapeHeight: shape === "Circle" ? r * 2 : _this3._fetchConfig("height", d, i),
            y: 0
          };

          if (!label) {
            res.sentence = false;
            res.words = [];
            res.height = 0;
            res.width = 0;
            return res;
          }

          var f = _this3._fetchConfig("fontFamily", d, i),
              lh = _this3._fetchConfig("lineHeight", d, i),
              s = _this3._fetchConfig("fontSize", d, i);

          var h = availableHeight - (_this3._data.length + 1) * _this3._padding,
              w = _this3._width;
          res = Object.assign(res, textWrap().fontFamily(f).fontSize(s).lineHeight(lh).width(w).height(h)(label));
          res.width = Math.ceil(max(res.lines.map(function (t) {
            return textWidth(t, {
              "font-family": f,
              "font-size": s
            });
          }))) + s * 0.75;
          res.height = Math.ceil(res.lines.length * (lh + 1));
          res.og = {
            height: res.height,
            width: res.width
          };
          res.f = f;
          res.s = s;
          res.lh = lh;
          return res;
        });
        var spaceNeeded;
        var availableWidth = this._width - this._padding * 2;
        spaceNeeded = this._rowWidth(this._lineData);

        if (this._direction === "column" || spaceNeeded > availableWidth) {
          var lines = 1,
              newRows = [];
          var maxLines = max(this._lineData.map(function (d) {
            return d.words.length;
          }));

          this._wrapLines = function () {
            var _this4 = this;

            lines++;
            if (lines > maxLines) return;
            var wrappable = lines === 1 ? this._lineData.slice() : this._lineData.filter(function (d) {
              return d.width + d.shapeWidth + _this4._padding * (d.width ? 2 : 1) > availableWidth && d.words.length >= lines;
            }).sort(function (a, b) {
              return b.sentence.length - a.sentence.length;
            });

            if (wrappable.length && availableHeight > wrappable[0].height * lines) {
              var truncated = false;

              var _loop = function _loop(x) {
                var label = wrappable[x];
                var h = label.og.height * lines,
                    w = label.og.width * (1.5 * (1 / lines));
                var res = textWrap().fontFamily(label.f).fontSize(label.s).lineHeight(label.lh).width(w).height(h)(label.sentence);

                if (!res.truncated) {
                  label.width = Math.ceil(max(res.lines.map(function (t) {
                    return textWidth(t, {
                      "font-family": label.f,
                      "font-size": label.s
                    });
                  }))) + label.s;
                  label.height = res.lines.length * (label.lh + 1);
                } else {
                  truncated = true;
                  return "break";
                }
              };

              for (var x = 0; x < wrappable.length; x++) {
                var _ret = _loop(x);

                if (_ret === "break") break;
              }

              if (!truncated) this._wrapRows();
            } else {
              newRows = [];
              return;
            }
          };

          this._wrapRows = function () {
            newRows = [];
            var row = 1,
                rowWidth = 0;

            for (var i = 0; i < this._lineData.length; i++) {
              var d = this._lineData[i],
                  w = d.width + this._padding * (d.width ? 2 : 1) + d.shapeWidth;

              if (sum(newRows.map(function (row) {
                return max(row, function (d) {
                  return max([d.height, d.shapeHeight]);
                });
              })) > availableHeight) {
                newRows = [];
                break;
              }

              if (w > availableWidth) {
                newRows = [];

                this._wrapLines();

                break;
              } else if (rowWidth + w < availableWidth) {
                rowWidth += w;
              } else if (this._direction !== "column") {
                rowWidth = w;
                row++;
              }

              if (!newRows[row - 1]) newRows[row - 1] = [];
              newRows[row - 1].push(d);

              if (this._direction === "column") {
                rowWidth = 0;
                row++;
              }
            }
          };

          this._wrapRows();

          if (!newRows.length || sum(newRows, this._rowHeight.bind(this)) + this._padding > availableHeight) {
            spaceNeeded = sum(this._lineData.map(function (d) {
              return d.shapeWidth + _this3._padding;
            })) - this._padding;

            for (var i = 0; i < this._lineData.length; i++) {
              this._lineData[i].width = 0;
              this._lineData[i].height = 0;
            }

            this._wrapRows();
          }

          if (newRows.length && sum(newRows, this._rowHeight.bind(this)) + this._padding < availableHeight) {
            newRows.forEach(function (row, i) {
              row.forEach(function (d) {
                if (i) {
                  d.y = sum(newRows.slice(0, i), _this3._rowHeight.bind(_this3));
                }
              });
            });
            spaceNeeded = max(newRows, this._rowWidth.bind(this));
          }
        }

        var innerHeight = max(this._lineData, function (d, i) {
          return max([d.height, _this3._fetchConfig("height", d.data, i)]) + d.y;
        }) + this._titleHeight,
            innerWidth = max([spaceNeeded, this._titleWidth]);

        this._outerBounds.width = innerWidth;
        this._outerBounds.height = innerHeight;
        var xOffset = this._padding,
            yOffset = this._padding;
        if (this._align === "center") xOffset = (this._width - innerWidth) / 2;else if (this._align === "right") xOffset = this._width - this._padding - innerWidth;
        if (this._verticalAlign === "middle") yOffset = (this._height - innerHeight) / 2;else if (this._verticalAlign === "bottom") yOffset = this._height - this._padding - innerHeight;
        this._outerBounds.x = xOffset;
        this._outerBounds.y = yOffset;

        this._titleClass.data(this._title ? [{
          text: this._title
        }] : []).duration(this._duration).select(this._group.node()).textAnchor({
          left: "start",
          center: "middle",
          right: "end"
        }[this._align]).width(this._width - this._padding * 2).x(this._padding).y(this._outerBounds.y).config(this._titleConfig).render();

        this._shapes = [];
        var baseConfig = configPrep.bind(this)(this._shapeConfig, "legend"),
            config = {
          id: function id(d) {
            return d.id;
          },
          label: function label(d) {
            return d.label;
          },
          lineHeight: function lineHeight(d) {
            return d.lH;
          }
        };

        var data = this._data.map(function (d, i) {
          var obj = {
            __d3plus__: true,
            data: d,
            i: i,
            id: _this3._id(d, i),
            label: _this3._lineData[i].width ? _this3._label(d, i) : false,
            lH: _this3._fetchConfig("lineHeight", d, i),
            shape: _this3._shape(d, i)
          };
          return obj;
        }); // Legend Shapes


        this._shapes = [];
        ["Circle", "Rect"].forEach(function (Shape) {
          _this3._shapes.push(new shapes$2[Shape]().data(data.filter(function (d) {
            return d.shape === Shape;
          })).duration(_this3._duration).labelConfig({
            padding: 0
          }).select(_this3._group.node()).verticalAlign("top").config(assign({}, baseConfig, config)).render());
        });
        if (callback) setTimeout(callback, this._duration + 100);
        return this;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the active method for all shapes to the specified function and returns the current class instance. If *value* is not specified, returns the current active method.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "active",
      value: function active(_) {
        this._shapes.forEach(function (s) {
          return s.active(_);
        });

        return this;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the horizontal alignment to the specified value and returns the current class instance. If *value* is not specified, returns the current horizontal alignment.
          @param {String} [*value* = "center"] Supports `"left"` and `"center"` and `"right"`.
          @chainable
      */

    }, {
      key: "align",
      value: function align(_) {
        return arguments.length ? (this._align = _, this) : this._align;
      }
      /**
          @memberof Legend
          @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array. A shape key will be drawn for each object in the array.
          @param {Array} [*data* = []]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof Legend
          @desc Sets the flow of the items inside the legend. If no value is passed, the current flow will be returned.
          @param {String} [*value* = "row"]
          @chainable
      */

    }, {
      key: "direction",
      value: function direction(_) {
        return arguments.length ? (this._direction = _, this) : this._direction;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the transition duration of the legend and returns the current class instance. If *value* is not specified, returns the current duration.
          @param {Number} [*value* = 600]
          @chainable
      */

    }, {
      key: "duration",
      value: function duration(_) {
        return arguments.length ? (this._duration = _, this) : this._duration;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the overall height of the legend and returns the current class instance. If *value* is not specified, returns the current height value.
          @param {Number} [*value* = 100]
          @chainable
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = _, this) : this._height;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the hover method for all shapes to the specified function and returns the current class instance. If *value* is not specified, returns the current hover method.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "hover",
      value: function hover(_) {
        this._shapes.forEach(function (s) {
          return s.hover(_);
        });

        return this;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the id accessor to the specified function and returns the current class instance. If *value* is not specified, returns the current id accessor.
          @param {Function} [*value*]
          @chainable
          @example
      function value(d) {
      return d.id;
      }
      */

    }, {
      key: "id",
      value: function id(_) {
        return arguments.length ? (this._id = _, this) : this._id;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the label accessor to the specified function or string and returns the current class instance. If *value* is not specified, returns the current label accessor, which is the [id](#shape.id) accessor by default.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "label",
      value: function label(_) {
        return arguments.length ? (this._label = typeof _ === "function" ? _ : constant$3(_), this) : this._label;
      }
      /**
          @memberof Legend
          @desc If called after the elements have been drawn to DOM, will returns the outer bounds of the legend content.
          @example
      {"width": 180, "height": 24, "x": 10, "y": 20}
      */

    }, {
      key: "outerBounds",
      value: function outerBounds() {
        return this._outerBounds;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the padding between each key to the specified number and returns the current class instance. If *value* is not specified, returns the current padding value.
          @param {Number} [*value* = 10]
          @chainable
      */

    }, {
      key: "padding",
      value: function padding(_) {
        return arguments.length ? (this._padding = _, this) : this._padding;
      }
      /**
          @memberof Legend
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.
          @param {String|HTMLElement} [*selector* = d3.select("body").append("svg")]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the shape accessor to the specified function or string and returns the current class instance. If *value* is not specified, returns the current shape accessor.
          @param {Function|String} [*value* = "Rect"]
          @chainable
      */

    }, {
      key: "shape",
      value: function shape(_) {
        return arguments.length ? (this._shape = typeof _ === "function" ? _ : constant$3(_), this) : this._shape;
      }
      /**
          @memberof Legend
          @desc If *config* is specified, sets the methods that correspond to the key/value pairs for each shape and returns the current class instance. If *config* is not specified, returns the current shape configuration.
          @param {Object} [*config* = {}]
          @chainable
      */

    }, {
      key: "shapeConfig",
      value: function shapeConfig(_) {
        return arguments.length ? (this._shapeConfig = assign(this._shapeConfig, _), this) : this._shapeConfig;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the title of the legend and returns the current class instance. If *value* is not specified, returns the current title.
          @param {String} [*value*]
          @chainable
      */

    }, {
      key: "title",
      value: function title(_) {
        return arguments.length ? (this._title = _, this) : this._title;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the title configuration of the legend and returns the current class instance. If *value* is not specified, returns the current title configuration.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "titleConfig",
      value: function titleConfig(_) {
        return arguments.length ? (this._titleConfig = assign(this._titleConfig, _), this) : this._titleConfig;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the vertical alignment to the specified value and returns the current class instance. If *value* is not specified, returns the current vertical alignment.
          @param {String} [*value* = "middle"] Supports `"top"` and `"middle"` and `"bottom"`.
          @chainable
      */

    }, {
      key: "verticalAlign",
      value: function verticalAlign(_) {
        return arguments.length ? (this._verticalAlign = _, this) : this._verticalAlign;
      }
      /**
          @memberof Legend
          @desc If *value* is specified, sets the overall width of the legend and returns the current class instance. If *value* is not specified, returns the current width value.
          @param {Number} [*value* = 400]
          @chainable
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = _, this) : this._width;
      }
    }]);

    return Legend;
  }(BaseClass);

  function _typeof$n(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$n = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$n = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$n(obj);
  }

  function _defineProperty$3(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function _classCallCheck$l(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$h(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$h(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$h(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$h(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$j(self, call) {
    if (call && (_typeof$n(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$j(self);
  }

  function _assertThisInitialized$j(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$j(o) {
    _getPrototypeOf$j = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$j(o);
  }

  function _inherits$j(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$j(subClass, superClass);
  }

  function _setPrototypeOf$j(o, p) {
    _setPrototypeOf$j = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$j(o, p);
  }
  /**
      @class ColorScale
      @extends external:BaseClass
      @desc Creates an SVG scale based on an array of data. If *data* is specified, immediately draws based on the specified array and returns the current class instance. If *data* is not specified on instantiation, it can be passed/updated after instantiation using the [data](#shape.data) method.
  */

  var ColorScale =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$j(ColorScale, _BaseClass);
    /**
        @memberof ColorScale
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function ColorScale() {
      var _this;

      _classCallCheck$l(this, ColorScale);

      _this = _possibleConstructorReturn$j(this, _getPrototypeOf$j(ColorScale).call(this));
      _this._axisClass = new Axis();
      _this._axisConfig = {
        gridSize: 0,
        shapeConfig: {
          labelConfig: {
            fontColor: "#222"
          }
        },
        titleConfig: {
          fontSize: 12
        }
      };
      _this._axisTest = new Axis();
      _this._align = "middle";
      _this._buckets = 5;
      _this._bucketAxis = false;
      _this._colorMax = "#0C8040";
      _this._colorMid = "#f7f7f7";
      _this._colorMin = "#b22200";
      _this._data = [];
      _this._duration = 600;
      _this._height = 200;
      _this._legendClass = new Legend();
      _this._legendConfig = {
        shapeConfig: {
          labelConfig: {
            fontColor: "#222"
          },
          stroke: "#444",
          strokeWidth: 1
        }
      };
      _this._midpoint = 0;
      _this._orient = "bottom";
      _this._outerBounds = {
        width: 0,
        height: 0,
        x: 0,
        y: 0
      };
      _this._padding = 5;
      _this._rectClass = new Rect();
      _this._rectConfig = {
        stroke: "#444",
        strokeWidth: 1
      };
      _this._scale = "linear";
      _this._size = 10;
      _this._value = accessor("value");
      _this._width = 400;
      return _this;
    }
    /**
        @memberof ColorScale
        @desc Renders the current ColorScale to the page. If a *callback* is specified, it will be called once the ColorScale is done drawing.
        @param {Function} [*callback* = undefined]
        @chainable
    */


    _createClass$h(ColorScale, [{
      key: "render",
      value: function render(callback) {
        var _this2 = this;

        if (this._select === void 0) this.select(_select("body").append("svg").attr("width", "".concat(this._width, "px")).attr("height", "".concat(this._height, "px")).node());
        var horizontal = ["bottom", "top"].includes(this._orient);
        var height = horizontal ? "height" : "width",
            width = horizontal ? "width" : "height",
            x = horizontal ? "x" : "y",
            y = horizontal ? "y" : "x"; // Shape <g> Group

        this._group = elem("g.d3plus-ColorScale", {
          parent: this._select
        });
        var domain = extent(this._data, this._value);
        var negative = domain[0] < this._midpoint;
        var positive = domain[1] > this._midpoint;
        var diverging = negative && positive;
        var colors = this._color,
            labels,
            ticks;

        if (colors && !(colors instanceof Array)) {
          colors = range(0, this._buckets, 1).map(function (i) {
            return colorLighter(colors, (i + 1) / _this2._buckets);
          }).reverse();
        }

        if (this._scale === "jenks") {
          var data = this._data.map(this._value).filter(function (d) {
            return d !== null && typeof d === "number";
          });

          var buckets = min([colors ? colors.length : this._buckets, data.length]);
          var jenks = ckmeans(data, buckets);
          ticks = merge(jenks.map(function (c, i) {
            return i === jenks.length - 1 ? [c[0], c[c.length - 1]] : [c[0]];
          }));
          var tickSet = new Set(ticks);

          if (ticks.length !== tickSet.size) {
            labels = Array.from(tickSet);
          }

          if (!colors) {
            if (diverging) {
              colors = [this._colorMin, this._colorMid, this._colorMax];
              var negatives = ticks.slice(0, buckets).filter(function (d, i) {
                return d < _this2._midpoint && ticks[i + 1] <= _this2._midpoint;
              });
              var spanning = ticks.slice(0, buckets).filter(function (d, i) {
                return d <= _this2._midpoint && ticks[i + 1] > _this2._midpoint;
              });
              var positives = ticks.slice(0, buckets).filter(function (d, i) {
                return d > _this2._midpoint && ticks[i + 1] > _this2._midpoint;
              });
              var negativeColors = negatives.map(function (d, i) {
                return !i ? colors[0] : colorLighter(colors[0], i / negatives.length);
              });
              var spanningColors = spanning.map(function () {
                return colors[1];
              });
              var positiveColors = positives.map(function (d, i) {
                return i === positives.length - 1 ? colors[2] : colorLighter(colors[2], 1 - (i + 1) / positives.length);
              });
              colors = negativeColors.concat(spanningColors).concat(positiveColors);
            } else {
              colors = range(0, this._buckets, 1).map(function (i) {
                return colorLighter(_this2._colorMax, i / _this2._buckets);
              }).reverse();
            }
          }

          if (data.length <= buckets) {
            colors = colors.slice(buckets - data.length);
          }

          this._colorScale = threshold().domain(ticks).range(["black"].concat(colors).concat(colors[colors.length - 1]));
        } else {
          var _buckets;

          if (diverging && !colors) {
            var half = Math.floor(this._buckets / 2);

            var _negativeColors = range(0, half, 1).map(function (i) {
              return !i ? _this2._colorMin : colorLighter(_this2._colorMin, i / half);
            });

            var _spanningColors = (this._buckets % 2 ? [0] : []).map(function () {
              return _this2._colorMid;
            });

            var _positiveColors = range(0, half, 1).map(function (i) {
              return !i ? _this2._colorMax : colorLighter(_this2._colorMax, i / half);
            }).reverse();

            colors = _negativeColors.concat(_spanningColors).concat(_positiveColors);
            var step = (colors.length - 1) / 2;
            _buckets = [domain[0], this._midpoint, domain[1]];
            _buckets = range(domain[0], this._midpoint, -(domain[0] - this._midpoint) / step).concat(range(this._midpoint, domain[1], (domain[1] - this._midpoint) / step)).concat([domain[1]]);
          } else {
            if (!colors) {
              if (this._scale === "buckets") {
                colors = range(0, this._buckets, 1).map(function (i) {
                  return colorLighter(negative ? _this2._colorMin : _this2._colorMax, i / _this2._buckets);
                });
                if (positive) colors = colors.reverse();
              } else {
                colors = negative ? [this._colorMin, colorLighter(this._colorMin, 0.8)] : [colorLighter(this._colorMax, 0.8), this._colorMax];
              }
            }

            var _step = (domain[1] - domain[0]) / (colors.length - 1);

            _buckets = range(domain[0], domain[1] + _step / 2, _step);
          }

          if (this._scale === "buckets") {
            ticks = _buckets.concat([_buckets[_buckets.length - 1]]);
          }

          this._colorScale = linear$1().domain(_buckets).range(colors);
        }

        if (this._bucketAxis || !["buckets", "jenks"].includes(this._scale)) {
          var _this$_rectClass$data;

          var axisConfig = assign({
            domain: horizontal ? domain : domain.reverse(),
            duration: this._duration,
            height: this._height,
            labels: labels || ticks,
            orient: this._orient,
            padding: this._padding,
            ticks: ticks,
            width: this._width
          }, this._axisConfig);

          this._axisTest.select(elem("g.d3plus-ColorScale-axisTest", {
            enter: {
              opacity: 0
            },
            parent: this._group
          }).node()).config(axisConfig).duration(0).render();

          var axisBounds = this._axisTest.outerBounds();

          this._outerBounds[width] = this["_".concat(width)] - this._padding * 2;
          this._outerBounds[height] = axisBounds[height] + this._size;
          this._outerBounds[x] = this._padding;
          this._outerBounds[y] = this._padding;
          if (this._align === "middle") this._outerBounds[y] = (this["_".concat(height)] - this._outerBounds[height]) / 2;else if (this._align === "end") this._outerBounds[y] = this["_".concat(height)] - this._padding - this._outerBounds[height];

          var groupOffset = this._outerBounds[y] + (["bottom", "right"].includes(this._orient) ? this._size : 0) - (axisConfig.padding || this._axisClass.padding());

          this._axisClass.select(elem("g.d3plus-ColorScale-axis", {
            parent: this._group,
            update: {
              transform: "translate(".concat(horizontal ? 0 : groupOffset, ", ").concat(horizontal ? groupOffset : 0, ")")
            }
          }).node()).config(axisConfig).align("start").render();

          var axisScale = this._axisTest._getPosition.bind(this._axisTest);

          var scaleRange = this._axisTest._getRange();

          var defs = this._group.selectAll("defs").data([0]);

          var defsEnter = defs.enter().append("defs");
          defsEnter.append("linearGradient").attr("id", "gradient-".concat(this._uuid));
          defs = defsEnter.merge(defs);
          defs.select("linearGradient").attr("".concat(x, "1"), horizontal ? "0%" : "100%").attr("".concat(x, "2"), horizontal ? "100%" : "0%").attr("".concat(y, "1"), "0%").attr("".concat(y, "2"), "0%");
          var stops = defs.select("linearGradient").selectAll("stop").data(colors);

          var scaleDomain = this._colorScale.domain();

          var offsetScale = linear$1().domain([scaleDomain[0], scaleDomain[scaleDomain.length - 1]]).range([0, 100]);
          stops.enter().append("stop").merge(stops).attr("offset", function (d, i) {
            return "".concat(offsetScale(scaleDomain[i]), "%");
          }).attr("stop-color", String);
          /** determines the width of buckets */

          var bucketWidth = function bucketWidth(d, i) {
            var w = Math.abs(axisScale(ticks[i + 1]) - axisScale(d));
            return w || 2;
          };

          this._rectClass.data(ticks ? ticks.slice(0, ticks.length - 1) : [0]).id(function (d, i) {
            return i;
          }).select(elem("g.d3plus-ColorScale-Rect", {
            parent: this._group
          }).node()).config((_this$_rectClass$data = {
            duration: this._duration,
            fill: ticks ? function (d) {
              return _this2._colorScale(d);
            } : "url(#gradient-".concat(this._uuid, ")")
          }, _defineProperty$3(_this$_rectClass$data, x, ticks ? function (d, i) {
            return axisScale(d) + bucketWidth(d, i) / 2 - (["left", "right"].includes(_this2._orient) ? bucketWidth(d, i) : 0);
          } : scaleRange[0] + (scaleRange[1] - scaleRange[0]) / 2), _defineProperty$3(_this$_rectClass$data, y, this._outerBounds[y] + (["top", "left"].includes(this._orient) ? axisBounds[height] : 0) + this._size / 2), _defineProperty$3(_this$_rectClass$data, width, ticks ? bucketWidth : scaleRange[1] - scaleRange[0]), _defineProperty$3(_this$_rectClass$data, height, this._size), _this$_rectClass$data)).config(this._rectConfig).render();
        } else {
          var format = this._axisConfig.tickFormat ? this._axisConfig.tickFormat : function (d) {
            return d;
          };

          var _data = ticks.reduce(function (arr, tick, i) {
            if (i !== ticks.length - 1) {
              var next = ticks[i + 1];
              arr.push({
                color: colors[i],
                id: tick === next ? "".concat(format(tick), "+") : "".concat(format(tick), " - ").concat(format(next))
              });
            }

            return arr;
          }, []);

          var legendConfig = assign({
            align: horizontal ? "center" : {
              start: "left",
              middle: "center",
              end: "right"
            }[this._align],
            direction: horizontal ? "row" : "column",
            duration: this._duration,
            height: this._height,
            padding: this._padding,
            shapeConfig: assign({
              duration: this._duration
            }, this._axisConfig.shapeConfig || {}),
            title: this._axisConfig.title,
            titleConfig: this._axisConfig.titleConfig || {},
            width: this._width,
            verticalAlign: horizontal ? {
              start: "top",
              middle: "middle",
              end: "bottom"
            }[this._align] : "middle"
          }, this._legendConfig);

          this._legendClass.data(_data).select(elem("g.d3plus-ColorScale-legend", {
            parent: this._group
          }).node()).config(legendConfig).render();

          this._outerBounds = this._legendClass.outerBounds();
        }

        if (callback) setTimeout(callback, this._duration + 100);
        return this;
      }
      /**
          @memberof ColorScale
          @desc The [ColorScale](http://d3plus.org/docs/#ColorScale) is constructed by combining an [Axis](http://d3plus.org/docs/#Axis) for the ticks/labels and a [Rect](http://d3plus.org/docs/#Rect) for the actual color box (or multiple boxes, as in a jenks scale). Because of this, there are separate configs for the [Axis](http://d3plus.org/docs/#Axis) class used to display the text ([axisConfig](http://d3plus.org/docs/#ColorScale.axisConfig)) and the [Rect](http://d3plus.org/docs/#Rect) class used to draw the color breaks ([rectConfig](http://d3plus.org/docs/#ColorScale.rectConfig)). This method acts as a pass-through to the config method of the [Axis](http://d3plus.org/docs/#Axis). An example usage of this method can be seen [here](http://d3plus.org/examples/d3plus-legend/colorScale-dark/).
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "axisConfig",
      value: function axisConfig(_) {
        return arguments.length ? (this._axisConfig = assign(this._axisConfig, _), this) : this._axisConfig;
      }
      /**
          @memberof ColorScale
          @desc If *value* is specified, sets the horizontal alignment to the specified value and returns the current class instance. If *value* is not specified, returns the current horizontal alignment.
          @param {String} [*value* = "center"] Supports `"left"` and `"center"` and `"right"`.
          @chainable
      */

    }, {
      key: "align",
      value: function align(_) {
        return arguments.length ? (this._align = _, this) : this._align;
      }
      /**
          @memberof ColorScale
          @desc The number of discrete buckets to create in a bucketed color scale. Will be overridden by any custom Array of colors passed to the `color` method.
          @param {Number} [*value* = 5]
          @chainable
      */

    }, {
      key: "buckets",
      value: function buckets(_) {
        return arguments.length ? (this._buckets = _, this) : this._buckets;
      }
      /**
          @memberof ColorScale
          @desc Determines whether or not to use an Axis to display bucket scales (both "buckets" and "jenks"). When set to `false`, bucketed scales will use the `Legend` class to display squares for each range of data. When set to `true`, bucketed scales will be displayed on an `Axis`, similar to "linear" scales.
          @param {Boolean} [*value* = false]
          @chainable
      */

    }, {
      key: "bucketAxis",
      value: function bucketAxis(_) {
        return arguments.length ? (this._bucketAxis = _, this) : this._bucketAxis;
      }
      /**
          @memberof ColorScale
          @desc Overrides the default internal logic of `colorMin`, `colorMid`, and `colorMax` to only use just this specified color. If a single color is given as a String, then the scale is interpolated by lightening that color. Otherwise, the function expects an Array of color values to be used in order for the scale.
          @param {String|Array} [*value*]
          @chainable
      */

    }, {
      key: "color",
      value: function color(_) {
        return arguments.length ? (this._color = _, this) : this._color;
      }
      /**
          @memberof ColorScale
          @desc Defines the color to be used for numbers greater than the value of the `midpoint` on the scale (defaults to `0`). Colors in between this value and the value of `colorMid` will be interpolated, unless a custom Array of colors has been specified using the `color` method.
          @param {String} [*value* = "#0C8040"]
          @chainable
      */

    }, {
      key: "colorMax",
      value: function colorMax(_) {
        return arguments.length ? (this._colorMax = _, this) : this._colorMax;
      }
      /**
          @memberof ColorScale
          @desc Defines the color to be used for the midpoint of a diverging scale, based on the current value of the `midpoint` method (defaults to `0`). Colors in between this value and the values of `colorMin` and `colorMax` will be interpolated, unless a custom Array of colors has been specified using the `color` method.
          @param {String} [*value* = "#f7f7f7"]
          @chainable
      */

    }, {
      key: "colorMid",
      value: function colorMid(_) {
        return arguments.length ? (this._colorMid = _, this) : this._colorMid;
      }
      /**
          @memberof ColorScale
          @desc Defines the color to be used for numbers less than the value of the `midpoint` on the scale (defaults to `0`). Colors in between this value and the value of `colorMid` will be interpolated, unless a custom Array of colors has been specified using the `color` method.
          @param {String} [*value* = "#b22200"]
          @chainable
      */

    }, {
      key: "colorMin",
      value: function colorMin(_) {
        return arguments.length ? (this._colorMin = _, this) : this._colorMin;
      }
      /**
          @memberof ColorScale
          @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array. A shape key will be drawn for each object in the array.
          @param {Array} [*data* = []]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof ColorScale
          @desc If *value* is specified, sets the transition duration of the ColorScale and returns the current class instance. If *value* is not specified, returns the current duration.
          @param {Number} [*value* = 600]
          @chainable
      */

    }, {
      key: "duration",
      value: function duration(_) {
        return arguments.length ? (this._duration = _, this) : this._duration;
      }
      /**
          @memberof ColorScale
          @desc If *value* is specified, sets the overall height of the ColorScale and returns the current class instance. If *value* is not specified, returns the current height value.
          @param {Number} [*value* = 100]
          @chainable
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = _, this) : this._height;
      }
      /**
          @memberof ColorScale
          @desc The [ColorScale](http://d3plus.org/docs/#ColorScale) is constructed by combining an [Axis](http://d3plus.org/docs/#Axis) for the ticks/labels and a [Rect](http://d3plus.org/docs/#Rect) for the actual color box (or multiple boxes, as in a jenks scale). Because of this, there are separate configs for the [Axis](http://d3plus.org/docs/#Axis) class used to display the text ([axisConfig](http://d3plus.org/docs/#ColorScale.axisConfig)) and the [Rect](http://d3plus.org/docs/#Rect) class used to draw the color breaks ([rectConfig](http://d3plus.org/docs/#ColorScale.rectConfig)). This method acts as a pass-through to the config method of the [Axis](http://d3plus.org/docs/#Axis). An example usage of this method can be seen [here](http://d3plus.org/examples/d3plus-legend/colorScale-dark/).
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "legendConfig",
      value: function legendConfig(_) {
        return arguments.length ? (this._legendConfig = assign(this._legendConfig, _), this) : this._legendConfig;
      }
      /**
          @memberof ColorScale
          @desc The number value to be used as the anchor for `colorMid`, and defines the center point of the diverging color scale.
          @param {Number} [*value* = 0]
          @chainable
      */

    }, {
      key: "midpoint",
      value: function midpoint(_) {
        return arguments.length ? (this._midpoint = _, this) : this._midpoint;
      }
      /**
          @memberof ColorScale
          @desc Sets the flow of the items inside the ColorScale. If no value is passed, the current flow will be returned.
          @param {String} [*value* = "bottom"]
          @chainable
      */

    }, {
      key: "orient",
      value: function orient(_) {
        return arguments.length ? (this._orient = _, this) : this._orient;
      }
      /**
          @memberof ColorScale
          @desc If called after the elements have been drawn to DOM, will returns the outer bounds of the ColorScale content.
          @example
      {"width": 180, "height": 24, "x": 10, "y": 20}
      */

    }, {
      key: "outerBounds",
      value: function outerBounds() {
        return this._outerBounds;
      }
      /**
          @memberof ColorScale
          @desc If *value* is specified, sets the padding between each key to the specified number and returns the current class instance. If *value* is not specified, returns the current padding value.
          @param {Number} [*value* = 10]
          @chainable
      */

    }, {
      key: "padding",
      value: function padding(_) {
        return arguments.length ? (this._padding = _, this) : this._padding;
      }
      /**
          @memberof ColorScale
          @desc The [ColorScale](http://d3plus.org/docs/#ColorScale) is constructed by combining an [Axis](http://d3plus.org/docs/#Axis) for the ticks/labels and a [Rect](http://d3plus.org/docs/#Rect) for the actual color box (or multiple boxes, as in a jenks scale). Because of this, there are separate configs for the [Axis](http://d3plus.org/docs/#Axis) class used to display the text ([axisConfig](http://d3plus.org/docs/#ColorScale.axisConfig)) and the [Rect](http://d3plus.org/docs/#Rect) class used to draw the color breaks ([rectConfig](http://d3plus.org/docs/#ColorScale.rectConfig)). This method acts as a pass-through to the config method of the [Rect](http://d3plus.org/docs/#Rect). An example usage of this method can be seen [here](http://d3plus.org/examples/d3plus-legend/colorScale-dark/).
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "rectConfig",
      value: function rectConfig(_) {
        return arguments.length ? (this._rectConfig = assign(this._rectConfig, _), this) : this._rectConfig;
      }
      /**
          @memberof ColorScale
          @desc If *value* is specified, sets the scale of the ColorScale and returns the current class instance. If *value* is not specified, returns the current scale value.
          @param {String} [*value* = "linear"] Can either be "linear", "jenks", or "buckets".
          @chainable
      */

    }, {
      key: "scale",
      value: function scale(_) {
        return arguments.length ? (this._scale = _, this) : this._scale;
      }
      /**
          @memberof ColorScale
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.
          @param {String|HTMLElement} [*selector* = d3.select("body").append("svg")]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
          @memberof ColorScale
          @desc The height of horizontal color scales, and width when positioned vertical.
          @param {Number} [*value* = 10]
          @chainable
      */

    }, {
      key: "size",
      value: function size(_) {
        return arguments.length ? (this._size = _, this) : this._size;
      }
      /**
          @memberof ColorScale
          @desc If *value* is specified, sets the value accessor to the specified function or string and returns the current class instance. If *value* is not specified, returns the current value accessor.
          @param {Function|String} [*value*]
          @chainable
          @example
      function value(d) {
      return d.value;
      }
      */

    }, {
      key: "value",
      value: function value(_) {
        return arguments.length ? (this._value = typeof _ === "function" ? _ : constant$3(_), this) : this._value;
      }
      /**
          @memberof ColorScale
          @desc If *value* is specified, sets the overall width of the ColorScale and returns the current class instance. If *value* is not specified, returns the current width value.
          @param {Number} [*value* = 400]
          @chainable
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = _, this) : this._width;
      }
    }]);

    return ColorScale;
  }(BaseClass);

  function constant$8 (x) {
    return function () {
      return x;
    };
  }

  function BrushEvent$1 (target, type, selection) {
    this.target = target;
    this.type = type;
    this.selection = selection;
  }

  function nopropagation$2() {
    event$1.stopImmediatePropagation();
  }
  function noevent$3 () {
    event$1.preventDefault();
    event$1.stopImmediatePropagation();
  }

  var MODE_DRAG$1 = {
    name: "drag"
  },
      MODE_SPACE$1 = {
    name: "space"
  },
      MODE_HANDLE$1 = {
    name: "handle"
  },
      MODE_CENTER$1 = {
    name: "center"
  };
  var X$1 = {
    name: "x",
    handles: ["e", "w"].map(type$2),
    input: function input(x, e) {
      return x && [[x[0], e[0][1]], [x[1], e[1][1]]];
    },
    output: function output(xy) {
      return xy && [xy[0][0], xy[1][0]];
    }
  };
  var Y$1 = {
    name: "y",
    handles: ["n", "s"].map(type$2),
    input: function input(y, e) {
      return y && [[e[0][0], y[0]], [e[1][0], y[1]]];
    },
    output: function output(xy) {
      return xy && [xy[0][1], xy[1][1]];
    }
  };
  var cursors$1 = {
    overlay: "crosshair",
    selection: "move",
    n: "ns-resize",
    e: "ew-resize",
    s: "ns-resize",
    w: "ew-resize",
    nw: "nwse-resize",
    ne: "nesw-resize",
    se: "nwse-resize",
    sw: "nesw-resize"
  };
  var flipX$1 = {
    e: "w",
    w: "e",
    nw: "ne",
    ne: "nw",
    se: "sw",
    sw: "se"
  };
  var flipY$1 = {
    n: "s",
    s: "n",
    nw: "sw",
    ne: "se",
    se: "ne",
    sw: "nw"
  };
  var signsX$1 = {
    overlay: +1,
    selection: +1,
    n: null,
    e: +1,
    s: null,
    w: -1,
    nw: -1,
    ne: +1,
    se: +1,
    sw: -1
  };
  var signsY$1 = {
    overlay: +1,
    selection: +1,
    n: -1,
    e: null,
    s: +1,
    w: null,
    nw: -1,
    ne: -1,
    se: +1,
    sw: +1
  };

  function type$2(t) {
    return {
      type: t
    };
  } // Ignore right-click, since that should open the context menu.


  function defaultFilter$2() {
    return !event$1.button;
  }

  function defaultExtent$2() {
    var svg = this.ownerSVGElement || this;
    return [[0, 0], [svg.width.baseVal.value, svg.height.baseVal.value]];
  } // Like d3.local, but with the name __brush rather than auto-generated.


  function local$1(node) {
    while (!node.__brush) {
      if (!(node = node.parentNode)) return;
    }

    return node.__brush;
  }

  function empty$2(extent) {
    return extent[0][0] === extent[1][0] || extent[0][1] === extent[1][1];
  }
  function brushX() {
    return brush$2(X$1);
  }

  function brush$2(dim) {
    var extent = defaultExtent$2,
        filter = defaultFilter$2,
        listeners = dispatch(brush, "start", "brush", "end"),
        handleSize = 6,
        touchending;

    function brush(group) {
      var overlay = group.property("__brush", initialize).selectAll(".overlay").data([type$2("overlay")]);
      overlay.enter().append("rect").attr("class", "overlay").attr("pointer-events", "all").attr("cursor", cursors$1.overlay).merge(overlay).each(function () {
        var extent = local$1(this).extent;
        _select(this).attr("x", extent[0][0]).attr("y", extent[0][1]).attr("width", extent[1][0] - extent[0][0]).attr("height", extent[1][1] - extent[0][1]);
      });
      group.selectAll(".selection").data([type$2("selection")]).enter().append("rect").attr("class", "selection").attr("cursor", cursors$1.selection).attr("fill", "#777").attr("fill-opacity", 0.3).attr("stroke", "#fff").attr("shape-rendering", "crispEdges");
      var handle = group.selectAll(".handle").data(dim.handles, function (d) {
        return d.type;
      });
      handle.exit().remove();
      handle.enter().append("rect").attr("class", function (d) {
        return "handle handle--" + d.type;
      }).attr("cursor", function (d) {
        return cursors$1[d.type];
      });
      group.each(redraw).attr("fill", "none").attr("pointer-events", "all").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)").on("mousedown.brush touchstart.brush", started);
    }

    brush.move = function (group, selection) {
      if (group.selection) {
        group.on("start.brush", function () {
          emitter(this, arguments).beforestart().start();
        }).on("interrupt.brush end.brush", function () {
          emitter(this, arguments).end();
        }).tween("brush", function () {
          var that = this,
              state = that.__brush,
              emit = emitter(that, arguments),
              selection0 = state.selection,
              selection1 = dim.input(typeof selection === "function" ? selection.apply(this, arguments) : selection, state.extent),
              i = interpolate(selection0, selection1);

          function tween(t) {
            state.selection = t === 1 && empty$2(selection1) ? null : i(t);
            redraw.call(that);
            emit.brush();
          }

          return selection0 && selection1 ? tween : tween(1);
        });
      } else {
        group.each(function () {
          var that = this,
              args = arguments,
              state = that.__brush,
              selection1 = dim.input(typeof selection === "function" ? selection.apply(that, args) : selection, state.extent),
              emit = emitter(that, args).beforestart();
          interrupt(that);
          state.selection = selection1 == null || empty$2(selection1) ? null : selection1;
          redraw.call(that);
          emit.start().brush().end();
        });
      }
    };

    function redraw() {
      var group = _select(this),
          selection = local$1(this).selection;

      if (selection) {
        group.selectAll(".selection").style("display", null).attr("x", selection[0][0]).attr("y", selection[0][1]).attr("width", selection[1][0] - selection[0][0]).attr("height", selection[1][1] - selection[0][1]);
        group.selectAll(".handle").style("display", null).attr("x", function (d) {
          return d.type[d.type.length - 1] === "e" ? selection[1][0] - handleSize / 2 : selection[0][0] - handleSize / 2;
        }).attr("y", function (d) {
          return d.type[0] === "s" ? selection[1][1] - handleSize / 2 : selection[0][1] - handleSize / 2;
        }).attr("width", function (d) {
          return d.type === "n" || d.type === "s" ? selection[1][0] - selection[0][0] + handleSize : handleSize;
        }).attr("height", function (d) {
          return d.type === "e" || d.type === "w" ? selection[1][1] - selection[0][1] + handleSize : handleSize;
        });
      } else {
        group.selectAll(".selection,.handle").style("display", "none").attr("x", null).attr("y", null).attr("width", null).attr("height", null);
      }
    }

    function emitter(that, args) {
      return that.__brush.emitter || new Emitter(that, args);
    }

    function Emitter(that, args) {
      this.that = that;
      this.args = args;
      this.state = that.__brush;
      this.active = 0;
    }

    Emitter.prototype = {
      beforestart: function beforestart() {
        if (++this.active === 1) this.state.emitter = this, this.starting = true;
        return this;
      },
      start: function start() {
        if (this.starting) this.starting = false, this.emit("start");
        return this;
      },
      brush: function brush() {
        this.emit("brush");
        return this;
      },
      end: function end() {
        if (--this.active === 0) delete this.state.emitter, this.emit("end");
        return this;
      },
      emit: function emit(type) {
        customEvent(new BrushEvent$1(brush, type, dim.output(this.state.selection)), listeners.apply, listeners, [type, this.that, this.args]);
      }
    };

    function started() {
      if (event$1.touches) {
        if (event$1.changedTouches.length < event$1.touches.length) return noevent$3();
      } else if (touchending) return;

      if (!filter.apply(this, arguments)) return;
      var that = this,
          type = event$1.target.__data__.type,
          mode = (event$1.metaKey ? type = "overlay" : type) === "selection" ? MODE_DRAG$1 : event$1.altKey ? MODE_CENTER$1 : MODE_HANDLE$1,
          signX = dim === Y$1 ? null : signsX$1[type],
          signY = dim === X$1 ? null : signsY$1[type],
          state = local$1(that),
          extent = state.extent,
          selection = state.selection,
          W = extent[0][0],
          w0,
          w1,
          N = extent[0][1],
          n0,
          n1,
          E = extent[1][0],
          e0,
          e1,
          S = extent[1][1],
          s0,
          s1,
          dx,
          dy,
          moving,
          shifting = signX && signY && event$1.shiftKey,
          lockX,
          lockY,
          point0 = mouse(that),
          point = point0,
          emit = emitter(that, arguments).beforestart();

      if (type === "overlay") {
        state.selection = selection = [[w0 = dim === Y$1 ? W : point0[0], n0 = dim === X$1 ? N : point0[1]], [e0 = dim === Y$1 ? E : w0, s0 = dim === X$1 ? S : n0]];
      } else {
        w0 = selection[0][0];
        n0 = selection[0][1];
        e0 = selection[1][0];
        s0 = selection[1][1];
      }

      w1 = w0;
      n1 = n0;
      e1 = e0;
      s1 = s0;
      var group = _select(that).attr("pointer-events", "none");
      var overlay = group.selectAll(".overlay").attr("cursor", cursors$1[type]);

      if (event$1.touches) {
        group.on("touchmove.brush", moved, true).on("touchend.brush touchcancel.brush", ended, true);
      } else {
        var view = _select(event$1.view).on("keydown.brush", keydowned, true).on("keyup.brush", keyupped, true).on("mousemove.brush", moved, true).on("mouseup.brush", ended, true);
        dragDisable(event$1.view);
      }

      nopropagation$2();
      interrupt(that);
      redraw.call(that);
      emit.start();

      function moved() {
        var point1 = mouse(that);

        if (shifting && !lockX && !lockY) {
          if (Math.abs(point1[0] - point[0]) > Math.abs(point1[1] - point[1])) lockY = true;else lockX = true;
        }

        point = point1;
        moving = true;
        noevent$3();
        move();
      }

      function move() {
        var t;
        dx = point[0] - point0[0];
        dy = point[1] - point0[1];

        switch (mode) {
          case MODE_SPACE$1:
          case MODE_DRAG$1:
            {
              if (signX) dx = Math.max(W - w0, Math.min(E - e0, dx)), w1 = w0 + dx, e1 = e0 + dx;
              if (signY) dy = Math.max(N - n0, Math.min(S - s0, dy)), n1 = n0 + dy, s1 = s0 + dy;
              break;
            }

          case MODE_HANDLE$1:
            {
              if (signX < 0) dx = Math.max(W - w0, Math.min(E - w0, dx)), w1 = w0 + dx, e1 = e0;else if (signX > 0) dx = Math.max(W - e0, Math.min(E - e0, dx)), w1 = w0, e1 = e0 + dx;
              if (signY < 0) dy = Math.max(N - n0, Math.min(S - n0, dy)), n1 = n0 + dy, s1 = s0;else if (signY > 0) dy = Math.max(N - s0, Math.min(S - s0, dy)), n1 = n0, s1 = s0 + dy;
              break;
            }

          case MODE_CENTER$1:
            {
              if (signX) w1 = Math.max(W, Math.min(E, w0 - dx * signX)), e1 = Math.max(W, Math.min(E, e0 + dx * signX));
              if (signY) n1 = Math.max(N, Math.min(S, n0 - dy * signY)), s1 = Math.max(N, Math.min(S, s0 + dy * signY));
              break;
            }
        }

        if (e1 < w1) {
          signX *= -1;
          t = w0, w0 = e0, e0 = t;
          t = w1, w1 = e1, e1 = t;
          if (type in flipX$1) overlay.attr("cursor", cursors$1[type = flipX$1[type]]);
        }

        if (s1 < n1) {
          signY *= -1;
          t = n0, n0 = s0, s0 = t;
          t = n1, n1 = s1, s1 = t;
          if (type in flipY$1) overlay.attr("cursor", cursors$1[type = flipY$1[type]]);
        }

        if (state.selection) selection = state.selection; // May be set by brush.move!

        if (lockX) w1 = selection[0][0], e1 = selection[1][0];
        if (lockY) n1 = selection[0][1], s1 = selection[1][1];

        if (selection[0][0] !== w1 || selection[0][1] !== n1 || selection[1][0] !== e1 || selection[1][1] !== s1) {
          state.selection = [[w1, n1], [e1, s1]];
          redraw.call(that);
          emit.brush();
        }
      }

      function ended() {
        nopropagation$2();

        if (event$1.touches) {
          if (event$1.touches.length) return;
          if (touchending) clearTimeout(touchending);
          touchending = setTimeout(function () {
            touchending = null;
          }, 500); // Ghost clicks are delayed!

          group.on("touchmove.brush touchend.brush touchcancel.brush", null);
        } else {
          yesdrag(event$1.view, moving);
          view.on("keydown.brush keyup.brush mousemove.brush mouseup.brush", null);
        }

        group.attr("pointer-events", "all");
        overlay.attr("cursor", cursors$1.overlay);
        if (state.selection) selection = state.selection; // May be set by brush.move (on start)!

        if (empty$2(selection)) state.selection = null, redraw.call(that);
        emit.end();
      }

      function keydowned() {
        switch (event$1.keyCode) {
          case 16:
            {
              // SHIFT
              shifting = signX && signY;
              break;
            }

          case 18:
            {
              // ALT
              if (mode === MODE_HANDLE$1) {
                if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;
                if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;
                mode = MODE_CENTER$1;
                move();
              }

              break;
            }

          case 32:
            {
              // SPACE; takes priority over ALT
              if (mode === MODE_HANDLE$1 || mode === MODE_CENTER$1) {
                if (signX < 0) e0 = e1 - dx;else if (signX > 0) w0 = w1 - dx;
                if (signY < 0) s0 = s1 - dy;else if (signY > 0) n0 = n1 - dy;
                mode = MODE_SPACE$1;
                overlay.attr("cursor", cursors$1.selection);
                move();
              }

              break;
            }

          default:
            return;
        }

        noevent$3();
      }

      function keyupped() {
        switch (event$1.keyCode) {
          case 16:
            {
              // SHIFT
              if (shifting) {
                lockX = lockY = shifting = false;
                move();
              }

              break;
            }

          case 18:
            {
              // ALT
              if (mode === MODE_CENTER$1) {
                if (signX < 0) e0 = e1;else if (signX > 0) w0 = w1;
                if (signY < 0) s0 = s1;else if (signY > 0) n0 = n1;
                mode = MODE_HANDLE$1;
                move();
              }

              break;
            }

          case 32:
            {
              // SPACE
              if (mode === MODE_SPACE$1) {
                if (event$1.altKey) {
                  if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;
                  if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;
                  mode = MODE_CENTER$1;
                } else {
                  if (signX < 0) e0 = e1;else if (signX > 0) w0 = w1;
                  if (signY < 0) s0 = s1;else if (signY > 0) n0 = n1;
                  mode = MODE_HANDLE$1;
                }

                overlay.attr("cursor", cursors$1[type]);
                move();
              }

              break;
            }

          default:
            return;
        }

        noevent$3();
      }
    }

    function initialize() {
      var state = this.__brush || {
        selection: null
      };
      state.extent = extent.apply(this, arguments);
      state.dim = dim;
      return state;
    }

    brush.extent = function (_) {
      return arguments.length ? (extent = typeof _ === "function" ? _ : constant$8([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), brush) : extent;
    };

    brush.filter = function (_) {
      return arguments.length ? (filter = typeof _ === "function" ? _ : constant$8(!!_), brush) : filter;
    };

    brush.handleSize = function (_) {
      return arguments.length ? (handleSize = +_, brush) : handleSize;
    };

    brush.on = function () {
      var value = listeners.on.apply(listeners, arguments);
      return value === listeners ? brush : value;
    };

    return brush;
  }

  function _typeof$o(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$o = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$o = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$o(obj);
  }

  function _classCallCheck$m(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$i(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$i(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$i(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$i(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$k(self, call) {
    if (call && (_typeof$o(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$k(self);
  }

  function _assertThisInitialized$k(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$6(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$6 = Reflect.get;
    } else {
      _get$6 = function _get(target, property, receiver) {
        var base = _superPropBase$6(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$6(target, property, receiver || target);
  }

  function _superPropBase$6(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$k(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$k(o) {
    _getPrototypeOf$k = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$k(o);
  }

  function _inherits$k(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$k(subClass, superClass);
  }

  function _setPrototypeOf$k(o, p) {
    _setPrototypeOf$k = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$k(o, p);
  }
  /**
      @class Timeline
      @extends external:Axis
  */

  var Timeline =
  /*#__PURE__*/
  function (_Axis) {
    _inherits$k(Timeline, _Axis);
    /**
        @memberof Timeline
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Axis.
        @private
    */


    function Timeline() {
      var _this;

      _classCallCheck$m(this, Timeline);

      _this = _possibleConstructorReturn$k(this, _getPrototypeOf$k(Timeline).call(this));
      _this._barConfig = Object.assign({}, _this._barConfig, {
        "stroke-width": function strokeWidth() {
          return _this._buttonBehaviorCurrent === "buttons" ? 0 : 1;
        }
      });
      _this._brushing = true;

      _this._brushFilter = function () {
        return !event$1.button && event$1.detail < 2;
      };

      _this._buttonAlign = "middle";
      _this._buttonBehavior = "auto";
      _this._buttonPadding = 10;
      _this._buttonHeight = 30;
      _this._domain = [2001, 2010];
      _this._gridSize = 0;
      _this._handleConfig = {
        fill: "#444"
      };
      _this._handleSize = 6;
      _this._height = 100;
      _this._labelOffset = false;
      _this._on = {};

      _this.orient("bottom");

      _this._scale = "time";
      _this._selectionConfig = {
        "fill": "#777",
        "stroke-width": 0
      };
      _this._shape = "Rect";
      _this._shapeConfig = Object.assign({}, _this._shapeConfig, {
        labelBounds: function labelBounds(d) {
          return _this._buttonBehaviorCurrent === "buttons" ? {
            x: d.labelBounds.x,
            y: -5,
            width: d.labelBounds.width,
            height: _this._buttonHeight
          } : d.labelBounds;
        },
        fill: function fill() {
          return _this._buttonBehaviorCurrent === "buttons" ? "#EEE" : "#444";
        },
        height: function height(d) {
          return _this._buttonBehaviorCurrent === "buttons" ? _this._buttonHeight : d.tick ? 10 : 0;
        },
        width: function width(d) {
          return _this._buttonBehaviorCurrent === "buttons" ? _this._ticksWidth / _this._availableTicks.length : d.tick ? _this._domain.map(function (t) {
            return date$2(t).getTime();
          }).includes(d.id) ? 2 : 1 : 0;
        },
        y: function y(d) {
          return _this._buttonBehaviorCurrent === "buttons" ? _this._align === "middle" ? _this._height / 2 : _this._align === "start" ? _this._margin.top + _this._buttonHeight / 2 : _this._height - _this._buttonHeight / 2 - _this._margin.bottom : d.y;
        }
      });
      _this._snapping = true;
      return _this;
    }
    /**
        @memberof Timeline
        @desc Triggered on brush "brush".
        @private
    */


    _createClass$i(Timeline, [{
      key: "_brushBrush",
      value: function _brushBrush() {
        if (event$1.sourceEvent && event$1.sourceEvent.offsetX && event$1.selection !== null && (!this._brushing || this._snapping)) {
          var domain = this._updateDomain();

          this._brushGroup.call(this._brush.move, this._updateBrushLimit(domain));
        }

        this._brushStyle();

        if (this._on.brush) this._on.brush(this._selection);
      }
      /**
          @memberof Timeline
          @desc Triggered on brush "end".
          @private
      */

    }, {
      key: "_brushEnd",
      value: function _brushEnd() {
        if (!event$1.sourceEvent) return; // Only transition after input.

        var domain = this._updateDomain();

        this._brushStyle();

        if (this._brushing || !this._snapping) this._brushGroup.transition(this._transition).call(this._brush.move, this._updateBrushLimit(domain));
        if (this._on.end) this._on.end(this._selection);
      }
      /**
          @memberof Timeline
          @desc Triggered on brush "start".
          @private
      */

    }, {
      key: "_brushStart",
      value: function _brushStart() {
        if (event$1.sourceEvent !== null && (!this._brushing || this._snapping)) {
          var domain = this._updateDomain();

          this._brushGroup.call(this._brush.move, this._updateBrushLimit(domain));
        }

        this._brushStyle();

        if (this._on.start) this._on.start();
      }
      /**
          @memberof Timeline
          @desc Overrides the default brush styles.
          @private
      */

    }, {
      key: "_brushStyle",
      value: function _brushStyle() {
        var height = this._position.height;
        var timelineHeight = this._shape === "Circle" ? typeof this._shapeConfig.r === "function" ? this._shapeConfig.r({
          tick: true
        }) * 2 : this._shapeConfig.r : this._shape === "Rect" ? typeof this._shapeConfig[height] === "function" ? this._shapeConfig[height]({
          tick: true
        }) : this._shapeConfig[height] : this._tickSize;

        var brushOverlay = this._brushGroup.selectAll(".overlay").attr("cursor", this._brushing ? "crosshair" : "pointer");

        var brushSelection = this._brushGroup.selectAll(".selection").call(attrize, this._selectionConfig).attr("height", timelineHeight);

        var brushHandle = this._brushGroup.selectAll(".handle").call(attrize, this._handleConfig).attr("height", this._buttonBehaviorCurrent === "buttons" ? this._buttonHeight : timelineHeight + this._handleSize);

        if (this._buttonBehaviorCurrent === "buttons") {
          var yTransform = this._align === "middle" ? this._height / 2 - this._buttonHeight / 2 : this._align === "start" ? this._margin.top : this._height - this._buttonHeight - this._margin.bottom;
          brushHandle.attr("y", yTransform);
          brushOverlay.attr("x", this._marginLeft).attr("width", this._ticksWidth);
          brushSelection.attr("y", yTransform);
        }
      }
      /**
          @memberof Timeline
          @desc Updates domain of the timeline used in brush functions.
          @private
      */

    }, {
      key: "_updateDomain",
      value: function _updateDomain() {
        var x = mouse(this._select.node())[0];
        var domain = event$1.selection && this._brushing ? event$1.selection : [x, x];
        if (this._buttonBehaviorCurrent === "ticks") domain = domain.map(this._d3Scale.invert);
        domain = domain.map(Number);

        if (event$1.type === "brush" && this._brushing && this._buttonBehaviorCurrent === "buttons") {
          var diffs = event$1.selection.map(function (d) {
            return Math.abs(d - event$1.sourceEvent.offsetX);
          });
          domain = diffs[1] <= diffs[0] ? [event$1.selection[0], event$1.sourceEvent.offsetX].sort(function (a, b) {
            return a - b;
          }) : [event$1.sourceEvent.offsetX, event$1.selection[1]].sort(function (a, b) {
            return a - b;
          });
        }

        var ticks = this._buttonBehaviorCurrent === "ticks" ? this._availableTicks.map(Number) : this._d3Scale.range();

        if (this._buttonBehaviorCurrent === "ticks") {
          domain[0] = date$2(closest(domain[0], ticks));
          domain[1] = date$2(closest(domain[1], ticks));
        } else {
          domain[0] = closest(domain[0], ticks);
          domain[1] = closest(domain[1], ticks);
        }

        var single = +domain[0] === +domain[1];

        if (event$1.type === "brush" || event$1.type === "end") {
          this._selection = this._buttonBehaviorCurrent === "ticks" ? single ? domain[0] : domain : single ? date$2(this._availableTicks[ticks.indexOf(domain[0])]) : [date$2(this._availableTicks[ticks.indexOf(domain[0])]), date$2(this._availableTicks[ticks.indexOf(domain[1])])];
        }

        return domain;
      }
      /**
          @memberof Timeline
          @desc Updates limits of the brush.
          @private
      */

    }, {
      key: "_updateBrushLimit",
      value: function _updateBrushLimit(domain) {
        var selection = this._buttonBehaviorCurrent === "ticks" ? domain.map(date$2).map(this._d3Scale) : domain;

        if (selection[0] === selection[1]) {
          selection[0] -= 0.1;
          selection[1] += 0.1;
        }

        if (this._buttonBehaviorCurrent === "buttons") {
          var buttonWidth = 0.5 * (this._ticksWidth / this._availableTicks.length - this._handleSize);
          selection[0] -= buttonWidth;
          selection[1] += buttonWidth;
        }

        return selection;
      }
      /**
          @memberof Timeline
          @desc Draws the timeline.
          @param {Function} [*callback* = undefined]
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        var _this2 = this;

        var _this$_position = this._position,
            height = _this$_position.height,
            y = _this$_position.y;

        if (this._buttonBehavior !== "ticks") {
          var ticks = this._ticks ? this._ticks.map(date$2) : this._domain.map(date$2);
          var d3Scale = scaleTime().domain(ticks).range([0, this._width]);
          ticks = this._ticks ? ticks : d3Scale.ticks();
          if (!this._tickFormat) this._tickFormat = d3Scale.tickFormat(ticks.length - 1, this._tickSpecifier); // Measures size of ticks

          var maxLabel = 0;
          ticks.forEach(function (d, i) {
            var f = _this2._shapeConfig.labelConfig.fontFamily(d, i),
                s = _this2._shapeConfig.labelConfig.fontSize(d, i);

            var wrap = textWrap().fontFamily(f).fontSize(s).lineHeight(_this2._shapeConfig.lineHeight ? _this2._shapeConfig.lineHeight(d, i) : undefined);
            var res = wrap(d3Scale.tickFormat(ticks.length - 1, _this2._tickSpecifier)(d));
            var width = res.lines.length ? Math.ceil(max(res.lines.map(function (line) {
              return textWidth(line, {
                "font-family": f,
                "font-size": s
              });
            }))) + s / 4 : 0;
            if (width % 2) width++;
            if (maxLabel < width) maxLabel = width + 2 * _this2._buttonPadding;
          });
          this._ticksWidth = maxLabel * ticks.length;
        }

        this._buttonBehaviorCurrent = this._buttonBehavior === "auto" ? this._ticksWidth < this._width ? "buttons" : "ticks" : this._buttonBehavior;

        if (this._buttonBehaviorCurrent === "buttons") {
          this._scale = "ordinal";
          this._labelRotation = 0;
          if (!this._brushing) this._handleSize = 0;
          var domain = scaleTime().domain(this._domain.map(date$2)).ticks().map(this._tickFormat).map(Number);
          this._domain = this._ticks ? this._ticks.map(date$2) : Array.from(Array(domain[domain.length - 1] - domain[0] + 1), function (_, x) {
            return domain[0] + x;
          }).map(date$2);
          this._ticks = this._domain;
          var buttonMargin = 0.5 * this._ticksWidth / this._ticks.length;
          this._marginLeft = this._buttonAlign === "middle" ? (this._width - this._ticksWidth) / 2 : this._buttonAlign === "end" ? this._width - this._ticksWidth : 0;
          var marginRight = this._buttonAlign === "middle" ? (this._width + this._ticksWidth) / 2 : this._buttonAlign === "start" ? this._ticksWidth : undefined;
          this._range = [this._buttonAlign === "start" ? undefined : this._marginLeft + buttonMargin, this._buttonAlign === "end" ? undefined : marginRight - buttonMargin];
        }

        if (this._ticks) this._domain = this._buttonBehaviorCurrent === "ticks" ? [this._ticks[0], this._ticks[this._ticks.length - 1]] : this._ticks.map(date$2);
        this._labels = this._ticks;

        _get$6(_getPrototypeOf$k(Timeline.prototype), "render", this).call(this, callback);

        var offset = this._outerBounds[y],
            range = this._d3Scale.range();

        var brush = this._brush = brushX().extent([[range[0], offset], [range[range.length - 1], offset + this._outerBounds[height]]]).filter(this._brushFilter).handleSize(this._handleSize).on("start", this._brushStart.bind(this)).on("brush", this._brushBrush.bind(this)).on("end", this._brushEnd.bind(this));
        var latest = this._buttonBehaviorCurrent === "ticks" ? this._availableTicks[this._availableTicks.length - 1] : range[range.length - 1];
        var selection = this._selection === void 0 ? [latest, latest] : this._selection instanceof Array ? this._buttonBehaviorCurrent === "buttons" ? this._selection.map(function (d) {
          return range[_this2._ticks.map(Number).indexOf(+d)];
        }).slice() : this._selection.slice() : this._buttonBehaviorCurrent === "buttons" ? [range[this._ticks.map(Number).indexOf(+this._selection)], range[this._ticks.map(Number).indexOf(+this._selection)]] : [this._selection, this._selection];

        this._updateBrushLimit(selection);

        this._brushGroup = elem("g.brushGroup", {
          parent: this._group
        });

        this._brushGroup.call(brush).transition(this._transition).call(brush.move, this._buttonBehaviorCurrent === "ticks" ? this._updateBrushLimit(selection) : selection);

        this._outerBounds.y -= this._handleSize / 2;
        this._outerBounds.height += this._handleSize / 2;
        return this;
      }
      /**
            @memberof Timeline
            @desc If *value* is specified, sets the button padding and returns the current class instance. If *value* is not specified, returns the current button padding.
            @param {Number} [*value* = 10]
            @chainable
        */

    }, {
      key: "buttonPadding",
      value: function buttonPadding(_) {
        return arguments.length ? (this._buttonPadding = _, this) : this._buttonPadding;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, toggles the brushing value and returns the current class instance. If *value* is not specified, returns the current brushing value.
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "brushing",
      value: function brushing(_) {
        return arguments.length ? (this._brushing = _, this) : this._brushing;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, sets the brush event filter and returns the current class instance. If *value* is not specified, returns the current brush event filter.
          @param {Function} [*value*]
          @chainable
          @example
      function() {
      return !event.button && event.detail < 2;
      }
      */

    }, {
      key: "brushFilter",
      value: function brushFilter(_) {
        return arguments.length ? (this._brushFilter = _, this) : this._brushFilter;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, toggles the horizontal alignment of the button timeline. Accepted values are `"start"`, `"middle"` and `"end"`. If *value* is not specified, returns the current button value.
          @param {String} [*value* = "middle"]
          @chainable
      */

    }, {
      key: "buttonAlign",
      value: function buttonAlign(_) {
        return arguments.length ? (this._buttonAlign = _, this) : this._buttonAlign;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, toggles the style of the timeline. Accepted values are `"auto"`, `"buttons"` and `"ticks"`. If *value* is not specified, returns the current button value.
          @param {String} [*value* = "auto"]
          @chainable
      */

    }, {
      key: "buttonBehavior",
      value: function buttonBehavior(_) {
        return arguments.length ? (this._buttonBehavior = _, this) : this._buttonBehavior;
      }
      /**
            @memberof Timeline
            @desc If *value* is specified, sets the button height and returns the current class instance. If *value* is not specified, returns the current button height.
            @param {Number} [*value* = 30]
            @chainable
        */

    }, {
      key: "buttonHeight",
      value: function buttonHeight(_) {
        return arguments.length ? (this._buttonHeight = _, this) : this._buttonHeight;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, sets the handle style and returns the current class instance. If *value* is not specified, returns the current handle style.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "handleConfig",
      value: function handleConfig(_) {
        return arguments.length ? (this._handleConfig = Object.assign(this._handleConfig, _), this) : this._handleConfig;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, sets the handle size and returns the current class instance. If *value* is not specified, returns the current handle size.
          @param {Number} [*value* = 6]
          @chainable
      */

    }, {
      key: "handleSize",
      value: function handleSize(_) {
        return arguments.length ? (this._handleSize = _, this) : this._handleSize;
      }
      /**
          @memberof Timeline
          @desc Adds or removes a *listener* for the specified brush event *typename*. If a *listener* is not specified, returns the currently-assigned listener for the specified event *typename*. Mirrors the core [d3-brush](https://github.com/d3/d3-brush#brush_on) behavior.
          @param {String|Object} [*typename*]
          @param {Function} [*listener*]
          @chainable
      */

    }, {
      key: "on",
      value: function on(_, f) {
        return arguments.length === 2 ? (this._on[_] = f, this) : arguments.length ? typeof _ === "string" ? this._on[_] : (this._on = Object.assign({}, this._on, _), this) : this._on;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, sets the selection style and returns the current class instance. If *value* is not specified, returns the current selection style.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "selectionConfig",
      value: function selectionConfig(_) {
        return arguments.length ? (this._selectionConfig = Object.assign(this._selectionConfig, _), this) : this._selectionConfig;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, sets the selection and returns the current class instance. If *value* is not specified, returns the current selection. Defaults to the most recent year in the timeline.
          @param {Array|Date|Number|String} [*value*]
          @chainable
      */

    }, {
      key: "selection",
      value: function selection(_) {
        return arguments.length ? (this._selection = _, this) : this._selection;
      }
      /**
          @memberof Timeline
          @desc If *value* is specified, toggles the snapping value and returns the current class instance. If *value* is not specified, returns the current snapping value.
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "snapping",
      value: function snapping(_) {
        return arguments.length ? (this._snapping = _, this) : this._snapping;
      }
    }]);

    return Timeline;
  }(Axis);

  /**!
   * @fileOverview Kickass library to create and place poppers near their reference elements.
   * @version 1.16.0
   * @license
   * Copyright (c) 2016 Federico Zivolo and contributors
   *
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   *
   * The above copyright notice and this permission notice shall be included in all
   * copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
   * SOFTWARE.
   */
  var isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined' && typeof navigator !== 'undefined';

  var timeoutDuration = function () {
    var longerTimeoutBrowsers = ['Edge', 'Trident', 'Firefox'];

    for (var i = 0; i < longerTimeoutBrowsers.length; i += 1) {
      if (isBrowser && navigator.userAgent.indexOf(longerTimeoutBrowsers[i]) >= 0) {
        return 1;
      }
    }

    return 0;
  }();

  function microtaskDebounce(fn) {
    var called = false;
    return function () {
      if (called) {
        return;
      }

      called = true;
      window.Promise.resolve().then(function () {
        called = false;
        fn();
      });
    };
  }

  function taskDebounce(fn) {
    var scheduled = false;
    return function () {
      if (!scheduled) {
        scheduled = true;
        setTimeout(function () {
          scheduled = false;
          fn();
        }, timeoutDuration);
      }
    };
  }

  var supportsMicroTasks = isBrowser && window.Promise;
  /**
  * Create a debounced version of a method, that's asynchronously deferred
  * but called in the minimum time possible.
  *
  * @method
  * @memberof Popper.Utils
  * @argument {Function} fn
  * @returns {Function}
  */

  var debounce = supportsMicroTasks ? microtaskDebounce : taskDebounce;
  /**
   * Check if the given variable is a function
   * @method
   * @memberof Popper.Utils
   * @argument {Any} functionToCheck - variable to check
   * @returns {Boolean} answer to: is a function?
   */

  function isFunction(functionToCheck) {
    var getType = {};
    return functionToCheck && getType.toString.call(functionToCheck) === '[object Function]';
  }
  /**
   * Get CSS computed property of the given element
   * @method
   * @memberof Popper.Utils
   * @argument {Eement} element
   * @argument {String} property
   */


  function getStyleComputedProperty(element, property) {
    if (element.nodeType !== 1) {
      return [];
    } // NOTE: 1 DOM access here


    var window = element.ownerDocument.defaultView;
    var css = window.getComputedStyle(element, null);
    return property ? css[property] : css;
  }
  /**
   * Returns the parentNode or the host of the element
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element
   * @returns {Element} parent
   */


  function getParentNode(element) {
    if (element.nodeName === 'HTML') {
      return element;
    }

    return element.parentNode || element.host;
  }
  /**
   * Returns the scrolling parent of the given element
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element
   * @returns {Element} scroll parent
   */


  function getScrollParent(element) {
    // Return body, `getScroll` will take care to get the correct `scrollTop` from it
    if (!element) {
      return document.body;
    }

    switch (element.nodeName) {
      case 'HTML':
      case 'BODY':
        return element.ownerDocument.body;

      case '#document':
        return element.body;
    } // Firefox want us to check `-x` and `-y` variations as well


    var _getStyleComputedProp = getStyleComputedProperty(element),
        overflow = _getStyleComputedProp.overflow,
        overflowX = _getStyleComputedProp.overflowX,
        overflowY = _getStyleComputedProp.overflowY;

    if (/(auto|scroll|overlay)/.test(overflow + overflowY + overflowX)) {
      return element;
    }

    return getScrollParent(getParentNode(element));
  }
  /**
   * Returns the reference node of the reference object, or the reference object itself.
   * @method
   * @memberof Popper.Utils
   * @param {Element|Object} reference - the reference element (the popper will be relative to this)
   * @returns {Element} parent
   */


  function getReferenceNode(reference) {
    return reference && reference.referenceNode ? reference.referenceNode : reference;
  }

  var isIE11 = isBrowser && !!(window.MSInputMethodContext && document.documentMode);
  var isIE10 = isBrowser && /MSIE 10/.test(navigator.userAgent);
  /**
   * Determines if the browser is Internet Explorer
   * @method
   * @memberof Popper.Utils
   * @param {Number} version to check
   * @returns {Boolean} isIE
   */

  function isIE(version) {
    if (version === 11) {
      return isIE11;
    }

    if (version === 10) {
      return isIE10;
    }

    return isIE11 || isIE10;
  }
  /**
   * Returns the offset parent of the given element
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element
   * @returns {Element} offset parent
   */


  function getOffsetParent(element) {
    if (!element) {
      return document.documentElement;
    }

    var noOffsetParent = isIE(10) ? document.body : null; // NOTE: 1 DOM access here

    var offsetParent = element.offsetParent || null; // Skip hidden elements which don't have an offsetParent

    while (offsetParent === noOffsetParent && element.nextElementSibling) {
      offsetParent = (element = element.nextElementSibling).offsetParent;
    }

    var nodeName = offsetParent && offsetParent.nodeName;

    if (!nodeName || nodeName === 'BODY' || nodeName === 'HTML') {
      return element ? element.ownerDocument.documentElement : document.documentElement;
    } // .offsetParent will return the closest TH, TD or TABLE in case
    // no offsetParent is present, I hate this job...


    if (['TH', 'TD', 'TABLE'].indexOf(offsetParent.nodeName) !== -1 && getStyleComputedProperty(offsetParent, 'position') === 'static') {
      return getOffsetParent(offsetParent);
    }

    return offsetParent;
  }

  function isOffsetContainer(element) {
    var nodeName = element.nodeName;

    if (nodeName === 'BODY') {
      return false;
    }

    return nodeName === 'HTML' || getOffsetParent(element.firstElementChild) === element;
  }
  /**
   * Finds the root node (document, shadowDOM root) of the given element
   * @method
   * @memberof Popper.Utils
   * @argument {Element} node
   * @returns {Element} root node
   */


  function getRoot(node) {
    if (node.parentNode !== null) {
      return getRoot(node.parentNode);
    }

    return node;
  }
  /**
   * Finds the offset parent common to the two provided nodes
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element1
   * @argument {Element} element2
   * @returns {Element} common offset parent
   */


  function findCommonOffsetParent(element1, element2) {
    // This check is needed to avoid errors in case one of the elements isn't defined for any reason
    if (!element1 || !element1.nodeType || !element2 || !element2.nodeType) {
      return document.documentElement;
    } // Here we make sure to give as "start" the element that comes first in the DOM


    var order = element1.compareDocumentPosition(element2) & Node.DOCUMENT_POSITION_FOLLOWING;
    var start = order ? element1 : element2;
    var end = order ? element2 : element1; // Get common ancestor container

    var range = document.createRange();
    range.setStart(start, 0);
    range.setEnd(end, 0);
    var commonAncestorContainer = range.commonAncestorContainer; // Both nodes are inside #document

    if (element1 !== commonAncestorContainer && element2 !== commonAncestorContainer || start.contains(end)) {
      if (isOffsetContainer(commonAncestorContainer)) {
        return commonAncestorContainer;
      }

      return getOffsetParent(commonAncestorContainer);
    } // one of the nodes is inside shadowDOM, find which one


    var element1root = getRoot(element1);

    if (element1root.host) {
      return findCommonOffsetParent(element1root.host, element2);
    } else {
      return findCommonOffsetParent(element1, getRoot(element2).host);
    }
  }
  /**
   * Gets the scroll value of the given element in the given side (top and left)
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element
   * @argument {String} side `top` or `left`
   * @returns {number} amount of scrolled pixels
   */


  function getScroll(element) {
    var side = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'top';
    var upperSide = side === 'top' ? 'scrollTop' : 'scrollLeft';
    var nodeName = element.nodeName;

    if (nodeName === 'BODY' || nodeName === 'HTML') {
      var html = element.ownerDocument.documentElement;
      var scrollingElement = element.ownerDocument.scrollingElement || html;
      return scrollingElement[upperSide];
    }

    return element[upperSide];
  }
  /*
   * Sum or subtract the element scroll values (left and top) from a given rect object
   * @method
   * @memberof Popper.Utils
   * @param {Object} rect - Rect object you want to change
   * @param {HTMLElement} element - The element from the function reads the scroll values
   * @param {Boolean} subtract - set to true if you want to subtract the scroll values
   * @return {Object} rect - The modifier rect object
   */


  function includeScroll(rect, element) {
    var subtract = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var scrollTop = getScroll(element, 'top');
    var scrollLeft = getScroll(element, 'left');
    var modifier = subtract ? -1 : 1;
    rect.top += scrollTop * modifier;
    rect.bottom += scrollTop * modifier;
    rect.left += scrollLeft * modifier;
    rect.right += scrollLeft * modifier;
    return rect;
  }
  /*
   * Helper to detect borders of a given element
   * @method
   * @memberof Popper.Utils
   * @param {CSSStyleDeclaration} styles
   * Result of `getStyleComputedProperty` on the given element
   * @param {String} axis - `x` or `y`
   * @return {number} borders - The borders size of the given axis
   */


  function getBordersSize(styles, axis) {
    var sideA = axis === 'x' ? 'Left' : 'Top';
    var sideB = sideA === 'Left' ? 'Right' : 'Bottom';
    return parseFloat(styles['border' + sideA + 'Width'], 10) + parseFloat(styles['border' + sideB + 'Width'], 10);
  }

  function getSize(axis, body, html, computedStyle) {
    return Math.max(body['offset' + axis], body['scroll' + axis], html['client' + axis], html['offset' + axis], html['scroll' + axis], isIE(10) ? parseInt(html['offset' + axis]) + parseInt(computedStyle['margin' + (axis === 'Height' ? 'Top' : 'Left')]) + parseInt(computedStyle['margin' + (axis === 'Height' ? 'Bottom' : 'Right')]) : 0);
  }

  function getWindowSizes(document) {
    var body = document.body;
    var html = document.documentElement;
    var computedStyle = isIE(10) && getComputedStyle(html);
    return {
      height: getSize('Height', body, html, computedStyle),
      width: getSize('Width', body, html, computedStyle)
    };
  }

  var classCallCheck = function classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  };

  var createClass = function () {
    function defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor) descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }

    return function (Constructor, protoProps, staticProps) {
      if (protoProps) defineProperties(Constructor.prototype, protoProps);
      if (staticProps) defineProperties(Constructor, staticProps);
      return Constructor;
    };
  }();

  var defineProperty = function defineProperty(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  };

  var _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };
  /**
   * Given element offsets, generate an output similar to getBoundingClientRect
   * @method
   * @memberof Popper.Utils
   * @argument {Object} offsets
   * @returns {Object} ClientRect like output
   */


  function getClientRect(offsets) {
    return _extends({}, offsets, {
      right: offsets.left + offsets.width,
      bottom: offsets.top + offsets.height
    });
  }
  /**
   * Get bounding client rect of given element
   * @method
   * @memberof Popper.Utils
   * @param {HTMLElement} element
   * @return {Object} client rect
   */


  function getBoundingClientRect(element) {
    var rect = {}; // IE10 10 FIX: Please, don't ask, the element isn't
    // considered in DOM in some circumstances...
    // This isn't reproducible in IE10 compatibility mode of IE11

    try {
      if (isIE(10)) {
        rect = element.getBoundingClientRect();
        var scrollTop = getScroll(element, 'top');
        var scrollLeft = getScroll(element, 'left');
        rect.top += scrollTop;
        rect.left += scrollLeft;
        rect.bottom += scrollTop;
        rect.right += scrollLeft;
      } else {
        rect = element.getBoundingClientRect();
      }
    } catch (e) {}

    var result = {
      left: rect.left,
      top: rect.top,
      width: rect.right - rect.left,
      height: rect.bottom - rect.top
    }; // subtract scrollbar size from sizes

    var sizes = element.nodeName === 'HTML' ? getWindowSizes(element.ownerDocument) : {};
    var width = sizes.width || element.clientWidth || result.width;
    var height = sizes.height || element.clientHeight || result.height;
    var horizScrollbar = element.offsetWidth - width;
    var vertScrollbar = element.offsetHeight - height; // if an hypothetical scrollbar is detected, we must be sure it's not a `border`
    // we make this check conditional for performance reasons

    if (horizScrollbar || vertScrollbar) {
      var styles = getStyleComputedProperty(element);
      horizScrollbar -= getBordersSize(styles, 'x');
      vertScrollbar -= getBordersSize(styles, 'y');
      result.width -= horizScrollbar;
      result.height -= vertScrollbar;
    }

    return getClientRect(result);
  }

  function getOffsetRectRelativeToArbitraryNode(children, parent) {
    var fixedPosition = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var isIE10 = isIE(10);
    var isHTML = parent.nodeName === 'HTML';
    var childrenRect = getBoundingClientRect(children);
    var parentRect = getBoundingClientRect(parent);
    var scrollParent = getScrollParent(children);
    var styles = getStyleComputedProperty(parent);
    var borderTopWidth = parseFloat(styles.borderTopWidth, 10);
    var borderLeftWidth = parseFloat(styles.borderLeftWidth, 10); // In cases where the parent is fixed, we must ignore negative scroll in offset calc

    if (fixedPosition && isHTML) {
      parentRect.top = Math.max(parentRect.top, 0);
      parentRect.left = Math.max(parentRect.left, 0);
    }

    var offsets = getClientRect({
      top: childrenRect.top - parentRect.top - borderTopWidth,
      left: childrenRect.left - parentRect.left - borderLeftWidth,
      width: childrenRect.width,
      height: childrenRect.height
    });
    offsets.marginTop = 0;
    offsets.marginLeft = 0; // Subtract margins of documentElement in case it's being used as parent
    // we do this only on HTML because it's the only element that behaves
    // differently when margins are applied to it. The margins are included in
    // the box of the documentElement, in the other cases not.

    if (!isIE10 && isHTML) {
      var marginTop = parseFloat(styles.marginTop, 10);
      var marginLeft = parseFloat(styles.marginLeft, 10);
      offsets.top -= borderTopWidth - marginTop;
      offsets.bottom -= borderTopWidth - marginTop;
      offsets.left -= borderLeftWidth - marginLeft;
      offsets.right -= borderLeftWidth - marginLeft; // Attach marginTop and marginLeft because in some circumstances we may need them

      offsets.marginTop = marginTop;
      offsets.marginLeft = marginLeft;
    }

    if (isIE10 && !fixedPosition ? parent.contains(scrollParent) : parent === scrollParent && scrollParent.nodeName !== 'BODY') {
      offsets = includeScroll(offsets, parent);
    }

    return offsets;
  }

  function getViewportOffsetRectRelativeToArtbitraryNode(element) {
    var excludeScroll = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var html = element.ownerDocument.documentElement;
    var relativeOffset = getOffsetRectRelativeToArbitraryNode(element, html);
    var width = Math.max(html.clientWidth, window.innerWidth || 0);
    var height = Math.max(html.clientHeight, window.innerHeight || 0);
    var scrollTop = !excludeScroll ? getScroll(html) : 0;
    var scrollLeft = !excludeScroll ? getScroll(html, 'left') : 0;
    var offset = {
      top: scrollTop - relativeOffset.top + relativeOffset.marginTop,
      left: scrollLeft - relativeOffset.left + relativeOffset.marginLeft,
      width: width,
      height: height
    };
    return getClientRect(offset);
  }
  /**
   * Check if the given element is fixed or is inside a fixed parent
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element
   * @argument {Element} customContainer
   * @returns {Boolean} answer to "isFixed?"
   */


  function isFixed(element) {
    var nodeName = element.nodeName;

    if (nodeName === 'BODY' || nodeName === 'HTML') {
      return false;
    }

    if (getStyleComputedProperty(element, 'position') === 'fixed') {
      return true;
    }

    var parentNode = getParentNode(element);

    if (!parentNode) {
      return false;
    }

    return isFixed(parentNode);
  }
  /**
   * Finds the first parent of an element that has a transformed property defined
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element
   * @returns {Element} first transformed parent or documentElement
   */


  function getFixedPositionOffsetParent(element) {
    // This check is needed to avoid errors in case one of the elements isn't defined for any reason
    if (!element || !element.parentElement || isIE()) {
      return document.documentElement;
    }

    var el = element.parentElement;

    while (el && getStyleComputedProperty(el, 'transform') === 'none') {
      el = el.parentElement;
    }

    return el || document.documentElement;
  }
  /**
   * Computed the boundaries limits and return them
   * @method
   * @memberof Popper.Utils
   * @param {HTMLElement} popper
   * @param {HTMLElement} reference
   * @param {number} padding
   * @param {HTMLElement} boundariesElement - Element used to define the boundaries
   * @param {Boolean} fixedPosition - Is in fixed position mode
   * @returns {Object} Coordinates of the boundaries
   */


  function getBoundaries(popper, reference, padding, boundariesElement) {
    var fixedPosition = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false; // NOTE: 1 DOM access here

    var boundaries = {
      top: 0,
      left: 0
    };
    var offsetParent = fixedPosition ? getFixedPositionOffsetParent(popper) : findCommonOffsetParent(popper, getReferenceNode(reference)); // Handle viewport case

    if (boundariesElement === 'viewport') {
      boundaries = getViewportOffsetRectRelativeToArtbitraryNode(offsetParent, fixedPosition);
    } else {
      // Handle other cases based on DOM element used as boundaries
      var boundariesNode = void 0;

      if (boundariesElement === 'scrollParent') {
        boundariesNode = getScrollParent(getParentNode(reference));

        if (boundariesNode.nodeName === 'BODY') {
          boundariesNode = popper.ownerDocument.documentElement;
        }
      } else if (boundariesElement === 'window') {
        boundariesNode = popper.ownerDocument.documentElement;
      } else {
        boundariesNode = boundariesElement;
      }

      var offsets = getOffsetRectRelativeToArbitraryNode(boundariesNode, offsetParent, fixedPosition); // In case of HTML, we need a different computation

      if (boundariesNode.nodeName === 'HTML' && !isFixed(offsetParent)) {
        var _getWindowSizes = getWindowSizes(popper.ownerDocument),
            height = _getWindowSizes.height,
            width = _getWindowSizes.width;

        boundaries.top += offsets.top - offsets.marginTop;
        boundaries.bottom = height + offsets.top;
        boundaries.left += offsets.left - offsets.marginLeft;
        boundaries.right = width + offsets.left;
      } else {
        // for all the other DOM elements, this one is good
        boundaries = offsets;
      }
    } // Add paddings


    padding = padding || 0;
    var isPaddingNumber = typeof padding === 'number';
    boundaries.left += isPaddingNumber ? padding : padding.left || 0;
    boundaries.top += isPaddingNumber ? padding : padding.top || 0;
    boundaries.right -= isPaddingNumber ? padding : padding.right || 0;
    boundaries.bottom -= isPaddingNumber ? padding : padding.bottom || 0;
    return boundaries;
  }

  function getArea(_ref) {
    var width = _ref.width,
        height = _ref.height;
    return width * height;
  }
  /**
   * Utility used to transform the `auto` placement to the placement with more
   * available space.
   * @method
   * @memberof Popper.Utils
   * @argument {Object} data - The data object generated by update method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */


  function computeAutoPlacement(placement, refRect, popper, reference, boundariesElement) {
    var padding = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;

    if (placement.indexOf('auto') === -1) {
      return placement;
    }

    var boundaries = getBoundaries(popper, reference, padding, boundariesElement);
    var rects = {
      top: {
        width: boundaries.width,
        height: refRect.top - boundaries.top
      },
      right: {
        width: boundaries.right - refRect.right,
        height: boundaries.height
      },
      bottom: {
        width: boundaries.width,
        height: boundaries.bottom - refRect.bottom
      },
      left: {
        width: refRect.left - boundaries.left,
        height: boundaries.height
      }
    };
    var sortedAreas = Object.keys(rects).map(function (key) {
      return _extends({
        key: key
      }, rects[key], {
        area: getArea(rects[key])
      });
    }).sort(function (a, b) {
      return b.area - a.area;
    });
    var filteredAreas = sortedAreas.filter(function (_ref2) {
      var width = _ref2.width,
          height = _ref2.height;
      return width >= popper.clientWidth && height >= popper.clientHeight;
    });
    var computedPlacement = filteredAreas.length > 0 ? filteredAreas[0].key : sortedAreas[0].key;
    var variation = placement.split('-')[1];
    return computedPlacement + (variation ? '-' + variation : '');
  }
  /**
   * Get offsets to the reference element
   * @method
   * @memberof Popper.Utils
   * @param {Object} state
   * @param {Element} popper - the popper element
   * @param {Element} reference - the reference element (the popper will be relative to this)
   * @param {Element} fixedPosition - is in fixed position mode
   * @returns {Object} An object containing the offsets which will be applied to the popper
   */


  function getReferenceOffsets(state, popper, reference) {
    var fixedPosition = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
    var commonOffsetParent = fixedPosition ? getFixedPositionOffsetParent(popper) : findCommonOffsetParent(popper, getReferenceNode(reference));
    return getOffsetRectRelativeToArbitraryNode(reference, commonOffsetParent, fixedPosition);
  }
  /**
   * Get the outer sizes of the given element (offset size + margins)
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element
   * @returns {Object} object containing width and height properties
   */


  function getOuterSizes(element) {
    var window = element.ownerDocument.defaultView;
    var styles = window.getComputedStyle(element);
    var x = parseFloat(styles.marginTop || 0) + parseFloat(styles.marginBottom || 0);
    var y = parseFloat(styles.marginLeft || 0) + parseFloat(styles.marginRight || 0);
    var result = {
      width: element.offsetWidth + y,
      height: element.offsetHeight + x
    };
    return result;
  }
  /**
   * Get the opposite placement of the given one
   * @method
   * @memberof Popper.Utils
   * @argument {String} placement
   * @returns {String} flipped placement
   */


  function getOppositePlacement(placement) {
    var hash = {
      left: 'right',
      right: 'left',
      bottom: 'top',
      top: 'bottom'
    };
    return placement.replace(/left|right|bottom|top/g, function (matched) {
      return hash[matched];
    });
  }
  /**
   * Get offsets to the popper
   * @method
   * @memberof Popper.Utils
   * @param {Object} position - CSS position the Popper will get applied
   * @param {HTMLElement} popper - the popper element
   * @param {Object} referenceOffsets - the reference offsets (the popper will be relative to this)
   * @param {String} placement - one of the valid placement options
   * @returns {Object} popperOffsets - An object containing the offsets which will be applied to the popper
   */


  function getPopperOffsets(popper, referenceOffsets, placement) {
    placement = placement.split('-')[0]; // Get popper node sizes

    var popperRect = getOuterSizes(popper); // Add position, width and height to our offsets object

    var popperOffsets = {
      width: popperRect.width,
      height: popperRect.height
    }; // depending by the popper placement we have to compute its offsets slightly differently

    var isHoriz = ['right', 'left'].indexOf(placement) !== -1;
    var mainSide = isHoriz ? 'top' : 'left';
    var secondarySide = isHoriz ? 'left' : 'top';
    var measurement = isHoriz ? 'height' : 'width';
    var secondaryMeasurement = !isHoriz ? 'height' : 'width';
    popperOffsets[mainSide] = referenceOffsets[mainSide] + referenceOffsets[measurement] / 2 - popperRect[measurement] / 2;

    if (placement === secondarySide) {
      popperOffsets[secondarySide] = referenceOffsets[secondarySide] - popperRect[secondaryMeasurement];
    } else {
      popperOffsets[secondarySide] = referenceOffsets[getOppositePlacement(secondarySide)];
    }

    return popperOffsets;
  }
  /**
   * Mimics the `find` method of Array
   * @method
   * @memberof Popper.Utils
   * @argument {Array} arr
   * @argument prop
   * @argument value
   * @returns index or -1
   */


  function find(arr, check) {
    // use native find if supported
    if (Array.prototype.find) {
      return arr.find(check);
    } // use `filter` to obtain the same behavior of `find`


    return arr.filter(check)[0];
  }
  /**
   * Return the index of the matching object
   * @method
   * @memberof Popper.Utils
   * @argument {Array} arr
   * @argument prop
   * @argument value
   * @returns index or -1
   */


  function findIndex(arr, prop, value) {
    // use native findIndex if supported
    if (Array.prototype.findIndex) {
      return arr.findIndex(function (cur) {
        return cur[prop] === value;
      });
    } // use `find` + `indexOf` if `findIndex` isn't supported


    var match = find(arr, function (obj) {
      return obj[prop] === value;
    });
    return arr.indexOf(match);
  }
  /**
   * Loop trough the list of modifiers and run them in order,
   * each of them will then edit the data object.
   * @method
   * @memberof Popper.Utils
   * @param {dataObject} data
   * @param {Array} modifiers
   * @param {String} ends - Optional modifier name used as stopper
   * @returns {dataObject}
   */


  function runModifiers(modifiers, data, ends) {
    var modifiersToRun = ends === undefined ? modifiers : modifiers.slice(0, findIndex(modifiers, 'name', ends));
    modifiersToRun.forEach(function (modifier) {
      if (modifier['function']) {
        // eslint-disable-line dot-notation
        console.warn('`modifier.function` is deprecated, use `modifier.fn`!');
      }

      var fn = modifier['function'] || modifier.fn; // eslint-disable-line dot-notation

      if (modifier.enabled && isFunction(fn)) {
        // Add properties to offsets to make them a complete clientRect object
        // we do this before each modifier to make sure the previous one doesn't
        // mess with these values
        data.offsets.popper = getClientRect(data.offsets.popper);
        data.offsets.reference = getClientRect(data.offsets.reference);
        data = fn(data, modifier);
      }
    });
    return data;
  }
  /**
   * Updates the position of the popper, computing the new offsets and applying
   * the new style.<br />
   * Prefer `scheduleUpdate` over `update` because of performance reasons.
   * @method
   * @memberof Popper
   */


  function update() {
    // if popper is destroyed, don't perform any further update
    if (this.state.isDestroyed) {
      return;
    }

    var data = {
      instance: this,
      styles: {},
      arrowStyles: {},
      attributes: {},
      flipped: false,
      offsets: {}
    }; // compute reference element offsets

    data.offsets.reference = getReferenceOffsets(this.state, this.popper, this.reference, this.options.positionFixed); // compute auto placement, store placement inside the data object,
    // modifiers will be able to edit `placement` if needed
    // and refer to originalPlacement to know the original value

    data.placement = computeAutoPlacement(this.options.placement, data.offsets.reference, this.popper, this.reference, this.options.modifiers.flip.boundariesElement, this.options.modifiers.flip.padding); // store the computed placement inside `originalPlacement`

    data.originalPlacement = data.placement;
    data.positionFixed = this.options.positionFixed; // compute the popper offsets

    data.offsets.popper = getPopperOffsets(this.popper, data.offsets.reference, data.placement);
    data.offsets.popper.position = this.options.positionFixed ? 'fixed' : 'absolute'; // run the modifiers

    data = runModifiers(this.modifiers, data); // the first `update` will call `onCreate` callback
    // the other ones will call `onUpdate` callback

    if (!this.state.isCreated) {
      this.state.isCreated = true;
      this.options.onCreate(data);
    } else {
      this.options.onUpdate(data);
    }
  }
  /**
   * Helper used to know if the given modifier is enabled.
   * @method
   * @memberof Popper.Utils
   * @returns {Boolean}
   */


  function isModifierEnabled(modifiers, modifierName) {
    return modifiers.some(function (_ref) {
      var name = _ref.name,
          enabled = _ref.enabled;
      return enabled && name === modifierName;
    });
  }
  /**
   * Get the prefixed supported property name
   * @method
   * @memberof Popper.Utils
   * @argument {String} property (camelCase)
   * @returns {String} prefixed property (camelCase or PascalCase, depending on the vendor prefix)
   */


  function getSupportedPropertyName(property) {
    var prefixes = [false, 'ms', 'Webkit', 'Moz', 'O'];
    var upperProp = property.charAt(0).toUpperCase() + property.slice(1);

    for (var i = 0; i < prefixes.length; i++) {
      var prefix = prefixes[i];
      var toCheck = prefix ? '' + prefix + upperProp : property;

      if (typeof document.body.style[toCheck] !== 'undefined') {
        return toCheck;
      }
    }

    return null;
  }
  /**
   * Destroys the popper.
   * @method
   * @memberof Popper
   */


  function destroy() {
    this.state.isDestroyed = true; // touch DOM only if `applyStyle` modifier is enabled

    if (isModifierEnabled(this.modifiers, 'applyStyle')) {
      this.popper.removeAttribute('x-placement');
      this.popper.style.position = '';
      this.popper.style.top = '';
      this.popper.style.left = '';
      this.popper.style.right = '';
      this.popper.style.bottom = '';
      this.popper.style.willChange = '';
      this.popper.style[getSupportedPropertyName('transform')] = '';
    }

    this.disableEventListeners(); // remove the popper if user explicitly asked for the deletion on destroy
    // do not use `remove` because IE11 doesn't support it

    if (this.options.removeOnDestroy) {
      this.popper.parentNode.removeChild(this.popper);
    }

    return this;
  }
  /**
   * Get the window associated with the element
   * @argument {Element} element
   * @returns {Window}
   */


  function getWindow(element) {
    var ownerDocument = element.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView : window;
  }

  function attachToScrollParents(scrollParent, event, callback, scrollParents) {
    var isBody = scrollParent.nodeName === 'BODY';
    var target = isBody ? scrollParent.ownerDocument.defaultView : scrollParent;
    target.addEventListener(event, callback, {
      passive: true
    });

    if (!isBody) {
      attachToScrollParents(getScrollParent(target.parentNode), event, callback, scrollParents);
    }

    scrollParents.push(target);
  }
  /**
   * Setup needed event listeners used to update the popper position
   * @method
   * @memberof Popper.Utils
   * @private
   */


  function setupEventListeners(reference, options, state, updateBound) {
    // Resize event listener on window
    state.updateBound = updateBound;
    getWindow(reference).addEventListener('resize', state.updateBound, {
      passive: true
    }); // Scroll event listener on scroll parents

    var scrollElement = getScrollParent(reference);
    attachToScrollParents(scrollElement, 'scroll', state.updateBound, state.scrollParents);
    state.scrollElement = scrollElement;
    state.eventsEnabled = true;
    return state;
  }
  /**
   * It will add resize/scroll events and start recalculating
   * position of the popper element when they are triggered.
   * @method
   * @memberof Popper
   */


  function enableEventListeners() {
    if (!this.state.eventsEnabled) {
      this.state = setupEventListeners(this.reference, this.options, this.state, this.scheduleUpdate);
    }
  }
  /**
   * Remove event listeners used to update the popper position
   * @method
   * @memberof Popper.Utils
   * @private
   */


  function removeEventListeners(reference, state) {
    // Remove resize event listener on window
    getWindow(reference).removeEventListener('resize', state.updateBound); // Remove scroll event listener on scroll parents

    state.scrollParents.forEach(function (target) {
      target.removeEventListener('scroll', state.updateBound);
    }); // Reset state

    state.updateBound = null;
    state.scrollParents = [];
    state.scrollElement = null;
    state.eventsEnabled = false;
    return state;
  }
  /**
   * It will remove resize/scroll events and won't recalculate popper position
   * when they are triggered. It also won't trigger `onUpdate` callback anymore,
   * unless you call `update` method manually.
   * @method
   * @memberof Popper
   */


  function disableEventListeners() {
    if (this.state.eventsEnabled) {
      cancelAnimationFrame(this.scheduleUpdate);
      this.state = removeEventListeners(this.reference, this.state);
    }
  }
  /**
   * Tells if a given input is a number
   * @method
   * @memberof Popper.Utils
   * @param {*} input to check
   * @return {Boolean}
   */


  function isNumeric(n) {
    return n !== '' && !isNaN(parseFloat(n)) && isFinite(n);
  }
  /**
   * Set the style to the given popper
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element - Element to apply the style to
   * @argument {Object} styles
   * Object with a list of properties and values which will be applied to the element
   */


  function setStyles(element, styles) {
    Object.keys(styles).forEach(function (prop) {
      var unit = ''; // add unit if the value is numeric and is one of the following

      if (['width', 'height', 'top', 'right', 'bottom', 'left'].indexOf(prop) !== -1 && isNumeric(styles[prop])) {
        unit = 'px';
      }

      element.style[prop] = styles[prop] + unit;
    });
  }
  /**
   * Set the attributes to the given popper
   * @method
   * @memberof Popper.Utils
   * @argument {Element} element - Element to apply the attributes to
   * @argument {Object} styles
   * Object with a list of properties and values which will be applied to the element
   */


  function setAttributes(element, attributes) {
    Object.keys(attributes).forEach(function (prop) {
      var value = attributes[prop];

      if (value !== false) {
        element.setAttribute(prop, attributes[prop]);
      } else {
        element.removeAttribute(prop);
      }
    });
  }
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by `update` method
   * @argument {Object} data.styles - List of style properties - values to apply to popper element
   * @argument {Object} data.attributes - List of attribute properties - values to apply to popper element
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The same data object
   */


  function applyStyle(data) {
    // any property present in `data.styles` will be applied to the popper,
    // in this way we can make the 3rd party modifiers add custom styles to it
    // Be aware, modifiers could override the properties defined in the previous
    // lines of this modifier!
    setStyles(data.instance.popper, data.styles); // any property present in `data.attributes` will be applied to the popper,
    // they will be set as HTML attributes of the element

    setAttributes(data.instance.popper, data.attributes); // if arrowElement is defined and arrowStyles has some properties

    if (data.arrowElement && Object.keys(data.arrowStyles).length) {
      setStyles(data.arrowElement, data.arrowStyles);
    }

    return data;
  }
  /**
   * Set the x-placement attribute before everything else because it could be used
   * to add margins to the popper margins needs to be calculated to get the
   * correct popper offsets.
   * @method
   * @memberof Popper.modifiers
   * @param {HTMLElement} reference - The reference element used to position the popper
   * @param {HTMLElement} popper - The HTML element used as popper
   * @param {Object} options - Popper.js options
   */


  function applyStyleOnLoad(reference, popper, options, modifierOptions, state) {
    // compute reference element offsets
    var referenceOffsets = getReferenceOffsets(state, popper, reference, options.positionFixed); // compute auto placement, store placement inside the data object,
    // modifiers will be able to edit `placement` if needed
    // and refer to originalPlacement to know the original value

    var placement = computeAutoPlacement(options.placement, referenceOffsets, popper, reference, options.modifiers.flip.boundariesElement, options.modifiers.flip.padding);
    popper.setAttribute('x-placement', placement); // Apply `position` to popper before anything else because
    // without the position applied we can't guarantee correct computations

    setStyles(popper, {
      position: options.positionFixed ? 'fixed' : 'absolute'
    });
    return options;
  }
  /**
   * @function
   * @memberof Popper.Utils
   * @argument {Object} data - The data object generated by `update` method
   * @argument {Boolean} shouldRound - If the offsets should be rounded at all
   * @returns {Object} The popper's position offsets rounded
   *
   * The tale of pixel-perfect positioning. It's still not 100% perfect, but as
   * good as it can be within reason.
   * Discussion here: https://github.com/FezVrasta/popper.js/pull/715
   *
   * Low DPI screens cause a popper to be blurry if not using full pixels (Safari
   * as well on High DPI screens).
   *
   * Firefox prefers no rounding for positioning and does not have blurriness on
   * high DPI screens.
   *
   * Only horizontal placement and left/right values need to be considered.
   */


  function getRoundedOffsets(data, shouldRound) {
    var _data$offsets = data.offsets,
        popper = _data$offsets.popper,
        reference = _data$offsets.reference;
    var round = Math.round,
        floor = Math.floor;

    var noRound = function noRound(v) {
      return v;
    };

    var referenceWidth = round(reference.width);
    var popperWidth = round(popper.width);
    var isVertical = ['left', 'right'].indexOf(data.placement) !== -1;
    var isVariation = data.placement.indexOf('-') !== -1;
    var sameWidthParity = referenceWidth % 2 === popperWidth % 2;
    var bothOddWidth = referenceWidth % 2 === 1 && popperWidth % 2 === 1;
    var horizontalToInteger = !shouldRound ? noRound : isVertical || isVariation || sameWidthParity ? round : floor;
    var verticalToInteger = !shouldRound ? noRound : round;
    return {
      left: horizontalToInteger(bothOddWidth && !isVariation && shouldRound ? popper.left - 1 : popper.left),
      top: verticalToInteger(popper.top),
      bottom: verticalToInteger(popper.bottom),
      right: horizontalToInteger(popper.right)
    };
  }

  var isFirefox = isBrowser && /Firefox/i.test(navigator.userAgent);
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by `update` method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */

  function computeStyle(data, options) {
    var x = options.x,
        y = options.y;
    var popper = data.offsets.popper; // Remove this legacy support in Popper.js v2

    var legacyGpuAccelerationOption = find(data.instance.modifiers, function (modifier) {
      return modifier.name === 'applyStyle';
    }).gpuAcceleration;

    if (legacyGpuAccelerationOption !== undefined) {
      console.warn('WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!');
    }

    var gpuAcceleration = legacyGpuAccelerationOption !== undefined ? legacyGpuAccelerationOption : options.gpuAcceleration;
    var offsetParent = getOffsetParent(data.instance.popper);
    var offsetParentRect = getBoundingClientRect(offsetParent); // Styles

    var styles = {
      position: popper.position
    };
    var offsets = getRoundedOffsets(data, window.devicePixelRatio < 2 || !isFirefox);
    var sideA = x === 'bottom' ? 'top' : 'bottom';
    var sideB = y === 'right' ? 'left' : 'right'; // if gpuAcceleration is set to `true` and transform is supported,
    //  we use `translate3d` to apply the position to the popper we
    // automatically use the supported prefixed version if needed

    var prefixedProperty = getSupportedPropertyName('transform'); // now, let's make a step back and look at this code closely (wtf?)
    // If the content of the popper grows once it's been positioned, it
    // may happen that the popper gets misplaced because of the new content
    // overflowing its reference element
    // To avoid this problem, we provide two options (x and y), which allow
    // the consumer to define the offset origin.
    // If we position a popper on top of a reference element, we can set
    // `x` to `top` to make the popper grow towards its top instead of
    // its bottom.

    var left = void 0,
        top = void 0;

    if (sideA === 'bottom') {
      // when offsetParent is <html> the positioning is relative to the bottom of the screen (excluding the scrollbar)
      // and not the bottom of the html element
      if (offsetParent.nodeName === 'HTML') {
        top = -offsetParent.clientHeight + offsets.bottom;
      } else {
        top = -offsetParentRect.height + offsets.bottom;
      }
    } else {
      top = offsets.top;
    }

    if (sideB === 'right') {
      if (offsetParent.nodeName === 'HTML') {
        left = -offsetParent.clientWidth + offsets.right;
      } else {
        left = -offsetParentRect.width + offsets.right;
      }
    } else {
      left = offsets.left;
    }

    if (gpuAcceleration && prefixedProperty) {
      styles[prefixedProperty] = 'translate3d(' + left + 'px, ' + top + 'px, 0)';
      styles[sideA] = 0;
      styles[sideB] = 0;
      styles.willChange = 'transform';
    } else {
      // othwerise, we use the standard `top`, `left`, `bottom` and `right` properties
      var invertTop = sideA === 'bottom' ? -1 : 1;
      var invertLeft = sideB === 'right' ? -1 : 1;
      styles[sideA] = top * invertTop;
      styles[sideB] = left * invertLeft;
      styles.willChange = sideA + ', ' + sideB;
    } // Attributes


    var attributes = {
      'x-placement': data.placement
    }; // Update `data` attributes, styles and arrowStyles

    data.attributes = _extends({}, attributes, data.attributes);
    data.styles = _extends({}, styles, data.styles);
    data.arrowStyles = _extends({}, data.offsets.arrow, data.arrowStyles);
    return data;
  }
  /**
   * Helper used to know if the given modifier depends from another one.<br />
   * It checks if the needed modifier is listed and enabled.
   * @method
   * @memberof Popper.Utils
   * @param {Array} modifiers - list of modifiers
   * @param {String} requestingName - name of requesting modifier
   * @param {String} requestedName - name of requested modifier
   * @returns {Boolean}
   */


  function isModifierRequired(modifiers, requestingName, requestedName) {
    var requesting = find(modifiers, function (_ref) {
      var name = _ref.name;
      return name === requestingName;
    });
    var isRequired = !!requesting && modifiers.some(function (modifier) {
      return modifier.name === requestedName && modifier.enabled && modifier.order < requesting.order;
    });

    if (!isRequired) {
      var _requesting = '`' + requestingName + '`';

      var requested = '`' + requestedName + '`';
      console.warn(requested + ' modifier is required by ' + _requesting + ' modifier in order to work, be sure to include it before ' + _requesting + '!');
    }

    return isRequired;
  }
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by update method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */


  function arrow(data, options) {
    var _data$offsets$arrow; // arrow depends on keepTogether in order to work


    if (!isModifierRequired(data.instance.modifiers, 'arrow', 'keepTogether')) {
      return data;
    }

    var arrowElement = options.element; // if arrowElement is a string, suppose it's a CSS selector

    if (typeof arrowElement === 'string') {
      arrowElement = data.instance.popper.querySelector(arrowElement); // if arrowElement is not found, don't run the modifier

      if (!arrowElement) {
        return data;
      }
    } else {
      // if the arrowElement isn't a query selector we must check that the
      // provided DOM node is child of its popper node
      if (!data.instance.popper.contains(arrowElement)) {
        console.warn('WARNING: `arrow.element` must be child of its popper element!');
        return data;
      }
    }

    var placement = data.placement.split('-')[0];
    var _data$offsets = data.offsets,
        popper = _data$offsets.popper,
        reference = _data$offsets.reference;
    var isVertical = ['left', 'right'].indexOf(placement) !== -1;
    var len = isVertical ? 'height' : 'width';
    var sideCapitalized = isVertical ? 'Top' : 'Left';
    var side = sideCapitalized.toLowerCase();
    var altSide = isVertical ? 'left' : 'top';
    var opSide = isVertical ? 'bottom' : 'right';
    var arrowElementSize = getOuterSizes(arrowElement)[len]; //
    // extends keepTogether behavior making sure the popper and its
    // reference have enough pixels in conjunction
    //
    // top/left side

    if (reference[opSide] - arrowElementSize < popper[side]) {
      data.offsets.popper[side] -= popper[side] - (reference[opSide] - arrowElementSize);
    } // bottom/right side


    if (reference[side] + arrowElementSize > popper[opSide]) {
      data.offsets.popper[side] += reference[side] + arrowElementSize - popper[opSide];
    }

    data.offsets.popper = getClientRect(data.offsets.popper); // compute center of the popper

    var center = reference[side] + reference[len] / 2 - arrowElementSize / 2; // Compute the sideValue using the updated popper offsets
    // take popper margin in account because we don't have this info available

    var css = getStyleComputedProperty(data.instance.popper);
    var popperMarginSide = parseFloat(css['margin' + sideCapitalized], 10);
    var popperBorderSide = parseFloat(css['border' + sideCapitalized + 'Width'], 10);
    var sideValue = center - data.offsets.popper[side] - popperMarginSide - popperBorderSide; // prevent arrowElement from being placed not contiguously to its popper

    sideValue = Math.max(Math.min(popper[len] - arrowElementSize, sideValue), 0);
    data.arrowElement = arrowElement;
    data.offsets.arrow = (_data$offsets$arrow = {}, defineProperty(_data$offsets$arrow, side, Math.round(sideValue)), defineProperty(_data$offsets$arrow, altSide, ''), _data$offsets$arrow);
    return data;
  }
  /**
   * Get the opposite placement variation of the given one
   * @method
   * @memberof Popper.Utils
   * @argument {String} placement variation
   * @returns {String} flipped placement variation
   */


  function getOppositeVariation(variation) {
    if (variation === 'end') {
      return 'start';
    } else if (variation === 'start') {
      return 'end';
    }

    return variation;
  }
  /**
   * List of accepted placements to use as values of the `placement` option.<br />
   * Valid placements are:
   * - `auto`
   * - `top`
   * - `right`
   * - `bottom`
   * - `left`
   *
   * Each placement can have a variation from this list:
   * - `-start`
   * - `-end`
   *
   * Variations are interpreted easily if you think of them as the left to right
   * written languages. Horizontally (`top` and `bottom`), `start` is left and `end`
   * is right.<br />
   * Vertically (`left` and `right`), `start` is top and `end` is bottom.
   *
   * Some valid examples are:
   * - `top-end` (on top of reference, right aligned)
   * - `right-start` (on right of reference, top aligned)
   * - `bottom` (on bottom, centered)
   * - `auto-end` (on the side with more space available, alignment depends by placement)
   *
   * @static
   * @type {Array}
   * @enum {String}
   * @readonly
   * @method placements
   * @memberof Popper
   */


  var placements = ['auto-start', 'auto', 'auto-end', 'top-start', 'top', 'top-end', 'right-start', 'right', 'right-end', 'bottom-end', 'bottom', 'bottom-start', 'left-end', 'left', 'left-start']; // Get rid of `auto` `auto-start` and `auto-end`

  var validPlacements = placements.slice(3);
  /**
   * Given an initial placement, returns all the subsequent placements
   * clockwise (or counter-clockwise).
   *
   * @method
   * @memberof Popper.Utils
   * @argument {String} placement - A valid placement (it accepts variations)
   * @argument {Boolean} counter - Set to true to walk the placements counterclockwise
   * @returns {Array} placements including their variations
   */

  function clockwise(placement) {
    var counter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var index = validPlacements.indexOf(placement);
    var arr = validPlacements.slice(index + 1).concat(validPlacements.slice(0, index));
    return counter ? arr.reverse() : arr;
  }

  var BEHAVIORS = {
    FLIP: 'flip',
    CLOCKWISE: 'clockwise',
    COUNTERCLOCKWISE: 'counterclockwise'
  };
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by update method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */

  function flip(data, options) {
    // if `inner` modifier is enabled, we can't use the `flip` modifier
    if (isModifierEnabled(data.instance.modifiers, 'inner')) {
      return data;
    }

    if (data.flipped && data.placement === data.originalPlacement) {
      // seems like flip is trying to loop, probably there's not enough space on any of the flippable sides
      return data;
    }

    var boundaries = getBoundaries(data.instance.popper, data.instance.reference, options.padding, options.boundariesElement, data.positionFixed);
    var placement = data.placement.split('-')[0];
    var placementOpposite = getOppositePlacement(placement);
    var variation = data.placement.split('-')[1] || '';
    var flipOrder = [];

    switch (options.behavior) {
      case BEHAVIORS.FLIP:
        flipOrder = [placement, placementOpposite];
        break;

      case BEHAVIORS.CLOCKWISE:
        flipOrder = clockwise(placement);
        break;

      case BEHAVIORS.COUNTERCLOCKWISE:
        flipOrder = clockwise(placement, true);
        break;

      default:
        flipOrder = options.behavior;
    }

    flipOrder.forEach(function (step, index) {
      if (placement !== step || flipOrder.length === index + 1) {
        return data;
      }

      placement = data.placement.split('-')[0];
      placementOpposite = getOppositePlacement(placement);
      var popperOffsets = data.offsets.popper;
      var refOffsets = data.offsets.reference; // using floor because the reference offsets may contain decimals we are not going to consider here

      var floor = Math.floor;
      var overlapsRef = placement === 'left' && floor(popperOffsets.right) > floor(refOffsets.left) || placement === 'right' && floor(popperOffsets.left) < floor(refOffsets.right) || placement === 'top' && floor(popperOffsets.bottom) > floor(refOffsets.top) || placement === 'bottom' && floor(popperOffsets.top) < floor(refOffsets.bottom);
      var overflowsLeft = floor(popperOffsets.left) < floor(boundaries.left);
      var overflowsRight = floor(popperOffsets.right) > floor(boundaries.right);
      var overflowsTop = floor(popperOffsets.top) < floor(boundaries.top);
      var overflowsBottom = floor(popperOffsets.bottom) > floor(boundaries.bottom);
      var overflowsBoundaries = placement === 'left' && overflowsLeft || placement === 'right' && overflowsRight || placement === 'top' && overflowsTop || placement === 'bottom' && overflowsBottom; // flip the variation if required

      var isVertical = ['top', 'bottom'].indexOf(placement) !== -1; // flips variation if reference element overflows boundaries

      var flippedVariationByRef = !!options.flipVariations && (isVertical && variation === 'start' && overflowsLeft || isVertical && variation === 'end' && overflowsRight || !isVertical && variation === 'start' && overflowsTop || !isVertical && variation === 'end' && overflowsBottom); // flips variation if popper content overflows boundaries

      var flippedVariationByContent = !!options.flipVariationsByContent && (isVertical && variation === 'start' && overflowsRight || isVertical && variation === 'end' && overflowsLeft || !isVertical && variation === 'start' && overflowsBottom || !isVertical && variation === 'end' && overflowsTop);
      var flippedVariation = flippedVariationByRef || flippedVariationByContent;

      if (overlapsRef || overflowsBoundaries || flippedVariation) {
        // this boolean to detect any flip loop
        data.flipped = true;

        if (overlapsRef || overflowsBoundaries) {
          placement = flipOrder[index + 1];
        }

        if (flippedVariation) {
          variation = getOppositeVariation(variation);
        }

        data.placement = placement + (variation ? '-' + variation : ''); // this object contains `position`, we want to preserve it along with
        // any additional property we may add in the future

        data.offsets.popper = _extends({}, data.offsets.popper, getPopperOffsets(data.instance.popper, data.offsets.reference, data.placement));
        data = runModifiers(data.instance.modifiers, data, 'flip');
      }
    });
    return data;
  }
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by update method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */


  function keepTogether(data) {
    var _data$offsets = data.offsets,
        popper = _data$offsets.popper,
        reference = _data$offsets.reference;
    var placement = data.placement.split('-')[0];
    var floor = Math.floor;
    var isVertical = ['top', 'bottom'].indexOf(placement) !== -1;
    var side = isVertical ? 'right' : 'bottom';
    var opSide = isVertical ? 'left' : 'top';
    var measurement = isVertical ? 'width' : 'height';

    if (popper[side] < floor(reference[opSide])) {
      data.offsets.popper[opSide] = floor(reference[opSide]) - popper[measurement];
    }

    if (popper[opSide] > floor(reference[side])) {
      data.offsets.popper[opSide] = floor(reference[side]);
    }

    return data;
  }
  /**
   * Converts a string containing value + unit into a px value number
   * @function
   * @memberof {modifiers~offset}
   * @private
   * @argument {String} str - Value + unit string
   * @argument {String} measurement - `height` or `width`
   * @argument {Object} popperOffsets
   * @argument {Object} referenceOffsets
   * @returns {Number|String}
   * Value in pixels, or original string if no values were extracted
   */


  function toValue(str, measurement, popperOffsets, referenceOffsets) {
    // separate value from unit
    var split = str.match(/((?:\-|\+)?\d*\.?\d*)(.*)/);
    var value = +split[1];
    var unit = split[2]; // If it's not a number it's an operator, I guess

    if (!value) {
      return str;
    }

    if (unit.indexOf('%') === 0) {
      var element = void 0;

      switch (unit) {
        case '%p':
          element = popperOffsets;
          break;

        case '%':
        case '%r':
        default:
          element = referenceOffsets;
      }

      var rect = getClientRect(element);
      return rect[measurement] / 100 * value;
    } else if (unit === 'vh' || unit === 'vw') {
      // if is a vh or vw, we calculate the size based on the viewport
      var size = void 0;

      if (unit === 'vh') {
        size = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
      } else {
        size = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
      }

      return size / 100 * value;
    } else {
      // if is an explicit pixel unit, we get rid of the unit and keep the value
      // if is an implicit unit, it's px, and we return just the value
      return value;
    }
  }
  /**
   * Parse an `offset` string to extrapolate `x` and `y` numeric offsets.
   * @function
   * @memberof {modifiers~offset}
   * @private
   * @argument {String} offset
   * @argument {Object} popperOffsets
   * @argument {Object} referenceOffsets
   * @argument {String} basePlacement
   * @returns {Array} a two cells array with x and y offsets in numbers
   */


  function parseOffset(offset, popperOffsets, referenceOffsets, basePlacement) {
    var offsets = [0, 0]; // Use height if placement is left or right and index is 0 otherwise use width
    // in this way the first offset will use an axis and the second one
    // will use the other one

    var useHeight = ['right', 'left'].indexOf(basePlacement) !== -1; // Split the offset string to obtain a list of values and operands
    // The regex addresses values with the plus or minus sign in front (+10, -20, etc)

    var fragments = offset.split(/(\+|\-)/).map(function (frag) {
      return frag.trim();
    }); // Detect if the offset string contains a pair of values or a single one
    // they could be separated by comma or space

    var divider = fragments.indexOf(find(fragments, function (frag) {
      return frag.search(/,|\s/) !== -1;
    }));

    if (fragments[divider] && fragments[divider].indexOf(',') === -1) {
      console.warn('Offsets separated by white space(s) are deprecated, use a comma (,) instead.');
    } // If divider is found, we divide the list of values and operands to divide
    // them by ofset X and Y.


    var splitRegex = /\s*,\s*|\s+/;
    var ops = divider !== -1 ? [fragments.slice(0, divider).concat([fragments[divider].split(splitRegex)[0]]), [fragments[divider].split(splitRegex)[1]].concat(fragments.slice(divider + 1))] : [fragments]; // Convert the values with units to absolute pixels to allow our computations

    ops = ops.map(function (op, index) {
      // Most of the units rely on the orientation of the popper
      var measurement = (index === 1 ? !useHeight : useHeight) ? 'height' : 'width';
      var mergeWithPrevious = false;
      return op // This aggregates any `+` or `-` sign that aren't considered operators
      // e.g.: 10 + +5 => [10, +, +5]
      .reduce(function (a, b) {
        if (a[a.length - 1] === '' && ['+', '-'].indexOf(b) !== -1) {
          a[a.length - 1] = b;
          mergeWithPrevious = true;
          return a;
        } else if (mergeWithPrevious) {
          a[a.length - 1] += b;
          mergeWithPrevious = false;
          return a;
        } else {
          return a.concat(b);
        }
      }, []) // Here we convert the string values into number values (in px)
      .map(function (str) {
        return toValue(str, measurement, popperOffsets, referenceOffsets);
      });
    }); // Loop trough the offsets arrays and execute the operations

    ops.forEach(function (op, index) {
      op.forEach(function (frag, index2) {
        if (isNumeric(frag)) {
          offsets[index] += frag * (op[index2 - 1] === '-' ? -1 : 1);
        }
      });
    });
    return offsets;
  }
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by update method
   * @argument {Object} options - Modifiers configuration and options
   * @argument {Number|String} options.offset=0
   * The offset value as described in the modifier description
   * @returns {Object} The data object, properly modified
   */


  function offset(data, _ref) {
    var offset = _ref.offset;
    var placement = data.placement,
        _data$offsets = data.offsets,
        popper = _data$offsets.popper,
        reference = _data$offsets.reference;
    var basePlacement = placement.split('-')[0];
    var offsets = void 0;

    if (isNumeric(+offset)) {
      offsets = [+offset, 0];
    } else {
      offsets = parseOffset(offset, popper, reference, basePlacement);
    }

    if (basePlacement === 'left') {
      popper.top += offsets[0];
      popper.left -= offsets[1];
    } else if (basePlacement === 'right') {
      popper.top += offsets[0];
      popper.left += offsets[1];
    } else if (basePlacement === 'top') {
      popper.left += offsets[0];
      popper.top -= offsets[1];
    } else if (basePlacement === 'bottom') {
      popper.left += offsets[0];
      popper.top += offsets[1];
    }

    data.popper = popper;
    return data;
  }
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by `update` method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */


  function preventOverflow(data, options) {
    var boundariesElement = options.boundariesElement || getOffsetParent(data.instance.popper); // If offsetParent is the reference element, we really want to
    // go one step up and use the next offsetParent as reference to
    // avoid to make this modifier completely useless and look like broken

    if (data.instance.reference === boundariesElement) {
      boundariesElement = getOffsetParent(boundariesElement);
    } // NOTE: DOM access here
    // resets the popper's position so that the document size can be calculated excluding
    // the size of the popper element itself


    var transformProp = getSupportedPropertyName('transform');
    var popperStyles = data.instance.popper.style; // assignment to help minification

    var top = popperStyles.top,
        left = popperStyles.left,
        transform = popperStyles[transformProp];
    popperStyles.top = '';
    popperStyles.left = '';
    popperStyles[transformProp] = '';
    var boundaries = getBoundaries(data.instance.popper, data.instance.reference, options.padding, boundariesElement, data.positionFixed); // NOTE: DOM access here
    // restores the original style properties after the offsets have been computed

    popperStyles.top = top;
    popperStyles.left = left;
    popperStyles[transformProp] = transform;
    options.boundaries = boundaries;
    var order = options.priority;
    var popper = data.offsets.popper;
    var check = {
      primary: function primary(placement) {
        var value = popper[placement];

        if (popper[placement] < boundaries[placement] && !options.escapeWithReference) {
          value = Math.max(popper[placement], boundaries[placement]);
        }

        return defineProperty({}, placement, value);
      },
      secondary: function secondary(placement) {
        var mainSide = placement === 'right' ? 'left' : 'top';
        var value = popper[mainSide];

        if (popper[placement] > boundaries[placement] && !options.escapeWithReference) {
          value = Math.min(popper[mainSide], boundaries[placement] - (placement === 'right' ? popper.width : popper.height));
        }

        return defineProperty({}, mainSide, value);
      }
    };
    order.forEach(function (placement) {
      var side = ['left', 'top'].indexOf(placement) !== -1 ? 'primary' : 'secondary';
      popper = _extends({}, popper, check[side](placement));
    });
    data.offsets.popper = popper;
    return data;
  }
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by `update` method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */


  function shift(data) {
    var placement = data.placement;
    var basePlacement = placement.split('-')[0];
    var shiftvariation = placement.split('-')[1]; // if shift shiftvariation is specified, run the modifier

    if (shiftvariation) {
      var _data$offsets = data.offsets,
          reference = _data$offsets.reference,
          popper = _data$offsets.popper;
      var isVertical = ['bottom', 'top'].indexOf(basePlacement) !== -1;
      var side = isVertical ? 'left' : 'top';
      var measurement = isVertical ? 'width' : 'height';
      var shiftOffsets = {
        start: defineProperty({}, side, reference[side]),
        end: defineProperty({}, side, reference[side] + reference[measurement] - popper[measurement])
      };
      data.offsets.popper = _extends({}, popper, shiftOffsets[shiftvariation]);
    }

    return data;
  }
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by update method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */


  function hide(data) {
    if (!isModifierRequired(data.instance.modifiers, 'hide', 'preventOverflow')) {
      return data;
    }

    var refRect = data.offsets.reference;
    var bound = find(data.instance.modifiers, function (modifier) {
      return modifier.name === 'preventOverflow';
    }).boundaries;

    if (refRect.bottom < bound.top || refRect.left > bound.right || refRect.top > bound.bottom || refRect.right < bound.left) {
      // Avoid unnecessary DOM access if visibility hasn't changed
      if (data.hide === true) {
        return data;
      }

      data.hide = true;
      data.attributes['x-out-of-boundaries'] = '';
    } else {
      // Avoid unnecessary DOM access if visibility hasn't changed
      if (data.hide === false) {
        return data;
      }

      data.hide = false;
      data.attributes['x-out-of-boundaries'] = false;
    }

    return data;
  }
  /**
   * @function
   * @memberof Modifiers
   * @argument {Object} data - The data object generated by `update` method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {Object} The data object, properly modified
   */


  function inner(data) {
    var placement = data.placement;
    var basePlacement = placement.split('-')[0];
    var _data$offsets = data.offsets,
        popper = _data$offsets.popper,
        reference = _data$offsets.reference;
    var isHoriz = ['left', 'right'].indexOf(basePlacement) !== -1;
    var subtractLength = ['top', 'left'].indexOf(basePlacement) === -1;
    popper[isHoriz ? 'left' : 'top'] = reference[basePlacement] - (subtractLength ? popper[isHoriz ? 'width' : 'height'] : 0);
    data.placement = getOppositePlacement(placement);
    data.offsets.popper = getClientRect(popper);
    return data;
  }
  /**
   * Modifier function, each modifier can have a function of this type assigned
   * to its `fn` property.<br />
   * These functions will be called on each update, this means that you must
   * make sure they are performant enough to avoid performance bottlenecks.
   *
   * @function ModifierFn
   * @argument {dataObject} data - The data object generated by `update` method
   * @argument {Object} options - Modifiers configuration and options
   * @returns {dataObject} The data object, properly modified
   */

  /**
   * Modifiers are plugins used to alter the behavior of your poppers.<br />
   * Popper.js uses a set of 9 modifiers to provide all the basic functionalities
   * needed by the library.
   *
   * Usually you don't want to override the `order`, `fn` and `onLoad` props.
   * All the other properties are configurations that could be tweaked.
   * @namespace modifiers
   */


  var modifiers = {
    /**
     * Modifier used to shift the popper on the start or end of its reference
     * element.<br />
     * It will read the variation of the `placement` property.<br />
     * It can be one either `-end` or `-start`.
     * @memberof modifiers
     * @inner
     */
    shift: {
      /** @prop {number} order=100 - Index used to define the order of execution */
      order: 100,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: shift
    },

    /**
     * The `offset` modifier can shift your popper on both its axis.
     *
     * It accepts the following units:
     * - `px` or unit-less, interpreted as pixels
     * - `%` or `%r`, percentage relative to the length of the reference element
     * - `%p`, percentage relative to the length of the popper element
     * - `vw`, CSS viewport width unit
     * - `vh`, CSS viewport height unit
     *
     * For length is intended the main axis relative to the placement of the popper.<br />
     * This means that if the placement is `top` or `bottom`, the length will be the
     * `width`. In case of `left` or `right`, it will be the `height`.
     *
     * You can provide a single value (as `Number` or `String`), or a pair of values
     * as `String` divided by a comma or one (or more) white spaces.<br />
     * The latter is a deprecated method because it leads to confusion and will be
     * removed in v2.<br />
     * Additionally, it accepts additions and subtractions between different units.
     * Note that multiplications and divisions aren't supported.
     *
     * Valid examples are:
     * ```
     * 10
     * '10%'
     * '10, 10'
     * '10%, 10'
     * '10 + 10%'
     * '10 - 5vh + 3%'
     * '-10px + 5vh, 5px - 6%'
     * ```
     * > **NB**: If you desire to apply offsets to your poppers in a way that may make them overlap
     * > with their reference element, unfortunately, you will have to disable the `flip` modifier.
     * > You can read more on this at this [issue](https://github.com/FezVrasta/popper.js/issues/373).
     *
     * @memberof modifiers
     * @inner
     */
    offset: {
      /** @prop {number} order=200 - Index used to define the order of execution */
      order: 200,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: offset,

      /** @prop {Number|String} offset=0
       * The offset value as described in the modifier description
       */
      offset: 0
    },

    /**
     * Modifier used to prevent the popper from being positioned outside the boundary.
     *
     * A scenario exists where the reference itself is not within the boundaries.<br />
     * We can say it has "escaped the boundaries"  or just "escaped".<br />
     * In this case we need to decide whether the popper should either:
     *
     * - detach from the reference and remain "trapped" in the boundaries, or
     * - if it should ignore the boundary and "escape with its reference"
     *
     * When `escapeWithReference` is set to`true` and reference is completely
     * outside its boundaries, the popper will overflow (or completely leave)
     * the boundaries in order to remain attached to the edge of the reference.
     *
     * @memberof modifiers
     * @inner
     */
    preventOverflow: {
      /** @prop {number} order=300 - Index used to define the order of execution */
      order: 300,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: preventOverflow,

      /**
       * @prop {Array} [priority=['left','right','top','bottom']]
       * Popper will try to prevent overflow following these priorities by default,
       * then, it could overflow on the left and on top of the `boundariesElement`
       */
      priority: ['left', 'right', 'top', 'bottom'],

      /**
       * @prop {number} padding=5
       * Amount of pixel used to define a minimum distance between the boundaries
       * and the popper. This makes sure the popper always has a little padding
       * between the edges of its container
       */
      padding: 5,

      /**
       * @prop {String|HTMLElement} boundariesElement='scrollParent'
       * Boundaries used by the modifier. Can be `scrollParent`, `window`,
       * `viewport` or any DOM element.
       */
      boundariesElement: 'scrollParent'
    },

    /**
     * Modifier used to make sure the reference and its popper stay near each other
     * without leaving any gap between the two. Especially useful when the arrow is
     * enabled and you want to ensure that it points to its reference element.
     * It cares only about the first axis. You can still have poppers with margin
     * between the popper and its reference element.
     * @memberof modifiers
     * @inner
     */
    keepTogether: {
      /** @prop {number} order=400 - Index used to define the order of execution */
      order: 400,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: keepTogether
    },

    /**
     * This modifier is used to move the `arrowElement` of the popper to make
     * sure it is positioned between the reference element and its popper element.
     * It will read the outer size of the `arrowElement` node to detect how many
     * pixels of conjunction are needed.
     *
     * It has no effect if no `arrowElement` is provided.
     * @memberof modifiers
     * @inner
     */
    arrow: {
      /** @prop {number} order=500 - Index used to define the order of execution */
      order: 500,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: arrow,

      /** @prop {String|HTMLElement} element='[x-arrow]' - Selector or node used as arrow */
      element: '[x-arrow]'
    },

    /**
     * Modifier used to flip the popper's placement when it starts to overlap its
     * reference element.
     *
     * Requires the `preventOverflow` modifier before it in order to work.
     *
     * **NOTE:** this modifier will interrupt the current update cycle and will
     * restart it if it detects the need to flip the placement.
     * @memberof modifiers
     * @inner
     */
    flip: {
      /** @prop {number} order=600 - Index used to define the order of execution */
      order: 600,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: flip,

      /**
       * @prop {String|Array} behavior='flip'
       * The behavior used to change the popper's placement. It can be one of
       * `flip`, `clockwise`, `counterclockwise` or an array with a list of valid
       * placements (with optional variations)
       */
      behavior: 'flip',

      /**
       * @prop {number} padding=5
       * The popper will flip if it hits the edges of the `boundariesElement`
       */
      padding: 5,

      /**
       * @prop {String|HTMLElement} boundariesElement='viewport'
       * The element which will define the boundaries of the popper position.
       * The popper will never be placed outside of the defined boundaries
       * (except if `keepTogether` is enabled)
       */
      boundariesElement: 'viewport',

      /**
       * @prop {Boolean} flipVariations=false
       * The popper will switch placement variation between `-start` and `-end` when
       * the reference element overlaps its boundaries.
       *
       * The original placement should have a set variation.
       */
      flipVariations: false,

      /**
       * @prop {Boolean} flipVariationsByContent=false
       * The popper will switch placement variation between `-start` and `-end` when
       * the popper element overlaps its reference boundaries.
       *
       * The original placement should have a set variation.
       */
      flipVariationsByContent: false
    },

    /**
     * Modifier used to make the popper flow toward the inner of the reference element.
     * By default, when this modifier is disabled, the popper will be placed outside
     * the reference element.
     * @memberof modifiers
     * @inner
     */
    inner: {
      /** @prop {number} order=700 - Index used to define the order of execution */
      order: 700,

      /** @prop {Boolean} enabled=false - Whether the modifier is enabled or not */
      enabled: false,

      /** @prop {ModifierFn} */
      fn: inner
    },

    /**
     * Modifier used to hide the popper when its reference element is outside of the
     * popper boundaries. It will set a `x-out-of-boundaries` attribute which can
     * be used to hide with a CSS selector the popper when its reference is
     * out of boundaries.
     *
     * Requires the `preventOverflow` modifier before it in order to work.
     * @memberof modifiers
     * @inner
     */
    hide: {
      /** @prop {number} order=800 - Index used to define the order of execution */
      order: 800,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: hide
    },

    /**
     * Computes the style that will be applied to the popper element to gets
     * properly positioned.
     *
     * Note that this modifier will not touch the DOM, it just prepares the styles
     * so that `applyStyle` modifier can apply it. This separation is useful
     * in case you need to replace `applyStyle` with a custom implementation.
     *
     * This modifier has `850` as `order` value to maintain backward compatibility
     * with previous versions of Popper.js. Expect the modifiers ordering method
     * to change in future major versions of the library.
     *
     * @memberof modifiers
     * @inner
     */
    computeStyle: {
      /** @prop {number} order=850 - Index used to define the order of execution */
      order: 850,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: computeStyle,

      /**
       * @prop {Boolean} gpuAcceleration=true
       * If true, it uses the CSS 3D transformation to position the popper.
       * Otherwise, it will use the `top` and `left` properties
       */
      gpuAcceleration: true,

      /**
       * @prop {string} [x='bottom']
       * Where to anchor the X axis (`bottom` or `top`). AKA X offset origin.
       * Change this if your popper should grow in a direction different from `bottom`
       */
      x: 'bottom',

      /**
       * @prop {string} [x='left']
       * Where to anchor the Y axis (`left` or `right`). AKA Y offset origin.
       * Change this if your popper should grow in a direction different from `right`
       */
      y: 'right'
    },

    /**
     * Applies the computed styles to the popper element.
     *
     * All the DOM manipulations are limited to this modifier. This is useful in case
     * you want to integrate Popper.js inside a framework or view library and you
     * want to delegate all the DOM manipulations to it.
     *
     * Note that if you disable this modifier, you must make sure the popper element
     * has its position set to `absolute` before Popper.js can do its work!
     *
     * Just disable this modifier and define your own to achieve the desired effect.
     *
     * @memberof modifiers
     * @inner
     */
    applyStyle: {
      /** @prop {number} order=900 - Index used to define the order of execution */
      order: 900,

      /** @prop {Boolean} enabled=true - Whether the modifier is enabled or not */
      enabled: true,

      /** @prop {ModifierFn} */
      fn: applyStyle,

      /** @prop {Function} */
      onLoad: applyStyleOnLoad,

      /**
       * @deprecated since version 1.10.0, the property moved to `computeStyle` modifier
       * @prop {Boolean} gpuAcceleration=true
       * If true, it uses the CSS 3D transformation to position the popper.
       * Otherwise, it will use the `top` and `left` properties
       */
      gpuAcceleration: undefined
    }
  };
  /**
   * The `dataObject` is an object containing all the information used by Popper.js.
   * This object is passed to modifiers and to the `onCreate` and `onUpdate` callbacks.
   * @name dataObject
   * @property {Object} data.instance The Popper.js instance
   * @property {String} data.placement Placement applied to popper
   * @property {String} data.originalPlacement Placement originally defined on init
   * @property {Boolean} data.flipped True if popper has been flipped by flip modifier
   * @property {Boolean} data.hide True if the reference element is out of boundaries, useful to know when to hide the popper
   * @property {HTMLElement} data.arrowElement Node used as arrow by arrow modifier
   * @property {Object} data.styles Any CSS property defined here will be applied to the popper. It expects the JavaScript nomenclature (eg. `marginBottom`)
   * @property {Object} data.arrowStyles Any CSS property defined here will be applied to the popper arrow. It expects the JavaScript nomenclature (eg. `marginBottom`)
   * @property {Object} data.boundaries Offsets of the popper boundaries
   * @property {Object} data.offsets The measurements of popper, reference and arrow elements
   * @property {Object} data.offsets.popper `top`, `left`, `width`, `height` values
   * @property {Object} data.offsets.reference `top`, `left`, `width`, `height` values
   * @property {Object} data.offsets.arrow] `top` and `left` offsets, only one of them will be different from 0
   */

  /**
   * Default options provided to Popper.js constructor.<br />
   * These can be overridden using the `options` argument of Popper.js.<br />
   * To override an option, simply pass an object with the same
   * structure of the `options` object, as the 3rd argument. For example:
   * ```
   * new Popper(ref, pop, {
   *   modifiers: {
   *     preventOverflow: { enabled: false }
   *   }
   * })
   * ```
   * @type {Object}
   * @static
   * @memberof Popper
   */

  var Defaults = {
    /**
     * Popper's placement.
     * @prop {Popper.placements} placement='bottom'
     */
    placement: 'bottom',

    /**
     * Set this to true if you want popper to position it self in 'fixed' mode
     * @prop {Boolean} positionFixed=false
     */
    positionFixed: false,

    /**
     * Whether events (resize, scroll) are initially enabled.
     * @prop {Boolean} eventsEnabled=true
     */
    eventsEnabled: true,

    /**
     * Set to true if you want to automatically remove the popper when
     * you call the `destroy` method.
     * @prop {Boolean} removeOnDestroy=false
     */
    removeOnDestroy: false,

    /**
     * Callback called when the popper is created.<br />
     * By default, it is set to no-op.<br />
     * Access Popper.js instance with `data.instance`.
     * @prop {onCreate}
     */
    onCreate: function onCreate() {},

    /**
     * Callback called when the popper is updated. This callback is not called
     * on the initialization/creation of the popper, but only on subsequent
     * updates.<br />
     * By default, it is set to no-op.<br />
     * Access Popper.js instance with `data.instance`.
     * @prop {onUpdate}
     */
    onUpdate: function onUpdate() {},

    /**
     * List of modifiers used to modify the offsets before they are applied to the popper.
     * They provide most of the functionalities of Popper.js.
     * @prop {modifiers}
     */
    modifiers: modifiers
  };
  /**
   * @callback onCreate
   * @param {dataObject} data
   */

  /**
   * @callback onUpdate
   * @param {dataObject} data
   */
  // Utils
  // Methods

  var Popper = function () {
    /**
     * Creates a new Popper.js instance.
     * @class Popper
     * @param {Element|referenceObject} reference - The reference element used to position the popper
     * @param {Element} popper - The HTML / XML element used as the popper
     * @param {Object} options - Your custom options to override the ones defined in [Defaults](#defaults)
     * @return {Object} instance - The generated Popper.js instance
     */
    function Popper(reference, popper) {
      var _this = this;

      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      classCallCheck(this, Popper);

      this.scheduleUpdate = function () {
        return requestAnimationFrame(_this.update);
      }; // make update() debounced, so that it only runs at most once-per-tick


      this.update = debounce(this.update.bind(this)); // with {} we create a new object with the options inside it

      this.options = _extends({}, Popper.Defaults, options); // init state

      this.state = {
        isDestroyed: false,
        isCreated: false,
        scrollParents: []
      }; // get reference and popper elements (allow jQuery wrappers)

      this.reference = reference && reference.jquery ? reference[0] : reference;
      this.popper = popper && popper.jquery ? popper[0] : popper; // Deep merge modifiers options

      this.options.modifiers = {};
      Object.keys(_extends({}, Popper.Defaults.modifiers, options.modifiers)).forEach(function (name) {
        _this.options.modifiers[name] = _extends({}, Popper.Defaults.modifiers[name] || {}, options.modifiers ? options.modifiers[name] : {});
      }); // Refactoring modifiers' list (Object => Array)

      this.modifiers = Object.keys(this.options.modifiers).map(function (name) {
        return _extends({
          name: name
        }, _this.options.modifiers[name]);
      }) // sort the modifiers by order
      .sort(function (a, b) {
        return a.order - b.order;
      }); // modifiers have the ability to execute arbitrary code when Popper.js get inited
      // such code is executed in the same order of its modifier
      // they could add new properties to their options configuration
      // BE AWARE: don't add options to `options.modifiers.name` but to `modifierOptions`!

      this.modifiers.forEach(function (modifierOptions) {
        if (modifierOptions.enabled && isFunction(modifierOptions.onLoad)) {
          modifierOptions.onLoad(_this.reference, _this.popper, _this.options, modifierOptions, _this.state);
        }
      }); // fire the first update to position the popper in the right place

      this.update();
      var eventsEnabled = this.options.eventsEnabled;

      if (eventsEnabled) {
        // setup event listeners, they will take care of update the position in specific situations
        this.enableEventListeners();
      }

      this.state.eventsEnabled = eventsEnabled;
    } // We can't use class properties because they don't get listed in the
    // class prototype and break stuff like Sinon stubs


    createClass(Popper, [{
      key: 'update',
      value: function update$$1() {
        return update.call(this);
      }
    }, {
      key: 'destroy',
      value: function destroy$$1() {
        return destroy.call(this);
      }
    }, {
      key: 'enableEventListeners',
      value: function enableEventListeners$$1() {
        return enableEventListeners.call(this);
      }
    }, {
      key: 'disableEventListeners',
      value: function disableEventListeners$$1() {
        return disableEventListeners.call(this);
      }
      /**
       * Schedules an update. It will run on the next UI update available.
       * @method scheduleUpdate
       * @memberof Popper
       */

      /**
       * Collection of utilities useful when writing custom modifiers.
       * Starting from version 1.7, this method is available only if you
       * include `popper-utils.js` before `popper.js`.
       *
       * **DEPRECATION**: This way to access PopperUtils is deprecated
       * and will be removed in v2! Use the PopperUtils module directly instead.
       * Due to the high instability of the methods contained in Utils, we can't
       * guarantee them to follow semver. Use them at your own risk!
       * @static
       * @private
       * @type {Object}
       * @deprecated since version 1.8
       * @member Utils
       * @memberof Popper
       */

    }]);
    return Popper;
  }();
  /**
   * The `referenceObject` is an object that provides an interface compatible with Popper.js
   * and lets you use it as replacement of a real DOM node.<br />
   * You can use this method to position a popper relatively to a set of coordinates
   * in case you don't have a DOM node to use as reference.
   *
   * ```
   * new Popper(referenceObject, popperNode);
   * ```
   *
   * NB: This feature isn't supported in Internet Explorer 10.
   * @name referenceObject
   * @property {Function} data.getBoundingClientRect
   * A function that returns a set of coordinates compatible with the native `getBoundingClientRect` method.
   * @property {number} data.clientWidth
   * An ES6 getter that will return the width of the virtual reference element.
   * @property {number} data.clientHeight
   * An ES6 getter that will return the height of the virtual reference element.
   */


  Popper.Utils = (typeof window !== 'undefined' ? window : global).PopperUtils;
  Popper.placements = placements;
  Popper.Defaults = Defaults;

  function _typeof$p(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$p = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$p = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$p(obj);
  }

  function _classCallCheck$n(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$j(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$j(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$j(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$j(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$l(self, call) {
    if (call && (_typeof$p(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$l(self);
  }

  function _assertThisInitialized$l(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$l(o) {
    _getPrototypeOf$l = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$l(o);
  }

  function _inherits$l(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$l(subClass, superClass);
  }

  function _setPrototypeOf$l(o, p) {
    _setPrototypeOf$l = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$l(o, p);
  }
  /**
      @class Tooltip
      @extends BaseClass
      @desc Creates HTML tooltips in the body of a webpage.
  */

  var Tooltip =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$l(Tooltip, _BaseClass);
    /**
        @memberof Tooltip
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Tooltip() {
      var _this;

      _classCallCheck$n(this, Tooltip);

      _this = _possibleConstructorReturn$l(this, _getPrototypeOf$l(Tooltip).call(this));
      _this._arrow = accessor("arrow", "");
      _this._arrowStyle = {
        "content": "",
        "background": "inherit",
        "border": "inherit",
        "border-width": "0 1px 1px 0",
        "height": "10px",
        "position": "absolute",
        "transform": "rotate(45deg)",
        "width": "10px",
        "z-index": "-1"
      };
      _this._background = constant$3("rgba(255, 255, 255, 1)");
      _this._body = accessor("body", "");
      _this._bodyStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "12px",
        "font-weight": "400",
        "z-index": "1"
      };
      _this._border = constant$3("1px solid rgba(0, 0, 0, 0.1)");
      _this._borderRadius = constant$3("2px");
      _this._className = "d3plus-tooltip";
      _this._data = [];
      _this._footer = accessor("footer", "");
      _this._footerStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "12px",
        "font-weight": "400",
        "z-index": "1"
      };
      _this._height = constant$3("auto");

      _this._id = function (d, i) {
        return "".concat(i);
      };

      _this._offset = constant$3(5);
      _this._padding = constant$3("5px");
      _this._pointerEvents = constant$3("auto");
      _this._popperClasses = {};

      _this._position = function (d) {
        return [d.x, d.y];
      };

      _this._prefix = prefix$1();
      _this._tableStyle = {
        "border-collapse": "collapse",
        "border-spacing": "0",
        "width": "100%"
      };
      _this._tbody = [];
      _this._tbodyStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "12px",
        "text-align": "center"
      };
      _this._thead = [];
      _this._theadStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "12px",
        "font-weight": "600",
        "text-align": "center"
      };
      _this._title = accessor("title", "");
      _this._titleStyle = {
        "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
        "font-size": "14px",
        "font-weight": "600"
      };
      _this._trStyle = {
        "border-top": "1px solid rgba(0, 0, 0, 0.1)"
      };
      _this._tdStyle = {};
      _this._width = constant$3("auto");
      return _this;
    }
    /**
        The inner return object and draw function that gets assigned the public methods.
        @private
    */


    _createClass$j(Tooltip, [{
      key: "render",
      value: function render(callback) {
        var _this2 = this;

        var that = this;
        var tooltips = _select("body").selectAll(".".concat(this._className)).data(this._data, this._id);
        var enter = tooltips.enter().append("div").attr("class", this._className);
        var update = tooltips.merge(enter);
        /**
            Creates DIV elements with a unique class and styles.
            @private
        */

        function divElement(cat) {
          enter.append("div").attr("class", "d3plus-tooltip-".concat(cat)).attr("id", function (d, i) {
            return "d3plus-tooltip-".concat(cat, "-").concat(d ? that._id(d, i) : "");
          });
          var div = update.select(".d3plus-tooltip-".concat(cat)).html(function (d, i) {
            return that["_".concat(cat)](d, i);
          }).style("display", function (d, i) {
            var val = that["_".concat(cat)](d, i);
            var visible = val !== false && val !== undefined && val !== null;
            return visible ? "block" : "none";
          });
          stylize(div, that["_".concat(cat, "Style")]);
        }
        /**
            Fetches table contents given functions or values.
            @private
        */


        function cellContent(d) {
          if (typeof d === "function") {
            var datum = _select(this.parentNode.parentNode).datum();
            return d(datum, that._data.indexOf(datum));
          } else return d;
        }
        /**
            Sets styles for both enter and update.
            @private
        */


        function boxStyles(box) {
          box.style("background", that._background).style("".concat(that._prefix, "border-radius"), that._borderRadius).style("pointer-events", that._pointerEvents).style("padding", that._padding).style("width", that._width).style("height", that._height).style("border", function (d, i) {
            var b = _select(this).style("border");
            return b !== "0px none rgb(0, 0, 0)" ? b : that._border(d, i);
          });
        }

        divElement("title");
        divElement("body");
        var tableEnter = enter.append("table").attr("class", "d3plus-tooltip-table");
        var table = update.select(".d3plus-tooltip-table");
        stylize(table, this._tableStyle);
        tableEnter.append("thead").attr("class", "d3plus-tooltip-thead");
        var tableHead = update.select(".d3plus-tooltip-thead");
        stylize(tableHead, this._theadStyle);
        var th = tableHead.selectAll("th").data(this._thead);
        th.enter().append("th").merge(th).html(cellContent);
        th.exit().remove();
        tableEnter.append("tbody").attr("class", "d3plus-tooltip-tbody");
        var tableBody = update.select(".d3plus-tooltip-tbody");
        stylize(tableBody, this._tbodyStyle);
        var tr = tableBody.selectAll("tr").data(this._tbody);
        var trEnter = tr.enter().append("tr");
        tr.exit().remove();
        var trUpdate = tr.merge(trEnter);
        stylize(trUpdate, this._trStyle);
        var td = trUpdate.selectAll("td").data(function (d) {
          return d;
        });
        td.enter().append("td").merge(td).html(cellContent);
        stylize(td, this._tdStyle);
        divElement("footer");
        divElement("arrow");
        enter.attr("id", function (d, i) {
          return "d3plus-tooltip-".concat(d ? _this2._id(d, i) : "");
        }).call(boxStyles).each(function (d, i) {
          var id = that._id(d, i);

          var tooltip = document.getElementById("d3plus-tooltip-".concat(id));
          var arrow = document.getElementById("d3plus-tooltip-arrow-".concat(id));
          var arrowHeight = arrow.offsetHeight;
          var arrowDistance = arrow.getBoundingClientRect().height / 2;
          arrow.style.bottom = "-".concat(arrowHeight / 2, "px");

          var position = that._position(d, i);

          var referenceObject = Array.isArray(position) ? {
            clientWidth: 0,
            clientHeight: 0,
            getBoundingClientRect: function getBoundingClientRect() {
              return {
                top: position[1],
                right: position[0],
                bottom: position[1],
                left: position[0],
                width: 0,
                height: 0
              };
            }
          } : position;
          _this2._popperClasses[id] = new Popper(referenceObject, tooltip, {
            placement: "top",
            placements: ["top", "bottom", "left", "right"],
            modifiers: {
              arrow: {
                element: arrow
              },
              offset: {
                offset: "0,".concat(that._offset(d, i) + arrowDistance)
              },
              preventOverflow: {
                boundariesElement: "scrollParent"
              },
              flip: {
                behavior: "flip",
                boundariesElement: "viewport"
              }
            },
            onUpdate: function onUpdate(_ref) {
              var arrowElement = _ref.arrowElement,
                  flipped = _ref.flipped;

              if (flipped) {
                arrowElement.style.transform = "rotate(225deg)";
                arrowElement.style.top = "-".concat(arrowHeight / 2, "px");
              } else {
                arrowElement.style.transform = "rotate(45deg)";
                arrowElement.style.bottom = "-".concat(arrowHeight / 2, "px");
              }
            },
            removeOnDestroy: true
          });
        });
        update.each(function (d, i) {
          var id = that._id(d, i);

          var position = that._position(d, i);

          var instance = _this2._popperClasses[id];

          if (instance) {
            var referenceObject = Array.isArray(position) ? {
              clientWidth: 0,
              clientHeight: 0,
              getBoundingClientRect: function getBoundingClientRect() {
                return {
                  top: position[1],
                  right: position[0],
                  bottom: position[1],
                  left: position[0],
                  width: 0,
                  height: 0
                };
              }
            } : position;
            instance.reference = referenceObject;
            instance.scheduleUpdate();
          }
        }).call(boxStyles);
        tooltips.exit().each(function (d, i) {
          var id = that._id(d, i);

          var instance = _this2._popperClasses[id];

          if (instance) {
            instance.destroy();
            delete _this2._popperClasses[id];
          }
        }).remove();
        if (callback) setTimeout(callback, 100);
        return this;
      }
      /**
       @memberof Tooltip
       @desc Sets the inner HTML content of the arrow element, which by default is empty.
       @param {Function|String} [*value*]
       @example <caption>default accessor</caption>
       function value(d) {
      return d.arrow || "";
      }
       */

    }, {
      key: "arrow",
      value: function arrow(_) {
        return arguments.length ? (this._arrow = typeof _ === "function" ? _ : constant$3(_), this) : this._arrow;
      }
      /**
       @memberof Tooltip
       @desc If *value* is specified, sets the arrow styles to the specified values and returns this generator. If *value* is not specified, returns the current arrow styles.
       @param {Object} [*value*]
       @example <caption>default styles</caption>
       {
         "content": "",
         "border-width": "10px",
         "border-style": "solid",
         "border-color": "rgba(255, 255, 255, 0.75) transparent transparent transparent",
         "position": "absolute"
       }
       */

    }, {
      key: "arrowStyle",
      value: function arrowStyle(_) {
        return arguments.length ? (this._arrowStyle = Object.assign(this._arrowStyle, _), this) : this._arrowStyle;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the background accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current background accessor.
          @param {Function|String} [*value* = "rgba(255, 255, 255, 0.75)"]
      */

    }, {
      key: "background",
      value: function background(_) {
        return arguments.length ? (this._background = typeof _ === "function" ? _ : constant$3(_), this) : this._background;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the body accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current body accessor.
          @param {Function|String} [*value*]
          @example <caption>default accessor</caption>
      function value(d) {
      return d.body || "";
      }
      */

    }, {
      key: "body",
      value: function body(_) {
        return arguments.length ? (this._body = typeof _ === "function" ? _ : constant$3(_), this) : this._body;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the body styles to the specified values and returns this generator. If *value* is not specified, returns the current body styles.
          @param {Object} [*value*]
          @example <caption>default styles</caption>
      {
      "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
      "font-size": "12px",
      "font-weight": "400"
      }
      */

    }, {
      key: "bodyStyle",
      value: function bodyStyle(_) {
        return arguments.length ? (this._bodyStyle = Object.assign(this._bodyStyle, _), this) : this._bodyStyle;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the border accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current border accessor.
          @param {Function|String} [*value* = "1px solid rgba(0, 0, 0, 0.1)"]
      */

    }, {
      key: "border",
      value: function border(_) {
        return arguments.length ? (this._border = typeof _ === "function" ? _ : constant$3(_), this) : this._border;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the border-radius accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current border-radius accessor.
          @param {Function|String} [*value* = "2px"]
      */

    }, {
      key: "borderRadius",
      value: function borderRadius(_) {
        return arguments.length ? (this._borderRadius = typeof _ === "function" ? _ : constant$3(_), this) : this._borderRadius;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the class name to the specified string and returns this generator. If *value* is not specified, returns the current class name.
          @param {String} [*value* = "d3plus-tooltip"]
      */

    }, {
      key: "className",
      value: function className(_) {
        return arguments.length ? (this._className = _, this) : this._className;
      }
      /**
          @memberof Tooltip
          @desc If *data* is specified, sets the data array to the specified array and returns this generator. If *data* is not specified, returns the current data array.
          @param {Array} [*data* = []]
      */

    }, {
      key: "data",
      value: function data(_) {
        return arguments.length ? (this._data = _, this) : this._data;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the footer accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current footer accessor.
          @param {Function|String} [*value*]
          @example <caption>default accessor</caption>
      function value(d) {
      return d.footer || "";
      }
      */

    }, {
      key: "footer",
      value: function footer(_) {
        return arguments.length ? (this._footer = typeof _ === "function" ? _ : constant$3(_), this) : this._footer;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the footer styles to the specified values and returns this generator. If *value* is not specified, returns the current footer styles.
          @param {Object} [*value*]
          @example <caption>default styles</caption>
      {
      "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
      "font-size": "12px",
      "font-weight": "400"
      }
      */

    }, {
      key: "footerStyle",
      value: function footerStyle(_) {
        return arguments.length ? (this._footerStyle = Object.assign(this._footerStyle, _), this) : this._footerStyle;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the height accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current height accessor.
          @param {Function|String} [*value* = "auto"]
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = typeof _ === "function" ? _ : constant$3(_), this) : this._height;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the id accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current id accessor.
          @param {Function|String} [*value*]
          @example <caption>default accessor</caption>
      function value(d, i) {
      return d.id || "" + i;
      }
      */

    }, {
      key: "id",
      value: function id(_) {
        return arguments.length ? (this._id = typeof _ === "function" ? _ : constant$3(_), this) : this._id;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the offset accessor to the specified function or number and returns this generator. If *value* is not specified, returns the current offset accessor.
          @param {Function|Number} [*value* = 10]
      */

    }, {
      key: "offset",
      value: function offset(_) {
        return arguments.length ? (this._offset = typeof _ === "function" ? _ : constant$3(_), this) : this._offset;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the padding accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current padding accessor.
          @param {Function|String} [*value* = "5px"]
      */

    }, {
      key: "padding",
      value: function padding(_) {
        return arguments.length ? (this._padding = typeof _ === "function" ? _ : constant$3(_), this) : this._padding;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the pointer-events accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current pointer-events accessor.
          @param {Function|String} [*value* = "auto"]
      */

    }, {
      key: "pointerEvents",
      value: function pointerEvents(_) {
        return arguments.length ? (this._pointerEvents = typeof _ === "function" ? _ : constant$3(_), this) : this._pointerEvents;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the position accessor to the specified function or array and returns this generator. If *value* is not specified, returns the current position accessor. If *value* is an HTMLElement, anchors the Tooltip to that HTMLElement. If *value* is a selection string, anchors the Tooltip to the HTMLElement selected by that string. Otherwise, coordinate points must be in reference to the client viewport, not the overall page.
          @param {Function|Array|HTMLElement|String} [*value*]
          @example <caption>default accessor</caption>
       function value(d) {
        return [d.x, d.y];
      }
       */

    }, {
      key: "position",
      value: function position(_) {
        return arguments.length ? (this._position = typeof _ === "string" ? constant$3(_select(_).node() || [0, 0]) : typeof _ === "function" ? _ : constant$3(_), this) : this._position;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the table styles to the specified values and returns this generator. If *value* is not specified, returns the current table styles.
          @param {Object} [*value*]
          @example <caption>default styles</caption>
      {
      "border-collapse": "collapse",
      "border-spacing": "0",
      "width": "100%"
      }
      */

    }, {
      key: "tableStyle",
      value: function tableStyle(_) {
        return arguments.length ? (this._tableStyle = Object.assign(this._tableStyle, _), this) : this._tableStyle;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the contents of the table body to the specified array of functions or strings and returns this generator. If *value* is not specified, returns the current table body data.
          @param {Array} [*value* = []]
      */

    }, {
      key: "tbody",
      value: function tbody(_) {
        return arguments.length ? (this._tbody = _, this) : this._tbody;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the table body styles to the specified values and returns this generator. If *value* is not specified, returns the current table body styles.
          @param {Object} [*value*]
          @example <caption>default styles</caption>
      {
      "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
      "font-size": "12px",
      "font-weight": "600",
      "text-align": "center"
      }
      */

    }, {
      key: "tbodyStyle",
      value: function tbodyStyle(_) {
        return arguments.length ? (this._tbodyStyle = Object.assign(this._tbodyStyle, _), this) : this._tbodyStyle;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the contents of the table head to the specified array of functions or strings and returns this generator. If *value* is not specified, returns the current table head data.
          @param {Array} [*value* = []]
      */

    }, {
      key: "thead",
      value: function thead(_) {
        return arguments.length ? (this._thead = _, this) : this._thead;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the table head styles to the specified values and returns this generator. If *value* is not specified, returns the current table head styles.
          @param {Object} [*value*]
          @example <caption>default styles</caption>
      {
      "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
      "font-size": "12px",
      "font-weight": "600",
      "text-align": "center"
      }
      */

    }, {
      key: "theadStyle",
      value: function theadStyle(_) {
        return arguments.length ? (this._theadStyle = Object.assign(this._theadStyle, _), this) : this._theadStyle;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the title accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current title accessor.
          @param {Function|String} [*value*]
          @example <caption>default accessor</caption>
      function value(d) {
      return d.title || "";
      }
      */

    }, {
      key: "title",
      value: function title(_) {
        return arguments.length ? (this._title = typeof _ === "function" ? _ : constant$3(_), this) : this._title;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the title styles to the specified values and returns this generator. If *value* is not specified, returns the current title styles.
          @param {Object} [*value*]
          @example <caption>default styles</caption>
      {
      "font-family": "'Roboto', 'Helvetica Neue', 'HelveticaNeue', 'Helvetica', 'Arial', sans-serif",
      "font-size": "14px",
      "font-weight": "600",
      "padding-bottom": "5px"
      }
      */

    }, {
      key: "titleStyle",
      value: function titleStyle(_) {
        return arguments.length ? (this._titleStyle = Object.assign(this._titleStyle, _), this) : this._titleStyle;
      }
      /**
          @memberof Tooltip
          @desc An object with CSS keys and values to be applied to all <tr> elements inside of each <tbody>.
          @param {Object} [*value*]
          @example <caption>default styles</caption>
      {
        "border-top": "1px solid rgba(0, 0, 0, 0.1)"
      }
       */

    }, {
      key: "trStyle",
      value: function trStyle(_) {
        return arguments.length ? (this._trStyle = Object.assign(this._trStyle, _), this) : this._trStyle;
      }
      /**
          @memberof Tooltip
          @desc An object with CSS keys and values to be applied to all <td> elements inside of each <tr>.
          @param {Object} [*value*]
       */

    }, {
      key: "tdStyle",
      value: function tdStyle(_) {
        return arguments.length ? (this._tdStyle = Object.assign(this._tdStyle, _), this) : this._tdStyle;
      }
      /**
          @memberof Tooltip
          @desc If *value* is specified, sets the width accessor to the specified function or string and returns this generator. If *value* is not specified, returns the current width accessor.
          @param {Function|String} [*value* = "auto"]
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = typeof _ === "function" ? _ : constant$3(_), this) : this._width;
      }
    }]);

    return Tooltip;
  }(BaseClass);

  function _classCallCheck$o(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$k(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$k(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$k(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$k(Constructor, staticProps);
    return Constructor;
  }
  /**
      @class Message
      @desc Displays a message using plain HTML.
      @private
  */

  var Message =
  /*#__PURE__*/
  function () {
    /**
        @memberof Message
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */
    function Message() {
      _classCallCheck$o(this, Message);

      this._isVisible = false;
    }
    /**
        @memberof Message
        @desc Removes the message from the page.
        @chainable
    */


    _createClass$k(Message, [{
      key: "exit",
      value: function exit(elem, duration) {
        elem.transition().duration(duration).style("opacity", 0).transition().remove();
        this._isVisible = false;
      }
      /**
          @memberof Message
          @desc Removes the message from the page.
          @chainable
      */

    }, {
      key: "hide",
      value: function hide() {
        var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
            _ref$duration = _ref.duration,
            duration = _ref$duration === void 0 ? 600 : _ref$duration,
            callback = _ref.callback;

        this.mask.call(this.exit.bind(this), duration);
        this.elem.call(this.exit.bind(this), duration);
        if (callback) setTimeout(callback, duration + 100);
        this._isVisible = false;
        return this;
      }
      /**
          @memberof Message
          @desc Draws the message given the specified configuration.
          @param {Object} [*config*]
          @chainable
      */

    }, {
      key: "render",
      value: function render() {
        var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
            callback = _ref2.callback,
            _ref2$container = _ref2.container,
            container = _ref2$container === void 0 ? "body" : _ref2$container,
            _ref2$duration = _ref2.duration,
            duration = _ref2$duration === void 0 ? 600 : _ref2$duration,
            _ref2$html = _ref2.html,
            html = _ref2$html === void 0 ? "Please Wait" : _ref2$html,
            _ref2$mask = _ref2.mask,
            mask = _ref2$mask === void 0 ? "rgba(0, 0, 0, 0.05)" : _ref2$mask,
            _ref2$style = _ref2.style,
            style = _ref2$style === void 0 ? {} : _ref2$style;

        var parent = _select(container).style("position", "relative");
        this.mask = parent.selectAll("div.d3plus-Mask").data(mask ? [mask] : []);
        this.mask = this.mask.enter().append("div").attr("class", "d3plus-Mask").style("opacity", 1).merge(this.mask);
        this.mask.exit().call(this.exit.bind(this), duration);
        stylize(this.mask, {
          "background-color": String,
          "bottom": "0px",
          "left": "0px",
          "position": "absolute",
          "right": "0px",
          "top": "0px"
        });
        this.elem = parent.selectAll("div.d3plus-Message").data([html]);
        this.elem = this.elem.enter().append("div").attr("class", "d3plus-Message").style("opacity", 1).merge(this.elem).html(String);
        stylize(this.elem, style);
        if (callback) setTimeout(callback, 100);
        this._isVisible = true;
        return this;
      }
    }]);

    return Message;
  }();

  /**
      @function _drawBack
      @desc Draws a back button if there are states in this._history.
      @private
  */

  function drawBack () {
    var visible = this._history.length;
    var backGroup = elem("g.d3plus-viz-back", {
      parent: this._select,
      transition: this._transition,
      update: {
        transform: "translate(".concat(this._margin.left, ", ").concat(this._margin.top, ")")
      }
    }).node();

    this._backClass.data(visible ? [{
      text: "\u2190 ".concat(this._translate("Back")),
      x: 0,
      y: 0
    }] : []).select(backGroup).config(this._backConfig).render();

    this._margin.top += visible ? this._backClass.fontSize()() + this._backClass.padding()() * 2 : 0;
  }

  /**
      @function _drawColorScale
      @desc Renders the color scale if this._colorScale is not falsey.
      @private
  */

  function drawColorScale () {
    var _this = this;

    var data = this._data;
    var position = this._colorScalePosition || "bottom";
    var wide = ["top", "bottom"].includes(position);
    var padding = this._colorScalePadding() ? this._padding : {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    };
    var availableWidth = this._width - (this._margin.left + this._margin.right + padding.left + padding.right);
    var width = wide ? min([this._colorScaleMaxSize, availableWidth]) : this._width - (this._margin.left + this._margin.right);
    var availableHeight = this._height - (this._margin.bottom + this._margin.top + padding.bottom + padding.top);
    var height = !wide ? min([this._colorScaleMaxSize, availableHeight]) : this._height - (this._margin.bottom + this._margin.top);
    var transform = {
      opacity: this._colorScalePosition ? 1 : 0,
      transform: "translate(".concat(wide ? this._margin.left + padding.left + (availableWidth - width) / 2 : this._margin.left, ", ").concat(wide ? this._margin.top : this._margin.top + padding.top + (availableHeight - height) / 2, ")")
    };
    var showColorScale = this._colorScale && data && data.length > 1;
    var scaleGroup = elem("g.d3plus-viz-colorScale", {
      condition: showColorScale && !this._colorScaleConfig.select,
      enter: transform,
      parent: this._select,
      transition: this._transition,
      update: transform
    }).node();

    if (showColorScale) {
      var scaleData = data.filter(function (d, i) {
        var c = _this._colorScale(d, i);

        return c !== undefined && c !== null;
      });

      this._colorScaleClass.align({
        bottom: "end",
        left: "start",
        right: "end",
        top: "start"
      }[position] || "bottom").duration(this._duration).data(scaleData).height(height).locale(this._locale).orient(position).select(scaleGroup).value(this._colorScale).width(width).config(this._colorScaleConfig).render();

      var scaleBounds = this._colorScaleClass.outerBounds();

      if (this._colorScalePosition && !this._colorScaleConfig.select && scaleBounds.height) {
        if (wide) this._margin[position] += scaleBounds.height + this._legendClass.padding() * 2;else this._margin[position] += scaleBounds.width + this._legendClass.padding() * 2;
      }
    } else {
      this._colorScaleClass.config(this._colorScaleConfig);
    }
  }

  var html2canvas = createCommonjsModule(function (module, exports) {
    /*
      html2canvas 0.5.0-beta4 <http://html2canvas.hertzen.com>
      Copyright (c) 2016 Niklas von Hertzen
    
      Released under  License
    */
    (function (f) {
      {
        module.exports = f();
      }
    })(function () {
      return function e(t, n, r) {
        function s(o, u) {
          if (!n[o]) {
            if (!t[o]) {
              var a = typeof commonjsRequire == "function" && commonjsRequire;
              if (!u && a) return a(o, !0);
              if (i) return i(o, !0);
              var f = new Error("Cannot find module '" + o + "'");
              throw f.code = "MODULE_NOT_FOUND", f;
            }

            var l = n[o] = {
              exports: {}
            };
            t[o][0].call(l.exports, function (e) {
              var n = t[o][1][e];
              return s(n ? n : e);
            }, l, l.exports, e, t, n, r);
          }

          return n[o].exports;
        }

        var i = typeof commonjsRequire == "function" && commonjsRequire;

        for (var o = 0; o < r.length; o++) {
          s(r[o]);
        }

        return s;
      }({
        1: [function (_dereq_, module, exports) {
          (function (global) {

            (function (root) {
              /** Detect free variables */
              var freeExports = _typeof(exports) == 'object' && exports && !exports.nodeType && exports;
              var freeModule = _typeof(module) == 'object' && module && !module.nodeType && module;
              var freeGlobal = _typeof(global) == 'object' && global;

              if (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal || freeGlobal.self === freeGlobal) {
                root = freeGlobal;
              }
              /**
               * The `punycode` object.
               * @name punycode
               * @type Object
               */


              var punycode,

              /** Highest positive signed 32-bit float value */
              maxInt = 2147483647,
                  // aka. 0x7FFFFFFF or 2^31-1

              /** Bootstring parameters */
              base = 36,
                  tMin = 1,
                  tMax = 26,
                  skew = 38,
                  damp = 700,
                  initialBias = 72,
                  initialN = 128,
                  // 0x80
              delimiter = '-',
                  // '\x2D'

              /** Regular expressions */
              regexPunycode = /^xn--/,
                  regexNonASCII = /[^\x20-\x7E]/,
                  // unprintable ASCII chars + non-ASCII chars
              regexSeparators = /[\x2E\u3002\uFF0E\uFF61]/g,
                  // RFC 3490 separators

              /** Error messages */
              errors = {
                'overflow': 'Overflow: input needs wider integers to process',
                'not-basic': 'Illegal input >= 0x80 (not a basic code point)',
                'invalid-input': 'Invalid input'
              },

              /** Convenience shortcuts */
              baseMinusTMin = base - tMin,
                  floor = Math.floor,
                  stringFromCharCode = String.fromCharCode,

              /** Temporary variable */
              key;
              /*--------------------------------------------------------------------------*/

              /**
               * A generic error utility function.
               * @private
               * @param {String} type The error type.
               * @returns {Error} Throws a `RangeError` with the applicable error message.
               */

              function error(type) {
                throw new RangeError(errors[type]);
              }
              /**
               * A generic `Array#map` utility function.
               * @private
               * @param {Array} array The array to iterate over.
               * @param {Function} callback The function that gets called for every array
               * item.
               * @returns {Array} A new array of values returned by the callback function.
               */


              function map(array, fn) {
                var length = array.length;
                var result = [];

                while (length--) {
                  result[length] = fn(array[length]);
                }

                return result;
              }
              /**
               * A simple `Array#map`-like wrapper to work with domain name strings or email
               * addresses.
               * @private
               * @param {String} domain The domain name or email address.
               * @param {Function} callback The function that gets called for every
               * character.
               * @returns {Array} A new string of characters returned by the callback
               * function.
               */


              function mapDomain(string, fn) {
                var parts = string.split('@');
                var result = '';

                if (parts.length > 1) {
                  // In email addresses, only the domain name should be punycoded. Leave
                  // the local part (i.e. everything up to `@`) intact.
                  result = parts[0] + '@';
                  string = parts[1];
                } // Avoid `split(regex)` for IE8 compatibility. See #17.


                string = string.replace(regexSeparators, '\x2E');
                var labels = string.split('.');
                var encoded = map(labels, fn).join('.');
                return result + encoded;
              }
              /**
               * Creates an array containing the numeric code points of each Unicode
               * character in the string. While JavaScript uses UCS-2 internally,
               * this function will convert a pair of surrogate halves (each of which
               * UCS-2 exposes as separate characters) into a single code point,
               * matching UTF-16.
               * @see `punycode.ucs2.encode`
               * @see <https://mathiasbynens.be/notes/javascript-encoding>
               * @memberOf punycode.ucs2
               * @name decode
               * @param {String} string The Unicode input string (UCS-2).
               * @returns {Array} The new array of code points.
               */


              function ucs2decode(string) {
                var output = [],
                    counter = 0,
                    length = string.length,
                    value,
                    extra;

                while (counter < length) {
                  value = string.charCodeAt(counter++);

                  if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
                    // high surrogate, and there is a next character
                    extra = string.charCodeAt(counter++);

                    if ((extra & 0xFC00) == 0xDC00) {
                      // low surrogate
                      output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
                    } else {
                      // unmatched surrogate; only append this code unit, in case the next
                      // code unit is the high surrogate of a surrogate pair
                      output.push(value);
                      counter--;
                    }
                  } else {
                    output.push(value);
                  }
                }

                return output;
              }
              /**
               * Creates a string based on an array of numeric code points.
               * @see `punycode.ucs2.decode`
               * @memberOf punycode.ucs2
               * @name encode
               * @param {Array} codePoints The array of numeric code points.
               * @returns {String} The new Unicode string (UCS-2).
               */


              function ucs2encode(array) {
                return map(array, function (value) {
                  var output = '';

                  if (value > 0xFFFF) {
                    value -= 0x10000;
                    output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
                    value = 0xDC00 | value & 0x3FF;
                  }

                  output += stringFromCharCode(value);
                  return output;
                }).join('');
              }
              /**
               * Converts a basic code point into a digit/integer.
               * @see `digitToBasic()`
               * @private
               * @param {Number} codePoint The basic numeric code point value.
               * @returns {Number} The numeric value of a basic code point (for use in
               * representing integers) in the range `0` to `base - 1`, or `base` if
               * the code point does not represent a value.
               */


              function basicToDigit(codePoint) {
                if (codePoint - 48 < 10) {
                  return codePoint - 22;
                }

                if (codePoint - 65 < 26) {
                  return codePoint - 65;
                }

                if (codePoint - 97 < 26) {
                  return codePoint - 97;
                }

                return base;
              }
              /**
               * Converts a digit/integer into a basic code point.
               * @see `basicToDigit()`
               * @private
               * @param {Number} digit The numeric value of a basic code point.
               * @returns {Number} The basic code point whose value (when used for
               * representing integers) is `digit`, which needs to be in the range
               * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is
               * used; else, the lowercase form is used. The behavior is undefined
               * if `flag` is non-zero and `digit` has no uppercase form.
               */


              function digitToBasic(digit, flag) {
                //  0..25 map to ASCII a..z or A..Z
                // 26..35 map to ASCII 0..9
                return digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);
              }
              /**
               * Bias adaptation function as per section 3.4 of RFC 3492.
               * https://tools.ietf.org/html/rfc3492#section-3.4
               * @private
               */


              function adapt(delta, numPoints, firstTime) {
                var k = 0;
                delta = firstTime ? floor(delta / damp) : delta >> 1;
                delta += floor(delta / numPoints);

                for (;
                /* no initialization */
                delta > baseMinusTMin * tMax >> 1; k += base) {
                  delta = floor(delta / baseMinusTMin);
                }

                return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));
              }
              /**
               * Converts a Punycode string of ASCII-only symbols to a string of Unicode
               * symbols.
               * @memberOf punycode
               * @param {String} input The Punycode string of ASCII-only symbols.
               * @returns {String} The resulting string of Unicode symbols.
               */


              function decode(input) {
                // Don't use UCS-2
                var output = [],
                    inputLength = input.length,
                    out,
                    i = 0,
                    n = initialN,
                    bias = initialBias,
                    basic,
                    j,
                    index,
                    oldi,
                    w,
                    k,
                    digit,
                    t,

                /** Cached calculation results */
                baseMinusT; // Handle the basic code points: let `basic` be the number of input code
                // points before the last delimiter, or `0` if there is none, then copy
                // the first basic code points to the output.

                basic = input.lastIndexOf(delimiter);

                if (basic < 0) {
                  basic = 0;
                }

                for (j = 0; j < basic; ++j) {
                  // if it's not a basic code point
                  if (input.charCodeAt(j) >= 0x80) {
                    error('not-basic');
                  }

                  output.push(input.charCodeAt(j));
                } // Main decoding loop: start just after the last delimiter if any basic code
                // points were copied; start at the beginning otherwise.


                for (index = basic > 0 ? basic + 1 : 0; index < inputLength;)
                /* no final expression */
                {
                  // `index` is the index of the next character to be consumed.
                  // Decode a generalized variable-length integer into `delta`,
                  // which gets added to `i`. The overflow checking is easier
                  // if we increase `i` as we go, then subtract off its starting
                  // value at the end to obtain `delta`.
                  for (oldi = i, w = 1, k = base;;
                  /* no condition */
                  k += base) {
                    if (index >= inputLength) {
                      error('invalid-input');
                    }

                    digit = basicToDigit(input.charCodeAt(index++));

                    if (digit >= base || digit > floor((maxInt - i) / w)) {
                      error('overflow');
                    }

                    i += digit * w;
                    t = k <= bias ? tMin : k >= bias + tMax ? tMax : k - bias;

                    if (digit < t) {
                      break;
                    }

                    baseMinusT = base - t;

                    if (w > floor(maxInt / baseMinusT)) {
                      error('overflow');
                    }

                    w *= baseMinusT;
                  }

                  out = output.length + 1;
                  bias = adapt(i - oldi, out, oldi == 0); // `i` was supposed to wrap around from `out` to `0`,
                  // incrementing `n` each time, so we'll fix that now:

                  if (floor(i / out) > maxInt - n) {
                    error('overflow');
                  }

                  n += floor(i / out);
                  i %= out; // Insert `n` at position `i` of the output

                  output.splice(i++, 0, n);
                }

                return ucs2encode(output);
              }
              /**
               * Converts a string of Unicode symbols (e.g. a domain name label) to a
               * Punycode string of ASCII-only symbols.
               * @memberOf punycode
               * @param {String} input The string of Unicode symbols.
               * @returns {String} The resulting Punycode string of ASCII-only symbols.
               */


              function encode(input) {
                var n,
                    delta,
                    handledCPCount,
                    basicLength,
                    bias,
                    j,
                    m,
                    q,
                    k,
                    t,
                    currentValue,
                    output = [],

                /** `inputLength` will hold the number of code points in `input`. */
                inputLength,

                /** Cached calculation results */
                handledCPCountPlusOne,
                    baseMinusT,
                    qMinusT; // Convert the input in UCS-2 to Unicode

                input = ucs2decode(input); // Cache the length

                inputLength = input.length; // Initialize the state

                n = initialN;
                delta = 0;
                bias = initialBias; // Handle the basic code points

                for (j = 0; j < inputLength; ++j) {
                  currentValue = input[j];

                  if (currentValue < 0x80) {
                    output.push(stringFromCharCode(currentValue));
                  }
                }

                handledCPCount = basicLength = output.length; // `handledCPCount` is the number of code points that have been handled;
                // `basicLength` is the number of basic code points.
                // Finish the basic string - if it is not empty - with a delimiter

                if (basicLength) {
                  output.push(delimiter);
                } // Main encoding loop:


                while (handledCPCount < inputLength) {
                  // All non-basic code points < n have been handled already. Find the next
                  // larger one:
                  for (m = maxInt, j = 0; j < inputLength; ++j) {
                    currentValue = input[j];

                    if (currentValue >= n && currentValue < m) {
                      m = currentValue;
                    }
                  } // Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,
                  // but guard against overflow


                  handledCPCountPlusOne = handledCPCount + 1;

                  if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {
                    error('overflow');
                  }

                  delta += (m - n) * handledCPCountPlusOne;
                  n = m;

                  for (j = 0; j < inputLength; ++j) {
                    currentValue = input[j];

                    if (currentValue < n && ++delta > maxInt) {
                      error('overflow');
                    }

                    if (currentValue == n) {
                      // Represent delta as a generalized variable-length integer
                      for (q = delta, k = base;;
                      /* no condition */
                      k += base) {
                        t = k <= bias ? tMin : k >= bias + tMax ? tMax : k - bias;

                        if (q < t) {
                          break;
                        }

                        qMinusT = q - t;
                        baseMinusT = base - t;
                        output.push(stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0)));
                        q = floor(qMinusT / baseMinusT);
                      }

                      output.push(stringFromCharCode(digitToBasic(q, 0)));
                      bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
                      delta = 0;
                      ++handledCPCount;
                    }
                  }

                  ++delta;
                  ++n;
                }

                return output.join('');
              }
              /**
               * Converts a Punycode string representing a domain name or an email address
               * to Unicode. Only the Punycoded parts of the input will be converted, i.e.
               * it doesn't matter if you call it on a string that has already been
               * converted to Unicode.
               * @memberOf punycode
               * @param {String} input The Punycoded domain name or email address to
               * convert to Unicode.
               * @returns {String} The Unicode representation of the given Punycode
               * string.
               */


              function toUnicode(input) {
                return mapDomain(input, function (string) {
                  return regexPunycode.test(string) ? decode(string.slice(4).toLowerCase()) : string;
                });
              }
              /**
               * Converts a Unicode string representing a domain name or an email address to
               * Punycode. Only the non-ASCII parts of the domain name will be converted,
               * i.e. it doesn't matter if you call it with a domain that's already in
               * ASCII.
               * @memberOf punycode
               * @param {String} input The domain name or email address to convert, as a
               * Unicode string.
               * @returns {String} The Punycode representation of the given domain name or
               * email address.
               */


              function toASCII(input) {
                return mapDomain(input, function (string) {
                  return regexNonASCII.test(string) ? 'xn--' + encode(string) : string;
                });
              }
              /*--------------------------------------------------------------------------*/

              /** Define the public API */


              punycode = {
                /**
                 * A string representing the current Punycode.js version number.
                 * @memberOf punycode
                 * @type String
                 */
                'version': '1.3.2',

                /**
                 * An object of methods to convert from JavaScript's internal character
                 * representation (UCS-2) to Unicode code points, and back.
                 * @see <https://mathiasbynens.be/notes/javascript-encoding>
                 * @memberOf punycode
                 * @type Object
                 */
                'ucs2': {
                  'decode': ucs2decode,
                  'encode': ucs2encode
                },
                'decode': decode,
                'encode': encode,
                'toASCII': toASCII,
                'toUnicode': toUnicode
              };
              /** Expose `punycode` */
              // Some AMD build optimizers, like r.js, check for specific condition patterns
              // like the following:

              if (freeExports && freeModule) {
                if (module.exports == freeExports) {
                  // in Node.js, io.js, or RingoJS v0.8.0+
                  freeModule.exports = punycode;
                } else {
                  // in Narwhal or RingoJS v0.7.0-
                  for (key in punycode) {
                    punycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);
                  }
                }
              } else {
                // in Rhino or a web browser
                root.punycode = punycode;
              }
            })(this);
          }).call(this, typeof commonjsGlobal !== "undefined" ? commonjsGlobal : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {});
        }, {}],
        2: [function (_dereq_, module, exports) {
          var log = _dereq_('./log');

          function restoreOwnerScroll(ownerDocument, x, y) {
            if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {
              ownerDocument.defaultView.scrollTo(x, y);
            }
          }

          function cloneCanvasContents(canvas, clonedCanvas) {
            try {
              if (clonedCanvas) {
                clonedCanvas.width = canvas.width;
                clonedCanvas.height = canvas.height;
                clonedCanvas.getContext("2d").putImageData(canvas.getContext("2d").getImageData(0, 0, canvas.width, canvas.height), 0, 0);
              }
            } catch (e) {
              log("Unable to copy canvas content from", canvas, e);
            }
          }

          function cloneNode(node, javascriptEnabled) {
            var clone = node.nodeType === 3 ? document.createTextNode(node.nodeValue) : node.cloneNode(false);
            var child = node.firstChild;

            while (child) {
              if (javascriptEnabled === true || child.nodeType !== 1 || child.nodeName !== 'SCRIPT') {
                clone.appendChild(cloneNode(child, javascriptEnabled));
              }

              child = child.nextSibling;
            }

            if (node.nodeType === 1) {
              clone._scrollTop = node.scrollTop;
              clone._scrollLeft = node.scrollLeft;

              if (node.nodeName === "CANVAS") {
                cloneCanvasContents(node, clone);
              } else if (node.nodeName === "TEXTAREA" || node.nodeName === "SELECT") {
                clone.value = node.value;
              }
            }

            return clone;
          }

          function initNode(node) {
            if (node.nodeType === 1) {
              node.scrollTop = node._scrollTop;
              node.scrollLeft = node._scrollLeft;
              var child = node.firstChild;

              while (child) {
                initNode(child);
                child = child.nextSibling;
              }
            }
          }

          module.exports = function (ownerDocument, containerDocument, width, height, options, x, y) {
            var documentElement = cloneNode(ownerDocument.documentElement, options.javascriptEnabled);
            var container = containerDocument.createElement("iframe");
            container.className = "html2canvas-container";
            container.style.visibility = "hidden";
            container.style.position = "fixed";
            container.style.left = "-10000px";
            container.style.top = "0px";
            container.style.border = "0";
            container.width = width;
            container.height = height;
            container.scrolling = "no"; // ios won't scroll without it

            containerDocument.body.appendChild(container);
            return new Promise(function (resolve) {
              var documentClone = container.contentWindow.document;
              /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle
               if window url is about:blank, we can assign the url to current by writing onto the document
               */

              container.contentWindow.onload = container.onload = function () {
                var interval = setInterval(function () {
                  if (documentClone.body.childNodes.length > 0) {
                    initNode(documentClone.documentElement);
                    clearInterval(interval);

                    if (options.type === "view") {
                      container.contentWindow.scrollTo(x, y);

                      if (/(iPad|iPhone|iPod)/g.test(navigator.userAgent) && (container.contentWindow.scrollY !== y || container.contentWindow.scrollX !== x)) {
                        documentClone.documentElement.style.top = -y + "px";
                        documentClone.documentElement.style.left = -x + "px";
                        documentClone.documentElement.style.position = 'absolute';
                      }
                    }

                    resolve(container);
                  }
                }, 50);
              };

              documentClone.open();
              documentClone.write("<!DOCTYPE html><html></html>"); // Chrome scrolls the parent document for some reason after the write to the cloned window???

              restoreOwnerScroll(ownerDocument, x, y);
              documentClone.replaceChild(documentClone.adoptNode(documentElement), documentClone.documentElement);
              documentClone.close();
            });
          };
        }, {
          "./log": 13
        }],
        3: [function (_dereq_, module, exports) {
          // http://dev.w3.org/csswg/css-color/
          function Color(value) {
            this.r = 0;
            this.g = 0;
            this.b = 0;
            this.a = null;
            var result = this.fromArray(value) || this.namedColor(value) || this.rgb(value) || this.rgba(value) || this.hex6(value) || this.hex3(value);
          }

          Color.prototype.darken = function (amount) {
            var a = 1 - amount;
            return new Color([Math.round(this.r * a), Math.round(this.g * a), Math.round(this.b * a), this.a]);
          };

          Color.prototype.isTransparent = function () {
            return this.a === 0;
          };

          Color.prototype.isBlack = function () {
            return this.r === 0 && this.g === 0 && this.b === 0;
          };

          Color.prototype.fromArray = function (array) {
            if (Array.isArray(array)) {
              this.r = Math.min(array[0], 255);
              this.g = Math.min(array[1], 255);
              this.b = Math.min(array[2], 255);

              if (array.length > 3) {
                this.a = array[3];
              }
            }

            return Array.isArray(array);
          };

          var _hex3 = /^#([a-f0-9]{3})$/i;

          Color.prototype.hex3 = function (value) {
            var match = null;

            if ((match = value.match(_hex3)) !== null) {
              this.r = parseInt(match[1][0] + match[1][0], 16);
              this.g = parseInt(match[1][1] + match[1][1], 16);
              this.b = parseInt(match[1][2] + match[1][2], 16);
            }

            return match !== null;
          };

          var _hex6 = /^#([a-f0-9]{6})$/i;

          Color.prototype.hex6 = function (value) {
            var match = null;

            if ((match = value.match(_hex6)) !== null) {
              this.r = parseInt(match[1].substring(0, 2), 16);
              this.g = parseInt(match[1].substring(2, 4), 16);
              this.b = parseInt(match[1].substring(4, 6), 16);
            }

            return match !== null;
          };

          var _rgb = /^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;

          Color.prototype.rgb = function (value) {
            var match = null;

            if ((match = value.match(_rgb)) !== null) {
              this.r = Number(match[1]);
              this.g = Number(match[2]);
              this.b = Number(match[3]);
            }

            return match !== null;
          };

          var _rgba = /^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;

          Color.prototype.rgba = function (value) {
            var match = null;

            if ((match = value.match(_rgba)) !== null) {
              this.r = Number(match[1]);
              this.g = Number(match[2]);
              this.b = Number(match[3]);
              this.a = Number(match[4]);
            }

            return match !== null;
          };

          Color.prototype.toString = function () {
            return this.a !== null && this.a !== 1 ? "rgba(" + [this.r, this.g, this.b, this.a].join(",") + ")" : "rgb(" + [this.r, this.g, this.b].join(",") + ")";
          };

          Color.prototype.namedColor = function (value) {
            value = value.toLowerCase();
            var color = colors[value];

            if (color) {
              this.r = color[0];
              this.g = color[1];
              this.b = color[2];
            } else if (value === "transparent") {
              this.r = this.g = this.b = this.a = 0;
              return true;
            }

            return !!color;
          };

          Color.prototype.isColor = true; // JSON.stringify([].slice.call($$('.named-color-table tr'), 1).map(function(row) { return [row.childNodes[3].textContent, row.childNodes[5].textContent.trim().split(",").map(Number)] }).reduce(function(data, row) {data[row[0]] = row[1]; return data}, {}))

          var colors = {
            "aliceblue": [240, 248, 255],
            "antiquewhite": [250, 235, 215],
            "aqua": [0, 255, 255],
            "aquamarine": [127, 255, 212],
            "azure": [240, 255, 255],
            "beige": [245, 245, 220],
            "bisque": [255, 228, 196],
            "black": [0, 0, 0],
            "blanchedalmond": [255, 235, 205],
            "blue": [0, 0, 255],
            "blueviolet": [138, 43, 226],
            "brown": [165, 42, 42],
            "burlywood": [222, 184, 135],
            "cadetblue": [95, 158, 160],
            "chartreuse": [127, 255, 0],
            "chocolate": [210, 105, 30],
            "coral": [255, 127, 80],
            "cornflowerblue": [100, 149, 237],
            "cornsilk": [255, 248, 220],
            "crimson": [220, 20, 60],
            "cyan": [0, 255, 255],
            "darkblue": [0, 0, 139],
            "darkcyan": [0, 139, 139],
            "darkgoldenrod": [184, 134, 11],
            "darkgray": [169, 169, 169],
            "darkgreen": [0, 100, 0],
            "darkgrey": [169, 169, 169],
            "darkkhaki": [189, 183, 107],
            "darkmagenta": [139, 0, 139],
            "darkolivegreen": [85, 107, 47],
            "darkorange": [255, 140, 0],
            "darkorchid": [153, 50, 204],
            "darkred": [139, 0, 0],
            "darksalmon": [233, 150, 122],
            "darkseagreen": [143, 188, 143],
            "darkslateblue": [72, 61, 139],
            "darkslategray": [47, 79, 79],
            "darkslategrey": [47, 79, 79],
            "darkturquoise": [0, 206, 209],
            "darkviolet": [148, 0, 211],
            "deeppink": [255, 20, 147],
            "deepskyblue": [0, 191, 255],
            "dimgray": [105, 105, 105],
            "dimgrey": [105, 105, 105],
            "dodgerblue": [30, 144, 255],
            "firebrick": [178, 34, 34],
            "floralwhite": [255, 250, 240],
            "forestgreen": [34, 139, 34],
            "fuchsia": [255, 0, 255],
            "gainsboro": [220, 220, 220],
            "ghostwhite": [248, 248, 255],
            "gold": [255, 215, 0],
            "goldenrod": [218, 165, 32],
            "gray": [128, 128, 128],
            "green": [0, 128, 0],
            "greenyellow": [173, 255, 47],
            "grey": [128, 128, 128],
            "honeydew": [240, 255, 240],
            "hotpink": [255, 105, 180],
            "indianred": [205, 92, 92],
            "indigo": [75, 0, 130],
            "ivory": [255, 255, 240],
            "khaki": [240, 230, 140],
            "lavender": [230, 230, 250],
            "lavenderblush": [255, 240, 245],
            "lawngreen": [124, 252, 0],
            "lemonchiffon": [255, 250, 205],
            "lightblue": [173, 216, 230],
            "lightcoral": [240, 128, 128],
            "lightcyan": [224, 255, 255],
            "lightgoldenrodyellow": [250, 250, 210],
            "lightgray": [211, 211, 211],
            "lightgreen": [144, 238, 144],
            "lightgrey": [211, 211, 211],
            "lightpink": [255, 182, 193],
            "lightsalmon": [255, 160, 122],
            "lightseagreen": [32, 178, 170],
            "lightskyblue": [135, 206, 250],
            "lightslategray": [119, 136, 153],
            "lightslategrey": [119, 136, 153],
            "lightsteelblue": [176, 196, 222],
            "lightyellow": [255, 255, 224],
            "lime": [0, 255, 0],
            "limegreen": [50, 205, 50],
            "linen": [250, 240, 230],
            "magenta": [255, 0, 255],
            "maroon": [128, 0, 0],
            "mediumaquamarine": [102, 205, 170],
            "mediumblue": [0, 0, 205],
            "mediumorchid": [186, 85, 211],
            "mediumpurple": [147, 112, 219],
            "mediumseagreen": [60, 179, 113],
            "mediumslateblue": [123, 104, 238],
            "mediumspringgreen": [0, 250, 154],
            "mediumturquoise": [72, 209, 204],
            "mediumvioletred": [199, 21, 133],
            "midnightblue": [25, 25, 112],
            "mintcream": [245, 255, 250],
            "mistyrose": [255, 228, 225],
            "moccasin": [255, 228, 181],
            "navajowhite": [255, 222, 173],
            "navy": [0, 0, 128],
            "oldlace": [253, 245, 230],
            "olive": [128, 128, 0],
            "olivedrab": [107, 142, 35],
            "orange": [255, 165, 0],
            "orangered": [255, 69, 0],
            "orchid": [218, 112, 214],
            "palegoldenrod": [238, 232, 170],
            "palegreen": [152, 251, 152],
            "paleturquoise": [175, 238, 238],
            "palevioletred": [219, 112, 147],
            "papayawhip": [255, 239, 213],
            "peachpuff": [255, 218, 185],
            "peru": [205, 133, 63],
            "pink": [255, 192, 203],
            "plum": [221, 160, 221],
            "powderblue": [176, 224, 230],
            "purple": [128, 0, 128],
            "rebeccapurple": [102, 51, 153],
            "red": [255, 0, 0],
            "rosybrown": [188, 143, 143],
            "royalblue": [65, 105, 225],
            "saddlebrown": [139, 69, 19],
            "salmon": [250, 128, 114],
            "sandybrown": [244, 164, 96],
            "seagreen": [46, 139, 87],
            "seashell": [255, 245, 238],
            "sienna": [160, 82, 45],
            "silver": [192, 192, 192],
            "skyblue": [135, 206, 235],
            "slateblue": [106, 90, 205],
            "slategray": [112, 128, 144],
            "slategrey": [112, 128, 144],
            "snow": [255, 250, 250],
            "springgreen": [0, 255, 127],
            "steelblue": [70, 130, 180],
            "tan": [210, 180, 140],
            "teal": [0, 128, 128],
            "thistle": [216, 191, 216],
            "tomato": [255, 99, 71],
            "turquoise": [64, 224, 208],
            "violet": [238, 130, 238],
            "wheat": [245, 222, 179],
            "white": [255, 255, 255],
            "whitesmoke": [245, 245, 245],
            "yellow": [255, 255, 0],
            "yellowgreen": [154, 205, 50]
          };
          module.exports = Color;
        }, {}],
        4: [function (_dereq_, module, exports) {
          var Support = _dereq_('./support');

          var CanvasRenderer = _dereq_('./renderers/canvas');

          var ImageLoader = _dereq_('./imageloader');

          var NodeParser = _dereq_('./nodeparser');

          var NodeContainer = _dereq_('./nodecontainer');

          var log = _dereq_('./log');

          var utils = _dereq_('./utils');

          var createWindowClone = _dereq_('./clone');

          var loadUrlDocument = _dereq_('./proxy').loadUrlDocument;

          var getBounds = utils.getBounds;
          var html2canvasNodeAttribute = "data-html2canvas-node";
          var html2canvasCloneIndex = 0;

          function html2canvas(nodeList, options) {
            var index = html2canvasCloneIndex++;
            options = options || {};

            if (options.logging) {
              log.options.logging = true;
              log.options.start = Date.now();
            }

            options.async = typeof options.async === "undefined" ? true : options.async;
            options.allowTaint = typeof options.allowTaint === "undefined" ? false : options.allowTaint;
            options.removeContainer = typeof options.removeContainer === "undefined" ? true : options.removeContainer;
            options.javascriptEnabled = typeof options.javascriptEnabled === "undefined" ? false : options.javascriptEnabled;
            options.imageTimeout = typeof options.imageTimeout === "undefined" ? 10000 : options.imageTimeout;
            options.renderer = typeof options.renderer === "function" ? options.renderer : CanvasRenderer;
            options.strict = !!options.strict;

            if (typeof nodeList === "string") {
              if (typeof options.proxy !== "string") {
                return Promise.reject("Proxy must be used when rendering url");
              }

              var width = options.width != null ? options.width : window.innerWidth;
              var height = options.height != null ? options.height : window.innerHeight;
              return loadUrlDocument(absoluteUrl(nodeList), options.proxy, document, width, height, options).then(function (container) {
                return renderWindow(container.contentWindow.document.documentElement, container, options, width, height);
              });
            }

            var node = (nodeList === undefined ? [document.documentElement] : nodeList.length ? nodeList : [nodeList])[0];
            node.setAttribute(html2canvasNodeAttribute + index, index);
            return renderDocument(node.ownerDocument, options, node.ownerDocument.defaultView.innerWidth, node.ownerDocument.defaultView.innerHeight, index).then(function (canvas) {
              if (typeof options.onrendered === "function") {
                log("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas");
                options.onrendered(canvas);
              }

              return canvas;
            });
          }

          html2canvas.CanvasRenderer = CanvasRenderer;
          html2canvas.NodeContainer = NodeContainer;
          html2canvas.log = log;
          html2canvas.utils = utils;
          var html2canvasExport = typeof document === "undefined" || typeof Object.create !== "function" || typeof document.createElement("canvas").getContext !== "function" ? function () {
            return Promise.reject("No canvas support");
          } : html2canvas;
          module.exports = html2canvasExport;

          function renderDocument(document, options, windowWidth, windowHeight, html2canvasIndex) {
            return createWindowClone(document, document, windowWidth, windowHeight, options, document.defaultView.pageXOffset, document.defaultView.pageYOffset).then(function (container) {
              log("Document cloned");
              var attributeName = html2canvasNodeAttribute + html2canvasIndex;
              var selector = "[" + attributeName + "='" + html2canvasIndex + "']";
              document.querySelector(selector).removeAttribute(attributeName);
              var clonedWindow = container.contentWindow;
              var node = clonedWindow.document.querySelector(selector);
              var oncloneHandler = typeof options.onclone === "function" ? Promise.resolve(options.onclone(clonedWindow.document)) : Promise.resolve(true);
              return oncloneHandler.then(function () {
                return renderWindow(node, container, options, windowWidth, windowHeight);
              });
            });
          }

          function renderWindow(node, container, options, windowWidth, windowHeight) {
            var clonedWindow = container.contentWindow;
            var support = new Support(clonedWindow.document);
            var imageLoader = new ImageLoader(options, support);
            var bounds = getBounds(node);
            var width = options.type === "view" ? windowWidth : documentWidth(clonedWindow.document);
            var height = options.type === "view" ? windowHeight : documentHeight(clonedWindow.document);
            var renderer = new options.renderer(width, height, imageLoader, options, document);
            var parser = new NodeParser(node, renderer, support, imageLoader, options);
            return parser.ready.then(function () {
              log("Finished rendering");
              var canvas;

              if (options.type === "view") {
                canvas = crop(renderer.canvas, {
                  width: renderer.canvas.width,
                  height: renderer.canvas.height,
                  top: 0,
                  left: 0,
                  x: 0,
                  y: 0
                });
              } else if (node === clonedWindow.document.body || node === clonedWindow.document.documentElement || options.canvas != null) {
                canvas = renderer.canvas;
              } else {
                canvas = crop(renderer.canvas, {
                  width: options.width != null ? options.width : bounds.width,
                  height: options.height != null ? options.height : bounds.height,
                  top: bounds.top,
                  left: bounds.left,
                  x: 0,
                  y: 0
                });
              }

              cleanupContainer(container, options);
              return canvas;
            });
          }

          function cleanupContainer(container, options) {
            if (options.removeContainer) {
              container.parentNode.removeChild(container);
              log("Cleaned up container");
            }
          }

          function crop(canvas, bounds) {
            var croppedCanvas = document.createElement("canvas");
            var x1 = Math.min(canvas.width - 1, Math.max(0, bounds.left));
            var x2 = Math.min(canvas.width, Math.max(1, bounds.left + bounds.width));
            var y1 = Math.min(canvas.height - 1, Math.max(0, bounds.top));
            var y2 = Math.min(canvas.height, Math.max(1, bounds.top + bounds.height));
            croppedCanvas.width = bounds.width;
            croppedCanvas.height = bounds.height;
            var width = x2 - x1;
            var height = y2 - y1;
            log("Cropping canvas at:", "left:", bounds.left, "top:", bounds.top, "width:", width, "height:", height);
            log("Resulting crop with width", bounds.width, "and height", bounds.height, "with x", x1, "and y", y1);
            croppedCanvas.getContext("2d").drawImage(canvas, x1, y1, width, height, bounds.x, bounds.y, width, height);
            return croppedCanvas;
          }

          function documentWidth(doc) {
            return Math.max(Math.max(doc.body.scrollWidth, doc.documentElement.scrollWidth), Math.max(doc.body.offsetWidth, doc.documentElement.offsetWidth), Math.max(doc.body.clientWidth, doc.documentElement.clientWidth));
          }

          function documentHeight(doc) {
            return Math.max(Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight), Math.max(doc.body.offsetHeight, doc.documentElement.offsetHeight), Math.max(doc.body.clientHeight, doc.documentElement.clientHeight));
          }

          function absoluteUrl(url) {
            var link = document.createElement("a");
            link.href = url;
            link.href = link.href;
            return link;
          }
        }, {
          "./clone": 2,
          "./imageloader": 11,
          "./log": 13,
          "./nodecontainer": 14,
          "./nodeparser": 15,
          "./proxy": 16,
          "./renderers/canvas": 20,
          "./support": 22,
          "./utils": 26
        }],
        5: [function (_dereq_, module, exports) {
          var log = _dereq_('./log');

          var smallImage = _dereq_('./utils').smallImage;

          function DummyImageContainer(src) {
            this.src = src;
            log("DummyImageContainer for", src);

            if (!this.promise || !this.image) {
              log("Initiating DummyImageContainer");
              DummyImageContainer.prototype.image = new Image();
              var image = this.image;
              DummyImageContainer.prototype.promise = new Promise(function (resolve, reject) {
                image.onload = resolve;
                image.onerror = reject;
                image.src = smallImage();

                if (image.complete === true) {
                  resolve(image);
                }
              });
            }
          }

          module.exports = DummyImageContainer;
        }, {
          "./log": 13,
          "./utils": 26
        }],
        6: [function (_dereq_, module, exports) {
          var smallImage = _dereq_('./utils').smallImage;

          function Font(family, size) {
            var container = document.createElement('div'),
                img = document.createElement('img'),
                span = document.createElement('span'),
                sampleText = 'Hidden Text',
                baseline,
                middle;
            container.style.visibility = "hidden";
            container.style.fontFamily = family;
            container.style.fontSize = size;
            container.style.margin = 0;
            container.style.padding = 0;
            document.body.appendChild(container);
            img.src = smallImage();
            img.width = 1;
            img.height = 1;
            img.style.margin = 0;
            img.style.padding = 0;
            img.style.verticalAlign = "baseline";
            span.style.fontFamily = family;
            span.style.fontSize = size;
            span.style.margin = 0;
            span.style.padding = 0;
            span.appendChild(document.createTextNode(sampleText));
            container.appendChild(span);
            container.appendChild(img);
            baseline = img.offsetTop - span.offsetTop + 1;
            container.removeChild(span);
            container.appendChild(document.createTextNode(sampleText));
            container.style.lineHeight = "normal";
            img.style.verticalAlign = "super";
            middle = img.offsetTop - container.offsetTop + 1;
            document.body.removeChild(container);
            this.baseline = baseline;
            this.lineWidth = 1;
            this.middle = middle;
          }

          module.exports = Font;
        }, {
          "./utils": 26
        }],
        7: [function (_dereq_, module, exports) {
          var Font = _dereq_('./font');

          function FontMetrics() {
            this.data = {};
          }

          FontMetrics.prototype.getMetrics = function (family, size) {
            if (this.data[family + "-" + size] === undefined) {
              this.data[family + "-" + size] = new Font(family, size);
            }

            return this.data[family + "-" + size];
          };

          module.exports = FontMetrics;
        }, {
          "./font": 6
        }],
        8: [function (_dereq_, module, exports) {
          var utils = _dereq_('./utils');

          var getBounds = utils.getBounds;

          var loadUrlDocument = _dereq_('./proxy').loadUrlDocument;

          function FrameContainer(container, sameOrigin, options) {
            this.image = null;
            this.src = container;
            var self = this;
            var bounds = getBounds(container);
            this.promise = (!sameOrigin ? this.proxyLoad(options.proxy, bounds, options) : new Promise(function (resolve) {
              if (container.contentWindow.document.URL === "about:blank" || container.contentWindow.document.documentElement == null) {
                container.contentWindow.onload = container.onload = function () {
                  resolve(container);
                };
              } else {
                resolve(container);
              }
            })).then(function (container) {
              var html2canvas = _dereq_('./core');

              return html2canvas(container.contentWindow.document.documentElement, {
                type: 'view',
                width: container.width,
                height: container.height,
                proxy: options.proxy,
                javascriptEnabled: options.javascriptEnabled,
                removeContainer: options.removeContainer,
                allowTaint: options.allowTaint,
                imageTimeout: options.imageTimeout / 2
              });
            }).then(function (canvas) {
              return self.image = canvas;
            });
          }

          FrameContainer.prototype.proxyLoad = function (proxy, bounds, options) {
            var container = this.src;
            return loadUrlDocument(container.src, proxy, container.ownerDocument, bounds.width, bounds.height, options);
          };

          module.exports = FrameContainer;
        }, {
          "./core": 4,
          "./proxy": 16,
          "./utils": 26
        }],
        9: [function (_dereq_, module, exports) {
          function GradientContainer(imageData) {
            this.src = imageData.value;
            this.colorStops = [];
            this.type = null;
            this.x0 = 0.5;
            this.y0 = 0.5;
            this.x1 = 0.5;
            this.y1 = 0.5;
            this.promise = Promise.resolve(true);
          }

          GradientContainer.TYPES = {
            LINEAR: 1,
            RADIAL: 2
          }; // TODO: support hsl[a], negative %/length values
          // TODO: support <angle> (e.g. -?\d{1,3}(?:\.\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )

          GradientContainer.REGEXP_COLORSTOP = /^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i;
          module.exports = GradientContainer;
        }, {}],
        10: [function (_dereq_, module, exports) {
          function ImageContainer(src, cors) {
            this.src = src;
            this.image = new Image();
            var self = this;
            this.tainted = null;
            this.promise = new Promise(function (resolve, reject) {
              self.image.onload = resolve;
              self.image.onerror = reject;

              if (cors) {
                self.image.crossOrigin = "anonymous";
              }

              self.image.src = src;

              if (self.image.complete === true) {
                resolve(self.image);
              }
            });
          }

          module.exports = ImageContainer;
        }, {}],
        11: [function (_dereq_, module, exports) {
          var log = _dereq_('./log');

          var ImageContainer = _dereq_('./imagecontainer');

          var DummyImageContainer = _dereq_('./dummyimagecontainer');

          var ProxyImageContainer = _dereq_('./proxyimagecontainer');

          var FrameContainer = _dereq_('./framecontainer');

          var SVGContainer = _dereq_('./svgcontainer');

          var SVGNodeContainer = _dereq_('./svgnodecontainer');

          var LinearGradientContainer = _dereq_('./lineargradientcontainer');

          var WebkitGradientContainer = _dereq_('./webkitgradientcontainer');

          var bind = _dereq_('./utils').bind;

          function ImageLoader(options, support) {
            this.link = null;
            this.options = options;
            this.support = support;
            this.origin = this.getOrigin(window.location.href);
          }

          ImageLoader.prototype.findImages = function (nodes) {
            var images = [];
            nodes.reduce(function (imageNodes, container) {
              switch (container.node.nodeName) {
                case "IMG":
                  return imageNodes.concat([{
                    args: [container.node.src],
                    method: "url"
                  }]);

                case "svg":
                case "IFRAME":
                  return imageNodes.concat([{
                    args: [container.node],
                    method: container.node.nodeName
                  }]);
              }

              return imageNodes;
            }, []).forEach(this.addImage(images, this.loadImage), this);
            return images;
          };

          ImageLoader.prototype.findBackgroundImage = function (images, container) {
            container.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(images, this.loadImage), this);
            return images;
          };

          ImageLoader.prototype.addImage = function (images, callback) {
            return function (newImage) {
              newImage.args.forEach(function (image) {
                if (!this.imageExists(images, image)) {
                  images.splice(0, 0, callback.call(this, newImage));
                  log('Added image #' + images.length, typeof image === "string" ? image.substring(0, 100) : image);
                }
              }, this);
            };
          };

          ImageLoader.prototype.hasImageBackground = function (imageData) {
            return imageData.method !== "none";
          };

          ImageLoader.prototype.loadImage = function (imageData) {
            if (imageData.method === "url") {
              var src = imageData.args[0];

              if (this.isSVG(src) && !this.support.svg && !this.options.allowTaint) {
                return new SVGContainer(src);
              } else if (src.match(/data:image\/.*;base64,/i)) {
                return new ImageContainer(src.replace(/url\(['"]{0,}|['"]{0,}\)$/ig, ''), false);
              } else if (this.isSameOrigin(src) || this.options.allowTaint === true || this.isSVG(src)) {
                return new ImageContainer(src, false);
              } else if (this.support.cors && !this.options.allowTaint && this.options.useCORS) {
                return new ImageContainer(src, true);
              } else if (this.options.proxy) {
                return new ProxyImageContainer(src, this.options.proxy);
              } else {
                return new DummyImageContainer(src);
              }
            } else if (imageData.method === "linear-gradient") {
              return new LinearGradientContainer(imageData);
            } else if (imageData.method === "gradient") {
              return new WebkitGradientContainer(imageData);
            } else if (imageData.method === "svg") {
              return new SVGNodeContainer(imageData.args[0], this.support.svg);
            } else if (imageData.method === "IFRAME") {
              return new FrameContainer(imageData.args[0], this.isSameOrigin(imageData.args[0].src), this.options);
            } else {
              return new DummyImageContainer(imageData);
            }
          };

          ImageLoader.prototype.isSVG = function (src) {
            return src.substring(src.length - 3).toLowerCase() === "svg" || SVGContainer.prototype.isInline(src);
          };

          ImageLoader.prototype.imageExists = function (images, src) {
            return images.some(function (image) {
              return image.src === src;
            });
          };

          ImageLoader.prototype.isSameOrigin = function (url) {
            return this.getOrigin(url) === this.origin;
          };

          ImageLoader.prototype.getOrigin = function (url) {
            var link = this.link || (this.link = document.createElement("a"));
            link.href = url;
            link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/

            return link.protocol + link.hostname + link.port;
          };

          ImageLoader.prototype.getPromise = function (container) {
            return this.timeout(container, this.options.imageTimeout)['catch'](function () {
              var dummy = new DummyImageContainer(container.src);
              return dummy.promise.then(function (image) {
                container.image = image;
              });
            });
          };

          ImageLoader.prototype.get = function (src) {
            var found = null;
            return this.images.some(function (img) {
              return (found = img).src === src;
            }) ? found : null;
          };

          ImageLoader.prototype.fetch = function (nodes) {
            this.images = nodes.reduce(bind(this.findBackgroundImage, this), this.findImages(nodes));
            this.images.forEach(function (image, index) {
              image.promise.then(function () {
                log("Succesfully loaded image #" + (index + 1), image);
              }, function (e) {
                log("Failed loading image #" + (index + 1), image, e);
              });
            });
            this.ready = Promise.all(this.images.map(this.getPromise, this));
            log("Finished searching images");
            return this;
          };

          ImageLoader.prototype.timeout = function (container, timeout) {
            var timer;
            var promise = Promise.race([container.promise, new Promise(function (res, reject) {
              timer = setTimeout(function () {
                log("Timed out loading image", container);
                reject(container);
              }, timeout);
            })]).then(function (container) {
              clearTimeout(timer);
              return container;
            });
            promise['catch'](function () {
              clearTimeout(timer);
            });
            return promise;
          };

          module.exports = ImageLoader;
        }, {
          "./dummyimagecontainer": 5,
          "./framecontainer": 8,
          "./imagecontainer": 10,
          "./lineargradientcontainer": 12,
          "./log": 13,
          "./proxyimagecontainer": 17,
          "./svgcontainer": 23,
          "./svgnodecontainer": 24,
          "./utils": 26,
          "./webkitgradientcontainer": 27
        }],
        12: [function (_dereq_, module, exports) {
          var GradientContainer = _dereq_('./gradientcontainer');

          var Color = _dereq_('./color');

          function LinearGradientContainer(imageData) {
            GradientContainer.apply(this, arguments);
            this.type = GradientContainer.TYPES.LINEAR;
            var hasDirection = LinearGradientContainer.REGEXP_DIRECTION.test(imageData.args[0]) || !GradientContainer.REGEXP_COLORSTOP.test(imageData.args[0]);

            if (hasDirection) {
              imageData.args[0].split(/\s+/).reverse().forEach(function (position, index) {
                switch (position) {
                  case "left":
                    this.x0 = 0;
                    this.x1 = 1;
                    break;

                  case "top":
                    this.y0 = 0;
                    this.y1 = 1;
                    break;

                  case "right":
                    this.x0 = 1;
                    this.x1 = 0;
                    break;

                  case "bottom":
                    this.y0 = 1;
                    this.y1 = 0;
                    break;

                  case "to":
                    var y0 = this.y0;
                    var x0 = this.x0;
                    this.y0 = this.y1;
                    this.x0 = this.x1;
                    this.x1 = x0;
                    this.y1 = y0;
                    break;

                  case "center":
                    break;
                  // centered by default
                  // Firefox internally converts position keywords to percentages:
                  // http://www.w3.org/TR/2010/WD-CSS2-20101207/colors.html#propdef-background-position

                  default:
                    // percentage or absolute length
                    // TODO: support absolute start point positions (e.g., use bounds to convert px to a ratio)
                    var ratio = parseFloat(position, 10) * 1e-2;

                    if (isNaN(ratio)) {
                      // invalid or unhandled value
                      break;
                    }

                    if (index === 0) {
                      this.y0 = ratio;
                      this.y1 = 1 - this.y0;
                    } else {
                      this.x0 = ratio;
                      this.x1 = 1 - this.x0;
                    }

                    break;
                }
              }, this);
            } else {
              this.y0 = 0;
              this.y1 = 1;
            }

            this.colorStops = imageData.args.slice(hasDirection ? 1 : 0).map(function (colorStop) {
              var colorStopMatch = colorStop.match(GradientContainer.REGEXP_COLORSTOP);
              var value = +colorStopMatch[2];
              var unit = value === 0 ? "%" : colorStopMatch[3]; // treat "0" as "0%"

              return {
                color: new Color(colorStopMatch[1]),
                // TODO: support absolute stop positions (e.g., compute gradient line length & convert px to ratio)
                stop: unit === "%" ? value / 100 : null
              };
            });

            if (this.colorStops[0].stop === null) {
              this.colorStops[0].stop = 0;
            }

            if (this.colorStops[this.colorStops.length - 1].stop === null) {
              this.colorStops[this.colorStops.length - 1].stop = 1;
            } // calculates and fills-in explicit stop positions when omitted from rule


            this.colorStops.forEach(function (colorStop, index) {
              if (colorStop.stop === null) {
                this.colorStops.slice(index).some(function (find, count) {
                  if (find.stop !== null) {
                    colorStop.stop = (find.stop - this.colorStops[index - 1].stop) / (count + 1) + this.colorStops[index - 1].stop;
                    return true;
                  } else {
                    return false;
                  }
                }, this);
              }
            }, this);
          }

          LinearGradientContainer.prototype = Object.create(GradientContainer.prototype); // TODO: support <angle> (e.g. -?\d{1,3}(?:\.\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )

          LinearGradientContainer.REGEXP_DIRECTION = /^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i;
          module.exports = LinearGradientContainer;
        }, {
          "./color": 3,
          "./gradientcontainer": 9
        }],
        13: [function (_dereq_, module, exports) {
          var logger = function logger() {
            if (logger.options.logging && window.console && window.console.log) {
              Function.prototype.bind.call(window.console.log, window.console).apply(window.console, [Date.now() - logger.options.start + "ms", "html2canvas:"].concat([].slice.call(arguments, 0)));
            }
          };

          logger.options = {
            logging: false
          };
          module.exports = logger;
        }, {}],
        14: [function (_dereq_, module, exports) {
          var Color = _dereq_('./color');

          var utils = _dereq_('./utils');

          var getBounds = utils.getBounds;
          var parseBackgrounds = utils.parseBackgrounds;
          var offsetBounds = utils.offsetBounds;

          function NodeContainer(node, parent) {
            this.node = node;
            this.parent = parent;
            this.stack = null;
            this.bounds = null;
            this.borders = null;
            this.clip = [];
            this.backgroundClip = [];
            this.offsetBounds = null;
            this.visible = null;
            this.computedStyles = null;
            this.colors = {};
            this.styles = {};
            this.backgroundImages = null;
            this.transformData = null;
            this.transformMatrix = null;
            this.isPseudoElement = false;
            this.opacity = null;
          }

          NodeContainer.prototype.cloneTo = function (stack) {
            stack.visible = this.visible;
            stack.borders = this.borders;
            stack.bounds = this.bounds;
            stack.clip = this.clip;
            stack.backgroundClip = this.backgroundClip;
            stack.computedStyles = this.computedStyles;
            stack.styles = this.styles;
            stack.backgroundImages = this.backgroundImages;
            stack.opacity = this.opacity;
          };

          NodeContainer.prototype.getOpacity = function () {
            return this.opacity === null ? this.opacity = this.cssFloat('opacity') : this.opacity;
          };

          NodeContainer.prototype.assignStack = function (stack) {
            this.stack = stack;
            stack.children.push(this);
          };

          NodeContainer.prototype.isElementVisible = function () {
            return this.node.nodeType === Node.TEXT_NODE ? this.parent.visible : this.css('display') !== "none" && this.css('visibility') !== "hidden" && !this.node.hasAttribute("data-html2canvas-ignore") && (this.node.nodeName !== "INPUT" || this.node.getAttribute("type") !== "hidden");
          };

          NodeContainer.prototype.css = function (attribute) {
            if (!this.computedStyles) {
              this.computedStyles = this.isPseudoElement ? this.parent.computedStyle(this.before ? ":before" : ":after") : this.computedStyle(null);
            }

            return this.styles[attribute] || (this.styles[attribute] = this.computedStyles[attribute]);
          };

          NodeContainer.prototype.prefixedCss = function (attribute) {
            var prefixes = ["webkit", "moz", "ms", "o"];
            var value = this.css(attribute);

            if (value === undefined) {
              prefixes.some(function (prefix) {
                value = this.css(prefix + attribute.substr(0, 1).toUpperCase() + attribute.substr(1));
                return value !== undefined;
              }, this);
            }

            return value === undefined ? null : value;
          };

          NodeContainer.prototype.computedStyle = function (type) {
            return this.node.ownerDocument.defaultView.getComputedStyle(this.node, type);
          };

          NodeContainer.prototype.cssInt = function (attribute) {
            var value = parseInt(this.css(attribute), 10);
            return isNaN(value) ? 0 : value; // borders in old IE are throwing 'medium' for demo.html
          };

          NodeContainer.prototype.color = function (attribute) {
            return this.colors[attribute] || (this.colors[attribute] = new Color(this.css(attribute)));
          };

          NodeContainer.prototype.cssFloat = function (attribute) {
            var value = parseFloat(this.css(attribute));
            return isNaN(value) ? 0 : value;
          };

          NodeContainer.prototype.fontWeight = function () {
            var weight = this.css("fontWeight");

            switch (parseInt(weight, 10)) {
              case 401:
                weight = "bold";
                break;

              case 400:
                weight = "normal";
                break;
            }

            return weight;
          };

          NodeContainer.prototype.parseClip = function () {
            var matches = this.css('clip').match(this.CLIP);

            if (matches) {
              return {
                top: parseInt(matches[1], 10),
                right: parseInt(matches[2], 10),
                bottom: parseInt(matches[3], 10),
                left: parseInt(matches[4], 10)
              };
            }

            return null;
          };

          NodeContainer.prototype.parseBackgroundImages = function () {
            return this.backgroundImages || (this.backgroundImages = parseBackgrounds(this.css("backgroundImage")));
          };

          NodeContainer.prototype.cssList = function (property, index) {
            var value = (this.css(property) || '').split(',');
            value = value[index || 0] || value[0] || 'auto';
            value = value.trim().split(' ');

            if (value.length === 1) {
              value = [value[0], isPercentage(value[0]) ? 'auto' : value[0]];
            }

            return value;
          };

          NodeContainer.prototype.parseBackgroundSize = function (bounds, image, index) {
            var size = this.cssList("backgroundSize", index);
            var width, height;

            if (isPercentage(size[0])) {
              width = bounds.width * parseFloat(size[0]) / 100;
            } else if (/contain|cover/.test(size[0])) {
              var targetRatio = bounds.width / bounds.height,
                  currentRatio = image.width / image.height;
              return targetRatio < currentRatio ^ size[0] === 'contain' ? {
                width: bounds.height * currentRatio,
                height: bounds.height
              } : {
                width: bounds.width,
                height: bounds.width / currentRatio
              };
            } else {
              width = parseInt(size[0], 10);
            }

            if (size[0] === 'auto' && size[1] === 'auto') {
              height = image.height;
            } else if (size[1] === 'auto') {
              height = width / image.width * image.height;
            } else if (isPercentage(size[1])) {
              height = bounds.height * parseFloat(size[1]) / 100;
            } else {
              height = parseInt(size[1], 10);
            }

            if (size[0] === 'auto') {
              width = height / image.height * image.width;
            }

            return {
              width: width,
              height: height
            };
          };

          NodeContainer.prototype.parseBackgroundPosition = function (bounds, image, index, backgroundSize) {
            var position = this.cssList('backgroundPosition', index);
            var left, top;

            if (isPercentage(position[0])) {
              left = (bounds.width - (backgroundSize || image).width) * (parseFloat(position[0]) / 100);
            } else {
              left = parseInt(position[0], 10);
            }

            if (position[1] === 'auto') {
              top = left / image.width * image.height;
            } else if (isPercentage(position[1])) {
              top = (bounds.height - (backgroundSize || image).height) * parseFloat(position[1]) / 100;
            } else {
              top = parseInt(position[1], 10);
            }

            if (position[0] === 'auto') {
              left = top / image.height * image.width;
            }

            return {
              left: left,
              top: top
            };
          };

          NodeContainer.prototype.parseBackgroundRepeat = function (index) {
            return this.cssList("backgroundRepeat", index)[0];
          };

          NodeContainer.prototype.parseTextShadows = function () {
            var textShadow = this.css("textShadow");
            var results = [];

            if (textShadow && textShadow !== 'none') {
              var shadows = textShadow.match(this.TEXT_SHADOW_PROPERTY);

              for (var i = 0; shadows && i < shadows.length; i++) {
                var s = shadows[i].match(this.TEXT_SHADOW_VALUES);
                results.push({
                  color: new Color(s[0]),
                  offsetX: s[1] ? parseFloat(s[1].replace('px', '')) : 0,
                  offsetY: s[2] ? parseFloat(s[2].replace('px', '')) : 0,
                  blur: s[3] ? s[3].replace('px', '') : 0
                });
              }
            }

            return results;
          };

          NodeContainer.prototype.parseTransform = function () {
            if (!this.transformData) {
              if (this.hasTransform()) {
                var offset = this.parseBounds();
                var origin = this.prefixedCss("transformOrigin").split(" ").map(removePx).map(asFloat);
                origin[0] += offset.left;
                origin[1] += offset.top;
                this.transformData = {
                  origin: origin,
                  matrix: this.parseTransformMatrix()
                };
              } else {
                this.transformData = {
                  origin: [0, 0],
                  matrix: [1, 0, 0, 1, 0, 0]
                };
              }
            }

            return this.transformData;
          };

          NodeContainer.prototype.parseTransformMatrix = function () {
            if (!this.transformMatrix) {
              var transform = this.prefixedCss("transform");
              var matrix = transform ? parseMatrix(transform.match(this.MATRIX_PROPERTY)) : null;
              this.transformMatrix = matrix ? matrix : [1, 0, 0, 1, 0, 0];
            }

            return this.transformMatrix;
          };

          NodeContainer.prototype.parseBounds = function () {
            return this.bounds || (this.bounds = this.hasTransform() ? offsetBounds(this.node) : getBounds(this.node));
          };

          NodeContainer.prototype.hasTransform = function () {
            return this.parseTransformMatrix().join(",") !== "1,0,0,1,0,0" || this.parent && this.parent.hasTransform();
          };

          NodeContainer.prototype.getValue = function () {
            var value = this.node.value || "";

            if (this.node.tagName === "SELECT") {
              value = selectionValue(this.node);
            } else if (this.node.type === "password") {
              value = Array(value.length + 1).join("\u2022"); // jshint ignore:line
            }

            return value.length === 0 ? this.node.placeholder || "" : value;
          };

          NodeContainer.prototype.MATRIX_PROPERTY = /(matrix|matrix3d)\((.+)\)/;
          NodeContainer.prototype.TEXT_SHADOW_PROPERTY = /((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g;
          NodeContainer.prototype.TEXT_SHADOW_VALUES = /(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;
          NodeContainer.prototype.CLIP = /^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/;

          function selectionValue(node) {
            var option = node.options[node.selectedIndex || 0];
            return option ? option.text || "" : "";
          }

          function parseMatrix(match) {
            if (match && match[1] === "matrix") {
              return match[2].split(",").map(function (s) {
                return parseFloat(s.trim());
              });
            } else if (match && match[1] === "matrix3d") {
              var matrix3d = match[2].split(",").map(function (s) {
                return parseFloat(s.trim());
              });
              return [matrix3d[0], matrix3d[1], matrix3d[4], matrix3d[5], matrix3d[12], matrix3d[13]];
            }
          }

          function isPercentage(value) {
            return value.toString().indexOf("%") !== -1;
          }

          function removePx(str) {
            return str.replace("px", "");
          }

          function asFloat(str) {
            return parseFloat(str);
          }

          module.exports = NodeContainer;
        }, {
          "./color": 3,
          "./utils": 26
        }],
        15: [function (_dereq_, module, exports) {
          var log = _dereq_('./log');

          var punycode = _dereq_('punycode');

          var NodeContainer = _dereq_('./nodecontainer');

          var TextContainer = _dereq_('./textcontainer');

          var PseudoElementContainer = _dereq_('./pseudoelementcontainer');

          var FontMetrics = _dereq_('./fontmetrics');

          var Color = _dereq_('./color');

          var StackingContext = _dereq_('./stackingcontext');

          var utils = _dereq_('./utils');

          var bind = utils.bind;
          var getBounds = utils.getBounds;
          var parseBackgrounds = utils.parseBackgrounds;
          var offsetBounds = utils.offsetBounds;

          function NodeParser(element, renderer, support, imageLoader, options) {
            log("Starting NodeParser");
            this.renderer = renderer;
            this.options = options;
            this.range = null;
            this.support = support;
            this.renderQueue = [];
            this.stack = new StackingContext(true, 1, element.ownerDocument, null);
            var parent = new NodeContainer(element, null);

            if (options.background) {
              renderer.rectangle(0, 0, renderer.width, renderer.height, new Color(options.background));
            }

            if (element === element.ownerDocument.documentElement) {
              // http://www.w3.org/TR/css3-background/#special-backgrounds
              var canvasBackground = new NodeContainer(parent.color('backgroundColor').isTransparent() ? element.ownerDocument.body : element.ownerDocument.documentElement, null);
              renderer.rectangle(0, 0, renderer.width, renderer.height, canvasBackground.color('backgroundColor'));
            }

            parent.visibile = parent.isElementVisible();
            this.createPseudoHideStyles(element.ownerDocument);
            this.disableAnimations(element.ownerDocument);
            this.nodes = flatten([parent].concat(this.getChildren(parent)).filter(function (container) {
              return container.visible = container.isElementVisible();
            }).map(this.getPseudoElements, this));
            this.fontMetrics = new FontMetrics();
            log("Fetched nodes, total:", this.nodes.length);
            log("Calculate overflow clips");
            this.calculateOverflowClips();
            log("Start fetching images");
            this.images = imageLoader.fetch(this.nodes.filter(isElement));
            this.ready = this.images.ready.then(bind(function () {
              log("Images loaded, starting parsing");
              log("Creating stacking contexts");
              this.createStackingContexts();
              log("Sorting stacking contexts");
              this.sortStackingContexts(this.stack);
              this.parse(this.stack);
              log("Render queue created with " + this.renderQueue.length + " items");
              return new Promise(bind(function (resolve) {
                if (!options.async) {
                  this.renderQueue.forEach(this.paint, this);
                  resolve();
                } else if (typeof options.async === "function") {
                  options.async.call(this, this.renderQueue, resolve);
                } else if (this.renderQueue.length > 0) {
                  this.renderIndex = 0;
                  this.asyncRenderer(this.renderQueue, resolve);
                } else {
                  resolve();
                }
              }, this));
            }, this));
          }

          NodeParser.prototype.calculateOverflowClips = function () {
            this.nodes.forEach(function (container) {
              if (isElement(container)) {
                if (isPseudoElement(container)) {
                  container.appendToDOM();
                }

                container.borders = this.parseBorders(container);
                var clip = container.css('overflow') === "hidden" ? [container.borders.clip] : [];
                var cssClip = container.parseClip();

                if (cssClip && ["absolute", "fixed"].indexOf(container.css('position')) !== -1) {
                  clip.push([["rect", container.bounds.left + cssClip.left, container.bounds.top + cssClip.top, cssClip.right - cssClip.left, cssClip.bottom - cssClip.top]]);
                }

                container.clip = hasParentClip(container) ? container.parent.clip.concat(clip) : clip;
                container.backgroundClip = container.css('overflow') !== "hidden" ? container.clip.concat([container.borders.clip]) : container.clip;

                if (isPseudoElement(container)) {
                  container.cleanDOM();
                }
              } else if (isTextNode(container)) {
                container.clip = hasParentClip(container) ? container.parent.clip : [];
              }

              if (!isPseudoElement(container)) {
                container.bounds = null;
              }
            }, this);
          };

          function hasParentClip(container) {
            return container.parent && container.parent.clip.length;
          }

          NodeParser.prototype.asyncRenderer = function (queue, resolve, asyncTimer) {
            asyncTimer = asyncTimer || Date.now();
            this.paint(queue[this.renderIndex++]);

            if (queue.length === this.renderIndex) {
              resolve();
            } else if (asyncTimer + 20 > Date.now()) {
              this.asyncRenderer(queue, resolve, asyncTimer);
            } else {
              setTimeout(bind(function () {
                this.asyncRenderer(queue, resolve);
              }, this), 0);
            }
          };

          NodeParser.prototype.createPseudoHideStyles = function (document) {
            this.createStyles(document, '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ':before { content: "" !important; display: none !important; }' + '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER + ':after { content: "" !important; display: none !important; }');
          };

          NodeParser.prototype.disableAnimations = function (document) {
            this.createStyles(document, '* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; ' + '-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}');
          };

          NodeParser.prototype.createStyles = function (document, styles) {
            var hidePseudoElements = document.createElement('style');
            hidePseudoElements.innerHTML = styles;
            document.body.appendChild(hidePseudoElements);
          };

          NodeParser.prototype.getPseudoElements = function (container) {
            var nodes = [[container]];

            if (container.node.nodeType === Node.ELEMENT_NODE) {
              var before = this.getPseudoElement(container, ":before");
              var after = this.getPseudoElement(container, ":after");

              if (before) {
                nodes.push(before);
              }

              if (after) {
                nodes.push(after);
              }
            }

            return flatten(nodes);
          };

          function toCamelCase(str) {
            return str.replace(/(\-[a-z])/g, function (match) {
              return match.toUpperCase().replace('-', '');
            });
          }

          NodeParser.prototype.getPseudoElement = function (container, type) {
            var style = container.computedStyle(type);

            if (!style || !style.content || style.content === "none" || style.content === "-moz-alt-content" || style.display === "none") {
              return null;
            }

            var content = stripQuotes(style.content);
            var isImage = content.substr(0, 3) === 'url';
            var pseudoNode = document.createElement(isImage ? 'img' : 'html2canvaspseudoelement');
            var pseudoContainer = new PseudoElementContainer(pseudoNode, container, type);

            for (var i = style.length - 1; i >= 0; i--) {
              var property = toCamelCase(style.item(i));
              pseudoNode.style[property] = style[property];
            }

            pseudoNode.className = PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + " " + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;

            if (isImage) {
              pseudoNode.src = parseBackgrounds(content)[0].args[0];
              return [pseudoContainer];
            } else {
              var text = document.createTextNode(content);
              pseudoNode.appendChild(text);
              return [pseudoContainer, new TextContainer(text, pseudoContainer)];
            }
          };

          NodeParser.prototype.getChildren = function (parentContainer) {
            return flatten([].filter.call(parentContainer.node.childNodes, renderableNode).map(function (node) {
              var container = [node.nodeType === Node.TEXT_NODE ? new TextContainer(node, parentContainer) : new NodeContainer(node, parentContainer)].filter(nonIgnoredElement);
              return node.nodeType === Node.ELEMENT_NODE && container.length && node.tagName !== "TEXTAREA" ? container[0].isElementVisible() ? container.concat(this.getChildren(container[0])) : [] : container;
            }, this));
          };

          NodeParser.prototype.newStackingContext = function (container, hasOwnStacking) {
            var stack = new StackingContext(hasOwnStacking, container.getOpacity(), container.node, container.parent);
            container.cloneTo(stack);
            var parentStack = hasOwnStacking ? stack.getParentStack(this) : stack.parent.stack;
            parentStack.contexts.push(stack);
            container.stack = stack;
          };

          NodeParser.prototype.createStackingContexts = function () {
            this.nodes.forEach(function (container) {
              if (isElement(container) && (this.isRootElement(container) || hasOpacity(container) || isPositionedForStacking(container) || this.isBodyWithTransparentRoot(container) || container.hasTransform())) {
                this.newStackingContext(container, true);
              } else if (isElement(container) && (isPositioned(container) && zIndex0(container) || isInlineBlock(container) || isFloating(container))) {
                this.newStackingContext(container, false);
              } else {
                container.assignStack(container.parent.stack);
              }
            }, this);
          };

          NodeParser.prototype.isBodyWithTransparentRoot = function (container) {
            return container.node.nodeName === "BODY" && container.parent.color('backgroundColor').isTransparent();
          };

          NodeParser.prototype.isRootElement = function (container) {
            return container.parent === null;
          };

          NodeParser.prototype.sortStackingContexts = function (stack) {
            stack.contexts.sort(zIndexSort(stack.contexts.slice(0)));
            stack.contexts.forEach(this.sortStackingContexts, this);
          };

          NodeParser.prototype.parseTextBounds = function (container) {
            return function (text, index, textList) {
              if (container.parent.css("textDecoration").substr(0, 4) !== "none" || text.trim().length !== 0) {
                if (this.support.rangeBounds && !container.parent.hasTransform()) {
                  var offset = textList.slice(0, index).join("").length;
                  return this.getRangeBounds(container.node, offset, text.length);
                } else if (container.node && typeof container.node.data === "string") {
                  var replacementNode = container.node.splitText(text.length);
                  var bounds = this.getWrapperBounds(container.node, container.parent.hasTransform());
                  container.node = replacementNode;
                  return bounds;
                }
              } else if (!this.support.rangeBounds || container.parent.hasTransform()) {
                container.node = container.node.splitText(text.length);
              }

              return {};
            };
          };

          NodeParser.prototype.getWrapperBounds = function (node, transform) {
            var wrapper = node.ownerDocument.createElement('html2canvaswrapper');
            var parent = node.parentNode,
                backupText = node.cloneNode(true);
            wrapper.appendChild(node.cloneNode(true));
            parent.replaceChild(wrapper, node);
            var bounds = transform ? offsetBounds(wrapper) : getBounds(wrapper);
            parent.replaceChild(backupText, wrapper);
            return bounds;
          };

          NodeParser.prototype.getRangeBounds = function (node, offset, length) {
            var range = this.range || (this.range = node.ownerDocument.createRange());
            range.setStart(node, offset);
            range.setEnd(node, offset + length);
            return range.getBoundingClientRect();
          };

          function ClearTransform() {}

          NodeParser.prototype.parse = function (stack) {
            // http://www.w3.org/TR/CSS21/visuren.html#z-index
            var negativeZindex = stack.contexts.filter(negativeZIndex); // 2. the child stacking contexts with negative stack levels (most negative first).

            var descendantElements = stack.children.filter(isElement);
            var descendantNonFloats = descendantElements.filter(not(isFloating));
            var nonInlineNonPositionedDescendants = descendantNonFloats.filter(not(isPositioned)).filter(not(inlineLevel)); // 3 the in-flow, non-inline-level, non-positioned descendants.

            var nonPositionedFloats = descendantElements.filter(not(isPositioned)).filter(isFloating); // 4. the non-positioned floats.

            var inFlow = descendantNonFloats.filter(not(isPositioned)).filter(inlineLevel); // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.

            var stackLevel0 = stack.contexts.concat(descendantNonFloats.filter(isPositioned)).filter(zIndex0); // 6. the child stacking contexts with stack level 0 and the positioned descendants with stack level 0.

            var text = stack.children.filter(isTextNode).filter(hasText);
            var positiveZindex = stack.contexts.filter(positiveZIndex); // 7. the child stacking contexts with positive stack levels (least positive first).

            negativeZindex.concat(nonInlineNonPositionedDescendants).concat(nonPositionedFloats).concat(inFlow).concat(stackLevel0).concat(text).concat(positiveZindex).forEach(function (container) {
              this.renderQueue.push(container);

              if (isStackingContext(container)) {
                this.parse(container);
                this.renderQueue.push(new ClearTransform());
              }
            }, this);
          };

          NodeParser.prototype.paint = function (container) {
            try {
              if (container instanceof ClearTransform) {
                this.renderer.ctx.restore();
              } else if (isTextNode(container)) {
                if (isPseudoElement(container.parent)) {
                  container.parent.appendToDOM();
                }

                this.paintText(container);

                if (isPseudoElement(container.parent)) {
                  container.parent.cleanDOM();
                }
              } else {
                this.paintNode(container);
              }
            } catch (e) {
              log(e);

              if (this.options.strict) {
                throw e;
              }
            }
          };

          NodeParser.prototype.paintNode = function (container) {
            if (isStackingContext(container)) {
              this.renderer.setOpacity(container.opacity);
              this.renderer.ctx.save();

              if (container.hasTransform()) {
                this.renderer.setTransform(container.parseTransform());
              }
            }

            if (container.node.nodeName === "INPUT" && container.node.type === "checkbox") {
              this.paintCheckbox(container);
            } else if (container.node.nodeName === "INPUT" && container.node.type === "radio") {
              this.paintRadio(container);
            } else {
              this.paintElement(container);
            }
          };

          NodeParser.prototype.paintElement = function (container) {
            var bounds = container.parseBounds();
            this.renderer.clip(container.backgroundClip, function () {
              this.renderer.renderBackground(container, bounds, container.borders.borders.map(getWidth));
            }, this);
            this.renderer.clip(container.clip, function () {
              this.renderer.renderBorders(container.borders.borders);
            }, this);
            this.renderer.clip(container.backgroundClip, function () {
              switch (container.node.nodeName) {
                case "svg":
                case "IFRAME":
                  var imgContainer = this.images.get(container.node);

                  if (imgContainer) {
                    this.renderer.renderImage(container, bounds, container.borders, imgContainer);
                  } else {
                    log("Error loading <" + container.node.nodeName + ">", container.node);
                  }

                  break;

                case "IMG":
                  var imageContainer = this.images.get(container.node.src);

                  if (imageContainer) {
                    this.renderer.renderImage(container, bounds, container.borders, imageContainer);
                  } else {
                    log("Error loading <img>", container.node.src);
                  }

                  break;

                case "CANVAS":
                  this.renderer.renderImage(container, bounds, container.borders, {
                    image: container.node
                  });
                  break;

                case "SELECT":
                case "INPUT":
                case "TEXTAREA":
                  this.paintFormValue(container);
                  break;
              }
            }, this);
          };

          NodeParser.prototype.paintCheckbox = function (container) {
            var b = container.parseBounds();
            var size = Math.min(b.width, b.height);
            var bounds = {
              width: size - 1,
              height: size - 1,
              top: b.top,
              left: b.left
            };
            var r = [3, 3];
            var radius = [r, r, r, r];
            var borders = [1, 1, 1, 1].map(function (w) {
              return {
                color: new Color('#A5A5A5'),
                width: w
              };
            });
            var borderPoints = calculateCurvePoints(bounds, radius, borders);
            this.renderer.clip(container.backgroundClip, function () {
              this.renderer.rectangle(bounds.left + 1, bounds.top + 1, bounds.width - 2, bounds.height - 2, new Color("#DEDEDE"));
              this.renderer.renderBorders(calculateBorders(borders, bounds, borderPoints, radius));

              if (container.node.checked) {
                this.renderer.font(new Color('#424242'), 'normal', 'normal', 'bold', size - 3 + "px", 'arial');
                this.renderer.text("\u2714", bounds.left + size / 6, bounds.top + size - 1);
              }
            }, this);
          };

          NodeParser.prototype.paintRadio = function (container) {
            var bounds = container.parseBounds();
            var size = Math.min(bounds.width, bounds.height) - 2;
            this.renderer.clip(container.backgroundClip, function () {
              this.renderer.circleStroke(bounds.left + 1, bounds.top + 1, size, new Color('#DEDEDE'), 1, new Color('#A5A5A5'));

              if (container.node.checked) {
                this.renderer.circle(Math.ceil(bounds.left + size / 4) + 1, Math.ceil(bounds.top + size / 4) + 1, Math.floor(size / 2), new Color('#424242'));
              }
            }, this);
          };

          NodeParser.prototype.paintFormValue = function (container) {
            var value = container.getValue();

            if (value.length > 0) {
              var document = container.node.ownerDocument;
              var wrapper = document.createElement('html2canvaswrapper');
              var properties = ['lineHeight', 'textAlign', 'fontFamily', 'fontWeight', 'fontSize', 'color', 'paddingLeft', 'paddingTop', 'paddingRight', 'paddingBottom', 'width', 'height', 'borderLeftStyle', 'borderTopStyle', 'borderLeftWidth', 'borderTopWidth', 'boxSizing', 'whiteSpace', 'wordWrap'];
              properties.forEach(function (property) {
                try {
                  wrapper.style[property] = container.css(property);
                } catch (e) {
                  // Older IE has issues with "border"
                  log("html2canvas: Parse: Exception caught in renderFormValue: " + e.message);
                }
              });
              var bounds = container.parseBounds();
              wrapper.style.position = "fixed";
              wrapper.style.left = bounds.left + "px";
              wrapper.style.top = bounds.top + "px";
              wrapper.textContent = value;
              document.body.appendChild(wrapper);
              this.paintText(new TextContainer(wrapper.firstChild, container));
              document.body.removeChild(wrapper);
            }
          };

          NodeParser.prototype.paintText = function (container) {
            container.applyTextTransform();
            var characters = punycode.ucs2.decode(container.node.data);
            var textList = (!this.options.letterRendering || noLetterSpacing(container)) && !hasUnicode(container.node.data) ? getWords(characters) : characters.map(function (character) {
              return punycode.ucs2.encode([character]);
            });
            var weight = container.parent.fontWeight();
            var size = container.parent.css('fontSize');
            var family = container.parent.css('fontFamily');
            var shadows = container.parent.parseTextShadows();
            this.renderer.font(container.parent.color('color'), container.parent.css('fontStyle'), container.parent.css('fontVariant'), weight, size, family);

            if (shadows.length) {
              // TODO: support multiple text shadows
              this.renderer.fontShadow(shadows[0].color, shadows[0].offsetX, shadows[0].offsetY, shadows[0].blur);
            } else {
              this.renderer.clearShadow();
            }

            this.renderer.clip(container.parent.clip, function () {
              textList.map(this.parseTextBounds(container), this).forEach(function (bounds, index) {
                if (bounds) {
                  this.renderer.text(textList[index], bounds.left, bounds.bottom);
                  this.renderTextDecoration(container.parent, bounds, this.fontMetrics.getMetrics(family, size));
                }
              }, this);
            }, this);
          };

          NodeParser.prototype.renderTextDecoration = function (container, bounds, metrics) {
            switch (container.css("textDecoration").split(" ")[0]) {
              case "underline":
                // Draws a line at the baseline of the font
                // TODO As some browsers display the line as more than 1px if the font-size is big, need to take that into account both in position and size
                this.renderer.rectangle(bounds.left, Math.round(bounds.top + metrics.baseline + metrics.lineWidth), bounds.width, 1, container.color("color"));
                break;

              case "overline":
                this.renderer.rectangle(bounds.left, Math.round(bounds.top), bounds.width, 1, container.color("color"));
                break;

              case "line-through":
                // TODO try and find exact position for line-through
                this.renderer.rectangle(bounds.left, Math.ceil(bounds.top + metrics.middle + metrics.lineWidth), bounds.width, 1, container.color("color"));
                break;
            }
          };

          var borderColorTransforms = {
            inset: [["darken", 0.60], ["darken", 0.10], ["darken", 0.10], ["darken", 0.60]]
          };

          NodeParser.prototype.parseBorders = function (container) {
            var nodeBounds = container.parseBounds();
            var radius = getBorderRadiusData(container);
            var borders = ["Top", "Right", "Bottom", "Left"].map(function (side, index) {
              var style = container.css('border' + side + 'Style');
              var color = container.color('border' + side + 'Color');

              if (style === "inset" && color.isBlack()) {
                color = new Color([255, 255, 255, color.a]); // this is wrong, but
              }

              var colorTransform = borderColorTransforms[style] ? borderColorTransforms[style][index] : null;
              return {
                width: container.cssInt('border' + side + 'Width'),
                color: colorTransform ? color[colorTransform[0]](colorTransform[1]) : color,
                args: null
              };
            });
            var borderPoints = calculateCurvePoints(nodeBounds, radius, borders);
            return {
              clip: this.parseBackgroundClip(container, borderPoints, borders, radius, nodeBounds),
              borders: calculateBorders(borders, nodeBounds, borderPoints, radius)
            };
          };

          function calculateBorders(borders, nodeBounds, borderPoints, radius) {
            return borders.map(function (border, borderSide) {
              if (border.width > 0) {
                var bx = nodeBounds.left;
                var by = nodeBounds.top;
                var bw = nodeBounds.width;
                var bh = nodeBounds.height - borders[2].width;

                switch (borderSide) {
                  case 0:
                    // top border
                    bh = borders[0].width;
                    border.args = drawSide({
                      c1: [bx, by],
                      c2: [bx + bw, by],
                      c3: [bx + bw - borders[1].width, by + bh],
                      c4: [bx + borders[3].width, by + bh]
                    }, radius[0], radius[1], borderPoints.topLeftOuter, borderPoints.topLeftInner, borderPoints.topRightOuter, borderPoints.topRightInner);
                    break;

                  case 1:
                    // right border
                    bx = nodeBounds.left + nodeBounds.width - borders[1].width;
                    bw = borders[1].width;
                    border.args = drawSide({
                      c1: [bx + bw, by],
                      c2: [bx + bw, by + bh + borders[2].width],
                      c3: [bx, by + bh],
                      c4: [bx, by + borders[0].width]
                    }, radius[1], radius[2], borderPoints.topRightOuter, borderPoints.topRightInner, borderPoints.bottomRightOuter, borderPoints.bottomRightInner);
                    break;

                  case 2:
                    // bottom border
                    by = by + nodeBounds.height - borders[2].width;
                    bh = borders[2].width;
                    border.args = drawSide({
                      c1: [bx + bw, by + bh],
                      c2: [bx, by + bh],
                      c3: [bx + borders[3].width, by],
                      c4: [bx + bw - borders[3].width, by]
                    }, radius[2], radius[3], borderPoints.bottomRightOuter, borderPoints.bottomRightInner, borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner);
                    break;

                  case 3:
                    // left border
                    bw = borders[3].width;
                    border.args = drawSide({
                      c1: [bx, by + bh + borders[2].width],
                      c2: [bx, by],
                      c3: [bx + bw, by + borders[0].width],
                      c4: [bx + bw, by + bh]
                    }, radius[3], radius[0], borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner, borderPoints.topLeftOuter, borderPoints.topLeftInner);
                    break;
                }
              }

              return border;
            });
          }

          NodeParser.prototype.parseBackgroundClip = function (container, borderPoints, borders, radius, bounds) {
            var backgroundClip = container.css('backgroundClip'),
                borderArgs = [];

            switch (backgroundClip) {
              case "content-box":
              case "padding-box":
                parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftInner, borderPoints.topRightInner, bounds.left + borders[3].width, bounds.top + borders[0].width);
                parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightInner, borderPoints.bottomRightInner, bounds.left + bounds.width - borders[1].width, bounds.top + borders[0].width);
                parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightInner, borderPoints.bottomLeftInner, bounds.left + bounds.width - borders[1].width, bounds.top + bounds.height - borders[2].width);
                parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftInner, borderPoints.topLeftInner, bounds.left + borders[3].width, bounds.top + bounds.height - borders[2].width);
                break;

              default:
                parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftOuter, borderPoints.topRightOuter, bounds.left, bounds.top);
                parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightOuter, borderPoints.bottomRightOuter, bounds.left + bounds.width, bounds.top);
                parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightOuter, borderPoints.bottomLeftOuter, bounds.left + bounds.width, bounds.top + bounds.height);
                parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftOuter, borderPoints.topLeftOuter, bounds.left, bounds.top + bounds.height);
                break;
            }

            return borderArgs;
          };

          function getCurvePoints(x, y, r1, r2) {
            var kappa = 4 * ((Math.sqrt(2) - 1) / 3);
            var ox = r1 * kappa,
                // control point offset horizontal
            oy = r2 * kappa,
                // control point offset vertical
            xm = x + r1,
                // x-middle
            ym = y + r2; // y-middle

            return {
              topLeft: bezierCurve({
                x: x,
                y: ym
              }, {
                x: x,
                y: ym - oy
              }, {
                x: xm - ox,
                y: y
              }, {
                x: xm,
                y: y
              }),
              topRight: bezierCurve({
                x: x,
                y: y
              }, {
                x: x + ox,
                y: y
              }, {
                x: xm,
                y: ym - oy
              }, {
                x: xm,
                y: ym
              }),
              bottomRight: bezierCurve({
                x: xm,
                y: y
              }, {
                x: xm,
                y: y + oy
              }, {
                x: x + ox,
                y: ym
              }, {
                x: x,
                y: ym
              }),
              bottomLeft: bezierCurve({
                x: xm,
                y: ym
              }, {
                x: xm - ox,
                y: ym
              }, {
                x: x,
                y: y + oy
              }, {
                x: x,
                y: y
              })
            };
          }

          function calculateCurvePoints(bounds, borderRadius, borders) {
            var x = bounds.left,
                y = bounds.top,
                width = bounds.width,
                height = bounds.height,
                tlh = borderRadius[0][0] < width / 2 ? borderRadius[0][0] : width / 2,
                tlv = borderRadius[0][1] < height / 2 ? borderRadius[0][1] : height / 2,
                trh = borderRadius[1][0] < width / 2 ? borderRadius[1][0] : width / 2,
                trv = borderRadius[1][1] < height / 2 ? borderRadius[1][1] : height / 2,
                brh = borderRadius[2][0] < width / 2 ? borderRadius[2][0] : width / 2,
                brv = borderRadius[2][1] < height / 2 ? borderRadius[2][1] : height / 2,
                blh = borderRadius[3][0] < width / 2 ? borderRadius[3][0] : width / 2,
                blv = borderRadius[3][1] < height / 2 ? borderRadius[3][1] : height / 2;
            var topWidth = width - trh,
                rightHeight = height - brv,
                bottomWidth = width - brh,
                leftHeight = height - blv;
            return {
              topLeftOuter: getCurvePoints(x, y, tlh, tlv).topLeft.subdivide(0.5),
              topLeftInner: getCurvePoints(x + borders[3].width, y + borders[0].width, Math.max(0, tlh - borders[3].width), Math.max(0, tlv - borders[0].width)).topLeft.subdivide(0.5),
              topRightOuter: getCurvePoints(x + topWidth, y, trh, trv).topRight.subdivide(0.5),
              topRightInner: getCurvePoints(x + Math.min(topWidth, width + borders[3].width), y + borders[0].width, topWidth > width + borders[3].width ? 0 : trh - borders[3].width, trv - borders[0].width).topRight.subdivide(0.5),
              bottomRightOuter: getCurvePoints(x + bottomWidth, y + rightHeight, brh, brv).bottomRight.subdivide(0.5),
              bottomRightInner: getCurvePoints(x + Math.min(bottomWidth, width - borders[3].width), y + Math.min(rightHeight, height + borders[0].width), Math.max(0, brh - borders[1].width), brv - borders[2].width).bottomRight.subdivide(0.5),
              bottomLeftOuter: getCurvePoints(x, y + leftHeight, blh, blv).bottomLeft.subdivide(0.5),
              bottomLeftInner: getCurvePoints(x + borders[3].width, y + leftHeight, Math.max(0, blh - borders[3].width), blv - borders[2].width).bottomLeft.subdivide(0.5)
            };
          }

          function bezierCurve(start, startControl, endControl, end) {
            var lerp = function lerp(a, b, t) {
              return {
                x: a.x + (b.x - a.x) * t,
                y: a.y + (b.y - a.y) * t
              };
            };

            return {
              start: start,
              startControl: startControl,
              endControl: endControl,
              end: end,
              subdivide: function subdivide(t) {
                var ab = lerp(start, startControl, t),
                    bc = lerp(startControl, endControl, t),
                    cd = lerp(endControl, end, t),
                    abbc = lerp(ab, bc, t),
                    bccd = lerp(bc, cd, t),
                    dest = lerp(abbc, bccd, t);
                return [bezierCurve(start, ab, abbc, dest), bezierCurve(dest, bccd, cd, end)];
              },
              curveTo: function curveTo(borderArgs) {
                borderArgs.push(["bezierCurve", startControl.x, startControl.y, endControl.x, endControl.y, end.x, end.y]);
              },
              curveToReversed: function curveToReversed(borderArgs) {
                borderArgs.push(["bezierCurve", endControl.x, endControl.y, startControl.x, startControl.y, start.x, start.y]);
              }
            };
          }

          function drawSide(borderData, radius1, radius2, outer1, inner1, outer2, inner2) {
            var borderArgs = [];

            if (radius1[0] > 0 || radius1[1] > 0) {
              borderArgs.push(["line", outer1[1].start.x, outer1[1].start.y]);
              outer1[1].curveTo(borderArgs);
            } else {
              borderArgs.push(["line", borderData.c1[0], borderData.c1[1]]);
            }

            if (radius2[0] > 0 || radius2[1] > 0) {
              borderArgs.push(["line", outer2[0].start.x, outer2[0].start.y]);
              outer2[0].curveTo(borderArgs);
              borderArgs.push(["line", inner2[0].end.x, inner2[0].end.y]);
              inner2[0].curveToReversed(borderArgs);
            } else {
              borderArgs.push(["line", borderData.c2[0], borderData.c2[1]]);
              borderArgs.push(["line", borderData.c3[0], borderData.c3[1]]);
            }

            if (radius1[0] > 0 || radius1[1] > 0) {
              borderArgs.push(["line", inner1[1].end.x, inner1[1].end.y]);
              inner1[1].curveToReversed(borderArgs);
            } else {
              borderArgs.push(["line", borderData.c4[0], borderData.c4[1]]);
            }

            return borderArgs;
          }

          function parseCorner(borderArgs, radius1, radius2, corner1, corner2, x, y) {
            if (radius1[0] > 0 || radius1[1] > 0) {
              borderArgs.push(["line", corner1[0].start.x, corner1[0].start.y]);
              corner1[0].curveTo(borderArgs);
              corner1[1].curveTo(borderArgs);
            } else {
              borderArgs.push(["line", x, y]);
            }

            if (radius2[0] > 0 || radius2[1] > 0) {
              borderArgs.push(["line", corner2[0].start.x, corner2[0].start.y]);
            }
          }

          function negativeZIndex(container) {
            return container.cssInt("zIndex") < 0;
          }

          function positiveZIndex(container) {
            return container.cssInt("zIndex") > 0;
          }

          function zIndex0(container) {
            return container.cssInt("zIndex") === 0;
          }

          function inlineLevel(container) {
            return ["inline", "inline-block", "inline-table"].indexOf(container.css("display")) !== -1;
          }

          function isStackingContext(container) {
            return container instanceof StackingContext;
          }

          function hasText(container) {
            return container.node.data.trim().length > 0;
          }

          function noLetterSpacing(container) {
            return /^(normal|none|0px)$/.test(container.parent.css("letterSpacing"));
          }

          function getBorderRadiusData(container) {
            return ["TopLeft", "TopRight", "BottomRight", "BottomLeft"].map(function (side) {
              var value = container.css('border' + side + 'Radius');
              var arr = value.split(" ");

              if (arr.length <= 1) {
                arr[1] = arr[0];
              }

              return arr.map(asInt);
            });
          }

          function renderableNode(node) {
            return node.nodeType === Node.TEXT_NODE || node.nodeType === Node.ELEMENT_NODE;
          }

          function isPositionedForStacking(container) {
            var position = container.css("position");
            var zIndex = ["absolute", "relative", "fixed"].indexOf(position) !== -1 ? container.css("zIndex") : "auto";
            return zIndex !== "auto";
          }

          function isPositioned(container) {
            return container.css("position") !== "static";
          }

          function isFloating(container) {
            return container.css("float") !== "none";
          }

          function isInlineBlock(container) {
            return ["inline-block", "inline-table"].indexOf(container.css("display")) !== -1;
          }

          function not(callback) {
            var context = this;
            return function () {
              return !callback.apply(context, arguments);
            };
          }

          function isElement(container) {
            return container.node.nodeType === Node.ELEMENT_NODE;
          }

          function isPseudoElement(container) {
            return container.isPseudoElement === true;
          }

          function isTextNode(container) {
            return container.node.nodeType === Node.TEXT_NODE;
          }

          function zIndexSort(contexts) {
            return function (a, b) {
              return a.cssInt("zIndex") + contexts.indexOf(a) / contexts.length - (b.cssInt("zIndex") + contexts.indexOf(b) / contexts.length);
            };
          }

          function hasOpacity(container) {
            return container.getOpacity() < 1;
          }

          function asInt(value) {
            return parseInt(value, 10);
          }

          function getWidth(border) {
            return border.width;
          }

          function nonIgnoredElement(nodeContainer) {
            return nodeContainer.node.nodeType !== Node.ELEMENT_NODE || ["SCRIPT", "HEAD", "TITLE", "OBJECT", "BR", "OPTION"].indexOf(nodeContainer.node.nodeName) === -1;
          }

          function flatten(arrays) {
            return [].concat.apply([], arrays);
          }

          function stripQuotes(content) {
            var first = content.substr(0, 1);
            return first === content.substr(content.length - 1) && first.match(/'|"/) ? content.substr(1, content.length - 2) : content;
          }

          function getWords(characters) {
            var words = [],
                i = 0,
                onWordBoundary = false,
                word;

            while (characters.length) {
              if (isWordBoundary(characters[i]) === onWordBoundary) {
                word = characters.splice(0, i);

                if (word.length) {
                  words.push(punycode.ucs2.encode(word));
                }

                onWordBoundary = !onWordBoundary;
                i = 0;
              } else {
                i++;
              }

              if (i >= characters.length) {
                word = characters.splice(0, i);

                if (word.length) {
                  words.push(punycode.ucs2.encode(word));
                }
              }
            }

            return words;
          }

          function isWordBoundary(characterCode) {
            return [32, // <space>
            13, // \r
            10, // \n
            9, // \t
            45 // -
            ].indexOf(characterCode) !== -1;
          }

          function hasUnicode(string) {
            return /[^\u0000-\u00ff]/.test(string);
          }

          module.exports = NodeParser;
        }, {
          "./color": 3,
          "./fontmetrics": 7,
          "./log": 13,
          "./nodecontainer": 14,
          "./pseudoelementcontainer": 18,
          "./stackingcontext": 21,
          "./textcontainer": 25,
          "./utils": 26,
          "punycode": 1
        }],
        16: [function (_dereq_, module, exports) {
          var XHR = _dereq_('./xhr');

          var utils = _dereq_('./utils');

          var log = _dereq_('./log');

          var createWindowClone = _dereq_('./clone');

          var decode64 = utils.decode64;

          function Proxy(src, proxyUrl, document) {
            var supportsCORS = 'withCredentials' in new XMLHttpRequest();

            if (!proxyUrl) {
              return Promise.reject("No proxy configured");
            }

            var callback = createCallback(supportsCORS);
            var url = createProxyUrl(proxyUrl, src, callback);
            return supportsCORS ? XHR(url) : jsonp(document, url, callback).then(function (response) {
              return decode64(response.content);
            });
          }

          var proxyCount = 0;

          function ProxyURL(src, proxyUrl, document) {
            var supportsCORSImage = 'crossOrigin' in new Image();
            var callback = createCallback(supportsCORSImage);
            var url = createProxyUrl(proxyUrl, src, callback);
            return supportsCORSImage ? Promise.resolve(url) : jsonp(document, url, callback).then(function (response) {
              return "data:" + response.type + ";base64," + response.content;
            });
          }

          function jsonp(document, url, callback) {
            return new Promise(function (resolve, reject) {
              var s = document.createElement("script");

              var cleanup = function cleanup() {
                delete window.html2canvas.proxy[callback];
                document.body.removeChild(s);
              };

              window.html2canvas.proxy[callback] = function (response) {
                cleanup();
                resolve(response);
              };

              s.src = url;

              s.onerror = function (e) {
                cleanup();
                reject(e);
              };

              document.body.appendChild(s);
            });
          }

          function createCallback(useCORS) {
            return !useCORS ? "html2canvas_" + Date.now() + "_" + ++proxyCount + "_" + Math.round(Math.random() * 100000) : "";
          }

          function createProxyUrl(proxyUrl, src, callback) {
            return proxyUrl + "?url=" + encodeURIComponent(src) + (callback.length ? "&callback=html2canvas.proxy." + callback : "");
          }

          function documentFromHTML(src) {
            return function (html) {
              var parser = new DOMParser(),
                  doc;

              try {
                doc = parser.parseFromString(html, "text/html");
              } catch (e) {
                log("DOMParser not supported, falling back to createHTMLDocument");
                doc = document.implementation.createHTMLDocument("");

                try {
                  doc.open();
                  doc.write(html);
                  doc.close();
                } catch (ee) {
                  log("createHTMLDocument write not supported, falling back to document.body.innerHTML");
                  doc.body.innerHTML = html; // ie9 doesnt support writing to documentElement
                }
              }

              var b = doc.querySelector("base");

              if (!b || !b.href.host) {
                var base = doc.createElement("base");
                base.href = src;
                doc.head.insertBefore(base, doc.head.firstChild);
              }

              return doc;
            };
          }

          function loadUrlDocument(src, proxy, document, width, height, options) {
            return new Proxy(src, proxy, window.document).then(documentFromHTML(src)).then(function (doc) {
              return createWindowClone(doc, document, width, height, options, 0, 0);
            });
          }

          exports.Proxy = Proxy;
          exports.ProxyURL = ProxyURL;
          exports.loadUrlDocument = loadUrlDocument;
        }, {
          "./clone": 2,
          "./log": 13,
          "./utils": 26,
          "./xhr": 28
        }],
        17: [function (_dereq_, module, exports) {
          var ProxyURL = _dereq_('./proxy').ProxyURL;

          function ProxyImageContainer(src, proxy) {
            var link = document.createElement("a");
            link.href = src;
            src = link.href;
            this.src = src;
            this.image = new Image();
            var self = this;
            this.promise = new Promise(function (resolve, reject) {
              self.image.crossOrigin = "Anonymous";
              self.image.onload = resolve;
              self.image.onerror = reject;
              new ProxyURL(src, proxy, document).then(function (url) {
                self.image.src = url;
              })['catch'](reject);
            });
          }

          module.exports = ProxyImageContainer;
        }, {
          "./proxy": 16
        }],
        18: [function (_dereq_, module, exports) {
          var NodeContainer = _dereq_('./nodecontainer');

          function PseudoElementContainer(node, parent, type) {
            NodeContainer.call(this, node, parent);
            this.isPseudoElement = true;
            this.before = type === ":before";
          }

          PseudoElementContainer.prototype.cloneTo = function (stack) {
            PseudoElementContainer.prototype.cloneTo.call(this, stack);
            stack.isPseudoElement = true;
            stack.before = this.before;
          };

          PseudoElementContainer.prototype = Object.create(NodeContainer.prototype);

          PseudoElementContainer.prototype.appendToDOM = function () {
            if (this.before) {
              this.parent.node.insertBefore(this.node, this.parent.node.firstChild);
            } else {
              this.parent.node.appendChild(this.node);
            }

            this.parent.node.className += " " + this.getHideClass();
          };

          PseudoElementContainer.prototype.cleanDOM = function () {
            this.node.parentNode.removeChild(this.node);
            this.parent.node.className = this.parent.node.className.replace(this.getHideClass(), "");
          };

          PseudoElementContainer.prototype.getHideClass = function () {
            return this["PSEUDO_HIDE_ELEMENT_CLASS_" + (this.before ? "BEFORE" : "AFTER")];
          };

          PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = "___html2canvas___pseudoelement_before";
          PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER = "___html2canvas___pseudoelement_after";
          module.exports = PseudoElementContainer;
        }, {
          "./nodecontainer": 14
        }],
        19: [function (_dereq_, module, exports) {
          var log = _dereq_('./log');

          function Renderer(width, height, images, options, document) {
            this.width = width;
            this.height = height;
            this.images = images;
            this.options = options;
            this.document = document;
          }

          Renderer.prototype.renderImage = function (container, bounds, borderData, imageContainer) {
            var paddingLeft = container.cssInt('paddingLeft'),
                paddingTop = container.cssInt('paddingTop'),
                paddingRight = container.cssInt('paddingRight'),
                paddingBottom = container.cssInt('paddingBottom'),
                borders = borderData.borders;
            var width = bounds.width - (borders[1].width + borders[3].width + paddingLeft + paddingRight);
            var height = bounds.height - (borders[0].width + borders[2].width + paddingTop + paddingBottom);
            this.drawImage(imageContainer, 0, 0, imageContainer.image.width || width, imageContainer.image.height || height, bounds.left + paddingLeft + borders[3].width, bounds.top + paddingTop + borders[0].width, width, height);
          };

          Renderer.prototype.renderBackground = function (container, bounds, borderData) {
            if (bounds.height > 0 && bounds.width > 0) {
              this.renderBackgroundColor(container, bounds);
              this.renderBackgroundImage(container, bounds, borderData);
            }
          };

          Renderer.prototype.renderBackgroundColor = function (container, bounds) {
            var color = container.color("backgroundColor");

            if (!color.isTransparent()) {
              this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, color);
            }
          };

          Renderer.prototype.renderBorders = function (borders) {
            borders.forEach(this.renderBorder, this);
          };

          Renderer.prototype.renderBorder = function (data) {
            if (!data.color.isTransparent() && data.args !== null) {
              this.drawShape(data.args, data.color);
            }
          };

          Renderer.prototype.renderBackgroundImage = function (container, bounds, borderData) {
            var backgroundImages = container.parseBackgroundImages();
            backgroundImages.reverse().forEach(function (backgroundImage, index, arr) {
              switch (backgroundImage.method) {
                case "url":
                  var image = this.images.get(backgroundImage.args[0]);

                  if (image) {
                    this.renderBackgroundRepeating(container, bounds, image, arr.length - (index + 1), borderData);
                  } else {
                    log("Error loading background-image", backgroundImage.args[0]);
                  }

                  break;

                case "linear-gradient":
                case "gradient":
                  var gradientImage = this.images.get(backgroundImage.value);

                  if (gradientImage) {
                    this.renderBackgroundGradient(gradientImage, bounds, borderData);
                  } else {
                    log("Error loading background-image", backgroundImage.args[0]);
                  }

                  break;

                case "none":
                  break;

                default:
                  log("Unknown background-image type", backgroundImage.args[0]);
              }
            }, this);
          };

          Renderer.prototype.renderBackgroundRepeating = function (container, bounds, imageContainer, index, borderData) {
            var size = container.parseBackgroundSize(bounds, imageContainer.image, index);
            var position = container.parseBackgroundPosition(bounds, imageContainer.image, index, size);
            var repeat = container.parseBackgroundRepeat(index);

            switch (repeat) {
              case "repeat-x":
              case "repeat no-repeat":
                this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + borderData[3], bounds.top + position.top + borderData[0], 99999, size.height, borderData);
                break;

              case "repeat-y":
              case "no-repeat repeat":
                this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + borderData[0], size.width, 99999, borderData);
                break;

              case "no-repeat":
                this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + position.top + borderData[0], size.width, size.height, borderData);
                break;

              default:
                this.renderBackgroundRepeat(imageContainer, position, size, {
                  top: bounds.top,
                  left: bounds.left
                }, borderData[3], borderData[0]);
                break;
            }
          };

          module.exports = Renderer;
        }, {
          "./log": 13
        }],
        20: [function (_dereq_, module, exports) {
          var Renderer = _dereq_('../renderer');

          var LinearGradientContainer = _dereq_('../lineargradientcontainer');

          var log = _dereq_('../log');

          function CanvasRenderer(width, height) {
            Renderer.apply(this, arguments);
            this.canvas = this.options.canvas || this.document.createElement("canvas");

            if (!this.options.canvas) {
              this.canvas.width = width;
              this.canvas.height = height;
            }

            this.ctx = this.canvas.getContext("2d");
            this.taintCtx = this.document.createElement("canvas").getContext("2d");
            this.ctx.textBaseline = "bottom";
            this.variables = {};
            log("Initialized CanvasRenderer with size", width, "x", height);
          }

          CanvasRenderer.prototype = Object.create(Renderer.prototype);

          CanvasRenderer.prototype.setFillStyle = function (fillStyle) {
            this.ctx.fillStyle = _typeof(fillStyle) === "object" && !!fillStyle.isColor ? fillStyle.toString() : fillStyle;
            return this.ctx;
          };

          CanvasRenderer.prototype.rectangle = function (left, top, width, height, color) {
            this.setFillStyle(color).fillRect(left, top, width, height);
          };

          CanvasRenderer.prototype.circle = function (left, top, size, color) {
            this.setFillStyle(color);
            this.ctx.beginPath();
            this.ctx.arc(left + size / 2, top + size / 2, size / 2, 0, Math.PI * 2, true);
            this.ctx.closePath();
            this.ctx.fill();
          };

          CanvasRenderer.prototype.circleStroke = function (left, top, size, color, stroke, strokeColor) {
            this.circle(left, top, size, color);
            this.ctx.strokeStyle = strokeColor.toString();
            this.ctx.stroke();
          };

          CanvasRenderer.prototype.drawShape = function (shape, color) {
            this.shape(shape);
            this.setFillStyle(color).fill();
          };

          CanvasRenderer.prototype.taints = function (imageContainer) {
            if (imageContainer.tainted === null) {
              this.taintCtx.drawImage(imageContainer.image, 0, 0);

              try {
                this.taintCtx.getImageData(0, 0, 1, 1);
                imageContainer.tainted = false;
              } catch (e) {
                this.taintCtx = document.createElement("canvas").getContext("2d");
                imageContainer.tainted = true;
              }
            }

            return imageContainer.tainted;
          };

          CanvasRenderer.prototype.drawImage = function (imageContainer, sx, sy, sw, sh, dx, dy, dw, dh) {
            if (!this.taints(imageContainer) || this.options.allowTaint) {
              this.ctx.drawImage(imageContainer.image, sx, sy, sw, sh, dx, dy, dw, dh);
            }
          };

          CanvasRenderer.prototype.clip = function (shapes, callback, context) {
            this.ctx.save();
            shapes.filter(hasEntries).forEach(function (shape) {
              this.shape(shape).clip();
            }, this);
            callback.call(context);
            this.ctx.restore();
          };

          CanvasRenderer.prototype.shape = function (shape) {
            this.ctx.beginPath();
            shape.forEach(function (point, index) {
              if (point[0] === "rect") {
                this.ctx.rect.apply(this.ctx, point.slice(1));
              } else {
                this.ctx[index === 0 ? "moveTo" : point[0] + "To"].apply(this.ctx, point.slice(1));
              }
            }, this);
            this.ctx.closePath();
            return this.ctx;
          };

          CanvasRenderer.prototype.font = function (color, style, variant, weight, size, family) {
            this.setFillStyle(color).font = [style, variant, weight, size, family].join(" ").split(",")[0];
          };

          CanvasRenderer.prototype.fontShadow = function (color, offsetX, offsetY, blur) {
            this.setVariable("shadowColor", color.toString()).setVariable("shadowOffsetY", offsetX).setVariable("shadowOffsetX", offsetY).setVariable("shadowBlur", blur);
          };

          CanvasRenderer.prototype.clearShadow = function () {
            this.setVariable("shadowColor", "rgba(0,0,0,0)");
          };

          CanvasRenderer.prototype.setOpacity = function (opacity) {
            this.ctx.globalAlpha = opacity;
          };

          CanvasRenderer.prototype.setTransform = function (transform) {
            this.ctx.translate(transform.origin[0], transform.origin[1]);
            this.ctx.transform.apply(this.ctx, transform.matrix);
            this.ctx.translate(-transform.origin[0], -transform.origin[1]);
          };

          CanvasRenderer.prototype.setVariable = function (property, value) {
            if (this.variables[property] !== value) {
              this.variables[property] = this.ctx[property] = value;
            }

            return this;
          };

          CanvasRenderer.prototype.text = function (text, left, bottom) {
            this.ctx.fillText(text, left, bottom);
          };

          CanvasRenderer.prototype.backgroundRepeatShape = function (imageContainer, backgroundPosition, size, bounds, left, top, width, height, borderData) {
            var shape = [["line", Math.round(left), Math.round(top)], ["line", Math.round(left + width), Math.round(top)], ["line", Math.round(left + width), Math.round(height + top)], ["line", Math.round(left), Math.round(height + top)]];
            this.clip([shape], function () {
              this.renderBackgroundRepeat(imageContainer, backgroundPosition, size, bounds, borderData[3], borderData[0]);
            }, this);
          };

          CanvasRenderer.prototype.renderBackgroundRepeat = function (imageContainer, backgroundPosition, size, bounds, borderLeft, borderTop) {
            var offsetX = Math.round(bounds.left + backgroundPosition.left + borderLeft),
                offsetY = Math.round(bounds.top + backgroundPosition.top + borderTop);
            this.setFillStyle(this.ctx.createPattern(this.resizeImage(imageContainer, size), "repeat"));
            this.ctx.translate(offsetX, offsetY);
            this.ctx.fill();
            this.ctx.translate(-offsetX, -offsetY);
          };

          CanvasRenderer.prototype.renderBackgroundGradient = function (gradientImage, bounds) {
            if (gradientImage instanceof LinearGradientContainer) {
              var gradient = this.ctx.createLinearGradient(bounds.left + bounds.width * gradientImage.x0, bounds.top + bounds.height * gradientImage.y0, bounds.left + bounds.width * gradientImage.x1, bounds.top + bounds.height * gradientImage.y1);
              gradientImage.colorStops.forEach(function (colorStop) {
                gradient.addColorStop(colorStop.stop, colorStop.color.toString());
              });
              this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, gradient);
            }
          };

          CanvasRenderer.prototype.resizeImage = function (imageContainer, size) {
            var image = imageContainer.image;

            if (image.width === size.width && image.height === size.height) {
              return image;
            }

            var ctx,
                canvas = document.createElement('canvas');
            canvas.width = size.width;
            canvas.height = size.height;
            ctx = canvas.getContext("2d");
            ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, size.width, size.height);
            return canvas;
          };

          function hasEntries(array) {
            return array.length > 0;
          }

          module.exports = CanvasRenderer;
        }, {
          "../lineargradientcontainer": 12,
          "../log": 13,
          "../renderer": 19
        }],
        21: [function (_dereq_, module, exports) {
          var NodeContainer = _dereq_('./nodecontainer');

          function StackingContext(hasOwnStacking, opacity, element, parent) {
            NodeContainer.call(this, element, parent);
            this.ownStacking = hasOwnStacking;
            this.contexts = [];
            this.children = [];
            this.opacity = (this.parent ? this.parent.stack.opacity : 1) * opacity;
          }

          StackingContext.prototype = Object.create(NodeContainer.prototype);

          StackingContext.prototype.getParentStack = function (context) {
            var parentStack = this.parent ? this.parent.stack : null;
            return parentStack ? parentStack.ownStacking ? parentStack : parentStack.getParentStack(context) : context.stack;
          };

          module.exports = StackingContext;
        }, {
          "./nodecontainer": 14
        }],
        22: [function (_dereq_, module, exports) {
          function Support(document) {
            this.rangeBounds = this.testRangeBounds(document);
            this.cors = this.testCORS();
            this.svg = this.testSVG();
          }

          Support.prototype.testRangeBounds = function (document) {
            var range,
                testElement,
                rangeBounds,
                rangeHeight,
                support = false;

            if (document.createRange) {
              range = document.createRange();

              if (range.getBoundingClientRect) {
                testElement = document.createElement('boundtest');
                testElement.style.height = "123px";
                testElement.style.display = "block";
                document.body.appendChild(testElement);
                range.selectNode(testElement);
                rangeBounds = range.getBoundingClientRect();
                rangeHeight = rangeBounds.height;

                if (rangeHeight === 123) {
                  support = true;
                }

                document.body.removeChild(testElement);
              }
            }

            return support;
          };

          Support.prototype.testCORS = function () {
            return typeof new Image().crossOrigin !== "undefined";
          };

          Support.prototype.testSVG = function () {
            var img = new Image();
            var canvas = document.createElement("canvas");
            var ctx = canvas.getContext("2d");
            img.src = "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";

            try {
              ctx.drawImage(img, 0, 0);
              canvas.toDataURL();
            } catch (e) {
              return false;
            }

            return true;
          };

          module.exports = Support;
        }, {}],
        23: [function (_dereq_, module, exports) {
          var XHR = _dereq_('./xhr');

          var decode64 = _dereq_('./utils').decode64;

          function SVGContainer(src) {
            this.src = src;
            this.image = null;
            var self = this;
            this.promise = this.hasFabric().then(function () {
              return self.isInline(src) ? Promise.resolve(self.inlineFormatting(src)) : XHR(src);
            }).then(function (svg) {
              return new Promise(function (resolve) {
                window.html2canvas.svg.fabric.loadSVGFromString(svg, self.createCanvas.call(self, resolve));
              });
            });
          }

          SVGContainer.prototype.hasFabric = function () {
            return !window.html2canvas.svg || !window.html2canvas.svg.fabric ? Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg")) : Promise.resolve();
          };

          SVGContainer.prototype.inlineFormatting = function (src) {
            return /^data:image\/svg\+xml;base64,/.test(src) ? this.decode64(this.removeContentType(src)) : this.removeContentType(src);
          };

          SVGContainer.prototype.removeContentType = function (src) {
            return src.replace(/^data:image\/svg\+xml(;base64)?,/, '');
          };

          SVGContainer.prototype.isInline = function (src) {
            return /^data:image\/svg\+xml/i.test(src);
          };

          SVGContainer.prototype.createCanvas = function (resolve) {
            var self = this;
            return function (objects, options) {
              var canvas = new window.html2canvas.svg.fabric.StaticCanvas('c');
              self.image = canvas.lowerCanvasEl;
              canvas.setWidth(options.width).setHeight(options.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(objects, options)).renderAll();
              resolve(canvas.lowerCanvasEl);
            };
          };

          SVGContainer.prototype.decode64 = function (str) {
            return typeof window.atob === "function" ? window.atob(str) : decode64(str);
          };

          module.exports = SVGContainer;
        }, {
          "./utils": 26,
          "./xhr": 28
        }],
        24: [function (_dereq_, module, exports) {
          var SVGContainer = _dereq_('./svgcontainer');

          function SVGNodeContainer(node, _native) {
            this.src = node;
            this.image = null;
            var self = this;
            this.promise = _native ? new Promise(function (resolve, reject) {
              self.image = new Image();
              self.image.onload = resolve;
              self.image.onerror = reject;
              self.image.src = "data:image/svg+xml," + new XMLSerializer().serializeToString(node);

              if (self.image.complete === true) {
                resolve(self.image);
              }
            }) : this.hasFabric().then(function () {
              return new Promise(function (resolve) {
                window.html2canvas.svg.fabric.parseSVGDocument(node, self.createCanvas.call(self, resolve));
              });
            });
          }

          SVGNodeContainer.prototype = Object.create(SVGContainer.prototype);
          module.exports = SVGNodeContainer;
        }, {
          "./svgcontainer": 23
        }],
        25: [function (_dereq_, module, exports) {
          var NodeContainer = _dereq_('./nodecontainer');

          function TextContainer(node, parent) {
            NodeContainer.call(this, node, parent);
          }

          TextContainer.prototype = Object.create(NodeContainer.prototype);

          TextContainer.prototype.applyTextTransform = function () {
            this.node.data = this.transform(this.parent.css("textTransform"));
          };

          TextContainer.prototype.transform = function (transform) {
            var text = this.node.data;

            switch (transform) {
              case "lowercase":
                return text.toLowerCase();

              case "capitalize":
                return text.replace(/(^|\s|:|-|\(|\))([a-z])/g, capitalize);

              case "uppercase":
                return text.toUpperCase();

              default:
                return text;
            }
          };

          function capitalize(m, p1, p2) {
            if (m.length > 0) {
              return p1 + p2.toUpperCase();
            }
          }

          module.exports = TextContainer;
        }, {
          "./nodecontainer": 14
        }],
        26: [function (_dereq_, module, exports) {
          exports.smallImage = function smallImage() {
            return "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
          };

          exports.bind = function (callback, context) {
            return function () {
              return callback.apply(context, arguments);
            };
          };
          /*
           * base64-arraybuffer
           * https://github.com/niklasvh/base64-arraybuffer
           *
           * Copyright (c) 2012 Niklas von Hertzen
           * Licensed under the MIT license.
           */


          exports.decode64 = function (base64) {
            var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
            var len = base64.length,
                i,
                encoded1,
                encoded2,
                encoded3,
                encoded4,
                byte1,
                byte2,
                byte3;
            var output = "";

            for (i = 0; i < len; i += 4) {
              encoded1 = chars.indexOf(base64[i]);
              encoded2 = chars.indexOf(base64[i + 1]);
              encoded3 = chars.indexOf(base64[i + 2]);
              encoded4 = chars.indexOf(base64[i + 3]);
              byte1 = encoded1 << 2 | encoded2 >> 4;
              byte2 = (encoded2 & 15) << 4 | encoded3 >> 2;
              byte3 = (encoded3 & 3) << 6 | encoded4;

              if (encoded3 === 64) {
                output += String.fromCharCode(byte1);
              } else if (encoded4 === 64 || encoded4 === -1) {
                output += String.fromCharCode(byte1, byte2);
              } else {
                output += String.fromCharCode(byte1, byte2, byte3);
              }
            }

            return output;
          };

          exports.getBounds = function (node) {
            if (node.getBoundingClientRect) {
              var clientRect = node.getBoundingClientRect();
              var width = node.offsetWidth == null ? clientRect.width : node.offsetWidth;
              return {
                top: clientRect.top,
                bottom: clientRect.bottom || clientRect.top + clientRect.height,
                right: clientRect.left + width,
                left: clientRect.left,
                width: width,
                height: node.offsetHeight == null ? clientRect.height : node.offsetHeight
              };
            }

            return {};
          };

          exports.offsetBounds = function (node) {
            var parent = node.offsetParent ? exports.offsetBounds(node.offsetParent) : {
              top: 0,
              left: 0
            };
            return {
              top: node.offsetTop + parent.top,
              bottom: node.offsetTop + node.offsetHeight + parent.top,
              right: node.offsetLeft + parent.left + node.offsetWidth,
              left: node.offsetLeft + parent.left,
              width: node.offsetWidth,
              height: node.offsetHeight
            };
          };

          exports.parseBackgrounds = function (backgroundImage) {
            var whitespace = ' \r\n\t',
                method,
                definition,
                prefix,
                prefix_i,
                block,
                results = [],
                mode = 0,
                numParen = 0,
                quote,
                args;

            var appendResult = function appendResult() {
              if (method) {
                if (definition.substr(0, 1) === '"') {
                  definition = definition.substr(1, definition.length - 2);
                }

                if (definition) {
                  args.push(definition);
                }

                if (method.substr(0, 1) === '-' && (prefix_i = method.indexOf('-', 1) + 1) > 0) {
                  prefix = method.substr(0, prefix_i);
                  method = method.substr(prefix_i);
                }

                results.push({
                  prefix: prefix,
                  method: method.toLowerCase(),
                  value: block,
                  args: args,
                  image: null
                });
              }

              args = [];
              method = prefix = definition = block = '';
            };

            args = [];
            method = prefix = definition = block = '';
            backgroundImage.split("").forEach(function (c) {
              if (mode === 0 && whitespace.indexOf(c) > -1) {
                return;
              }

              switch (c) {
                case '"':
                  if (!quote) {
                    quote = c;
                  } else if (quote === c) {
                    quote = null;
                  }

                  break;

                case '(':
                  if (quote) {
                    break;
                  } else if (mode === 0) {
                    mode = 1;
                    block += c;
                    return;
                  } else {
                    numParen++;
                  }

                  break;

                case ')':
                  if (quote) {
                    break;
                  } else if (mode === 1) {
                    if (numParen === 0) {
                      mode = 0;
                      block += c;
                      appendResult();
                      return;
                    } else {
                      numParen--;
                    }
                  }

                  break;

                case ',':
                  if (quote) {
                    break;
                  } else if (mode === 0) {
                    appendResult();
                    return;
                  } else if (mode === 1) {
                    if (numParen === 0 && !method.match(/^url$/i)) {
                      args.push(definition);
                      definition = '';
                      block += c;
                      return;
                    }
                  }

                  break;
              }

              block += c;

              if (mode === 0) {
                method += c;
              } else {
                definition += c;
              }
            });
            appendResult();
            return results;
          };
        }, {}],
        27: [function (_dereq_, module, exports) {
          var GradientContainer = _dereq_('./gradientcontainer');

          function WebkitGradientContainer(imageData) {
            GradientContainer.apply(this, arguments);
            this.type = imageData.args[0] === "linear" ? GradientContainer.TYPES.LINEAR : GradientContainer.TYPES.RADIAL;
          }

          WebkitGradientContainer.prototype = Object.create(GradientContainer.prototype);
          module.exports = WebkitGradientContainer;
        }, {
          "./gradientcontainer": 9
        }],
        28: [function (_dereq_, module, exports) {
          function XHR(url) {
            return new Promise(function (resolve, reject) {
              var xhr = new XMLHttpRequest();
              xhr.open('GET', url);

              xhr.onload = function () {
                if (xhr.status === 200) {
                  resolve(xhr.responseText);
                } else {
                  reject(new Error(xhr.statusText));
                }
              };

              xhr.onerror = function () {
                reject(new Error("Network Error"));
              };

              xhr.send();
            });
          }

          module.exports = XHR;
        }, {}]
      }, {}, [4])(4);
    });
  });

  /*
  	Based on rgbcolor.js by Stoyan Stefanov <sstoo@gmail.com>
  	http://www.phpied.com/rgb-color-parser-in-javascript/
  */
  var rgbcolor = function rgbcolor(color_string) {
    this.ok = false;
    this.alpha = 1.0; // strip any leading #

    if (color_string.charAt(0) == '#') {
      // remove # if any
      color_string = color_string.substr(1, 6);
    }

    color_string = color_string.replace(/ /g, '');
    color_string = color_string.toLowerCase(); // before getting into regexps, try simple matches
    // and overwrite the input

    var simple_colors = {
      aliceblue: 'f0f8ff',
      antiquewhite: 'faebd7',
      aqua: '00ffff',
      aquamarine: '7fffd4',
      azure: 'f0ffff',
      beige: 'f5f5dc',
      bisque: 'ffe4c4',
      black: '000000',
      blanchedalmond: 'ffebcd',
      blue: '0000ff',
      blueviolet: '8a2be2',
      brown: 'a52a2a',
      burlywood: 'deb887',
      cadetblue: '5f9ea0',
      chartreuse: '7fff00',
      chocolate: 'd2691e',
      coral: 'ff7f50',
      cornflowerblue: '6495ed',
      cornsilk: 'fff8dc',
      crimson: 'dc143c',
      cyan: '00ffff',
      darkblue: '00008b',
      darkcyan: '008b8b',
      darkgoldenrod: 'b8860b',
      darkgray: 'a9a9a9',
      darkgreen: '006400',
      darkkhaki: 'bdb76b',
      darkmagenta: '8b008b',
      darkolivegreen: '556b2f',
      darkorange: 'ff8c00',
      darkorchid: '9932cc',
      darkred: '8b0000',
      darksalmon: 'e9967a',
      darkseagreen: '8fbc8f',
      darkslateblue: '483d8b',
      darkslategray: '2f4f4f',
      darkturquoise: '00ced1',
      darkviolet: '9400d3',
      deeppink: 'ff1493',
      deepskyblue: '00bfff',
      dimgray: '696969',
      dodgerblue: '1e90ff',
      feldspar: 'd19275',
      firebrick: 'b22222',
      floralwhite: 'fffaf0',
      forestgreen: '228b22',
      fuchsia: 'ff00ff',
      gainsboro: 'dcdcdc',
      ghostwhite: 'f8f8ff',
      gold: 'ffd700',
      goldenrod: 'daa520',
      gray: '808080',
      green: '008000',
      greenyellow: 'adff2f',
      honeydew: 'f0fff0',
      hotpink: 'ff69b4',
      indianred: 'cd5c5c',
      indigo: '4b0082',
      ivory: 'fffff0',
      khaki: 'f0e68c',
      lavender: 'e6e6fa',
      lavenderblush: 'fff0f5',
      lawngreen: '7cfc00',
      lemonchiffon: 'fffacd',
      lightblue: 'add8e6',
      lightcoral: 'f08080',
      lightcyan: 'e0ffff',
      lightgoldenrodyellow: 'fafad2',
      lightgrey: 'd3d3d3',
      lightgreen: '90ee90',
      lightpink: 'ffb6c1',
      lightsalmon: 'ffa07a',
      lightseagreen: '20b2aa',
      lightskyblue: '87cefa',
      lightslateblue: '8470ff',
      lightslategray: '778899',
      lightsteelblue: 'b0c4de',
      lightyellow: 'ffffe0',
      lime: '00ff00',
      limegreen: '32cd32',
      linen: 'faf0e6',
      magenta: 'ff00ff',
      maroon: '800000',
      mediumaquamarine: '66cdaa',
      mediumblue: '0000cd',
      mediumorchid: 'ba55d3',
      mediumpurple: '9370d8',
      mediumseagreen: '3cb371',
      mediumslateblue: '7b68ee',
      mediumspringgreen: '00fa9a',
      mediumturquoise: '48d1cc',
      mediumvioletred: 'c71585',
      midnightblue: '191970',
      mintcream: 'f5fffa',
      mistyrose: 'ffe4e1',
      moccasin: 'ffe4b5',
      navajowhite: 'ffdead',
      navy: '000080',
      oldlace: 'fdf5e6',
      olive: '808000',
      olivedrab: '6b8e23',
      orange: 'ffa500',
      orangered: 'ff4500',
      orchid: 'da70d6',
      palegoldenrod: 'eee8aa',
      palegreen: '98fb98',
      paleturquoise: 'afeeee',
      palevioletred: 'd87093',
      papayawhip: 'ffefd5',
      peachpuff: 'ffdab9',
      peru: 'cd853f',
      pink: 'ffc0cb',
      plum: 'dda0dd',
      powderblue: 'b0e0e6',
      purple: '800080',
      red: 'ff0000',
      rosybrown: 'bc8f8f',
      royalblue: '4169e1',
      saddlebrown: '8b4513',
      salmon: 'fa8072',
      sandybrown: 'f4a460',
      seagreen: '2e8b57',
      seashell: 'fff5ee',
      sienna: 'a0522d',
      silver: 'c0c0c0',
      skyblue: '87ceeb',
      slateblue: '6a5acd',
      slategray: '708090',
      snow: 'fffafa',
      springgreen: '00ff7f',
      steelblue: '4682b4',
      tan: 'd2b48c',
      teal: '008080',
      thistle: 'd8bfd8',
      tomato: 'ff6347',
      turquoise: '40e0d0',
      violet: 'ee82ee',
      violetred: 'd02090',
      wheat: 'f5deb3',
      white: 'ffffff',
      whitesmoke: 'f5f5f5',
      yellow: 'ffff00',
      yellowgreen: '9acd32'
    };
    color_string = simple_colors[color_string] || color_string; // emd of simple type-in colors
    // array of color definition objects

    var color_defs = [{
      re: /^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,
      example: ['rgba(123, 234, 45, 0.8)', 'rgba(255,234,245,1.0)'],
      process: function process(bits) {
        return [parseInt(bits[1]), parseInt(bits[2]), parseInt(bits[3]), parseFloat(bits[4])];
      }
    }, {
      re: /^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,
      example: ['rgb(123, 234, 45)', 'rgb(255,234,245)'],
      process: function process(bits) {
        return [parseInt(bits[1]), parseInt(bits[2]), parseInt(bits[3])];
      }
    }, {
      re: /^(\w{2})(\w{2})(\w{2})$/,
      example: ['#00ff00', '336699'],
      process: function process(bits) {
        return [parseInt(bits[1], 16), parseInt(bits[2], 16), parseInt(bits[3], 16)];
      }
    }, {
      re: /^(\w{1})(\w{1})(\w{1})$/,
      example: ['#fb0', 'f0f'],
      process: function process(bits) {
        return [parseInt(bits[1] + bits[1], 16), parseInt(bits[2] + bits[2], 16), parseInt(bits[3] + bits[3], 16)];
      }
    }]; // search through the definitions to find a match

    for (var i = 0; i < color_defs.length; i++) {
      var re = color_defs[i].re;
      var processor = color_defs[i].process;
      var bits = re.exec(color_string);

      if (bits) {
        var channels = processor(bits);
        this.r = channels[0];
        this.g = channels[1];
        this.b = channels[2];

        if (channels.length > 3) {
          this.alpha = channels[3];
        }

        this.ok = true;
      }
    } // validate/cleanup values


    this.r = this.r < 0 || isNaN(this.r) ? 0 : this.r > 255 ? 255 : this.r;
    this.g = this.g < 0 || isNaN(this.g) ? 0 : this.g > 255 ? 255 : this.g;
    this.b = this.b < 0 || isNaN(this.b) ? 0 : this.b > 255 ? 255 : this.b;
    this.alpha = this.alpha < 0 ? 0 : this.alpha > 1.0 || isNaN(this.alpha) ? 1.0 : this.alpha; // some getters

    this.toRGB = function () {
      return 'rgb(' + this.r + ', ' + this.g + ', ' + this.b + ')';
    };

    this.toRGBA = function () {
      return 'rgba(' + this.r + ', ' + this.g + ', ' + this.b + ', ' + this.alpha + ')';
    };

    this.toHex = function () {
      var r = this.r.toString(16);
      var g = this.g.toString(16);
      var b = this.b.toString(16);
      if (r.length == 1) r = '0' + r;
      if (g.length == 1) g = '0' + g;
      if (b.length == 1) b = '0' + b;
      return '#' + r + g + b;
    }; // help


    this.getHelpXML = function () {
      var examples = new Array(); // add regexps

      for (var i = 0; i < color_defs.length; i++) {
        var example = color_defs[i].example;

        for (var j = 0; j < example.length; j++) {
          examples[examples.length] = example[j];
        }
      } // add type-in colors


      for (var sc in simple_colors) {
        examples[examples.length] = sc;
      }

      var xml = document.createElement('ul');
      xml.setAttribute('id', 'rgbcolor-examples');

      for (var i = 0; i < examples.length; i++) {
        try {
          var list_item = document.createElement('li');
          var list_color = new RGBColor(examples[i]);
          var example_div = document.createElement('div');
          example_div.style.cssText = 'margin: 3px; ' + 'border: 1px solid black; ' + 'background:' + list_color.toHex() + '; ' + 'color:' + list_color.toHex();
          example_div.appendChild(document.createTextNode('test'));
          var list_item_value = document.createTextNode(' ' + examples[i] + ' -> ' + list_color.toRGB() + ' -> ' + list_color.toHex());
          list_item.appendChild(example_div);
          list_item.appendChild(list_item_value);
          xml.appendChild(list_item);
        } catch (e) {}
      }

      return xml;
    };
  };

  /*

  StackBlur - a fast almost Gaussian Blur For Canvas

  Version: 	0.5
  Author:		Mario Klingemann
  Contact: 	mario@quasimondo.com
  Website:	http://www.quasimondo.com/StackBlurForCanvas
  Twitter:	@quasimondo

  In case you find this class useful - especially in commercial projects -
  I am not totally unhappy for a small donation to my PayPal account
  mario@quasimondo.de

  Or support me on flattr: 
  https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

  Copyright (c) 2010 Mario Klingemann

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation
  files (the "Software"), to deal in the Software without
  restriction, including without limitation the rights to use,
  copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the
  Software is furnished to do so, subject to the following
  conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
  HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
  WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
  OTHER DEALINGS IN THE SOFTWARE.
  */
  var mul_table = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];
  var shg_table = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];

  function blur(pixels, width, height, radius) {
    if (isNaN(radius) || radius < 1) return;
    radius |= 0;
    var x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum, a_sum, r_out_sum, g_out_sum, b_out_sum, a_out_sum, r_in_sum, g_in_sum, b_in_sum, a_in_sum, pr, pg, pb, pa, rbs;
    var div = radius + radius + 1;
    var widthMinus1 = width - 1;
    var heightMinus1 = height - 1;
    var radiusPlus1 = radius + 1;
    var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;
    var stackStart = new BlurStack();
    var stack = stackStart;

    for (i = 1; i < div; i++) {
      stack = stack.next = new BlurStack();
      if (i == radiusPlus1) var stackEnd = stack;
    }

    stack.next = stackStart;
    var stackIn = null;
    var stackOut = null;
    yw = yi = 0;
    var mul_sum = mul_table[radius];
    var shg_sum = shg_table[radius];

    for (y = 0; y < height; y++) {
      r_in_sum = g_in_sum = b_in_sum = a_in_sum = r_sum = g_sum = b_sum = a_sum = 0;
      r_out_sum = radiusPlus1 * (pr = pixels[yi]);
      g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);
      b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);
      a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);
      r_sum += sumFactor * pr;
      g_sum += sumFactor * pg;
      b_sum += sumFactor * pb;
      a_sum += sumFactor * pa;
      stack = stackStart;

      for (i = 0; i < radiusPlus1; i++) {
        stack.r = pr;
        stack.g = pg;
        stack.b = pb;
        stack.a = pa;
        stack = stack.next;
      }

      for (i = 1; i < radiusPlus1; i++) {
        p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);
        r_sum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - i);
        g_sum += (stack.g = pg = pixels[p + 1]) * rbs;
        b_sum += (stack.b = pb = pixels[p + 2]) * rbs;
        a_sum += (stack.a = pa = pixels[p + 3]) * rbs;
        r_in_sum += pr;
        g_in_sum += pg;
        b_in_sum += pb;
        a_in_sum += pa;
        stack = stack.next;
      }

      stackIn = stackStart;
      stackOut = stackEnd;

      for (x = 0; x < width; x++) {
        pixels[yi + 3] = pa = a_sum * mul_sum >> shg_sum;

        if (pa != 0) {
          pa = 255 / pa;
          pixels[yi] = (r_sum * mul_sum >> shg_sum) * pa;
          pixels[yi + 1] = (g_sum * mul_sum >> shg_sum) * pa;
          pixels[yi + 2] = (b_sum * mul_sum >> shg_sum) * pa;
        } else {
          pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;
        }

        r_sum -= r_out_sum;
        g_sum -= g_out_sum;
        b_sum -= b_out_sum;
        a_sum -= a_out_sum;
        r_out_sum -= stackIn.r;
        g_out_sum -= stackIn.g;
        b_out_sum -= stackIn.b;
        a_out_sum -= stackIn.a;
        p = yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1) << 2;
        r_in_sum += stackIn.r = pixels[p];
        g_in_sum += stackIn.g = pixels[p + 1];
        b_in_sum += stackIn.b = pixels[p + 2];
        a_in_sum += stackIn.a = pixels[p + 3];
        r_sum += r_in_sum;
        g_sum += g_in_sum;
        b_sum += b_in_sum;
        a_sum += a_in_sum;
        stackIn = stackIn.next;
        r_out_sum += pr = stackOut.r;
        g_out_sum += pg = stackOut.g;
        b_out_sum += pb = stackOut.b;
        a_out_sum += pa = stackOut.a;
        r_in_sum -= pr;
        g_in_sum -= pg;
        b_in_sum -= pb;
        a_in_sum -= pa;
        stackOut = stackOut.next;
        yi += 4;
      }

      yw += width;
    }

    for (x = 0; x < width; x++) {
      g_in_sum = b_in_sum = a_in_sum = r_in_sum = g_sum = b_sum = a_sum = r_sum = 0;
      yi = x << 2;
      r_out_sum = radiusPlus1 * (pr = pixels[yi]);
      g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);
      b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);
      a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);
      r_sum += sumFactor * pr;
      g_sum += sumFactor * pg;
      b_sum += sumFactor * pb;
      a_sum += sumFactor * pa;
      stack = stackStart;

      for (i = 0; i < radiusPlus1; i++) {
        stack.r = pr;
        stack.g = pg;
        stack.b = pb;
        stack.a = pa;
        stack = stack.next;
      }

      yp = width;

      for (i = 1; i <= radius; i++) {
        yi = yp + x << 2;
        r_sum += (stack.r = pr = pixels[yi]) * (rbs = radiusPlus1 - i);
        g_sum += (stack.g = pg = pixels[yi + 1]) * rbs;
        b_sum += (stack.b = pb = pixels[yi + 2]) * rbs;
        a_sum += (stack.a = pa = pixels[yi + 3]) * rbs;
        r_in_sum += pr;
        g_in_sum += pg;
        b_in_sum += pb;
        a_in_sum += pa;
        stack = stack.next;

        if (i < heightMinus1) {
          yp += width;
        }
      }

      yi = x;
      stackIn = stackStart;
      stackOut = stackEnd;

      for (y = 0; y < height; y++) {
        p = yi << 2;
        pixels[p + 3] = pa = a_sum * mul_sum >> shg_sum;

        if (pa > 0) {
          pa = 255 / pa;
          pixels[p] = (r_sum * mul_sum >> shg_sum) * pa;
          pixels[p + 1] = (g_sum * mul_sum >> shg_sum) * pa;
          pixels[p + 2] = (b_sum * mul_sum >> shg_sum) * pa;
        } else {
          pixels[p] = pixels[p + 1] = pixels[p + 2] = 0;
        }

        r_sum -= r_out_sum;
        g_sum -= g_out_sum;
        b_sum -= b_out_sum;
        a_sum -= a_out_sum;
        r_out_sum -= stackIn.r;
        g_out_sum -= stackIn.g;
        b_out_sum -= stackIn.b;
        a_out_sum -= stackIn.a;
        p = x + ((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width << 2;
        r_sum += r_in_sum += stackIn.r = pixels[p];
        g_sum += g_in_sum += stackIn.g = pixels[p + 1];
        b_sum += b_in_sum += stackIn.b = pixels[p + 2];
        a_sum += a_in_sum += stackIn.a = pixels[p + 3];
        stackIn = stackIn.next;
        r_out_sum += pr = stackOut.r;
        g_out_sum += pg = stackOut.g;
        b_out_sum += pb = stackOut.b;
        a_out_sum += pa = stackOut.a;
        r_in_sum -= pr;
        g_in_sum -= pg;
        b_in_sum -= pb;
        a_in_sum -= pa;
        stackOut = stackOut.next;
        yi += width;
      }
    }
  }

  function BlurStack() {
    this.r = 0;
    this.g = 0;
    this.b = 0;
    this.a = 0;
    this.next = null;
  }

  var stackblur = blur;

  //[4]   	NameStartChar	   ::=   	":" | [A-Z] | "_" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]
  //[4a]   	NameChar	   ::=   	NameStartChar | "-" | "." | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040]
  //[5]   	Name	   ::=   	NameStartChar (NameChar)*
  var nameStartChar = /[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/; //\u10000-\uEFFFF

  var nameChar = new RegExp("[\\-\\.0-9" + nameStartChar.source.slice(1, -1) + "\\u00B7\\u0300-\\u036F\\u203F-\\u2040]");
  var tagNamePattern = new RegExp('^' + nameStartChar.source + nameChar.source + '*(?:\:' + nameStartChar.source + nameChar.source + '*)?$'); //var tagNamePattern = /^[a-zA-Z_][\w\-\.]*(?:\:[a-zA-Z_][\w\-\.]*)?$/
  //var handlers = 'resolveEntity,getExternalSubset,characters,endDocument,endElement,endPrefixMapping,ignorableWhitespace,processingInstruction,setDocumentLocator,skippedEntity,startDocument,startElement,startPrefixMapping,notationDecl,unparsedEntityDecl,error,fatalError,warning,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,comment,endCDATA,endDTD,endEntity,startCDATA,startDTD,startEntity'.split(',')
  //S_TAG,	S_ATTR,	S_EQ,	S_ATTR_NOQUOT_VALUE
  //S_ATTR_SPACE,	S_ATTR_END,	S_TAG_SPACE, S_TAG_CLOSE

  var S_TAG = 0; //tag name offerring

  var S_ATTR = 1; //attr name offerring 

  var S_ATTR_SPACE = 2; //attr name end and space offer

  var S_EQ = 3; //=space?

  var S_ATTR_NOQUOT_VALUE = 4; //attr value(no quot value only)

  var S_ATTR_END = 5; //attr value end and no space(quot end)

  var S_TAG_SPACE = 6; //(attr value end || tag end ) && (space offer)

  var S_TAG_CLOSE = 7; //closed el<el />

  function XMLReader() {}

  XMLReader.prototype = {
    parse: function parse(source, defaultNSMap, entityMap) {
      var domBuilder = this.domBuilder;
      domBuilder.startDocument();

      _copy(defaultNSMap, defaultNSMap = {});

      _parse(source, defaultNSMap, entityMap, domBuilder, this.errorHandler);

      domBuilder.endDocument();
    }
  };

  function _parse(source, defaultNSMapCopy, entityMap, domBuilder, errorHandler) {
    function fixedFromCharCode(code) {
      // String.prototype.fromCharCode does not supports
      // > 2 bytes unicode chars directly
      if (code > 0xffff) {
        code -= 0x10000;
        var surrogate1 = 0xd800 + (code >> 10),
            surrogate2 = 0xdc00 + (code & 0x3ff);
        return String.fromCharCode(surrogate1, surrogate2);
      } else {
        return String.fromCharCode(code);
      }
    }

    function entityReplacer(a) {
      var k = a.slice(1, -1);

      if (k in entityMap) {
        return entityMap[k];
      } else if (k.charAt(0) === '#') {
        return fixedFromCharCode(parseInt(k.substr(1).replace('x', '0x')));
      } else {
        errorHandler.error('entity not found:' + a);
        return a;
      }
    }

    function appendText(end) {
      //has some bugs
      if (end > start) {
        var xt = source.substring(start, end).replace(/&#?\w+;/g, entityReplacer);
        locator && position(start);
        domBuilder.characters(xt, 0, end - start);
        start = end;
      }
    }

    function position(p, m) {
      while (p >= lineEnd && (m = linePattern.exec(source))) {
        lineStart = m.index;
        lineEnd = lineStart + m[0].length;
        locator.lineNumber++; //console.log('line++:',locator,startPos,endPos)
      }

      locator.columnNumber = p - lineStart + 1;
    }

    var lineStart = 0;
    var lineEnd = 0;
    var linePattern = /.*(?:\r\n?|\n)|.*$/g;
    var locator = domBuilder.locator;
    var parseStack = [{
      currentNSMap: defaultNSMapCopy
    }];
    var closeMap = {};
    var start = 0;

    while (true) {
      try {
        var tagStart = source.indexOf('<', start);

        if (tagStart < 0) {
          if (!source.substr(start).match(/^\s*$/)) {
            var doc = domBuilder.doc;
            var text = doc.createTextNode(source.substr(start));
            doc.appendChild(text);
            domBuilder.currentElement = text;
          }

          return;
        }

        if (tagStart > start) {
          appendText(tagStart);
        }

        switch (source.charAt(tagStart + 1)) {
          case '/':
            var end = source.indexOf('>', tagStart + 3);
            var tagName = source.substring(tagStart + 2, end);
            var config = parseStack.pop();

            if (end < 0) {
              tagName = source.substring(tagStart + 2).replace(/[\s<].*/, ''); //console.error('#@@@@@@'+tagName)

              errorHandler.error("end tag name: " + tagName + ' is not complete:' + config.tagName);
              end = tagStart + 1 + tagName.length;
            } else if (tagName.match(/\s</)) {
              tagName = tagName.replace(/[\s<].*/, '');
              errorHandler.error("end tag name: " + tagName + ' maybe not complete');
              end = tagStart + 1 + tagName.length;
            } //console.error(parseStack.length,parseStack)
            //console.error(config);


            var localNSMap = config.localNSMap;
            var endMatch = config.tagName == tagName;
            var endIgnoreCaseMach = endMatch || config.tagName && config.tagName.toLowerCase() == tagName.toLowerCase();

            if (endIgnoreCaseMach) {
              domBuilder.endElement(config.uri, config.localName, tagName);

              if (localNSMap) {
                for (var prefix in localNSMap) {
                  domBuilder.endPrefixMapping(prefix);
                }
              }

              if (!endMatch) {
                errorHandler.fatalError("end tag name: " + tagName + ' is not match the current start tagName:' + config.tagName);
              }
            } else {
              parseStack.push(config);
            }

            end++;
            break;
          // end elment

          case '?':
            // <?...?>
            locator && position(tagStart);
            end = parseInstruction(source, tagStart, domBuilder);
            break;

          case '!':
            // <!doctype,<![CDATA,<!--
            locator && position(tagStart);
            end = parseDCC(source, tagStart, domBuilder, errorHandler);
            break;

          default:
            locator && position(tagStart);
            var el = new ElementAttributes();
            var currentNSMap = parseStack[parseStack.length - 1].currentNSMap; //elStartEnd

            var end = parseElementStartPart(source, tagStart, el, currentNSMap, entityReplacer, errorHandler);
            var len = el.length;

            if (!el.closed && fixSelfClosed(source, end, el.tagName, closeMap)) {
              el.closed = true;

              if (!entityMap.nbsp) {
                errorHandler.warning('unclosed xml attribute');
              }
            }

            if (locator && len) {
              var locator2 = copyLocator(locator, {}); //try{//attribute position fixed

              for (var i = 0; i < len; i++) {
                var a = el[i];
                position(a.offset);
                a.locator = copyLocator(locator, {});
              } //}catch(e){console.error('@@@@@'+e)}


              domBuilder.locator = locator2;

              if (appendElement(el, domBuilder, currentNSMap)) {
                parseStack.push(el);
              }

              domBuilder.locator = locator;
            } else {
              if (appendElement(el, domBuilder, currentNSMap)) {
                parseStack.push(el);
              }
            }

            if (el.uri === 'http://www.w3.org/1999/xhtml' && !el.closed) {
              end = parseHtmlSpecialContent(source, end, el.tagName, entityReplacer, domBuilder);
            } else {
              end++;
            }

        }
      } catch (e) {
        errorHandler.error('element parse error: ' + e); //errorHandler.error('element parse error: '+e);

        end = -1; //throw e;
      }

      if (end > start) {
        start = end;
      } else {
        //TODO: sax
        appendText(Math.max(tagStart, start) + 1);
      }
    }
  }

  function copyLocator(f, t) {
    t.lineNumber = f.lineNumber;
    t.columnNumber = f.columnNumber;
    return t;
  }
  /**
   * @see #appendElement(source,elStartEnd,el,selfClosed,entityReplacer,domBuilder,parseStack);
   * @return end of the elementStartPart(end of elementEndPart for selfClosed el)
   */


  function parseElementStartPart(source, start, el, currentNSMap, entityReplacer, errorHandler) {
    var attrName;
    var value;
    var p = ++start;
    var s = S_TAG; //status

    while (true) {
      var c = source.charAt(p);

      switch (c) {
        case '=':
          if (s === S_ATTR) {
            //attrName
            attrName = source.slice(start, p);
            s = S_EQ;
          } else if (s === S_ATTR_SPACE) {
            s = S_EQ;
          } else {
            //fatalError: equal must after attrName or space after attrName
            throw new Error('attribute equal must after attrName');
          }

          break;

        case '\'':
        case '"':
          if (s === S_EQ || s === S_ATTR //|| s == S_ATTR_SPACE
          ) {
              //equal
              if (s === S_ATTR) {
                errorHandler.warning('attribute value must after "="');
                attrName = source.slice(start, p);
              }

              start = p + 1;
              p = source.indexOf(c, start);

              if (p > 0) {
                value = source.slice(start, p).replace(/&#?\w+;/g, entityReplacer);
                el.add(attrName, value, start - 1);
                s = S_ATTR_END;
              } else {
                //fatalError: no end quot match
                throw new Error('attribute value no end \'' + c + '\' match');
              }
            } else if (s == S_ATTR_NOQUOT_VALUE) {
            value = source.slice(start, p).replace(/&#?\w+;/g, entityReplacer); //console.log(attrName,value,start,p)

            el.add(attrName, value, start); //console.dir(el)

            errorHandler.warning('attribute "' + attrName + '" missed start quot(' + c + ')!!');
            start = p + 1;
            s = S_ATTR_END;
          } else {
            //fatalError: no equal before
            throw new Error('attribute value must after "="');
          }

          break;

        case '/':
          switch (s) {
            case S_TAG:
              el.setTagName(source.slice(start, p));

            case S_ATTR_END:
            case S_TAG_SPACE:
            case S_TAG_CLOSE:
              s = S_TAG_CLOSE;
              el.closed = true;

            case S_ATTR_NOQUOT_VALUE:
            case S_ATTR:
            case S_ATTR_SPACE:
              break;
            //case S_EQ:

            default:
              throw new Error("attribute invalid close char('/')");
          }

          break;

        case '':
          //end document
          //throw new Error('unexpected end of input')
          errorHandler.error('unexpected end of input');

          if (s == S_TAG) {
            el.setTagName(source.slice(start, p));
          }

          return p;

        case '>':
          switch (s) {
            case S_TAG:
              el.setTagName(source.slice(start, p));

            case S_ATTR_END:
            case S_TAG_SPACE:
            case S_TAG_CLOSE:
              break;
            //normal

            case S_ATTR_NOQUOT_VALUE: //Compatible state

            case S_ATTR:
              value = source.slice(start, p);

              if (value.slice(-1) === '/') {
                el.closed = true;
                value = value.slice(0, -1);
              }

            case S_ATTR_SPACE:
              if (s === S_ATTR_SPACE) {
                value = attrName;
              }

              if (s == S_ATTR_NOQUOT_VALUE) {
                errorHandler.warning('attribute "' + value + '" missed quot(")!!');
                el.add(attrName, value.replace(/&#?\w+;/g, entityReplacer), start);
              } else {
                if (currentNSMap[''] !== 'http://www.w3.org/1999/xhtml' || !value.match(/^(?:disabled|checked|selected)$/i)) {
                  errorHandler.warning('attribute "' + value + '" missed value!! "' + value + '" instead!!');
                }

                el.add(value, value, start);
              }

              break;

            case S_EQ:
              throw new Error('attribute value missed!!');
          } //			console.log(tagName,tagNamePattern,tagNamePattern.test(tagName))


          return p;

        /*xml space '\x20' | #x9 | #xD | #xA; */

        case "\x80":
          c = ' ';

        default:
          if (c <= ' ') {
            //space
            switch (s) {
              case S_TAG:
                el.setTagName(source.slice(start, p)); //tagName

                s = S_TAG_SPACE;
                break;

              case S_ATTR:
                attrName = source.slice(start, p);
                s = S_ATTR_SPACE;
                break;

              case S_ATTR_NOQUOT_VALUE:
                var value = source.slice(start, p).replace(/&#?\w+;/g, entityReplacer);
                errorHandler.warning('attribute "' + value + '" missed quot(")!!');
                el.add(attrName, value, start);

              case S_ATTR_END:
                s = S_TAG_SPACE;
                break;
              //case S_TAG_SPACE:
              //case S_EQ:
              //case S_ATTR_SPACE:
              //	void();break;
              //case S_TAG_CLOSE:
              //ignore warning
            }
          } else {
            //not space
            //S_TAG,	S_ATTR,	S_EQ,	S_ATTR_NOQUOT_VALUE
            //S_ATTR_SPACE,	S_ATTR_END,	S_TAG_SPACE, S_TAG_CLOSE
            switch (s) {
              //case S_TAG:void();break;
              //case S_ATTR:void();break;
              //case S_ATTR_NOQUOT_VALUE:void();break;
              case S_ATTR_SPACE:
                var tagName = el.tagName;

                if (currentNSMap[''] !== 'http://www.w3.org/1999/xhtml' || !attrName.match(/^(?:disabled|checked|selected)$/i)) {
                  errorHandler.warning('attribute "' + attrName + '" missed value!! "' + attrName + '" instead2!!');
                }

                el.add(attrName, attrName, start);
                start = p;
                s = S_ATTR;
                break;

              case S_ATTR_END:
                errorHandler.warning('attribute space is required"' + attrName + '"!!');

              case S_TAG_SPACE:
                s = S_ATTR;
                start = p;
                break;

              case S_EQ:
                s = S_ATTR_NOQUOT_VALUE;
                start = p;
                break;

              case S_TAG_CLOSE:
                throw new Error("elements closed character '/' and '>' must be connected to");
            }
          }

      } //end outer switch
      //console.log('p++',p)


      p++;
    }
  }
  /**
   * @return true if has new namespace define
   */


  function appendElement(el, domBuilder, currentNSMap) {
    var tagName = el.tagName;
    var localNSMap = null; //var currentNSMap = parseStack[parseStack.length-1].currentNSMap;

    var i = el.length;

    while (i--) {
      var a = el[i];
      var qName = a.qName;
      var value = a.value;
      var nsp = qName.indexOf(':');

      if (nsp > 0) {
        var prefix = a.prefix = qName.slice(0, nsp);
        var localName = qName.slice(nsp + 1);
        var nsPrefix = prefix === 'xmlns' && localName;
      } else {
        localName = qName;
        prefix = null;
        nsPrefix = qName === 'xmlns' && '';
      } //can not set prefix,because prefix !== ''


      a.localName = localName; //prefix == null for no ns prefix attribute 

      if (nsPrefix !== false) {
        //hack!!
        if (localNSMap == null) {
          localNSMap = {}; //console.log(currentNSMap,0)

          _copy(currentNSMap, currentNSMap = {}); //console.log(currentNSMap,1)

        }

        currentNSMap[nsPrefix] = localNSMap[nsPrefix] = value;
        a.uri = 'http://www.w3.org/2000/xmlns/';
        domBuilder.startPrefixMapping(nsPrefix, value);
      }
    }

    var i = el.length;

    while (i--) {
      a = el[i];
      var prefix = a.prefix;

      if (prefix) {
        //no prefix attribute has no namespace
        if (prefix === 'xml') {
          a.uri = 'http://www.w3.org/XML/1998/namespace';
        }

        if (prefix !== 'xmlns') {
          a.uri = currentNSMap[prefix || '']; //{console.log('###'+a.qName,domBuilder.locator.systemId+'',currentNSMap,a.uri)}
        }
      }
    }

    var nsp = tagName.indexOf(':');

    if (nsp > 0) {
      prefix = el.prefix = tagName.slice(0, nsp);
      localName = el.localName = tagName.slice(nsp + 1);
    } else {
      prefix = null; //important!!

      localName = el.localName = tagName;
    } //no prefix element has default namespace


    var ns = el.uri = currentNSMap[prefix || ''];
    domBuilder.startElement(ns, localName, tagName, el); //endPrefixMapping and startPrefixMapping have not any help for dom builder
    //localNSMap = null

    if (el.closed) {
      domBuilder.endElement(ns, localName, tagName);

      if (localNSMap) {
        for (prefix in localNSMap) {
          domBuilder.endPrefixMapping(prefix);
        }
      }
    } else {
      el.currentNSMap = currentNSMap;
      el.localNSMap = localNSMap; //parseStack.push(el);

      return true;
    }
  }

  function parseHtmlSpecialContent(source, elStartEnd, tagName, entityReplacer, domBuilder) {
    if (/^(?:script|textarea)$/i.test(tagName)) {
      var elEndStart = source.indexOf('</' + tagName + '>', elStartEnd);
      var text = source.substring(elStartEnd + 1, elEndStart);

      if (/[&<]/.test(text)) {
        if (/^script$/i.test(tagName)) {
          //if(!/\]\]>/.test(text)){
          //lexHandler.startCDATA();
          domBuilder.characters(text, 0, text.length); //lexHandler.endCDATA();

          return elEndStart; //}
        } //}else{//text area


        text = text.replace(/&#?\w+;/g, entityReplacer);
        domBuilder.characters(text, 0, text.length);
        return elEndStart; //}
      }
    }

    return elStartEnd + 1;
  }

  function fixSelfClosed(source, elStartEnd, tagName, closeMap) {
    //if(tagName in closeMap){
    var pos = closeMap[tagName];

    if (pos == null) {
      //console.log(tagName)
      pos = source.lastIndexOf('</' + tagName + '>');

      if (pos < elStartEnd) {
        //
        pos = source.lastIndexOf('</' + tagName);
      }

      closeMap[tagName] = pos;
    }

    return pos < elStartEnd; //} 
  }

  function _copy(source, target) {
    for (var n in source) {
      target[n] = source[n];
    }
  }

  function parseDCC(source, start, domBuilder, errorHandler) {
    //sure start with '<!'
    var next = source.charAt(start + 2);

    switch (next) {
      case '-':
        if (source.charAt(start + 3) === '-') {
          var end = source.indexOf('-->', start + 4); //append comment source.substring(4,end)//<!--

          if (end > start) {
            domBuilder.comment(source, start + 4, end - start - 4);
            return end + 3;
          } else {
            errorHandler.error("Unclosed comment");
            return -1;
          }
        } else {
          //error
          return -1;
        }

      default:
        if (source.substr(start + 3, 6) == 'CDATA[') {
          var end = source.indexOf(']]>', start + 9);
          domBuilder.startCDATA();
          domBuilder.characters(source, start + 9, end - start - 9);
          domBuilder.endCDATA();
          return end + 3;
        } //<!DOCTYPE
        //startDTD(java.lang.String name, java.lang.String publicId, java.lang.String systemId) 


        var matchs = split(source, start);
        var len = matchs.length;

        if (len > 1 && /!doctype/i.test(matchs[0][0])) {
          var name = matchs[1][0];
          var pubid = len > 3 && /^public$/i.test(matchs[2][0]) && matchs[3][0];
          var sysid = len > 4 && matchs[4][0];
          var lastMatch = matchs[len - 1];
          domBuilder.startDTD(name, pubid && pubid.replace(/^(['"])(.*?)\1$/, '$2'), sysid && sysid.replace(/^(['"])(.*?)\1$/, '$2'));
          domBuilder.endDTD();
          return lastMatch.index + lastMatch[0].length;
        }

    }

    return -1;
  }

  function parseInstruction(source, start, domBuilder) {
    var end = source.indexOf('?>', start);

    if (end) {
      var match = source.substring(start, end).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);

      if (match) {
        var len = match[0].length;
        domBuilder.processingInstruction(match[1], match[2]);
        return end + 2;
      } else {
        //error
        return -1;
      }
    }

    return -1;
  }
  /**
   * @param source
   */


  function ElementAttributes(source) {}

  ElementAttributes.prototype = {
    setTagName: function setTagName(tagName) {
      if (!tagNamePattern.test(tagName)) {
        throw new Error('invalid tagName:' + tagName);
      }

      this.tagName = tagName;
    },
    add: function add(qName, value, offset) {
      if (!tagNamePattern.test(qName)) {
        throw new Error('invalid attribute:' + qName);
      }

      this[this.length++] = {
        qName: qName,
        value: value,
        offset: offset
      };
    },
    length: 0,
    getLocalName: function getLocalName(i) {
      return this[i].localName;
    },
    getLocator: function getLocator(i) {
      return this[i].locator;
    },
    getQName: function getQName(i) {
      return this[i].qName;
    },
    getURI: function getURI(i) {
      return this[i].uri;
    },
    getValue: function getValue(i) {
      return this[i].value;
    } //	,getIndex:function(uri, localName)){
    //		if(localName){
    //			
    //		}else{
    //			var qName = uri
    //		}
    //	},
    //	getValue:function(){return this.getValue(this.getIndex.apply(this,arguments))},
    //	getType:function(uri,localName){}
    //	getType:function(i){},

  };

  function _set_proto_(thiz, parent) {
    thiz.__proto__ = parent;
    return thiz;
  }

  if (!(_set_proto_({}, _set_proto_.prototype) instanceof _set_proto_)) {
    _set_proto_ = function _set_proto_(thiz, parent) {
      function p() {}
      p.prototype = parent;
      p = new p();

      for (parent in thiz) {
        p[parent] = thiz[parent];
      }

      return p;
    };
  }

  function split(source, start) {
    var match;
    var buf = [];
    var reg = /'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;
    reg.lastIndex = start;
    reg.exec(source); //skip <

    while (match = reg.exec(source)) {
      buf.push(match);
      if (match[1]) return buf;
    }
  }

  var XMLReader_1 = XMLReader;
  var sax = {
    XMLReader: XMLReader_1
  };

  /*
   * DOM Level 2
   * Object DOMException
   * @see http://www.w3.org/TR/REC-DOM-Level-1/ecma-script-language-binding.html
   * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/ecma-script-binding.html
   */
  function copy$2(src, dest) {
    for (var p in src) {
      dest[p] = src[p];
    }
  }
  /**
  ^\w+\.prototype\.([_\w]+)\s*=\s*((?:.*\{\s*?[\r\n][\s\S]*?^})|\S.*?(?=[;\r\n]));?
  ^\w+\.prototype\.([_\w]+)\s*=\s*(\S.*?(?=[;\r\n]));?
   */


  function _extends$1(Class, Super) {
    var pt = Class.prototype;

    if (Object.create) {
      var ppt = Object.create(Super.prototype);
      pt.__proto__ = ppt;
    }

    if (!(pt instanceof Super)) {
      var t = function t() {};
      t.prototype = Super.prototype;
      t = new t();
      copy$2(pt, t);
      Class.prototype = pt = t;
    }

    if (pt.constructor != Class) {
      if (typeof Class != 'function') {
        console.error("unknow Class:" + Class);
      }

      pt.constructor = Class;
    }
  }

  var htmlns = 'http://www.w3.org/1999/xhtml'; // Node Types

  var NodeType = {};
  var ELEMENT_NODE = NodeType.ELEMENT_NODE = 1;
  var ATTRIBUTE_NODE = NodeType.ATTRIBUTE_NODE = 2;
  var TEXT_NODE = NodeType.TEXT_NODE = 3;
  var CDATA_SECTION_NODE = NodeType.CDATA_SECTION_NODE = 4;
  var ENTITY_REFERENCE_NODE = NodeType.ENTITY_REFERENCE_NODE = 5;
  var ENTITY_NODE = NodeType.ENTITY_NODE = 6;
  var PROCESSING_INSTRUCTION_NODE = NodeType.PROCESSING_INSTRUCTION_NODE = 7;
  var COMMENT_NODE = NodeType.COMMENT_NODE = 8;
  var DOCUMENT_NODE = NodeType.DOCUMENT_NODE = 9;
  var DOCUMENT_TYPE_NODE = NodeType.DOCUMENT_TYPE_NODE = 10;
  var DOCUMENT_FRAGMENT_NODE = NodeType.DOCUMENT_FRAGMENT_NODE = 11;
  var NOTATION_NODE = NodeType.NOTATION_NODE = 12; // ExceptionCode

  var ExceptionCode = {};
  var ExceptionMessage = {};
  var INDEX_SIZE_ERR = ExceptionCode.INDEX_SIZE_ERR = (ExceptionMessage[1] = "Index size error", 1);
  var DOMSTRING_SIZE_ERR = ExceptionCode.DOMSTRING_SIZE_ERR = (ExceptionMessage[2] = "DOMString size error", 2);
  var HIERARCHY_REQUEST_ERR = ExceptionCode.HIERARCHY_REQUEST_ERR = (ExceptionMessage[3] = "Hierarchy request error", 3);
  var WRONG_DOCUMENT_ERR = ExceptionCode.WRONG_DOCUMENT_ERR = (ExceptionMessage[4] = "Wrong document", 4);
  var INVALID_CHARACTER_ERR = ExceptionCode.INVALID_CHARACTER_ERR = (ExceptionMessage[5] = "Invalid character", 5);
  var NO_DATA_ALLOWED_ERR = ExceptionCode.NO_DATA_ALLOWED_ERR = (ExceptionMessage[6] = "No data allowed", 6);
  var NO_MODIFICATION_ALLOWED_ERR = ExceptionCode.NO_MODIFICATION_ALLOWED_ERR = (ExceptionMessage[7] = "No modification allowed", 7);
  var NOT_FOUND_ERR = ExceptionCode.NOT_FOUND_ERR = (ExceptionMessage[8] = "Not found", 8);
  var NOT_SUPPORTED_ERR = ExceptionCode.NOT_SUPPORTED_ERR = (ExceptionMessage[9] = "Not supported", 9);
  var INUSE_ATTRIBUTE_ERR = ExceptionCode.INUSE_ATTRIBUTE_ERR = (ExceptionMessage[10] = "Attribute in use", 10); //level2

  var INVALID_STATE_ERR = ExceptionCode.INVALID_STATE_ERR = (ExceptionMessage[11] = "Invalid state", 11);
  var SYNTAX_ERR = ExceptionCode.SYNTAX_ERR = (ExceptionMessage[12] = "Syntax error", 12);
  var INVALID_MODIFICATION_ERR = ExceptionCode.INVALID_MODIFICATION_ERR = (ExceptionMessage[13] = "Invalid modification", 13);
  var NAMESPACE_ERR = ExceptionCode.NAMESPACE_ERR = (ExceptionMessage[14] = "Invalid namespace", 14);
  var INVALID_ACCESS_ERR = ExceptionCode.INVALID_ACCESS_ERR = (ExceptionMessage[15] = "Invalid access", 15);

  function DOMException(code, message) {
    if (message instanceof Error) {
      var error = message;
    } else {
      error = this;
      Error.call(this, ExceptionMessage[code]);
      this.message = ExceptionMessage[code];
      if (Error.captureStackTrace) Error.captureStackTrace(this, DOMException);
    }

    error.code = code;
    if (message) this.message = this.message + ": " + message;
    return error;
  }
  DOMException.prototype = Error.prototype;
  copy$2(ExceptionCode, DOMException);
  /**
   * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-536297177
   * The NodeList interface provides the abstraction of an ordered collection of nodes, without defining or constraining how this collection is implemented. NodeList objects in the DOM are live.
   * The items in the NodeList are accessible via an integral index, starting from 0.
   */

  function NodeList() {}
  NodeList.prototype = {
    /**
     * The number of nodes in the list. The range of valid child node indices is 0 to length-1 inclusive.
     * @standard level1
     */
    length: 0,

    /**
     * Returns the indexth item in the collection. If index is greater than or equal to the number of nodes in the list, this returns null.
     * @standard level1
     * @param index  unsigned long 
     *   Index into the collection.
     * @return Node
     * 	The node at the indexth position in the NodeList, or null if that is not a valid index. 
     */
    item: function item(index) {
      return this[index] || null;
    },
    toString: function toString(isHTML, nodeFilter) {
      for (var buf = [], i = 0; i < this.length; i++) {
        serializeToString(this[i], buf, isHTML, nodeFilter);
      }

      return buf.join('');
    }
  };

  function LiveNodeList(node, refresh) {
    this._node = node;
    this._refresh = refresh;

    _updateLiveList(this);
  }

  function _updateLiveList(list) {
    var inc = list._node._inc || list._node.ownerDocument._inc;

    if (list._inc != inc) {
      var ls = list._refresh(list._node); //console.log(ls.length)


      __set__(list, 'length', ls.length);

      copy$2(ls, list);
      list._inc = inc;
    }
  }

  LiveNodeList.prototype.item = function (i) {
    _updateLiveList(this);

    return this[i];
  };

  _extends$1(LiveNodeList, NodeList);
  /**
   * 
   * Objects implementing the NamedNodeMap interface are used to represent collections of nodes that can be accessed by name. Note that NamedNodeMap does not inherit from NodeList; NamedNodeMaps are not maintained in any particular order. Objects contained in an object implementing NamedNodeMap may also be accessed by an ordinal index, but this is simply to allow convenient enumeration of the contents of a NamedNodeMap, and does not imply that the DOM specifies an order to these Nodes.
   * NamedNodeMap objects in the DOM are live.
   * used for attributes or DocumentType entities 
   */


  function NamedNodeMap() {}

  function _findNodeIndex(list, node) {
    var i = list.length;

    while (i--) {
      if (list[i] === node) {
        return i;
      }
    }
  }

  function _addNamedNode(el, list, newAttr, oldAttr) {
    if (oldAttr) {
      list[_findNodeIndex(list, oldAttr)] = newAttr;
    } else {
      list[list.length++] = newAttr;
    }

    if (el) {
      newAttr.ownerElement = el;
      var doc = el.ownerDocument;

      if (doc) {
        oldAttr && _onRemoveAttribute(doc, el, oldAttr);

        _onAddAttribute(doc, el, newAttr);
      }
    }
  }

  function _removeNamedNode(el, list, attr) {
    //console.log('remove attr:'+attr)
    var i = _findNodeIndex(list, attr);

    if (i >= 0) {
      var lastIndex = list.length - 1;

      while (i < lastIndex) {
        list[i] = list[++i];
      }

      list.length = lastIndex;

      if (el) {
        var doc = el.ownerDocument;

        if (doc) {
          _onRemoveAttribute(doc, el, attr);

          attr.ownerElement = null;
        }
      }
    } else {
      throw DOMException(NOT_FOUND_ERR, new Error(el.tagName + '@' + attr));
    }
  }

  NamedNodeMap.prototype = {
    length: 0,
    item: NodeList.prototype.item,
    getNamedItem: function getNamedItem(key) {
      //		if(key.indexOf(':')>0 || key == 'xmlns'){
      //			return null;
      //		}
      //console.log()
      var i = this.length;

      while (i--) {
        var attr = this[i]; //console.log(attr.nodeName,key)

        if (attr.nodeName == key) {
          return attr;
        }
      }
    },
    setNamedItem: function setNamedItem(attr) {
      var el = attr.ownerElement;

      if (el && el != this._ownerElement) {
        throw new DOMException(INUSE_ATTRIBUTE_ERR);
      }

      var oldAttr = this.getNamedItem(attr.nodeName);

      _addNamedNode(this._ownerElement, this, attr, oldAttr);

      return oldAttr;
    },

    /* returns Node */
    setNamedItemNS: function setNamedItemNS(attr) {
      // raises: WRONG_DOCUMENT_ERR,NO_MODIFICATION_ALLOWED_ERR,INUSE_ATTRIBUTE_ERR
      var el = attr.ownerElement,
          oldAttr;

      if (el && el != this._ownerElement) {
        throw new DOMException(INUSE_ATTRIBUTE_ERR);
      }

      oldAttr = this.getNamedItemNS(attr.namespaceURI, attr.localName);

      _addNamedNode(this._ownerElement, this, attr, oldAttr);

      return oldAttr;
    },

    /* returns Node */
    removeNamedItem: function removeNamedItem(key) {
      var attr = this.getNamedItem(key);

      _removeNamedNode(this._ownerElement, this, attr);

      return attr;
    },
    // raises: NOT_FOUND_ERR,NO_MODIFICATION_ALLOWED_ERR
    //for level2
    removeNamedItemNS: function removeNamedItemNS(namespaceURI, localName) {
      var attr = this.getNamedItemNS(namespaceURI, localName);

      _removeNamedNode(this._ownerElement, this, attr);

      return attr;
    },
    getNamedItemNS: function getNamedItemNS(namespaceURI, localName) {
      var i = this.length;

      while (i--) {
        var node = this[i];

        if (node.localName == localName && node.namespaceURI == namespaceURI) {
          return node;
        }
      }

      return null;
    }
  };
  /**
   * @see http://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html#ID-102161490
   */

  function DOMImplementation(
  /* Object */
  features) {
    this._features = {};

    if (features) {
      for (var feature in features) {
        this._features = features[feature];
      }
    }
  }
  DOMImplementation.prototype = {
    hasFeature: function hasFeature(
    /* string */
    feature,
    /* string */
    version) {
      var versions = this._features[feature.toLowerCase()];

      if (versions && (!version || version in versions)) {
        return true;
      } else {
        return false;
      }
    },
    // Introduced in DOM Level 2:
    createDocument: function createDocument(namespaceURI, qualifiedName, doctype) {
      // raises:INVALID_CHARACTER_ERR,NAMESPACE_ERR,WRONG_DOCUMENT_ERR
      var doc = new Document();
      doc.implementation = this;
      doc.childNodes = new NodeList();
      doc.doctype = doctype;

      if (doctype) {
        doc.appendChild(doctype);
      }

      if (qualifiedName) {
        var root = doc.createElementNS(namespaceURI, qualifiedName);
        doc.appendChild(root);
      }

      return doc;
    },
    // Introduced in DOM Level 2:
    createDocumentType: function createDocumentType(qualifiedName, publicId, systemId) {
      // raises:INVALID_CHARACTER_ERR,NAMESPACE_ERR
      var node = new DocumentType();
      node.name = qualifiedName;
      node.nodeName = qualifiedName;
      node.publicId = publicId;
      node.systemId = systemId; // Introduced in DOM Level 2:
      //readonly attribute DOMString        internalSubset;
      //TODO:..
      //  readonly attribute NamedNodeMap     entities;
      //  readonly attribute NamedNodeMap     notations;

      return node;
    }
  };
  /**
   * @see http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/core.html#ID-1950641247
   */

  function Node$1() {}
  Node$1.prototype = {
    firstChild: null,
    lastChild: null,
    previousSibling: null,
    nextSibling: null,
    attributes: null,
    parentNode: null,
    childNodes: null,
    ownerDocument: null,
    nodeValue: null,
    namespaceURI: null,
    prefix: null,
    localName: null,
    // Modified in DOM Level 2:
    insertBefore: function insertBefore(newChild, refChild) {
      //raises 
      return _insertBefore(this, newChild, refChild);
    },
    replaceChild: function replaceChild(newChild, oldChild) {
      //raises 
      this.insertBefore(newChild, oldChild);

      if (oldChild) {
        this.removeChild(oldChild);
      }
    },
    removeChild: function removeChild(oldChild) {
      return _removeChild(this, oldChild);
    },
    appendChild: function appendChild(newChild) {
      return this.insertBefore(newChild, null);
    },
    hasChildNodes: function hasChildNodes() {
      return this.firstChild != null;
    },
    cloneNode: function cloneNode(deep) {
      return _cloneNode(this.ownerDocument || this, this, deep);
    },
    // Modified in DOM Level 2:
    normalize: function normalize() {
      var child = this.firstChild;

      while (child) {
        var next = child.nextSibling;

        if (next && next.nodeType == TEXT_NODE && child.nodeType == TEXT_NODE) {
          this.removeChild(next);
          child.appendData(next.data);
        } else {
          child.normalize();
          child = next;
        }
      }
    },
    // Introduced in DOM Level 2:
    isSupported: function isSupported(feature, version) {
      return this.ownerDocument.implementation.hasFeature(feature, version);
    },
    // Introduced in DOM Level 2:
    hasAttributes: function hasAttributes() {
      return this.attributes.length > 0;
    },
    lookupPrefix: function lookupPrefix(namespaceURI) {
      var el = this;

      while (el) {
        var map = el._nsMap; //console.dir(map)

        if (map) {
          for (var n in map) {
            if (map[n] == namespaceURI) {
              return n;
            }
          }
        }

        el = el.nodeType == ATTRIBUTE_NODE ? el.ownerDocument : el.parentNode;
      }

      return null;
    },
    // Introduced in DOM Level 3:
    lookupNamespaceURI: function lookupNamespaceURI(prefix) {
      var el = this;

      while (el) {
        var map = el._nsMap; //console.dir(map)

        if (map) {
          if (prefix in map) {
            return map[prefix];
          }
        }

        el = el.nodeType == ATTRIBUTE_NODE ? el.ownerDocument : el.parentNode;
      }

      return null;
    },
    // Introduced in DOM Level 3:
    isDefaultNamespace: function isDefaultNamespace(namespaceURI) {
      var prefix = this.lookupPrefix(namespaceURI);
      return prefix == null;
    }
  };

  function _xmlEncoder(c) {
    return c == '<' && '&lt;' || c == '>' && '&gt;' || c == '&' && '&amp;' || c == '"' && '&quot;' || '&#' + c.charCodeAt() + ';';
  }

  copy$2(NodeType, Node$1);
  copy$2(NodeType, Node$1.prototype);
  /**
   * @param callback return true for continue,false for break
   * @return boolean true: break visit;
   */

  function _visitNode(node, callback) {
    if (callback(node)) {
      return true;
    }

    if (node = node.firstChild) {
      do {
        if (_visitNode(node, callback)) {
          return true;
        }
      } while (node = node.nextSibling);
    }
  }

  function Document() {}

  function _onAddAttribute(doc, el, newAttr) {
    doc && doc._inc++;
    var ns = newAttr.namespaceURI;

    if (ns == 'http://www.w3.org/2000/xmlns/') {
      //update namespace
      el._nsMap[newAttr.prefix ? newAttr.localName : ''] = newAttr.value;
    }
  }

  function _onRemoveAttribute(doc, el, newAttr, remove) {
    doc && doc._inc++;
    var ns = newAttr.namespaceURI;

    if (ns == 'http://www.w3.org/2000/xmlns/') {
      //update namespace
      delete el._nsMap[newAttr.prefix ? newAttr.localName : ''];
    }
  }

  function _onUpdateChild(doc, el, newChild) {
    if (doc && doc._inc) {
      doc._inc++; //update childNodes

      var cs = el.childNodes;

      if (newChild) {
        cs[cs.length++] = newChild;
      } else {
        //console.log(1)
        var child = el.firstChild;
        var i = 0;

        while (child) {
          cs[i++] = child;
          child = child.nextSibling;
        }

        cs.length = i;
      }
    }
  }
  /**
   * attributes;
   * children;
   * 
   * writeable properties:
   * nodeValue,Attr:value,CharacterData:data
   * prefix
   */


  function _removeChild(parentNode, child) {
    var previous = child.previousSibling;
    var next = child.nextSibling;

    if (previous) {
      previous.nextSibling = next;
    } else {
      parentNode.firstChild = next;
    }

    if (next) {
      next.previousSibling = previous;
    } else {
      parentNode.lastChild = previous;
    }

    _onUpdateChild(parentNode.ownerDocument, parentNode);

    return child;
  }
  /**
   * preformance key(refChild == null)
   */


  function _insertBefore(parentNode, newChild, nextChild) {
    var cp = newChild.parentNode;

    if (cp) {
      cp.removeChild(newChild); //remove and update
    }

    if (newChild.nodeType === DOCUMENT_FRAGMENT_NODE) {
      var newFirst = newChild.firstChild;

      if (newFirst == null) {
        return newChild;
      }

      var newLast = newChild.lastChild;
    } else {
      newFirst = newLast = newChild;
    }

    var pre = nextChild ? nextChild.previousSibling : parentNode.lastChild;
    newFirst.previousSibling = pre;
    newLast.nextSibling = nextChild;

    if (pre) {
      pre.nextSibling = newFirst;
    } else {
      parentNode.firstChild = newFirst;
    }

    if (nextChild == null) {
      parentNode.lastChild = newLast;
    } else {
      nextChild.previousSibling = newLast;
    }

    do {
      newFirst.parentNode = parentNode;
    } while (newFirst !== newLast && (newFirst = newFirst.nextSibling));

    _onUpdateChild(parentNode.ownerDocument || parentNode, parentNode); //console.log(parentNode.lastChild.nextSibling == null)


    if (newChild.nodeType == DOCUMENT_FRAGMENT_NODE) {
      newChild.firstChild = newChild.lastChild = null;
    }

    return newChild;
  }

  function _appendSingleChild(parentNode, newChild) {
    var cp = newChild.parentNode;

    if (cp) {
      var pre = parentNode.lastChild;
      cp.removeChild(newChild); //remove and update

      var pre = parentNode.lastChild;
    }

    var pre = parentNode.lastChild;
    newChild.parentNode = parentNode;
    newChild.previousSibling = pre;
    newChild.nextSibling = null;

    if (pre) {
      pre.nextSibling = newChild;
    } else {
      parentNode.firstChild = newChild;
    }

    parentNode.lastChild = newChild;

    _onUpdateChild(parentNode.ownerDocument, parentNode, newChild);

    return newChild; //console.log("__aa",parentNode.lastChild.nextSibling == null)
  }

  Document.prototype = {
    //implementation : null,
    nodeName: '#document',
    nodeType: DOCUMENT_NODE,
    doctype: null,
    documentElement: null,
    _inc: 1,
    insertBefore: function insertBefore(newChild, refChild) {
      //raises 
      if (newChild.nodeType == DOCUMENT_FRAGMENT_NODE) {
        var child = newChild.firstChild;

        while (child) {
          var next = child.nextSibling;
          this.insertBefore(child, refChild);
          child = next;
        }

        return newChild;
      }

      if (this.documentElement == null && newChild.nodeType == ELEMENT_NODE) {
        this.documentElement = newChild;
      }

      return _insertBefore(this, newChild, refChild), newChild.ownerDocument = this, newChild;
    },
    removeChild: function removeChild(oldChild) {
      if (this.documentElement == oldChild) {
        this.documentElement = null;
      }

      return _removeChild(this, oldChild);
    },
    // Introduced in DOM Level 2:
    importNode: function importNode(importedNode, deep) {
      return _importNode(this, importedNode, deep);
    },
    // Introduced in DOM Level 2:
    getElementById: function getElementById(id) {
      var rtv = null;

      _visitNode(this.documentElement, function (node) {
        if (node.nodeType == ELEMENT_NODE) {
          if (node.getAttribute('id') == id) {
            rtv = node;
            return true;
          }
        }
      });

      return rtv;
    },
    //document factory method:
    createElement: function createElement(tagName) {
      var node = new Element$1();
      node.ownerDocument = this;
      node.nodeName = tagName;
      node.tagName = tagName;
      node.childNodes = new NodeList();
      var attrs = node.attributes = new NamedNodeMap();
      attrs._ownerElement = node;
      return node;
    },
    createDocumentFragment: function createDocumentFragment() {
      var node = new DocumentFragment();
      node.ownerDocument = this;
      node.childNodes = new NodeList();
      return node;
    },
    createTextNode: function createTextNode(data) {
      var node = new Text();
      node.ownerDocument = this;
      node.appendData(data);
      return node;
    },
    createComment: function createComment(data) {
      var node = new Comment();
      node.ownerDocument = this;
      node.appendData(data);
      return node;
    },
    createCDATASection: function createCDATASection(data) {
      var node = new CDATASection();
      node.ownerDocument = this;
      node.appendData(data);
      return node;
    },
    createProcessingInstruction: function createProcessingInstruction(target, data) {
      var node = new ProcessingInstruction();
      node.ownerDocument = this;
      node.tagName = node.target = target;
      node.nodeValue = node.data = data;
      return node;
    },
    createAttribute: function createAttribute(name) {
      var node = new Attr();
      node.ownerDocument = this;
      node.name = name;
      node.nodeName = name;
      node.localName = name;
      node.specified = true;
      return node;
    },
    createEntityReference: function createEntityReference(name) {
      var node = new EntityReference();
      node.ownerDocument = this;
      node.nodeName = name;
      return node;
    },
    // Introduced in DOM Level 2:
    createElementNS: function createElementNS(namespaceURI, qualifiedName) {
      var node = new Element$1();
      var pl = qualifiedName.split(':');
      var attrs = node.attributes = new NamedNodeMap();
      node.childNodes = new NodeList();
      node.ownerDocument = this;
      node.nodeName = qualifiedName;
      node.tagName = qualifiedName;
      node.namespaceURI = namespaceURI;

      if (pl.length == 2) {
        node.prefix = pl[0];
        node.localName = pl[1];
      } else {
        //el.prefix = null;
        node.localName = qualifiedName;
      }

      attrs._ownerElement = node;
      return node;
    },
    // Introduced in DOM Level 2:
    createAttributeNS: function createAttributeNS(namespaceURI, qualifiedName) {
      var node = new Attr();
      var pl = qualifiedName.split(':');
      node.ownerDocument = this;
      node.nodeName = qualifiedName;
      node.name = qualifiedName;
      node.namespaceURI = namespaceURI;
      node.specified = true;

      if (pl.length == 2) {
        node.prefix = pl[0];
        node.localName = pl[1];
      } else {
        //el.prefix = null;
        node.localName = qualifiedName;
      }

      return node;
    }
  };

  _extends$1(Document, Node$1);

  function Element$1() {
    this._nsMap = {};
  }
  Element$1.prototype = {
    nodeType: ELEMENT_NODE,
    hasAttribute: function hasAttribute(name) {
      return this.getAttributeNode(name) != null;
    },
    getAttribute: function getAttribute(name) {
      var attr = this.getAttributeNode(name);
      return attr && attr.value || '';
    },
    getAttributeNode: function getAttributeNode(name) {
      return this.attributes.getNamedItem(name);
    },
    setAttribute: function setAttribute(name, value) {
      var attr = this.ownerDocument.createAttribute(name);
      attr.value = attr.nodeValue = "" + value;
      this.setAttributeNode(attr);
    },
    removeAttribute: function removeAttribute(name) {
      var attr = this.getAttributeNode(name);
      attr && this.removeAttributeNode(attr);
    },
    //four real opeartion method
    appendChild: function appendChild(newChild) {
      if (newChild.nodeType === DOCUMENT_FRAGMENT_NODE) {
        return this.insertBefore(newChild, null);
      } else {
        return _appendSingleChild(this, newChild);
      }
    },
    setAttributeNode: function setAttributeNode(newAttr) {
      return this.attributes.setNamedItem(newAttr);
    },
    setAttributeNodeNS: function setAttributeNodeNS(newAttr) {
      return this.attributes.setNamedItemNS(newAttr);
    },
    removeAttributeNode: function removeAttributeNode(oldAttr) {
      //console.log(this == oldAttr.ownerElement)
      return this.attributes.removeNamedItem(oldAttr.nodeName);
    },
    //get real attribute name,and remove it by removeAttributeNode
    removeAttributeNS: function removeAttributeNS(namespaceURI, localName) {
      var old = this.getAttributeNodeNS(namespaceURI, localName);
      old && this.removeAttributeNode(old);
    },
    hasAttributeNS: function hasAttributeNS(namespaceURI, localName) {
      return this.getAttributeNodeNS(namespaceURI, localName) != null;
    },
    getAttributeNS: function getAttributeNS(namespaceURI, localName) {
      var attr = this.getAttributeNodeNS(namespaceURI, localName);
      return attr && attr.value || '';
    },
    setAttributeNS: function setAttributeNS(namespaceURI, qualifiedName, value) {
      var attr = this.ownerDocument.createAttributeNS(namespaceURI, qualifiedName);
      attr.value = attr.nodeValue = "" + value;
      this.setAttributeNode(attr);
    },
    getAttributeNodeNS: function getAttributeNodeNS(namespaceURI, localName) {
      return this.attributes.getNamedItemNS(namespaceURI, localName);
    },
    getElementsByTagName: function getElementsByTagName(tagName) {
      return new LiveNodeList(this, function (base) {
        var ls = [];

        _visitNode(base, function (node) {
          if (node !== base && node.nodeType == ELEMENT_NODE && (tagName === '*' || node.tagName == tagName)) {
            ls.push(node);
          }
        });

        return ls;
      });
    },
    getElementsByTagNameNS: function getElementsByTagNameNS(namespaceURI, localName) {
      return new LiveNodeList(this, function (base) {
        var ls = [];

        _visitNode(base, function (node) {
          if (node !== base && node.nodeType === ELEMENT_NODE && (namespaceURI === '*' || node.namespaceURI === namespaceURI) && (localName === '*' || node.localName == localName)) {
            ls.push(node);
          }
        });

        return ls;
      });
    }
  };
  Document.prototype.getElementsByTagName = Element$1.prototype.getElementsByTagName;
  Document.prototype.getElementsByTagNameNS = Element$1.prototype.getElementsByTagNameNS;

  _extends$1(Element$1, Node$1);

  function Attr() {}
  Attr.prototype.nodeType = ATTRIBUTE_NODE;

  _extends$1(Attr, Node$1);

  function CharacterData() {}
  CharacterData.prototype = {
    data: '',
    substringData: function substringData(offset, count) {
      return this.data.substring(offset, offset + count);
    },
    appendData: function appendData(text) {
      text = this.data + text;
      this.nodeValue = this.data = text;
      this.length = text.length;
    },
    insertData: function insertData(offset, text) {
      this.replaceData(offset, 0, text);
    },
    appendChild: function appendChild(newChild) {
      throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR]);
    },
    deleteData: function deleteData(offset, count) {
      this.replaceData(offset, count, "");
    },
    replaceData: function replaceData(offset, count, text) {
      var start = this.data.substring(0, offset);
      var end = this.data.substring(offset + count);
      text = start + text + end;
      this.nodeValue = this.data = text;
      this.length = text.length;
    }
  };

  _extends$1(CharacterData, Node$1);

  function Text() {}
  Text.prototype = {
    nodeName: "#text",
    nodeType: TEXT_NODE,
    splitText: function splitText(offset) {
      var text = this.data;
      var newText = text.substring(offset);
      text = text.substring(0, offset);
      this.data = this.nodeValue = text;
      this.length = text.length;
      var newNode = this.ownerDocument.createTextNode(newText);

      if (this.parentNode) {
        this.parentNode.insertBefore(newNode, this.nextSibling);
      }

      return newNode;
    }
  };

  _extends$1(Text, CharacterData);

  function Comment() {}
  Comment.prototype = {
    nodeName: "#comment",
    nodeType: COMMENT_NODE
  };

  _extends$1(Comment, CharacterData);

  function CDATASection() {}
  CDATASection.prototype = {
    nodeName: "#cdata-section",
    nodeType: CDATA_SECTION_NODE
  };

  _extends$1(CDATASection, CharacterData);

  function DocumentType() {}
  DocumentType.prototype.nodeType = DOCUMENT_TYPE_NODE;

  _extends$1(DocumentType, Node$1);

  function Notation() {}
  Notation.prototype.nodeType = NOTATION_NODE;

  _extends$1(Notation, Node$1);

  function Entity() {}
  Entity.prototype.nodeType = ENTITY_NODE;

  _extends$1(Entity, Node$1);

  function EntityReference() {}
  EntityReference.prototype.nodeType = ENTITY_REFERENCE_NODE;

  _extends$1(EntityReference, Node$1);

  function DocumentFragment() {}
  DocumentFragment.prototype.nodeName = "#document-fragment";
  DocumentFragment.prototype.nodeType = DOCUMENT_FRAGMENT_NODE;

  _extends$1(DocumentFragment, Node$1);

  function ProcessingInstruction() {}

  ProcessingInstruction.prototype.nodeType = PROCESSING_INSTRUCTION_NODE;

  _extends$1(ProcessingInstruction, Node$1);

  function XMLSerializer$1() {}

  XMLSerializer$1.prototype.serializeToString = function (node, isHtml, nodeFilter) {
    return nodeSerializeToString.call(node, isHtml, nodeFilter);
  };

  Node$1.prototype.toString = nodeSerializeToString;

  function nodeSerializeToString(isHtml, nodeFilter) {
    var buf = [];
    var refNode = this.nodeType == 9 ? this.documentElement : this;
    var prefix = refNode.prefix;
    var uri = refNode.namespaceURI;

    if (uri && prefix == null) {
      //console.log(prefix)
      var prefix = refNode.lookupPrefix(uri);

      if (prefix == null) {
        //isHTML = true;
        var visibleNamespaces = [{
          namespace: uri,
          prefix: null
        } //{namespace:uri,prefix:''}
        ];
      }
    }

    serializeToString(this, buf, isHtml, nodeFilter, visibleNamespaces); //console.log('###',this.nodeType,uri,prefix,buf.join(''))

    return buf.join('');
  }

  function needNamespaceDefine(node, isHTML, visibleNamespaces) {
    var prefix = node.prefix || '';
    var uri = node.namespaceURI;

    if (!prefix && !uri) {
      return false;
    }

    if (prefix === "xml" && uri === "http://www.w3.org/XML/1998/namespace" || uri == 'http://www.w3.org/2000/xmlns/') {
      return false;
    }

    var i = visibleNamespaces.length; //console.log('@@@@',node.tagName,prefix,uri,visibleNamespaces)

    while (i--) {
      var ns = visibleNamespaces[i]; // get namespace prefix
      //console.log(node.nodeType,node.tagName,ns.prefix,prefix)

      if (ns.prefix == prefix) {
        return ns.namespace != uri;
      }
    } //console.log(isHTML,uri,prefix=='')
    //if(isHTML && prefix ==null && uri == 'http://www.w3.org/1999/xhtml'){
    //	return false;
    //}
    //node.flag = '11111'
    //console.error(3,true,node.flag,node.prefix,node.namespaceURI)


    return true;
  }

  function serializeToString(node, buf, isHTML, nodeFilter, visibleNamespaces) {
    if (nodeFilter) {
      node = nodeFilter(node);

      if (node) {
        if (typeof node == 'string') {
          buf.push(node);
          return;
        }
      } else {
        return;
      } //buf.sort.apply(attrs, attributeSorter);

    }

    switch (node.nodeType) {
      case ELEMENT_NODE:
        if (!visibleNamespaces) visibleNamespaces = [];
        var startVisibleNamespaces = visibleNamespaces.length;
        var attrs = node.attributes;
        var len = attrs.length;
        var child = node.firstChild;
        var nodeName = node.tagName;
        isHTML = htmlns === node.namespaceURI || isHTML;
        buf.push('<', nodeName);

        for (var i = 0; i < len; i++) {
          // add namespaces for attributes
          var attr = attrs.item(i);

          if (attr.prefix == 'xmlns') {
            visibleNamespaces.push({
              prefix: attr.localName,
              namespace: attr.value
            });
          } else if (attr.nodeName == 'xmlns') {
            visibleNamespaces.push({
              prefix: '',
              namespace: attr.value
            });
          }
        }

        for (var i = 0; i < len; i++) {
          var attr = attrs.item(i);

          if (needNamespaceDefine(attr, isHTML, visibleNamespaces)) {
            var prefix = attr.prefix || '';
            var uri = attr.namespaceURI;
            var ns = prefix ? ' xmlns:' + prefix : " xmlns";
            buf.push(ns, '="', uri, '"');
            visibleNamespaces.push({
              prefix: prefix,
              namespace: uri
            });
          }

          serializeToString(attr, buf, isHTML, nodeFilter, visibleNamespaces);
        } // add namespace for current node		


        if (needNamespaceDefine(node, isHTML, visibleNamespaces)) {
          var prefix = node.prefix || '';
          var uri = node.namespaceURI;
          var ns = prefix ? ' xmlns:' + prefix : " xmlns";
          buf.push(ns, '="', uri, '"');
          visibleNamespaces.push({
            prefix: prefix,
            namespace: uri
          });
        }

        if (child || isHTML && !/^(?:meta|link|img|br|hr|input)$/i.test(nodeName)) {
          buf.push('>'); //if is cdata child node

          if (isHTML && /^script$/i.test(nodeName)) {
            while (child) {
              if (child.data) {
                buf.push(child.data);
              } else {
                serializeToString(child, buf, isHTML, nodeFilter, visibleNamespaces);
              }

              child = child.nextSibling;
            }
          } else {
            while (child) {
              serializeToString(child, buf, isHTML, nodeFilter, visibleNamespaces);
              child = child.nextSibling;
            }
          }

          buf.push('</', nodeName, '>');
        } else {
          buf.push('/>');
        } // remove added visible namespaces
        //visibleNamespaces.length = startVisibleNamespaces;


        return;

      case DOCUMENT_NODE:
      case DOCUMENT_FRAGMENT_NODE:
        var child = node.firstChild;

        while (child) {
          serializeToString(child, buf, isHTML, nodeFilter, visibleNamespaces);
          child = child.nextSibling;
        }

        return;

      case ATTRIBUTE_NODE:
        return buf.push(' ', node.name, '="', node.value.replace(/[<&"]/g, _xmlEncoder), '"');

      case TEXT_NODE:
        return buf.push(node.data.replace(/[<&]/g, _xmlEncoder));

      case CDATA_SECTION_NODE:
        return buf.push('<![CDATA[', node.data, ']]>');

      case COMMENT_NODE:
        return buf.push("<!--", node.data, "-->");

      case DOCUMENT_TYPE_NODE:
        var pubid = node.publicId;
        var sysid = node.systemId;
        buf.push('<!DOCTYPE ', node.name);

        if (pubid) {
          buf.push(' PUBLIC "', pubid);

          if (sysid && sysid != '.') {
            buf.push('" "', sysid);
          }

          buf.push('">');
        } else if (sysid && sysid != '.') {
          buf.push(' SYSTEM "', sysid, '">');
        } else {
          var sub = node.internalSubset;

          if (sub) {
            buf.push(" [", sub, "]");
          }

          buf.push(">");
        }

        return;

      case PROCESSING_INSTRUCTION_NODE:
        return buf.push("<?", node.target, " ", node.data, "?>");

      case ENTITY_REFERENCE_NODE:
        return buf.push('&', node.nodeName, ';');
      //case ENTITY_NODE:
      //case NOTATION_NODE:

      default:
        buf.push('??', node.nodeName);
    }
  }

  function _importNode(doc, node, deep) {
    var node2;

    switch (node.nodeType) {
      case ELEMENT_NODE:
        node2 = node.cloneNode(false);
        node2.ownerDocument = doc;
      //var attrs = node2.attributes;
      //var len = attrs.length;
      //for(var i=0;i<len;i++){
      //node2.setAttributeNodeNS(importNode(doc,attrs.item(i),deep));
      //}

      case DOCUMENT_FRAGMENT_NODE:
        break;

      case ATTRIBUTE_NODE:
        deep = true;
        break;
      //case ENTITY_REFERENCE_NODE:
      //case PROCESSING_INSTRUCTION_NODE:
      ////case TEXT_NODE:
      //case CDATA_SECTION_NODE:
      //case COMMENT_NODE:
      //	deep = false;
      //	break;
      //case DOCUMENT_NODE:
      //case DOCUMENT_TYPE_NODE:
      //cannot be imported.
      //case ENTITY_NODE:
      //case NOTATION_NODE
      //can not hit in level3
      //default:throw e;
    }

    if (!node2) {
      node2 = node.cloneNode(false); //false
    }

    node2.ownerDocument = doc;
    node2.parentNode = null;

    if (deep) {
      var child = node.firstChild;

      while (child) {
        node2.appendChild(_importNode(doc, child, deep));
        child = child.nextSibling;
      }
    }

    return node2;
  } //
  //var _relationMap = {firstChild:1,lastChild:1,previousSibling:1,nextSibling:1,
  //					attributes:1,childNodes:1,parentNode:1,documentElement:1,doctype,};


  function _cloneNode(doc, node, deep) {
    var node2 = new node.constructor();

    for (var n in node) {
      var v = node[n];

      if (_typeof(v) != 'object') {
        if (v != node2[n]) {
          node2[n] = v;
        }
      }
    }

    if (node.childNodes) {
      node2.childNodes = new NodeList();
    }

    node2.ownerDocument = doc;

    switch (node2.nodeType) {
      case ELEMENT_NODE:
        var attrs = node.attributes;
        var attrs2 = node2.attributes = new NamedNodeMap();
        var len = attrs.length;
        attrs2._ownerElement = node2;

        for (var i = 0; i < len; i++) {
          node2.setAttributeNode(_cloneNode(doc, attrs.item(i), true));
        }

        break;

      case ATTRIBUTE_NODE:
        deep = true;
    }

    if (deep) {
      var child = node.firstChild;

      while (child) {
        node2.appendChild(_cloneNode(doc, child, deep));
        child = child.nextSibling;
      }
    }

    return node2;
  }

  function __set__(object, key, value) {
    object[key] = value;
  } //do dynamic


  try {
    if (Object.defineProperty) {
      var getTextContent = function getTextContent(node) {
        switch (node.nodeType) {
          case ELEMENT_NODE:
          case DOCUMENT_FRAGMENT_NODE:
            var buf = [];
            node = node.firstChild;

            while (node) {
              if (node.nodeType !== 7 && node.nodeType !== 8) {
                buf.push(getTextContent(node));
              }

              node = node.nextSibling;
            }

            return buf.join('');

          default:
            return node.nodeValue;
        }
      };

      Object.defineProperty(LiveNodeList.prototype, 'length', {
        get: function get() {
          _updateLiveList(this);

          return this.$$length;
        }
      });
      Object.defineProperty(Node$1.prototype, 'textContent', {
        get: function get() {
          return getTextContent(this);
        },
        set: function set(data) {
          switch (this.nodeType) {
            case ELEMENT_NODE:
            case DOCUMENT_FRAGMENT_NODE:
              while (this.firstChild) {
                this.removeChild(this.firstChild);
              }

              if (data || String(data)) {
                this.appendChild(this.ownerDocument.createTextNode(data));
              }

              break;

            default:
              //TODO:
              this.data = data;
              this.value = data;
              this.nodeValue = data;
          }
        }
      });

      __set__ = function __set__(object, key, value) {
        //console.log(value)
        object['$$' + key] = value;
      };
    }
  } catch (e) {} //ie8
  //if(typeof require == 'function'){


  var DOMImplementation_1 = DOMImplementation;
  var XMLSerializer_1 = XMLSerializer$1; //}

  var dom = {
    DOMImplementation: DOMImplementation_1,
    XMLSerializer: XMLSerializer_1
  };

  var domParser = createCommonjsModule(function (module, exports) {
    function DOMParser(options) {
      this.options = options || {
        locator: {}
      };
    }

    DOMParser.prototype.parseFromString = function (source, mimeType) {
      var options = this.options;
      var sax = new XMLReader();
      var domBuilder = options.domBuilder || new DOMHandler(); //contentHandler and LexicalHandler

      var errorHandler = options.errorHandler;
      var locator = options.locator;
      var defaultNSMap = options.xmlns || {};
      var entityMap = {
        'lt': '<',
        'gt': '>',
        'amp': '&',
        'quot': '"',
        'apos': "'"
      };

      if (locator) {
        domBuilder.setDocumentLocator(locator);
      }

      sax.errorHandler = buildErrorHandler(errorHandler, domBuilder, locator);
      sax.domBuilder = options.domBuilder || domBuilder;

      if (/\/x?html?$/.test(mimeType)) {
        entityMap.nbsp = '\xa0';
        entityMap.copy = '\xa9';
        defaultNSMap[''] = 'http://www.w3.org/1999/xhtml';
      }

      defaultNSMap.xml = defaultNSMap.xml || 'http://www.w3.org/XML/1998/namespace';

      if (source) {
        sax.parse(source, defaultNSMap, entityMap);
      } else {
        sax.errorHandler.error("invalid doc source");
      }

      return domBuilder.doc;
    };

    function buildErrorHandler(errorImpl, domBuilder, locator) {
      if (!errorImpl) {
        if (domBuilder instanceof DOMHandler) {
          return domBuilder;
        }

        errorImpl = domBuilder;
      }

      var errorHandler = {};
      var isCallback = errorImpl instanceof Function;
      locator = locator || {};

      function build(key) {
        var fn = errorImpl[key];

        if (!fn && isCallback) {
          fn = errorImpl.length == 2 ? function (msg) {
            errorImpl(key, msg);
          } : errorImpl;
        }

        errorHandler[key] = fn && function (msg) {
          fn('[xmldom ' + key + ']\t' + msg + _locator(locator));
        } || function () {};
      }

      build('warning');
      build('error');
      build('fatalError');
      return errorHandler;
    } //console.log('#\n\n\n\n\n\n\n####')

    /**
     * +ContentHandler+ErrorHandler
     * +LexicalHandler+EntityResolver2
     * -DeclHandler-DTDHandler 
     * 
     * DefaultHandler:EntityResolver, DTDHandler, ContentHandler, ErrorHandler
     * DefaultHandler2:DefaultHandler,LexicalHandler, DeclHandler, EntityResolver2
     * @link http://www.saxproject.org/apidoc/org/xml/sax/helpers/DefaultHandler.html
     */


    function DOMHandler() {
      this.cdata = false;
    }

    function position(locator, node) {
      node.lineNumber = locator.lineNumber;
      node.columnNumber = locator.columnNumber;
    }
    /**
     * @see org.xml.sax.ContentHandler#startDocument
     * @link http://www.saxproject.org/apidoc/org/xml/sax/ContentHandler.html
     */


    DOMHandler.prototype = {
      startDocument: function startDocument() {
        this.doc = new DOMImplementation().createDocument(null, null, null);

        if (this.locator) {
          this.doc.documentURI = this.locator.systemId;
        }
      },
      startElement: function startElement(namespaceURI, localName, qName, attrs) {
        var doc = this.doc;
        var el = doc.createElementNS(namespaceURI, qName || localName);
        var len = attrs.length;
        appendElement(this, el);
        this.currentElement = el;
        this.locator && position(this.locator, el);

        for (var i = 0; i < len; i++) {
          var namespaceURI = attrs.getURI(i);
          var value = attrs.getValue(i);
          var qName = attrs.getQName(i);
          var attr = doc.createAttributeNS(namespaceURI, qName);
          this.locator && position(attrs.getLocator(i), attr);
          attr.value = attr.nodeValue = value;
          el.setAttributeNode(attr);
        }
      },
      endElement: function endElement(namespaceURI, localName, qName) {
        var current = this.currentElement;
        var tagName = current.tagName;
        this.currentElement = current.parentNode;
      },
      startPrefixMapping: function startPrefixMapping(prefix, uri) {},
      endPrefixMapping: function endPrefixMapping(prefix) {},
      processingInstruction: function processingInstruction(target, data) {
        var ins = this.doc.createProcessingInstruction(target, data);
        this.locator && position(this.locator, ins);
        appendElement(this, ins);
      },
      ignorableWhitespace: function ignorableWhitespace(ch, start, length) {},
      characters: function characters(chars, start, length) {
        chars = _toString.apply(this, arguments); //console.log(chars)

        if (chars) {
          if (this.cdata) {
            var charNode = this.doc.createCDATASection(chars);
          } else {
            var charNode = this.doc.createTextNode(chars);
          }

          if (this.currentElement) {
            this.currentElement.appendChild(charNode);
          } else if (/^\s*$/.test(chars)) {
            this.doc.appendChild(charNode); //process xml
          }

          this.locator && position(this.locator, charNode);
        }
      },
      skippedEntity: function skippedEntity(name) {},
      endDocument: function endDocument() {
        this.doc.normalize();
      },
      setDocumentLocator: function setDocumentLocator(locator) {
        if (this.locator = locator) {
          // && !('lineNumber' in locator)){
          locator.lineNumber = 0;
        }
      },
      //LexicalHandler
      comment: function comment(chars, start, length) {
        chars = _toString.apply(this, arguments);
        var comm = this.doc.createComment(chars);
        this.locator && position(this.locator, comm);
        appendElement(this, comm);
      },
      startCDATA: function startCDATA() {
        //used in characters() methods
        this.cdata = true;
      },
      endCDATA: function endCDATA() {
        this.cdata = false;
      },
      startDTD: function startDTD(name, publicId, systemId) {
        var impl = this.doc.implementation;

        if (impl && impl.createDocumentType) {
          var dt = impl.createDocumentType(name, publicId, systemId);
          this.locator && position(this.locator, dt);
          appendElement(this, dt);
        }
      },

      /**
       * @see org.xml.sax.ErrorHandler
       * @link http://www.saxproject.org/apidoc/org/xml/sax/ErrorHandler.html
       */
      warning: function warning(error) {
        console.warn('[xmldom warning]\t' + error, _locator(this.locator));
      },
      error: function error(_error) {
        console.error('[xmldom error]\t' + _error, _locator(this.locator));
      },
      fatalError: function fatalError(error) {
        console.error('[xmldom fatalError]\t' + error, _locator(this.locator));
        throw error;
      }
    };

    function _locator(l) {
      if (l) {
        return '\n@' + (l.systemId || '') + '#[line:' + l.lineNumber + ',col:' + l.columnNumber + ']';
      }
    }

    function _toString(chars, start, length) {
      if (typeof chars == 'string') {
        return chars.substr(start, length);
      } else {
        //java sax connect width xmldom on rhino(what about: "? && !(chars instanceof String)")
        if (chars.length >= start + length || start) {
          return new java.lang.String(chars, start, length) + '';
        }

        return chars;
      }
    }
    /*
     * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/LexicalHandler.html
     * used method of org.xml.sax.ext.LexicalHandler:
     *  #comment(chars, start, length)
     *  #startCDATA()
     *  #endCDATA()
     *  #startDTD(name, publicId, systemId)
     *
     *
     * IGNORED method of org.xml.sax.ext.LexicalHandler:
     *  #endDTD()
     *  #startEntity(name)
     *  #endEntity(name)
     *
     *
     * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/DeclHandler.html
     * IGNORED method of org.xml.sax.ext.DeclHandler
     * 	#attributeDecl(eName, aName, type, mode, value)
     *  #elementDecl(name, model)
     *  #externalEntityDecl(name, publicId, systemId)
     *  #internalEntityDecl(name, value)
     * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/EntityResolver2.html
     * IGNORED method of org.xml.sax.EntityResolver2
     *  #resolveEntity(String name,String publicId,String baseURI,String systemId)
     *  #resolveEntity(publicId, systemId)
     *  #getExternalSubset(name, baseURI)
     * @link http://www.saxproject.org/apidoc/org/xml/sax/DTDHandler.html
     * IGNORED method of org.xml.sax.DTDHandler
     *  #notationDecl(name, publicId, systemId) {};
     *  #unparsedEntityDecl(name, publicId, systemId, notationName) {};
     */


    "endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g, function (key) {
      DOMHandler.prototype[key] = function () {
        return null;
      };
    });
    /* Private static helpers treated below as private instance methods, so don't need to add these to the public API; we might use a Relator to also get rid of non-standard public properties */

    function appendElement(hander, node) {
      if (!hander.currentElement) {
        hander.doc.appendChild(node);
      } else {
        hander.currentElement.appendChild(node);
      }
    } //appendChild and setAttributeNS are preformance key
    //if(typeof require == 'function'){


    var XMLReader = sax.XMLReader;
    var DOMImplementation = exports.DOMImplementation = dom.DOMImplementation;
    exports.XMLSerializer = dom.XMLSerializer;
    exports.DOMParser = DOMParser; //}
  });
  var domParser_1 = domParser.DOMImplementation;
  var domParser_2 = domParser.XMLSerializer;
  var domParser_3 = domParser.DOMParser;

  /*
   * canvg.js - Javascript SVG parser and renderer on Canvas
   * MIT Licensed
   * Gabe Lerner (gabelerner@gmail.com)
   * http://code.google.com/p/canvg/
   *
   * Requires: rgbcolor.js - http://www.phpied.com/rgb-color-parser-in-javascript/
   */

  /*
  canvg(target, s)
    empty parameters: replace all 'svg' elements on page with 'canvas' elements
    target: canvas element or the id of a canvas element
    s: svg string, url to svg file, or xml document
    opts: optional hash of options
      ignoreMouse: true => ignore mouse events
      ignoreAnimation: true => ignore animations
      ignoreDimensions: true => does not try to resize canvas
      ignoreClear: true => does not clear canvas
      offsetX: int => draws at a x offset
      offsetY: int => draws at a y offset
      scaleWidth: int => scales horizontally to width
      scaleHeight: int => scales vertically to height
      renderCallback: function => will call the function after the first render is completed
      forceRedraw: function => will call the function on every frame, if it returns true, will redraw
  */


  function canvg(target, s, opts) {
    // no parameters
    if (target == null && s == null && opts == null) {
      var svgTags = document.querySelectorAll('svg');

      for (var i = 0; i < svgTags.length; i++) {
        var svgTag = svgTags[i];
        var c = document.createElement('canvas');
        c.width = svgTag.clientWidth;
        c.height = svgTag.clientHeight;
        svgTag.parentNode.insertBefore(c, svgTag);
        svgTag.parentNode.removeChild(svgTag);
        var div = document.createElement('div');
        div.appendChild(svgTag);
        canvg(c, div.innerHTML);
      }

      return;
    }

    if (typeof target == 'string') {
      target = document.getElementById(target);
    } // store class on canvas


    if (target.svg != null) target.svg.stop();
    var svg = build(opts || {}); // on i.e. 8 for flash canvas, we can't assign the property so check for it

    if (!(target.childNodes.length == 1 && target.childNodes[0].nodeName == 'OBJECT')) target.svg = svg;
    var ctx = target.getContext('2d');

    if (typeof s.documentElement != 'undefined') {
      // load from xml doc
      svg.loadXmlDoc(ctx, s);
    } else if (s.substr(0, 1) == '<') {
      // load from xml string
      svg.loadXml(ctx, s);
    } else {
      // load from url
      svg.load(ctx, s);
    }
  }

  function getMatchesSelector() {
    // see https://developer.mozilla.org/en-US/docs/Web/API/Element.matches
    var matchesSelector;

    if (typeof Element.prototype.matches != 'undefined') {
      matchesSelector = function matchesSelector(node, selector) {
        return node.matches(selector);
      };
    } else if (typeof Element.prototype.webkitMatchesSelector != 'undefined') {
      matchesSelector = function matchesSelector(node, selector) {
        return node.webkitMatchesSelector(selector);
      };
    } else if (typeof Element.prototype.mozMatchesSelector != 'undefined') {
      matchesSelector = function matchesSelector(node, selector) {
        return node.mozMatchesSelector(selector);
      };
    } else if (typeof Element.prototype.msMatchesSelector != 'undefined') {
      matchesSelector = function matchesSelector(node, selector) {
        return node.msMatchesSelector(selector);
      };
    } else if (typeof Element.prototype.oMatchesSelector != 'undefined') {
      matchesSelector = function matchesSelector(node, selector) {
        return node.oMatchesSelector(selector);
      };
    } else {
      // requires Sizzle: https://github.com/jquery/sizzle/wiki/Sizzle-Documentation
      // or jQuery: http://jquery.com/download/
      // or Zepto: http://zeptojs.com/#
      // without it, this is a ReferenceError
      if (typeof jQuery == 'function' || typeof Zepto == 'function') {
        matchesSelector = function matchesSelector(node, selector) {
          return $(node).is(selector);
        };
      }

      if (typeof matchesSelector == 'undefined') {
        matchesSelector = Sizzle.matchesSelector;
      }
    }

    return matchesSelector;
  }

  function getSelectorSpecificity(selector) {
    var typeCount = [0, 0, 0]; // slightly modified version of https://github.com/keeganstreet/specificity/blob/master/specificity.js

    var attributeRegex = /(\[[^\]]+\])/g;
    var idRegex = /(#[^\s\+>~\.\[:]+)/g;
    var classRegex = /(\.[^\s\+>~\.\[:]+)/g;
    var pseudoElementRegex = /(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi;
    var pseudoClassWithBracketsRegex = /(:[\w-]+\([^\)]*\))/gi;
    var pseudoClassRegex = /(:[^\s\+>~\.\[:]+)/g;
    var elementRegex = /([^\s\+>~\.\[:]+)/g;

    var findMatch = function findMatch(regex, type) {
      var matches = selector.match(regex);

      if (matches == null) {
        return;
      }

      typeCount[type] += matches.length;
      selector = selector.replace(regex, ' ');
    };

    selector = selector.replace(/:not\(([^\)]*)\)/g, '     $1 ');
    selector = selector.replace(/{[^]*/gm, ' ');
    findMatch(attributeRegex, 1);
    findMatch(idRegex, 0);
    findMatch(classRegex, 1);
    findMatch(pseudoElementRegex, 2);
    findMatch(pseudoClassWithBracketsRegex, 1);
    findMatch(pseudoClassRegex, 1);
    selector = selector.replace(/[\*\s\+>~]/g, ' ');
    selector = selector.replace(/[#\.]/g, ' ');
    findMatch(elementRegex, 2);
    return typeCount.join('');
  }

  function build(opts) {
    var svg = {
      opts: opts
    };
    var matchesSelector = getMatchesSelector();

    if (typeof CanvasRenderingContext2D != 'undefined') {
      CanvasRenderingContext2D.prototype.drawSvg = function (s, dx, dy, dw, dh, opts) {
        var cOpts = {
          ignoreMouse: true,
          ignoreAnimation: true,
          ignoreDimensions: true,
          ignoreClear: true,
          offsetX: dx,
          offsetY: dy,
          scaleWidth: dw,
          scaleHeight: dh
        };

        for (var prop in opts) {
          if (opts.hasOwnProperty(prop)) {
            cOpts[prop] = opts[prop];
          }
        }

        canvg(this.canvas, s, cOpts);
      };
    }

    svg.FRAMERATE = 30;
    svg.MAX_VIRTUAL_PIXELS = 30000;

    svg.log = function (msg) {};

    if (svg.opts.log == true && typeof console != 'undefined') {
      svg.log = function (msg) {
        console.log(msg);
      };
    } // globals


    svg.init = function (ctx) {
      var uniqueId = 0;

      svg.UniqueId = function () {
        uniqueId++;
        return 'canvg' + uniqueId;
      };

      svg.Definitions = {};
      svg.Styles = {};
      svg.StylesSpecificity = {};
      svg.Animations = [];
      svg.Images = [];
      svg.ctx = ctx;
      svg.ViewPort = new function () {
        this.viewPorts = [];

        this.Clear = function () {
          this.viewPorts = [];
        };

        this.SetCurrent = function (width, height) {
          this.viewPorts.push({
            width: width,
            height: height
          });
        };

        this.RemoveCurrent = function () {
          this.viewPorts.pop();
        };

        this.Current = function () {
          return this.viewPorts[this.viewPorts.length - 1];
        };

        this.width = function () {
          return this.Current().width;
        };

        this.height = function () {
          return this.Current().height;
        };

        this.ComputeSize = function (d) {
          if (d != null && typeof d == 'number') return d;
          if (d == 'x') return this.width();
          if (d == 'y') return this.height();
          return Math.sqrt(Math.pow(this.width(), 2) + Math.pow(this.height(), 2)) / Math.sqrt(2);
        };
      }();
    };

    svg.init(); // images loaded

    svg.ImagesLoaded = function () {
      for (var i = 0; i < svg.Images.length; i++) {
        if (!svg.Images[i].loaded) return false;
      }

      return true;
    }; // trim


    svg.trim = function (s) {
      return s.replace(/^\s+|\s+$/g, '');
    }; // compress spaces


    svg.compressSpaces = function (s) {
      return s.replace(/[\s\r\t\n]+/gm, ' ');
    }; // ajax


    svg.ajax = function (url) {
      var AJAX;

      if (window.XMLHttpRequest) {
        AJAX = new XMLHttpRequest();
      } else {
        AJAX = new ActiveXObject('Microsoft.XMLHTTP');
      }

      if (AJAX) {
        AJAX.open('GET', url, false);
        AJAX.send(null);
        return AJAX.responseText;
      }

      return null;
    }; // parse xml


    svg.parseXml = function (xml) {
      if (typeof Windows != 'undefined' && typeof Windows.Data != 'undefined' && typeof Windows.Data.Xml != 'undefined') {
        var xmlDoc = new Windows.Data.Xml.Dom.XmlDocument();
        var settings = new Windows.Data.Xml.Dom.XmlLoadSettings();
        settings.prohibitDtd = false;
        xmlDoc.loadXml(xml, settings);
        return xmlDoc;
      } else if (window.DOMParser) {
        var parser = new DOMParser();
        return parser.parseFromString(xml, 'text/xml');
      } else {
        xml = xml.replace(/<!DOCTYPE svg[^>]*>/, '');
        var xmlDoc = new ActiveXObject('Microsoft.XMLDOM');
        xmlDoc.async = 'false';
        xmlDoc.loadXML(xml);
        return xmlDoc;
      }
    };

    svg.Property = function (name, value) {
      this.name = name;
      this.value = value;
    };

    svg.Property.prototype.getValue = function () {
      return this.value;
    };

    svg.Property.prototype.hasValue = function () {
      return this.value != null && this.value != '';
    }; // return the numerical value of the property


    svg.Property.prototype.numValue = function () {
      if (!this.hasValue()) return 0;
      var n = parseFloat(this.value);

      if ((this.value + '').match(/%$/)) {
        n = n / 100.0;
      }

      return n;
    };

    svg.Property.prototype.valueOrDefault = function (def) {
      if (this.hasValue()) return this.value;
      return def;
    };

    svg.Property.prototype.numValueOrDefault = function (def) {
      if (this.hasValue()) return this.numValue();
      return def;
    }; // color extensions
    // augment the current color value with the opacity


    svg.Property.prototype.addOpacity = function (opacityProp) {
      var newValue = this.value;

      if (opacityProp.value != null && opacityProp.value != '' && typeof this.value == 'string') {
        // can only add opacity to colors, not patterns
        var color = new rgbcolor(this.value);

        if (color.ok) {
          newValue = 'rgba(' + color.r + ', ' + color.g + ', ' + color.b + ', ' + opacityProp.numValue() + ')';
        }
      }

      return new svg.Property(this.name, newValue);
    }; // definition extensions
    // get the definition from the definitions table


    svg.Property.prototype.getDefinition = function () {
      var name = this.value.match(/#([^\)'"]+)/);

      if (name) {
        name = name[1];
      }

      if (!name) {
        name = this.value;
      }

      return svg.Definitions[name];
    };

    svg.Property.prototype.isUrlDefinition = function () {
      return this.value.indexOf('url(') == 0;
    };

    svg.Property.prototype.getFillStyleDefinition = function (e, opacityProp) {
      var def = this.getDefinition(); // gradient

      if (def != null && def.createGradient) {
        return def.createGradient(svg.ctx, e, opacityProp);
      } // pattern


      if (def != null && def.createPattern) {
        if (def.getHrefAttribute().hasValue()) {
          var pt = def.attribute('patternTransform');
          def = def.getHrefAttribute().getDefinition();

          if (pt.hasValue()) {
            def.attribute('patternTransform', true).value = pt.value;
          }
        }

        return def.createPattern(svg.ctx, e);
      }

      return null;
    }; // length extensions


    svg.Property.prototype.getDPI = function (viewPort) {
      return 96.0; // TODO: compute?
    };

    svg.Property.prototype.getEM = function (viewPort) {
      var em = 12;
      var fontSize = new svg.Property('fontSize', svg.Font.Parse(svg.ctx.font).fontSize);
      if (fontSize.hasValue()) em = fontSize.toPixels(viewPort);
      return em;
    };

    svg.Property.prototype.getUnits = function () {
      var s = this.value + '';
      return s.replace(/[0-9\.\-]/g, '');
    }; // get the length as pixels


    svg.Property.prototype.toPixels = function (viewPort, processPercent) {
      if (!this.hasValue()) return 0;
      var s = this.value + '';
      if (s.match(/em$/)) return this.numValue() * this.getEM(viewPort);
      if (s.match(/ex$/)) return this.numValue() * this.getEM(viewPort) / 2.0;
      if (s.match(/px$/)) return this.numValue();
      if (s.match(/pt$/)) return this.numValue() * this.getDPI(viewPort) * (1.0 / 72.0);
      if (s.match(/pc$/)) return this.numValue() * 15;
      if (s.match(/cm$/)) return this.numValue() * this.getDPI(viewPort) / 2.54;
      if (s.match(/mm$/)) return this.numValue() * this.getDPI(viewPort) / 25.4;
      if (s.match(/in$/)) return this.numValue() * this.getDPI(viewPort);
      if (s.match(/%$/)) return this.numValue() * svg.ViewPort.ComputeSize(viewPort);
      var n = this.numValue();
      if (processPercent && n < 1.0) return n * svg.ViewPort.ComputeSize(viewPort);
      return n;
    }; // time extensions
    // get the time as milliseconds


    svg.Property.prototype.toMilliseconds = function () {
      if (!this.hasValue()) return 0;
      var s = this.value + '';
      if (s.match(/s$/)) return this.numValue() * 1000;
      if (s.match(/ms$/)) return this.numValue();
      return this.numValue();
    }; // angle extensions
    // get the angle as radians


    svg.Property.prototype.toRadians = function () {
      if (!this.hasValue()) return 0;
      var s = this.value + '';
      if (s.match(/deg$/)) return this.numValue() * (Math.PI / 180.0);
      if (s.match(/grad$/)) return this.numValue() * (Math.PI / 200.0);
      if (s.match(/rad$/)) return this.numValue();
      return this.numValue() * (Math.PI / 180.0);
    }; // text extensions
    // get the text baseline


    var textBaselineMapping = {
      'baseline': 'alphabetic',
      'before-edge': 'top',
      'text-before-edge': 'top',
      'middle': 'middle',
      'central': 'middle',
      'after-edge': 'bottom',
      'text-after-edge': 'bottom',
      'ideographic': 'ideographic',
      'alphabetic': 'alphabetic',
      'hanging': 'hanging',
      'mathematical': 'alphabetic'
    };

    svg.Property.prototype.toTextBaseline = function () {
      if (!this.hasValue()) return null;
      return textBaselineMapping[this.value];
    }; // fonts


    svg.Font = new function () {
      this.Styles = 'normal|italic|oblique|inherit';
      this.Variants = 'normal|small-caps|inherit';
      this.Weights = 'normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit';

      this.CreateFont = function (fontStyle, fontVariant, fontWeight, fontSize, fontFamily, inherit) {
        var f = inherit != null ? this.Parse(inherit) : this.CreateFont('', '', '', '', '', svg.ctx.font);
        return {
          fontFamily: fontFamily || f.fontFamily,
          fontSize: fontSize || f.fontSize,
          fontStyle: fontStyle || f.fontStyle,
          fontWeight: fontWeight || f.fontWeight,
          fontVariant: fontVariant || f.fontVariant,
          toString: function toString() {
            return [this.fontStyle, this.fontVariant, this.fontWeight, this.fontSize, this.fontFamily].join(' ');
          }
        };
      };

      var that = this;

      this.Parse = function (s) {
        var f = {};
        var d = svg.trim(svg.compressSpaces(s || '')).split(' ');
        var set = {
          fontSize: false,
          fontStyle: false,
          fontWeight: false,
          fontVariant: false
        };
        var ff = '';

        for (var i = 0; i < d.length; i++) {
          if (!set.fontStyle && that.Styles.indexOf(d[i]) != -1) {
            if (d[i] != 'inherit') f.fontStyle = d[i];
            set.fontStyle = true;
          } else if (!set.fontVariant && that.Variants.indexOf(d[i]) != -1) {
            if (d[i] != 'inherit') f.fontVariant = d[i];
            set.fontStyle = set.fontVariant = true;
          } else if (!set.fontWeight && that.Weights.indexOf(d[i]) != -1) {
            if (d[i] != 'inherit') f.fontWeight = d[i];
            set.fontStyle = set.fontVariant = set.fontWeight = true;
          } else if (!set.fontSize) {
            if (d[i] != 'inherit') f.fontSize = d[i].split('/')[0];
            set.fontStyle = set.fontVariant = set.fontWeight = set.fontSize = true;
          } else {
            if (d[i] != 'inherit') ff += d[i];
          }
        }

        if (ff != '') f.fontFamily = ff;
        return f;
      };
    }(); // points and paths

    svg.ToNumberArray = function (s) {
      var a = svg.trim(svg.compressSpaces((s || '').replace(/,/g, ' '))).split(' ');

      for (var i = 0; i < a.length; i++) {
        a[i] = parseFloat(a[i]);
      }

      return a;
    };

    svg.Point = function (x, y) {
      this.x = x;
      this.y = y;
    };

    svg.Point.prototype.angleTo = function (p) {
      return Math.atan2(p.y - this.y, p.x - this.x);
    };

    svg.Point.prototype.applyTransform = function (v) {
      var xp = this.x * v[0] + this.y * v[2] + v[4];
      var yp = this.x * v[1] + this.y * v[3] + v[5];
      this.x = xp;
      this.y = yp;
    };

    svg.CreatePoint = function (s) {
      var a = svg.ToNumberArray(s);
      return new svg.Point(a[0], a[1]);
    };

    svg.CreatePath = function (s) {
      var a = svg.ToNumberArray(s);
      var path = [];

      for (var i = 0; i < a.length; i += 2) {
        path.push(new svg.Point(a[i], a[i + 1]));
      }

      return path;
    }; // bounding box


    svg.BoundingBox = function (x1, y1, x2, y2) {
      // pass in initial points if you want
      this.x1 = Number.NaN;
      this.y1 = Number.NaN;
      this.x2 = Number.NaN;
      this.y2 = Number.NaN;

      this.x = function () {
        return this.x1;
      };

      this.y = function () {
        return this.y1;
      };

      this.width = function () {
        return this.x2 - this.x1;
      };

      this.height = function () {
        return this.y2 - this.y1;
      };

      this.addPoint = function (x, y) {
        if (x != null) {
          if (isNaN(this.x1) || isNaN(this.x2)) {
            this.x1 = x;
            this.x2 = x;
          }

          if (x < this.x1) this.x1 = x;
          if (x > this.x2) this.x2 = x;
        }

        if (y != null) {
          if (isNaN(this.y1) || isNaN(this.y2)) {
            this.y1 = y;
            this.y2 = y;
          }

          if (y < this.y1) this.y1 = y;
          if (y > this.y2) this.y2 = y;
        }
      };

      this.addX = function (x) {
        this.addPoint(x, null);
      };

      this.addY = function (y) {
        this.addPoint(null, y);
      };

      this.addBoundingBox = function (bb) {
        this.addPoint(bb.x1, bb.y1);
        this.addPoint(bb.x2, bb.y2);
      };

      this.addQuadraticCurve = function (p0x, p0y, p1x, p1y, p2x, p2y) {
        var cp1x = p0x + 2 / 3 * (p1x - p0x); // CP1 = QP0 + 2/3 *(QP1-QP0)

        var cp1y = p0y + 2 / 3 * (p1y - p0y); // CP1 = QP0 + 2/3 *(QP1-QP0)

        var cp2x = cp1x + 1 / 3 * (p2x - p0x); // CP2 = CP1 + 1/3 *(QP2-QP0)

        var cp2y = cp1y + 1 / 3 * (p2y - p0y); // CP2 = CP1 + 1/3 *(QP2-QP0)

        this.addBezierCurve(p0x, p0y, cp1x, cp2x, cp1y, cp2y, p2x, p2y);
      };

      this.addBezierCurve = function (p0x, p0y, p1x, p1y, p2x, p2y, p3x, p3y) {
        // from http://blog.hackers-cafe.net/2009/06/how-to-calculate-bezier-curves-bounding.html
        var p0 = [p0x, p0y],
            p1 = [p1x, p1y],
            p2 = [p2x, p2y],
            p3 = [p3x, p3y];
        this.addPoint(p0[0], p0[1]);
        this.addPoint(p3[0], p3[1]);

        for (var i = 0; i <= 1; i++) {
          var f = function f(t) {
            return Math.pow(1 - t, 3) * p0[i] + 3 * Math.pow(1 - t, 2) * t * p1[i] + 3 * (1 - t) * Math.pow(t, 2) * p2[i] + Math.pow(t, 3) * p3[i];
          };

          var b = 6 * p0[i] - 12 * p1[i] + 6 * p2[i];
          var a = -3 * p0[i] + 9 * p1[i] - 9 * p2[i] + 3 * p3[i];
          var c = 3 * p1[i] - 3 * p0[i];

          if (a == 0) {
            if (b == 0) continue;
            var t = -c / b;

            if (0 < t && t < 1) {
              if (i == 0) this.addX(f(t));
              if (i == 1) this.addY(f(t));
            }

            continue;
          }

          var b2ac = Math.pow(b, 2) - 4 * c * a;
          if (b2ac < 0) continue;
          var t1 = (-b + Math.sqrt(b2ac)) / (2 * a);

          if (0 < t1 && t1 < 1) {
            if (i == 0) this.addX(f(t1));
            if (i == 1) this.addY(f(t1));
          }

          var t2 = (-b - Math.sqrt(b2ac)) / (2 * a);

          if (0 < t2 && t2 < 1) {
            if (i == 0) this.addX(f(t2));
            if (i == 1) this.addY(f(t2));
          }
        }
      };

      this.isPointInBox = function (x, y) {
        return this.x1 <= x && x <= this.x2 && this.y1 <= y && y <= this.y2;
      };

      this.addPoint(x1, y1);
      this.addPoint(x2, y2);
    }; // transforms


    svg.Transform = function (v) {
      var that = this;
      this.Type = {}; // translate

      this.Type.translate = function (s) {
        this.p = svg.CreatePoint(s);

        this.apply = function (ctx) {
          ctx.translate(this.p.x || 0.0, this.p.y || 0.0);
        };

        this.unapply = function (ctx) {
          ctx.translate(-1.0 * this.p.x || 0.0, -1.0 * this.p.y || 0.0);
        };

        this.applyToPoint = function (p) {
          p.applyTransform([1, 0, 0, 1, this.p.x || 0.0, this.p.y || 0.0]);
        };
      }; // rotate


      this.Type.rotate = function (s) {
        var a = svg.ToNumberArray(s);
        this.angle = new svg.Property('angle', a[0]);
        this.cx = a[1] || 0;
        this.cy = a[2] || 0;

        this.apply = function (ctx) {
          ctx.translate(this.cx, this.cy);
          ctx.rotate(this.angle.toRadians());
          ctx.translate(-this.cx, -this.cy);
        };

        this.unapply = function (ctx) {
          ctx.translate(this.cx, this.cy);
          ctx.rotate(-1.0 * this.angle.toRadians());
          ctx.translate(-this.cx, -this.cy);
        };

        this.applyToPoint = function (p) {
          var a = this.angle.toRadians();
          p.applyTransform([1, 0, 0, 1, this.p.x || 0.0, this.p.y || 0.0]);
          p.applyTransform([Math.cos(a), Math.sin(a), -Math.sin(a), Math.cos(a), 0, 0]);
          p.applyTransform([1, 0, 0, 1, -this.p.x || 0.0, -this.p.y || 0.0]);
        };
      };

      this.Type.scale = function (s) {
        this.p = svg.CreatePoint(s);

        this.apply = function (ctx) {
          ctx.scale(this.p.x || 1.0, this.p.y || this.p.x || 1.0);
        };

        this.unapply = function (ctx) {
          ctx.scale(1.0 / this.p.x || 1.0, 1.0 / this.p.y || this.p.x || 1.0);
        };

        this.applyToPoint = function (p) {
          p.applyTransform([this.p.x || 0.0, 0, 0, this.p.y || 0.0, 0, 0]);
        };
      };

      this.Type.matrix = function (s) {
        this.m = svg.ToNumberArray(s);

        this.apply = function (ctx) {
          ctx.transform(this.m[0], this.m[1], this.m[2], this.m[3], this.m[4], this.m[5]);
        };

        this.unapply = function (ctx) {
          var a = this.m[0];
          var b = this.m[2];
          var c = this.m[4];
          var d = this.m[1];
          var e = this.m[3];
          var f = this.m[5];
          var g = 0.0;
          var h = 0.0;
          var i = 1.0;
          var det = 1 / (a * (e * i - f * h) - b * (d * i - f * g) + c * (d * h - e * g));
          ctx.transform(det * (e * i - f * h), det * (f * g - d * i), det * (c * h - b * i), det * (a * i - c * g), det * (b * f - c * e), det * (c * d - a * f));
        };

        this.applyToPoint = function (p) {
          p.applyTransform(this.m);
        };
      };

      this.Type.SkewBase = function (s) {
        this.base = that.Type.matrix;
        this.base(s);
        this.angle = new svg.Property('angle', s);
      };

      this.Type.SkewBase.prototype = new this.Type.matrix();

      this.Type.skewX = function (s) {
        this.base = that.Type.SkewBase;
        this.base(s);
        this.m = [1, 0, Math.tan(this.angle.toRadians()), 1, 0, 0];
      };

      this.Type.skewX.prototype = new this.Type.SkewBase();

      this.Type.skewY = function (s) {
        this.base = that.Type.SkewBase;
        this.base(s);
        this.m = [1, Math.tan(this.angle.toRadians()), 0, 1, 0, 0];
      };

      this.Type.skewY.prototype = new this.Type.SkewBase();
      this.transforms = [];

      this.apply = function (ctx) {
        for (var i = 0; i < this.transforms.length; i++) {
          this.transforms[i].apply(ctx);
        }
      };

      this.unapply = function (ctx) {
        for (var i = this.transforms.length - 1; i >= 0; i--) {
          this.transforms[i].unapply(ctx);
        }
      };

      this.applyToPoint = function (p) {
        for (var i = 0; i < this.transforms.length; i++) {
          this.transforms[i].applyToPoint(p);
        }
      };

      var data = svg.trim(svg.compressSpaces(v)).replace(/\)([a-zA-Z])/g, ') $1').replace(/\)(\s?,\s?)/g, ') ').split(/\s(?=[a-z])/);

      for (var i = 0; i < data.length; i++) {
        var type = svg.trim(data[i].split('(')[0]);
        var s = data[i].split('(')[1].replace(')', '');
        var transformType = this.Type[type];

        if (typeof transformType != 'undefined') {
          var transform = new transformType(s);
          transform.type = type;
          this.transforms.push(transform);
        }
      }
    }; // aspect ratio


    svg.AspectRatio = function (ctx, aspectRatio, width, desiredWidth, height, desiredHeight, minX, minY, refX, refY) {
      // aspect ratio - http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute
      aspectRatio = svg.compressSpaces(aspectRatio);
      aspectRatio = aspectRatio.replace(/^defer\s/, ''); // ignore defer

      var align = aspectRatio.split(' ')[0] || 'xMidYMid';
      var meetOrSlice = aspectRatio.split(' ')[1] || 'meet'; // calculate scale

      var scaleX = width / desiredWidth;
      var scaleY = height / desiredHeight;
      var scaleMin = Math.min(scaleX, scaleY);
      var scaleMax = Math.max(scaleX, scaleY);

      if (meetOrSlice == 'meet') {
        desiredWidth *= scaleMin;
        desiredHeight *= scaleMin;
      }

      if (meetOrSlice == 'slice') {
        desiredWidth *= scaleMax;
        desiredHeight *= scaleMax;
      }

      refX = new svg.Property('refX', refX);
      refY = new svg.Property('refY', refY);

      if (refX.hasValue() && refY.hasValue()) {
        ctx.translate(-scaleMin * refX.toPixels('x'), -scaleMin * refY.toPixels('y'));
      } else {
        // align
        if (align.match(/^xMid/) && (meetOrSlice == 'meet' && scaleMin == scaleY || meetOrSlice == 'slice' && scaleMax == scaleY)) ctx.translate(width / 2.0 - desiredWidth / 2.0, 0);
        if (align.match(/YMid$/) && (meetOrSlice == 'meet' && scaleMin == scaleX || meetOrSlice == 'slice' && scaleMax == scaleX)) ctx.translate(0, height / 2.0 - desiredHeight / 2.0);
        if (align.match(/^xMax/) && (meetOrSlice == 'meet' && scaleMin == scaleY || meetOrSlice == 'slice' && scaleMax == scaleY)) ctx.translate(width - desiredWidth, 0);
        if (align.match(/YMax$/) && (meetOrSlice == 'meet' && scaleMin == scaleX || meetOrSlice == 'slice' && scaleMax == scaleX)) ctx.translate(0, height - desiredHeight);
      } // scale


      if (align == 'none') ctx.scale(scaleX, scaleY);else if (meetOrSlice == 'meet') ctx.scale(scaleMin, scaleMin);else if (meetOrSlice == 'slice') ctx.scale(scaleMax, scaleMax); // translate

      ctx.translate(minX == null ? 0 : -minX, minY == null ? 0 : -minY);
    }; // elements


    svg.Element = {};
    svg.EmptyProperty = new svg.Property('EMPTY', '');

    svg.Element.ElementBase = function (node) {
      this.attributes = {};
      this.styles = {};
      this.stylesSpecificity = {};
      this.children = []; // get or create attribute

      this.attribute = function (name, createIfNotExists) {
        var a = this.attributes[name];
        if (a != null) return a;

        if (createIfNotExists == true) {
          a = new svg.Property(name, '');
          this.attributes[name] = a;
        }

        return a || svg.EmptyProperty;
      };

      this.getHrefAttribute = function () {
        for (var a in this.attributes) {
          if (a == 'href' || a.match(/:href$/)) {
            return this.attributes[a];
          }
        }

        return svg.EmptyProperty;
      }; // get or create style, crawls up node tree


      this.style = function (name, createIfNotExists, skipAncestors) {
        var s = this.styles[name];
        if (s != null) return s;
        var a = this.attribute(name);

        if (a != null && a.hasValue()) {
          this.styles[name] = a; // move up to me to cache

          return a;
        }

        if (skipAncestors != true) {
          var p = this.parent;

          if (p != null) {
            var ps = p.style(name);

            if (ps != null && ps.hasValue()) {
              return ps;
            }
          }
        }

        if (createIfNotExists == true) {
          s = new svg.Property(name, '');
          this.styles[name] = s;
        }

        return s || svg.EmptyProperty;
      }; // base render


      this.render = function (ctx) {
        // don't render display=none
        if (this.style('display').value == 'none') return; // don't render visibility=hidden

        if (this.style('visibility').value == 'hidden') return;
        ctx.save();

        if (this.style('mask').hasValue()) {
          // mask
          var mask = this.style('mask').getDefinition();
          if (mask != null) mask.apply(ctx, this);
        } else if (this.style('filter').hasValue()) {
          // filter
          var filter = this.style('filter').getDefinition();
          if (filter != null) filter.apply(ctx, this);
        } else {
          this.setContext(ctx);
          this.renderChildren(ctx);
          this.clearContext(ctx);
        }

        ctx.restore();
      }; // base set context


      this.setContext = function (ctx) {} // OVERRIDE ME!
      // base clear context
      ;

      this.clearContext = function (ctx) {} // OVERRIDE ME!
      // base render children
      ;

      this.renderChildren = function (ctx) {
        for (var i = 0; i < this.children.length; i++) {
          this.children[i].render(ctx);
        }
      };

      this.addChild = function (childNode, create) {
        var child = childNode;
        if (create) child = svg.CreateElement(childNode);
        child.parent = this;

        if (child.type != 'title') {
          this.children.push(child);
        }
      };

      this.addStylesFromStyleDefinition = function () {
        // add styles
        for (var selector in svg.Styles) {
          if (selector[0] != '@' && matchesSelector(node, selector)) {
            var styles = svg.Styles[selector];
            var specificity = svg.StylesSpecificity[selector];

            if (styles != null) {
              for (var name in styles) {
                var existingSpecificity = this.stylesSpecificity[name];

                if (typeof existingSpecificity == 'undefined') {
                  existingSpecificity = '000';
                }

                if (specificity > existingSpecificity) {
                  this.styles[name] = styles[name];
                  this.stylesSpecificity[name] = specificity;
                }
              }
            }
          }
        }
      };

      if (node != null && node.nodeType == 1) {
        //ELEMENT_NODE
        // add attributes
        for (var i = 0; i < node.attributes.length; i++) {
          var attribute = node.attributes[i];
          this.attributes[attribute.nodeName] = new svg.Property(attribute.nodeName, attribute.value);
        }

        this.addStylesFromStyleDefinition(); // add inline styles

        if (this.attribute('style').hasValue()) {
          var styles = this.attribute('style').value.split(';');

          for (var i = 0; i < styles.length; i++) {
            if (svg.trim(styles[i]) != '') {
              var style = styles[i].split(':');
              var name = svg.trim(style[0]);
              var value = svg.trim(style[1]);
              this.styles[name] = new svg.Property(name, value);
            }
          }
        } // add id


        if (this.attribute('id').hasValue()) {
          if (svg.Definitions[this.attribute('id').value] == null) {
            svg.Definitions[this.attribute('id').value] = this;
          }
        } // add children


        for (var i = 0; i < node.childNodes.length; i++) {
          var childNode = node.childNodes[i];
          if (childNode.nodeType == 1) this.addChild(childNode, true); //ELEMENT_NODE

          if (this.captureTextNodes && (childNode.nodeType == 3 || childNode.nodeType == 4)) {
            var text = childNode.value || childNode.text || childNode.textContent || '';

            if (svg.compressSpaces(text) != '') {
              this.addChild(new svg.Element.tspan(childNode), false); // TEXT_NODE
            }
          }
        }
      }
    };

    svg.Element.RenderedElementBase = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);

      this.setContext = function (ctx) {
        // fill
        if (this.style('fill').isUrlDefinition()) {
          var fs = this.style('fill').getFillStyleDefinition(this, this.style('fill-opacity'));
          if (fs != null) ctx.fillStyle = fs;
        } else if (this.style('fill').hasValue()) {
          var fillStyle = this.style('fill');
          if (fillStyle.value == 'currentColor') fillStyle.value = this.style('color').value;
          if (fillStyle.value != 'inherit') ctx.fillStyle = fillStyle.value == 'none' ? 'rgba(0,0,0,0)' : fillStyle.value;
        }

        if (this.style('fill-opacity').hasValue()) {
          var fillStyle = new svg.Property('fill', ctx.fillStyle);
          fillStyle = fillStyle.addOpacity(this.style('fill-opacity'));
          ctx.fillStyle = fillStyle.value;
        } // stroke


        if (this.style('stroke').isUrlDefinition()) {
          var fs = this.style('stroke').getFillStyleDefinition(this, this.style('stroke-opacity'));
          if (fs != null) ctx.strokeStyle = fs;
        } else if (this.style('stroke').hasValue()) {
          var strokeStyle = this.style('stroke');
          if (strokeStyle.value == 'currentColor') strokeStyle.value = this.style('color').value;
          if (strokeStyle.value != 'inherit') ctx.strokeStyle = strokeStyle.value == 'none' ? 'rgba(0,0,0,0)' : strokeStyle.value;
        }

        if (this.style('stroke-opacity').hasValue()) {
          var strokeStyle = new svg.Property('stroke', ctx.strokeStyle);
          strokeStyle = strokeStyle.addOpacity(this.style('stroke-opacity'));
          ctx.strokeStyle = strokeStyle.value;
        }

        if (this.style('stroke-width').hasValue()) {
          var newLineWidth = this.style('stroke-width').toPixels();
          ctx.lineWidth = newLineWidth == 0 ? 0.001 : newLineWidth; // browsers don't respect 0
        }

        if (this.style('stroke-linecap').hasValue()) ctx.lineCap = this.style('stroke-linecap').value;
        if (this.style('stroke-linejoin').hasValue()) ctx.lineJoin = this.style('stroke-linejoin').value;
        if (this.style('stroke-miterlimit').hasValue()) ctx.miterLimit = this.style('stroke-miterlimit').value;

        if (this.style('stroke-dasharray').hasValue() && this.style('stroke-dasharray').value != 'none') {
          var gaps = svg.ToNumberArray(this.style('stroke-dasharray').value);

          if (typeof ctx.setLineDash != 'undefined') {
            ctx.setLineDash(gaps);
          } else if (typeof ctx.webkitLineDash != 'undefined') {
            ctx.webkitLineDash = gaps;
          } else if (typeof ctx.mozDash != 'undefined' && !(gaps.length == 1 && gaps[0] == 0)) {
            ctx.mozDash = gaps;
          }

          var offset = this.style('stroke-dashoffset').numValueOrDefault(1);

          if (typeof ctx.lineDashOffset != 'undefined') {
            ctx.lineDashOffset = offset;
          } else if (typeof ctx.webkitLineDashOffset != 'undefined') {
            ctx.webkitLineDashOffset = offset;
          } else if (typeof ctx.mozDashOffset != 'undefined') {
            ctx.mozDashOffset = offset;
          }
        } // font


        if (typeof ctx.font != 'undefined') {
          ctx.font = svg.Font.CreateFont(this.style('font-style').value, this.style('font-variant').value, this.style('font-weight').value, this.style('font-size').hasValue() ? this.style('font-size').toPixels() + 'px' : '', this.style('font-family').value).toString();
        } // transform


        if (this.style('transform', false, true).hasValue()) {
          var transform = new svg.Transform(this.style('transform', false, true).value);
          transform.apply(ctx);
        } // clip


        if (this.style('clip-path', false, true).hasValue()) {
          var clip = this.style('clip-path', false, true).getDefinition();
          if (clip != null) clip.apply(ctx);
        } // opacity


        if (this.style('opacity').hasValue()) {
          ctx.globalAlpha = this.style('opacity').numValue();
        }
      };
    };

    svg.Element.RenderedElementBase.prototype = new svg.Element.ElementBase();

    svg.Element.PathElementBase = function (node) {
      this.base = svg.Element.RenderedElementBase;
      this.base(node);

      this.path = function (ctx) {
        if (ctx != null) ctx.beginPath();
        return new svg.BoundingBox();
      };

      this.renderChildren = function (ctx) {
        this.path(ctx);
        svg.Mouse.checkPath(this, ctx);

        if (ctx.fillStyle != '') {
          if (this.style('fill-rule').valueOrDefault('inherit') != 'inherit') {
            ctx.fill(this.style('fill-rule').value);
          } else {
            ctx.fill();
          }
        }

        if (ctx.strokeStyle != '') ctx.stroke();
        var markers = this.getMarkers();

        if (markers != null) {
          if (this.style('marker-start').isUrlDefinition()) {
            var marker = this.style('marker-start').getDefinition();
            marker.render(ctx, markers[0][0], markers[0][1]);
          }

          if (this.style('marker-mid').isUrlDefinition()) {
            var marker = this.style('marker-mid').getDefinition();

            for (var i = 1; i < markers.length - 1; i++) {
              marker.render(ctx, markers[i][0], markers[i][1]);
            }
          }

          if (this.style('marker-end').isUrlDefinition()) {
            var marker = this.style('marker-end').getDefinition();
            marker.render(ctx, markers[markers.length - 1][0], markers[markers.length - 1][1]);
          }
        }
      };

      this.getBoundingBox = function () {
        return this.path();
      };

      this.getMarkers = function () {
        return null;
      };
    };

    svg.Element.PathElementBase.prototype = new svg.Element.RenderedElementBase(); // svg element

    svg.Element.svg = function (node) {
      this.base = svg.Element.RenderedElementBase;
      this.base(node);
      this.baseClearContext = this.clearContext;

      this.clearContext = function (ctx) {
        this.baseClearContext(ctx);
        svg.ViewPort.RemoveCurrent();
      };

      this.baseSetContext = this.setContext;

      this.setContext = function (ctx) {
        // initial values and defaults
        ctx.strokeStyle = 'rgba(0,0,0,0)';
        ctx.lineCap = 'butt';
        ctx.lineJoin = 'miter';
        ctx.miterLimit = 4;

        if (typeof ctx.font != 'undefined' && typeof window.getComputedStyle != 'undefined') {
          ctx.font = window.getComputedStyle(ctx.canvas).getPropertyValue('font');
        }

        this.baseSetContext(ctx); // create new view port

        if (!this.attribute('x').hasValue()) this.attribute('x', true).value = 0;
        if (!this.attribute('y').hasValue()) this.attribute('y', true).value = 0;
        ctx.translate(this.attribute('x').toPixels('x'), this.attribute('y').toPixels('y'));
        var width = svg.ViewPort.width();
        var height = svg.ViewPort.height();
        if (!this.attribute('width').hasValue()) this.attribute('width', true).value = '100%';
        if (!this.attribute('height').hasValue()) this.attribute('height', true).value = '100%';

        if (typeof this.root == 'undefined') {
          width = this.attribute('width').toPixels('x');
          height = this.attribute('height').toPixels('y');
          var x = 0;
          var y = 0;

          if (this.attribute('refX').hasValue() && this.attribute('refY').hasValue()) {
            x = -this.attribute('refX').toPixels('x');
            y = -this.attribute('refY').toPixels('y');
          }

          if (this.attribute('overflow').valueOrDefault('hidden') != 'visible') {
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(width, y);
            ctx.lineTo(width, height);
            ctx.lineTo(x, height);
            ctx.closePath();
            ctx.clip();
          }
        }

        svg.ViewPort.SetCurrent(width, height); // viewbox

        if (this.attribute('viewBox').hasValue()) {
          var viewBox = svg.ToNumberArray(this.attribute('viewBox').value);
          var minX = viewBox[0];
          var minY = viewBox[1];
          width = viewBox[2];
          height = viewBox[3];
          svg.AspectRatio(ctx, this.attribute('preserveAspectRatio').value, svg.ViewPort.width(), width, svg.ViewPort.height(), height, minX, minY, this.attribute('refX').value, this.attribute('refY').value);
          svg.ViewPort.RemoveCurrent();
          svg.ViewPort.SetCurrent(viewBox[2], viewBox[3]);
        }
      };
    };

    svg.Element.svg.prototype = new svg.Element.RenderedElementBase(); // rect element

    svg.Element.rect = function (node) {
      this.base = svg.Element.PathElementBase;
      this.base(node);

      this.path = function (ctx) {
        var x = this.attribute('x').toPixels('x');
        var y = this.attribute('y').toPixels('y');
        var width = this.attribute('width').toPixels('x');
        var height = this.attribute('height').toPixels('y');
        var rx = this.attribute('rx').toPixels('x');
        var ry = this.attribute('ry').toPixels('y');
        if (this.attribute('rx').hasValue() && !this.attribute('ry').hasValue()) ry = rx;
        if (this.attribute('ry').hasValue() && !this.attribute('rx').hasValue()) rx = ry;
        rx = Math.min(rx, width / 2.0);
        ry = Math.min(ry, height / 2.0);

        if (ctx != null) {
          ctx.beginPath();
          ctx.moveTo(x + rx, y);
          ctx.lineTo(x + width - rx, y);
          ctx.quadraticCurveTo(x + width, y, x + width, y + ry);
          ctx.lineTo(x + width, y + height - ry);
          ctx.quadraticCurveTo(x + width, y + height, x + width - rx, y + height);
          ctx.lineTo(x + rx, y + height);
          ctx.quadraticCurveTo(x, y + height, x, y + height - ry);
          ctx.lineTo(x, y + ry);
          ctx.quadraticCurveTo(x, y, x + rx, y);
          ctx.closePath();
        }

        return new svg.BoundingBox(x, y, x + width, y + height);
      };
    };

    svg.Element.rect.prototype = new svg.Element.PathElementBase(); // circle element

    svg.Element.circle = function (node) {
      this.base = svg.Element.PathElementBase;
      this.base(node);

      this.path = function (ctx) {
        var cx = this.attribute('cx').toPixels('x');
        var cy = this.attribute('cy').toPixels('y');
        var r = this.attribute('r').toPixels();

        if (ctx != null) {
          ctx.beginPath();
          ctx.arc(cx, cy, r, 0, Math.PI * 2, true);
          ctx.closePath();
        }

        return new svg.BoundingBox(cx - r, cy - r, cx + r, cy + r);
      };
    };

    svg.Element.circle.prototype = new svg.Element.PathElementBase(); // ellipse element

    svg.Element.ellipse = function (node) {
      this.base = svg.Element.PathElementBase;
      this.base(node);

      this.path = function (ctx) {
        var KAPPA = 4 * ((Math.sqrt(2) - 1) / 3);
        var rx = this.attribute('rx').toPixels('x');
        var ry = this.attribute('ry').toPixels('y');
        var cx = this.attribute('cx').toPixels('x');
        var cy = this.attribute('cy').toPixels('y');

        if (ctx != null) {
          ctx.beginPath();
          ctx.moveTo(cx, cy - ry);
          ctx.bezierCurveTo(cx + KAPPA * rx, cy - ry, cx + rx, cy - KAPPA * ry, cx + rx, cy);
          ctx.bezierCurveTo(cx + rx, cy + KAPPA * ry, cx + KAPPA * rx, cy + ry, cx, cy + ry);
          ctx.bezierCurveTo(cx - KAPPA * rx, cy + ry, cx - rx, cy + KAPPA * ry, cx - rx, cy);
          ctx.bezierCurveTo(cx - rx, cy - KAPPA * ry, cx - KAPPA * rx, cy - ry, cx, cy - ry);
          ctx.closePath();
        }

        return new svg.BoundingBox(cx - rx, cy - ry, cx + rx, cy + ry);
      };
    };

    svg.Element.ellipse.prototype = new svg.Element.PathElementBase(); // line element

    svg.Element.line = function (node) {
      this.base = svg.Element.PathElementBase;
      this.base(node);

      this.getPoints = function () {
        return [new svg.Point(this.attribute('x1').toPixels('x'), this.attribute('y1').toPixels('y')), new svg.Point(this.attribute('x2').toPixels('x'), this.attribute('y2').toPixels('y'))];
      };

      this.path = function (ctx) {
        var points = this.getPoints();

        if (ctx != null) {
          ctx.beginPath();
          ctx.moveTo(points[0].x, points[0].y);
          ctx.lineTo(points[1].x, points[1].y);
        }

        return new svg.BoundingBox(points[0].x, points[0].y, points[1].x, points[1].y);
      };

      this.getMarkers = function () {
        var points = this.getPoints();
        var a = points[0].angleTo(points[1]);
        return [[points[0], a], [points[1], a]];
      };
    };

    svg.Element.line.prototype = new svg.Element.PathElementBase(); // polyline element

    svg.Element.polyline = function (node) {
      this.base = svg.Element.PathElementBase;
      this.base(node);
      this.points = svg.CreatePath(this.attribute('points').value);

      this.path = function (ctx) {
        var bb = new svg.BoundingBox(this.points[0].x, this.points[0].y);

        if (ctx != null) {
          ctx.beginPath();
          ctx.moveTo(this.points[0].x, this.points[0].y);
        }

        for (var i = 1; i < this.points.length; i++) {
          bb.addPoint(this.points[i].x, this.points[i].y);
          if (ctx != null) ctx.lineTo(this.points[i].x, this.points[i].y);
        }

        return bb;
      };

      this.getMarkers = function () {
        var markers = [];

        for (var i = 0; i < this.points.length - 1; i++) {
          markers.push([this.points[i], this.points[i].angleTo(this.points[i + 1])]);
        }

        if (markers.length > 0) {
          markers.push([this.points[this.points.length - 1], markers[markers.length - 1][1]]);
        }

        return markers;
      };
    };

    svg.Element.polyline.prototype = new svg.Element.PathElementBase(); // polygon element

    svg.Element.polygon = function (node) {
      this.base = svg.Element.polyline;
      this.base(node);
      this.basePath = this.path;

      this.path = function (ctx) {
        var bb = this.basePath(ctx);

        if (ctx != null) {
          ctx.lineTo(this.points[0].x, this.points[0].y);
          ctx.closePath();
        }

        return bb;
      };
    };

    svg.Element.polygon.prototype = new svg.Element.polyline(); // path element

    svg.Element.path = function (node) {
      this.base = svg.Element.PathElementBase;
      this.base(node);
      var d = this.attribute('d').value; // TODO: convert to real lexer based on http://www.w3.org/TR/SVG11/paths.html#PathDataBNF

      d = d.replace(/,/gm, ' '); // get rid of all commas
      // As the end of a match can also be the start of the next match, we need to run this replace twice.

      for (var i = 0; i < 2; i++) {
        d = d.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm, '$1 $2');
      } // suffix commands with spaces


      d = d.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm, '$1 $2'); // prefix commands with spaces

      d = d.replace(/([0-9])([+\-])/gm, '$1 $2'); // separate digits on +- signs
      // Again, we need to run this twice to find all occurances

      for (var i = 0; i < 2; i++) {
        d = d.replace(/(\.[0-9]*)(\.)/gm, '$1 $2');
      } // separate digits when they start with a comma


      d = d.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm, '$1 $3 $4 '); // shorthand elliptical arc path syntax

      d = svg.compressSpaces(d); // compress multiple spaces

      d = svg.trim(d);
      this.PathParser = new function (d) {
        this.tokens = d.split(' ');

        this.reset = function () {
          this.i = -1;
          this.command = '';
          this.previousCommand = '';
          this.start = new svg.Point(0, 0);
          this.control = new svg.Point(0, 0);
          this.current = new svg.Point(0, 0);
          this.points = [];
          this.angles = [];
        };

        this.isEnd = function () {
          return this.i >= this.tokens.length - 1;
        };

        this.isCommandOrEnd = function () {
          if (this.isEnd()) return true;
          return this.tokens[this.i + 1].match(/^[A-Za-z]$/) != null;
        };

        this.isRelativeCommand = function () {
          switch (this.command) {
            case 'm':
            case 'l':
            case 'h':
            case 'v':
            case 'c':
            case 's':
            case 'q':
            case 't':
            case 'a':
            case 'z':
              return true;
          }

          return false;
        };

        this.getToken = function () {
          this.i++;
          return this.tokens[this.i];
        };

        this.getScalar = function () {
          return parseFloat(this.getToken());
        };

        this.nextCommand = function () {
          this.previousCommand = this.command;
          this.command = this.getToken();
        };

        this.getPoint = function () {
          var p = new svg.Point(this.getScalar(), this.getScalar());
          return this.makeAbsolute(p);
        };

        this.getAsControlPoint = function () {
          var p = this.getPoint();
          this.control = p;
          return p;
        };

        this.getAsCurrentPoint = function () {
          var p = this.getPoint();
          this.current = p;
          return p;
        };

        this.getReflectedControlPoint = function () {
          if (this.previousCommand.toLowerCase() != 'c' && this.previousCommand.toLowerCase() != 's' && this.previousCommand.toLowerCase() != 'q' && this.previousCommand.toLowerCase() != 't') {
            return this.current;
          } // reflect point


          var p = new svg.Point(2 * this.current.x - this.control.x, 2 * this.current.y - this.control.y);
          return p;
        };

        this.makeAbsolute = function (p) {
          if (this.isRelativeCommand()) {
            p.x += this.current.x;
            p.y += this.current.y;
          }

          return p;
        };

        this.addMarker = function (p, from, priorTo) {
          // if the last angle isn't filled in because we didn't have this point yet ...
          if (priorTo != null && this.angles.length > 0 && this.angles[this.angles.length - 1] == null) {
            this.angles[this.angles.length - 1] = this.points[this.points.length - 1].angleTo(priorTo);
          }

          this.addMarkerAngle(p, from == null ? null : from.angleTo(p));
        };

        this.addMarkerAngle = function (p, a) {
          this.points.push(p);
          this.angles.push(a);
        };

        this.getMarkerPoints = function () {
          return this.points;
        };

        this.getMarkerAngles = function () {
          for (var i = 0; i < this.angles.length; i++) {
            if (this.angles[i] == null) {
              for (var j = i + 1; j < this.angles.length; j++) {
                if (this.angles[j] != null) {
                  this.angles[i] = this.angles[j];
                  break;
                }
              }
            }
          }

          return this.angles;
        };
      }(d);

      this.path = function (ctx) {
        var pp = this.PathParser;
        pp.reset();
        var bb = new svg.BoundingBox();
        if (ctx != null) ctx.beginPath();

        while (!pp.isEnd()) {
          pp.nextCommand();

          switch (pp.command) {
            case 'M':
            case 'm':
              var p = pp.getAsCurrentPoint();
              pp.addMarker(p);
              bb.addPoint(p.x, p.y);
              if (ctx != null) ctx.moveTo(p.x, p.y);
              pp.start = pp.current;

              while (!pp.isCommandOrEnd()) {
                var p = pp.getAsCurrentPoint();
                pp.addMarker(p, pp.start);
                bb.addPoint(p.x, p.y);
                if (ctx != null) ctx.lineTo(p.x, p.y);
              }

              break;

            case 'L':
            case 'l':
              while (!pp.isCommandOrEnd()) {
                var c = pp.current;
                var p = pp.getAsCurrentPoint();
                pp.addMarker(p, c);
                bb.addPoint(p.x, p.y);
                if (ctx != null) ctx.lineTo(p.x, p.y);
              }

              break;

            case 'H':
            case 'h':
              while (!pp.isCommandOrEnd()) {
                var newP = new svg.Point((pp.isRelativeCommand() ? pp.current.x : 0) + pp.getScalar(), pp.current.y);
                pp.addMarker(newP, pp.current);
                pp.current = newP;
                bb.addPoint(pp.current.x, pp.current.y);
                if (ctx != null) ctx.lineTo(pp.current.x, pp.current.y);
              }

              break;

            case 'V':
            case 'v':
              while (!pp.isCommandOrEnd()) {
                var newP = new svg.Point(pp.current.x, (pp.isRelativeCommand() ? pp.current.y : 0) + pp.getScalar());
                pp.addMarker(newP, pp.current);
                pp.current = newP;
                bb.addPoint(pp.current.x, pp.current.y);
                if (ctx != null) ctx.lineTo(pp.current.x, pp.current.y);
              }

              break;

            case 'C':
            case 'c':
              while (!pp.isCommandOrEnd()) {
                var curr = pp.current;
                var p1 = pp.getPoint();
                var cntrl = pp.getAsControlPoint();
                var cp = pp.getAsCurrentPoint();
                pp.addMarker(cp, cntrl, p1);
                bb.addBezierCurve(curr.x, curr.y, p1.x, p1.y, cntrl.x, cntrl.y, cp.x, cp.y);
                if (ctx != null) ctx.bezierCurveTo(p1.x, p1.y, cntrl.x, cntrl.y, cp.x, cp.y);
              }

              break;

            case 'S':
            case 's':
              while (!pp.isCommandOrEnd()) {
                var curr = pp.current;
                var p1 = pp.getReflectedControlPoint();
                var cntrl = pp.getAsControlPoint();
                var cp = pp.getAsCurrentPoint();
                pp.addMarker(cp, cntrl, p1);
                bb.addBezierCurve(curr.x, curr.y, p1.x, p1.y, cntrl.x, cntrl.y, cp.x, cp.y);
                if (ctx != null) ctx.bezierCurveTo(p1.x, p1.y, cntrl.x, cntrl.y, cp.x, cp.y);
              }

              break;

            case 'Q':
            case 'q':
              while (!pp.isCommandOrEnd()) {
                var curr = pp.current;
                var cntrl = pp.getAsControlPoint();
                var cp = pp.getAsCurrentPoint();
                pp.addMarker(cp, cntrl, cntrl);
                bb.addQuadraticCurve(curr.x, curr.y, cntrl.x, cntrl.y, cp.x, cp.y);
                if (ctx != null) ctx.quadraticCurveTo(cntrl.x, cntrl.y, cp.x, cp.y);
              }

              break;

            case 'T':
            case 't':
              while (!pp.isCommandOrEnd()) {
                var curr = pp.current;
                var cntrl = pp.getReflectedControlPoint();
                pp.control = cntrl;
                var cp = pp.getAsCurrentPoint();
                pp.addMarker(cp, cntrl, cntrl);
                bb.addQuadraticCurve(curr.x, curr.y, cntrl.x, cntrl.y, cp.x, cp.y);
                if (ctx != null) ctx.quadraticCurveTo(cntrl.x, cntrl.y, cp.x, cp.y);
              }

              break;

            case 'A':
            case 'a':
              while (!pp.isCommandOrEnd()) {
                var curr = pp.current;
                var rx = pp.getScalar();
                var ry = pp.getScalar();
                var xAxisRotation = pp.getScalar() * (Math.PI / 180.0);
                var largeArcFlag = pp.getScalar();
                var sweepFlag = pp.getScalar();
                var cp = pp.getAsCurrentPoint(); // Conversion from endpoint to center parameterization
                // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes
                // x1', y1'

                var currp = new svg.Point(Math.cos(xAxisRotation) * (curr.x - cp.x) / 2.0 + Math.sin(xAxisRotation) * (curr.y - cp.y) / 2.0, -Math.sin(xAxisRotation) * (curr.x - cp.x) / 2.0 + Math.cos(xAxisRotation) * (curr.y - cp.y) / 2.0); // adjust radii

                var l = Math.pow(currp.x, 2) / Math.pow(rx, 2) + Math.pow(currp.y, 2) / Math.pow(ry, 2);

                if (l > 1) {
                  rx *= Math.sqrt(l);
                  ry *= Math.sqrt(l);
                } // cx', cy'


                var s = (largeArcFlag == sweepFlag ? -1 : 1) * Math.sqrt((Math.pow(rx, 2) * Math.pow(ry, 2) - Math.pow(rx, 2) * Math.pow(currp.y, 2) - Math.pow(ry, 2) * Math.pow(currp.x, 2)) / (Math.pow(rx, 2) * Math.pow(currp.y, 2) + Math.pow(ry, 2) * Math.pow(currp.x, 2)));
                if (isNaN(s)) s = 0;
                var cpp = new svg.Point(s * rx * currp.y / ry, s * -ry * currp.x / rx); // cx, cy

                var centp = new svg.Point((curr.x + cp.x) / 2.0 + Math.cos(xAxisRotation) * cpp.x - Math.sin(xAxisRotation) * cpp.y, (curr.y + cp.y) / 2.0 + Math.sin(xAxisRotation) * cpp.x + Math.cos(xAxisRotation) * cpp.y); // vector magnitude

                var m = function m(v) {
                  return Math.sqrt(Math.pow(v[0], 2) + Math.pow(v[1], 2));
                }; // ratio between two vectors


                var r = function r(u, v) {
                  return (u[0] * v[0] + u[1] * v[1]) / (m(u) * m(v));
                }; // angle between two vectors


                var a = function a(u, v) {
                  return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(r(u, v));
                }; // initial angle


                var a1 = a([1, 0], [(currp.x - cpp.x) / rx, (currp.y - cpp.y) / ry]); // angle delta

                var u = [(currp.x - cpp.x) / rx, (currp.y - cpp.y) / ry];
                var v = [(-currp.x - cpp.x) / rx, (-currp.y - cpp.y) / ry];
                var ad = a(u, v);
                if (r(u, v) <= -1) ad = Math.PI;
                if (r(u, v) >= 1) ad = 0; // for markers

                var dir = 1 - sweepFlag ? 1.0 : -1.0;
                var ah = a1 + dir * (ad / 2.0);
                var halfWay = new svg.Point(centp.x + rx * Math.cos(ah), centp.y + ry * Math.sin(ah));
                pp.addMarkerAngle(halfWay, ah - dir * Math.PI / 2);
                pp.addMarkerAngle(cp, ah - dir * Math.PI);
                bb.addPoint(cp.x, cp.y); // TODO: this is too naive, make it better

                if (ctx != null) {
                  var r = rx > ry ? rx : ry;
                  var sx = rx > ry ? 1 : rx / ry;
                  var sy = rx > ry ? ry / rx : 1;
                  ctx.translate(centp.x, centp.y);
                  ctx.rotate(xAxisRotation);
                  ctx.scale(sx, sy);
                  ctx.arc(0, 0, r, a1, a1 + ad, 1 - sweepFlag);
                  ctx.scale(1 / sx, 1 / sy);
                  ctx.rotate(-xAxisRotation);
                  ctx.translate(-centp.x, -centp.y);
                }
              }

              break;

            case 'Z':
            case 'z':
              if (ctx != null) ctx.closePath();
              pp.current = pp.start;
          }
        }

        return bb;
      };

      this.getMarkers = function () {
        var points = this.PathParser.getMarkerPoints();
        var angles = this.PathParser.getMarkerAngles();
        var markers = [];

        for (var i = 0; i < points.length; i++) {
          markers.push([points[i], angles[i]]);
        }

        return markers;
      };
    };

    svg.Element.path.prototype = new svg.Element.PathElementBase(); // pattern element

    svg.Element.pattern = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);

      this.createPattern = function (ctx, element) {
        var width = this.attribute('width').toPixels('x', true);
        var height = this.attribute('height').toPixels('y', true); // render me using a temporary svg element

        var tempSvg = new svg.Element.svg();
        tempSvg.attributes['viewBox'] = new svg.Property('viewBox', this.attribute('viewBox').value);
        tempSvg.attributes['width'] = new svg.Property('width', width + 'px');
        tempSvg.attributes['height'] = new svg.Property('height', height + 'px');
        tempSvg.attributes['transform'] = new svg.Property('transform', this.attribute('patternTransform').value);
        tempSvg.children = this.children;
        var c = document.createElement('canvas');
        c.width = width;
        c.height = height;
        var cctx = c.getContext('2d');

        if (this.attribute('x').hasValue() && this.attribute('y').hasValue()) {
          cctx.translate(this.attribute('x').toPixels('x', true), this.attribute('y').toPixels('y', true));
        } // render 3x3 grid so when we transform there's no white space on edges


        for (var x = -1; x <= 1; x++) {
          for (var y = -1; y <= 1; y++) {
            cctx.save();
            tempSvg.attributes['x'] = new svg.Property('x', x * c.width);
            tempSvg.attributes['y'] = new svg.Property('y', y * c.height);
            tempSvg.render(cctx);
            cctx.restore();
          }
        }

        var pattern = ctx.createPattern(c, 'repeat');
        return pattern;
      };
    };

    svg.Element.pattern.prototype = new svg.Element.ElementBase(); // marker element

    svg.Element.marker = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);
      this.baseRender = this.render;

      this.render = function (ctx, point, angle) {
        ctx.translate(point.x, point.y);
        if (this.attribute('orient').valueOrDefault('auto') == 'auto') ctx.rotate(angle);
        if (this.attribute('markerUnits').valueOrDefault('strokeWidth') == 'strokeWidth') ctx.scale(ctx.lineWidth, ctx.lineWidth);
        ctx.save(); // render me using a temporary svg element

        var tempSvg = new svg.Element.svg();
        tempSvg.attributes['viewBox'] = new svg.Property('viewBox', this.attribute('viewBox').value);
        tempSvg.attributes['refX'] = new svg.Property('refX', this.attribute('refX').value);
        tempSvg.attributes['refY'] = new svg.Property('refY', this.attribute('refY').value);
        tempSvg.attributes['width'] = new svg.Property('width', this.attribute('markerWidth').value);
        tempSvg.attributes['height'] = new svg.Property('height', this.attribute('markerHeight').value);
        tempSvg.attributes['fill'] = new svg.Property('fill', this.attribute('fill').valueOrDefault('black'));
        tempSvg.attributes['stroke'] = new svg.Property('stroke', this.attribute('stroke').valueOrDefault('none'));
        tempSvg.children = this.children;
        tempSvg.render(ctx);
        ctx.restore();
        if (this.attribute('markerUnits').valueOrDefault('strokeWidth') == 'strokeWidth') ctx.scale(1 / ctx.lineWidth, 1 / ctx.lineWidth);
        if (this.attribute('orient').valueOrDefault('auto') == 'auto') ctx.rotate(-angle);
        ctx.translate(-point.x, -point.y);
      };
    };

    svg.Element.marker.prototype = new svg.Element.ElementBase(); // definitions element

    svg.Element.defs = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);

      this.render = function (ctx) {// NOOP
      };
    };

    svg.Element.defs.prototype = new svg.Element.ElementBase(); // base for gradients

    svg.Element.GradientBase = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);
      this.stops = [];

      for (var i = 0; i < this.children.length; i++) {
        var child = this.children[i];
        if (child.type == 'stop') this.stops.push(child);
      }

      this.getGradient = function () {// OVERRIDE ME!
      };

      this.gradientUnits = function () {
        return this.attribute('gradientUnits').valueOrDefault('objectBoundingBox');
      };

      this.attributesToInherit = ['gradientUnits'];

      this.inheritStopContainer = function (stopsContainer) {
        for (var i = 0; i < this.attributesToInherit.length; i++) {
          var attributeToInherit = this.attributesToInherit[i];

          if (!this.attribute(attributeToInherit).hasValue() && stopsContainer.attribute(attributeToInherit).hasValue()) {
            this.attribute(attributeToInherit, true).value = stopsContainer.attribute(attributeToInherit).value;
          }
        }
      };

      this.createGradient = function (ctx, element, parentOpacityProp) {
        var stopsContainer = this;

        if (this.getHrefAttribute().hasValue()) {
          stopsContainer = this.getHrefAttribute().getDefinition();
          this.inheritStopContainer(stopsContainer);
        }

        var addParentOpacity = function addParentOpacity(color) {
          if (parentOpacityProp.hasValue()) {
            var p = new svg.Property('color', color);
            return p.addOpacity(parentOpacityProp).value;
          }

          return color;
        };

        var g = this.getGradient(ctx, element);
        if (g == null) return addParentOpacity(stopsContainer.stops[stopsContainer.stops.length - 1].color);

        for (var i = 0; i < stopsContainer.stops.length; i++) {
          g.addColorStop(stopsContainer.stops[i].offset, addParentOpacity(stopsContainer.stops[i].color));
        }

        if (this.attribute('gradientTransform').hasValue()) {
          // render as transformed pattern on temporary canvas
          var rootView = svg.ViewPort.viewPorts[0];
          var rect = new svg.Element.rect();
          rect.attributes['x'] = new svg.Property('x', -svg.MAX_VIRTUAL_PIXELS / 3.0);
          rect.attributes['y'] = new svg.Property('y', -svg.MAX_VIRTUAL_PIXELS / 3.0);
          rect.attributes['width'] = new svg.Property('width', svg.MAX_VIRTUAL_PIXELS);
          rect.attributes['height'] = new svg.Property('height', svg.MAX_VIRTUAL_PIXELS);
          var group = new svg.Element.g();
          group.attributes['transform'] = new svg.Property('transform', this.attribute('gradientTransform').value);
          group.children = [rect];
          var tempSvg = new svg.Element.svg();
          tempSvg.attributes['x'] = new svg.Property('x', 0);
          tempSvg.attributes['y'] = new svg.Property('y', 0);
          tempSvg.attributes['width'] = new svg.Property('width', rootView.width);
          tempSvg.attributes['height'] = new svg.Property('height', rootView.height);
          tempSvg.children = [group];
          var c = document.createElement('canvas');
          c.width = rootView.width;
          c.height = rootView.height;
          var tempCtx = c.getContext('2d');
          tempCtx.fillStyle = g;
          tempSvg.render(tempCtx);
          return tempCtx.createPattern(c, 'no-repeat');
        }

        return g;
      };
    };

    svg.Element.GradientBase.prototype = new svg.Element.ElementBase(); // linear gradient element

    svg.Element.linearGradient = function (node) {
      this.base = svg.Element.GradientBase;
      this.base(node);
      this.attributesToInherit.push('x1');
      this.attributesToInherit.push('y1');
      this.attributesToInherit.push('x2');
      this.attributesToInherit.push('y2');

      this.getGradient = function (ctx, element) {
        var bb = this.gradientUnits() == 'objectBoundingBox' ? element.getBoundingBox() : null;

        if (!this.attribute('x1').hasValue() && !this.attribute('y1').hasValue() && !this.attribute('x2').hasValue() && !this.attribute('y2').hasValue()) {
          this.attribute('x1', true).value = 0;
          this.attribute('y1', true).value = 0;
          this.attribute('x2', true).value = 1;
          this.attribute('y2', true).value = 0;
        }

        var x1 = this.gradientUnits() == 'objectBoundingBox' ? bb.x() + bb.width() * this.attribute('x1').numValue() : this.attribute('x1').toPixels('x');
        var y1 = this.gradientUnits() == 'objectBoundingBox' ? bb.y() + bb.height() * this.attribute('y1').numValue() : this.attribute('y1').toPixels('y');
        var x2 = this.gradientUnits() == 'objectBoundingBox' ? bb.x() + bb.width() * this.attribute('x2').numValue() : this.attribute('x2').toPixels('x');
        var y2 = this.gradientUnits() == 'objectBoundingBox' ? bb.y() + bb.height() * this.attribute('y2').numValue() : this.attribute('y2').toPixels('y');
        if (x1 == x2 && y1 == y2) return null;
        return ctx.createLinearGradient(x1, y1, x2, y2);
      };
    };

    svg.Element.linearGradient.prototype = new svg.Element.GradientBase(); // radial gradient element

    svg.Element.radialGradient = function (node) {
      this.base = svg.Element.GradientBase;
      this.base(node);
      this.attributesToInherit.push('cx');
      this.attributesToInherit.push('cy');
      this.attributesToInherit.push('r');
      this.attributesToInherit.push('fx');
      this.attributesToInherit.push('fy');

      this.getGradient = function (ctx, element) {
        var bb = element.getBoundingBox();
        if (!this.attribute('cx').hasValue()) this.attribute('cx', true).value = '50%';
        if (!this.attribute('cy').hasValue()) this.attribute('cy', true).value = '50%';
        if (!this.attribute('r').hasValue()) this.attribute('r', true).value = '50%';
        var cx = this.gradientUnits() == 'objectBoundingBox' ? bb.x() + bb.width() * this.attribute('cx').numValue() : this.attribute('cx').toPixels('x');
        var cy = this.gradientUnits() == 'objectBoundingBox' ? bb.y() + bb.height() * this.attribute('cy').numValue() : this.attribute('cy').toPixels('y');
        var fx = cx;
        var fy = cy;

        if (this.attribute('fx').hasValue()) {
          fx = this.gradientUnits() == 'objectBoundingBox' ? bb.x() + bb.width() * this.attribute('fx').numValue() : this.attribute('fx').toPixels('x');
        }

        if (this.attribute('fy').hasValue()) {
          fy = this.gradientUnits() == 'objectBoundingBox' ? bb.y() + bb.height() * this.attribute('fy').numValue() : this.attribute('fy').toPixels('y');
        }

        var r = this.gradientUnits() == 'objectBoundingBox' ? (bb.width() + bb.height()) / 2.0 * this.attribute('r').numValue() : this.attribute('r').toPixels();
        return ctx.createRadialGradient(fx, fy, 0, cx, cy, r);
      };
    };

    svg.Element.radialGradient.prototype = new svg.Element.GradientBase(); // gradient stop element

    svg.Element.stop = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);
      this.offset = this.attribute('offset').numValue();
      if (this.offset < 0) this.offset = 0;
      if (this.offset > 1) this.offset = 1;
      var stopColor = this.style('stop-color', true);
      if (stopColor.value == '') stopColor.value = '#000';
      if (this.style('stop-opacity').hasValue()) stopColor = stopColor.addOpacity(this.style('stop-opacity'));
      this.color = stopColor.value;
    };

    svg.Element.stop.prototype = new svg.Element.ElementBase(); // animation base element

    svg.Element.AnimateBase = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);
      svg.Animations.push(this);
      this.duration = 0.0;
      this.begin = this.attribute('begin').toMilliseconds();
      this.maxDuration = this.begin + this.attribute('dur').toMilliseconds();

      this.getProperty = function () {
        var attributeType = this.attribute('attributeType').value;
        var attributeName = this.attribute('attributeName').value;

        if (attributeType == 'CSS') {
          return this.parent.style(attributeName, true);
        }

        return this.parent.attribute(attributeName, true);
      };

      this.initialValue = null;
      this.initialUnits = '';
      this.removed = false;

      this.calcValue = function () {
        // OVERRIDE ME!
        return '';
      };

      this.update = function (delta) {
        // set initial value
        if (this.initialValue == null) {
          this.initialValue = this.getProperty().value;
          this.initialUnits = this.getProperty().getUnits();
        } // if we're past the end time


        if (this.duration > this.maxDuration) {
          // loop for indefinitely repeating animations
          if (this.attribute('repeatCount').value == 'indefinite' || this.attribute('repeatDur').value == 'indefinite') {
            this.duration = 0.0;
          } else if (this.attribute('fill').valueOrDefault('remove') == 'freeze' && !this.frozen) {
            this.frozen = true;
            this.parent.animationFrozen = true;
            this.parent.animationFrozenValue = this.getProperty().value;
          } else if (this.attribute('fill').valueOrDefault('remove') == 'remove' && !this.removed) {
            this.removed = true;
            this.getProperty().value = this.parent.animationFrozen ? this.parent.animationFrozenValue : this.initialValue;
            return true;
          }

          return false;
        }

        this.duration = this.duration + delta; // if we're past the begin time

        var updated = false;

        if (this.begin < this.duration) {
          var newValue = this.calcValue(); // tween

          if (this.attribute('type').hasValue()) {
            // for transform, etc.
            var type = this.attribute('type').value;
            newValue = type + '(' + newValue + ')';
          }

          this.getProperty().value = newValue;
          updated = true;
        }

        return updated;
      };

      this.from = this.attribute('from');
      this.to = this.attribute('to');
      this.values = this.attribute('values');
      if (this.values.hasValue()) this.values.value = this.values.value.split(';'); // fraction of duration we've covered

      this.progress = function () {
        var ret = {
          progress: (this.duration - this.begin) / (this.maxDuration - this.begin)
        };

        if (this.values.hasValue()) {
          var p = ret.progress * (this.values.value.length - 1);
          var lb = Math.floor(p),
              ub = Math.ceil(p);
          ret.from = new svg.Property('from', parseFloat(this.values.value[lb]));
          ret.to = new svg.Property('to', parseFloat(this.values.value[ub]));
          ret.progress = (p - lb) / (ub - lb);
        } else {
          ret.from = this.from;
          ret.to = this.to;
        }

        return ret;
      };
    };

    svg.Element.AnimateBase.prototype = new svg.Element.ElementBase(); // animate element

    svg.Element.animate = function (node) {
      this.base = svg.Element.AnimateBase;
      this.base(node);

      this.calcValue = function () {
        var p = this.progress(); // tween value linearly

        var newValue = p.from.numValue() + (p.to.numValue() - p.from.numValue()) * p.progress;
        return newValue + this.initialUnits;
      };
    };

    svg.Element.animate.prototype = new svg.Element.AnimateBase(); // animate color element

    svg.Element.animateColor = function (node) {
      this.base = svg.Element.AnimateBase;
      this.base(node);

      this.calcValue = function () {
        var p = this.progress();
        var from = new rgbcolor(p.from.value);
        var to = new rgbcolor(p.to.value);

        if (from.ok && to.ok) {
          // tween color linearly
          var r = from.r + (to.r - from.r) * p.progress;
          var g = from.g + (to.g - from.g) * p.progress;
          var b = from.b + (to.b - from.b) * p.progress;
          return 'rgb(' + parseInt(r, 10) + ',' + parseInt(g, 10) + ',' + parseInt(b, 10) + ')';
        }

        return this.attribute('from').value;
      };
    };

    svg.Element.animateColor.prototype = new svg.Element.AnimateBase(); // animate transform element

    svg.Element.animateTransform = function (node) {
      this.base = svg.Element.AnimateBase;
      this.base(node);

      this.calcValue = function () {
        var p = this.progress(); // tween value linearly

        var from = svg.ToNumberArray(p.from.value);
        var to = svg.ToNumberArray(p.to.value);
        var newValue = '';

        for (var i = 0; i < from.length; i++) {
          newValue += from[i] + (to[i] - from[i]) * p.progress + ' ';
        }

        return newValue;
      };
    };

    svg.Element.animateTransform.prototype = new svg.Element.animate(); // font element

    svg.Element.font = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);
      this.horizAdvX = this.attribute('horiz-adv-x').numValue();
      this.isRTL = false;
      this.isArabic = false;
      this.fontFace = null;
      this.missingGlyph = null;
      this.glyphs = [];

      for (var i = 0; i < this.children.length; i++) {
        var child = this.children[i];

        if (child.type == 'font-face') {
          this.fontFace = child;

          if (child.style('font-family').hasValue()) {
            svg.Definitions[child.style('font-family').value] = this;
          }
        } else if (child.type == 'missing-glyph') this.missingGlyph = child;else if (child.type == 'glyph') {
          if (child.arabicForm != '') {
            this.isRTL = true;
            this.isArabic = true;
            if (typeof this.glyphs[child.unicode] == 'undefined') this.glyphs[child.unicode] = [];
            this.glyphs[child.unicode][child.arabicForm] = child;
          } else {
            this.glyphs[child.unicode] = child;
          }
        }
      }
    };

    svg.Element.font.prototype = new svg.Element.ElementBase(); // font-face element

    svg.Element.fontface = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);
      this.ascent = this.attribute('ascent').value;
      this.descent = this.attribute('descent').value;
      this.unitsPerEm = this.attribute('units-per-em').numValue();
    };

    svg.Element.fontface.prototype = new svg.Element.ElementBase(); // missing-glyph element

    svg.Element.missingglyph = function (node) {
      this.base = svg.Element.path;
      this.base(node);
      this.horizAdvX = 0;
    };

    svg.Element.missingglyph.prototype = new svg.Element.path(); // glyph element

    svg.Element.glyph = function (node) {
      this.base = svg.Element.path;
      this.base(node);
      this.horizAdvX = this.attribute('horiz-adv-x').numValue();
      this.unicode = this.attribute('unicode').value;
      this.arabicForm = this.attribute('arabic-form').value;
    };

    svg.Element.glyph.prototype = new svg.Element.path(); // text element

    svg.Element.text = function (node) {
      this.captureTextNodes = true;
      this.base = svg.Element.RenderedElementBase;
      this.base(node);
      this.baseSetContext = this.setContext;

      this.setContext = function (ctx) {
        this.baseSetContext(ctx);
        var textBaseline = this.style('dominant-baseline').toTextBaseline();
        if (textBaseline == null) textBaseline = this.style('alignment-baseline').toTextBaseline();
        if (textBaseline != null) ctx.textBaseline = textBaseline;
      };

      this.getBoundingBox = function () {
        var x = this.attribute('x').toPixels('x');
        var y = this.attribute('y').toPixels('y');
        var fontSize = this.parent.style('font-size').numValueOrDefault(svg.Font.Parse(svg.ctx.font).fontSize);
        return new svg.BoundingBox(x, y - fontSize, x + Math.floor(fontSize * 2.0 / 3.0) * this.children[0].getText().length, y);
      };

      this.renderChildren = function (ctx) {
        this.x = this.attribute('x').toPixels('x');
        this.y = this.attribute('y').toPixels('y');
        if (this.attribute('dx').hasValue()) this.x += this.attribute('dx').toPixels('x');
        if (this.attribute('dy').hasValue()) this.y += this.attribute('dy').toPixels('y');
        this.x += this.getAnchorDelta(ctx, this, 0);

        for (var i = 0; i < this.children.length; i++) {
          this.renderChild(ctx, this, this, i);
        }
      };

      this.getAnchorDelta = function (ctx, parent, startI) {
        var textAnchor = this.style('text-anchor').valueOrDefault('start');

        if (textAnchor != 'start') {
          var width = 0;

          for (var i = startI; i < parent.children.length; i++) {
            var child = parent.children[i];
            if (i > startI && child.attribute('x').hasValue()) break; // new group

            width += child.measureTextRecursive(ctx);
          }

          return -1 * (textAnchor == 'end' ? width : width / 2.0);
        }

        return 0;
      };

      this.renderChild = function (ctx, textParent, parent, i) {
        var child = parent.children[i];

        if (child.attribute('x').hasValue()) {
          child.x = child.attribute('x').toPixels('x') + textParent.getAnchorDelta(ctx, parent, i);
          if (child.attribute('dx').hasValue()) child.x += child.attribute('dx').toPixels('x');
        } else {
          if (child.attribute('dx').hasValue()) textParent.x += child.attribute('dx').toPixels('x');
          child.x = textParent.x;
        }

        textParent.x = child.x + child.measureText(ctx);

        if (child.attribute('y').hasValue()) {
          child.y = child.attribute('y').toPixels('y');
          if (child.attribute('dy').hasValue()) child.y += child.attribute('dy').toPixels('y');
        } else {
          if (child.attribute('dy').hasValue()) textParent.y += child.attribute('dy').toPixels('y');
          child.y = textParent.y;
        }

        textParent.y = child.y;
        child.render(ctx);

        for (var i = 0; i < child.children.length; i++) {
          textParent.renderChild(ctx, textParent, child, i);
        }
      };
    };

    svg.Element.text.prototype = new svg.Element.RenderedElementBase(); // text base

    svg.Element.TextElementBase = function (node) {
      this.base = svg.Element.RenderedElementBase;
      this.base(node);

      this.getGlyph = function (font, text, i) {
        var c = text[i];
        var glyph = null;

        if (font.isArabic) {
          var arabicForm = 'isolated';
          if ((i == 0 || text[i - 1] == ' ') && i < text.length - 2 && text[i + 1] != ' ') arabicForm = 'terminal';
          if (i > 0 && text[i - 1] != ' ' && i < text.length - 2 && text[i + 1] != ' ') arabicForm = 'medial';
          if (i > 0 && text[i - 1] != ' ' && (i == text.length - 1 || text[i + 1] == ' ')) arabicForm = 'initial';

          if (typeof font.glyphs[c] != 'undefined') {
            glyph = font.glyphs[c][arabicForm];
            if (glyph == null && font.glyphs[c].type == 'glyph') glyph = font.glyphs[c];
          }
        } else {
          glyph = font.glyphs[c];
        }

        if (glyph == null) glyph = font.missingGlyph;
        return glyph;
      };

      this.renderChildren = function (ctx) {
        var customFont = this.parent.style('font-family').getDefinition();

        if (customFont != null) {
          var fontSize = this.parent.style('font-size').numValueOrDefault(svg.Font.Parse(svg.ctx.font).fontSize);
          var fontStyle = this.parent.style('font-style').valueOrDefault(svg.Font.Parse(svg.ctx.font).fontStyle);
          var text = this.getText();
          if (customFont.isRTL) text = text.split("").reverse().join("");
          var dx = svg.ToNumberArray(this.parent.attribute('dx').value);

          for (var i = 0; i < text.length; i++) {
            var glyph = this.getGlyph(customFont, text, i);
            var scale = fontSize / customFont.fontFace.unitsPerEm;
            ctx.translate(this.x, this.y);
            ctx.scale(scale, -scale);
            var lw = ctx.lineWidth;
            ctx.lineWidth = ctx.lineWidth * customFont.fontFace.unitsPerEm / fontSize;
            if (fontStyle == 'italic') ctx.transform(1, 0, .4, 1, 0, 0);
            glyph.render(ctx);
            if (fontStyle == 'italic') ctx.transform(1, 0, -.4, 1, 0, 0);
            ctx.lineWidth = lw;
            ctx.scale(1 / scale, -1 / scale);
            ctx.translate(-this.x, -this.y);
            this.x += fontSize * (glyph.horizAdvX || customFont.horizAdvX) / customFont.fontFace.unitsPerEm;

            if (typeof dx[i] != 'undefined' && !isNaN(dx[i])) {
              this.x += dx[i];
            }
          }

          return;
        }

        if (ctx.fillStyle != '') ctx.fillText(svg.compressSpaces(this.getText()), this.x, this.y);
        if (ctx.strokeStyle != '') ctx.strokeText(svg.compressSpaces(this.getText()), this.x, this.y);
      };

      this.getText = function () {// OVERRIDE ME
      };

      this.measureTextRecursive = function (ctx) {
        var width = this.measureText(ctx);

        for (var i = 0; i < this.children.length; i++) {
          width += this.children[i].measureTextRecursive(ctx);
        }

        return width;
      };

      this.measureText = function (ctx) {
        var customFont = this.parent.style('font-family').getDefinition();

        if (customFont != null) {
          var fontSize = this.parent.style('font-size').numValueOrDefault(svg.Font.Parse(svg.ctx.font).fontSize);
          var measure = 0;
          var text = this.getText();
          if (customFont.isRTL) text = text.split("").reverse().join("");
          var dx = svg.ToNumberArray(this.parent.attribute('dx').value);

          for (var i = 0; i < text.length; i++) {
            var glyph = this.getGlyph(customFont, text, i);
            measure += (glyph.horizAdvX || customFont.horizAdvX) * fontSize / customFont.fontFace.unitsPerEm;

            if (typeof dx[i] != 'undefined' && !isNaN(dx[i])) {
              measure += dx[i];
            }
          }

          return measure;
        }

        var textToMeasure = svg.compressSpaces(this.getText());
        if (!ctx.measureText) return textToMeasure.length * 10;
        ctx.save();
        this.setContext(ctx);
        var width = ctx.measureText(textToMeasure).width;
        ctx.restore();
        return width;
      };
    };

    svg.Element.TextElementBase.prototype = new svg.Element.RenderedElementBase(); // tspan

    svg.Element.tspan = function (node) {
      this.captureTextNodes = true;
      this.base = svg.Element.TextElementBase;
      this.base(node);
      this.text = svg.compressSpaces(node.value || node.text || node.textContent || '');

      this.getText = function () {
        // if this node has children, then they own the text
        if (this.children.length > 0) {
          return '';
        }

        return this.text;
      };
    };

    svg.Element.tspan.prototype = new svg.Element.TextElementBase(); // tref

    svg.Element.tref = function (node) {
      this.base = svg.Element.TextElementBase;
      this.base(node);

      this.getText = function () {
        var element = this.getHrefAttribute().getDefinition();
        if (element != null) return element.children[0].getText();
      };
    };

    svg.Element.tref.prototype = new svg.Element.TextElementBase(); // a element

    svg.Element.a = function (node) {
      this.base = svg.Element.TextElementBase;
      this.base(node);
      this.hasText = node.childNodes.length > 0;

      for (var i = 0; i < node.childNodes.length; i++) {
        if (node.childNodes[i].nodeType != 3) this.hasText = false;
      } // this might contain text


      this.text = this.hasText ? node.childNodes[0].value : '';

      this.getText = function () {
        return this.text;
      };

      this.baseRenderChildren = this.renderChildren;

      this.renderChildren = function (ctx) {
        if (this.hasText) {
          // render as text element
          this.baseRenderChildren(ctx);
          var fontSize = new svg.Property('fontSize', svg.Font.Parse(svg.ctx.font).fontSize);
          svg.Mouse.checkBoundingBox(this, new svg.BoundingBox(this.x, this.y - fontSize.toPixels('y'), this.x + this.measureText(ctx), this.y));
        } else if (this.children.length > 0) {
          // render as temporary group
          var g = new svg.Element.g();
          g.children = this.children;
          g.parent = this;
          g.render(ctx);
        }
      };

      this.onclick = function () {
        window.open(this.getHrefAttribute().value);
      };

      this.onmousemove = function () {
        svg.ctx.canvas.style.cursor = 'pointer';
      };
    };

    svg.Element.a.prototype = new svg.Element.TextElementBase(); // image element

    svg.Element.image = function (node) {
      this.base = svg.Element.RenderedElementBase;
      this.base(node);
      var href = this.getHrefAttribute().value;

      if (href == '') {
        return;
      }

      var isSvg = href.match(/\.svg$/);
      svg.Images.push(this);
      this.loaded = false;

      if (!isSvg) {
        this.img = document.createElement('img');

        if (svg.opts['useCORS'] == true) {
          this.img.crossOrigin = 'Anonymous';
        }

        var self = this;

        this.img.onload = function () {
          self.loaded = true;
        };

        this.img.onerror = function () {
          svg.log('ERROR: image "' + href + '" not found');
          self.loaded = true;
        };

        this.img.src = href;
      } else {
        this.img = svg.ajax(href);
        this.loaded = true;
      }

      this.renderChildren = function (ctx) {
        var x = this.attribute('x').toPixels('x');
        var y = this.attribute('y').toPixels('y');
        var width = this.attribute('width').toPixels('x');
        var height = this.attribute('height').toPixels('y');
        if (width == 0 || height == 0) return;
        ctx.save();

        if (isSvg) {
          ctx.drawSvg(this.img, x, y, width, height);
        } else {
          ctx.translate(x, y);
          svg.AspectRatio(ctx, this.attribute('preserveAspectRatio').value, width, this.img.width, height, this.img.height, 0, 0);
          ctx.drawImage(this.img, 0, 0);
        }

        ctx.restore();
      };

      this.getBoundingBox = function () {
        var x = this.attribute('x').toPixels('x');
        var y = this.attribute('y').toPixels('y');
        var width = this.attribute('width').toPixels('x');
        var height = this.attribute('height').toPixels('y');
        return new svg.BoundingBox(x, y, x + width, y + height);
      };
    };

    svg.Element.image.prototype = new svg.Element.RenderedElementBase(); // group element

    svg.Element.g = function (node) {
      this.base = svg.Element.RenderedElementBase;
      this.base(node);

      this.getBoundingBox = function () {
        var bb = new svg.BoundingBox();

        for (var i = 0; i < this.children.length; i++) {
          bb.addBoundingBox(this.children[i].getBoundingBox());
        }

        return bb;
      };
    };

    svg.Element.g.prototype = new svg.Element.RenderedElementBase(); // symbol element

    svg.Element.symbol = function (node) {
      this.base = svg.Element.RenderedElementBase;
      this.base(node);

      this.render = function (ctx) {// NO RENDER
      };
    };

    svg.Element.symbol.prototype = new svg.Element.RenderedElementBase(); // style element

    svg.Element.style = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node); // text, or spaces then CDATA

      var css = '';

      for (var i = 0; i < node.childNodes.length; i++) {
        css += node.childNodes[i].data;
      }

      css = css.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm, ''); // remove comments

      css = svg.compressSpaces(css); // replace whitespace

      var cssDefs = css.split('}');

      for (var i = 0; i < cssDefs.length; i++) {
        if (svg.trim(cssDefs[i]) != '') {
          var cssDef = cssDefs[i].split('{');
          var cssClasses = cssDef[0].split(',');
          var cssProps = cssDef[1].split(';');

          for (var j = 0; j < cssClasses.length; j++) {
            var cssClass = svg.trim(cssClasses[j]);

            if (cssClass != '') {
              var props = svg.Styles[cssClass] || {};

              for (var k = 0; k < cssProps.length; k++) {
                var prop = cssProps[k].indexOf(':');
                var name = cssProps[k].substr(0, prop);
                var value = cssProps[k].substr(prop + 1, cssProps[k].length - prop);

                if (name != null && value != null) {
                  props[svg.trim(name)] = new svg.Property(svg.trim(name), svg.trim(value));
                }
              }

              svg.Styles[cssClass] = props;
              svg.StylesSpecificity[cssClass] = getSelectorSpecificity(cssClass);

              if (cssClass == '@font-face') {
                var fontFamily = props['font-family'].value.replace(/"/g, '');
                var srcs = props['src'].value.split(',');

                for (var s = 0; s < srcs.length; s++) {
                  if (srcs[s].indexOf('format("svg")') > 0) {
                    var urlStart = srcs[s].indexOf('url');
                    var urlEnd = srcs[s].indexOf(')', urlStart);
                    var url = srcs[s].substr(urlStart + 5, urlEnd - urlStart - 6);
                    var doc = svg.parseXml(svg.ajax(url));
                    var fonts = doc.getElementsByTagName('font');

                    for (var f = 0; f < fonts.length; f++) {
                      var font = svg.CreateElement(fonts[f]);
                      svg.Definitions[fontFamily] = font;
                    }
                  }
                }
              }
            }
          }
        }
      }
    };

    svg.Element.style.prototype = new svg.Element.ElementBase(); // use element

    svg.Element.use = function (node) {
      this.base = svg.Element.RenderedElementBase;
      this.base(node);
      this.baseSetContext = this.setContext;

      this.setContext = function (ctx) {
        this.baseSetContext(ctx);
        if (this.attribute('x').hasValue()) ctx.translate(this.attribute('x').toPixels('x'), 0);
        if (this.attribute('y').hasValue()) ctx.translate(0, this.attribute('y').toPixels('y'));
      };

      var element = this.getHrefAttribute().getDefinition();

      this.path = function (ctx) {
        if (element != null) element.path(ctx);
      };

      this.getBoundingBox = function () {
        if (element != null) return element.getBoundingBox();
      };

      this.renderChildren = function (ctx) {
        if (element != null) {
          var tempSvg = element;

          if (element.type == 'symbol') {
            // render me using a temporary svg element in symbol cases (http://www.w3.org/TR/SVG/struct.html#UseElement)
            tempSvg = new svg.Element.svg();
            tempSvg.type = 'svg';
            tempSvg.attributes['viewBox'] = new svg.Property('viewBox', element.attribute('viewBox').value);
            tempSvg.attributes['preserveAspectRatio'] = new svg.Property('preserveAspectRatio', element.attribute('preserveAspectRatio').value);
            tempSvg.attributes['overflow'] = new svg.Property('overflow', element.attribute('overflow').value);
            tempSvg.children = element.children;
          }

          if (tempSvg.type == 'svg') {
            // if symbol or svg, inherit width/height from me
            if (this.attribute('width').hasValue()) tempSvg.attributes['width'] = new svg.Property('width', this.attribute('width').value);
            if (this.attribute('height').hasValue()) tempSvg.attributes['height'] = new svg.Property('height', this.attribute('height').value);
          }

          var oldParent = tempSvg.parent;
          tempSvg.parent = null;
          tempSvg.render(ctx);
          tempSvg.parent = oldParent;
        }
      };
    };

    svg.Element.use.prototype = new svg.Element.RenderedElementBase(); // mask element

    svg.Element.mask = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);

      this.apply = function (ctx, element) {
        // render as temp svg
        var x = this.attribute('x').toPixels('x');
        var y = this.attribute('y').toPixels('y');
        var width = this.attribute('width').toPixels('x');
        var height = this.attribute('height').toPixels('y');

        if (width == 0 && height == 0) {
          var bb = new svg.BoundingBox();

          for (var i = 0; i < this.children.length; i++) {
            bb.addBoundingBox(this.children[i].getBoundingBox());
          }

          var x = Math.floor(bb.x1);
          var y = Math.floor(bb.y1);
          var width = Math.floor(bb.width());
          var height = Math.floor(bb.height());
        } // temporarily remove mask to avoid recursion


        var mask = element.attribute('mask').value;
        element.attribute('mask').value = '';
        var cMask = document.createElement('canvas');
        cMask.width = x + width;
        cMask.height = y + height;
        var maskCtx = cMask.getContext('2d');
        this.renderChildren(maskCtx);
        var c = document.createElement('canvas');
        c.width = x + width;
        c.height = y + height;
        var tempCtx = c.getContext('2d');
        element.render(tempCtx);
        tempCtx.globalCompositeOperation = 'destination-in';
        tempCtx.fillStyle = maskCtx.createPattern(cMask, 'no-repeat');
        tempCtx.fillRect(0, 0, x + width, y + height);
        ctx.fillStyle = tempCtx.createPattern(c, 'no-repeat');
        ctx.fillRect(0, 0, x + width, y + height); // reassign mask

        element.attribute('mask').value = mask;
      };

      this.render = function (ctx) {// NO RENDER
      };
    };

    svg.Element.mask.prototype = new svg.Element.ElementBase(); // clip element

    svg.Element.clipPath = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);

      this.apply = function (ctx) {
        var oldBeginPath = CanvasRenderingContext2D.prototype.beginPath;

        CanvasRenderingContext2D.prototype.beginPath = function () {};

        var oldClosePath = CanvasRenderingContext2D.prototype.closePath;

        CanvasRenderingContext2D.prototype.closePath = function () {};

        oldBeginPath.call(ctx);

        for (var i = 0; i < this.children.length; i++) {
          var child = this.children[i];

          if (typeof child.path != 'undefined') {
            var transform = null;

            if (child.style('transform', false, true).hasValue()) {
              transform = new svg.Transform(child.style('transform', false, true).value);
              transform.apply(ctx);
            }

            child.path(ctx);
            CanvasRenderingContext2D.prototype.closePath = oldClosePath;

            if (transform) {
              transform.unapply(ctx);
            }
          }
        }

        oldClosePath.call(ctx);
        ctx.clip();
        CanvasRenderingContext2D.prototype.beginPath = oldBeginPath;
        CanvasRenderingContext2D.prototype.closePath = oldClosePath;
      };

      this.render = function (ctx) {// NO RENDER
      };
    };

    svg.Element.clipPath.prototype = new svg.Element.ElementBase(); // filters

    svg.Element.filter = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);

      this.apply = function (ctx, element) {
        // render as temp svg
        var bb = element.getBoundingBox();
        var x = Math.floor(bb.x1);
        var y = Math.floor(bb.y1);
        var width = Math.floor(bb.width());
        var height = Math.floor(bb.height()); // temporarily remove filter to avoid recursion

        var filter = element.style('filter').value;
        element.style('filter').value = '';
        var px = 0,
            py = 0;

        for (var i = 0; i < this.children.length; i++) {
          var efd = this.children[i].extraFilterDistance || 0;
          px = Math.max(px, efd);
          py = Math.max(py, efd);
        }

        var c = document.createElement('canvas');
        c.width = width + 2 * px;
        c.height = height + 2 * py;
        var tempCtx = c.getContext('2d');
        tempCtx.translate(-x + px, -y + py);
        element.render(tempCtx); // apply filters

        for (var i = 0; i < this.children.length; i++) {
          if (typeof this.children[i].apply == 'function') {
            this.children[i].apply(tempCtx, 0, 0, width + 2 * px, height + 2 * py);
          }
        } // render on me


        ctx.drawImage(c, 0, 0, width + 2 * px, height + 2 * py, x - px, y - py, width + 2 * px, height + 2 * py); // reassign filter

        element.style('filter', true).value = filter;
      };

      this.render = function (ctx) {// NO RENDER
      };
    };

    svg.Element.filter.prototype = new svg.Element.ElementBase();

    svg.Element.feMorphology = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);

      this.apply = function (ctx, x, y, width, height) {// TODO: implement
      };
    };

    svg.Element.feMorphology.prototype = new svg.Element.ElementBase();

    svg.Element.feComposite = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);

      this.apply = function (ctx, x, y, width, height) {// TODO: implement
      };
    };

    svg.Element.feComposite.prototype = new svg.Element.ElementBase();

    svg.Element.feColorMatrix = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);
      var matrix = svg.ToNumberArray(this.attribute('values').value);

      switch (this.attribute('type').valueOrDefault('matrix')) {
        // http://www.w3.org/TR/SVG/filters.html#feColorMatrixElement
        case 'saturate':
          var s = matrix[0];
          matrix = [0.213 + 0.787 * s, 0.715 - 0.715 * s, 0.072 - 0.072 * s, 0, 0, 0.213 - 0.213 * s, 0.715 + 0.285 * s, 0.072 - 0.072 * s, 0, 0, 0.213 - 0.213 * s, 0.715 - 0.715 * s, 0.072 + 0.928 * s, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];
          break;

        case 'hueRotate':
          var a = matrix[0] * Math.PI / 180.0;

          var c = function c(m1, m2, m3) {
            return m1 + Math.cos(a) * m2 + Math.sin(a) * m3;
          };

          matrix = [c(0.213, 0.787, -0.213), c(0.715, -0.715, -0.715), c(0.072, -0.072, 0.928), 0, 0, c(0.213, -0.213, 0.143), c(0.715, 0.285, 0.140), c(0.072, -0.072, -0.283), 0, 0, c(0.213, -0.213, -0.787), c(0.715, -0.715, 0.715), c(0.072, 0.928, 0.072), 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];
          break;

        case 'luminanceToAlpha':
          matrix = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.2125, 0.7154, 0.0721, 0, 0, 0, 0, 0, 0, 1];
          break;
      }

      function imGet(img, x, y, width, height, rgba) {
        return img[y * width * 4 + x * 4 + rgba];
      }

      function imSet(img, x, y, width, height, rgba, val) {
        img[y * width * 4 + x * 4 + rgba] = val;
      }

      function m(i, v) {
        var mi = matrix[i];
        return mi * (mi < 0 ? v - 255 : v);
      }

      this.apply = function (ctx, x, y, width, height) {
        // assuming x==0 && y==0 for now
        var srcData = ctx.getImageData(0, 0, width, height);

        for (var y = 0; y < height; y++) {
          for (var x = 0; x < width; x++) {
            var r = imGet(srcData.data, x, y, width, height, 0);
            var g = imGet(srcData.data, x, y, width, height, 1);
            var b = imGet(srcData.data, x, y, width, height, 2);
            var a = imGet(srcData.data, x, y, width, height, 3);
            imSet(srcData.data, x, y, width, height, 0, m(0, r) + m(1, g) + m(2, b) + m(3, a) + m(4, 1));
            imSet(srcData.data, x, y, width, height, 1, m(5, r) + m(6, g) + m(7, b) + m(8, a) + m(9, 1));
            imSet(srcData.data, x, y, width, height, 2, m(10, r) + m(11, g) + m(12, b) + m(13, a) + m(14, 1));
            imSet(srcData.data, x, y, width, height, 3, m(15, r) + m(16, g) + m(17, b) + m(18, a) + m(19, 1));
          }
        }

        ctx.clearRect(0, 0, width, height);
        ctx.putImageData(srcData, 0, 0);
      };
    };

    svg.Element.feColorMatrix.prototype = new svg.Element.ElementBase();

    svg.Element.feGaussianBlur = function (node) {
      this.base = svg.Element.ElementBase;
      this.base(node);
      this.blurRadius = Math.floor(this.attribute('stdDeviation').numValue());
      this.extraFilterDistance = this.blurRadius;

      this.apply = function (ctx, x, y, width, height) {
        if (typeof stackblur.canvasRGBA == 'undefined') {
          svg.log('ERROR: StackBlur.js must be included for blur to work');
          return;
        } // StackBlur requires canvas be on document


        ctx.canvas.id = svg.UniqueId();
        ctx.canvas.style.display = 'none';
        document.body.appendChild(ctx.canvas);
        stackblur.canvasRGBA(ctx.canvas.id, x, y, width, height, this.blurRadius);
        document.body.removeChild(ctx.canvas);
      };
    };

    svg.Element.feGaussianBlur.prototype = new svg.Element.ElementBase(); // title element, do nothing

    svg.Element.title = function (node) {};

    svg.Element.title.prototype = new svg.Element.ElementBase(); // desc element, do nothing

    svg.Element.desc = function (node) {};

    svg.Element.desc.prototype = new svg.Element.ElementBase();

    svg.Element.MISSING = function (node) {
      svg.log('ERROR: Element \'' + node.nodeName + '\' not yet implemented.');
    };

    svg.Element.MISSING.prototype = new svg.Element.ElementBase(); // element factory

    svg.CreateElement = function (node) {
      var className = node.nodeName.replace(/^[^:]+:/, ''); // remove namespace

      className = className.replace(/\-/g, ''); // remove dashes

      var e = null;

      if (typeof svg.Element[className] != 'undefined') {
        e = new svg.Element[className](node);
      } else {
        e = new svg.Element.MISSING(node);
      }

      e.type = node.nodeName;
      return e;
    }; // load from url


    svg.load = function (ctx, url) {
      svg.loadXml(ctx, svg.ajax(url));
    }; // load from xml


    svg.loadXml = function (ctx, xml) {
      svg.loadXmlDoc(ctx, svg.parseXml(xml));
    };

    svg.loadXmlDoc = function (ctx, dom) {
      svg.init(ctx);

      var mapXY = function mapXY(p) {
        var e = ctx.canvas;

        while (e) {
          p.x -= e.offsetLeft;
          p.y -= e.offsetTop;
          e = e.offsetParent;
        }

        if (window.scrollX) p.x += window.scrollX;
        if (window.scrollY) p.y += window.scrollY;
        return p;
      }; // bind mouse


      if (svg.opts['ignoreMouse'] != true) {
        ctx.canvas.onclick = function (e) {
          var p = mapXY(new svg.Point(e != null ? e.clientX : event.clientX, e != null ? e.clientY : event.clientY));
          svg.Mouse.onclick(p.x, p.y);
        };

        ctx.canvas.onmousemove = function (e) {
          var p = mapXY(new svg.Point(e != null ? e.clientX : event.clientX, e != null ? e.clientY : event.clientY));
          svg.Mouse.onmousemove(p.x, p.y);
        };
      }

      var e = svg.CreateElement(dom.documentElement);
      e.root = true;
      e.addStylesFromStyleDefinition(); // render loop

      var isFirstRender = true;

      var draw = function draw() {
        svg.ViewPort.Clear();
        if (ctx.canvas.parentNode) svg.ViewPort.SetCurrent(ctx.canvas.parentNode.clientWidth, ctx.canvas.parentNode.clientHeight);

        if (svg.opts['ignoreDimensions'] != true) {
          // set canvas size
          if (e.style('width').hasValue()) {
            ctx.canvas.width = e.style('width').toPixels('x');
            ctx.canvas.style.width = ctx.canvas.width + 'px';
          }

          if (e.style('height').hasValue()) {
            ctx.canvas.height = e.style('height').toPixels('y');
            ctx.canvas.style.height = ctx.canvas.height + 'px';
          }
        }

        var cWidth = ctx.canvas.clientWidth || ctx.canvas.width;
        var cHeight = ctx.canvas.clientHeight || ctx.canvas.height;

        if (svg.opts['ignoreDimensions'] == true && e.style('width').hasValue() && e.style('height').hasValue()) {
          cWidth = e.style('width').toPixels('x');
          cHeight = e.style('height').toPixels('y');
        }

        svg.ViewPort.SetCurrent(cWidth, cHeight);
        if (svg.opts['offsetX'] != null) e.attribute('x', true).value = svg.opts['offsetX'];
        if (svg.opts['offsetY'] != null) e.attribute('y', true).value = svg.opts['offsetY'];

        if (svg.opts['scaleWidth'] != null || svg.opts['scaleHeight'] != null) {
          var xRatio = null,
              yRatio = null,
              viewBox = svg.ToNumberArray(e.attribute('viewBox').value);

          if (svg.opts['scaleWidth'] != null) {
            if (e.attribute('width').hasValue()) xRatio = e.attribute('width').toPixels('x') / svg.opts['scaleWidth'];else if (!isNaN(viewBox[2])) xRatio = viewBox[2] / svg.opts['scaleWidth'];
          }

          if (svg.opts['scaleHeight'] != null) {
            if (e.attribute('height').hasValue()) yRatio = e.attribute('height').toPixels('y') / svg.opts['scaleHeight'];else if (!isNaN(viewBox[3])) yRatio = viewBox[3] / svg.opts['scaleHeight'];
          }

          if (xRatio == null) {
            xRatio = yRatio;
          }

          if (yRatio == null) {
            yRatio = xRatio;
          }

          e.attribute('width', true).value = svg.opts['scaleWidth'];
          e.attribute('height', true).value = svg.opts['scaleHeight'];
          e.style('transform', true, true).value += ' scale(' + 1.0 / xRatio + ',' + 1.0 / yRatio + ')';
        } // clear and render


        if (svg.opts['ignoreClear'] != true) {
          ctx.clearRect(0, 0, cWidth, cHeight);
        }

        e.render(ctx);

        if (isFirstRender) {
          isFirstRender = false;
          if (typeof svg.opts['renderCallback'] == 'function') svg.opts['renderCallback'](dom);
        }
      };

      var waitingForImages = true;

      if (svg.ImagesLoaded()) {
        waitingForImages = false;
        draw();
      }

      svg.intervalID = setInterval(function () {
        var needUpdate = false;

        if (waitingForImages && svg.ImagesLoaded()) {
          waitingForImages = false;
          needUpdate = true;
        } // need update from mouse events?


        if (svg.opts['ignoreMouse'] != true) {
          needUpdate = needUpdate | svg.Mouse.hasEvents();
        } // need update from animations?


        if (svg.opts['ignoreAnimation'] != true) {
          for (var i = 0; i < svg.Animations.length; i++) {
            needUpdate = needUpdate | svg.Animations[i].update(1000 / svg.FRAMERATE);
          }
        } // need update from redraw?


        if (typeof svg.opts['forceRedraw'] == 'function') {
          if (svg.opts['forceRedraw']() == true) needUpdate = true;
        } // render if needed


        if (needUpdate) {
          draw();
          svg.Mouse.runEvents(); // run and clear our events
        }
      }, 1000 / svg.FRAMERATE);
    };

    svg.stop = function () {
      if (svg.intervalID) {
        clearInterval(svg.intervalID);
      }
    };

    svg.Mouse = new function () {
      this.events = [];

      this.hasEvents = function () {
        return this.events.length != 0;
      };

      this.onclick = function (x, y) {
        this.events.push({
          type: 'onclick',
          x: x,
          y: y,
          run: function run(e) {
            if (e.onclick) e.onclick();
          }
        });
      };

      this.onmousemove = function (x, y) {
        this.events.push({
          type: 'onmousemove',
          x: x,
          y: y,
          run: function run(e) {
            if (e.onmousemove) e.onmousemove();
          }
        });
      };

      this.eventElements = [];

      this.checkPath = function (element, ctx) {
        for (var i = 0; i < this.events.length; i++) {
          var e = this.events[i];
          if (ctx.isPointInPath && ctx.isPointInPath(e.x, e.y)) this.eventElements[i] = element;
        }
      };

      this.checkBoundingBox = function (element, bb) {
        for (var i = 0; i < this.events.length; i++) {
          var e = this.events[i];
          if (bb.isPointInBox(e.x, e.y)) this.eventElements[i] = element;
        }
      };

      this.runEvents = function () {
        svg.ctx.canvas.style.cursor = '';

        for (var i = 0; i < this.events.length; i++) {
          var e = this.events[i];
          var element = this.eventElements[i];

          while (element) {
            e.run(element);
            element = element.parent;
          }
        } // done running, clear


        this.events = [];
        this.eventElements = [];
      };
    }();
    return svg;
  }
  var canvgBrowser = canvg;

  /**
      @function svgPresets
      @desc Adds SVG default attributes to a d3 selection in order to render it properly.
      @param {Selection} selection
  */
  function svgPresets (selection) {
    // sets "stroke-width" attribute to `0` if not defined
    var strokeWidth = selection.attr("stroke-width");
    selection.attr("stroke-width", !strokeWidth ? 0 : strokeWidth); // if there is no stroke, set the stroke color to "transparent" (fixes weird text rendering)

    if (!strokeWidth) selection.attr("stroke", "transparent"); // sets "fill-opacity" attribute to `0` if fill is "transparent" or "none"

    var transparent = ["none", "transparent"].includes(selection.attr("fill"));
    var fillOpacity = selection.attr("fill-opacity");
    selection.attr("fill-opacity", transparent ? 0 : fillOpacity); // "aria-label" properties interfere with text labels \_()_/

    selection.attr("aria-label", null);
  }

  /**
      @function htmlPresets
      @desc Adds HTML default styles to a d3 selection in order to render it properly.
      @param {Selection} selection
  */

  function htmlPresets (selection) {
    selection.selectAll("*").each(function () {
      var tag = this.tagName.toLowerCase();

      if (!["option"].includes(tag)) {
        var elem = _select(this);
        /* forces minor unnoticible letter-spacing on any element where it is not defined to fix IE */

        var letterSpacing = elem.style("letter-spacing");
        elem.style("letter-spacing", letterSpacing === "normal" ? "0.1px" : letterSpacing);
      }
    });
  }

  function _slicedToArray$3(arr, i) {
    return _arrayWithHoles$3(arr) || _iterableToArrayLimit$3(arr, i) || _nonIterableRest$3();
  }

  function _nonIterableRest$3() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance");
  }

  function _iterableToArrayLimit$3(arr, i) {
    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _arrayWithHoles$3(arr) {
    if (Array.isArray(arr)) return arr;
  }
  var defaultOptions = {
    background: false,
    callback: function callback() {},
    exclude: [],
    padding: 0,
    scale: 1
  };
  var canvgOptions = {
    ignoreMouse: true,
    ignoreAnimation: true,
    ignoreDimensions: true,
    ignoreClear: true
  };
  /**
      @function parseTransform
      @desc Extracts scale, x, and y position from an elements "transform" attribute, respecting cross-browser render differences.
      @param {HTMLElement} elem The element to be analyzed.
      @private
  */

  function parseTransform(elem) {
    var property = _select(elem).attr("transform");
    var scale = 1,
        x = 0,
        y = 0;

    if (property) {
      scale = property.match(/scale\(([^a-z]+)\)/i);
      if (scale) scale = parseFloat(scale[1]);else scale = 1;
      var translate = property.match(/translate\(([^a-z]+)\)/i);

      if (translate) {
        var _translate$1$replace$ = translate[1].replace(", ", ",").replace(/([^a-z]),*\s([^a-z])/gi, "$1,$2").split(",").map(function (d) {
          return parseFloat(d) * scale;
        });

        var _translate$1$replace$2 = _slicedToArray$3(_translate$1$replace$, 2);

        x = _translate$1$replace$2[0];
        y = _translate$1$replace$2[1];
      }
    }

    return [scale, x, y];
  }
  /**
      @function dom2canvas
      @desc Renders HTML/SVG elements to a shared canvas.
      @param {HTMLElement|Object|Array} elem The element or array of elements to be rendered to a single canvas. Additionally, a complex object can be passed as an element which can contain specific other properties.
      @param {Number} [elem.x] The x offset of the element within the rendered canvas.
      @param {Number} [elem.y] The y offset of the element within the rendered canvas.
      @param {Object} [options] Additional options to specify.
      @param {String} [options.background] Background color of the rendered canvas.
      @param {Function} [options.callback] Callback function to be passed the canvas element after rendering.
      @param {Array} [options.excludes] An array of HTMLElement objects to be excluded from the render.
      @param {Number} [options.height] Pixel height for the final output. If a height value has not been passed, it will be inferred from the sizing of the first DOM element passed.
      @param {Number} [options.padding = 0] Outer padding for the final file.
      @param {Number} [options.scale = 1] Scale for the final file.
      @param {Number} [options.width] Pixel width for the final output. If a width value has not been passed, it will be inferred from the sizing of the first DOM element passed.
  */


  function dom2canvas (elem, options) {
    if (!elem) return;
    if (!(elem instanceof Array)) elem = [elem];
    options = Object.assign({}, defaultOptions, options);
    var IE = new RegExp(/(MSIE|Trident\/|Edge\/)/i).test(navigator.userAgent);
    var ratio = window ? window.devicePixelRatio || 1 : 1;
    var reference = elem[0];
    if (reference.constructor === Object) reference = reference.element;
    var height = options.height || parseFloat(_select(reference).style("height")) + parseFloat(_select(reference).style("padding-top")) + parseFloat(_select(reference).style("padding-bottom")),
        width = options.width || parseFloat(_select(reference).style("width")) + parseFloat(_select(reference).style("padding-left")) + parseFloat(_select(reference).style("padding-right"));
    var layerX,
        layerY,
        offsetX = 0,
        offsetY = 0;

    if (reference.getBoundingClientRect) {
      var bounds = reference.getBoundingClientRect();
      offsetX = bounds.left;
      offsetY = bounds.top;
    } else {
      offsetX = reference.offsetLeft;
      offsetY = reference.offsetTop;
    }

    var canvas = document.createElement("canvas");
    canvas.width = (width + options.padding * 2) * options.scale * ratio;
    canvas.height = (height + options.padding * 2) * options.scale * ratio;
    canvas.style.width = (width + options.padding * 2) * options.scale;
    canvas.style.height = (height + options.padding * 2) * options.scale;
    var context = canvas.getContext("2d");
    context.scale(options.scale * ratio, options.scale * ratio);
    context.clearRect(0, 0, canvas.width / ratio, canvas.height / ratio);

    if (options.background) {
      context.beginPath();
      context.rect(0, 0, canvas.width / ratio, canvas.height / ratio);
      context.fillStyle = options.background;
      context.fill();
    }

    var layers = [];
    /**
     * Determines how a given DOM element should be rendered.
     * @param {Object} trans ancestral transform properties
     * @private
     */

    function checkRender(trans) {
      var tag = (this.tagName || "").toLowerCase();
      if (options.exclude.includes(this) || tag === "foreignobject") return;
      var transform = Object.assign({}, trans); // strips translate and scale from transform property

      if (this.tagName) {
        var opacity = _select(this).attr("opacity") || _select(this).style("opacity");
        var display = _select(this).style("display");
        var visibility = _select(this).style("visibility");
        if (display === "none" || visibility === "hidden" || opacity && parseFloat(opacity) === 0) return;

        var _tag = this.tagName.toLowerCase();

        if (_tag.length && ["defs", "title", "desc"].includes(_tag)) return;

        if (_tag === "svg") {
          // do not perform this transform for SVGs nested within other SVGs
          if (!transform.svg) {
            var _this$getBoundingClie = this.getBoundingClientRect(),
                left = _this$getBoundingClie.left,
                top = _this$getBoundingClie.top;

            transform.x += left - offsetX;
            transform.y += top - offsetY;
            transform.svg = true;
          }

          var x = _select(this).attr("x");
          x = x ? parseFloat(x) * transform.scale : 0;
          transform.x += x;
          var y = _select(this).attr("y");
          y = y ? parseFloat(y) * transform.scale : 0;
          transform.y += y;
          transform.clip = {
            height: parseFloat(_select(this).attr("height") || _select(this).style("height")),
            width: parseFloat(_select(this).attr("width") || _select(this).style("width")),
            x: x,
            y: y
          };
        } else {
          var _x = _select(this).attr("x");

          if (_x) transform.x += parseFloat(_x) * transform.scale;

          var _y = _select(this).attr("y");

          if (_y) transform.y += parseFloat(_y) * transform.scale;
        }
      }

      if (!tag.length) {
        var test = (this.wholeText || "").replace(/\s/g, "");

        if (test.length) {
          var text = this.nodeValue.replace(/^\s*/, "").replace(/^\n/, "").replace(/^\s*/, "").replace(/\n$/, "").replace(/\s*$/, "").replace(/\n$/, "");
          layers.push({
            type: "text",
            style: this.parentNode,
            value: text,
            x: transform.x,
            y: transform.y
          });
        }
      } else if (tag === "text") {
        var _elem = this.cloneNode(true);

        _select(_elem).call(svgPresets);
        layers.push(Object.assign({}, transform, {
          type: "svg",
          value: _elem
        }));
      } else if (["image", "img"].includes(tag)) {
        var url = _select(this).attr("href") || _select(this).attr("xlink:href");

        if (url.length) {
          var h = parseFloat(_select(this).attr("height")) * transform.scale,
              w = parseFloat(_select(this).attr("width")) * transform.scale;
          var data = {
            clip: transform.clip,
            height: h,
            loaded: false,
            type: "img",
            width: w,
            x: transform.x,
            y: transform.y
          };
          layers.push(data);
          var img = new Image();
          img.crossOrigin = "Anonymous";

          img.onload = function () {
            var canvas2 = document.createElement("canvas");
            var ctx2 = canvas2.getContext("2d");
            canvas2.height = h * ratio;
            canvas2.width = w * ratio;
            ctx2.drawImage(this, 0, 0, w * ratio, h * ratio);
            var himg = document.createElement("img");
            himg.src = canvas2.toDataURL("image/png");
            data.value = himg;
            data.loaded = true;
          };

          img.src = url;
        }
      } else if (!["svg", "g", "text"].includes(tag) && !_select(this).selectAll("svg").size()) {
        var s = options.scale * ratio;
        var _data = {
          height: Math.floor(height + options.padding * 2 + offsetY),
          loaded: false,
          type: "html",
          width: Math.floor(width + options.padding * 2 + offsetX),
          x: Math.floor(layerX - offsetX),
          y: Math.floor(layerY - offsetY)
        };
        var tempCanvas = document.createElement("canvas");
        tempCanvas.width = _data.width * s;
        tempCanvas.height = _data.height * s;
        tempCanvas.style.width = "".concat(_data.width * s, "px");
        tempCanvas.style.height = "".concat(_data.height * s, "px");
        var tempContext = tempCanvas.getContext("2d");
        tempContext.scale(s, s);
        layers.push(_data);
        htmlPresets(_select(this));
        html2canvas(this, {
          allowTaint: true,
          canvas: tempCanvas,
          letterRendering: true
        }).then(function (c) {
          _data.value = c;
          _data.loaded = true;
        });
      } else if (tag !== "svg" && this.childNodes.length > 0 && !_select(this).selectAll("image, img, svg").size()) {
        var _elem2 = this.cloneNode(true);

        _select(_elem2).selectAll("*").each(function () {
          _select(this).call(svgPresets);
          if (_select(this).attr("opacity") === "0") this.parentNode.removeChild(this);
        });
        layers.push(Object.assign({}, transform, {
          type: "svg",
          value: _elem2,
          tag: tag
        }));
      } else if (this.childNodes.length > 0) {
        var _parseTransform = parseTransform(this),
            _parseTransform2 = _slicedToArray$3(_parseTransform, 3),
            scale = _parseTransform2[0],
            _x2 = _parseTransform2[1],
            _y2 = _parseTransform2[2];

        transform.scale *= scale;
        transform.x += _x2;
        transform.y += _y2;
        checkChildren(this, transform);
      } else {
        // catches all SVG shapes
        var _elem3 = this.cloneNode(true);

        _select(_elem3).selectAll("*").each(function () {
          if (_select(this).attr("opacity") === "0") this.parentNode.removeChild(this);
        });

        if (tag === "line") {
          _select(_elem3).attr("x1", parseFloat(_select(_elem3).attr("x1")) + transform.x);
          _select(_elem3).attr("x2", parseFloat(_select(_elem3).attr("x2")) + transform.x);
          _select(_elem3).attr("y1", parseFloat(_select(_elem3).attr("y1")) + transform.y);
          _select(_elem3).attr("y2", parseFloat(_select(_elem3).attr("y2")) + transform.y);
        } else if (tag === "path") {
          var _parseTransform3 = parseTransform(_elem3),
              _parseTransform4 = _slicedToArray$3(_parseTransform3, 3),
              _scale = _parseTransform4[0],
              _x3 = _parseTransform4[1],
              _y3 = _parseTransform4[2];

          if (_select(_elem3).attr("transform")) _select(_elem3).attr("transform", "scale(".concat(_scale, ")translate(").concat(_x3 + transform.x, ",").concat(_y3 + transform.y, ")"));
        }

        _select(_elem3).call(svgPresets);
        var fill = _select(_elem3).attr("fill");
        var defFill = fill && fill.indexOf("url") === 0; // if (defFill) select(elem).attr("fill-opacity", 0);

        layers.push(Object.assign({}, transform, {
          type: "svg",
          value: _elem3,
          tag: tag
        }));

        if (defFill) {
          var def = _select(fill.slice(4, -1)).node().cloneNode(true);
          var defTag = (def.tagName || "").toLowerCase();

          if (defTag === "pattern") {
            var _parseTransform5 = parseTransform(_elem3),
                _parseTransform6 = _slicedToArray$3(_parseTransform5, 3),
                _scale2 = _parseTransform6[0],
                _x4 = _parseTransform6[1],
                _y4 = _parseTransform6[2];

            transform.scale *= _scale2;
            transform.x += _x4;
            transform.y += _y4;
            checkChildren(def, transform);
          }
        }
      }
    }
    /**
     * Performs "checkRender" on all childNodes of a DOM element (used recursively by checkRender)
     * @param {HTMLElement} e DOM node to traverse
     * @param {Object} trans ancestral transform properties
     * @private
     */


    function checkChildren(e, trans) {
      selectAll(e.childNodes).each(function () {
        checkRender.bind(this)(trans);
      });
    }

    for (var i = 0; i < elem.length; i++) {
      var e = elem[i],
          _options = {
        scale: 1,
        x: 0,
        y: 0,
        svg: false
      };

      if (e.constructor === Object) {
        _options = Object.assign(_options, e);
        e = e.element;
      }

      layerX = _options.x;
      layerY = _options.y;
      checkRender.bind(e)(_options);
    }
    /**
     * Checks the status of each render layer every 500ms, and finishes render once all are complete.
     * @private
     */


    function checkStatus() {
      var allDone = true;

      for (var _i2 = 0; _i2 < layers.length; _i2++) {
        if (layers[_i2].loaded === false) {
          allDone = false;
          break;
        }
      }

      if (allDone) finish();else setTimeout(checkStatus, 500);
    }

    checkStatus();
    /**
     * Finishes the render after all layers have been rendered to canvas.
     * @private
     */

    function finish() {
      for (var _i3 = 0; _i3 < layers.length; _i3++) {
        var layer = layers[_i3];
        var clip = layer.clip || {
          height: height,
          width: width,
          x: 0,
          y: 0
        };

        switch (layer.type) {
          case "img":
            context.save();
            context.beginPath();
            context.translate(options.padding + clip.x, options.padding + clip.y);
            context.rect(0, 0, clip.width, clip.height);
            context.clip();
            context.drawImage(layer.value, layer.x + clip.x, layer.y + clip.y, layer.width, layer.height);
            context.restore();
            break;

          case "html":
            context.save();
            context.beginPath();
            context.translate(options.padding, options.padding);
            context.drawImage(layer.value, layer.x, layer.y, layer.width, layer.height);
            context.restore();
            break;

          case "text":
            var parent = _select(layer.style);
            var title = layer.value.replace(/&/g, "&amp;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
            var fC = parent.style("color"),
                fS = parent.style("font-size");
            var fF = parent.style("font-family").split(",")[0];
            if (fF.indexOf("'") !== 0) fF = "'".concat(fF, "'");
            var text = "<text stroke='none' dy='".concat(fS, "' fill='").concat(fC, "' font-family=").concat(fF, " font-size='").concat(fS, "'>").concat(title, "</text>");
            context.save();
            context.translate(options.padding, options.padding);
            canvgBrowser(canvas, text, Object.assign({}, canvgOptions, {
              offsetX: layer.x,
              offsetY: layer.y
            }));
            context.restore();
            break;

          case "svg":
            var outer = IE ? new XMLSerializer().serializeToString(layer.value) : layer.value.outerHTML;
            context.save();
            context.translate(options.padding + clip.x + layer.x, options.padding + clip.y + layer.y);
            context.rect(0, 0, clip.width, clip.height);
            context.clip();
            canvgBrowser(canvas, outer, Object.assign({}, canvgOptions, {
              offsetX: layer.x + clip.x,
              offsetY: layer.y + clip.y
            }));
            context.restore();
            break;

          default:
            console.warn("uncaught", layer);
            break;
        }
      }

      options.callback(canvas);
    }
  }

  /* canvas-toBlob.js
   * A canvas.toBlob() implementation.
   * 2016-05-26
   * 
   * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr
   * License: MIT
   *   See https://github.com/eligrey/canvas-toBlob.js/blob/master/LICENSE.md
   */

  /*global self */

  /*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,
    plusplus: true */

  /*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */

  (function (view) {

    var Uint8Array = view.Uint8Array,
        HTMLCanvasElement = view.HTMLCanvasElement,
        canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype,
        is_base64_regex = /\s*;\s*base64\s*(?:;|$)/i,
        to_data_url = "toDataURL",
        base64_ranks,
        decode_base64 = function decode_base64(base64) {
      var len = base64.length,
          buffer = new Uint8Array(len / 4 * 3 | 0),
          i = 0,
          outptr = 0,
          last = [0, 0],
          state = 0,
          save = 0,
          rank,
          code,
          undef;

      while (len--) {
        code = base64.charCodeAt(i++);
        rank = base64_ranks[code - 43];

        if (rank !== 255 && rank !== undef) {
          last[1] = last[0];
          last[0] = code;
          save = save << 6 | rank;
          state++;

          if (state === 4) {
            buffer[outptr++] = save >>> 16;

            if (last[1] !== 61
            /* padding character */
            ) {
                buffer[outptr++] = save >>> 8;
              }

            if (last[0] !== 61
            /* padding character */
            ) {
                buffer[outptr++] = save;
              }

            state = 0;
          }
        }
      } // 2/3 chance there's going to be some null bytes at the end, but that
      // doesn't really matter with most image formats.
      // If it somehow matters for you, truncate the buffer up outptr.


      return buffer;
    };

    if (Uint8Array) {
      base64_ranks = new Uint8Array([62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, 0, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51]);
    }

    if (HTMLCanvasElement && (!canvas_proto.toBlob || !canvas_proto.toBlobHD)) {
      if (!canvas_proto.toBlob) canvas_proto.toBlob = function (callback, type
      /*, ...args*/
      ) {
        if (!type) {
          type = "image/png";
        }

        if (this.mozGetAsFile) {
          callback(this.mozGetAsFile("canvas", type));
          return;
        }

        if (this.msToBlob && /^\s*image\/png\s*(?:$|;)/i.test(type)) {
          callback(this.msToBlob());
          return;
        }

        var args = Array.prototype.slice.call(arguments, 1),
            dataURI = this[to_data_url].apply(this, args),
            header_end = dataURI.indexOf(","),
            data = dataURI.substring(header_end + 1),
            is_base64 = is_base64_regex.test(dataURI.substring(0, header_end)),
            blob;

        if (Blob.fake) {
          // no reason to decode a data: URI that's just going to become a data URI again
          blob = new Blob();

          if (is_base64) {
            blob.encoding = "base64";
          } else {
            blob.encoding = "URI";
          }

          blob.data = data;
          blob.size = data.length;
        } else if (Uint8Array) {
          if (is_base64) {
            blob = new Blob([decode_base64(data)], {
              type: type
            });
          } else {
            blob = new Blob([decodeURIComponent(data)], {
              type: type
            });
          }
        }

        callback(blob);
      };

      if (!canvas_proto.toBlobHD && canvas_proto.toDataURLHD) {
        canvas_proto.toBlobHD = function () {
          to_data_url = "toDataURLHD";
          var blob = this.toBlob();
          to_data_url = "toDataURL";
          return blob;
        };
      } else {
        canvas_proto.toBlobHD = canvas_proto.toBlob;
      }
    }
  })(typeof self !== "undefined" && self || typeof window !== "undefined" && window || commonjsGlobal.content || commonjsGlobal);

  var FileSaver = createCommonjsModule(function (module) {
    /* FileSaver.js
     * A saveAs() FileSaver implementation.
     * 1.3.2
     * 2016-06-16 18:25:19
     *
     * By Eli Grey, http://eligrey.com
     * License: MIT
     *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md
     */

    /*global self */

    /*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */

    /*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
    var saveAs = saveAs || function (view) {

      if (typeof view === "undefined" || typeof navigator !== "undefined" && /MSIE [1-9]\./.test(navigator.userAgent)) {
        return;
      }

      var doc = view.document // only get URL when necessary in case Blob.js hasn't overridden it yet
      ,
          get_URL = function get_URL() {
        return view.URL || view.webkitURL || view;
      },
          save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a"),
          can_use_save_link = "download" in save_link,
          click = function click(node) {
        var event = new MouseEvent("click");
        node.dispatchEvent(event);
      },
          is_safari = /constructor/i.test(view.HTMLElement) || view.safari,
          is_chrome_ios = /CriOS\/[\d]+/.test(navigator.userAgent),
          throw_outside = function throw_outside(ex) {
        (view.setImmediate || view.setTimeout)(function () {
          throw ex;
        }, 0);
      },
          force_saveable_type = "application/octet-stream" // the Blob API is fundamentally broken as there is no "downloadfinished" event to subscribe to
      ,
          arbitrary_revoke_timeout = 1000 * 40 // in ms
      ,
          revoke = function revoke(file) {
        var revoker = function revoker() {
          if (typeof file === "string") {
            // file is an object URL
            get_URL().revokeObjectURL(file);
          } else {
            // file is a File
            file.remove();
          }
        };

        setTimeout(revoker, arbitrary_revoke_timeout);
      },
          dispatch = function dispatch(filesaver, event_types, event) {
        event_types = [].concat(event_types);
        var i = event_types.length;

        while (i--) {
          var listener = filesaver["on" + event_types[i]];

          if (typeof listener === "function") {
            try {
              listener.call(filesaver, event || filesaver);
            } catch (ex) {
              throw_outside(ex);
            }
          }
        }
      },
          auto_bom = function auto_bom(blob) {
        // prepend BOM for UTF-8 XML and text/* types (including HTML)
        // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF
        if (/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
          return new Blob([String.fromCharCode(0xFEFF), blob], {
            type: blob.type
          });
        }

        return blob;
      },
          FileSaver = function FileSaver(blob, name, no_auto_bom) {
        if (!no_auto_bom) {
          blob = auto_bom(blob);
        } // First try a.download, then web filesystem, then object URLs


        var filesaver = this,
            type = blob.type,
            force = type === force_saveable_type,
            object_url,
            dispatch_all = function dispatch_all() {
          dispatch(filesaver, "writestart progress write writeend".split(" "));
        } // on any filesys errors revert to saving with object URLs
        ,
            fs_error = function fs_error() {
          if ((is_chrome_ios || force && is_safari) && view.FileReader) {
            // Safari doesn't allow downloading of blob urls
            var reader = new FileReader();

            reader.onloadend = function () {
              var url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');
              var popup = view.open(url, '_blank');
              if (!popup) view.location.href = url;
              url = undefined; // release reference before dispatching

              filesaver.readyState = filesaver.DONE;
              dispatch_all();
            };

            reader.readAsDataURL(blob);
            filesaver.readyState = filesaver.INIT;
            return;
          } // don't create more object URLs than needed


          if (!object_url) {
            object_url = get_URL().createObjectURL(blob);
          }

          if (force) {
            view.location.href = object_url;
          } else {
            var opened = view.open(object_url, "_blank");

            if (!opened) {
              // Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html
              view.location.href = object_url;
            }
          }

          filesaver.readyState = filesaver.DONE;
          dispatch_all();
          revoke(object_url);
        };

        filesaver.readyState = filesaver.INIT;

        if (can_use_save_link) {
          object_url = get_URL().createObjectURL(blob);
          setTimeout(function () {
            save_link.href = object_url;
            save_link.download = name;
            click(save_link);
            dispatch_all();
            revoke(object_url);
            filesaver.readyState = filesaver.DONE;
          });
          return;
        }

        fs_error();
      },
          FS_proto = FileSaver.prototype,
          saveAs = function saveAs(blob, name, no_auto_bom) {
        return new FileSaver(blob, name || blob.name || "download", no_auto_bom);
      }; // IE 10+ (native saveAs)


      if (typeof navigator !== "undefined" && navigator.msSaveOrOpenBlob) {
        return function (blob, name, no_auto_bom) {
          name = name || blob.name || "download";

          if (!no_auto_bom) {
            blob = auto_bom(blob);
          }

          return navigator.msSaveOrOpenBlob(blob, name);
        };
      }

      FS_proto.abort = function () {};

      FS_proto.readyState = FS_proto.INIT = 0;
      FS_proto.WRITING = 1;
      FS_proto.DONE = 2;
      FS_proto.error = FS_proto.onwritestart = FS_proto.onprogress = FS_proto.onwrite = FS_proto.onabort = FS_proto.onerror = FS_proto.onwriteend = null;
      return saveAs;
    }(typeof self !== "undefined" && self || typeof window !== "undefined" && window || commonjsGlobal.content); // `self` is undefined in Firefox for Android content script context
    // while `this` is nsIContentFrameMessageManager
    // with an attribute `content` that corresponds to the window


    if ( module.exports) {
      module.exports.saveAs = saveAs;
    }
  });
  var FileSaver_1 = FileSaver.saveAs;

  var defaultOptions$1 = {
    filename: "download",
    type: "png"
  };
  /**
      @function saveElement
      @desc Downloads an HTML Element as a bitmap PNG image.
      @param {HTMLElement|Array} elem A single element or array of elements to be saved to one file.
      @param {Object} [options] Additional options to specify.
      @param {String} [options.filename = "download"] Filename for the downloaded file, without the extension.
      @param {String} [options.type = "png"] File type of the saved document. Accepted values are `"png"` and `"jpg"`.
      @param {Object} [renderOptions] Custom options to be passed to the dom2canvas function.
  */

  function saveElement (elem) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var renderOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
    if (!elem) return;
    options = Object.assign({}, defaultOptions$1, options);
    var IE = new RegExp(/(MSIE|Trident\/|Edge\/)/i).test(navigator.userAgent);

    if (!(elem instanceof Array) && options.type === "svg") {
      var outer = IE ? new XMLSerializer().serializeToString(elem) : elem.outerHTML;
      FileSaver_1(new Blob([outer], {
        type: "application/svg+xml"
      }), "".concat(options.filename, ".svg"));
    }

    dom2canvas(elem, Object.assign({}, renderOptions, {
      callback: function callback(canvas) {
        if (renderOptions.callback) renderOptions.callback(canvas);

        if (["jpg", "png"].includes(options.type)) {
          canvas.toBlob(function (blob) {
            return FileSaver_1(blob, "".concat(options.filename, ".").concat(options.type));
          });
        } // else if (options.type === "pdf") {
        //   const outputHeight = 11,
        //         outputWidth = 8.5;
        //   const aspect = canvas.width / canvas.height,
        //         orientation = aspect > 1 ? "landscape" : "portrait";
        //   const pdf = new JsPDF({
        //     orientation,
        //     unit: "in",
        //     format: [outputWidth, outputHeight]
        //   });
        //   let h = orientation === "landscape" ? outputWidth : outputHeight,
        //       left,
        //       top,
        //       w = orientation === "landscape" ? outputHeight : outputWidth;
        //   const margin = 0.5;
        //   if (aspect < w / h) {
        //     h -= margin * 2;
        //     const tempWidth = h * aspect;
        //     top = margin;
        //     left = (w - tempWidth) / 2;
        //     w = tempWidth;
        //   }
        //   else {
        //     w -= margin * 2;
        //     const tempHeight = w / aspect;
        //     left = margin;
        //     top = (h - tempHeight) / 2;
        //     h = tempHeight;
        //   }
        //   pdf.addImage(canvas, "canvas", left, top, w, h);
        //   pdf.save(options.filename);
        // }

      }
    }));
  }

  var formTypes = {
    Button: Button,
    Radio: Radio,
    Select: Select
  };
  /**
      @function _drawLegend
      @desc Renders the legend if this._legend is not falsy.
      @param {Array} dara The filtered data array to be displayed.
      @private
  */

  function drawControls () {
    var _this = this;

    var that = this;
    var padding = this._controlPadding() ? this._padding : {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    };
    var areas = ["left", "right", "top", "bottom"];

    var _loop = function _loop(a) {
      var area = areas[a];
      var controls = (_this._controls || []).filter(function (c) {
        return !c.position && area === "bottom" || c.position === area;
      });

      if (_this._downloadButton && _this._downloadPosition === area) {
        controls.push({
          data: [{
            text: _this._translate("Download"),
            value: 1
          }],
          label: "downloadButton",
          on: {
            click: function click() {
              var resize = _this._detectResize;
              if (resize) _this.detectResize(false).render();
              saveElement(_this._select.node(), Object.assign({
                title: _this._title || undefined
              }, _this._downloadConfig), {
                callback: function callback() {
                  setTimeout(function () {
                    if (resize) _this.detectResize(resize).render();
                  }, 5000);
                }
              });
            }
          },
          type: "Button"
        });
      }

      var wide = area === "top" || area === "bottom";
      var transform = {
        height: wide ? _this._height - (_this._margin.top + _this._margin.bottom) : _this._height - (_this._margin.top + _this._margin.bottom + padding.top + padding.bottom),
        width: wide ? _this._width - (_this._margin.left + _this._margin.right + padding.left + padding.right) : _this._width - (_this._margin.left + _this._margin.right)
      };
      transform.x = (wide ? _this._margin.left + padding.left : _this._margin.left) + (area === "right" ? _this._width - _this._margin.bottom : 0);
      transform.y = (wide ? _this._margin.top : _this._margin.top + padding.top) + (area === "bottom" ? _this._height - _this._margin.bottom : 0);
      var foreign = elem("foreignObject.d3plus-viz-controls-".concat(area), {
        condition: controls.length,
        enter: Object.assign({
          opacity: 0
        }, transform),
        exit: Object.assign({
          opacity: 0
        }, transform),
        parent: _this._select,
        transition: _this._transition,
        update: {
          height: transform.height,
          opacity: 1,
          width: transform.width
        }
      });
      var container = foreign.selectAll("div.d3plus-viz-controls-container").data([null]);
      container = container.enter().append("xhtml:div").attr("class", "d3plus-viz-controls-container").merge(container);

      if (controls.length) {
        var _loop2 = function _loop2(i) {
          var control = Object.assign({}, controls[i]);
          var on = {};

          if (control.on) {
            var _loop3 = function _loop3(event) {
              if ({}.hasOwnProperty.call(control.on, event)) {
                on[event] = function () {
                  control.on[event].bind(that)(this.value);
                };
              }
            };

            for (var event in control.on) {
              _loop3(event);
            }
          }

          var id = control.label || "".concat(area, "-").concat(i);

          if (!_this._controlCache[id]) {
            var type = control.type && formTypes[control.type] ? control.type : "Select";
            _this._controlCache[id] = new formTypes[type]().container(container.node());
            if (control.checked) _this._controlCache[id].checked(control.checked);
            if (control.selected) _this._controlCache[id].selected(control.selected);
          }

          delete control.checked;
          delete control.selected;

          _this._controlCache[id].config(control).config({
            on: on
          }).config(_this._controlConfig).render();
        };

        for (var i = 0; i < controls.length; i++) {
          _loop2(i);
        }

        container.style("display", ["top", "bottom"].includes(area) ? "block" : "inline-block").style("text-align", ["top", "bottom"].includes(area) ? "center" : area);
        var bounds = container.node().getBoundingClientRect();
        foreign.transition(_this._transition).attr("x", transform.x - (area === "right" ? bounds.width : 0)).attr("y", transform.y - (area === "bottom" ? bounds.height : 0)).attr("height", wide ? bounds.height : transform.height).attr("width", wide ? transform.width : bounds.width);
        _this._margin[area] += ["top", "bottom"].includes(area) ? bounds.height : bounds.width;
      }
    };

    for (var a = 0; a < areas.length; a++) {
      _loop(a);
    }
  }

  /**
      @function legendLabel
      @desc Default label function for the legend.
      @private
  */

  function legendLabel(d, i) {
    var l = this._drawLabel(d, i);

    return l instanceof Array ? l.join(", ") : l;
  }
  /**
      @function _drawLegend
      @desc Renders the legend if this._legend is not falsy.
      @param {Array} data The filtered data array to be displayed.
      @private
  */

  function drawLegend () {
    var _this = this;

    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

    if (this._legend) {
      var legendBounds = this._legendClass.outerBounds();

      var position = this._legendPosition;
      var wide = ["top", "bottom"].includes(position);
      var padding = this._legendPadding() ? this._padding : {
        top: 0,
        right: 0,
        bottom: 0,
        left: 0
      };
      var transform = {
        transform: "translate(".concat(wide ? this._margin.left + padding.left : this._margin.left, ", ").concat(wide ? this._margin.top : this._margin.top + padding.top, ")")
      };
      var legendGroup = elem("g.d3plus-viz-legend", {
        condition: this._legend && !this._legendConfig.select,
        enter: transform,
        parent: this._select,
        transition: this._transition,
        update: transform
      }).node();
      var legendData = [];

      var color = function color(d, i) {
        var shape = _this._shape(d, i);

        var attr = shape === "Line" ? "stroke" : "fill";
        var value = _this._shapeConfig[shape] && _this._shapeConfig[shape][attr] ? _this._shapeConfig[shape][attr] : _this._shapeConfig[attr];
        return typeof value === "function" ? value(d, i) : value;
      };

      var opacity = function opacity(d, i) {
        var shape = _this._shape(d, i);

        var value = _this._shapeConfig[shape] && _this._shapeConfig[shape].opacity ? _this._shapeConfig[shape].opacity : _this._shapeConfig.opacity;
        return typeof value === "function" ? value(d, i) : value;
      };

      var fill = function fill(d, i) {
        return "".concat(color(d, i), "_").concat(opacity(d, i));
      };

      nest().key(fill).rollup(function (leaves) {
        return legendData.push(objectMerge(leaves, _this._aggs));
      }).entries(this._colorScale ? data.filter(function (d, i) {
        return _this._colorScale(d, i) === undefined;
      }) : data);
      legendData.sort(this._legendSort);

      var hidden = function hidden(d, i) {
        var id = _this._id(d, i);

        if (id instanceof Array) id = id[0];
        return _this._hidden.includes(id) || _this._solo.length && !_this._solo.includes(id);
      };

      this._legendClass.id(fill).align(wide ? "center" : position).direction(wide ? "row" : "column").duration(this._duration).data(legendData.length > this._legendCutoff || this._colorScale ? legendData : []).height(wide ? this._height - (this._margin.bottom + this._margin.top) : this._height - (this._margin.bottom + this._margin.top + padding.bottom + padding.top)).locale(this._locale).select(legendGroup).verticalAlign(!wide ? "middle" : position).width(wide ? this._width - (this._margin.left + this._margin.right + padding.left + padding.right) : this._width - (this._margin.left + this._margin.right)).shapeConfig(configPrep.bind(this)(this._shapeConfig, "legend")).config(this._legendConfig).shapeConfig({
        fill: function fill(d, i) {
          return hidden(d, i) ? _this._hiddenColor(d, i) : color(d, i);
        },
        labelConfig: {
          fontOpacity: function fontOpacity(d, i) {
            return hidden(d, i) ? _this._hiddenOpacity(d, i) : 1;
          }
        },
        opacity: opacity
      }).render();

      if (!this._legendConfig.select && legendBounds.height) {
        if (wide) this._margin[position] += legendBounds.height + this._legendClass.padding() * 2;else this._margin[position] += legendBounds.width + this._legendClass.padding() * 2;
      }
    }
  }

  /**
      @function setTimeFilter
      @desc Determines whether or not to update the timeFilter method of the Viz.
      @param {Array|Date} The timeline selection given from the d3 brush.
      @private
  */

  function setTimeFilter(s) {
    var _this = this;

    if (!(s instanceof Array)) s = [s, s];

    if (JSON.stringify(s) !== JSON.stringify(this._timelineSelection)) {
      this._timelineSelection = s;
      s = s.map(Number);
      this.timeFilter(function (d) {
        var ms = date$2(_this._time(d)).getTime();
        return ms >= s[0] && ms <= s[1];
      }).render();
    }
  }
  /**
      @function _drawTimeline
      @desc Renders the timeline if this._time and this._timeline are not falsy and there are more than 1 tick available.
      @param {Array} data The filtered data array to be displayed.
      @private
  */


  function drawTimeline () {
    var _this2 = this;

    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    var timelinePossible = this._time && this._timeline;
    var ticks = timelinePossible ? unique(this._data.map(this._time)).map(date$2) : [];
    timelinePossible = timelinePossible && ticks.length > 1;
    var padding = this._timelinePadding() ? this._padding : {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    };
    var transform = {
      transform: "translate(".concat(this._margin.left + padding.left, ", 0)")
    };
    var timelineGroup = elem("g.d3plus-viz-timeline", {
      condition: timelinePossible,
      enter: transform,
      parent: this._select,
      transition: this._transition,
      update: transform
    }).node();

    if (timelinePossible) {
      var timeline = this._timelineClass.domain(extent(ticks)).duration(this._duration).height(this._height - this._margin.bottom).locale(this._locale).select(timelineGroup).ticks(ticks.sort(function (a, b) {
        return +a - +b;
      })).width(this._width - (this._margin.left + this._margin.right + padding.left + padding.right));

      if (timeline.selection() === undefined) {
        this._timelineSelection = extent(data, this._time).map(date$2);
        timeline.selection(this._timelineSelection);
      }

      var config = this._timelineConfig;
      timeline.config(config) // .on("brush", s => {
      //   setTimeFilter.bind(this)(s);
      //   if (config.on && config.on.brush) config.on.brush(s);
      // })
      .on("end", function (s) {
        setTimeFilter.bind(_this2)(s);
        if (config.on && config.on.end) config.on.end(s);
      }).render();
      this._margin.bottom += timeline.outerBounds().height + timeline.padding() * 2;
    }
  }

  /**
      @function _drawTitle
      @desc Draws a title if this._title is defined.
      @param {Array} [*data*] The currently filtered dataset.
      @private
  */

  function drawTitle () {
    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    var text = this._title ? this._title(data) : false;
    var padding = this._titlePadding() ? this._padding : {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    };
    var transform = {
      transform: "translate(".concat(this._margin.left + padding.left, ", ").concat(this._margin.top, ")")
    };
    var group = elem("g.d3plus-viz-title", {
      enter: transform,
      parent: this._select,
      transition: this._transition,
      update: transform
    }).node();

    this._titleClass.data(text ? [{
      text: text
    }] : []).locale(this._locale).select(group).width(this._width - (this._margin.left + this._margin.right + padding.left + padding.right)).config(this._titleConfig).render();

    this._margin.top += text ? group.getBBox().height : 0;
  }

  /**
      @function _drawTotal
      @desc Draws a total title if this._total is defined.
      @param {Array} [*data*] The currently filtered dataset.
      @private
  */

  function drawTotal () {
    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    var total = typeof this._total === "function" ? sum(data.map(this._total)) : this._total === true && this._size ? sum(data.map(this._size)) : false;
    var padding = this._totalPadding() ? this._padding : {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    };
    var transform = {
      transform: "translate(".concat(this._margin.left + padding.left, ", ").concat(this._margin.top, ")")
    };
    var group = elem("g.d3plus-viz-total", {
      enter: transform,
      parent: this._select,
      transition: this._transition,
      update: transform
    }).node();
    var visible = typeof total === "number";

    this._totalClass.data(visible ? [{
      text: this._totalFormat(total)
    }] : []).locale(this._locale).select(group).width(this._width - (this._margin.left + this._margin.right + padding.left + padding.right)).config(this._totalConfig).render();

    this._margin.top += visible ? group.getBBox().height + this._totalConfig.padding * 2 : 0;
  }

  /**
    @desc Given an HTMLElement and a "width" or "height" string, this function returns the current calculated size for the DOM element.
    @private
  */

  function _elementSize(element, s) {
    if (!element) return undefined;

    if (element.tagName === undefined || ["BODY", "HTML"].indexOf(element.tagName) >= 0) {
      var val = window["inner".concat(s.charAt(0).toUpperCase() + s.slice(1))];
      var elem = _select(element);

      if (s === "width") {
        val -= parseFloat(elem.style("margin-left"), 10);
        val -= parseFloat(elem.style("margin-right"), 10);
        val -= parseFloat(elem.style("padding-left"), 10);
        val -= parseFloat(elem.style("padding-right"), 10);
      } else {
        val -= parseFloat(elem.style("margin-top"), 10);
        val -= parseFloat(elem.style("margin-bottom"), 10);
        val -= parseFloat(elem.style("padding-top"), 10);
        val -= parseFloat(elem.style("padding-bottom"), 10);
      }

      return val;
    } else {
      var _val = parseFloat(_select(element).style(s), 10);

      if (typeof _val === "number" && _val > 0) return _val;else return _elementSize(element.parentNode, s);
    }
  }
  /**
      @function getSize
      @desc Finds the available width and height for a specified HTMLElement, traversing it's parents until it finds something with constrained dimensions. Falls back to the inner dimensions of the browser window if none is found.
      @param {HTMLElement} elem The HTMLElement to find dimensions for.
      @private
  */


  function getSize$1 (elem) {
    return [_elementSize(elem, "width"), _elementSize(elem, "height")];
  }

  /**
    @desc Returns a *Boolean* denoting whether or not a given DOM element is visible in the current window.
    @param {DOMElement} elem The DOM element to analyze.
    @param {Number} [buffer = 0] A pixel offset from the edge of the top and bottom of the screen. If a positive value, the element will be deemed visible when it is that many pixels away from entering the viewport. If negative, the element will have to enter the viewport by that many pixels before being deemed visible.
    @private
  */
  function inViewport (elem) {
    var buffer = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    var pageX = window.pageXOffset !== undefined ? window.pageXOffset : (document.documentElement || document.body.parentNode || document.body).scrollLeft;
    var pageY = window.pageYOffset !== undefined ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop;
    var bounds = elem.getBoundingClientRect();
    var height = bounds.height,
        left = bounds.left + pageX,
        top = bounds.top + pageY,
        width = bounds.width;
    return pageY + window.innerHeight > top + buffer && pageY + buffer < top + height && pageX + window.innerWidth > left + buffer && pageX + buffer < left + width;
  }

  /**
      @desc On click event for all shapes in a Viz.
      @param {Object} *d* The data object being interacted with.
      @param {Number} *i* The index of the data object being interacted with.
      @private
  */
  function clickShape (d, i) {
    this._select.style("cursor", "auto");

    if (this._drawDepth < this._groupBy.length - 1) {
      var filterGroup = this._groupBy[this._drawDepth],
          filterId = filterGroup(d, i);
      this.hover(false);
      if (this._tooltip) this._tooltipClass.data([]).render();
      var oldFilter = this._filter;

      this._history.push({
        depth: this._depth,
        filter: oldFilter
      });

      this.config({
        depth: this._drawDepth + 1,
        filter: function filter(f, x) {
          return (!oldFilter || oldFilter(f, x)) && filterGroup(f, x) === filterId;
        }
      }).render();
    }
  }

  /**
      @desc On click event for all legend shapes in a Viz.
      @param {Object} *d* The data object being interacted with.
      @param {Number} *i* The index of the data object being interacted with.
      @private
  */

  function clickLegend (d, i) {
    var _this = this;

    this._select.style("cursor", "auto");

    if (this._tooltip) this._tooltipClass.data([]).render();

    var id = this._id(d, i);

    if (!(id instanceof Array)) id = [id];

    var hiddenIndex = this._hidden.indexOf(id[0]);

    var soloIndex = this._solo.indexOf(id[0]);

    var dataLength = merge(this._legendClass.data().map(function (d, i) {
      var id = _this._id(d, i);

      if (!(id instanceof Array)) id = [id];
      return id;
    })).length;

    if (event$1.shiftKey) {
      if (hiddenIndex < 0 && !this._solo.length) {
        this._hidden = this._hidden.concat(id);
        if (this._solo.length === dataLength) this._solo = [];
        if (this._hidden.length === dataLength) this._hidden = [];
        this.render();
      } else if (soloIndex >= 0) {
        this._solo = [];
        this._hidden = [];
        this.render();
      }
    } else {
      if (soloIndex < 0 && this._hidden.length < dataLength - 1) {
        this._solo = id;
        this._hidden = [];
      } else {
        this._solo = [];
        this._hidden = [];
      }

      this.render();
    }
  }

  var flattenIds = function flattenIds(levels) {
    return levels.reduce(function (arr, level) {
      if (level instanceof Array) {
        if (arr.length) {
          var oldArray = arr.slice();
          arr = [];
          level.forEach(function (id) {
            return arr = arr.concat(oldArray.map(function (a) {
              return "".concat(a, "_").concat(id);
            }));
          });
        } else {
          arr = level.slice();
        }
      } else if (arr.length) {
        arr = arr.map(function (a) {
          return "".concat(a, "_").concat(level);
        });
      } else {
        arr.push(level);
      }

      return arr;
    }, []);
  };
  /**
      @desc On mouseenter event for all shapes in a Viz.
      @param {Object} *d* The data object being interacted with.
      @param {Number} *i* The index of the data object being interacted with.
      @private
  */


  function mouseenter (d, i) {
    var _this = this;

    if (this._shapeConfig.hoverOpacity !== 1) {
      var filterIds = flattenIds(this._ids(d, i));
      this.hover(function (h, x) {
        var ids = flattenIds(_this._ids(h, x));
        return filterIds.some(function (id) {
          return ids.includes(id);
        });
      });
    }
  }

  /**
      @desc On mouseleave event for all shapes in a Viz.
      @param {Object} *d* The data object being interacted with.
      @param {Number} *i* The index of the data object being interacted with.
      @private
  */
  function mouseleave (d, i) {
    var _this = this;

    setTimeout(function () {
      if (_this._shapeConfig.hoverOpacity !== 1 && _this._hover ? _this._hover(d, i) : true) {
        _this.hover(false);
      }

      var tooltipData = _this._tooltipClass.data();

      if (tooltipData.length && _this._tooltip) {
        var tooltipDatum = tooltipData[0];

        while (tooltipDatum.__d3plus__ && tooltipDatum.data) {
          tooltipDatum = tooltipDatum.data;
        }

        if (_this._id(tooltipDatum) === _this._id(d)) _this._tooltipClass.data([]).render();
      }
    }, 50);

    this._select.style("cursor", "auto");
  }

  /**
      @desc Tooltip logic for a specified data point.
      @param {Object} *d* The data object being interacted with.
      @param {Number} *i* The index of the data object being interacted with.
      @param {Object} [*config*] Optional configuration methods for the Tooltip class.
      @private
  */

  function mousemoveLegend (d, i, x) {
    var _this = this;

    var position = event$1.touches ? [event$1.touches[0].clientX, event$1.touches[0].clientY] : [event$1.clientX, event$1.clientY];
    var dataLength = merge(this._legendClass.data().map(function (d, i) {
      var id = _this._id(d, i);

      if (!(id instanceof Array)) id = [id];
      return id;
    })).length;

    if (this._tooltip && d) {
      var id = this._id(d, i);

      if (id instanceof Array) id = id[0];
      var t = this._translate;

      this._select.style("cursor", "pointer");

      this._tooltipClass.data([x || d]).footer(this._solo.length && !this._solo.includes(id) ? t("Click to Highlight") : this._solo.length === 1 && this._solo.includes(id) || this._hidden.length === dataLength - 1 ? t("Click to Reset") : this._solo.includes(id) ? t("Click to Hide") : this._hidden.includes(id) ? t("Click to Highlight") : "".concat(t("Click to Highlight"), "<br />").concat(t("Shift+Click to Hide"))).title(this._legendConfig.label ? this._legendClass.label() : legendLabel.bind(this)).position(position).config(configPrep.bind(this)(this._tooltipConfig)).config(configPrep.bind(this)(this._legendTooltip)).render();
    }
  }

  /**
      @desc Tooltip logic for a specified data point.
      @param {Object} *d* The data object being interacted with.
      @param {Number} *i* The index of the data object being interacted with.
      @param {Object} [*config*] Optional configuration methods for the Tooltip class.
      @private
  */

  function mousemoveShape (d, i, x) {
    if (this._tooltip && d) {
      this._select.style("cursor", "pointer");

      var position = event$1.touches ? [event$1.touches[0].clientX, event$1.touches[0].clientY] : [event$1.clientX, event$1.clientY];

      this._tooltipClass.data([x || d]).footer(this._drawDepth < this._groupBy.length - 1 ? this._translate("Click to Expand") : false).title(this._drawLabel).position(position).config(configPrep.bind(this)(this._tooltipConfig)).render();
    }
  }

  /**
   @desc On touchstart event for the Body element.
   @private
   */

  function touchstartBody (d) {
    event$1.preventDefault();
    event$1.stopPropagation();
    if (this._tooltip && !d) this._tooltipClass.data([]).render();
  }

  function _slicedToArray$4(arr, i) {
    return _arrayWithHoles$4(arr) || _iterableToArrayLimit$4(arr, i) || _nonIterableRest$4();
  }

  function _nonIterableRest$4() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance");
  }

  function _iterableToArrayLimit$4(arr, i) {
    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
      return;
    }

    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _arrayWithHoles$4(arr) {
    if (Array.isArray(arr)) return arr;
  }
  var brushing = false;
  /**
      @name zoomControls
      @desc Sets up initial zoom events and controls.
      @private
  */

  function zoomControls () {
    if (!this._container || !this._zoomGroup) return;
    var height = this._zoomHeight || this._height - this._margin.top - this._margin.bottom,
        that = this,
        width = this._zoomWidth || this._width - this._margin.left - this._margin.right;

    this._zoomBehavior.extent([[0, 0], [width, height]]).scaleExtent([1, this._zoomMax]).translateExtent([[0, 0], [width, height]]).on("zoom", zoomed.bind(this));

    this._zoomToBounds = zoomToBounds.bind(this);
    var control = _select(this._select.node().parentNode).selectAll("div.d3plus-zoom-control").data(this._zoom ? [0] : []);
    var controlEnter = control.enter().append("div").attr("class", "d3plus-zoom-control");
    control.exit().remove();
    control = control.merge(controlEnter).style("position", "absolute").style("top", "".concat(this._margin.top, "px")).style("left", "".concat(this._margin.left, "px"));
    controlEnter.append("div").attr("class", "zoom-control zoom-in");
    control.select(".zoom-in").on("click", zoomMath.bind(this, this._zoomFactor)).html("&#65291;");
    controlEnter.append("div").attr("class", "zoom-control zoom-out");
    control.select(".zoom-out").on("click", zoomMath.bind(this, 1 / this._zoomFactor)).html("&#65293;");
    controlEnter.append("div").attr("class", "zoom-control zoom-reset");
    control.select(".zoom-reset").on("click", zoomMath.bind(this, 0)).html("&#8634");
    controlEnter.append("div").attr("class", "zoom-control zoom-brush");
    control.select(".zoom-brush").on("click", function () {
      _select(this).classed("active", !brushing).call(stylize, brushing ? that._zoomControlStyle || {} : that._zoomControlStyleActive || {});
      zoomEvents.bind(that)(!brushing);
    }).html("&#164");
    control.selectAll(".zoom-control").call(stylize, that._zoomControlStyle).on("mouseenter", function () {
      _select(this).call(stylize, that._zoomControlStyleHover || {});
    }).on("mouseleave", function () {
      _select(this).call(stylize, _select(this).classed("active") ? that._zoomControlStyleActive || {} : that._zoomControlStyle || {});
    });

    this._zoomBrush.extent([[0, 0], [width, height]]).filter(function () {
      return !event$1.button && event$1.detail < 2;
    }).handleSize(this._zoomBrushHandleSize).on("start", brushStart.bind(this)).on("brush", brushBrush.bind(this)).on("end", brushEnd.bind(this));

    var brushGroup = this._container.selectAll("g.brush").data([0]);

    this._brushGroup = brushGroup.enter().append("g").attr("class", "brush").merge(brushGroup).call(this._zoomBrush);
    zoomEvents.bind(this)();
    if (this._renderTiles) this._renderTiles(transform$2(this._container.node()), 0);
  }
  /**
      @name zoomEvents
      @desc Handles adding/removing zoom event listeners.
      @private
  */

  function zoomEvents() {
    var brush = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
    brushing = brush;
    if (brushing) this._brushGroup.style("display", "inline");else this._brushGroup.style("display", "none");

    if (!brushing && this._zoom) {
      this._container.call(this._zoomBehavior);

      if (!this._zoomScroll) {
        this._container.on("wheel.zoom", null);
      }

      if (!this._zoomPan) {
        this._container.on("mousedown.zoom mousemove.zoom", null).on("touchstart.zoom touchmove.zoom touchend.zoom touchcancel.zoom", null);
      }
    } else {
      this._container.on(".zoom", null);
    }
  }
  /**
      @name zoomed
      @desc Handles events dispatched from this._zoomBehavior
      @param {Object} [*transform* = event.transform]
      @param {Number} [*duration* = 0]
      @private
  */


  function zoomed() {
    var transform = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0; // console.log(transform || event.transform);

    if (this._zoomGroup) {
      if (!duration) this._zoomGroup.attr("transform", transform || event$1.transform);else this._zoomGroup.transition().duration(duration).attr("transform", transform || event$1.transform);
    }

    if (this._renderTiles) this._renderTiles(transform$2(this._container.node()), duration);
  }
  /**
      @name zoomMath
      @desc Zooms in or out based on the provided multiplier.
      @param {Number} [*factor* = 0]
      @private
  */


  function zoomMath() {
    var factor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
    if (!this._container) return;

    var center = this._zoomBehavior.extent().bind(document)()[1].map(function (d) {
      return d / 2;
    }),
        scaleExtent = this._zoomBehavior.scaleExtent(),
        t = transform$2(this._container.node());

    if (!factor) {
      t.k = scaleExtent[0];
      t.x = 0;
      t.y = 0;
    } else {
      var translate0 = [(center[0] - t.x) / t.k, (center[1] - t.y) / t.k];
      t.k = Math.min(scaleExtent[1], t.k * factor);

      if (t.k <= scaleExtent[0]) {
        t.k = scaleExtent[0];
        t.x = 0;
        t.y = 0;
      } else {
        t.x += center[0] - (translate0[0] * t.k + t.x);
        t.y += center[1] - (translate0[1] * t.k + t.y);
      }
    }

    zoomed.bind(this)(t, this._duration);
  }
  /**
      @name zoomToBounds
      @desc Zooms to given bounds.
      @param {Array} *bounds*
      @param {Number} [*duration* = 0]
      @private
  */


  function zoomToBounds(bounds) {
    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._duration;

    var scaleExtent = this._zoomBehavior.scaleExtent(),
        t = transform$2(this._container.node());

    if (bounds) {
      var _this$_zoomBehavior$t = _slicedToArray$4(this._zoomBehavior.translateExtent()[1], 2),
          width = _this$_zoomBehavior$t[0],
          height = _this$_zoomBehavior$t[1],
          dx = bounds[1][0] - bounds[0][0],
          dy = bounds[1][1] - bounds[0][1];

      var k = Math.min(scaleExtent[1], 1 / Math.max(dx / width, dy / height));
      var xMod, yMod;

      if (dx / dy < width / height) {
        k *= (height - this._zoomPadding * 2) / height;
        xMod = (width - dx * k) / 2 / k;
        yMod = this._zoomPadding / k;
      } else {
        k *= (width - this._zoomPadding * 2) / width;
        yMod = (height - dy * k) / 2 / k;
        xMod = this._zoomPadding / k;
      }

      t.x = (t.x - bounds[0][0] + xMod) * (t.k * k / t.k);
      t.y = (t.y - bounds[0][1] + yMod) * (t.k * k / t.k);
      t.k *= k;
      if (t.x > 0) t.x = 0;else if (t.x < width * -t.k + width) t.x = width * -t.k + width;
      if (t.y > 0) t.y = 0;else if (t.y < height * -t.k + height) t.y = height * -t.k + height;
    } else {
      t.k = scaleExtent[0];
      t.x = 0;
      t.y = 0;
    }

    zoomed.bind(this)(t, duration);
  }
  /**
      @desc Triggered on brush "brush".
      @private
  */


  function brushBrush() {
    brushStyle.bind(this)();
  }
  /**
      @desc Triggered on brush "end".
      @private
  */


  function brushEnd() {
    if (!event$1.selection) return; // Only transition after input.

    this._brushGroup.call(this._zoomBrush.move, null);

    zoomToBounds.bind(this)(event$1.selection);
  }
  /**
      @desc Triggered on brush "start".
      @private
  */


  function brushStart() {
    brushStyle.bind(this)();
  }
  /**
      @desc Overrides the default brush styles.
      @private
  */


  function brushStyle() {
    this._brushGroup.selectAll(".selection").call(attrize, this._zoomBrushSelectionStyle || {});

    this._brushGroup.selectAll(".handle").call(attrize, this._zoomBrushHandleStyle || {});
  }

  function _toConsumableArray$1(arr) {
    return _arrayWithoutHoles$1(arr) || _iterableToArray$1(arr) || _nonIterableSpread$1();
  }

  function _nonIterableSpread$1() {
    throw new TypeError("Invalid attempt to spread non-iterable instance");
  }

  function _iterableToArray$1(iter) {
    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter);
  }

  function _arrayWithoutHoles$1(arr) {
    if (Array.isArray(arr)) {
      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {
        arr2[i] = arr[i];
      }

      return arr2;
    }
  }

  function _slicedToArray$5(arr, i) {
    return _arrayWithHoles$5(arr) || _iterableToArrayLimit$5(arr, i) || _nonIterableRest$5();
  }

  function _nonIterableRest$5() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance");
  }

  function _iterableToArrayLimit$5(arr, i) {
    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
      return;
    }

    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _arrayWithHoles$5(arr) {
    if (Array.isArray(arr)) return arr;
  }

  function _typeof$q(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$q = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$q = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$q(obj);
  }

  function _classCallCheck$p(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$l(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$l(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$l(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$l(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$m(self, call) {
    if (call && (_typeof$q(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$m(self);
  }

  function _getPrototypeOf$m(o) {
    _getPrototypeOf$m = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$m(o);
  }

  function _assertThisInitialized$m(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _inherits$m(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$m(subClass, superClass);
  }

  function _setPrototypeOf$m(o, p) {
    _setPrototypeOf$m = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$m(o, p);
  }
  /**
   * Default padding logic that will return false if the screen is less than 600 pixels wide.
   */

  function defaultPadding() {
    return typeof window !== "undefined" ? window.innerWidth > 600 : true;
  }
  /**
   * Turns an array of values into a list string.
   */


  function listify(n) {
    return n.reduce(function (str, item, i) {
      if (!i) str += item;else if (i === n.length - 1 && i === 1) str += " and ".concat(item);else if (i === n.length - 1) str += ", and ".concat(item);else str += ", ".concat(item);
      return str;
    }, "");
  }
  /**
      @class Viz
      @extends external:BaseClass
      @desc Creates an x/y plot based on an array of data. If *data* is specified, immediately draws the tree map based on the specified array and returns the current class instance. If *data* is not specified on instantiation, it can be passed/updated after instantiation using the [data](#treemap.data) method. See [this example](https://d3plus.org/examples/d3plus-treemap/getting-started/) for help getting started using the treemap generator.
  */


  var Viz =
  /*#__PURE__*/
  function (_BaseClass) {
    _inherits$m(Viz, _BaseClass);
    /**
        @memberof Viz
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Viz() {
      var _this;

      _classCallCheck$p(this, Viz);

      _this = _possibleConstructorReturn$m(this, _getPrototypeOf$m(Viz).call(this));
      _this._aggs = {};
      _this._ariaHidden = true;
      _this._backClass = new TextBox().on("click", function () {
        if (_this._history.length) _this.config(_this._history.pop()).render();else _this.depth(_this._drawDepth - 1).filter(false).render();
      }).on("mousemove", function () {
        return _this._backClass.select().style("cursor", "pointer");
      });
      _this._backConfig = {
        fontSize: 10,
        padding: 5,
        resize: false
      };
      _this._cache = true;

      _this._color = function (d, i) {
        return _this._groupBy[0](d, i);
      };

      _this._colorScaleClass = new ColorScale();
      _this._colorScaleConfig = {};
      _this._colorScalePadding = defaultPadding;
      _this._colorScalePosition = "bottom";
      _this._colorScaleMaxSize = 600;
      var controlTest = new Select();
      _this._controlCache = {};
      _this._controlConfig = {
        selectStyle: Object.assign({
          margin: "5px"
        }, controlTest.selectStyle())
      };
      _this._controlPadding = defaultPadding;
      _this._data = [];
      _this._dataCutoff = 100;
      _this._detectResize = true;
      _this._detectResizeDelay = 400;
      _this._detectVisible = true;
      _this._detectVisibleInterval = 1000;
      _this._downloadButton = false;
      _this._downloadConfig = {
        type: "png"
      };
      _this._downloadPosition = "top";
      _this._duration = 600;
      _this._hidden = [];
      _this._hiddenColor = constant$3("#aaa");
      _this._hiddenOpacity = constant$3(0.5);
      _this._history = [];
      _this._groupBy = [accessor("id")];
      _this._legend = true;
      _this._legendClass = new Legend();
      _this._legendConfig = {
        label: legendLabel.bind(_assertThisInitialized$m(_this)),
        shapeConfig: {
          ariaLabel: legendLabel.bind(_assertThisInitialized$m(_this)),
          labelConfig: {
            fontColor: undefined,
            fontResize: false,
            padding: 0
          }
        }
      };
      _this._legendCutoff = 1;
      _this._legendPadding = defaultPadding;
      _this._legendPosition = "bottom";

      _this._legendSort = function (a, b) {
        return _this._drawLabel(a).localeCompare(_this._drawLabel(b));
      };

      _this._legendTooltip = {};

      _this._loadingHTML = function () {
        return "\n    <div style=\"left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;\">\n      <strong>".concat(_this._translate("Loading Visualization"), "</strong>\n      <sub style=\"bottom: 0; display: block; line-height: 1; margin-top: 5px;\"><a href=\"https://d3plus.org\" target=\"_blank\">").concat(_this._translate("Powered by D3plus"), "</a></sub>\n    </div>");
      };

      _this._loadingMessage = true;
      _this._lrucache = lrucache(10);
      _this._messageClass = new Message();
      _this._messageMask = "rgba(0, 0, 0, 0.05)";
      _this._messageStyle = {
        "bottom": "0",
        "left": "0",
        "position": "absolute",
        "right": "0",
        "text-align": "center",
        "top": "0"
      };

      _this._noDataHTML = function () {
        return "\n    <div style=\"left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;\">\n      <strong>".concat(_this._translate("No Data Available"), "</strong>\n    </div>");
      };

      _this._noDataMessage = true;
      _this._on = {
        "click.shape": clickShape.bind(_assertThisInitialized$m(_this)),
        "click.legend": clickLegend.bind(_assertThisInitialized$m(_this)),
        "mouseenter": mouseenter.bind(_assertThisInitialized$m(_this)),
        "mouseleave": mouseleave.bind(_assertThisInitialized$m(_this)),
        "mousemove.shape": mousemoveShape.bind(_assertThisInitialized$m(_this)),
        "mousemove.legend": mousemoveLegend.bind(_assertThisInitialized$m(_this))
      };
      _this._queue = [];
      _this._scrollContainer = (typeof window === "undefined" ? "undefined" : _typeof$q(window)) === undefined ? "" : window;
      _this._shape = constant$3("Rect");
      _this._shapes = [];
      _this._shapeConfig = {
        ariaLabel: function ariaLabel(d, i) {
          return _this._drawLabel(d, i);
        },
        fill: function fill(d, i) {
          while (d.__d3plus__ && d.data) {
            d = d.data;
            i = d.i;
          }

          if (_this._colorScale) {
            var _c = _this._colorScale(d, i);

            if (_c !== undefined && _c !== null) {
              var scale = _this._colorScaleClass._colorScale;

              var colors = _this._colorScaleClass.color();

              if (!scale) return colors instanceof Array ? colors[colors.length - 1] : colors;else if (!scale.domain().length) return scale.range()[scale.range().length - 1];
              return scale(_c);
            }
          }

          var c = _this._color(d, i);

          if (color$4(c)) return c;
          return colorAssign(c);
        },
        labelConfig: {
          fontColor: function fontColor(d, i) {
            var c = typeof _this._shapeConfig.fill === "function" ? _this._shapeConfig.fill(d, i) : _this._shapeConfig.fill;
            return colorContrast(c);
          }
        },
        opacity: constant$3(1),
        stroke: function stroke(d, i) {
          var c = typeof _this._shapeConfig.fill === "function" ? _this._shapeConfig.fill(d, i) : _this._shapeConfig.fill;
          return color$4(c).darker();
        },
        role: "presentation",
        strokeWidth: constant$3(0)
      };
      _this._solo = [];
      _this._svgDesc = "";
      _this._svgTitle = "";
      _this._timeline = true;
      _this._timelineClass = new Timeline().align("end");
      _this._timelineConfig = {
        brushing: false,
        padding: 5
      };
      _this._timelinePadding = defaultPadding;
      _this._threshold = constant$3(0.0001);
      _this._thresholdKey = undefined;

      _this._thresholdName = function () {
        return _this._translate("Values");
      };

      _this._titleClass = new TextBox();
      _this._titleConfig = {
        ariaHidden: true,
        fontSize: 12,
        padding: 5,
        resize: false,
        textAnchor: "middle"
      };
      _this._titlePadding = defaultPadding;
      _this._tooltip = true;
      _this._tooltipClass = new Tooltip();
      _this._tooltipConfig = {
        pointerEvents: "none",
        titleStyle: {
          "max-width": "200px"
        }
      };
      _this._totalClass = new TextBox();
      _this._totalConfig = {
        fontSize: 10,
        padding: 5,
        resize: false,
        textAnchor: "middle"
      };

      _this._totalFormat = function (d) {
        return "".concat(_this._translate("Total"), ": ").concat(formatAbbreviate(d, _this._locale));
      };

      _this._totalPadding = defaultPadding;
      _this._zoom = false;
      _this._zoomBehavior = zoom();
      _this._zoomBrush = brush();
      _this._zoomBrushHandleSize = 1;
      _this._zoomBrushHandleStyle = {
        fill: "#444"
      };
      _this._zoomBrushSelectionStyle = {
        "fill": "#777",
        "stroke-width": 0
      };
      _this._zoomControlStyle = {
        "background": "rgba(255, 255, 255, 0.75)",
        "border": "1px solid rgba(0, 0, 0, 0.75)",
        "color": "rgba(0, 0, 0, 0.75)",
        "display": "block",
        "font": "900 15px/21px 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",
        "height": "20px",
        "margin": "5px",
        "opacity": 0.75,
        "padding": 0,
        "text-align": "center",
        "width": "20px"
      };
      _this._zoomControlStyleActive = {
        background: "rgba(0, 0, 0, 0.75)",
        color: "rgba(255, 255, 255, 0.75)",
        opacity: 1
      };
      _this._zoomControlStyleHover = {
        cursor: "pointer",
        opacity: 1
      };
      _this._zoomFactor = 2;
      _this._zoomMax = 16;
      _this._zoomPadding = 20;
      _this._zoomPan = true;
      _this._zoomScroll = true;
      return _this;
    }
    /**
     @memberof Viz
     @desc Called by draw before anything is drawn. Formats the data and performs preparations for draw.
     @private
     */


    _createClass$l(Viz, [{
      key: "_preDraw",
      value: function _preDraw() {
        var _this2 = this;

        var that = this; // based on the groupBy, determine the draw depth and current depth id

        this._drawDepth = this._depth !== void 0 ? this._depth : this._groupBy.length - 1;
        this._id = this._groupBy[this._drawDepth];

        this._ids = function (d, i) {
          return _this2._groupBy.map(function (g) {
            return !d || d.__d3plus__ && !d.data ? undefined : g(d.__d3plus__ ? d.data : d, d.__d3plus__ ? d.i : i);
          }).filter(function (g) {
            return g !== undefined && g !== null;
          });
        };

        this._drawLabel = function (d, i) {
          if (!d) return "";

          if (d._isAggregation) {
            return "".concat(_this2._thresholdName(d, i), " < ").concat(formatAbbreviate(d._threshold * 100, _this2._locale), "%");
          }

          while (d.__d3plus__ && d.data) {
            d = d.data;
            i = d.i;
          }

          if (_this2._label) return _this2._label(d, i);

          var l = that._ids(d, i).slice(0, _this2._drawDepth + 1);

          var n = l.reverse().find(function (ll) {
            return !(ll instanceof Array);
          }) || l[l.length - 1];
          return n instanceof Array ? listify(n) : n;
        }; // set the default timeFilter if it has not been specified


        if (this._time && !this._timeFilter && this._data.length) {
          var dates = this._data.map(this._time).map(date$2);

          var d = this._data[0],
              i = 0;

          if (this._discrete && "_".concat(this._discrete) in this && this["_".concat(this._discrete)](d, i) === this._time(d, i)) {
            this._timeFilter = function () {
              return true;
            };
          } else {
            var latestTime = +max(dates);

            this._timeFilter = function (d, i) {
              return +date$2(_this2._time(d, i)) === latestTime;
            };
          }
        }

        this._filteredData = [];
        this._legendData = [];
        var flatData = [];

        if (this._data.length) {
          flatData = this._timeFilter ? this._data.filter(this._timeFilter) : this._data;
          if (this._filter) flatData = flatData.filter(this._filter);
          var dataNest = nest();

          for (var _i = 0; _i <= this._drawDepth; _i++) {
            dataNest.key(this._groupBy[_i]);
          }

          if (this._discrete && "_".concat(this._discrete) in this) dataNest.key(this["_".concat(this._discrete)]);
          if (this._discrete && "_".concat(this._discrete, "2") in this) dataNest.key(this["_".concat(this._discrete, "2")]);
          var tree = dataNest.rollup(function (leaves) {
            var index = _this2._data.indexOf(leaves[0]);

            var shape = _this2._shape(leaves[0], index);

            var id = _this2._id(leaves[0], index);

            var d = objectMerge(leaves, _this2._aggs);

            if (!_this2._hidden.includes(id) && (!_this2._solo.length || _this2._solo.includes(id))) {
              if (shape === "Line") _this2._filteredData = _this2._filteredData.concat(leaves);else _this2._filteredData.push(d);
            }

            _this2._legendData.push(d);
          }).entries(flatData);
          this._filteredData = this._thresholdFunction(this._filteredData, tree);
        } // overrides the hoverOpacity of shapes if data is larger than cutoff


        var uniqueIds = nest().key(this._id).entries(this._filteredData).length;

        if (uniqueIds > this._dataCutoff) {
          if (this._userHover === undefined) this._userHover = this._shapeConfig.hoverOpacity || 0.5;
          if (this._userDuration === undefined) this._userDuration = this._shapeConfig.duration || 600;
          this._shapeConfig.hoverOpacity = 1;
          this._shapeConfig.duration = 0;
        } else if (this._userHover !== undefined) {
          this._shapeConfig.hoverOpacity = this._userHover;
          this._shapeConfig.duration = this._userDuration;
        }

        if (this._noDataMessage && !this._filteredData.length) {
          this._messageClass.render({
            container: this._select.node().parentNode,
            html: this._noDataHTML(this),
            mask: false,
            style: this._messageStyle
          });
        }
      }
      /**
          @memberof Viz
          @desc Called by render once all checks are passed.
          @private
      */

    }, {
      key: "_draw",
      value: function _draw() {
        if (this._legendPosition === "left" || this._legendPosition === "right") drawLegend.bind(this)(this._filteredData);
        if (this._colorScalePosition === "left" || this._colorScalePosition === "right" || this._colorScalePosition === false) drawColorScale.bind(this)(this._filteredData);
        drawBack.bind(this)();
        drawTitle.bind(this)(this._filteredData);
        drawTotal.bind(this)(this._filteredData);
        drawTimeline.bind(this)(this._filteredData);
        drawControls.bind(this)(this._filteredData);
        if (this._legendPosition === "top" || this._legendPosition === "bottom") drawLegend.bind(this)(this._legendData);
        if (this._colorScalePosition === "top" || this._colorScalePosition === "bottom") drawColorScale.bind(this)(this._filteredData);
        this._shapes = []; // Draws a container and zoomGroup to test functionality.
        // this._testGroup = this._select.selectAll("g.d3plus-viz-testGroup").data([0]);
        // const enterTest = this._testGroup.enter().append("g").attr("class", "d3plus-viz-testGroup")
        //   .merge(this._testGroup);
        // this._testGroup = enterTest.merge(this._testGroup);
        // const bgHeight = this._height - this._margin.top - this._margin.bottom;
        // const bgWidth = this._width - this._margin.left - this._margin.right;
        // new Rect()
        //   .data([{id: "background"}])
        //   .select(this._testGroup.node())
        //   .x(bgWidth / 2 + this._margin.left)
        //   .y(bgHeight / 2 + this._margin.top)
        //   .width(bgWidth)
        //   .height(bgHeight)
        //   .fill("#ccc")
        //   .render();
        // this._zoomGroup = this._select.selectAll("g.d3plus-viz-zoomGroup").data([0]);
        // const enter = this._zoomGroup.enter().append("g").attr("class", "d3plus-viz-zoomGroup")
        //   .merge(this._zoomGroup);
        // this._zoomGroup = enter.merge(this._zoomGroup);
        // const testConfig = {
        //   on: {
        //     click: this._on["click.shape"],
        //     mouseenter: this._on.mouseenter,
        //     mouseleave: this._on.mouseleave,
        //     mousemove: this._on["mousemove.shape"]
        //   }
        // };
        // const testWidth = 20;
        // this._shapes.push(new Rect()
        //   .config(this._shapeConfig)
        //   .config(configPrep(testConfig))
        //   .data(this._filteredData)
        //   .label("Test Label")
        //   .select(this._zoomGroup.node())
        //   .id(this._id)
        //   .x((d, i) => i * testWidth + testWidth / 2)
        //   .y(200)
        //   .width(testWidth)
        //   .height(100)
        //   .render());
      }
      /**
       * Applies the threshold algorithm according to the type of chart used.
       * @param {Array} data The data to process.
       */

    }, {
      key: "_thresholdFunction",
      value: function _thresholdFunction(data) {
        return data;
      }
      /**
          @memberof Viz
          @desc Draws the visualization given the specified configuration.
          @param {Function} [*callback*] An optional callback function that, if passed, will be called after animation is complete.
          @chainable
      */

    }, {
      key: "render",
      value: function render(callback) {
        var _this3 = this; // Resets margins and padding


        this._margin = {
          bottom: 0,
          left: 0,
          right: 0,
          top: 0
        };
        this._padding = {
          bottom: 0,
          left: 0,
          right: 0,
          top: 0
        };
        this._transition = transition().duration(this._duration); // Appends a fullscreen SVG to the BODY if a container has not been provided through .select().

        if (this._select === void 0 || this._select.node().tagName.toLowerCase() !== "svg") {
          var parent = this._select === void 0 ? _select("body").append("div") : this._select;
          var svg = parent.append("svg");
          this.select(svg.node());
        }
        /** detects width and height and sets SVG properties */


        function setSVGSize() {
          var display = this._select.style("display");

          this._select.style("display", "none");

          var _getSize = getSize$1(this._select.node().parentNode),
              _getSize2 = _slicedToArray$5(_getSize, 2),
              w = _getSize2[0],
              h = _getSize2[1];

          w -= parseFloat(this._select.style("border-left-width"), 10);
          w -= parseFloat(this._select.style("border-right-width"), 10);
          h -= parseFloat(this._select.style("border-top-width"), 10);
          h -= parseFloat(this._select.style("border-bottom-width"), 10);

          this._select.style("display", display);

          if (this._autoWidth) {
            this.width(w);

            this._select.style("width", "".concat(this._width, "px")).attr("width", "".concat(this._width, "px"));
          }

          if (this._autoHeight) {
            this.height(h);

            this._select.style("height", "".concat(this._height, "px")).attr("height", "".concat(this._height, "px"));
          }
        } // Calculates the width and/or height of the Viz based on the this._select, if either has not been defined.


        if ((!this._width || !this._height) && (!this._detectVisible || inViewport(this._select.node()))) {
          this._autoWidth = this._width === undefined;
          this._autoHeight = this._height === undefined;
          setSVGSize.bind(this)();
        }

        this._select.attr("class", "d3plus-viz").attr("aria-hidden", this._ariaHidden).attr("aria-labelledby", "".concat(this._uuid, "-title ").concat(this._uuid, "-desc")).attr("role", "img").transition(transition).style("width", this._width !== undefined ? "".concat(this._width, "px") : undefined).style("height", this._height !== undefined ? "".concat(this._height, "px") : undefined).attr("width", this._width !== undefined ? "".concat(this._width, "px") : undefined).attr("height", this._height !== undefined ? "".concat(this._height, "px") : undefined); // Updates the <title> tag if already exists else creates a new <title> tag on this.select.


        var svgTitle = this._select.selectAll("title").data([0]);

        var svgTitleEnter = svgTitle.enter().append("title").attr("id", "".concat(this._uuid, "-title"));
        svgTitle.merge(svgTitleEnter).text(this._svgTitle); // Updates the <desc> tag if already exists else creates a new <desc> tag on this.select.

        var svgDesc = this._select.selectAll("desc").data([0]);

        var svgDescEnter = svgDesc.enter().append("desc").attr("id", "".concat(this._uuid, "-desc"));
        svgDesc.merge(svgDescEnter).text(this._svgDesc);
        this._visiblePoll = clearInterval(this._visiblePoll);
        this._resizePoll = clearTimeout(this._resizePoll);
        this._scrollPoll = clearTimeout(this._scrollPoll);

        _select(this._scrollContainer).on("scroll.".concat(this._uuid), null);

        _select(this._scrollContainer).on("resize.".concat(this._uuid), null);

        if (this._detectVisible && this._select.style("visibility") === "hidden") {
          this._visiblePoll = setInterval(function () {
            if (_this3._select.style("visibility") !== "hidden") {
              _this3._visiblePoll = clearInterval(_this3._visiblePoll);

              _this3.render(callback);
            }
          }, this._detectVisibleInterval);
        } else if (this._detectVisible && this._select.style("display") === "none") {
          this._visiblePoll = setInterval(function () {
            if (_this3._select.style("display") !== "none") {
              _this3._visiblePoll = clearInterval(_this3._visiblePoll);

              _this3.render(callback);
            }
          }, this._detectVisibleInterval);
        } else if (this._detectVisible && !inViewport(this._select.node())) {
          _select(this._scrollContainer).on("scroll.".concat(this._uuid), function () {
            if (!_this3._scrollPoll) {
              _this3._scrollPoll = setTimeout(function () {
                if (inViewport(_this3._select.node())) {
                  _select(_this3._scrollContainer).on("scroll.".concat(_this3._uuid), null);

                  _this3.render(callback);
                }

                _this3._scrollPoll = clearTimeout(_this3._scrollPoll);
              }, _this3._detectVisibleInterval);
            }
          });
        } else {
          var q = queue();

          if (this._loadingMessage) {
            this._messageClass.render({
              container: this._select.node().parentNode,
              html: this._loadingHTML(this),
              mask: this._filteredData ? this._messageMask : false,
              style: this._messageStyle
            });
          }

          this._queue.forEach(function (p) {
            var cache = _this3._cache ? _this3._lrucache.get(p[1]) : undefined;
            if (!cache) q.defer.apply(q, _toConsumableArray$1(p));else _this3["_".concat(p[3])] = cache;
          });

          this._queue = [];
          q.awaitAll(function () {
            var columns = _this3._data instanceof Array && _this3._data.length > 0 ? Object.keys(_this3._data[0]) : [];

            var svgTable = _this3._select.selectAll("g.data-table").data(!_this3._ariaHidden && _this3._data instanceof Array && _this3._data.length ? [0] : []);

            var svgTableEnter = svgTable.enter().append("g").attr("class", "data-table").attr("role", "table");
            svgTable.exit().remove();
            var rows = svgTable.merge(svgTableEnter).selectAll("text").data(_this3._data instanceof Array ? range(0, _this3._data.length + 1) : []);
            rows.exit().remove();
            var cells = rows.merge(rows.enter().append("text").attr("role", "row")).selectAll("tspan").data(function (d, i) {
              return columns.map(function (c) {
                return {
                  role: i ? "cell" : "columnheader",
                  text: i ? _this3._data[i - 1][c] : c
                };
              });
            });
            cells.exit().remove();
            cells.merge(cells.enter().append("tspan")).attr("role", function (d) {
              return d.role;
            }).attr("dy", "-1000px").html(function (d) {
              return d.text;
            });

            _this3._preDraw();

            _this3._draw(callback);

            zoomControls.bind(_this3)();
            if (_this3._messageClass._isVisible && (!_this3._noDataMessage || _this3._filteredData.length)) _this3._messageClass.hide();

            if (_this3._detectResize && (_this3._autoWidth || _this3._autoHeight)) {
              _select(_this3._scrollContainer).on("resize.".concat(_this3._uuid), function () {
                _this3._resizePoll = clearTimeout(_this3._resizePoll);
                _this3._resizePoll = setTimeout(function () {
                  _this3._resizePoll = clearTimeout(_this3._resizePoll);
                  setSVGSize.bind(_this3)();

                  _this3.render(callback);
                }, _this3._detectResizeDelay);
              });
            }

            if (callback) setTimeout(callback, _this3._duration + 100);
          });
        } // Attaches touchstart event listener to the BODY to hide the tooltip when the user touches any element without data


        _select("body").on("touchstart.".concat(this._uuid), touchstartBody.bind(this));

        return this;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the active method to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "active",
      value: function active(_) {
        this._active = _;

        if (this._shapeConfig.activeOpacity !== 1) {
          this._shapes.forEach(function (s) {
            return s.active(_);
          });

          if (this._legend) this._legendClass.active(_);
        }

        return this;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the aggregation method for each key in the object and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "aggs",
      value: function aggs(_) {
        return arguments.length ? (this._aggs = assign(this._aggs, _), this) : this._aggs;
      }
      /**
          @memberof Viz
          @desc Sets the "aria-hidden" attribute of the containing SVG element. The default value is "false", but it you need to hide the SVG from screen readers set this property to "true".
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "ariaHidden",
      value: function ariaHidden(_) {
        return arguments.length ? (this._ariaHidden = _, this) : this._ariaHidden;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for the back button and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "backConfig",
      value: function backConfig(_) {
        return arguments.length ? (this._backConfig = assign(this._backConfig, _), this) : this._backConfig;
      }
      /**
          @memberof Viz
          @desc Enables a lru cache that stores up to 5 previously loaded files/URLs. Helpful when constantly writing over the data array with a URL in the render function of a react component.
          @param {Boolean} [*value* = false]
          @chainable
      */

    }, {
      key: "cache",
      value: function cache(_) {
        return arguments.length ? (this._cache = _, this) : this._cache;
      }
      /**
          @memberof Viz
          @desc Defines the main color to be used for each data point in a visualization. Can be either an accessor function or a string key to reference in each data point. If a color value is returned, it will be used as is. If a string is returned, a unique color will be assigned based on the string.
          @param {Function|String|False} [*value*]
          @chainable
      */

    }, {
      key: "color",
      value: function color(_) {
        return arguments.length ? (this._color = !_ || typeof _ === "function" ? _ : accessor(_), this) : this._color;
      }
      /**
          @memberof Viz
          @desc Defines the value to be used for a color scale. Can be either an accessor function or a string key to reference in each data point.
          @param {Function|String|False} [*value*]
          @chainable
      */

    }, {
      key: "colorScale",
      value: function colorScale(_) {
        return arguments.length ? (this._colorScale = !_ || typeof _ === "function" ? _ : accessor(_), this) : this._colorScale;
      }
      /**
          @memberof Viz
          @desc A pass-through to the config method of ColorScale.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "colorScaleConfig",
      value: function colorScaleConfig(_) {
        return arguments.length ? (this._colorScaleConfig = assign(this._colorScaleConfig, _), this) : this._colorScaleConfig;
      }
      /**
          @memberof Viz
          @desc Tells the colorScale whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the colorScale appears centered above the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.
          @param {Boolean|Function} [*value*]
          @chainable
      */

    }, {
      key: "colorScalePadding",
      value: function colorScalePadding(_) {
        return arguments.length ? (this._colorScalePadding = typeof _ === "function" ? _ : constant$3(_), this) : this._colorScalePadding;
      }
      /**
          @memberof Viz
          @desc Defines which side of the visualization to anchor the color scale. Acceptable values are `"top"`, `"bottom"`, `"left"`, `"right"`, and `false`. A `false` value will cause the color scale to not be displayed, but will still color shapes based on the scale.
          @param {String|Boolean} [*value* = "bottom"]
          @chainable
      */

    }, {
      key: "colorScalePosition",
      value: function colorScalePosition(_) {
        return arguments.length ? (this._colorScalePosition = _, this) : this._colorScalePosition;
      }
      /**
          @memberof Viz
          @desc Sets the maximum pixel size for drawing the color scale: width for horizontal scales and height for vertical scales.
          @param {Number} [*value* = 600]
          @chainable
      */

    }, {
      key: "colorScaleMaxSize",
      value: function colorScaleMaxSize(_) {
        return arguments.length ? (this._colorScaleMaxSize = _, this) : this._colorScaleMaxSize;
      }
      /**
          @memberof Viz
          @desc Defines a list of controls to be rendered at the bottom of the visualization.
          @param {Array} [*value*]
          @chainable
      */

    }, {
      key: "controls",
      value: function controls(_) {
        return arguments.length ? (this._controls = _, this) : this._controls;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for the controls and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "controlConfig",
      value: function controlConfig(_) {
        return arguments.length ? (this._controlConfig = assign(this._controlConfig, _), this) : this._controlConfig;
      }
      /**
          @memberof Viz
          @desc Tells the controls whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the controls appears centered above the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.
          @param {Boolean|Function} [*value*]
          @chainable
      */

    }, {
      key: "controlPadding",
      value: function controlPadding(_) {
        return arguments.length ? (this._controlPadding = typeof _ === "function" ? _ : constant$3(_), this) : this._controlPadding;
      }
      /**
          @memberof Viz
          @desc Sets the primary data array to be used when drawing the visualization. The value passed should be an *Array* of objects or a *String* representing a filepath or URL to be loaded. The following filetypes are supported: `csv`, `tsv`, `txt`, and `json`.
      Additionally, a custom formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final array of obejcts to be used as the primary data array. For example, some JSON APIs return the headers split from the data values to save bandwidth. These would need be joined using a custom formatter.
      If *data* is not specified, this method returns the current primary data array, which defaults to an empty array (`[]`);
          @param {Array|String} *data* = []
          @param {Function} [*formatter*]
          @chainable
      */

    }, {
      key: "data",
      value: function data(_, f) {
        if (arguments.length) {
          var prev = this._queue.find(function (q) {
            return q[3] === "data";
          });

          var d = [load.bind(this), _, f, "data"];
          if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          this._hidden = [];
          this._solo = [];
          return this;
        }

        return this._data;
      }
      /**
          @memberof Viz
          @desc If the number of visible data points exceeds this number, the default hover behavior will be disabled (helpful for very large visualizations bogging down the DOM with opacity updates).
          @param {Number} [*value* = 100]
          @chainable
      */

    }, {
      key: "dataCutoff",
      value: function dataCutoff(_) {
        return arguments.length ? (this._dataCutoff = _, this) : this._dataCutoff;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the depth to the specified number and returns the current class instance. The *value* should correspond with an index in the [groupBy](#groupBy) array.
          @param {Number} [*value*]
          @chainable
      */

    }, {
      key: "depth",
      value: function depth(_) {
        return arguments.length ? (this._depth = _, this) : this._depth;
      }
      /**
          @memberof Viz
          @desc If the width and/or height of a Viz is not user-defined, it is determined by the size of it's parent element. When this method is set to `true`, the Viz will listen for the `window.onresize` event and adjust it's dimensions accordingly.
          @param {Boolean} *value* = true
          @chainable
      */

    }, {
      key: "detectResize",
      value: function detectResize(_) {
        return arguments.length ? (this._detectResize = _, this) : this._detectResize;
      }
      /**
          @memberof Viz
          @desc When resizing the browser window, this is the millisecond delay to trigger the resize event.
          @param {Number} *value* = 400
          @chainable
      */

    }, {
      key: "detectResizeDelay",
      value: function detectResizeDelay(_) {
        return arguments.length ? (this._detectResizeDelay = _, this) : this._detectResizeDelay;
      }
      /**
          @memberof Viz
          @desc Toggles whether or not the Viz should try to detect if it visible in the current viewport. When this method is set to `true`, the Viz will only be rendered when it has entered the viewport either through scrolling or if it's display or visibility is changed.
          @param {Boolean} *value* = true
          @chainable
      */

    }, {
      key: "detectVisible",
      value: function detectVisible(_) {
        return arguments.length ? (this._detectVisible = _, this) : this._detectVisible;
      }
      /**
          @memberof Viz
          @desc The interval, in milliseconds, for checking if the visualization is visible on the page.
          @param {Number} *value* = 1000
          @chainable
      */

    }, {
      key: "detectVisibleInterval",
      value: function detectVisibleInterval(_) {
        return arguments.length ? (this._detectVisibleInterval = _, this) : this._detectVisibleInterval;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the discrete accessor to the specified method name (usually an axis) and returns the current class instance.
          @param {String} [*value*]
          @chainable
      */

    }, {
      key: "discrete",
      value: function discrete(_) {
        return arguments.length ? (this._discrete = _, this) : this._discrete;
      }
      /**
          @memberof Viz
          @desc Shows a button that allows for downloading the current visualization.
          @param {Boolean} [*value* = false]
          @chainable
      */

    }, {
      key: "downloadButton",
      value: function downloadButton(_) {
        return arguments.length ? (this._downloadButton = _, this) : this._downloadButton;
      }
      /**
          @memberof Viz
          @desc Sets specific options of the saveElement function used when downloading the visualization.
          @param {Object} [*value* = {type: "png"}]
          @chainable
      */

    }, {
      key: "downloadConfig",
      value: function downloadConfig(_) {
        return arguments.length ? (this._downloadConfig = assign(this._downloadConfig, _), this) : this._downloadConfig;
      }
      /**
          @memberof Viz
          @desc Defines which control group to add the download button into.
          @param {String} [*value* = "top"]
          @chainable
      */

    }, {
      key: "downloadPosition",
      value: function downloadPosition(_) {
        return arguments.length ? (this._downloadPosition = _, this) : this._downloadPosition;
      }
      /**
          @memberof Viz
          @desc If *ms* is specified, sets the animation duration to the specified number and returns the current class instance. If *ms* is not specified, returns the current animation duration.
          @param {Number} [*ms* = 600]
          @chainable
      */

    }, {
      key: "duration",
      value: function duration(_) {
        return arguments.length ? (this._duration = _, this) : this._duration;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the filter to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "filter",
      value: function filter(_) {
        return arguments.length ? (this._filter = _, this) : this._filter;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the group accessor(s) to the specified string, function, or array of values and returns the current class instance.
          @param {String|Function|Array} [*value*]
          @chainable
          @example
      function value(d) {
      return d.id;
      }
      */

    }, {
      key: "groupBy",
      value: function groupBy(_) {
        var _this4 = this;

        if (!arguments.length) return this._groupBy;
        if (!(_ instanceof Array)) _ = [_];
        return this._groupBy = _.map(function (k) {
          if (typeof k === "function") return k;else {
            if (!_this4._aggs[k]) {
              _this4._aggs[k] = function (a) {
                var v = unique(a);
                return v.length === 1 ? v[0] : v;
              };
            }

            return accessor(k);
          }
        }), this;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the overall height to the specified number and returns the current class instance.
          @param {Number} [*value* = window.innerHeight]
          @chainable
      */

    }, {
      key: "height",
      value: function height(_) {
        return arguments.length ? (this._height = _, this) : this._height;
      }
      /**
          @memberof Viz
          @desc Defines the color used for legend shapes when the corresponding grouping is hidden from display (by clicking on the legend).
          @param {Function|String} [*value* = "#aaa"]
          @chainable
      */

    }, {
      key: "hiddenColor",
      value: function hiddenColor(_) {
        return arguments.length ? (this._hiddenColor = typeof _ === "function" ? _ : constant$3(_), this) : this._hiddenColor;
      }
      /**
          @memberof Viz
          @desc Defines the opacity used for legend labels when the corresponding grouping is hidden from display (by clicking on the legend).
          @param {Function|Number} [*value* = 0.5]
          @chainable
      */

    }, {
      key: "hiddenOpacity",
      value: function hiddenOpacity(_) {
        return arguments.length ? (this._hiddenOpacity = typeof _ === "function" ? _ : constant$3(_), this) : this._hiddenOpacity;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the hover method to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "hover",
      value: function hover(_) {
        var _this5 = this;

        var hoverFunction = this._hover = _;

        if (this._shapeConfig.hoverOpacity !== 1) {
          if (typeof _ === "function") {
            var shapeData = merge(this._shapes.map(function (s) {
              return s.data();
            }));
            shapeData = shapeData.concat(this._legendClass.data());
            var activeData = _ ? shapeData.filter(_) : [];
            var activeIds = [];
            activeData.map(this._ids).forEach(function (ids) {
              for (var x = 1; x <= ids.length; x++) {
                activeIds.push(JSON.stringify(ids.slice(0, x)));
              }
            });
            activeIds = activeIds.filter(function (id, i) {
              return activeIds.indexOf(id) === i;
            });
            if (activeIds.length) hoverFunction = function hoverFunction(d, i) {
              return activeIds.includes(JSON.stringify(_this5._ids(d, i)));
            };
          }

          this._shapes.forEach(function (s) {
            return s.hover(hoverFunction);
          });

          if (this._legend) this._legendClass.hover(hoverFunction);
        }

        return this;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the label accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "label",
      value: function label(_) {
        return arguments.length ? (this._label = typeof _ === "function" ? _ : constant$3(_), this) : this._label;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, toggles the legend based on the specified boolean and returns the current class instance.
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "legend",
      value: function legend(_) {
        return arguments.length ? (this._legend = _, this) : this._legend;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, the object is passed to the legend's config method.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "legendConfig",
      value: function legendConfig(_) {
        return arguments.length ? (this._legendConfig = assign(this._legendConfig, _), this) : this._legendConfig;
      }
      /**
       * @memberof Viz
       * @desc If *value* is specified, sets the cutoff for the amount of categories in the legend.
       * @param {Number} [*value* = 1]
       * @chainable
       */

    }, {
      key: "legendCutoff",
      value: function legendCutoff(_) {
        return arguments.length ? (this._legendCutoff = _, this) : this._legendCutoff;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for the legend tooltip and returns the current class instance.
          @param {Object} [*value* = {}]
          @chainable
      */

    }, {
      key: "legendTooltip",
      value: function legendTooltip(_) {
        return arguments.length ? (this._legendTooltip = assign(this._legendTooltip, _), this) : this._legendTooltip;
      }
      /**
          @memberof Viz
          @desc Tells the legend whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the legend appears centered underneath the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.
          @param {Boolean|Function} [*value*]
          @chainable
      */

    }, {
      key: "legendPadding",
      value: function legendPadding(_) {
        return arguments.length ? (this._legendPadding = typeof _ === "function" ? _ : constant$3(_), this) : this._legendPadding;
      }
      /**
          @memberof Viz
          @desc Defines which side of the visualization to anchor the legend. Expected values are `"top"`, `"bottom"`, `"left"`, and `"right"`.
          @param {String} [*value* = "bottom"]
          @chainable
      */

    }, {
      key: "legendPosition",
      value: function legendPosition(_) {
        return arguments.length ? (this._legendPosition = _, this) : this._legendPosition;
      }
      /**
          @memberof Viz
          @desc A JavaScript [sort comparator function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort) used to sort the legend.
          @param {Function} *value*
          @chainable
      */

    }, {
      key: "legendSort",
      value: function legendSort(_) {
        return arguments.length ? (this._legendSort = _, this) : this._legendSort;
      }
      /**
          @memberof Viz
          @desc Sets the inner HTML of the status message that is displayed when loading AJAX requests and displaying errors. Must be a valid HTML string or a function that, when passed this Viz instance, returns a valid HTML string.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "loadingHTML",
      value: function loadingHTML(_) {
        return arguments.length ? (this._loadingHTML = typeof _ === "function" ? _ : constant$3(_), this) : this._loadingHTML;
      }
      /**
          @memberof Viz
          @desc Toggles the visibility of the status message that is displayed when loading AJAX requests and displaying errors.
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "loadingMessage",
      value: function loadingMessage(_) {
        return arguments.length ? (this._loadingMessage = _, this) : this._loadingMessage;
      }
      /**
          @memberof Viz
          @desc Sets the color of the mask used underneath the status message that is displayed when loading AJAX requests and displaying errors. Additionally, `false` will turn off the mask completely.
          @param {Boolean|String} [*value* = "rgba(0, 0, 0, 0.1)"]
          @chainable
      */

    }, {
      key: "messageMask",
      value: function messageMask(_) {
        return arguments.length ? (this._messageMask = _, this) : this._messageMask;
      }
      /**
          @memberof Viz
          @desc Defines the CSS style properties for the status message that is displayed when loading AJAX requests and displaying errors.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "messageStyle",
      value: function messageStyle(_) {
        return arguments.length ? (this._messageStyle = assign(this._messageStyle, _), this) : this._messageStyle;
      }
      /**
          @memberof Viz
          @desc Sets the inner HTML of the status message that is displayed when no data is supplied to the visualization. Must be a valid HTML string or a function that, when passed this Viz instance, returns a valid HTML string.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "noDataHTML",
      value: function noDataHTML(_) {
        return arguments.length ? (this._noDataHTML = typeof _ === "function" ? _ : constant$3(_), this) : this._noDataHTML;
      }
      /**
         @memberof Viz
         @desc Toggles the visibility of the status message that is displayed when no data is supplied to the visualization.
         @param {Boolean} [*value* = true]
         @chainable
      */

    }, {
      key: "noDataMessage",
      value: function noDataMessage(_) {
        return arguments.length ? (this._noDataMessage = _, this) : this._noDataMessage;
      }
      /**
          @memberof Viz
          @desc If using scroll or visibility detection, this method allow a custom override of the element to which the scroll detection function gets attached.
          @param {String|HTMLElement} *selector*
          @chainable
      */

    }, {
      key: "scrollContainer",
      value: function scrollContainer(_) {
        return arguments.length ? (this._scrollContainer = _, this) : this._scrollContainer;
      }
      /**
          @memberof Viz
          @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element, which is `undefined` by default.
          @param {String|HTMLElement} [*selector*]
          @chainable
      */

    }, {
      key: "select",
      value: function select(_) {
        return arguments.length ? (this._select = _select(_), this) : this._select;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the shape accessor to the specified function or number and returns the current class instance.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "shape",
      value: function shape(_) {
        return arguments.length ? (this._shape = typeof _ === "function" ? _ : constant$3(_), this) : this._shape;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for each shape and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "shapeConfig",
      value: function shapeConfig(_) {
        return arguments.length ? (this._shapeConfig = assign(this._shapeConfig, _), this) : this._shapeConfig;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the description accessor to the specified string and returns the current class instance.
          @param {String} [*value*]
          @chainable
      */

    }, {
      key: "svgDesc",
      value: function svgDesc(_) {
        return arguments.length ? (this._svgDesc = _, this) : this._svgDesc;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the title accessor to the specified string and returns the current class instance.
          @param {String} [*value*]
          @chainable
      */

    }, {
      key: "svgTitle",
      value: function svgTitle(_) {
        return arguments.length ? (this._svgTitle = _, this) : this._svgTitle;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the threshold for buckets to the specified function or string, and returns the current class instance.
          @param {Function|Number} [value]
          @chainable
       */

    }, {
      key: "threshold",
      value: function threshold(_) {
        if (arguments.length) {
          if (typeof _ === "function") {
            this._threshold = _;
          } else if (isFinite(_) && !isNaN(_)) {
            this._threshold = constant$3(_ * 1);
          }

          return this;
        } else return this._threshold;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the accesor for the value used in the threshold algorithm, and returns the current class instance.
          @param {Function|Number} [value]
          @chainable
       */

    }, {
      key: "thresholdKey",
      value: function thresholdKey(key) {
        if (arguments.length) {
          if (typeof key === "function") {
            this._thresholdKey = key;
          } else {
            this._thresholdKey = accessor(key);
          }

          return this;
        } else return this._thresholdKey;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the label for the bucket item, and returns the current class instance.
          @param {Function|String} [value]
          @chainable
       */

    }, {
      key: "thresholdName",
      value: function thresholdName(_) {
        return arguments.length ? (this._thresholdName = typeof _ === "function" ? _ : constant$3(_), this) : this._thresholdName;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the time accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "time",
      value: function time(_) {
        if (arguments.length) {
          if (typeof _ === "function") {
            this._time = _;
          } else {
            this._time = accessor(_);

            if (!this._aggs[_]) {
              this._aggs[_] = function (a) {
                var v = unique(a);
                return v.length === 1 ? v[0] : v;
              };
            }
          }

          this._timeFilter = false;
          return this;
        } else return this._time;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the time filter to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
      */

    }, {
      key: "timeFilter",
      value: function timeFilter(_) {
        return arguments.length ? (this._timeFilter = _, this) : this._timeFilter;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, toggles the timeline based on the specified boolean and returns the current class instance.
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "timeline",
      value: function timeline(_) {
        return arguments.length ? (this._timeline = _, this) : this._timeline;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for the timeline and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "timelineConfig",
      value: function timelineConfig(_) {
        return arguments.length ? (this._timelineConfig = assign(this._timelineConfig, _), this) : this._timelineConfig;
      }
      /**
          @memberof Viz
          @desc Tells the timeline whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the timeline appears centered underneath the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.
          @param {Boolean|Function} [*value*]
          @chainable
      */

    }, {
      key: "timelinePadding",
      value: function timelinePadding(_) {
        return arguments.length ? (this._timelinePadding = typeof _ === "function" ? _ : constant$3(_), this) : this._timelinePadding;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the title accessor to the specified function or string and returns the current class instance.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "title",
      value: function title(_) {
        return arguments.length ? (this._title = typeof _ === "function" ? _ : constant$3(_), this) : this._title;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for the title and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "titleConfig",
      value: function titleConfig(_) {
        return arguments.length ? (this._titleConfig = assign(this._titleConfig, _), this) : this._titleConfig;
      }
      /**
          @memberof Viz
          @desc Tells the title whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the title appears centered above the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.
          @param {Boolean|Function} [*value*]
          @chainable
      */

    }, {
      key: "titlePadding",
      value: function titlePadding(_) {
        return arguments.length ? (this._titlePadding = typeof _ === "function" ? _ : constant$3(_), this) : this._titlePadding;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, toggles the tooltip based on the specified boolean and returns the current class instance.
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "tooltip",
      value: function tooltip(_) {
        return arguments.length ? (this._tooltip = _, this) : this._tooltip;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for the tooltip and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "tooltipConfig",
      value: function tooltipConfig(_) {
        return arguments.length ? (this._tooltipConfig = assign(this._tooltipConfig, _), this) : this._tooltipConfig;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the total accessor to the specified function or string and returns the current class instance.
          @param {Boolean|Function|String} [*value*]
          @chainable
      */

    }, {
      key: "total",
      value: function total(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._total = _;else if (_) this._total = accessor(_);else this._total = false;
          return this;
        } else return this._total;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the config method for the total and returns the current class instance.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "totalConfig",
      value: function totalConfig(_) {
        return arguments.length ? (this._totalConfig = assign(this._totalConfig, _), this) : this._totalConfig;
      }
      /**
          @memberof Viz
          @desc Formatter function for the value in the total bar.
          @param {Function} *value*
          @chainable
      */

    }, {
      key: "totalFormat",
      value: function totalFormat(_) {
        return arguments.length ? (this._totalFormat = _, this) : this._totalFormat;
      }
      /**
          @memberof Viz
          @desc Tells the total whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the total appears centered above the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.
          @param {Boolean|Function} [*value*]
          @chainable
      */

    }, {
      key: "totalPadding",
      value: function totalPadding(_) {
        return arguments.length ? (this._totalPadding = typeof _ === "function" ? _ : constant$3(_), this) : this._totalPadding;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the overallwidth to the specified number and returns the current class instance.
          @param {Number} [*value* = window.innerWidth]
          @chainable
      */

    }, {
      key: "width",
      value: function width(_) {
        return arguments.length ? (this._width = _, this) : this._width;
      }
      /**
          @memberof Viz
          @desc Toggles the ability to zoom/pan the visualization. Certain parameters for zooming are required to be hooked up on a visualization by visualization basis.
          @param {Boolean} *value* = false
          @chainable
      */

    }, {
      key: "zoom",
      value: function zoom(_) {
        return arguments.length ? (this._zoom = _, this) : this._zoom;
      }
      /**
          @memberof Viz
          @desc The pixel stroke-width of the zoom brush area.
          @param {Number} *value* = 1
          @chainable
      */

    }, {
      key: "zoomBrushHandleSize",
      value: function zoomBrushHandleSize(_) {
        return arguments.length ? (this._zoomBrushHandleSize = _, this) : this._zoomBrushHandleSize;
      }
      /**
          @memberof Viz
          @desc An object containing CSS key/value pairs that is used to style the outer handle area of the zoom brush. Passing `false` will remove all default styling.
          @param {Object|Boolean} *value*
          @chainable
      */

    }, {
      key: "zoomBrushHandleStyle",
      value: function zoomBrushHandleStyle(_) {
        return arguments.length ? (this._zoomBrushHandleStyle = _, this) : this._zoomBrushHandleStyle;
      }
      /**
          @memberof Viz
          @desc An object containing CSS key/value pairs that is used to style the inner selection area of the zoom brush. Passing `false` will remove all default styling.
          @param {Object|Boolean} *value*
          @chainable
      */

    }, {
      key: "zoomBrushSelectionStyle",
      value: function zoomBrushSelectionStyle(_) {
        return arguments.length ? (this._zoomBrushSelectionStyle = _, this) : this._zoomBrushSelectionStyle;
      }
      /**
          @memberof Viz
          @desc An object containing CSS key/value pairs that is used to style each zoom control button (`.zoom-in`, `.zoom-out`, `.zoom-reset`, and `.zoom-brush`). Passing `false` will remove all default styling.
          @param {Object|Boolean} *value*
          @chainable
      */

    }, {
      key: "zoomControlStyle",
      value: function zoomControlStyle(_) {
        return arguments.length ? (this._zoomControlStyle = _, this) : this._zoomControlStyle;
      }
      /**
          @memberof Viz
          @desc An object containing CSS key/value pairs that is used to style each zoom control button when active (`.zoom-in`, `.zoom-out`, `.zoom-reset`, and `.zoom-brush`). Passing `false` will remove all default styling.
          @param {Object|Boolean} *value*
          @chainable
      */

    }, {
      key: "zoomControlStyleActive",
      value: function zoomControlStyleActive(_) {
        return arguments.length ? (this._zoomControlStyleActive = _, this) : this._zoomControlStyleActive;
      }
      /**
          @memberof Viz
          @desc An object containing CSS key/value pairs that is used to style each zoom control button on hover (`.zoom-in`, `.zoom-out`, `.zoom-reset`, and `.zoom-brush`). Passing `false` will remove all default styling.
          @param {Object|Boolean} *value*
          @chainable
      */

    }, {
      key: "zoomControlStyleHover",
      value: function zoomControlStyleHover(_) {
        return arguments.length ? (this._zoomControlStyleHover = _, this) : this._zoomControlStyleHover;
      }
      /**
          @memberof Viz
          @desc The multiplier that is used in with the control buttons when zooming in and out.
          @param {Number} *value* = 2
          @chainable
      */

    }, {
      key: "zoomFactor",
      value: function zoomFactor(_) {
        return arguments.length ? (this._zoomFactor = _, this) : this._zoomFactor;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, sets the max zoom scale to the specified number and returns the current class instance. If *value* is not specified, returns the current max zoom scale.
          @param {Number} *value* = 16
          @chainable
      */

    }, {
      key: "zoomMax",
      value: function zoomMax(_) {
        return arguments.length ? (this._zoomMax = _, this) : this._zoomMax;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, toggles panning to the specified boolean and returns the current class instance. If *value* is not specified, returns the current panning value.
          @param {Boolean} *value* = true
          @chainable
      */

    }, {
      key: "zoomPan",
      value: function zoomPan(_) {
        return arguments.length ? (this._zoomPan = _, this) : this._zoomPan;
      }
      /**
          @memberof Viz
          @desc A pixel value to be used to pad all sides of a zoomed area.
          @param {Number} *value* = 20
          @chainable
      */

    }, {
      key: "zoomPadding",
      value: function zoomPadding(_) {
        return arguments.length ? (this._zoomPadding = _, this) : this._zoomPadding;
      }
      /**
          @memberof Viz
          @desc If *value* is specified, toggles scroll zooming to the specified boolean and returns the current class instance. If *value* is not specified, returns the current scroll zooming value.
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "zoomScroll",
      value: function zoomScroll(_) {
        return arguments.length ? (this._zoomScroll = _, this) : this._zoomScroll;
      }
    }]);

    return Viz;
  }(BaseClass);

  function _typeof$r(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$r = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$r = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$r(obj);
  }

  function _classCallCheck$q(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$m(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$m(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$m(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$m(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$n(self, call) {
    if (call && (_typeof$r(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$n(self);
  }

  function _assertThisInitialized$n(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$7(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$7 = Reflect.get;
    } else {
      _get$7 = function _get(target, property, receiver) {
        var base = _superPropBase$7(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$7(target, property, receiver || target);
  }

  function _superPropBase$7(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$n(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$n(o) {
    _getPrototypeOf$n = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$n(o);
  }

  function _inherits$n(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$n(subClass, superClass);
  }

  function _setPrototypeOf$n(o, p) {
    _setPrototypeOf$n = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$n(o, p);
  }
  /**
      @name topo2feature
      @desc Converts a specific topojson object key into a feature ready for projection.
      @param {Object} *topo* A valid topojson json object.
      @param {String} [*key*] The topojson object key to be used. If undefined, the first key available will be used.
      @private
  */

  function topo2feature(topo, key) {
    var k = key && topo.objects[key] ? key : Object.keys(topo.objects)[0];
    return feature(topo, topo.objects[k]);
  }
  /**
      @class Geomap
      @extends external:Viz
      @desc Creates a geographical map with zooming, panning, image tiles, and the ability to layer choropleth paths and coordinate points. See [this example](https://d3plus.org/examples/d3plus-geomap/getting-started/) for help getting started.
  */


  var Geomap =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$n(Geomap, _Viz);
    /**
        @memberof Geomap
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Geomap() {
      var _this;

      _classCallCheck$q(this, Geomap);

      _this = _possibleConstructorReturn$n(this, _getPrototypeOf$n(Geomap).call(this));
      _this._fitObject = false;
      _this._noDataMessage = false;
      _this._ocean = "#d4dadc";
      _this._point = accessor("point");
      _this._pointSize = constant$3(1);
      _this._pointSizeMax = 10;
      _this._pointSizeMin = 5;
      _this._pointSizeScale = "linear";
      _this._projection = mercator();
      _this._projectionPadding = parseSides(20);
      _this._rotate = [0, 0];
      _this._shape = constant$3("Circle");
      _this._shapeConfig = assign(_this._shapeConfig, {
        ariaLabel: function ariaLabel(d, i) {
          return "".concat(_this._drawLabel(d, i), ", ").concat(_this._pointSize(d, i));
        },
        hoverOpacity: 1,
        Path: {
          ariaLabel: function ariaLabel(d, i) {
            var validColorScale = _this._colorScale ? ", ".concat(_this._colorScale(d, i)) : "";
            return "".concat(_this._drawLabel(d, i)).concat(validColorScale, ".");
          },
          fill: function fill(d) {
            if (_this._colorScale && !_this._coordData.features.includes(d)) {
              var c = _this._colorScale(d);

              if (c !== undefined && c !== null) {
                if (_this._colorScaleClass._colorScale) {
                  return _this._colorScaleClass._colorScale(c);
                } else {
                  var _color = _this._colorScaleClass.color();

                  if (_color instanceof Array) _color = _color[_color.length - 1];
                  return _color;
                }
              }
            }

            return _this._topojsonFill();
          },
          on: {
            "mouseenter": function mouseenter(d) {
              return !_this._coordData.features.includes(d) ? _this._on.mouseenter.bind(_assertThisInitialized$n(_this))(d) : null;
            },
            "mousemove.shape": function mousemoveShape(d) {
              return !_this._coordData.features.includes(d) ? _this._on["mousemove.shape"].bind(_assertThisInitialized$n(_this))(d) : null;
            },
            "mouseleave": function mouseleave(d) {
              return !_this._coordData.features.includes(d) ? _this._on.mouseleave.bind(_assertThisInitialized$n(_this))(d) : null;
            }
          },
          stroke: function stroke(d, i) {
            var c = typeof _this._shapeConfig.Path.fill === "function" ? _this._shapeConfig.Path.fill(d, i) : _this._shapeConfig.Path.fill;
            return color$3(c).darker();
          },
          strokeWidth: 1
        }
      });
      _this._tiles = true;
      _this._tileGen = tile().wrap(false);
      _this._tileUrl = "https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}@2x.png";
      _this._topojson = false;
      _this._topojsonFill = constant$3("#f5f5f3");

      _this._topojsonFilter = function (d) {
        return !["010"].includes(d.id);
      };

      _this._topojsonId = accessor("id");
      _this._zoom = true;
      _this._zoomSet = false;
      return _this;
    }
    /**
        Renders map tiles based on the current zoom level.
        @private
    */


    _createClass$m(Geomap, [{
      key: "_renderTiles",
      value: function _renderTiles(transform) {
        var _this2 = this;

        var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var tileData = [];

        if (this._tiles) {
          tileData = this._tileGen.extent(this._zoomBehavior.translateExtent()).scale(this._projection.scale() * (2 * Math.PI) * transform.k).translate(transform.apply(this._projection.translate()))();

          this._tileGroup.transition().duration(duration).attr("transform", transform);
        }

        var images = this._tileGroup.selectAll("image.tile").data(tileData, function (d) {
          return "".concat(d.x, "-").concat(d.y, "-").concat(d.z);
        });

        images.exit().transition().duration(duration).attr("opacity", 0).remove();
        var scale = tileData.scale / transform.k;
        images.enter().append("image").attr("class", "tile").attr("opacity", 0).attr("xlink:href", function (d) {
          return _this2._tileUrl.replace("{s}", ["a", "b", "c"][Math.random() * 3 | 0]).replace("{z}", d.z).replace("{x}", d.x).replace("{y}", d.y);
        }).attr("width", scale).attr("height", scale).attr("x", function (d) {
          return d.x * scale + tileData.translate[0] * scale - transform.x / transform.k;
        }).attr("y", function (d) {
          return d.y * scale + tileData.translate[1] * scale - transform.y / transform.k;
        }).transition().duration(duration).attr("opacity", 1);
        images.attr("width", scale).attr("height", scale).attr("x", function (d) {
          return d.x * scale + tileData.translate[0] * scale - transform.x / transform.k;
        }).attr("y", function (d) {
          return d.y * scale + tileData.translate[1] * scale - transform.y / transform.k;
        });
      }
      /**
          Extends the draw behavior of the abstract Viz class.
          @private
      */

    }, {
      key: "_draw",
      value: function _draw(callback) {
        var _this3 = this;

        _get$7(_getPrototypeOf$n(Geomap.prototype), "_draw", this).call(this, callback);

        var height = this._height - this._margin.top - this._margin.bottom,
            width = this._width - this._margin.left - this._margin.right;
        this._container = this._select.selectAll("svg.d3plus-geomap").data([0]);
        this._container = this._container.enter().append("svg").attr("class", "d3plus-geomap").attr("opacity", 0).attr("width", width).attr("height", height).attr("x", this._margin.left).attr("y", this._margin.top).style("background-color", this._ocean || "transparent").merge(this._container);

        this._container.transition(this._transition).attr("opacity", 1).attr("width", width).attr("height", height).attr("x", this._margin.left).attr("y", this._margin.top);

        var ocean = this._container.selectAll("rect.d3plus-geomap-ocean").data([0]);

        ocean.enter().append("rect").attr("class", "d3plus-geomap-ocean").merge(ocean).attr("width", width).attr("height", height).attr("fill", this._ocean || "transparent");
        this._tileGroup = this._container.selectAll("g.d3plus-geomap-tileGroup").data([0]);
        this._tileGroup = this._tileGroup.enter().append("g").attr("class", "d3plus-geomap-tileGroup").merge(this._tileGroup);
        this._zoomGroup = this._container.selectAll("g.d3plus-geomap-zoomGroup").data([0]);
        this._zoomGroup = this._zoomGroup.enter().append("g").attr("class", "d3plus-geomap-zoomGroup").merge(this._zoomGroup);

        var pathGroup = this._zoomGroup.selectAll("g.d3plus-geomap-paths").data([0]);

        pathGroup = pathGroup.enter().append("g").attr("class", "d3plus-geomap-paths").merge(pathGroup);
        var coordData = this._coordData = this._topojson ? topo2feature(this._topojson, this._topojsonKey) : {
          type: "FeatureCollection",
          features: []
        };
        if (this._topojsonFilter) coordData.features = coordData.features.filter(this._topojsonFilter);
        var path = this._path = index().projection(this._projection);

        var pointData = this._filteredData.filter(function (d, i) {
          return _this3._point(d, i) instanceof Array;
        });

        var pathData = this._filteredData.filter(function (d, i) {
          return !(_this3._point(d, i) instanceof Array);
        }).reduce(function (obj, d) {
          obj[_this3._id(d)] = d;
          return obj;
        }, {});

        var topoData = coordData.features.reduce(function (arr, feature) {
          var id = _this3._topojsonId(feature);

          arr.push({
            __d3plus__: true,
            data: pathData[id],
            feature: feature,
            id: id
          });
          return arr;
        }, []);
        var r = scales["scale".concat(this._pointSizeScale.charAt(0).toUpperCase()).concat(this._pointSizeScale.slice(1))]().domain(extent(pointData, function (d, i) {
          return _this3._pointSize(d, i);
        })).range([this._pointSizeMin, this._pointSizeMax]);

        if (!this._zoomSet) {
          var fitData = this._fitObject ? topo2feature(this._fitObject, this._fitKey) : coordData;
          this._extentBounds = {
            type: "FeatureCollection",
            features: this._fitFilter ? fitData.features.filter(this._fitFilter) : fitData.features.slice()
          };
          this._extentBounds.features = this._extentBounds.features.reduce(function (arr, d) {
            if (d.geometry) {
              var reduced = {
                type: d.type,
                id: d.id,
                geometry: {
                  coordinates: d.geometry.coordinates,
                  type: d.geometry.type
                }
              };

              if (d.geometry.type === "MultiPolygon" && d.geometry.coordinates.length > 1) {
                var areas = [],
                    distances = [];
                d.geometry.coordinates.forEach(function (c) {
                  reduced.geometry.coordinates = [c];
                  areas.push(path.area(reduced));
                });
                reduced.geometry.coordinates = [d.geometry.coordinates[areas.indexOf(max(areas))]];
                var center = path.centroid(reduced);
                d.geometry.coordinates.forEach(function (c) {
                  reduced.geometry.coordinates = [c];
                  distances.push(pointDistance(path.centroid(reduced), center));
                });
                var distCutoff = quantile(areas.reduce(function (arr, dist, i) {
                  if (dist) arr.push(areas[i] / dist);
                  return arr;
                }, []), 0.9);
                reduced.geometry.coordinates = d.geometry.coordinates.filter(function (c, i) {
                  var dist = distances[i];
                  return dist === 0 || areas[i] / dist >= distCutoff;
                });
              }

              arr.push(reduced);
            }

            return arr;
          }, []);

          if (!this._extentBounds.features.length && pointData.length) {
            var bounds = [[undefined, undefined], [undefined, undefined]];
            pointData.forEach(function (d, i) {
              var point = _this3._projection(_this3._point(d, i));

              if (bounds[0][0] === void 0 || point[0] < bounds[0][0]) bounds[0][0] = point[0];
              if (bounds[1][0] === void 0 || point[0] > bounds[1][0]) bounds[1][0] = point[0];
              if (bounds[0][1] === void 0 || point[1] < bounds[0][1]) bounds[0][1] = point[1];
              if (bounds[1][1] === void 0 || point[1] > bounds[1][1]) bounds[1][1] = point[1];
            });
            this._extentBounds = {
              type: "FeatureCollection",
              features: [{
                type: "Feature",
                geometry: {
                  type: "MultiPoint",
                  coordinates: bounds.map(function (b) {
                    return _this3._projection.invert(b);
                  })
                }
              }]
            };
            var maxSize = max(pointData, function (d, i) {
              return r(_this3._pointSize(d, i));
            });
            this._projectionPadding.top += maxSize;
            this._projectionPadding.right += maxSize;
            this._projectionPadding.bottom += maxSize;
            this._projectionPadding.left += maxSize;
          }

          this._zoomBehavior.extent([[0, 0], [width, height]]).scaleExtent([1, this._zoomMax]).translateExtent([[0, 0], [width, height]]);

          this._zoomSet = true;
        }

        this._projection = this._projection.fitExtent(this._extentBounds.features.length ? [[this._projectionPadding.left, this._projectionPadding.top], [width - this._projectionPadding.right, height - this._projectionPadding.bottom]] : [[0, 0], [width, height]], this._extentBounds.features.length ? this._extentBounds : {
          type: "Sphere"
        });

        this._shapes.push(new Path$1().data(topoData).d(function (d) {
          return path(d.feature);
        }).select(pathGroup.node()).x(0).y(0).config(configPrep.bind(this)(this._shapeConfig, "shape", "Path")).render());

        var pointGroup = this._zoomGroup.selectAll("g.d3plus-geomap-pins").data([0]);

        pointGroup = pointGroup.enter().append("g").attr("class", "d3plus-geomap-pins").merge(pointGroup);
        var circles = new Circle().config(configPrep.bind(this)(this._shapeConfig, "shape", "Circle")).data(pointData).r(function (d, i) {
          return r(_this3._pointSize(d, i));
        }).select(pointGroup.node()).sort(function (a, b) {
          return _this3._pointSize(b) - _this3._pointSize(a);
        }).x(function (d, i) {
          return _this3._projection(_this3._point(d, i))[0];
        }).y(function (d, i) {
          return _this3._projection(_this3._point(d, i))[1];
        });
        var events = Object.keys(this._on);
        var classEvents = events.filter(function (e) {
          return e.includes(".Circle");
        }),
            globalEvents = events.filter(function (e) {
          return !e.includes(".");
        }),
            shapeEvents = events.filter(function (e) {
          return e.includes(".shape");
        });

        for (var e = 0; e < globalEvents.length; e++) {
          circles.on(globalEvents[e], this._on[globalEvents[e]]);
        }

        for (var _e = 0; _e < shapeEvents.length; _e++) {
          circles.on(shapeEvents[_e], this._on[shapeEvents[_e]]);
        }

        for (var _e2 = 0; _e2 < classEvents.length; _e2++) {
          circles.on(classEvents[_e2], this._on[classEvents[_e2]]);
        }

        this._shapes.push(circles.render());

        return this;
      }
      /**
          @memberof Geomap
          @desc Topojson files sometimes include small geographies that negatively impact how the library determines the default zoom level (for example, a small island or territory far off the coast that is barely visible to the eye). The fitFilter method can be used to remove specific geographies from the logic used to determine the zooming.
      The *value* passed can be a single id to remove, an array of ids, or a filter function. Take a look at the [Choropleth Example](http://d3plus.org/examples/d3plus-geomap/getting-started/) to see it in action.
          @param {Number|String|Array|Function} [*value*]
          @chainable
      */

    }, {
      key: "fitFilter",
      value: function fitFilter(_) {
        if (arguments.length) {
          this._zoomSet = false;
          if (typeof _ === "function") return this._fitFilter = _, this;
          if (!(_ instanceof Array)) _ = [_];
          return this._fitFilter = function (d) {
            return _.includes(d.id);
          }, this;
        }

        return this._fitFilter;
      }
      /**
          @memberof Geomap
          @desc If the topojson being used to determine the zoom fit (either the main [topojson](#Geomap.topojson) object or the [fitObject](#Geomap.fitObject)) contains multiple geographical sets (for example, a file containing state and county boundaries), use this method to indentify which set to use for the zoom fit.
      If not specified, the first key in the *Array* returned from using `Object.keys` on the topojson will be used.
          @param {String} *value*
          @chainable
      */

    }, {
      key: "fitKey",
      value: function fitKey(_) {
        if (arguments.length) {
          this._fitKey = _;
          this._zoomSet = false;
          return this;
        }

        return this._fitKey;
      }
      /**
          @memberof Geomap
          @desc The topojson to be used for the initial projection [fit extent](https://github.com/d3/d3-geo#projection_fitExtent). The value passed should either be a valid Topojson *Object* or a *String* representing a filepath or URL to be loaded.
      Additionally, a custom formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function needs to return the final Topojson *Object*.
          @param {Object|String} *data* = `undefined`
          @param {Function} [*formatter*]
          @chainable
      */

    }, {
      key: "fitObject",
      value: function fitObject(_, f) {
        if (arguments.length) {
          if (typeof _ === "string") {
            var prev = this._queue.find(function (q) {
              return q[3] === "fitObject";
            });

            var d = [load.bind(this), _, f, "fitObject"];
            if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          } else {
            this._fitObject = _;
          }

          this._zoomSet = false;
          return this;
        }

        return this._fitObject;
      }
      /**
          @memberof Geomap
          @desc The color visible behind any shapes drawn on the map projection. By default, a color value matching the color used in the map tiles is used to help mask the loading time needed to render the tiles. Any value CSS color value may be used, including hexidecimal, rgb, rgba, and color strings like `"blue"` and `"transparent"`.
          @param {String} [*value* = "#d4dadc"]
          @chainable
      */

    }, {
      key: "ocean",
      value: function ocean(_) {
        return arguments.length ? (this._ocean = _, this) : this._ocean;
      }
      /**
          @memberof Geomap
          @desc The accessor to be used when detecting coordinate points in the objects passed to the [data](https://d3plus.org/docs/#Viz.data) method. Values are expected to be in the format `[longitude, latitude]`, which is in-line with d3's expected coordinate mapping.
          @param {Function|Array} [*value*]
          @chainable
      */

    }, {
      key: "point",
      value: function point(_) {
        return arguments.length ? (this._point = typeof _ === "function" ? _ : constant$3(_), this) : this._point;
      }
      /**
          @memberof Geomap
          @desc The accessor or static value to be used for sizing coordinate points.
          @param {Function|Number} [*value*]
          @chainable
      */

    }, {
      key: "pointSize",
      value: function pointSize(_) {
        return arguments.length ? (this._pointSize = typeof _ === "function" ? _ : constant$3(_), this) : this._pointSize;
      }
      /**
          @memberof Geomap
          @desc The maximum pixel radius used in the scale for sizing coordinate points.
          @param {Number} [*value* = 10]
          @chainable
      */

    }, {
      key: "pointSizeMax",
      value: function pointSizeMax(_) {
        return arguments.length ? (this._pointSizeMax = _, this) : this._pointSizeMax;
      }
      /**
          @memberof Geomap
          @desc The minimum pixel radius used in the scale for sizing coordinate points.
          @param {Number} [*value* = 5]
          @chainable
      */

    }, {
      key: "pointSizeMin",
      value: function pointSizeMin(_) {
        return arguments.length ? (this._pointSizeMin = _, this) : this._pointSizeMin;
      }
      /**
          @memberof Geomap
          @desc Sets the map projection used when displaying topojson and coordinate points. Any of the standard projections exported from [d3-geo](https://github.com/d3/d3-geo#projections) are accepted, whether as the string name (ie. "geoMercator") or the generator function itself. Map tiles are only usable when the projection is set to Mercator (which is also the default value).
          @param {Function|String} *projection* = "geoMercator"
          @chainable
      */

    }, {
      key: "projection",
      value: function projection(_) {
        if (arguments.length && _ !== "geoMercator") this._tiles = false;
        return arguments.length ? (this._projection = typeof _ === "string" ? d3Geo[_]() : _, this) : this._projection;
      }
      /**
          @memberof Geomap
          @desc The outer padding between the edge of the visualization and the shapes drawn. The value passed can be either a single number to be used on all sides, or a CSS string pattern (ie. `"20px 0 10px"`).
          @param {Number|String} [*value* = 20]
          @chainable
      */

    }, {
      key: "projectionPadding",
      value: function projectionPadding(_) {
        return arguments.length ? (this._projectionPadding = parseSides(_), this) : this._projectionPadding;
      }
      /**
          @memberof Geomap
          @desc Toggles the visibility of the map tiles.
          @param {Boolean} [*value* = true]
          @chainable
      */

    }, {
      key: "tiles",
      value: function tiles(_) {
        return arguments.length ? (this._tiles = _, this) : this._tiles;
      }
      /**
          @memberof Geomap
          @desc By default, d3plus uses the `light_all` style provided by [CARTO](https://carto.com/location-data-services/basemaps/) for it's map tiles. The [tileUrl](https://d3plus.org/docs/#Geomap.tileUrl) method changes the base URL used for fetching the tiles, as long as the string passed contains `{x}`, `{y}`, and `{z}` variables enclosed in curly brackets for the zoom logic to load the correct tiles.
          @param {String} [url="https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"]
          @chainable
      */

    }, {
      key: "tileUrl",
      value: function tileUrl(_) {
        return arguments.length ? (this._tileUrl = _, this) : this._tileUrl;
      }
      /**
          @memberof Geomap
          @desc The topojson to be used for drawing geographical paths. The value passed should either be a valid Topojson *Object* or a *String* representing a filepath or URL to be loaded.
      Additionally, a custom formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final Topojson *Obejct*.
          @param {Object|String} *data* = []
          @param {Function} [*formatter*]
          @chainable
      */

    }, {
      key: "topojson",
      value: function topojson(_, f) {
        if (arguments.length) {
          if (typeof _ === "string") {
            var prev = this._queue.find(function (q) {
              return q[3] === "topojson";
            });

            var d = [load.bind(this), _, f, "topojson"];
            if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          } else {
            this._topojson = _;
          }

          this._zoomSet = false;
          return this;
        }

        return this._topojson;
      }
      /**
          @memberof Geomap
          @desc The function is used to set default color of the map.
          @param {String|Function} *value* = string
          @chainable
      */

    }, {
      key: "topojsonFill",
      value: function topojsonFill(_) {
        return arguments.length ? (this._topojsonFill = typeof _ === "function" ? _ : constant$3(_), this) : this._topojsonFill;
      }
      /**
          @memberof Geomap
          @desc If the [topojson](#Geomap.topojson) being used contains boundaries that should not be shown, this method can be used to filter them out of the final output. The *value* passed can be a single id to remove, an array of ids, or a filter function.
          @param {Number|String|Array|Function} [*value*]
          @chainable
      */

    }, {
      key: "topojsonFilter",
      value: function topojsonFilter(_) {
        if (arguments.length) {
          this._zoomSet = false;
          if (typeof _ === "function") return this._topojsonFilter = _, this;
          if (!(_ instanceof Array)) _ = [_];
          return this._topojsonFilter = function (d) {
            return _.includes(d.id);
          }, this;
        }

        return this._topojsonFilter;
      }
      /**
          @memberof Geomap
          @desc If the [topojson](#Geomap.topojson) contains multiple geographical sets (for example, a file containing state and county boundaries), use this method to indentify which set to use.
      If not specified, the first key in the *Array* returned from using `Object.keys` on the topojson will be used.
          @param {String} *value*
          @chainable
      */

    }, {
      key: "topojsonKey",
      value: function topojsonKey(_) {
        if (arguments.length) {
          this._topojsonKey = _;
          this._zoomSet = false;
          return this;
        }

        return this._topojsonKey;
      }
      /**
          @memberof Geomap
          @desc The accessor used to map each topojson geometry to it's corresponding [data](https://d3plus.org/docs/#Viz.data) point.
          @param {String|Function} *value* = "id"
          @chainable
      */

    }, {
      key: "topojsonId",
      value: function topojsonId(_) {
        return arguments.length ? (this._topojsonId = typeof _ === "function" ? _ : accessor(_), this) : this._topojsonId;
      }
    }]);

    return Geomap;
  }(Viz);

  function _typeof$s(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$s = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$s = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$s(obj);
  }

  function _classCallCheck$r(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$n(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$n(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$n(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$n(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$o(self, call) {
    if (call && (_typeof$s(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$o(self);
  }

  function _assertThisInitialized$o(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$8(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$8 = Reflect.get;
    } else {
      _get$8 = function _get(target, property, receiver) {
        var base = _superPropBase$8(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$8(target, property, receiver || target);
  }

  function _superPropBase$8(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$o(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$o(o) {
    _getPrototypeOf$o = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$o(o);
  }

  function _inherits$o(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$o(subClass, superClass);
  }

  function _setPrototypeOf$o(o, p) {
    _setPrototypeOf$o = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$o(o, p);
  }
  /**
      @class Pie
      @extends Viz
      @desc Uses the [d3 pie layout](https://github.com/d3/d3-shape#pies) to creates SVG arcs based on an array of data.
  */

  var Pie =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$o(Pie, _Viz);
    /**
        @memberof Pie
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Pie() {
      var _this;

      _classCallCheck$r(this, Pie);

      _this = _possibleConstructorReturn$o(this, _getPrototypeOf$o(Pie).call(this));
      _this._shapeConfig = assign(_this._shapeConfig, {
        ariaLabel: function ariaLabel(d, i) {
          return _this._pieData ? "".concat(++_this._pieData[i].index, ". ").concat(_this._drawLabel(d, i), ", ").concat(_this._value(d, i), ".") : "";
        },
        Path: {
          labelConfig: {
            fontResize: true
          }
        }
      });
      _this._innerRadius = 0;

      _this._legendSort = function (a, b) {
        return _this._value(b) - _this._value(a);
      };

      _this._padPixel = 0;
      _this._pie = pie();

      _this._sort = function (a, b) {
        return _this._value(b) - _this._value(a);
      };

      _this._value = accessor("value");
      return _this;
    }
    /**
        Extends the draw behavior of the abstract Viz class.
        @private
    */


    _createClass$n(Pie, [{
      key: "_draw",
      value: function _draw(callback) {
        var _this2 = this;

        _get$8(_getPrototypeOf$o(Pie.prototype), "_draw", this).call(this, callback);

        var height = this._height - this._margin.top - this._margin.bottom,
            width = this._width - this._margin.left - this._margin.right;
        var outerRadius = min([width, height]) / 2;

        var pieData = this._pieData = this._pie.padAngle(this._padAngle || this._padPixel / outerRadius).sort(this._sort).value(this._value)(this._filteredData);

        pieData.forEach(function (d, i) {
          d.__d3plus__ = true;
          d.i = i;
        });
        var arcData = arc().innerRadius(this._innerRadius).outerRadius(outerRadius);
        var transform = "translate(".concat(width / 2 + this._margin.left, ", ").concat(height / 2 + this._margin.top, ")");

        this._shapes.push(new Path$1().data(pieData).d(arcData).select(elem("g.d3plus-Pie", {
          parent: this._select,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        }).node()).config({
          id: function id(d) {
            return _this2._ids(d).join("-");
          },
          x: 0,
          y: 0
        }).label(this._drawLabel).config(configPrep.bind(this)(this._shapeConfig, "shape", "Path")).render());

        return this;
      }
      /**
          @memberof Pie
          @desc If *value* is specified, sets the inner radius accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current inner radius accessor.
          @param {Function|Number} [*value*]
      */

    }, {
      key: "innerRadius",
      value: function innerRadius(_) {
        return arguments.length ? (this._innerRadius = _, this) : this._innerRadius;
      }
      /**
          @memberof Pie
          @desc If *value* is specified, sets the arc padding to the specified radian value and returns the current class instance. If *value* is not specified, returns the current radian padding.
          @param {Number} [*value*]
      */

    }, {
      key: "padAngle",
      value: function padAngle(_) {
        return arguments.length ? (this._padAngle = _, this) : this._padAngle;
      }
      /**
          @memberof Pie
          @desc If *value* is specified, sets the arc padding to the specified pixel value and returns the current class instance. If *value* is not specified, returns the current pixel padding.
          @param {Number} [*value*]
      */

    }, {
      key: "padPixel",
      value: function padPixel(_) {
        return arguments.length ? (this._padPixel = _, this) : this._padPixel;
      }
      /**
          @memberof Pie
          @desc If *comparator* is specified, sets the sort order for the pie slices using the specified comparator function. If *comparator* is not specified, returns the current sort order, which defaults to descending order by the associated input data's numeric value attribute.
          @param {Array} [*comparator*]
          @example
      function comparator(a, b) {
      return b.value - a.value;
      }
      */

    }, {
      key: "sort",
      value: function sort(_) {
        return arguments.length ? (this._sort = _, this) : this._sort;
      }
      /**
          @memberof Pie
          @desc If *value* is specified, sets the value accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current value accessor.
          @param {Function|String} *value*
          @example
      function value(d) {
      return d.value;
      }
      */

    }, {
      key: "value",
      value: function value(_) {
        return arguments.length ? (this._value = typeof _ === "function" ? _ : accessor(_), this) : this._value;
      }
    }]);

    return Pie;
  }(Viz);

  function _typeof$t(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$t = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$t = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$t(obj);
  }

  function _classCallCheck$s(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$p(self, call) {
    if (call && (_typeof$t(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$p(self);
  }

  function _assertThisInitialized$p(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$p(o) {
    _getPrototypeOf$p = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$p(o);
  }

  function _inherits$p(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$p(subClass, superClass);
  }

  function _setPrototypeOf$p(o, p) {
    _setPrototypeOf$p = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$p(o, p);
  }
  /**
      @class Donut
      @extends Pie
      @desc Extends the Pie visualization to create a donut chart.
  */

  var Donut =
  /*#__PURE__*/
  function (_Pie) {
    _inherits$p(Donut, _Pie);
    /**
        @memberof Donut
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Donut() {
      var _this;

      _classCallCheck$s(this, Donut);

      _this = _possibleConstructorReturn$p(this, _getPrototypeOf$p(Donut).call(this));

      _this._innerRadius = function () {
        return min([_this._width - _this._margin.left - _this._margin.right, _this._height - _this._margin.top - _this._margin.bottom]) / 4;
      };

      _this._padPixel = 2;
      return _this;
    }

    return Donut;
  }(Pie);

  function count(node) {
    var sum = 0,
        children = node.children,
        i = children && children.length;
    if (!i) sum = 1;else while (--i >= 0) {
      sum += children[i].value;
    }
    node.value = sum;
  }

  function node_count () {
    return this.eachAfter(count);
  }

  function node_each (callback) {
    var node = this,
        current,
        next = [node],
        children,
        i,
        n;

    do {
      current = next.reverse(), next = [];

      while (node = current.pop()) {
        callback(node), children = node.children;
        if (children) for (i = 0, n = children.length; i < n; ++i) {
          next.push(children[i]);
        }
      }
    } while (next.length);

    return this;
  }

  function node_eachBefore (callback) {
    var node = this,
        nodes = [node],
        children,
        i;

    while (node = nodes.pop()) {
      callback(node), children = node.children;
      if (children) for (i = children.length - 1; i >= 0; --i) {
        nodes.push(children[i]);
      }
    }

    return this;
  }

  function node_eachAfter (callback) {
    var node = this,
        nodes = [node],
        next = [],
        children,
        i,
        n;

    while (node = nodes.pop()) {
      next.push(node), children = node.children;
      if (children) for (i = 0, n = children.length; i < n; ++i) {
        nodes.push(children[i]);
      }
    }

    while (node = next.pop()) {
      callback(node);
    }

    return this;
  }

  function node_sum (value) {
    return this.eachAfter(function (node) {
      var sum = +value(node.data) || 0,
          children = node.children,
          i = children && children.length;

      while (--i >= 0) {
        sum += children[i].value;
      }

      node.value = sum;
    });
  }

  function node_sort (compare) {
    return this.eachBefore(function (node) {
      if (node.children) {
        node.children.sort(compare);
      }
    });
  }

  function node_path (end) {
    var start = this,
        ancestor = leastCommonAncestor(start, end),
        nodes = [start];

    while (start !== ancestor) {
      start = start.parent;
      nodes.push(start);
    }

    var k = nodes.length;

    while (end !== ancestor) {
      nodes.splice(k, 0, end);
      end = end.parent;
    }

    return nodes;
  }

  function leastCommonAncestor(a, b) {
    if (a === b) return a;
    var aNodes = a.ancestors(),
        bNodes = b.ancestors(),
        c = null;
    a = aNodes.pop();
    b = bNodes.pop();

    while (a === b) {
      c = a;
      a = aNodes.pop();
      b = bNodes.pop();
    }

    return c;
  }

  function node_ancestors () {
    var node = this,
        nodes = [node];

    while (node = node.parent) {
      nodes.push(node);
    }

    return nodes;
  }

  function node_descendants () {
    var nodes = [];
    this.each(function (node) {
      nodes.push(node);
    });
    return nodes;
  }

  function node_leaves () {
    var leaves = [];
    this.eachBefore(function (node) {
      if (!node.children) {
        leaves.push(node);
      }
    });
    return leaves;
  }

  function node_links () {
    var root = this,
        links = [];
    root.each(function (node) {
      if (node !== root) {
        // Dont include the roots parent, if any.
        links.push({
          source: node.parent,
          target: node
        });
      }
    });
    return links;
  }

  function hierarchy(data, children) {
    var root = new Node$2(data),
        valued = +data.value && (root.value = data.value),
        node,
        nodes = [root],
        child,
        childs,
        i,
        n;
    if (children == null) children = defaultChildren;

    while (node = nodes.pop()) {
      if (valued) node.value = +node.data.value;

      if ((childs = children(node.data)) && (n = childs.length)) {
        node.children = new Array(n);

        for (i = n - 1; i >= 0; --i) {
          nodes.push(child = node.children[i] = new Node$2(childs[i]));
          child.parent = node;
          child.depth = node.depth + 1;
        }
      }
    }

    return root.eachBefore(computeHeight);
  }

  function node_copy() {
    return hierarchy(this).eachBefore(copyData);
  }

  function defaultChildren(d) {
    return d.children;
  }

  function copyData(node) {
    node.data = node.data.data;
  }

  function computeHeight(node) {
    var height = 0;

    do {
      node.height = height;
    } while ((node = node.parent) && node.height < ++height);
  }
  function Node$2(data) {
    this.data = data;
    this.depth = this.height = 0;
    this.parent = null;
  }
  Node$2.prototype = hierarchy.prototype = {
    constructor: Node$2,
    count: node_count,
    each: node_each,
    eachAfter: node_eachAfter,
    eachBefore: node_eachBefore,
    sum: node_sum,
    sort: node_sort,
    path: node_path,
    ancestors: node_ancestors,
    descendants: node_descendants,
    leaves: node_leaves,
    links: node_links,
    copy: node_copy
  };

  var slice$3 = Array.prototype.slice;
  function shuffle(array) {
    var m = array.length,
        t,
        i;

    while (m) {
      i = Math.random() * m-- | 0;
      t = array[m];
      array[m] = array[i];
      array[i] = t;
    }

    return array;
  }

  function enclose (circles) {
    var i = 0,
        n = (circles = shuffle(slice$3.call(circles))).length,
        B = [],
        p,
        e;

    while (i < n) {
      p = circles[i];
      if (e && enclosesWeak(e, p)) ++i;else e = encloseBasis(B = extendBasis(B, p)), i = 0;
    }

    return e;
  }

  function extendBasis(B, p) {
    var i, j;
    if (enclosesWeakAll(p, B)) return [p]; // If we get here then B must have at least one element.

    for (i = 0; i < B.length; ++i) {
      if (enclosesNot(p, B[i]) && enclosesWeakAll(encloseBasis2(B[i], p), B)) {
        return [B[i], p];
      }
    } // If we get here then B must have at least two elements.


    for (i = 0; i < B.length - 1; ++i) {
      for (j = i + 1; j < B.length; ++j) {
        if (enclosesNot(encloseBasis2(B[i], B[j]), p) && enclosesNot(encloseBasis2(B[i], p), B[j]) && enclosesNot(encloseBasis2(B[j], p), B[i]) && enclosesWeakAll(encloseBasis3(B[i], B[j], p), B)) {
          return [B[i], B[j], p];
        }
      }
    } // If we get here then something is very wrong.


    throw new Error();
  }

  function enclosesNot(a, b) {
    var dr = a.r - b.r,
        dx = b.x - a.x,
        dy = b.y - a.y;
    return dr < 0 || dr * dr < dx * dx + dy * dy;
  }

  function enclosesWeak(a, b) {
    var dr = a.r - b.r + 1e-6,
        dx = b.x - a.x,
        dy = b.y - a.y;
    return dr > 0 && dr * dr > dx * dx + dy * dy;
  }

  function enclosesWeakAll(a, B) {
    for (var i = 0; i < B.length; ++i) {
      if (!enclosesWeak(a, B[i])) {
        return false;
      }
    }

    return true;
  }

  function encloseBasis(B) {
    switch (B.length) {
      case 1:
        return encloseBasis1(B[0]);

      case 2:
        return encloseBasis2(B[0], B[1]);

      case 3:
        return encloseBasis3(B[0], B[1], B[2]);
    }
  }

  function encloseBasis1(a) {
    return {
      x: a.x,
      y: a.y,
      r: a.r
    };
  }

  function encloseBasis2(a, b) {
    var x1 = a.x,
        y1 = a.y,
        r1 = a.r,
        x2 = b.x,
        y2 = b.y,
        r2 = b.r,
        x21 = x2 - x1,
        y21 = y2 - y1,
        r21 = r2 - r1,
        l = Math.sqrt(x21 * x21 + y21 * y21);
    return {
      x: (x1 + x2 + x21 / l * r21) / 2,
      y: (y1 + y2 + y21 / l * r21) / 2,
      r: (l + r1 + r2) / 2
    };
  }

  function encloseBasis3(a, b, c) {
    var x1 = a.x,
        y1 = a.y,
        r1 = a.r,
        x2 = b.x,
        y2 = b.y,
        r2 = b.r,
        x3 = c.x,
        y3 = c.y,
        r3 = c.r,
        a2 = x1 - x2,
        a3 = x1 - x3,
        b2 = y1 - y2,
        b3 = y1 - y3,
        c2 = r2 - r1,
        c3 = r3 - r1,
        d1 = x1 * x1 + y1 * y1 - r1 * r1,
        d2 = d1 - x2 * x2 - y2 * y2 + r2 * r2,
        d3 = d1 - x3 * x3 - y3 * y3 + r3 * r3,
        ab = a3 * b2 - a2 * b3,
        xa = (b2 * d3 - b3 * d2) / (ab * 2) - x1,
        xb = (b3 * c2 - b2 * c3) / ab,
        ya = (a3 * d2 - a2 * d3) / (ab * 2) - y1,
        yb = (a2 * c3 - a3 * c2) / ab,
        A = xb * xb + yb * yb - 1,
        B = 2 * (r1 + xa * xb + ya * yb),
        C = xa * xa + ya * ya - r1 * r1,
        r = -(A ? (B + Math.sqrt(B * B - 4 * A * C)) / (2 * A) : C / B);
    return {
      x: x1 + xa + xb * r,
      y: y1 + ya + yb * r,
      r: r
    };
  }

  function place(b, a, c) {
    var dx = b.x - a.x,
        x,
        a2,
        dy = b.y - a.y,
        y,
        b2,
        d2 = dx * dx + dy * dy;

    if (d2) {
      a2 = a.r + c.r, a2 *= a2;
      b2 = b.r + c.r, b2 *= b2;

      if (a2 > b2) {
        x = (d2 + b2 - a2) / (2 * d2);
        y = Math.sqrt(Math.max(0, b2 / d2 - x * x));
        c.x = b.x - x * dx - y * dy;
        c.y = b.y - x * dy + y * dx;
      } else {
        x = (d2 + a2 - b2) / (2 * d2);
        y = Math.sqrt(Math.max(0, a2 / d2 - x * x));
        c.x = a.x + x * dx - y * dy;
        c.y = a.y + x * dy + y * dx;
      }
    } else {
      c.x = a.x + c.r;
      c.y = a.y;
    }
  }

  function intersects(a, b) {
    var dr = a.r + b.r - 1e-6,
        dx = b.x - a.x,
        dy = b.y - a.y;
    return dr > 0 && dr * dr > dx * dx + dy * dy;
  }

  function score(node) {
    var a = node._,
        b = node.next._,
        ab = a.r + b.r,
        dx = (a.x * b.r + b.x * a.r) / ab,
        dy = (a.y * b.r + b.y * a.r) / ab;
    return dx * dx + dy * dy;
  }

  function Node$3(circle) {
    this._ = circle;
    this.next = null;
    this.previous = null;
  }

  function packEnclose(circles) {
    if (!(n = circles.length)) return 0;
    var a, b, c, n, aa, ca, i, j, k, sj, sk; // Place the first circle.

    a = circles[0], a.x = 0, a.y = 0;
    if (!(n > 1)) return a.r; // Place the second circle.

    b = circles[1], a.x = -b.r, b.x = a.r, b.y = 0;
    if (!(n > 2)) return a.r + b.r; // Place the third circle.

    place(b, a, c = circles[2]); // Initialize the front-chain using the first three circles a, b and c.

    a = new Node$3(a), b = new Node$3(b), c = new Node$3(c);
    a.next = c.previous = b;
    b.next = a.previous = c;
    c.next = b.previous = a; // Attempt to place each remaining circle

    pack: for (i = 3; i < n; ++i) {
      place(a._, b._, c = circles[i]), c = new Node$3(c); // Find the closest intersecting circle on the front-chain, if any.
      // Closeness is determined by linear distance along the front-chain.
      // Ahead or behind is likewise determined by linear distance.

      j = b.next, k = a.previous, sj = b._.r, sk = a._.r;

      do {
        if (sj <= sk) {
          if (intersects(j._, c._)) {
            b = j, a.next = b, b.previous = a, --i;
            continue pack;
          }

          sj += j._.r, j = j.next;
        } else {
          if (intersects(k._, c._)) {
            a = k, a.next = b, b.previous = a, --i;
            continue pack;
          }

          sk += k._.r, k = k.previous;
        }
      } while (j !== k.next); // Success! Insert the new circle c between a and b.


      c.previous = a, c.next = b, a.next = b.previous = b = c; // Compute the new closest circle pair to the centroid.

      aa = score(a);

      while ((c = c.next) !== b) {
        if ((ca = score(c)) < aa) {
          a = c, aa = ca;
        }
      }

      b = a.next;
    } // Compute the enclosing circle of the front chain.


    a = [b._], c = b;

    while ((c = c.next) !== b) {
      a.push(c._);
    }

    c = enclose(a); // Translate the circles to put the enclosing circle around the origin.

    for (i = 0; i < n; ++i) {
      a = circles[i], a.x -= c.x, a.y -= c.y;
    }

    return c.r;
  }

  function optional(f) {
    return f == null ? null : required(f);
  }
  function required(f) {
    if (typeof f !== "function") throw new Error();
    return f;
  }

  function constantZero() {
    return 0;
  }
  function constant$9 (x) {
    return function () {
      return x;
    };
  }

  function defaultRadius(d) {
    return Math.sqrt(d.value);
  }

  function pack () {
    var radius = null,
        dx = 1,
        dy = 1,
        padding = constantZero;

    function pack(root) {
      root.x = dx / 2, root.y = dy / 2;

      if (radius) {
        root.eachBefore(radiusLeaf(radius)).eachAfter(packChildren(padding, 0.5)).eachBefore(translateChild(1));
      } else {
        root.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildren(constantZero, 1)).eachAfter(packChildren(padding, root.r / Math.min(dx, dy))).eachBefore(translateChild(Math.min(dx, dy) / (2 * root.r)));
      }

      return root;
    }

    pack.radius = function (x) {
      return arguments.length ? (radius = optional(x), pack) : radius;
    };

    pack.size = function (x) {
      return arguments.length ? (dx = +x[0], dy = +x[1], pack) : [dx, dy];
    };

    pack.padding = function (x) {
      return arguments.length ? (padding = typeof x === "function" ? x : constant$9(+x), pack) : padding;
    };

    return pack;
  }

  function radiusLeaf(radius) {
    return function (node) {
      if (!node.children) {
        node.r = Math.max(0, +radius(node) || 0);
      }
    };
  }

  function packChildren(padding, k) {
    return function (node) {
      if (children = node.children) {
        var children,
            i,
            n = children.length,
            r = padding(node) * k || 0,
            e;
        if (r) for (i = 0; i < n; ++i) {
          children[i].r += r;
        }
        e = packEnclose(children);
        if (r) for (i = 0; i < n; ++i) {
          children[i].r -= r;
        }
        node.r = e + r;
      }
    };
  }

  function translateChild(k) {
    return function (node) {
      var parent = node.parent;
      node.r *= k;

      if (parent) {
        node.x = parent.x + k * node.x;
        node.y = parent.y + k * node.y;
      }
    };
  }

  function roundNode (node) {
    node.x0 = Math.round(node.x0);
    node.y0 = Math.round(node.y0);
    node.x1 = Math.round(node.x1);
    node.y1 = Math.round(node.y1);
  }

  function treemapDice (parent, x0, y0, x1, y1) {
    var nodes = parent.children,
        node,
        i = -1,
        n = nodes.length,
        k = parent.value && (x1 - x0) / parent.value;

    while (++i < n) {
      node = nodes[i], node.y0 = y0, node.y1 = y1;
      node.x0 = x0, node.x1 = x0 += node.value * k;
    }
  }

  function defaultSeparation(a, b) {
    return a.parent === b.parent ? 1 : 2;
  } // function radialSeparation(a, b) {
  //   return (a.parent === b.parent ? 1 : 2) / a.depth;
  // }
  // This function is used to traverse the left contour of a subtree (or
  // subforest). It returns the successor of v on this contour. This successor is
  // either given by the leftmost child of v or by the thread of v. The function
  // returns null if and only if v is on the highest level of its subtree.


  function nextLeft(v) {
    var children = v.children;
    return children ? children[0] : v.t;
  } // This function works analogously to nextLeft.


  function nextRight(v) {
    var children = v.children;
    return children ? children[children.length - 1] : v.t;
  } // Shifts the current subtree rooted at w+. This is done by increasing
  // prelim(w+) and mod(w+) by shift.


  function moveSubtree(wm, wp, shift) {
    var change = shift / (wp.i - wm.i);
    wp.c -= change;
    wp.s += shift;
    wm.c += change;
    wp.z += shift;
    wp.m += shift;
  } // All other shifts, applied to the smaller subtrees between w- and w+, are
  // performed by this function. To prepare the shifts, we have to adjust
  // change(w+), shift(w+), and change(w-).


  function executeShifts(v) {
    var shift = 0,
        change = 0,
        children = v.children,
        i = children.length,
        w;

    while (--i >= 0) {
      w = children[i];
      w.z += shift;
      w.m += shift;
      shift += w.s + (change += w.c);
    }
  } // If vi-s ancestor is a sibling of v, returns vi-s ancestor. Otherwise,
  // returns the specified (default) ancestor.


  function nextAncestor(vim, v, ancestor) {
    return vim.a.parent === v.parent ? vim.a : ancestor;
  }

  function TreeNode(node, i) {
    this._ = node;
    this.parent = null;
    this.children = null;
    this.A = null; // default ancestor

    this.a = this; // ancestor

    this.z = 0; // prelim

    this.m = 0; // mod

    this.c = 0; // change

    this.s = 0; // shift

    this.t = null; // thread

    this.i = i; // number
  }

  TreeNode.prototype = Object.create(Node$2.prototype);

  function treeRoot(root) {
    var tree = new TreeNode(root, 0),
        node,
        nodes = [tree],
        child,
        children,
        i,
        n;

    while (node = nodes.pop()) {
      if (children = node._.children) {
        node.children = new Array(n = children.length);

        for (i = n - 1; i >= 0; --i) {
          nodes.push(child = node.children[i] = new TreeNode(children[i], i));
          child.parent = node;
        }
      }
    }

    (tree.parent = new TreeNode(null, 0)).children = [tree];
    return tree;
  } // Node-link tree diagram using the Reingold-Tilford "tidy" algorithm


  function tree () {
    var separation = defaultSeparation,
        dx = 1,
        dy = 1,
        nodeSize = null;

    function tree(root) {
      var t = treeRoot(root); // Compute the layout using Buchheim et al.s algorithm.

      t.eachAfter(firstWalk), t.parent.m = -t.z;
      t.eachBefore(secondWalk); // If a fixed node size is specified, scale x and y.

      if (nodeSize) root.eachBefore(sizeNode); // If a fixed tree size is specified, scale x and y based on the extent.
      // Compute the left-most, right-most, and depth-most nodes for extents.
      else {
          var left = root,
              right = root,
              bottom = root;
          root.eachBefore(function (node) {
            if (node.x < left.x) left = node;
            if (node.x > right.x) right = node;
            if (node.depth > bottom.depth) bottom = node;
          });
          var s = left === right ? 1 : separation(left, right) / 2,
              tx = s - left.x,
              kx = dx / (right.x + s + tx),
              ky = dy / (bottom.depth || 1);
          root.eachBefore(function (node) {
            node.x = (node.x + tx) * kx;
            node.y = node.depth * ky;
          });
        }
      return root;
    } // Computes a preliminary x-coordinate for v. Before that, FIRST WALK is
    // applied recursively to the children of v, as well as the function
    // APPORTION. After spacing out the children by calling EXECUTE SHIFTS, the
    // node v is placed to the midpoint of its outermost children.


    function firstWalk(v) {
      var children = v.children,
          siblings = v.parent.children,
          w = v.i ? siblings[v.i - 1] : null;

      if (children) {
        executeShifts(v);
        var midpoint = (children[0].z + children[children.length - 1].z) / 2;

        if (w) {
          v.z = w.z + separation(v._, w._);
          v.m = v.z - midpoint;
        } else {
          v.z = midpoint;
        }
      } else if (w) {
        v.z = w.z + separation(v._, w._);
      }

      v.parent.A = apportion(v, w, v.parent.A || siblings[0]);
    } // Computes all real x-coordinates by summing up the modifiers recursively.


    function secondWalk(v) {
      v._.x = v.z + v.parent.m;
      v.m += v.parent.m;
    } // The core of the algorithm. Here, a new subtree is combined with the
    // previous subtrees. Threads are used to traverse the inside and outside
    // contours of the left and right subtree up to the highest common level. The
    // vertices used for the traversals are vi+, vi-, vo-, and vo+, where the
    // superscript o means outside and i means inside, the subscript - means left
    // subtree and + means right subtree. For summing up the modifiers along the
    // contour, we use respective variables si+, si-, so-, and so+. Whenever two
    // nodes of the inside contours conflict, we compute the left one of the
    // greatest uncommon ancestors using the function ANCESTOR and call MOVE
    // SUBTREE to shift the subtree and prepare the shifts of smaller subtrees.
    // Finally, we add a new thread (if necessary).


    function apportion(v, w, ancestor) {
      if (w) {
        var vip = v,
            vop = v,
            vim = w,
            vom = vip.parent.children[0],
            sip = vip.m,
            sop = vop.m,
            sim = vim.m,
            som = vom.m,
            shift;

        while (vim = nextRight(vim), vip = nextLeft(vip), vim && vip) {
          vom = nextLeft(vom);
          vop = nextRight(vop);
          vop.a = v;
          shift = vim.z + sim - vip.z - sip + separation(vim._, vip._);

          if (shift > 0) {
            moveSubtree(nextAncestor(vim, v, ancestor), v, shift);
            sip += shift;
            sop += shift;
          }

          sim += vim.m;
          sip += vip.m;
          som += vom.m;
          sop += vop.m;
        }

        if (vim && !nextRight(vop)) {
          vop.t = vim;
          vop.m += sim - sop;
        }

        if (vip && !nextLeft(vom)) {
          vom.t = vip;
          vom.m += sip - som;
          ancestor = v;
        }
      }

      return ancestor;
    }

    function sizeNode(node) {
      node.x *= dx;
      node.y = node.depth * dy;
    }

    tree.separation = function (x) {
      return arguments.length ? (separation = x, tree) : separation;
    };

    tree.size = function (x) {
      return arguments.length ? (nodeSize = false, dx = +x[0], dy = +x[1], tree) : nodeSize ? null : [dx, dy];
    };

    tree.nodeSize = function (x) {
      return arguments.length ? (nodeSize = true, dx = +x[0], dy = +x[1], tree) : nodeSize ? [dx, dy] : null;
    };

    return tree;
  }

  function treemapSlice (parent, x0, y0, x1, y1) {
    var nodes = parent.children,
        node,
        i = -1,
        n = nodes.length,
        k = parent.value && (y1 - y0) / parent.value;

    while (++i < n) {
      node = nodes[i], node.x0 = x0, node.x1 = x1;
      node.y0 = y0, node.y1 = y0 += node.value * k;
    }
  }

  var phi = (1 + Math.sqrt(5)) / 2;
  function squarifyRatio(ratio, parent, x0, y0, x1, y1) {
    var rows = [],
        nodes = parent.children,
        row,
        nodeValue,
        i0 = 0,
        i1 = 0,
        n = nodes.length,
        dx,
        dy,
        value = parent.value,
        sumValue,
        minValue,
        maxValue,
        newRatio,
        minRatio,
        alpha,
        beta;

    while (i0 < n) {
      dx = x1 - x0, dy = y1 - y0; // Find the next non-empty node.

      do {
        sumValue = nodes[i1++].value;
      } while (!sumValue && i1 < n);

      minValue = maxValue = sumValue;
      alpha = Math.max(dy / dx, dx / dy) / (value * ratio);
      beta = sumValue * sumValue * alpha;
      minRatio = Math.max(maxValue / beta, beta / minValue); // Keep adding nodes while the aspect ratio maintains or improves.

      for (; i1 < n; ++i1) {
        sumValue += nodeValue = nodes[i1].value;
        if (nodeValue < minValue) minValue = nodeValue;
        if (nodeValue > maxValue) maxValue = nodeValue;
        beta = sumValue * sumValue * alpha;
        newRatio = Math.max(maxValue / beta, beta / minValue);

        if (newRatio > minRatio) {
          sumValue -= nodeValue;
          break;
        }

        minRatio = newRatio;
      } // Position and record the row orientation.


      rows.push(row = {
        value: sumValue,
        dice: dx < dy,
        children: nodes.slice(i0, i1)
      });
      if (row.dice) treemapDice(row, x0, y0, x1, value ? y0 += dy * sumValue / value : y1);else treemapSlice(row, x0, y0, value ? x0 += dx * sumValue / value : x1, y1);
      value -= sumValue, i0 = i1;
    }

    return rows;
  }
  var treemapSquarify = (function custom(ratio) {
    function squarify(parent, x0, y0, x1, y1) {
      squarifyRatio(ratio, parent, x0, y0, x1, y1);
    }

    squarify.ratio = function (x) {
      return custom((x = +x) > 1 ? x : 1);
    };

    return squarify;
  })(phi);

  function treemap () {
    var tile = treemapSquarify,
        round = false,
        dx = 1,
        dy = 1,
        paddingStack = [0],
        paddingInner = constantZero,
        paddingTop = constantZero,
        paddingRight = constantZero,
        paddingBottom = constantZero,
        paddingLeft = constantZero;

    function treemap(root) {
      root.x0 = root.y0 = 0;
      root.x1 = dx;
      root.y1 = dy;
      root.eachBefore(positionNode);
      paddingStack = [0];
      if (round) root.eachBefore(roundNode);
      return root;
    }

    function positionNode(node) {
      var p = paddingStack[node.depth],
          x0 = node.x0 + p,
          y0 = node.y0 + p,
          x1 = node.x1 - p,
          y1 = node.y1 - p;
      if (x1 < x0) x0 = x1 = (x0 + x1) / 2;
      if (y1 < y0) y0 = y1 = (y0 + y1) / 2;
      node.x0 = x0;
      node.y0 = y0;
      node.x1 = x1;
      node.y1 = y1;

      if (node.children) {
        p = paddingStack[node.depth + 1] = paddingInner(node) / 2;
        x0 += paddingLeft(node) - p;
        y0 += paddingTop(node) - p;
        x1 -= paddingRight(node) - p;
        y1 -= paddingBottom(node) - p;
        if (x1 < x0) x0 = x1 = (x0 + x1) / 2;
        if (y1 < y0) y0 = y1 = (y0 + y1) / 2;
        tile(node, x0, y0, x1, y1);
      }
    }

    treemap.round = function (x) {
      return arguments.length ? (round = !!x, treemap) : round;
    };

    treemap.size = function (x) {
      return arguments.length ? (dx = +x[0], dy = +x[1], treemap) : [dx, dy];
    };

    treemap.tile = function (x) {
      return arguments.length ? (tile = required(x), treemap) : tile;
    };

    treemap.padding = function (x) {
      return arguments.length ? treemap.paddingInner(x).paddingOuter(x) : treemap.paddingInner();
    };

    treemap.paddingInner = function (x) {
      return arguments.length ? (paddingInner = typeof x === "function" ? x : constant$9(+x), treemap) : paddingInner;
    };

    treemap.paddingOuter = function (x) {
      return arguments.length ? treemap.paddingTop(x).paddingRight(x).paddingBottom(x).paddingLeft(x) : treemap.paddingTop();
    };

    treemap.paddingTop = function (x) {
      return arguments.length ? (paddingTop = typeof x === "function" ? x : constant$9(+x), treemap) : paddingTop;
    };

    treemap.paddingRight = function (x) {
      return arguments.length ? (paddingRight = typeof x === "function" ? x : constant$9(+x), treemap) : paddingRight;
    };

    treemap.paddingBottom = function (x) {
      return arguments.length ? (paddingBottom = typeof x === "function" ? x : constant$9(+x), treemap) : paddingBottom;
    };

    treemap.paddingLeft = function (x) {
      return arguments.length ? (paddingLeft = typeof x === "function" ? x : constant$9(+x), treemap) : paddingLeft;
    };

    return treemap;
  }

  function _typeof$u(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$u = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$u = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$u(obj);
  }

  function _toConsumableArray$2(arr) {
    return _arrayWithoutHoles$2(arr) || _iterableToArray$2(arr) || _nonIterableSpread$2();
  }

  function _nonIterableSpread$2() {
    throw new TypeError("Invalid attempt to spread non-iterable instance");
  }

  function _iterableToArray$2(iter) {
    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter);
  }

  function _arrayWithoutHoles$2(arr) {
    if (Array.isArray(arr)) {
      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {
        arr2[i] = arr[i];
      }

      return arr2;
    }
  }

  function _classCallCheck$t(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$o(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$o(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$o(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$o(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$q(self, call) {
    if (call && (_typeof$u(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$q(self);
  }

  function _assertThisInitialized$q(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$9(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$9 = Reflect.get;
    } else {
      _get$9 = function _get(target, property, receiver) {
        var base = _superPropBase$9(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$9(target, property, receiver || target);
  }

  function _superPropBase$9(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$q(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$q(o) {
    _getPrototypeOf$q = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$q(o);
  }

  function _inherits$q(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$q(subClass, superClass);
  }

  function _setPrototypeOf$q(o, p) {
    _setPrototypeOf$q = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$q(o, p);
  }

  var recursionCircles = function recursionCircles(d) {
    var arr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

    if (d.values) {
      d.values.forEach(function (h) {
        arr.push(h);
        recursionCircles(h, arr);
      });
    } else {
      arr.push(d);
    }

    return arr;
  };
  /**
      @class Pack
      @extends Viz
      @desc Uses the [d3 pack layout](https://github.com/d3/d3-hierarchy#pack) to creates Circle Packing chart based on an array of data.
  */


  var Pack =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$q(Pack, _Viz);
    /**
        @memberof Pack
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Pack() {
      var _this;

      _classCallCheck$t(this, Pack);

      _this = _possibleConstructorReturn$q(this, _getPrototypeOf$q(Pack).call(this));
      _this._layoutPadding = 1;

      _this._on.mouseenter = function () {};

      var defaultMouseMoveLegend = _this._on["mousemove.legend"];

      _this._on["mousemove.legend"] = function (d, i) {
        defaultMouseMoveLegend(d, i);

        var ids = _this._ids(d, i);

        var hoverData = recursionCircles(d);

        _this.hover(function (h) {
          var hover = Object.keys(h).filter(function (key) {
            return key !== "value";
          }).every(function (key) {
            return d[key] && d[key].includes(h[key]);
          });
          if (hover) hoverData.push(h);else if (ids.includes(h.key)) hoverData.push.apply(hoverData, _toConsumableArray$2(recursionCircles(h, [h])));
          return hoverData.includes(h);
        });
      };

      var defaultMouseMoveShape = _this._on["mousemove.shape"];

      _this._on["mousemove.shape"] = function (d, i) {
        if (d.__d3plusTooltip__) defaultMouseMoveShape(d, i);

        _this.hover(function (h) {
          return recursionCircles(d, [d]).includes(h);
        });
      };

      _this._pack = pack();
      _this._packOpacity = constant$3(0.25);
      _this._shape = constant$3("Circle");
      _this._shapeConfig = assign(_this._shapeConfig, {
        Circle: {
          label: function label(d) {
            return d.parent && !d.children ? d.id : false;
          },
          labelConfig: {
            fontResize: true
          },
          opacity: function opacity(d) {
            return d.__d3plusOpacity__;
          }
        }
      });

      _this._sort = function (a, b) {
        return b.value - a.value;
      };

      _this._sum = accessor("value");
      return _this;
    }
    /**
        Extends the draw behavior of the abstract Viz class.
        @private
    */


    _createClass$o(Pack, [{
      key: "_draw",
      value: function _draw(callback) {
        var _this2 = this;

        _get$9(_getPrototypeOf$q(Pack.prototype), "_draw", this).call(this, callback);

        var height = this._height - this._margin.top - this._margin.bottom,
            width = this._width - this._margin.left - this._margin.right;
        var diameter = Math.min(height, width);
        var transform = "translate(".concat((width - diameter) / 2, ", ").concat((height - diameter) / 2, ")");
        var nestedData = nest();

        for (var i = 0; i <= this._drawDepth; i++) {
          nestedData.key(this._groupBy[i]);
        }

        nestedData = nestedData.entries(this._filteredData);

        var packData = this._pack.padding(this._layoutPadding).size([diameter, diameter])(hierarchy({
          key: nestedData.key,
          values: nestedData
        }, function (d) {
          return d.values;
        }).sum(this._sum).sort(this._sort)).descendants();

        packData.forEach(function (d, i) {
          d.__d3plus__ = true;
          d.i = i;
          d.id = d.parent ? d.parent.data.key : null;
          d.data.__d3plusOpacity__ = d.height ? _this2._packOpacity(d.data, i) : 1;
          d.data.__d3plusTooltip__ = !d.height ? true : false;
        });

        this._shapes.push(new Circle().data(packData).select(elem("g.d3plus-Pack", {
          parent: this._select,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        }).node()).config(configPrep.bind(this)(this._shapeConfig, "shape", "Circle")).render());

        return this;
      }
      /**
          @memberof Pack
          @desc If *value* is specified, sets the hover method to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
       */

    }, {
      key: "hover",
      value: function hover(_) {
        this._hover = _;

        this._shapes.forEach(function (s) {
          return s.hover(_);
        });

        if (this._legend) this._legendClass.hover(_);
        return this;
      }
      /**
          @memberof Pack
          @desc If *value* is specified, sets the opacity accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current pack opacity accessor.
          @param {Function|Number} [*value*]
      */

    }, {
      key: "layoutPadding",
      value: function layoutPadding(_) {
        return arguments.length ? (this._layoutPadding = _, this) : this._layoutPadding;
      }
      /**
          @memberof Pack
          @desc If *value* is specified, sets the padding accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current pack opacity accessor.
          @param {Function|Number} [*value*]
      */

    }, {
      key: "packOpacity",
      value: function packOpacity(_) {
        return arguments.length ? (this._packOpacity = typeof _ === "function" ? _ : constant$3(_), this) : this._packOpacity;
      }
      /**
          @memberof Pack
          @desc If *comparator* is specified, sets the sort order for the pack using the specified comparator function. If *comparator* is not specified, returns the current group sort order, which defaults to descending order by the associated input data's numeric value attribute.
          @param {Array} [*comparator*]
          @example
      function comparator(a, b) {
      return b.value - a.value;
      }
      */

    }, {
      key: "sort",
      value: function sort(_) {
        return arguments.length ? (this._sort = _, this) : this._sort;
      }
      /**
          @memberof Pack
          @desc If *value* is specified, sets the sum accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current sum accessor.
          @param {Function|Number} [*value*]
          @example
      function sum(d) {
      return d.sum;
      }
      */

    }, {
      key: "sum",
      value: function sum(_) {
        return arguments.length ? (this._sum = typeof _ === "function" ? _ : accessor(_), this) : this._sum;
      }
    }]);

    return Pack;
  }(Viz);

  /**
      @function nest
      @summary Extends the base behavior of d3.nest to allow for multiple depth levels.
      @param {Array} *data* The data array to be nested.
      @param {Array} *keys* An array of key accessors that signify each nest level.
  */

  function nest$1 (data, keys) {
    if (!(keys instanceof Array)) keys = [keys];
    var dataNest = nest();

    for (var i = 0; i < keys.length; i++) {
      dataNest.key(keys[i]);
    }

    var nestedData = dataNest.entries(data);
    return bubble(nestedData);
  }
  /**
      Bubbles up values that do not nest to the furthest key.
      @param {Array} *values* The "values" of a nest object.
      @private
  */

  function bubble(values) {
    return values.map(function (d) {
      if (d.key && d.values) {
        if (d.values[0].key === "undefined") return d.values[0].values[0];else d.values = bubble(d.values);
      }

      return d;
    });
  }

  function _typeof$v(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$v = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$v = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$v(obj);
  }

  function _defineProperty$4(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function _classCallCheck$u(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$p(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$p(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$p(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$p(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$r(self, call) {
    if (call && (_typeof$v(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$r(self);
  }

  function _assertThisInitialized$r(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$a(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$a = Reflect.get;
    } else {
      _get$a = function _get(target, property, receiver) {
        var base = _superPropBase$a(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$a(target, property, receiver || target);
  }

  function _superPropBase$a(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$r(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$r(o) {
    _getPrototypeOf$r = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$r(o);
  }

  function _inherits$r(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$r(subClass, superClass);
  }

  function _setPrototypeOf$r(o, p) {
    _setPrototypeOf$r = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$r(o, p);
  }
  /**
      @class Tree
      @extends Viz
      @desc Uses d3's [tree layout](https://github.com/d3/d3-hierarchy#tree) to create a tidy tree chart based on an array of data.
  */

  var Tree =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$r(Tree, _Viz);
    /**
        @memberof Tree
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Tree() {
      var _this;

      _classCallCheck$u(this, Tree);

      _this = _possibleConstructorReturn$r(this, _getPrototypeOf$r(Tree).call(this));
      _this._orient = "vertical";

      _this._separation = function (a, b) {
        return a.parent === b.parent ? 1 : 2;
      };

      _this._shape = constant$3("Circle");
      _this._shapeConfig = assign(_this._shapeConfig, {
        ariaLabel: function ariaLabel(d, i) {
          return _this._treeData ? "".concat(_this._treeData[i].depth, ". ").concat(_this._drawLabel(d, i), ".") : "";
        },
        labelConfig: {
          fontColor: "#444"
        },
        Path: {
          fill: "none",
          stroke: "#ccc",
          strokeWidth: 1
        },
        r: constant$3(5),
        width: constant$3(10),
        height: constant$3(10)
      });
      _this._tree = tree();
      return _this;
    }
    /**
        Extends the draw behavior of the abstract Viz class.
        @private
    */


    _createClass$p(Tree, [{
      key: "_draw",
      value: function _draw(callback) {
        var _this2 = this;

        _get$a(_getPrototypeOf$r(Tree.prototype), "_draw", this).call(this, callback);

        var height = this._orient === "vertical" ? this._height - this._margin.top - this._margin.bottom : this._width - this._margin.left - this._margin.right,
            left = this._orient === "vertical" ? "left" : "top",
            that = this,
            transform = "translate(".concat(this._margin.left, ", ").concat(this._margin.top, ")"),
            width = this._orient === "horizontal" ? this._height - this._margin.top - this._margin.bottom : this._width - this._margin.left - this._margin.right;

        var treeData = this._treeData = this._tree.separation(this._separation).size([width, height])(hierarchy({
          key: "root",
          values: nest$1(this._filteredData, this._groupBy.slice(0, this._drawDepth + 1))
        }, function (d) {
          return d.key && d.values ? d.values : null;
        }).sort(this._sort)).descendants().filter(function (d) {
          return d.depth <= _this2._groupBy.length && d.parent;
        });
        /**
            Merges the values of a given nest branch.
            @private
        */


        function flattenBranchData(branch) {
          return objectMerge(branch.values.map(function (l) {
            return l.key && l.values ? flattenBranchData(l) : l;
          }), that._aggs);
        }

        treeData.forEach(function (d, i) {
          if (d.data.key && d.data.values) d.data = flattenBranchData(d.data);
          d.__d3plus__ = true;
          d.i = i;
        });
        var r = this._shapeConfig.r;
        if (typeof r !== "function") r = constant$3(r);
        var rBufferRoot = max(treeData, function (d) {
          return d.depth === 1 ? r(d.data, d.i) : 0;
        });
        var rBufferEnd = max(treeData, function (d) {
          return d.children ? 0 : r(d.data, d.i);
        });
        var yExtent = extent(treeData, function (d) {
          return d.y;
        });
        this._labelHeight = min([this._orient === "vertical" ? 50 : 100, (yExtent[1] - rBufferRoot - rBufferEnd) / (this._groupBy.length + 1)]);
        this._labelWidths = nest$1(treeData, function (d) {
          return d.depth;
        }).map(function (d) {
          return d.values.reduce(function (num, v, i) {
            var next = i < d.values.length - 1 ? d.values[i + 1].x : width + _this2._margin[left],
                prev = i ? d.values[i - 1].x : _this2._margin[left];
            return min([num, next - v.x, v.x - prev]);
          }, width);
        });
        var yScale = linear$1().domain(yExtent).range([rBufferRoot + this._labelHeight, height - rBufferEnd - this._labelHeight]);
        treeData.forEach(function (d) {
          var val = yScale(d.y);

          if (_this2._orient === "horizontal") {
            d.y = d.x;
            d.x = val;
          } else d.y = val;
        });
        var elemObject = {
          parent: this._select,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        };

        this._shapes.push(new Path$1().data(treeData.filter(function (d) {
          return d.depth > 1;
        })).select(elem("g.d3plus-Tree-Links", elemObject).node()).config(configPrep.bind(this)(this._shapeConfig, "shape", "Path")).config({
          d: function d(_d) {
            var r = _this2._shapeConfig.r;
            if (typeof r === "function") r = r(_d.data, _d.i);
            var px = _d.parent.x - _d.x + (_this2._orient === "vertical" ? 0 : r),
                py = _d.parent.y - _d.y + (_this2._orient === "vertical" ? r : 0),
                x = _this2._orient === "vertical" ? 0 : -r,
                y = _this2._orient === "vertical" ? -r : 0;
            return _this2._orient === "vertical" ? "M".concat(x, ",").concat(y, "C").concat(x, ",").concat((y + py) / 2, " ").concat(px, ",").concat((y + py) / 2, " ").concat(px, ",").concat(py) : "M".concat(x, ",").concat(y, "C").concat((x + px) / 2, ",").concat(y, " ").concat((x + px) / 2, ",").concat(py, " ").concat(px, ",").concat(py);
          },
          id: function id(d, i) {
            return _this2._ids(d, i).join("-");
          }
        }).render());

        this._shapes.push(new Circle().data(treeData).select(elem("g.d3plus-Tree-Shapes", elemObject).node()).config(configPrep.bind(this)(this._shapeConfig, "shape", "Circle")).config({
          id: function id(d, i) {
            return _this2._ids(d, i).join("-");
          },
          label: function label(d, i) {
            if (_this2._label) return _this2._label(d.data, i);

            var ids = _this2._ids(d, i).slice(0, d.depth);

            return ids[ids.length - 1];
          },
          labelConfig: {
            textAnchor: function textAnchor(d) {
              return _this2._orient === "vertical" ? "middle" : d.data.children && d.data.depth !== _this2._groupBy.length ? "end" : "start";
            },
            verticalAlign: function verticalAlign(d) {
              return _this2._orient === "vertical" ? d.data.depth === 1 ? "bottom" : "top" : "middle";
            }
          },
          hitArea: function hitArea(d, i, s) {
            var h = _this2._labelHeight,
                w = _this2._labelWidths[d.depth - 1];
            return {
              width: _this2._orient === "vertical" ? w : s.r * 2 + w,
              height: _this2._orient === "horizontal" ? h : s.r * 2 + h,
              x: _this2._orient === "vertical" ? -w / 2 : d.children && d.depth !== _this2._groupBy.length ? -(s.r + w) : -s.r,
              y: _this2._orient === "horizontal" ? -h / 2 : d.children && d.depth !== _this2._groupBy.length ? -(s.r + _this2._labelHeight) : -s.r
            };
          },
          labelBounds: function labelBounds(d, i, s) {
            var _ref;

            var h = _this2._labelHeight,
                height = _this2._orient === "vertical" ? "height" : "width",
                w = _this2._labelWidths[d.depth - 1],
                width = _this2._orient === "vertical" ? "width" : "height",
                x = _this2._orient === "vertical" ? "x" : "y",
                y = _this2._orient === "vertical" ? "y" : "x";
            return _ref = {}, _defineProperty$4(_ref, width, w), _defineProperty$4(_ref, height, h), _defineProperty$4(_ref, x, -w / 2), _defineProperty$4(_ref, y, d.children && d.depth !== _this2._groupBy.length ? -(s.r + h) : s.r), _ref;
          }
        }).render());

        return this;
      }
      /**
          @memberof Tree
          @desc If *value* is specified, sets the orientation to the specified value. If *value* is not specified, returns the current orientation.
          @param {String} [*value* = "vertical"] Accepts either "vertical" or "horizontal".
      */

    }, {
      key: "orient",
      value: function orient(_) {
        return arguments.length ? (this._orient = _, this) : this._orient;
      }
      /**
          @memberof Tree
          @desc If *value* is specified, sets the separation accessor to the specified function. If *value* is not specified, returns the current separation accessor.
      From the [d3-hierarchy documentation](https://github.com/d3/d3-hierarchy#tree_separation):
      > The separation accessor is used to separate neighboring nodes. The separation function is passed two nodes a and b, and must return the desired separation. The nodes are typically siblings, though the nodes may be more distantly related if the layout decides to place such nodes adjacent.
          @param {Function} [*value*]
          @example
      function separation(a, b) {
      return a.parent === b.parent ? 1 : 2;
      }
      */

    }, {
      key: "separation",
      value: function separation(_) {
        return arguments.length ? (this._separation = _, this) : this._separation;
      }
    }]);

    return Tree;
  }(Viz);

  function _typeof$w(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$w = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$w = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$w(obj);
  }

  function _classCallCheck$v(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$q(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$q(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$q(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$q(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$s(self, call) {
    if (call && (_typeof$w(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$s(self);
  }

  function _assertThisInitialized$s(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$b(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$b = Reflect.get;
    } else {
      _get$b = function _get(target, property, receiver) {
        var base = _superPropBase$b(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$b(target, property, receiver || target);
  }

  function _superPropBase$b(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$s(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$s(o) {
    _getPrototypeOf$s = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$s(o);
  }

  function _inherits$s(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$s(subClass, superClass);
  }

  function _setPrototypeOf$s(o, p) {
    _setPrototypeOf$s = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$s(o, p);
  }
  /**
      @class Treemap
      @extends Viz
      @desc Uses the [d3 treemap layout](https://github.com/mbostock/d3/wiki/Treemap-Layout) to creates SVG rectangles based on an array of data. See [this example](https://d3plus.org/examples/d3plus-hierarchy/getting-started/) for help getting started using the treemap generator.
  */

  var Treemap =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$s(Treemap, _Viz);
    /**
      @memberof Treemap
      @desc Invoked when creating a new class instance, and sets any default parameters.
      @private
    */


    function Treemap() {
      var _this;

      _classCallCheck$v(this, Treemap);

      _this = _possibleConstructorReturn$s(this, _getPrototypeOf$s(Treemap).call(this));
      _this._layoutPadding = 1;

      _this._legendSort = function (a, b) {
        return _this._sum(b) - _this._sum(a);
      };

      _this._legendTooltip = assign({}, _this._legendTooltip, {
        tbody: []
      });
      _this._shapeConfig = assign({}, _this._shapeConfig, {
        ariaLabel: function ariaLabel(d, i) {
          var rank = _this._rankData ? "".concat(_this._rankData.indexOf(d) + 1, ". ") : "";
          return "".concat(rank).concat(_this._drawLabel(d, i), ", ").concat(_this._sum(d, i), ".");
        },
        labelConfig: {
          fontMax: 20,
          fontMin: 8,
          fontResize: true,
          padding: 5
        }
      });

      _this._sort = function (a, b) {
        var aggA = isAggregated(a);
        var aggB = isAggregated(b);
        return aggA && !aggB ? 1 : !aggA && aggB ? -1 : b.value - a.value;
      };

      _this._sum = accessor("value");
      _this._thresholdKey = _this._sum;
      _this._tile = treemapSquarify;
      _this._tooltipConfig = assign({}, _this._tooltipConfig, {
        tbody: [[function () {
          return _this._translate("Share");
        }, function (d, i, x) {
          return "".concat(formatAbbreviate(x.share * 100, _this._locale), "%");
        }]]
      });
      _this._treemap = treemap().round(true);

      var isAggregated = function isAggregated(leaf) {
        return leaf.children && leaf.children.length === 1 && leaf.children[0].data._isAggregation;
      };

      return _this;
    }
    /**
        @memberof Treemap
        @desc Extends the draw behavior of the abstract Viz class.
        @private
    */


    _createClass$q(Treemap, [{
      key: "_draw",
      value: function _draw(callback) {
        var _this2 = this;

        _get$b(_getPrototypeOf$s(Treemap.prototype), "_draw", this).call(this, callback);

        var nestedData = nest();

        for (var i = 0; i <= this._drawDepth; i++) {
          nestedData.key(this._groupBy[i]);
        }

        nestedData = nestedData.entries(this._filteredData);

        var tmapData = this._treemap.padding(this._layoutPadding).size([this._width - this._margin.left - this._margin.right, this._height - this._margin.top - this._margin.bottom]).tile(this._tile)(hierarchy({
          values: nestedData
        }, function (d) {
          return d.values;
        }).sum(this._sum).sort(this._sort));

        var shapeData = [],
            that = this;
        /**
            @memberof Treemap
            @desc Flattens and merges treemap data.
            @private
        */

        function extractLayout(children) {
          for (var _i = 0; _i < children.length; _i++) {
            var node = children[_i];
            if (node.depth <= that._drawDepth) extractLayout(node.children);else {
              var index = node.data.values.length === 1 ? that._filteredData.indexOf(node.data.values[0]) : undefined;
              node.__d3plus__ = true;
              node.id = node.data.key;
              node.i = index > -1 ? index : undefined;
              node.data = objectMerge(node.data.values);
              node.x = node.x0 + (node.x1 - node.x0) / 2;
              node.y = node.y0 + (node.y1 - node.y0) / 2;
              shapeData.push(node);
            }
          }
        }

        if (tmapData.children) extractLayout(tmapData.children);
        this._rankData = shapeData.sort(this._sort).map(function (d) {
          return d.data;
        });
        var total = tmapData.value;
        shapeData.forEach(function (d) {
          d.share = _this2._sum(d.data, d.i) / total;
        });
        var transform = "translate(".concat(this._margin.left, ", ").concat(this._margin.top, ")");
        var rectConfig = configPrep.bind(this)(this._shapeConfig, "shape", "Rect");
        var fontMin = rectConfig.labelConfig.fontMin;
        var padding = rectConfig.labelConfig.padding;

        this._shapes.push(new Rect().data(shapeData).label(function (d) {
          return [_this2._drawLabel(d.data, d.i), "".concat(formatAbbreviate(d.share * 100, _this2._locale), "%")];
        }).select(elem("g.d3plus-Treemap", {
          parent: this._select,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        }).node()).config({
          height: function height(d) {
            return d.y1 - d.y0;
          },
          labelBounds: function labelBounds(d, i, s) {
            var h = s.height;
            var sh = Math.min(50, (h - padding * 2) * 0.5);
            if (sh < fontMin) sh = 0;
            return [{
              width: s.width,
              height: h - sh,
              x: -s.width / 2,
              y: -h / 2
            }, {
              width: s.width,
              height: sh + padding * 2,
              x: -s.width / 2,
              y: h / 2 - sh - padding * 2
            }];
          },
          labelConfig: {
            textAnchor: function textAnchor(d, i, x) {
              var line,
                  parent = x;

              while (typeof line === "undefined" && parent) {
                if (typeof parent.l !== "undefined") line = parent.l;
                parent = parent.__d3plusParent__;
              }

              return line ? "middle" : "start";
            },
            verticalAlign: function verticalAlign(d, i, x) {
              var line,
                  parent = x;

              while (typeof line === "undefined" && parent) {
                if (typeof parent.l !== "undefined") line = parent.l;
                parent = parent.__d3plusParent__;
              }

              return line ? "bottom" : "top";
            }
          },
          width: function width(d) {
            return d.x1 - d.x0;
          }
        }).config(rectConfig).render());

        return this;
      }
      /**
       * Applies the threshold algorithm for Treemaps.
       * @param {Array} data The data to process.
       */

    }, {
      key: "_thresholdFunction",
      value: function _thresholdFunction(data, tree) {
        var aggs = this._aggs;
        var drawDepth = this._drawDepth;
        var groupBy = this._groupBy;
        var threshold = this._threshold;
        var thresholdKey = this._thresholdKey;

        if (threshold && thresholdKey) {
          var finalDataset = data.slice();
          var totalSum = sum(finalDataset, this._thresholdKey);
          var n = tree.length;

          while (n--) {
            var branch = tree[n];
            thresholdByDepth(finalDataset, totalSum, data, branch, 0);
          }

          return finalDataset;
        }
        /**
         * @memberof Treemap
         * @desc Explores the data tree recursively and merges elements under the indicated threshold.
         * @param {object[]} finalDataset The array of data that will be returned after modifications.
         * @param {number} totalSum The total sum of the values in the initial dataset.
         * @param {object[]} currentDataset The current subset of the dataset to work on.
         * @param {object} branch The branch of the dataset tree to explore.
         * @param {number} depth The depth of the current branch.
         * @private
         */


        function thresholdByDepth(finalDataset, totalSum, currentDataset, branch, depth) {
          if (depth >= drawDepth) return;
          var currentAccesor = groupBy[depth];
          var nextDataset = currentDataset.filter(function (item) {
            return currentAccesor(item) === branch.key;
          });

          if (depth + 1 === drawDepth) {
            var removedItems = [];
            var thresholdPercent = Math.min(1, Math.max(0, threshold(nextDataset)));
            if (!isFinite(thresholdPercent) || isNaN(thresholdPercent)) return;
            var thresholdValue = thresholdPercent * totalSum;
            var _n = nextDataset.length;

            while (_n--) {
              var item = nextDataset[_n];

              if (thresholdKey(item) < thresholdValue) {
                var index = finalDataset.indexOf(item);
                finalDataset.splice(index, 1);
                removedItems.push(item);
              }
            }

            if (removedItems.length > 0) {
              var mergedItem = objectMerge(removedItems, aggs);
              mergedItem._isAggregation = true;
              mergedItem._threshold = thresholdPercent;
              finalDataset.push(mergedItem);
            }
          } else {
            var leaves = branch.values;
            var _n2 = leaves.length;

            while (_n2--) {
              thresholdByDepth(finalDataset, totalSum, nextDataset, leaves[_n2], depth + 1);
            }
          }
        }

        return data;
      }
      /**
          @memberof Treemap
          @desc If *value* is specified, sets the inner and outer padding accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current padding accessor.
          @param {Function|Number} [*value*]
      */

    }, {
      key: "layoutPadding",
      value: function layoutPadding(_) {
        return arguments.length ? (this._layoutPadding = typeof _ === "function" ? _ : constant$3(_), this) : this._layoutPadding;
      }
      /**
          @memberof Treemap
          @desc If *comparator* is specified, sets the sort order for the treemap using the specified comparator function. If *comparator* is not specified, returns the current group sort order, which defaults to descending order by the associated input data's numeric value attribute.
          @param {Array} [*comparator*]
          @example
      function comparator(a, b) {
      return b.value - a.value;
      }
      */

    }, {
      key: "sort",
      value: function sort(_) {
        return arguments.length ? (this._sort = _, this) : this._sort;
      }
      /**
          @memberof Treemap
          @desc If *value* is specified, sets the sum accessor to the specified function or number and returns the current class instance. If *value* is not specified, returns the current sum accessor.
          @param {Function|Number} [*value*]
          @example
      function sum(d) {
      return d.sum;
      }
      */

    }, {
      key: "sum",
      value: function sum(_) {
        if (arguments.length) {
          this._sum = typeof _ === "function" ? _ : accessor(_);
          this._thresholdKey = this._sum;
          return this;
        } else return this._sum;
      }
      /**
          @memberof Treemap
          @desc If *value* is specified, sets the [tiling method](https://github.com/d3/d3-hierarchy#treemap-tiling) to the specified function and returns the current class instance. If *value* is not specified, returns the current [tiling method](https://github.com/d3/d3-hierarchy#treemap-tiling).
          @param {Function} [*value*]
      */

    }, {
      key: "tile",
      value: function tile(_) {
        return arguments.length ? (this._tile = _, this) : this._tile;
      }
    }]);

    return Treemap;
  }(Viz);

  function constant$a (x) {
    return function () {
      return x;
    };
  }

  function jiggle () {
    return (Math.random() - 0.5) * 1e-6;
  }

  function tree_add (d) {
    var x = +this._x.call(null, d),
        y = +this._y.call(null, d);
    return add$1(this.cover(x, y), x, y, d);
  }

  function add$1(tree, x, y, d) {
    if (isNaN(x) || isNaN(y)) return tree; // ignore invalid points

    var parent,
        node = tree._root,
        leaf = {
      data: d
    },
        x0 = tree._x0,
        y0 = tree._y0,
        x1 = tree._x1,
        y1 = tree._y1,
        xm,
        ym,
        xp,
        yp,
        right,
        bottom,
        i,
        j; // If the tree is empty, initialize the root as a leaf.

    if (!node) return tree._root = leaf, tree; // Find the existing leaf for the new point, or add it.

    while (node.length) {
      if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm;else x1 = xm;
      if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym;else y1 = ym;
      if (parent = node, !(node = node[i = bottom << 1 | right])) return parent[i] = leaf, tree;
    } // Is the new point is exactly coincident with the existing point?


    xp = +tree._x.call(null, node.data);
    yp = +tree._y.call(null, node.data);
    if (x === xp && y === yp) return leaf.next = node, parent ? parent[i] = leaf : tree._root = leaf, tree; // Otherwise, split the leaf node until the old and new point are separated.

    do {
      parent = parent ? parent[i] = new Array(4) : tree._root = new Array(4);
      if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm;else x1 = xm;
      if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym;else y1 = ym;
    } while ((i = bottom << 1 | right) === (j = (yp >= ym) << 1 | xp >= xm));

    return parent[j] = node, parent[i] = leaf, tree;
  }

  function addAll(data) {
    var d,
        i,
        n = data.length,
        x,
        y,
        xz = new Array(n),
        yz = new Array(n),
        x0 = Infinity,
        y0 = Infinity,
        x1 = -Infinity,
        y1 = -Infinity; // Compute the points and their extent.

    for (i = 0; i < n; ++i) {
      if (isNaN(x = +this._x.call(null, d = data[i])) || isNaN(y = +this._y.call(null, d))) continue;
      xz[i] = x;
      yz[i] = y;
      if (x < x0) x0 = x;
      if (x > x1) x1 = x;
      if (y < y0) y0 = y;
      if (y > y1) y1 = y;
    } // If there were no (valid) points, abort.


    if (x0 > x1 || y0 > y1) return this; // Expand the tree to cover the new points.

    this.cover(x0, y0).cover(x1, y1); // Add the new points.

    for (i = 0; i < n; ++i) {
      add$1(this, xz[i], yz[i], data[i]);
    }

    return this;
  }

  function tree_cover (x, y) {
    if (isNaN(x = +x) || isNaN(y = +y)) return this; // ignore invalid points

    var x0 = this._x0,
        y0 = this._y0,
        x1 = this._x1,
        y1 = this._y1; // If the quadtree has no extent, initialize them.
    // Integer extent are necessary so that if we later double the extent,
    // the existing quadrant boundaries dont change due to floating point error!

    if (isNaN(x0)) {
      x1 = (x0 = Math.floor(x)) + 1;
      y1 = (y0 = Math.floor(y)) + 1;
    } // Otherwise, double repeatedly to cover.
    else {
        var z = x1 - x0,
            node = this._root,
            parent,
            i;

        while (x0 > x || x >= x1 || y0 > y || y >= y1) {
          i = (y < y0) << 1 | x < x0;
          parent = new Array(4), parent[i] = node, node = parent, z *= 2;

          switch (i) {
            case 0:
              x1 = x0 + z, y1 = y0 + z;
              break;

            case 1:
              x0 = x1 - z, y1 = y0 + z;
              break;

            case 2:
              x1 = x0 + z, y0 = y1 - z;
              break;

            case 3:
              x0 = x1 - z, y0 = y1 - z;
              break;
          }
        }

        if (this._root && this._root.length) this._root = node;
      }

    this._x0 = x0;
    this._y0 = y0;
    this._x1 = x1;
    this._y1 = y1;
    return this;
  }

  function tree_data () {
    var data = [];
    this.visit(function (node) {
      if (!node.length) do {
        data.push(node.data);
      } while (node = node.next);
    });
    return data;
  }

  function tree_extent (_) {
    return arguments.length ? this.cover(+_[0][0], +_[0][1]).cover(+_[1][0], +_[1][1]) : isNaN(this._x0) ? undefined : [[this._x0, this._y0], [this._x1, this._y1]];
  }

  function Quad (node, x0, y0, x1, y1) {
    this.node = node;
    this.x0 = x0;
    this.y0 = y0;
    this.x1 = x1;
    this.y1 = y1;
  }

  function tree_find (x, y, radius) {
    var data,
        x0 = this._x0,
        y0 = this._y0,
        x1,
        y1,
        x2,
        y2,
        x3 = this._x1,
        y3 = this._y1,
        quads = [],
        node = this._root,
        q,
        i;
    if (node) quads.push(new Quad(node, x0, y0, x3, y3));
    if (radius == null) radius = Infinity;else {
      x0 = x - radius, y0 = y - radius;
      x3 = x + radius, y3 = y + radius;
      radius *= radius;
    }

    while (q = quads.pop()) {
      // Stop searching if this quadrant cant contain a closer node.
      if (!(node = q.node) || (x1 = q.x0) > x3 || (y1 = q.y0) > y3 || (x2 = q.x1) < x0 || (y2 = q.y1) < y0) continue; // Bisect the current quadrant.

      if (node.length) {
        var xm = (x1 + x2) / 2,
            ym = (y1 + y2) / 2;
        quads.push(new Quad(node[3], xm, ym, x2, y2), new Quad(node[2], x1, ym, xm, y2), new Quad(node[1], xm, y1, x2, ym), new Quad(node[0], x1, y1, xm, ym)); // Visit the closest quadrant first.

        if (i = (y >= ym) << 1 | x >= xm) {
          q = quads[quads.length - 1];
          quads[quads.length - 1] = quads[quads.length - 1 - i];
          quads[quads.length - 1 - i] = q;
        }
      } // Visit this point. (Visiting coincident points isnt necessary!)
      else {
          var dx = x - +this._x.call(null, node.data),
              dy = y - +this._y.call(null, node.data),
              d2 = dx * dx + dy * dy;

          if (d2 < radius) {
            var d = Math.sqrt(radius = d2);
            x0 = x - d, y0 = y - d;
            x3 = x + d, y3 = y + d;
            data = node.data;
          }
        }
    }

    return data;
  }

  function tree_remove (d) {
    if (isNaN(x = +this._x.call(null, d)) || isNaN(y = +this._y.call(null, d))) return this; // ignore invalid points

    var parent,
        node = this._root,
        retainer,
        previous,
        next,
        x0 = this._x0,
        y0 = this._y0,
        x1 = this._x1,
        y1 = this._y1,
        x,
        y,
        xm,
        ym,
        right,
        bottom,
        i,
        j; // If the tree is empty, initialize the root as a leaf.

    if (!node) return this; // Find the leaf node for the point.
    // While descending, also retain the deepest parent with a non-removed sibling.

    if (node.length) while (true) {
      if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm;else x1 = xm;
      if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym;else y1 = ym;
      if (!(parent = node, node = node[i = bottom << 1 | right])) return this;
      if (!node.length) break;
      if (parent[i + 1 & 3] || parent[i + 2 & 3] || parent[i + 3 & 3]) retainer = parent, j = i;
    } // Find the point to remove.

    while (node.data !== d) {
      if (!(previous = node, node = node.next)) return this;
    }

    if (next = node.next) delete node.next; // If there are multiple coincident points, remove just the point.

    if (previous) return next ? previous.next = next : delete previous.next, this; // If this is the root point, remove it.

    if (!parent) return this._root = next, this; // Remove this leaf.

    next ? parent[i] = next : delete parent[i]; // If the parent now contains exactly one leaf, collapse superfluous parents.

    if ((node = parent[0] || parent[1] || parent[2] || parent[3]) && node === (parent[3] || parent[2] || parent[1] || parent[0]) && !node.length) {
      if (retainer) retainer[j] = node;else this._root = node;
    }

    return this;
  }
  function removeAll(data) {
    for (var i = 0, n = data.length; i < n; ++i) {
      this.remove(data[i]);
    }

    return this;
  }

  function tree_root () {
    return this._root;
  }

  function tree_size () {
    var size = 0;
    this.visit(function (node) {
      if (!node.length) do {
        ++size;
      } while (node = node.next);
    });
    return size;
  }

  function tree_visit (callback) {
    var quads = [],
        q,
        node = this._root,
        child,
        x0,
        y0,
        x1,
        y1;
    if (node) quads.push(new Quad(node, this._x0, this._y0, this._x1, this._y1));

    while (q = quads.pop()) {
      if (!callback(node = q.node, x0 = q.x0, y0 = q.y0, x1 = q.x1, y1 = q.y1) && node.length) {
        var xm = (x0 + x1) / 2,
            ym = (y0 + y1) / 2;
        if (child = node[3]) quads.push(new Quad(child, xm, ym, x1, y1));
        if (child = node[2]) quads.push(new Quad(child, x0, ym, xm, y1));
        if (child = node[1]) quads.push(new Quad(child, xm, y0, x1, ym));
        if (child = node[0]) quads.push(new Quad(child, x0, y0, xm, ym));
      }
    }

    return this;
  }

  function tree_visitAfter (callback) {
    var quads = [],
        next = [],
        q;
    if (this._root) quads.push(new Quad(this._root, this._x0, this._y0, this._x1, this._y1));

    while (q = quads.pop()) {
      var node = q.node;

      if (node.length) {
        var child,
            x0 = q.x0,
            y0 = q.y0,
            x1 = q.x1,
            y1 = q.y1,
            xm = (x0 + x1) / 2,
            ym = (y0 + y1) / 2;
        if (child = node[0]) quads.push(new Quad(child, x0, y0, xm, ym));
        if (child = node[1]) quads.push(new Quad(child, xm, y0, x1, ym));
        if (child = node[2]) quads.push(new Quad(child, x0, ym, xm, y1));
        if (child = node[3]) quads.push(new Quad(child, xm, ym, x1, y1));
      }

      next.push(q);
    }

    while (q = next.pop()) {
      callback(q.node, q.x0, q.y0, q.x1, q.y1);
    }

    return this;
  }

  function defaultX(d) {
    return d[0];
  }
  function tree_x (_) {
    return arguments.length ? (this._x = _, this) : this._x;
  }

  function defaultY(d) {
    return d[1];
  }
  function tree_y (_) {
    return arguments.length ? (this._y = _, this) : this._y;
  }

  function quadtree(nodes, x, y) {
    var tree = new Quadtree(x == null ? defaultX : x, y == null ? defaultY : y, NaN, NaN, NaN, NaN);
    return nodes == null ? tree : tree.addAll(nodes);
  }

  function Quadtree(x, y, x0, y0, x1, y1) {
    this._x = x;
    this._y = y;
    this._x0 = x0;
    this._y0 = y0;
    this._x1 = x1;
    this._y1 = y1;
    this._root = undefined;
  }

  function leaf_copy(leaf) {
    var copy = {
      data: leaf.data
    },
        next = copy;

    while (leaf = leaf.next) {
      next = next.next = {
        data: leaf.data
      };
    }

    return copy;
  }

  var treeProto = quadtree.prototype = Quadtree.prototype;

  treeProto.copy = function () {
    var copy = new Quadtree(this._x, this._y, this._x0, this._y0, this._x1, this._y1),
        node = this._root,
        nodes,
        child;
    if (!node) return copy;
    if (!node.length) return copy._root = leaf_copy(node), copy;
    nodes = [{
      source: node,
      target: copy._root = new Array(4)
    }];

    while (node = nodes.pop()) {
      for (var i = 0; i < 4; ++i) {
        if (child = node.source[i]) {
          if (child.length) nodes.push({
            source: child,
            target: node.target[i] = new Array(4)
          });else node.target[i] = leaf_copy(child);
        }
      }
    }

    return copy;
  };

  treeProto.add = tree_add;
  treeProto.addAll = addAll;
  treeProto.cover = tree_cover;
  treeProto.data = tree_data;
  treeProto.extent = tree_extent;
  treeProto.find = tree_find;
  treeProto.remove = tree_remove;
  treeProto.removeAll = removeAll;
  treeProto.root = tree_root;
  treeProto.size = tree_size;
  treeProto.visit = tree_visit;
  treeProto.visitAfter = tree_visitAfter;
  treeProto.x = tree_x;
  treeProto.y = tree_y;

  function index$1(d) {
    return d.index;
  }

  function find$1(nodeById, nodeId) {
    var node = nodeById.get(nodeId);
    if (!node) throw new Error("missing: " + nodeId);
    return node;
  }

  function forceLink (links) {
    var id = index$1,
        strength = defaultStrength,
        strengths,
        distance = constant$a(30),
        distances,
        nodes,
        count,
        bias,
        iterations = 1;
    if (links == null) links = [];

    function defaultStrength(link) {
      return 1 / Math.min(count[link.source.index], count[link.target.index]);
    }

    function force(alpha) {
      for (var k = 0, n = links.length; k < iterations; ++k) {
        for (var i = 0, link, source, target, x, y, l, b; i < n; ++i) {
          link = links[i], source = link.source, target = link.target;
          x = target.x + target.vx - source.x - source.vx || jiggle();
          y = target.y + target.vy - source.y - source.vy || jiggle();
          l = Math.sqrt(x * x + y * y);
          l = (l - distances[i]) / l * alpha * strengths[i];
          x *= l, y *= l;
          target.vx -= x * (b = bias[i]);
          target.vy -= y * b;
          source.vx += x * (b = 1 - b);
          source.vy += y * b;
        }
      }
    }

    function initialize() {
      if (!nodes) return;
      var i,
          n = nodes.length,
          m = links.length,
          nodeById = map(nodes, id),
          link;

      for (i = 0, count = new Array(n); i < m; ++i) {
        link = links[i], link.index = i;
        if (_typeof(link.source) !== "object") link.source = find$1(nodeById, link.source);
        if (_typeof(link.target) !== "object") link.target = find$1(nodeById, link.target);
        count[link.source.index] = (count[link.source.index] || 0) + 1;
        count[link.target.index] = (count[link.target.index] || 0) + 1;
      }

      for (i = 0, bias = new Array(m); i < m; ++i) {
        link = links[i], bias[i] = count[link.source.index] / (count[link.source.index] + count[link.target.index]);
      }

      strengths = new Array(m), initializeStrength();
      distances = new Array(m), initializeDistance();
    }

    function initializeStrength() {
      if (!nodes) return;

      for (var i = 0, n = links.length; i < n; ++i) {
        strengths[i] = +strength(links[i], i, links);
      }
    }

    function initializeDistance() {
      if (!nodes) return;

      for (var i = 0, n = links.length; i < n; ++i) {
        distances[i] = +distance(links[i], i, links);
      }
    }

    force.initialize = function (_) {
      nodes = _;
      initialize();
    };

    force.links = function (_) {
      return arguments.length ? (links = _, initialize(), force) : links;
    };

    force.id = function (_) {
      return arguments.length ? (id = _, force) : id;
    };

    force.iterations = function (_) {
      return arguments.length ? (iterations = +_, force) : iterations;
    };

    force.strength = function (_) {
      return arguments.length ? (strength = typeof _ === "function" ? _ : constant$a(+_), initializeStrength(), force) : strength;
    };

    force.distance = function (_) {
      return arguments.length ? (distance = typeof _ === "function" ? _ : constant$a(+_), initializeDistance(), force) : distance;
    };

    return force;
  }

  function x$1(d) {
    return d.x;
  }
  function y$1(d) {
    return d.y;
  }
  var initialRadius = 10,
      initialAngle = Math.PI * (3 - Math.sqrt(5));
  function forceSimulation (_nodes) {
    var simulation,
        _alpha = 1,
        _alphaMin = 0.001,
        _alphaDecay = 1 - Math.pow(_alphaMin, 1 / 300),
        _alphaTarget = 0,
        _velocityDecay = 0.6,
        forces = map(),
        stepper = timer(step),
        event = dispatch("tick", "end");

    if (_nodes == null) _nodes = [];

    function step() {
      tick();
      event.call("tick", simulation);

      if (_alpha < _alphaMin) {
        stepper.stop();
        event.call("end", simulation);
      }
    }

    function tick(iterations) {
      var i,
          n = _nodes.length,
          node;
      if (iterations === undefined) iterations = 1;

      for (var k = 0; k < iterations; ++k) {
        _alpha += (_alphaTarget - _alpha) * _alphaDecay;
        forces.each(function (force) {
          force(_alpha);
        });

        for (i = 0; i < n; ++i) {
          node = _nodes[i];
          if (node.fx == null) node.x += node.vx *= _velocityDecay;else node.x = node.fx, node.vx = 0;
          if (node.fy == null) node.y += node.vy *= _velocityDecay;else node.y = node.fy, node.vy = 0;
        }
      }

      return simulation;
    }

    function initializeNodes() {
      for (var i = 0, n = _nodes.length, node; i < n; ++i) {
        node = _nodes[i], node.index = i;
        if (node.fx != null) node.x = node.fx;
        if (node.fy != null) node.y = node.fy;

        if (isNaN(node.x) || isNaN(node.y)) {
          var radius = initialRadius * Math.sqrt(i),
              angle = i * initialAngle;
          node.x = radius * Math.cos(angle);
          node.y = radius * Math.sin(angle);
        }

        if (isNaN(node.vx) || isNaN(node.vy)) {
          node.vx = node.vy = 0;
        }
      }
    }

    function initializeForce(force) {
      if (force.initialize) force.initialize(_nodes);
      return force;
    }

    initializeNodes();
    return simulation = {
      tick: tick,
      restart: function restart() {
        return stepper.restart(step), simulation;
      },
      stop: function stop() {
        return stepper.stop(), simulation;
      },
      nodes: function nodes(_) {
        return arguments.length ? (_nodes = _, initializeNodes(), forces.each(initializeForce), simulation) : _nodes;
      },
      alpha: function alpha(_) {
        return arguments.length ? (_alpha = +_, simulation) : _alpha;
      },
      alphaMin: function alphaMin(_) {
        return arguments.length ? (_alphaMin = +_, simulation) : _alphaMin;
      },
      alphaDecay: function alphaDecay(_) {
        return arguments.length ? (_alphaDecay = +_, simulation) : +_alphaDecay;
      },
      alphaTarget: function alphaTarget(_) {
        return arguments.length ? (_alphaTarget = +_, simulation) : _alphaTarget;
      },
      velocityDecay: function velocityDecay(_) {
        return arguments.length ? (_velocityDecay = 1 - _, simulation) : 1 - _velocityDecay;
      },
      force: function force(name, _) {
        return arguments.length > 1 ? (_ == null ? forces.remove(name) : forces.set(name, initializeForce(_)), simulation) : forces.get(name);
      },
      find: function find(x, y, radius) {
        var i = 0,
            n = _nodes.length,
            dx,
            dy,
            d2,
            node,
            closest;
        if (radius == null) radius = Infinity;else radius *= radius;

        for (i = 0; i < n; ++i) {
          node = _nodes[i];
          dx = x - node.x;
          dy = y - node.y;
          d2 = dx * dx + dy * dy;
          if (d2 < radius) closest = node, radius = d2;
        }

        return closest;
      },
      on: function on(name, _) {
        return arguments.length > 1 ? (event.on(name, _), simulation) : event.on(name);
      }
    };
  }

  function forceManyBody () {
    var nodes,
        node,
        alpha,
        strength = constant$a(-30),
        strengths,
        distanceMin2 = 1,
        distanceMax2 = Infinity,
        theta2 = 0.81;

    function force(_) {
      var i,
          n = nodes.length,
          tree = quadtree(nodes, x$1, y$1).visitAfter(accumulate);

      for (alpha = _, i = 0; i < n; ++i) {
        node = nodes[i], tree.visit(apply);
      }
    }

    function initialize() {
      if (!nodes) return;
      var i,
          n = nodes.length,
          node;
      strengths = new Array(n);

      for (i = 0; i < n; ++i) {
        node = nodes[i], strengths[node.index] = +strength(node, i, nodes);
      }
    }

    function accumulate(quad) {
      var strength = 0,
          q,
          c,
          weight = 0,
          x,
          y,
          i; // For internal nodes, accumulate forces from child quadrants.

      if (quad.length) {
        for (x = y = i = 0; i < 4; ++i) {
          if ((q = quad[i]) && (c = Math.abs(q.value))) {
            strength += q.value, weight += c, x += c * q.x, y += c * q.y;
          }
        }

        quad.x = x / weight;
        quad.y = y / weight;
      } // For leaf nodes, accumulate forces from coincident quadrants.
      else {
          q = quad;
          q.x = q.data.x;
          q.y = q.data.y;

          do {
            strength += strengths[q.data.index];
          } while (q = q.next);
        }

      quad.value = strength;
    }

    function apply(quad, x1, _, x2) {
      if (!quad.value) return true;
      var x = quad.x - node.x,
          y = quad.y - node.y,
          w = x2 - x1,
          l = x * x + y * y; // Apply the Barnes-Hut approximation if possible.
      // Limit forces for very close nodes; randomize direction if coincident.

      if (w * w / theta2 < l) {
        if (l < distanceMax2) {
          if (x === 0) x = jiggle(), l += x * x;
          if (y === 0) y = jiggle(), l += y * y;
          if (l < distanceMin2) l = Math.sqrt(distanceMin2 * l);
          node.vx += x * quad.value * alpha / l;
          node.vy += y * quad.value * alpha / l;
        }

        return true;
      } // Otherwise, process points directly.
      else if (quad.length || l >= distanceMax2) return; // Limit forces for very close nodes; randomize direction if coincident.


      if (quad.data !== node || quad.next) {
        if (x === 0) x = jiggle(), l += x * x;
        if (y === 0) y = jiggle(), l += y * y;
        if (l < distanceMin2) l = Math.sqrt(distanceMin2 * l);
      }

      do {
        if (quad.data !== node) {
          w = strengths[quad.data.index] * alpha / l;
          node.vx += x * w;
          node.vy += y * w;
        }
      } while (quad = quad.next);
    }

    force.initialize = function (_) {
      nodes = _;
      initialize();
    };

    force.strength = function (_) {
      return arguments.length ? (strength = typeof _ === "function" ? _ : constant$a(+_), initialize(), force) : strength;
    };

    force.distanceMin = function (_) {
      return arguments.length ? (distanceMin2 = _ * _, force) : Math.sqrt(distanceMin2);
    };

    force.distanceMax = function (_) {
      return arguments.length ? (distanceMax2 = _ * _, force) : Math.sqrt(distanceMax2);
    };

    force.theta = function (_) {
      return arguments.length ? (theta2 = _ * _, force) : Math.sqrt(theta2);
    };

    return force;
  }

  function _typeof$x(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$x = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$x = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$x(obj);
  }

  function _classCallCheck$w(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$r(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$r(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$r(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$r(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$t(self, call) {
    if (call && (_typeof$x(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$t(self);
  }

  function _assertThisInitialized$t(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$c(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$c = Reflect.get;
    } else {
      _get$c = function _get(target, property, receiver) {
        var base = _superPropBase$c(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$c(target, property, receiver || target);
  }

  function _superPropBase$c(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$t(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$t(o) {
    _getPrototypeOf$t = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$t(o);
  }

  function _inherits$t(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$t(subClass, superClass);
  }

  function _setPrototypeOf$t(o, p) {
    _setPrototypeOf$t = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$t(o, p);
  }
  /**
      @class Network
      @extends external:Viz
      @desc Creates a network visualization based on a defined set of nodes and edges. [Click here](http://d3plus.org/examples/d3plus-network/getting-started/) for help getting started using the Network class.
  */

  var Network =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$t(Network, _Viz);
    /**
        @memberof Network
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Network() {
      var _this;

      _classCallCheck$w(this, Network);

      _this = _possibleConstructorReturn$t(this, _getPrototypeOf$t(Network).call(this));
      _this._links = [];
      _this._linkSize = constant$3(1);
      _this._linkSizeMin = 1;
      _this._linkSizeScale = "sqrt";
      _this._noDataMessage = false;
      _this._nodes = [];

      _this._on["click.shape"] = function (d, i) {
        _this._tooltipClass.data([]).render();

        if (_this._hover && _this._drawDepth >= _this._groupBy.length - 1) {
          var id = "".concat(_this._nodeGroupBy && _this._nodeGroupBy[_this._drawDepth](d, i) ? _this._nodeGroupBy[_this._drawDepth](d, i) : _this._id(d, i));

          if (_this._focus && _this._focus === id) {
            _this.active(false);

            _this._on.mouseenter.bind(_assertThisInitialized$t(_this))(d, i);

            _this._focus = undefined;

            _this._zoomToBounds(null);
          } else {
            _this.hover(false);

            var links = _this._linkLookup[id],
                node = _this._nodeLookup[id];
            var filterIds = [id];
            var xDomain = [node.x - node.r, node.x + node.r],
                yDomain = [node.y - node.r, node.y + node.r];
            links.forEach(function (l) {
              filterIds.push(l.id);
              if (l.x - l.r < xDomain[0]) xDomain[0] = l.x - l.r;
              if (l.x + l.r > xDomain[1]) xDomain[1] = l.x + l.r;
              if (l.y - l.r < yDomain[0]) yDomain[0] = l.y - l.r;
              if (l.y + l.r > yDomain[1]) yDomain[1] = l.y + l.r;
            });

            _this.active(function (h, x) {
              if (h.source && h.target) return h.source.id === id || h.target.id === id;else return filterIds.includes("".concat(_this._ids(h, x)[_this._drawDepth]));
            });

            _this._focus = id;
            var t = transform$2(_this._container.node());
            xDomain = xDomain.map(function (d) {
              return d * t.k + t.x;
            });
            yDomain = yDomain.map(function (d) {
              return d * t.k + t.y;
            });

            _this._zoomToBounds([[xDomain[0], yDomain[0]], [xDomain[1], yDomain[1]]]);
          }
        }
      };

      _this._on["click.legend"] = function (d, i) {
        var ids = _this._id(d);

        var id = _this._ids(d);

        id = id[id.length - 1];

        if (_this._hover && _this._drawDepth >= _this._groupBy.length - 1) {
          if (_this._focus && _this._focus === ids) {
            _this.active(false);

            _this._focus = undefined;

            _this._zoomToBounds(null);
          } else {
            _this.hover(false);

            var nodes = ids.map(function (id) {
              return _this._nodeLookup[id];
            });
            var filterIds = ["".concat(id)];
            var xDomain = [nodes[0].x - nodes[0].r, nodes[0].x + nodes[0].r],
                yDomain = [nodes[0].y - nodes[0].r, nodes[0].y + nodes[0].r];
            nodes.forEach(function (l) {
              filterIds.push(l.id);
              if (l.x - l.r < xDomain[0]) xDomain[0] = l.x - l.r;
              if (l.x + l.r > xDomain[1]) xDomain[1] = l.x + l.r;
              if (l.y - l.r < yDomain[0]) yDomain[0] = l.y - l.r;
              if (l.y + l.r > yDomain[1]) yDomain[1] = l.y + l.r;
            });

            _this.active(function (h, x) {
              if (h.source && h.target) return filterIds.includes(h.source.id) && filterIds.includes(h.target.id);else {
                var myIds = _this._ids(h, x);

                return filterIds.includes("".concat(myIds[myIds.length - 1]));
              }
            });

            _this._focus = ids;
            var t = transform$2(_this._container.node());
            xDomain = xDomain.map(function (d) {
              return d * t.k + t.x;
            });
            yDomain = yDomain.map(function (d) {
              return d * t.k + t.y;
            });

            _this._zoomToBounds([[xDomain[0], yDomain[0]], [xDomain[1], yDomain[1]]]);
          }

          _this._on.mouseenter.bind(_assertThisInitialized$t(_this))(d, i);

          _this._on["mousemove.legend"].bind(_assertThisInitialized$t(_this))(d, i);
        }
      };

      _this._on.mouseenter = function () {};

      _this._on["mouseleave.shape"] = function () {
        _this.hover(false);
      };

      var defaultMouseMove = _this._on["mousemove.shape"];

      _this._on["mousemove.shape"] = function (d, i) {
        defaultMouseMove(d, i);
        var id = "".concat(_this._nodeGroupBy && _this._nodeGroupBy[_this._drawDepth](d, i) ? _this._nodeGroupBy[_this._drawDepth](d, i) : _this._id(d, i)),
            links = _this._linkLookup[id],
            node = _this._nodeLookup[id];
        var filterIds = [id];
        var xDomain = [node.x - node.r, node.x + node.r],
            yDomain = [node.y - node.r, node.y + node.r];
        links.forEach(function (l) {
          filterIds.push(l.id);
          if (l.x - l.r < xDomain[0]) xDomain[0] = l.x - l.r;
          if (l.x + l.r > xDomain[1]) xDomain[1] = l.x + l.r;
          if (l.y - l.r < yDomain[0]) yDomain[0] = l.y - l.r;
          if (l.y + l.r > yDomain[1]) yDomain[1] = l.y + l.r;
        });

        _this.hover(function (h, x) {
          if (h.source && h.target) return h.source.id === id || h.target.id === id;else return filterIds.includes("".concat(_this._ids(h, x)[_this._drawDepth]));
        });
      };

      _this._sizeMin = 5;
      _this._sizeScale = "sqrt";
      _this._shape = constant$3("Circle");
      _this._shapeConfig = assign(_this._shapeConfig, {
        ariaLabel: function ariaLabel(d, i) {
          var validSize = _this._size ? ", ".concat(_this._size(d, i)) : "";
          return "".concat(_this._drawLabel(d, i)).concat(validSize, ".");
        },
        labelConfig: {
          duration: 0,
          fontMin: 1,
          fontResize: true,
          labelPadding: 0,
          textAnchor: "middle",
          verticalAlign: "middle"
        },
        Path: {
          fill: "none",
          label: false,
          stroke: "#eee"
        }
      });
      _this._x = accessor("x");
      _this._y = accessor("y");
      _this._zoom = true;
      return _this;
    }
    /**
        Extends the draw behavior of the abstract Viz class.
        @private
    */


    _createClass$r(Network, [{
      key: "_draw",
      value: function _draw(callback) {
        var _this2 = this;

        _get$c(_getPrototypeOf$t(Network.prototype), "_draw", this).call(this, callback);

        var height = this._height - this._margin.top - this._margin.bottom,
            transform = "translate(".concat(this._margin.left, ", ").concat(this._margin.top, ")"),
            transition = this._transition,
            width = this._width - this._margin.left - this._margin.right;

        var data = this._filteredData.reduce(function (obj, d, i) {
          obj[_this2._id(d, i)] = d;
          return obj;
        }, {});

        var nodes = this._nodes.reduce(function (obj, d, i) {
          obj[_this2._nodeGroupBy ? _this2._nodeGroupBy[_this2._drawDepth](d, i) : d.id] = d;
          return obj;
        }, {});

        nodes = Array.from(new Set(Object.keys(data).concat(Object.keys(nodes)))).map(function (id, i) {
          var d = data[id],
              n = nodes[id];
          if (n === undefined) return false;
          return {
            __d3plus__: true,
            data: d || n,
            i: i,
            id: id,
            fx: d !== undefined && _this2._x(d) !== undefined ? _this2._x(d) : _this2._x(n),
            fy: d !== undefined && _this2._y(d) !== undefined ? _this2._y(d) : _this2._y(n),
            node: n,
            r: _this2._size ? d !== undefined && _this2._size(d) !== undefined ? _this2._size(d) : _this2._size(n) : _this2._sizeMin,
            shape: d !== undefined && _this2._shape(d) !== undefined ? _this2._shape(d) : _this2._shape(n)
          };
        }).filter(function (n) {
          return n;
        });
        var nodeLookup = this._nodeLookup = nodes.reduce(function (obj, d) {
          obj[d.id] = d;
          return obj;
        }, {});
        var nodeIndices = nodes.map(function (n) {
          return n.node;
        });

        var links = this._links.map(function (l) {
          var referenceType = _typeof$x(l.source);

          return {
            size: _this2._linkSize(l),
            source: referenceType === "number" ? nodes[nodeIndices.indexOf(_this2._nodes[l.source])] : referenceType === "string" ? nodeLookup[l.source] : nodeLookup[l.source.id],
            target: referenceType === "number" ? nodes[nodeIndices.indexOf(_this2._nodes[l.target])] : referenceType === "string" ? nodeLookup[l.target] : nodeLookup[l.target.id]
          };
        });

        this._linkLookup = links.reduce(function (obj, d) {
          if (!obj[d.source.id]) obj[d.source.id] = [];
          obj[d.source.id].push(d.target);
          if (!obj[d.target.id]) obj[d.target.id] = [];
          obj[d.target.id].push(d.source);
          return obj;
        }, {});
        var missingCoords = nodes.some(function (n) {
          return n.fx === undefined || n.fy === undefined;
        });

        if (missingCoords) {
          var linkStrength = linear$1().domain(extent(links, function (d) {
            return d.size;
          })).range([0.1, 0.5]);
          var simulation = forceSimulation().force("link", forceLink(links).id(function (d) {
            return d.id;
          }).distance(1).strength(function (d) {
            return linkStrength(d.size);
          }).iterations(4)).force("charge", forceManyBody().strength(-1)).stop();
          var iterations = 300;
          var alphaMin = 0.001;
          var alphaDecay = 1 - Math.pow(alphaMin, 1 / iterations);
          simulation.velocityDecay(0);
          simulation.alphaMin(alphaMin);
          simulation.alphaDecay(alphaDecay);
          simulation.alphaDecay(0);
          simulation.nodes(nodes);
          simulation.tick(iterations).stop();
          var hull = polygonHull(nodes.map(function (n) {
            return [n.vx, n.vy];
          }));

          var _shapes$largestRect = largestRect(hull),
              angle = _shapes$largestRect.angle,
              cx = _shapes$largestRect.cx,
              cy = _shapes$largestRect.cy;

          nodes.forEach(function (n) {
            var p = pointRotate([n.vx, n.vy], -1 * (Math.PI / 180 * angle), [cx, cy]);
            n.fx = p[0];
            n.fy = p[1];
          });
        }

        var xExtent = extent(nodes.map(function (n) {
          return n.fx;
        })),
            yExtent = extent(nodes.map(function (n) {
          return n.fy;
        }));
        var x = linear$1().domain(xExtent).range([0, width]),
            y = linear$1().domain(yExtent).range([0, height]);
        var nodeRatio = (xExtent[1] - xExtent[0]) / (yExtent[1] - yExtent[0]),
            screenRatio = width / height;

        if (nodeRatio > screenRatio) {
          var h = height * screenRatio / nodeRatio;
          y.range([(height - h) / 2, height - (height - h) / 2]);
        } else {
          var w = width * nodeRatio / screenRatio;
          x.range([(width - w) / 2, width - (width - w) / 2]);
        }

        nodes.forEach(function (n) {
          n.x = x(n.fx);
          n.y = y(n.fy);
        });
        var rExtent = extent(nodes.map(function (n) {
          return n.r;
        }));
        var rMax = this._sizeMax || max([1, min(merge(nodes.map(function (n1) {
          return nodes.map(function (n2) {
            return n1 === n2 ? null : pointDistance([n1.x, n1.y], [n2.x, n2.y]);
          });
        }))) / 2]);
        var r = scales["scale".concat(this._sizeScale.charAt(0).toUpperCase()).concat(this._sizeScale.slice(1))]().domain(rExtent).range([rExtent[0] === rExtent[1] ? rMax : min([rMax / 2, this._sizeMin]), rMax]),
            xDomain = x.domain(),
            yDomain = y.domain();
        var xOldSize = xDomain[1] - xDomain[0],
            yOldSize = yDomain[1] - yDomain[0];
        nodes.forEach(function (n) {
          var size = r(n.r);
          if (xDomain[0] > x.invert(n.x - size)) xDomain[0] = x.invert(n.x - size);
          if (xDomain[1] < x.invert(n.x + size)) xDomain[1] = x.invert(n.x + size);
          if (yDomain[0] > y.invert(n.y - size)) yDomain[0] = y.invert(n.y - size);
          if (yDomain[1] < y.invert(n.y + size)) yDomain[1] = y.invert(n.y + size);
        });
        var xNewSize = xDomain[1] - xDomain[0],
            yNewSize = yDomain[1] - yDomain[0];
        rMax *= min([xOldSize / xNewSize, yOldSize / yNewSize]);
        r.range([rExtent[0] === rExtent[1] ? rMax : min([rMax / 2, this._sizeMin]), rMax]);
        x.domain(xDomain);
        y.domain(yDomain);
        nodes.forEach(function (n) {
          n.x = x(n.fx);
          n.fx = n.x;
          n.y = y(n.fy);
          n.fy = n.y;
          n.r = r(n.r);
          n.width = n.r * 2;
          n.height = n.r * 2;
        });
        this._container = this._select.selectAll("svg.d3plus-network").data([0]);
        this._container = this._container.enter().append("svg").attr("class", "d3plus-network").attr("opacity", 0).attr("width", width).attr("height", height).attr("x", this._margin.left).attr("y", this._margin.top).style("background-color", "transparent").merge(this._container);

        this._container.transition(this._transition).attr("opacity", 1).attr("width", width).attr("height", height).attr("x", this._margin.left).attr("y", this._margin.top);

        var hitArea = this._container.selectAll("rect.d3plus-network-hitArea").data([0]);

        hitArea.enter().append("rect").attr("class", "d3plus-network-hitArea").merge(hitArea).attr("width", width).attr("height", height).attr("fill", "transparent").on("click", function () {
          if (_this2._focus) {
            _this2.active(false);

            _this2._focus = undefined;

            _this2._zoomToBounds(null);
          }
        });
        this._zoomGroup = this._container.selectAll("g.d3plus-network-zoomGroup").data([0]);

        var parent = this._zoomGroup = this._zoomGroup.enter().append("g").attr("class", "d3plus-network-zoomGroup").merge(this._zoomGroup);

        var strokeExtent = extent(links, function (d) {
          return d.size;
        });

        if (strokeExtent[0] !== strokeExtent[1]) {
          var strokeScale = scales["scale".concat(this._linkSizeScale.charAt(0).toUpperCase()).concat(this._linkSizeScale.slice(1))]().domain(strokeExtent).range([this._linkSizeMin, r.range()[0]]);
          links.forEach(function (link) {
            link.size = strokeScale(link.size);
          });
        }

        var linkConfig = configPrep.bind(this)(this._shapeConfig, "edge", "Path");
        delete linkConfig.on;

        this._shapes.push(new Path$1().config(linkConfig).strokeWidth(function (d) {
          return d.size;
        }).activeStyle({
          "stroke-width": function strokeWidth(d) {
            return d.size;
          }
        }).d(function (d) {
          return "M".concat(d.source.x, ",").concat(d.source.y, " ").concat(d.target.x, ",").concat(d.target.y);
        }).data(links).select(elem("g.d3plus-network-links", {
          parent: parent,
          transition: transition,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        }).node()).render());

        var shapeConfig = {
          label: function label(d) {
            return nodes.length <= _this2._dataCutoff || _this2._hover && _this2._hover(d) || _this2._active && _this2._active(d) ? _this2._drawLabel(d.data || d.node, d.i) : false;
          },
          select: elem("g.d3plus-network-nodes", {
            parent: parent,
            transition: transition,
            enter: {
              transform: transform
            },
            update: {
              transform: transform
            }
          }).node()
        };
        nest().key(function (d) {
          return d.shape;
        }).entries(nodes).forEach(function (d) {
          _this2._shapes.push(new shapes$2[d.key]().config(configPrep.bind(_this2)(_this2._shapeConfig, "shape", d.key)).config(shapeConfig).config(shapeConfig[d.key] || {}).data(d.values).render());
        });
        return this;
      }
      /**
          @memberof Network
          @desc If *value* is specified, sets the hover method to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
       */

    }, {
      key: "hover",
      value: function hover(_) {
        this._hover = _;

        if (this._nodes.length < this._dataCutoff) {
          this._shapes.forEach(function (s) {
            return s.hover(_);
          });

          if (this._legend) this._legendClass.hover(_);
        }

        return this;
      }
      /**
          @memberof Network
          @desc A predefined *Array* of edges that connect each object passed to the [node](#Network.node) method. The `source` and `target` keys in each link need to map to the nodes in one of three ways:
      1. The index of the node in the nodes array (as in [this](http://d3plus.org/examples/d3plus-network/getting-started/) example).
      2. The actual node *Object* itself.
      3. A *String* value matching the `id` of the node.
      The value passed should either be an *Array* of data or a *String* representing a filepath or URL to be loaded. An optional formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final links *Array*.
          @param {Array|String} *links* = []
          @param {Function} [*formatter*]
          @chainable
      */

    }, {
      key: "links",
      value: function links(_, f) {
        if (arguments.length) {
          var prev = this._queue.find(function (q) {
            return q[3] === "links";
          });

          var d = [load.bind(this), _, f, "links"];
          if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          return this;
        }

        return this._links;
      }
      /**
          @memberof Network
          @desc Defines the thickness of the links connecting each node. The value provided can be either a pixel Number to be used for all links, or an accessor function that returns a specific data value to be used in an automatically calculated linear scale.
          @param {Function|Name} [*value* = 1]
          @chainable
      */

    }, {
      key: "linkSize",
      value: function linkSize(_) {
        return arguments.length ? (this._linkSize = typeof _ === "function" ? _ : constant$3(_), this) : this._linkSize;
      }
      /**
          @memberof Network
          @desc Defines the minimum pixel stroke width used in link sizing.
          @param {Number} [*value* = 2]
          @chainable
      */

    }, {
      key: "linkSizeMin",
      value: function linkSizeMin(_) {
        return arguments.length ? (this._linkSizeMin = _, this) : this._linkSizeMin;
      }
      /**
          @memberof Network
          @desc Sets the specific type of [continuous d3-scale](https://github.com/d3/d3-scale#continuous-scales) used when calculating the pixel size of links in the network.
          @param {String} [*value* = "sqrt"]
          @chainable
      */

    }, {
      key: "linkSizeScale",
      value: function linkSizeScale(_) {
        return arguments.length ? (this._linkSizeScale = _, this) : this._linkSizeScale;
      }
      /**
          @memberof Network
          @desc If *value* is specified, sets the node group accessor(s) to the specified string, function, or array of values and returns the current class instance. This method overrides the default .groupBy() function from being used with the data passed to .nodes(). If *value* is not specified, returns the current node group accessor.
          @param {String|Function|Array} [*value* = undefined]
          @chainable
      */

    }, {
      key: "nodeGroupBy",
      value: function nodeGroupBy(_) {
        var _this3 = this;

        if (!arguments.length) return this._nodeGroupBy;
        if (!(_ instanceof Array)) _ = [_];
        return this._nodeGroupBy = _.map(function (k) {
          if (typeof k === "function") return k;else {
            if (!_this3._aggs[k]) {
              _this3._aggs[k] = function (a) {
                var v = Array.from(new Set(a));
                return v.length === 1 ? v[0] : v;
              };
            }

            return accessor(k);
          }
        }), this;
      }
      /**
          @memberof Network
          @desc The list of nodes to be used for drawing the network. The value passed should either be an *Array* of data or a *String* representing a filepath or URL to be loaded.
      Additionally, a custom formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final node *Array*.
          @param {Array|String} *nodes* = []
          @param {Function} [*formatter*]
          @chainable
      */

    }, {
      key: "nodes",
      value: function nodes(_, f) {
        if (arguments.length) {
          var prev = this._queue.find(function (q) {
            return q[3] === "nodes";
          });

          var d = [load.bind(this), _, f, "nodes"];
          if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          return this;
        }

        return this._nodes;
      }
      /**
          @memberof Network
          @desc If *value* is specified, sets the size accessor to the specified function or data key and returns the current class instance. If *value* is not specified, returns the current size accessor.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "size",
      value: function size(_) {
        return arguments.length ? (this._size = typeof _ === "function" || !_ ? _ : accessor(_), this) : this._size;
      }
      /**
          @memberof Network
          @desc Defines the maximum pixel radius used in size scaling. By default, the maximum size is determined by half the distance of the two closest nodes.
          @param {Number} [*value*]
          @chainable
      */

    }, {
      key: "sizeMax",
      value: function sizeMax(_) {
        return arguments.length ? (this._sizeMax = _, this) : this._sizeMax;
      }
      /**
          @memberof Network
          @desc Defines the minimum pixel radius used in size scaling.
          @param {Number} [*value* = 5]
          @chainable
      */

    }, {
      key: "sizeMin",
      value: function sizeMin(_) {
        return arguments.length ? (this._sizeMin = _, this) : this._sizeMin;
      }
      /**
          @memberof Network
          @desc Sets the specific type of [continuous d3-scale](https://github.com/d3/d3-scale#continuous-scales) used when calculating the pixel size of nodes in the network.
          @param {String} [*value* = "sqrt"]
          @chainable
      */

    }, {
      key: "sizeScale",
      value: function sizeScale(_) {
        return arguments.length ? (this._sizeScale = _, this) : this._sizeScale;
      }
      /**
          @memberof Network
          @desc If *value* is specified, sets the x accessor to the specified function or string matching a key in the data and returns the current class instance. The data passed to .data() takes priority over the .nodes() data array. If *value* is not specified, returns the current x accessor. By default, the x and y positions are determined dynamically based on default force layout properties.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "x",
      value: function x(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._x = _;else {
            this._x = accessor(_);
            if (!this._aggs[_]) this._aggs[_] = function (a) {
              return mean(a);
            };
          }
          return this;
        } else return this._x;
      }
      /**
          @memberof Network
          @desc If *value* is specified, sets the y accessor to the specified function or string matching a key in the data and returns the current class instance. The data passed to .data() takes priority over the .nodes() data array. If *value* is not specified, returns the current y accessor. By default, the x and y positions are determined dynamically based on default force layout properties.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "y",
      value: function y(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._y = _;else {
            this._y = accessor(_);
            if (!this._aggs[_]) this._aggs[_] = function (a) {
              return mean(a);
            };
          }
          return this;
        } else return this._y;
      }
    }]);

    return Network;
  }(Viz);

  function _typeof$y(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$y = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$y = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$y(obj);
  }

  function _classCallCheck$x(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$s(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$s(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$s(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$s(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$u(self, call) {
    if (call && (_typeof$y(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$u(self);
  }

  function _assertThisInitialized$u(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$d(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$d = Reflect.get;
    } else {
      _get$d = function _get(target, property, receiver) {
        var base = _superPropBase$d(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$d(target, property, receiver || target);
  }

  function _superPropBase$d(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$u(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$u(o) {
    _getPrototypeOf$u = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$u(o);
  }

  function _inherits$u(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$u(subClass, superClass);
  }

  function _setPrototypeOf$u(o, p) {
    _setPrototypeOf$u = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$u(o, p);
  }
  /**
      @class Rings
      @extends external:Viz
      @desc Creates a ring visualization based on a defined set of nodes and edges. [Click here](http://d3plus.org/examples/d3plus-network/simple-rings/) for help getting started using the Rings class.
  */

  var Rings =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$u(Rings, _Viz);
    /**
        @memberof Rings
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Rings() {
      var _this;

      _classCallCheck$x(this, Rings);

      _this = _possibleConstructorReturn$u(this, _getPrototypeOf$u(Rings).call(this));
      _this._links = [];
      _this._linkSize = constant$3(1);
      _this._linkSizeMin = 1;
      _this._linkSizeScale = "sqrt";
      _this._noDataMessage = false;
      _this._nodes = [];

      _this._on.mouseenter = function () {};

      _this._on["mouseleave.shape"] = function () {
        _this.hover(false);
      };

      var defaultMouseMove = _this._on["mousemove.shape"];

      _this._on["mousemove.shape"] = function (d, i) {
        defaultMouseMove(d, i);

        if (_this._focus && _this._focus === d.id) {
          _this.hover(false);

          _this._on.mouseenter.bind(_assertThisInitialized$u(_this))(d, i);

          _this._focus = undefined;
        } else {
          var id = _this._nodeGroupBy && _this._nodeGroupBy[_this._drawDepth](d, i) ? _this._nodeGroupBy[_this._drawDepth](d, i) : _this._id(d, i),
              links = _this._linkLookup[id],
              node = _this._nodeLookup[id];
          var filterIds = [node.id];
          var xDomain = [node.x - node.r, node.x + node.r],
              yDomain = [node.y - node.r, node.y + node.r];
          links.forEach(function (l) {
            filterIds.push(l.id);
            if (l.x - l.r < xDomain[0]) xDomain[0] = l.x - l.r;
            if (l.x + l.r > xDomain[1]) xDomain[1] = l.x + l.r;
            if (l.y - l.r < yDomain[0]) yDomain[0] = l.y - l.r;
            if (l.y + l.r > yDomain[1]) yDomain[1] = l.y + l.r;
          });

          _this.hover(function (h, x) {
            if (h.source && h.target) return h.source.id === node.id || h.target.id === node.id;else return filterIds.includes(_this._ids(h, x)[_this._drawDepth]);
          });
        }
      };

      _this._on["click.shape"] = function (d) {
        _this._center = d.id;

        _this._draw();
      };

      _this._sizeMin = 5;
      _this._sizeScale = "sqrt";
      _this._shape = constant$3("Circle");
      _this._shapeConfig = assign(_this._shapeConfig, {
        ariaLabel: function ariaLabel(d, i) {
          var validSize = _this._size ? ", ".concat(_this._size(d, i)) : "";
          return "".concat(_this._drawLabel(d, i)).concat(validSize, ".");
        },
        labelConfig: {
          duration: 0,
          fontMin: 1,
          fontResize: true,
          labelPadding: 0,
          textAnchor: "middle",
          verticalAlign: "middle"
        },
        Path: {
          fill: "none",
          label: false,
          stroke: "#eee",
          strokeWidth: 1
        }
      });
      return _this;
    }
    /**
        Extends the draw behavior of the abstract Viz class.
        @private
    */


    _createClass$s(Rings, [{
      key: "_draw",
      value: function _draw(callback) {
        var _this2 = this;

        _get$d(_getPrototypeOf$u(Rings.prototype), "_draw", this).call(this, callback);

        var data = this._filteredData.reduce(function (obj, d, i) {
          obj[_this2._id(d, i)] = d;
          return obj;
        }, {});

        var nodes = this._nodes;

        if (!this._nodes.length && this._links.length) {
          var nodeIds = Array.from(new Set(this._links.reduce(function (ids, link) {
            return ids.concat([link.source, link.target]);
          }, [])));
          nodes = nodeIds.map(function (node) {
            return _typeof$y(node) === "object" ? node : {
              id: node
            };
          });
        }

        nodes = nodes.reduce(function (obj, d, i) {
          obj[_this2._nodeGroupBy ? _this2._nodeGroupBy[_this2._drawDepth](d, i) : _this2._id(d, i)] = d;
          return obj;
        }, {});
        nodes = Array.from(new Set(Object.keys(data).concat(Object.keys(nodes)))).map(function (id, i) {
          var d = data[id],
              n = nodes[id];
          if (n === undefined) return false;
          return {
            __d3plus__: true,
            data: d || n,
            i: i,
            id: id,
            node: n,
            shape: d !== undefined && _this2._shape(d) !== undefined ? _this2._shape(d) : _this2._shape(n)
          };
        }).filter(function (n) {
          return n;
        });
        var nodeLookup = this._nodeLookup = nodes.reduce(function (obj, d) {
          obj[d.id] = d;
          return obj;
        }, {});

        var links = this._links.map(function (link) {
          var check = ["source", "target"];
          var edge = check.reduce(function (result, check) {
            result[check] = typeof link[check] === "number" ? nodes[link[check]] : nodeLookup[link[check].id || link[check]];
            return result;
          }, {});
          edge.size = _this2._linkSize(link);
          return edge;
        });

        var linkMap = links.reduce(function (map, link) {
          if (!map[link.source.id]) {
            map[link.source.id] = [];
          }

          map[link.source.id].push(link);

          if (!map[link.target.id]) {
            map[link.target.id] = [];
          }

          map[link.target.id].push(link);
          return map;
        }, {});
        var height = this._height - this._margin.top - this._margin.bottom,
            transform = "translate(".concat(this._margin.left, ", ").concat(this._margin.top, ")"),
            transition = this._transition,
            width = this._width - this._margin.left - this._margin.right;
        var edges = [],
            radius = min([height, width]) / 2,
            ringWidth = radius / 3;
        var primaryRing = ringWidth,
            secondaryRing = ringWidth * 2;
        var center = nodeLookup[this._center];
        center.x = width / 2;
        center.y = height / 2;
        center.r = this._sizeMin ? max([this._sizeMin, primaryRing * .65]) : this._sizeMax ? min([this._sizeMax, primaryRing * .65]) : primaryRing * .65;
        var claimed = [center],
            primaries = [];

        linkMap[this._center].forEach(function (edge) {
          var node = edge.source.id === _this2._center ? edge.target : edge.source;
          node.edges = linkMap[node.id].filter(function (link) {
            return link.source.id !== _this2._center || link.target.id !== _this2._center;
          });
          node.edge = edge;
          claimed.push(node);
          primaries.push(node);
        });

        primaries.sort(function (a, b) {
          return a.edges.length - b.edges.length;
        });
        var secondaries = [];
        var totalEndNodes = 0;
        primaries.forEach(function (p) {
          var primaryId = p.id;
          p.edges = p.edges.filter(function (edge) {
            return !claimed.includes(edge.source) && edge.target.id === primaryId || !claimed.includes(edge.target) && edge.source.id === primaryId;
          });
          totalEndNodes += p.edges.length || 1;
          p.edges.forEach(function (edge) {
            var source = edge.source,
                target = edge.target;
            var claim = target.id === primaryId ? source : target;
            claimed.push(claim);
          });
        });
        var tau = Math.PI * 2;
        var offset = 0;
        primaries.forEach(function (p, i) {
          var children = p.edges.length || 1;
          var space = tau / totalEndNodes * children;

          if (i === 0) {
            offset -= space / 2;
          }

          var angle = offset + space / 2 - tau / 4;
          p.radians = angle;
          p.x = width / 2 + primaryRing * Math.cos(angle);
          p.y = height / 2 + primaryRing * Math.sin(angle);
          offset += space;
          p.edges.forEach(function (edge, i) {
            var node = edge.source.id === p.id ? edge.target : edge.source;
            var s = tau / totalEndNodes;
            var a = angle - s * children / 2 + s / 2 + s * i;
            node.radians = a;
            node.x = width / 2 + secondaryRing * Math.cos(a);
            node.y = height / 2 + secondaryRing * Math.sin(a);
            secondaries.push(node);
          });
        });
        var primaryDistance = ringWidth / 2;
        var secondaryDistance = ringWidth / 4;
        var primaryMax = primaryDistance / 2 - 4;

        if (primaryDistance / 2 - 4 < 8) {
          primaryMax = min([primaryDistance / 2, 8]);
        }

        var secondaryMax = secondaryDistance / 2 - 4;

        if (secondaryDistance / 2 - 4 < 4) {
          secondaryMax = min([secondaryDistance / 2, 4]);
        }

        if (secondaryMax > ringWidth / 10) {
          secondaryMax = ringWidth / 10;
        }

        if (secondaryMax > primaryMax && secondaryMax > 10) {
          secondaryMax = primaryMax * .75;
        }

        if (primaryMax > secondaryMax * 1.5) {
          primaryMax = secondaryMax * 1.5;
        }

        primaryMax = Math.floor(primaryMax);
        secondaryMax = Math.floor(secondaryMax);
        var radiusFn;

        if (this._size) {
          var domain = extent(data, function (d) {
            return d.size;
          });

          if (domain[0] === domain[1]) {
            domain[0] = 0;
          }

          radiusFn = linear$1().domain(domain).rangeRound([3, min([primaryMax, secondaryMax])]);
          var val = center.size;
          center.r = radiusFn(val);
        } else {
          radiusFn = linear$1().domain([1, 2]).rangeRound([primaryMax, secondaryMax]);
        }

        secondaries.forEach(function (s) {
          s.ring = 2;
          var val = _this2._size ? s.size : 2;
          s.r = _this2._sizeMin ? max([_this2._sizeMin, radiusFn(val)]) : _this2._sizeMax ? min([_this2._sizeMax, radiusFn(val)]) : radiusFn(val);
        });
        primaries.forEach(function (p) {
          p.ring = 1;
          var val = _this2._size ? p.size : 1;
          p.r = _this2._sizeMin ? max([_this2._sizeMin, radiusFn(val)]) : _this2._sizeMax ? min([_this2._sizeMax, radiusFn(val)]) : radiusFn(val);
        });
        nodes = [center].concat(primaries).concat(secondaries);
        primaries.forEach(function (p) {
          var check = ["source", "target"];
          var edge = p.edge;
          check.forEach(function (node) {
            edge[node] = nodes.find(function (n) {
              return n.id === edge[node].id;
            });
          });
          edges.push(edge);
          linkMap[p.id].forEach(function (edge) {
            var node = edge.source.id === p.id ? edge.target : edge.source;

            if (node.id !== center.id) {
              var target = secondaries.find(function (s) {
                return s.id === node.id;
              });

              if (!target) {
                target = primaries.find(function (s) {
                  return s.id === node.id;
                });
              }

              if (target) {
                edge.spline = true;
                var centerX = width / 2;
                var centerY = height / 2;
                var middleRing = primaryRing + (secondaryRing - primaryRing) * 0.5;
                var _check = ["source", "target"];

                _check.forEach(function (node, i) {
                  edge["".concat(node, "X")] = edge[node].x + Math.cos(edge[node].ring === 2 ? edge[node].radians + Math.PI : edge[node].radians) * edge[node].r;
                  edge["".concat(node, "Y")] = edge[node].y + Math.sin(edge[node].ring === 2 ? edge[node].radians + Math.PI : edge[node].radians) * edge[node].r;
                  edge["".concat(node, "BisectX")] = centerX + middleRing * Math.cos(edge[node].radians);
                  edge["".concat(node, "BisectY")] = centerY + middleRing * Math.sin(edge[node].radians);
                  edge[node] = nodes.find(function (n) {
                    return n.id === edge[node].id;
                  });
                  if (edge[node].edges === undefined) edge[node].edges = {};
                  var oppId = i === 0 ? edge.target.id : edge.source.id;

                  if (edge[node].id === p.id) {
                    edge[node].edges[oppId] = {
                      angle: p.radians + Math.PI,
                      radius: ringWidth / 2
                    };
                  } else {
                    edge[node].edges[oppId] = {
                      angle: target.radians,
                      radius: ringWidth / 2
                    };
                  }
                });

                edges.push(edge);
              }
            }
          });
        });
        nodes.forEach(function (node) {
          if (node.id !== _this2._center) {
            var fontSize = _this2._shapeConfig.labelConfig.fontSize && _this2._shapeConfig.labelConfig.fontSize(node) || 11;
            var lineHeight = fontSize * 1.4;

            var _height = lineHeight * 2;

            var padding = 5;

            var _width = ringWidth - node.r;

            var angle = node.radians * (180 / Math.PI);
            var x = node.r + padding;
            var textAnchor = "start";

            if (angle < -90 || angle > 90) {
              x = -node.r - _width - padding;
              textAnchor = "end";
              angle += 180;
            }

            node.labelBounds = {
              x: x,
              y: -lineHeight / 2,
              width: _width,
              height: _height
            };
            node.rotate = angle;
            node.textAnchor = textAnchor;
          } else {
            node.labelBounds = {
              x: -primaryRing / 2,
              y: -primaryRing / 2,
              width: primaryRing,
              height: primaryRing
            };
          }
        });
        this._linkLookup = links.reduce(function (obj, d) {
          if (!obj[d.source.id]) obj[d.source.id] = [];
          obj[d.source.id].push(d.target);
          if (!obj[d.target.id]) obj[d.target.id] = [];
          obj[d.target.id].push(d.source);
          return obj;
        }, {});
        var strokeExtent = extent(links, function (d) {
          return d.size;
        });

        if (strokeExtent[0] !== strokeExtent[1]) {
          var _radius = min(nodes, function (d) {
            return d.r;
          });

          var strokeScale = scales["scale".concat(this._linkSizeScale.charAt(0).toUpperCase()).concat(this._linkSizeScale.slice(1))]().domain(strokeExtent).range([this._linkSizeMin, _radius]);
          links.forEach(function (link) {
            link.size = strokeScale(link.size);
          });
        }

        var linkConfig = configPrep.bind(this)(this._shapeConfig, "edge", "Path");
        delete linkConfig.on;

        this._shapes.push(new Path$1().config(linkConfig).strokeWidth(function (d) {
          return d.size;
        }).id(function (d) {
          return "".concat(d.source.id, "_").concat(d.target.id);
        }).d(function (d) {
          return d.spline ? "M".concat(d.sourceX, ",").concat(d.sourceY, "C").concat(d.sourceBisectX, ",").concat(d.sourceBisectY, " ").concat(d.targetBisectX, ",").concat(d.targetBisectY, " ").concat(d.targetX, ",").concat(d.targetY) : "M".concat(d.source.x, ",").concat(d.source.y, " ").concat(d.target.x, ",").concat(d.target.y);
        }).data(edges).select(elem("g.d3plus-rings-links", {
          parent: this._select,
          transition: transition,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        }).node()).render());

        var that = this;
        var shapeConfig = {
          label: function label(d) {
            return nodes.length <= _this2._dataCutoff || _this2._hover && _this2._hover(d) || _this2._active && _this2._active(d) ? _this2._drawLabel(d.data || d.node, d.i) : false;
          },
          labelBounds: function labelBounds(d) {
            return d.labelBounds;
          },
          labelConfig: {
            fontColor: function fontColor(d) {
              return d.id === _this2._center ? configPrep.bind(that)(that._shapeConfig, "shape", d.key).labelConfig.fontColor(d) : colorLegible(configPrep.bind(that)(that._shapeConfig, "shape", d.key).fill(d));
            },
            fontResize: function fontResize(d) {
              return d.id === _this2._center;
            },
            padding: 0,
            textAnchor: function textAnchor(d) {
              return nodeLookup[d.id].textAnchor || configPrep.bind(that)(that._shapeConfig, "shape", d.key).labelConfig.textAnchor;
            },
            verticalAlign: function verticalAlign(d) {
              return d.id === _this2._center ? "middle" : "top";
            }
          },
          rotate: function rotate(d) {
            return nodeLookup[d.id].rotate || 0;
          },
          select: elem("g.d3plus-rings-nodes", {
            parent: this._select,
            transition: transition,
            enter: {
              transform: transform
            },
            update: {
              transform: transform
            }
          }).node()
        };
        nest().key(function (d) {
          return d.shape;
        }).entries(nodes).forEach(function (d) {
          _this2._shapes.push(new shapes$2[d.key]().config(configPrep.bind(_this2)(_this2._shapeConfig, "shape", d.key)).config(shapeConfig).data(d.values).render());
        });
        return this;
      }
      /**
       @memberof Rings
       @desc Sets the center node to be the node with the given id.
       @param {String}
       @chainable
       */

    }, {
      key: "center",
      value: function center(_) {
        return arguments.length ? (this._center = _, this) : this._center;
      }
      /**
          @memberof Rings
          @desc If *value* is specified, sets the hover method to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
       */

    }, {
      key: "hover",
      value: function hover(_) {
        this._hover = _;

        this._shapes.forEach(function (s) {
          return s.hover(_);
        });

        if (this._legend) this._legendClass.hover(_);
        return this;
      }
      /**
          @memberof Rings
          @desc A predefined *Array* of edges that connect each object passed to the [node](#Rings.node) method. The `source` and `target` keys in each link need to map to the nodes in one of three ways:
      1. The index of the node in the nodes array (as in [this](http://d3plus.org/examples/d3plus-network/getting-started/) example).
      2. The actual node *Object* itself.
      3. A *String* value matching the `id` of the node.
      The value passed should either be an *Array* of data or a *String* representing a filepath or URL to be loaded. An optional formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final links *Array*.
          @param {Array|String} *links* = []
          @param {Function} [*formatter*]
          @chainable
      */

    }, {
      key: "links",
      value: function links(_, f) {
        if (arguments.length) {
          var prev = this._queue.find(function (q) {
            return q[3] === "links";
          });

          var d = [load.bind(this), _, f, "links"];
          if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          return this;
        }

        return this._links;
      }
      /**
          @memberof Network
          @desc Defines the thickness of the links connecting each node. The value provided can be either a pixel Number to be used for all links, or an accessor function that returns a specific data value to be used in an automatically calculated linear scale.
          @param {Function|Name} [*value* = 1]
          @chainable
      */

    }, {
      key: "linkSize",
      value: function linkSize(_) {
        return arguments.length ? (this._linkSize = typeof _ === "function" ? _ : constant$3(_), this) : this._linkSize;
      }
      /**
          @memberof Network
          @desc Defines the minimum pixel stroke width used in link sizing.
          @param {Number} [*value* = 2]
          @chainable
      */

    }, {
      key: "linkSizeMin",
      value: function linkSizeMin(_) {
        return arguments.length ? (this._linkSizeMin = _, this) : this._linkSizeMin;
      }
      /**
          @memberof Network
          @desc Sets the specific type of [continuous d3-scale](https://github.com/d3/d3-scale#continuous-scales) used when calculating the pixel size of links in the network.
          @param {String} [*value* = "sqrt"]
          @chainable
      */

    }, {
      key: "linkSizeScale",
      value: function linkSizeScale(_) {
        return arguments.length ? (this._linkSizeScale = _, this) : this._linkSizeScale;
      }
      /**
          @memberof Rings
          @desc If *value* is specified, sets the node group accessor(s) to the specified string, function, or array of values and returns the current class instance. This method overrides the default .groupBy() function from being used with the data passed to .nodes(). If *value* is not specified, returns the current node group accessor.
          @param {String|Function|Array} [*value* = undefined]
          @chainable
      */

    }, {
      key: "nodeGroupBy",
      value: function nodeGroupBy(_) {
        var _this3 = this;

        if (!arguments.length) return this._nodeGroupBy;
        if (!(_ instanceof Array)) _ = [_];
        return this._nodeGroupBy = _.map(function (k) {
          if (typeof k === "function") return k;else {
            if (!_this3._aggs[k]) {
              _this3._aggs[k] = function (a) {
                var v = Array.from(new Set(a));
                return v.length === 1 ? v[0] : v;
              };
            }

            return accessor(k);
          }
        }), this;
      }
      /**
          @memberof Rings
          @desc The list of nodes to be used for drawing the rings network. The value passed should either be an *Array* of data or a *String* representing a filepath or URL to be loaded.
      Additionally, a custom formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final node *Array*.
          @param {Array|String} *nodes* = []
          @param {Function} [*formatter*]
          @chainable
      */

    }, {
      key: "nodes",
      value: function nodes(_, f) {
        if (arguments.length) {
          var prev = this._queue.find(function (q) {
            return q[3] === "nodes";
          });

          var d = [load.bind(this), _, f, "nodes"];
          if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          return this;
        }

        return this._nodes;
      }
      /**
          @memberof Rings
          @desc If *value* is specified, sets the size accessor to the specified function or data key and returns the current class instance. If *value* is not specified, returns the current size accessor.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "size",
      value: function size(_) {
        return arguments.length ? (this._size = typeof _ === "function" || !_ ? _ : accessor(_), this) : this._size;
      }
      /**
          @memberof Rings
          @desc If *value* is specified, sets the size scale maximum to the specified number and returns the current class instance. If *value* is not specified, returns the current size scale maximum. By default, the maximum size is determined by half the distance of the two closest nodes.
          @param {Number} [*value*]
          @chainable
      */

    }, {
      key: "sizeMax",
      value: function sizeMax(_) {
        return arguments.length ? (this._sizeMax = _, this) : this._sizeMax;
      }
      /**
          @memberof Rings
          @desc If *value* is specified, sets the size scale minimum to the specified number and returns the current class instance. If *value* is not specified, returns the current size scale minimum.
          @param {Number} [*value* = 5]
          @chainable
      */

    }, {
      key: "sizeMin",
      value: function sizeMin(_) {
        return arguments.length ? (this._sizeMin = _, this) : this._sizeMin;
      }
      /**
          @memberof Rings
          @desc If *value* is specified, sets the size scale to the specified string and returns the current class instance. If *value* is not specified, returns the current size scale.
          @param {String} [*value* = "sqrt"]
          @chainable
      */

    }, {
      key: "sizeScale",
      value: function sizeScale(_) {
        return arguments.length ? (this._sizeScale = _, this) : this._sizeScale;
      }
    }]);

    return Rings;
  }(Viz);

  function targetDepth(d) {
    return d.target.depth;
  }

  function left(node) {
    return node.depth;
  }
  function right(node, n) {
    return n - 1 - node.height;
  }
  function justify(node, n) {
    return node.sourceLinks.length ? node.depth : n - 1;
  }
  function center(node) {
    return node.targetLinks.length ? node.depth : node.sourceLinks.length ? min(node.sourceLinks, targetDepth) - 1 : 0;
  }

  function constant$b(x) {
    return function () {
      return x;
    };
  }

  function ascendingSourceBreadth(a, b) {
    return ascendingBreadth(a.source, b.source) || a.index - b.index;
  }

  function ascendingTargetBreadth(a, b) {
    return ascendingBreadth(a.target, b.target) || a.index - b.index;
  }

  function ascendingBreadth(a, b) {
    return a.y0 - b.y0;
  }

  function value(d) {
    return d.value;
  }

  function nodeCenter(node) {
    return (node.y0 + node.y1) / 2;
  }

  function weightedSource(link) {
    return nodeCenter(link.source) * link.value;
  }

  function weightedTarget(link) {
    return nodeCenter(link.target) * link.value;
  }

  function defaultId(d) {
    return d.index;
  }

  function defaultNodes(graph) {
    return graph.nodes;
  }

  function defaultLinks(graph) {
    return graph.links;
  }

  function find$2(nodeById, id) {
    var node = nodeById.get(id);
    if (!node) throw new Error("missing: " + id);
    return node;
  }

  function sankey () {
    var x0 = 0,
        y0 = 0,
        x1 = 1,
        y1 = 1,
        // extent
    dx = 24,
        // nodeWidth
    py = 8,
        // nodePadding
    id = defaultId,
        align = justify,
        nodes = defaultNodes,
        links = defaultLinks,
        iterations = 32;

    function sankey() {
      var graph = {
        nodes: nodes.apply(null, arguments),
        links: links.apply(null, arguments)
      };
      computeNodeLinks(graph);
      computeNodeValues(graph);
      computeNodeDepths(graph);
      computeNodeBreadths(graph);
      computeLinkBreadths(graph);
      return graph;
    }

    sankey.update = function (graph) {
      computeLinkBreadths(graph);
      return graph;
    };

    sankey.nodeId = function (_) {
      return arguments.length ? (id = typeof _ === "function" ? _ : constant$b(_), sankey) : id;
    };

    sankey.nodeAlign = function (_) {
      return arguments.length ? (align = typeof _ === "function" ? _ : constant$b(_), sankey) : align;
    };

    sankey.nodeWidth = function (_) {
      return arguments.length ? (dx = +_, sankey) : dx;
    };

    sankey.nodePadding = function (_) {
      return arguments.length ? (py = +_, sankey) : py;
    };

    sankey.nodes = function (_) {
      return arguments.length ? (nodes = typeof _ === "function" ? _ : constant$b(_), sankey) : nodes;
    };

    sankey.links = function (_) {
      return arguments.length ? (links = typeof _ === "function" ? _ : constant$b(_), sankey) : links;
    };

    sankey.size = function (_) {
      return arguments.length ? (x0 = y0 = 0, x1 = +_[0], y1 = +_[1], sankey) : [x1 - x0, y1 - y0];
    };

    sankey.extent = function (_) {
      return arguments.length ? (x0 = +_[0][0], x1 = +_[1][0], y0 = +_[0][1], y1 = +_[1][1], sankey) : [[x0, y0], [x1, y1]];
    };

    sankey.iterations = function (_) {
      return arguments.length ? (iterations = +_, sankey) : iterations;
    }; // Populate the sourceLinks and targetLinks for each node.
    // Also, if the source and target are not objects, assume they are indices.


    function computeNodeLinks(graph) {
      graph.nodes.forEach(function (node, i) {
        node.index = i;
        node.sourceLinks = [];
        node.targetLinks = [];
      });
      var nodeById = map(graph.nodes, id);
      graph.links.forEach(function (link, i) {
        link.index = i;
        var source = link.source,
            target = link.target;
        if (_typeof(source) !== "object") source = link.source = find$2(nodeById, source);
        if (_typeof(target) !== "object") target = link.target = find$2(nodeById, target);
        source.sourceLinks.push(link);
        target.targetLinks.push(link);
      });
    } // Compute the value (size) of each node by summing the associated links.


    function computeNodeValues(graph) {
      graph.nodes.forEach(function (node) {
        node.value = Math.max(sum(node.sourceLinks, value), sum(node.targetLinks, value));
      });
    } // Iteratively assign the depth (x-position) for each node.
    // Nodes are assigned the maximum depth of incoming neighbors plus one;
    // nodes with no incoming links are assigned depth zero, while
    // nodes with no outgoing links are assigned the maximum depth.


    function computeNodeDepths(graph) {
      var nodes, next, x;

      for (nodes = graph.nodes, next = [], x = 0; nodes.length; ++x, nodes = next, next = []) {
        nodes.forEach(function (node) {
          node.depth = x;
          node.sourceLinks.forEach(function (link) {
            if (next.indexOf(link.target) < 0) {
              next.push(link.target);
            }
          });
        });
      }

      for (nodes = graph.nodes, next = [], x = 0; nodes.length; ++x, nodes = next, next = []) {
        nodes.forEach(function (node) {
          node.height = x;
          node.targetLinks.forEach(function (link) {
            if (next.indexOf(link.source) < 0) {
              next.push(link.source);
            }
          });
        });
      }

      var kx = (x1 - x0 - dx) / (x - 1);
      graph.nodes.forEach(function (node) {
        node.x1 = (node.x0 = x0 + Math.max(0, Math.min(x - 1, Math.floor(align.call(null, node, x)))) * kx) + dx;
      });
    }

    function computeNodeBreadths(graph) {
      var columns = nest().key(function (d) {
        return d.x0;
      }).sortKeys(ascending).entries(graph.nodes).map(function (d) {
        return d.values;
      }); //

      initializeNodeBreadth();
      resolveCollisions();

      for (var alpha = 1, n = iterations; n > 0; --n) {
        relaxRightToLeft(alpha *= 0.99);
        resolveCollisions();
        relaxLeftToRight(alpha);
        resolveCollisions();
      }

      function initializeNodeBreadth() {
        var ky = min(columns, function (nodes) {
          return (y1 - y0 - (nodes.length - 1) * py) / sum(nodes, value);
        });
        columns.forEach(function (nodes) {
          nodes.forEach(function (node, i) {
            node.y1 = (node.y0 = i) + node.value * ky;
          });
        });
        graph.links.forEach(function (link) {
          link.width = link.value * ky;
        });
      }

      function relaxLeftToRight(alpha) {
        columns.forEach(function (nodes) {
          nodes.forEach(function (node) {
            if (node.targetLinks.length) {
              var dy = (sum(node.targetLinks, weightedSource) / sum(node.targetLinks, value) - nodeCenter(node)) * alpha;
              node.y0 += dy, node.y1 += dy;
            }
          });
        });
      }

      function relaxRightToLeft(alpha) {
        columns.slice().reverse().forEach(function (nodes) {
          nodes.forEach(function (node) {
            if (node.sourceLinks.length) {
              var dy = (sum(node.sourceLinks, weightedTarget) / sum(node.sourceLinks, value) - nodeCenter(node)) * alpha;
              node.y0 += dy, node.y1 += dy;
            }
          });
        });
      }

      function resolveCollisions() {
        columns.forEach(function (nodes) {
          var node,
              dy,
              y = y0,
              n = nodes.length,
              i; // Push any overlapping nodes down.

          nodes.sort(ascendingBreadth);

          for (i = 0; i < n; ++i) {
            node = nodes[i];
            dy = y - node.y0;
            if (dy > 0) node.y0 += dy, node.y1 += dy;
            y = node.y1 + py;
          } // If the bottommost node goes outside the bounds, push it back up.


          dy = y - py - y1;

          if (dy > 0) {
            y = node.y0 -= dy, node.y1 -= dy; // Push any overlapping nodes back up.

            for (i = n - 2; i >= 0; --i) {
              node = nodes[i];
              dy = node.y1 + py - y;
              if (dy > 0) node.y0 -= dy, node.y1 -= dy;
              y = node.y0;
            }
          }
        });
      }
    }

    function computeLinkBreadths(graph) {
      graph.nodes.forEach(function (node) {
        node.sourceLinks.sort(ascendingTargetBreadth);
        node.targetLinks.sort(ascendingSourceBreadth);
      });
      graph.nodes.forEach(function (node) {
        var y0 = node.y0,
            y1 = y0;
        node.sourceLinks.forEach(function (link) {
          link.y0 = y0 + link.width / 2, y0 += link.width;
        });
        node.targetLinks.forEach(function (link) {
          link.y1 = y1 + link.width / 2, y1 += link.width;
        });
      });
    }

    return sankey;
  }

  function horizontalSource(d) {
    return [d.source.x1, d.y0];
  }

  function horizontalTarget(d) {
    return [d.target.x0, d.y1];
  }

  function sankeyLinkHorizontal () {
    return linkHorizontal().source(horizontalSource).target(horizontalTarget);
  }

  function _typeof$z(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$z = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$z = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$z(obj);
  }

  function _classCallCheck$y(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$t(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$t(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$t(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$t(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$v(self, call) {
    if (call && (_typeof$z(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$v(self);
  }

  function _assertThisInitialized$v(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$e(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$e = Reflect.get;
    } else {
      _get$e = function _get(target, property, receiver) {
        var base = _superPropBase$e(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$e(target, property, receiver || target);
  }

  function _superPropBase$e(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$v(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$v(o) {
    _getPrototypeOf$v = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$v(o);
  }

  function _inherits$v(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$v(subClass, superClass);
  }

  function _setPrototypeOf$v(o, p) {
    _setPrototypeOf$v = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$v(o, p);
  }
  var sankeyAligns = {
    center: center,
    justify: justify,
    left: left,
    right: right
  };
  /**
      @class Sankey
      @extends external:Viz
      @desc Creates a sankey visualization based on a defined set of nodes and links. [Click here](http://d3plus.org/examples/d3plus-network/sankey-diagram/) for help getting started using the Sankey class.
  */

  var Sankey =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$v(Sankey, _Viz);
    /**
        @memberof Sankey
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Sankey() {
      var _this;

      _classCallCheck$y(this, Sankey);

      _this = _possibleConstructorReturn$v(this, _getPrototypeOf$v(Sankey).call(this));
      _this._nodeId = accessor("id");
      _this._links = accessor("links");
      _this._linksSource = "source";
      _this._linksTarget = "target";
      _this._noDataMessage = false;
      _this._nodes = accessor("nodes");
      _this._nodeAlign = sankeyAligns.justify;
      _this._nodePadding = 8;
      _this._nodeWidth = 30;

      _this._on.mouseenter = function () {};

      _this._on["mouseleave.shape"] = function () {
        _this.hover(false);
      };

      var defaultMouseMove = _this._on["mousemove.shape"];

      _this._on["mousemove.shape"] = function (d, i) {
        defaultMouseMove(d, i);

        if (_this._focus && _this._focus === d.id) {
          _this.hover(false);

          _this._on.mouseenter.bind(_assertThisInitialized$v(_this))(d, i);

          _this._focus = undefined;
        } else {
          var id = _this._nodeId(d, i),
              node = _this._nodeLookup[id],
              nodeLookup = Object.keys(_this._nodeLookup).reduce(function (all, item) {
            all[_this._nodeLookup[item]] = !isNaN(item) ? parseInt(item, 10) : item;
            return all;
          }, {});

          var links = _this._linkLookup[node];
          var filterIds = [id];
          links.forEach(function (l) {
            filterIds.push(nodeLookup[l]);
          });

          _this.hover(function (h, x) {
            if (h.source && h.target) {
              return h.source.id === id || h.target.id === id;
            } else {
              return filterIds.includes(_this._nodeId(h, x));
            }
          });
        }
      };

      _this._path = sankeyLinkHorizontal();
      _this._sankey = sankey();
      _this._shape = constant$3("Rect");
      _this._shapeConfig = assign(_this._shapeConfig, {
        Path: {
          fill: "none",
          hoverStyle: {
            "stroke-width": function strokeWidth(d) {
              return Math.max(1, Math.abs(d.source.y1 - d.source.y0) * (d.value / d.source.value) - 2);
            }
          },
          label: false,
          stroke: "#DBDBDB",
          strokeOpacity: 0.5,
          strokeWidth: function strokeWidth(d) {
            return Math.max(1, Math.abs(d.source.y1 - d.source.y0) * (d.value / d.source.value) - 2);
          }
        },
        Rect: {}
      });
      _this._value = constant$3(1);
      return _this;
    }
    /**
        Extends the draw behavior of the abstract Viz class.
        @private
    */


    _createClass$t(Sankey, [{
      key: "_draw",
      value: function _draw(callback) {
        var _this2 = this;

        _get$e(_getPrototypeOf$v(Sankey.prototype), "_draw", this).call(this, callback);

        var height = this._height - this._margin.top - this._margin.bottom,
            width = this._width - this._margin.left - this._margin.right;

        var _nodes = Array.isArray(this._nodes) ? this._nodes : this._links.reduce(function (all, d) {
          if (!all.includes(d[_this2._linksSource])) all.push(d[_this2._linksSource]);
          if (!all.includes(d[_this2._linksTarget])) all.push(d[_this2._linksTarget]);
          return all;
        }, []).map(function (id) {
          return {
            id: id
          };
        });

        var nodes = _nodes.map(function (n, i) {
          return {
            __d3plus__: true,
            data: n,
            i: i,
            id: _this2._nodeId(n, i),
            node: n,
            shape: "Rect"
          };
        });

        var nodeLookup = this._nodeLookup = nodes.reduce(function (obj, d, i) {
          obj[d.id] = i;
          return obj;
        }, {});

        var links = this._links.map(function (link, i) {
          var check = [_this2._linksSource, _this2._linksTarget];
          var linkLookup = check.reduce(function (result, item) {
            result[item] = nodeLookup[link[item]];
            return result;
          }, {});
          return {
            source: linkLookup[_this2._linksSource],
            target: linkLookup[_this2._linksTarget],
            value: _this2._value(link, i)
          };
        });

        this._linkLookup = links.reduce(function (obj, d) {
          if (!obj[d.source]) obj[d.source] = [];
          obj[d.source].push(d.target);
          if (!obj[d.target]) obj[d.target] = [];
          obj[d.target].push(d.source);
          return obj;
        }, {});
        var transform = "translate(".concat(this._margin.left, ", ").concat(this._margin.top, ")");

        this._sankey.nodeAlign(this._nodeAlign).nodePadding(this._nodePadding).nodeWidth(this._nodeWidth).nodes(nodes).links(links).size([width, height])();

        this._shapes.push(new Path$1().config(this._shapeConfig.Path).data(links).d(this._path).select(elem("g.d3plus-Links", {
          parent: this._select,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        }).node()).render());

        nest().key(function (d) {
          return d.shape;
        }).entries(nodes).forEach(function (d) {
          _this2._shapes.push(new shapes$2[d.key]().data(d.values).height(function (d) {
            return d.y1 - d.y0;
          }).width(function (d) {
            return d.x1 - d.x0;
          }).x(function (d) {
            return (d.x1 + d.x0) / 2;
          }).y(function (d) {
            return (d.y1 + d.y0) / 2;
          }).select(elem("g.d3plus-sankey-nodes", {
            parent: _this2._select,
            enter: {
              transform: transform
            },
            update: {
              transform: transform
            }
          }).node()).config(configPrep.bind(_this2)(_this2._shapeConfig, "shape", d.key)).render());
        });
        return this;
      }
      /**
          @memberof Sankey
          @desc If *value* is specified, sets the hover method to the specified function and returns the current class instance.
          @param {Function} [*value*]
          @chainable
       */

    }, {
      key: "hover",
      value: function hover(_) {
        this._hover = _;

        this._shapes.forEach(function (s) {
          return s.hover(_);
        });

        if (this._legend) this._legendClass.hover(_);
        return this;
      }
      /**
          @memberof Sankey
          @desc A predefined *Array* of edges that connect each object passed to the [node](#Sankey.node) method. The `source` and `target` keys in each link need to map to the nodes in one of one way:
      1. A *String* value matching the `id` of the node.
      The value passed should be an *Array* of data. An optional formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final links *Array*.
          @param {Array} *links* = []
          @chainable
      */

    }, {
      key: "links",
      value: function links(_, f) {
        if (arguments.length) {
          var prev = this._queue.find(function (q) {
            return q[3] === "links";
          });

          var d = [load.bind(this), _, f, "links"];
          if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          return this;
        }

        return this._links;
      }
      /**
          @memberof Sankey
          @desc The key inside of each link Object that references the source node.
          @param {String} [*value* = "source"]
          @chainable
      */

    }, {
      key: "linksSource",
      value: function linksSource(_) {
        return arguments.length ? (this._linksSource = _, this) : this._linksSource;
      }
      /**
          @memberof Sankey
          @desc The key inside of each link Object that references the target node.
          @param {String} [*value* = "target"]
          @chainable
      */

    }, {
      key: "linksTarget",
      value: function linksTarget(_) {
        return arguments.length ? (this._linksTarget = _, this) : this._linksTarget;
      }
      /**
          @memberof Sankey
          @desc Sets the nodeAlign property of the sankey layout, which can either be "left", "right", "center", or "justify".
          @param {Function|String} [*value* = "justify"]
          @chainable
      */

    }, {
      key: "nodeAlign",
      value: function nodeAlign(_) {
        return arguments.length ? (this._nodeAlign = typeof _ === "function" ? _ : sankeyAligns[_], this) : this._nodeAlign;
      }
      /**
          @memberof Sankey
          @desc If *value* is specified, sets the node id accessor(s) to the specified array of values and returns the current class instance. If *value* is not specified, returns the current node group accessor.
          @param {String} [*value* = "id"]
          @chainable
      */

    }, {
      key: "nodeId",
      value: function nodeId(_) {
        return arguments.length ? (this._nodeId = typeof _ === "function" ? _ : accessor(_), this) : this._nodeId;
      }
      /**
          @memberof Sankey
          @desc The list of nodes to be used for drawing the network. The value passed must be an *Array* of data.
      Additionally, a custom formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final node *Array*.
          @param {Array} *nodes* = []
          @chainable
      */

    }, {
      key: "nodes",
      value: function nodes(_, f) {
        if (arguments.length) {
          var prev = this._queue.find(function (q) {
            return q[3] === "nodes";
          });

          var d = [load.bind(this), _, f, "nodes"];
          if (prev) this._queue[this._queue.indexOf(prev)] = d;else this._queue.push(d);
          return this;
        }

        return this._nodes;
      }
      /**
          @memberof Sankey
          @desc If *value* is specified, sets the padding of the node and returns the current class instance. If *value* is not specified, returns the current nodePadding. By default, the nodePadding size is 8.
          @param {Number} [*value* = 8]
          @chainable
      */

    }, {
      key: "nodePadding",
      value: function nodePadding(_) {
        return arguments.length ? (this._nodePadding = _, this) : this._nodePadding;
      }
      /**
          @memberof Sankey
          @desc If *value* is specified, sets the width of the node and returns the current class instance. If *value* is not specified, returns the current nodeWidth. By default, the nodeWidth size is 30.
          @param {Number} [*value* = 30]
          @chainable
      */

    }, {
      key: "nodeWidth",
      value: function nodeWidth(_) {
        return arguments.length ? (this._nodeWidth = _, this) : this._nodeWidth;
      }
      /**
          @memberof Sankey
          @desc If *value* is specified, sets the width of the links and returns the current class instance. If *value* is not specified, returns the current value accessor.
          @param {Function|Number} *value*
          @example
      function value(d) {
      return d.value;
      }
      */

    }, {
      key: "value",
      value: function value(_) {
        return arguments.length ? (this._value = typeof _ === "function" ? _ : accessor(_), this) : this._value;
      }
    }]);

    return Sankey;
  }(Viz);

  /**
   * Adds left/right padding to a point or time scale.
   * @private
   */
  var discreteBuffer = (function (scale, data, discrete) {
    if (scale.padding) scale.padding(0.5);else {
      var closest = data.map(function (d) {
        return d[discrete];
      }).reduce(function (acc, curr, i, arr) {
        if (!i) return acc;
        var prev = arr[i - 1];
        if (!acc || curr - prev < acc) return curr - prev;else return acc;
      }, 0);
      var domain = scale.domain().slice();
      if (discrete === "y") domain.reverse();
      domain[0] = new Date(+domain[0] - closest / 2);
      domain[1] = new Date(+domain[1] + closest / 2);
      if (discrete === "y") domain.reverse();
      scale.domain(domain);
    }
  });

  /**
      Adds a buffer to either side of the non-discrete axis.
      @param {Array} data
      @param {D3Scale} x
      @param {D3Scale} y
      @param {Object} [config]
      @param {Number} [buffer = 10]
      @private
  */

  function BarBuffer (_ref) {
    var _this = this;

    var data = _ref.data,
        x = _ref.x,
        y = _ref.y,
        x2 = _ref.x2,
        y2 = _ref.y2,
        _ref$buffer = _ref.buffer,
        buffer = _ref$buffer === void 0 ? 10 : _ref$buffer;
    var xKey = x2 ? "x2" : "x";
    var yKey = y2 ? "y2" : "y";
    var oppScale = this._discrete === "x" ? y : x;
    var oppDomain = oppScale.domain().slice();
    var isDiscreteX = this._discrete === "x";
    if (isDiscreteX) oppDomain.reverse();
    var negVals, posVals;

    if (this._stacked) {
      var groupedData = nest().key(function (d) {
        return "".concat(d[_this._discrete], "_").concat(d.group);
      }).entries(data).map(function (d) {
        return d.values.map(function (x) {
          return x[isDiscreteX ? yKey : xKey];
        });
      });
      posVals = groupedData.map(function (arr) {
        return sum(arr.filter(function (d) {
          return d > 0;
        }));
      });
      negVals = groupedData.map(function (arr) {
        return sum(arr.filter(function (d) {
          return d < 0;
        }));
      });
    } else {
      posVals = data.map(function (d) {
        return d[isDiscreteX ? yKey : xKey];
      });
      negVals = posVals;
    }

    var bMax = oppScale(max(posVals));
    if (isDiscreteX ? bMax < oppScale(0) : bMax > oppScale(0)) bMax += isDiscreteX ? -buffer : buffer;
    bMax = oppScale.invert(bMax);
    var bMin = oppScale(min(negVals));
    if (isDiscreteX ? bMin > oppScale(0) : bMin < oppScale(0)) bMin += isDiscreteX ? buffer : -buffer;
    bMin = oppScale.invert(bMin);
    if (bMax > oppDomain[1]) oppDomain[1] = bMax;
    if (bMin < oppDomain[0]) oppDomain[0] = bMin;
    if (isDiscreteX) oppDomain.reverse();
    oppScale.domain(oppDomain);
    discreteBuffer(isDiscreteX ? x : y, data, this._discrete);
    return [x, y];
  }

  /**
      Adds a buffer to either side of the non-discrete axis.
      @param {Array} data
      @param {D3Scale} x
      @param {D3Scale} y
      @param {Object} [config]
      @param {Number} [buffer = 10]
      @private
  */

  function BoxBuffer (_ref) {
    var _this = this;

    var data = _ref.data,
        x = _ref.x,
        y = _ref.y,
        x2 = _ref.x2,
        y2 = _ref.y2,
        _ref$buffer = _ref.buffer,
        buffer = _ref$buffer === void 0 ? 10 : _ref$buffer;
    var xKey = x2 ? "x2" : "x";
    var yKey = y2 ? "y2" : "y";
    var oppScale = this._discrete === "x" ? y : x;
    var oppDomain = oppScale.domain().slice();
    var isDiscreteX = this._discrete === "x";
    if (isDiscreteX) oppDomain.reverse();
    var negVals, posVals;

    if (this._stacked) {
      var groupedData = nest().key(function (d) {
        return d[_this._discrete];
      }).entries(data).map(function (d) {
        return d.values.map(function (x) {
          return x[isDiscreteX ? yKey : xKey];
        });
      });
      posVals = groupedData.map(function (arr) {
        return sum(arr.filter(function (d) {
          return d > 0;
        }));
      });
      negVals = groupedData.map(function (arr) {
        return sum(arr.filter(function (d) {
          return d < 0;
        }));
      });
    } else {
      posVals = data.map(function (d) {
        return d[isDiscreteX ? yKey : xKey];
      });
      negVals = posVals;
    }

    var bMax = oppScale(max(posVals));
    bMax += isDiscreteX ? -buffer : buffer;
    bMax = oppScale.invert(bMax);
    var bMin = oppScale(min(negVals));
    bMin += isDiscreteX ? buffer : -buffer;
    bMin = oppScale.invert(bMin);
    if (bMax > oppDomain[1]) oppDomain[1] = bMax;
    if (bMin < oppDomain[0]) oppDomain[0] = bMin;
    if (isDiscreteX) oppDomain.reverse();
    oppScale.domain(oppDomain);
    discreteBuffer(isDiscreteX ? x : y, data, this._discrete);
    return [x, y];
  }

  /**
      Adds a buffer to either side of the non-discrete axis.
      @param {Array} data
      @param {D3Scale} x
      @param {D3Scale} y
      @param {Object} [config]
      @param {Number} [buffer] Defaults to the radius of the largest Circle.
      @private
  */

  function CircleBuffer (_ref) {
    var data = _ref.data,
        x = _ref.x,
        y = _ref.y,
        x2 = _ref.x2,
        y2 = _ref.y2,
        config = _ref.config,
        buffer = _ref.buffer;
    var xKey = x2 ? "x2" : "x";
    var yKey = y2 ? "y2" : "y";
    var xD = x.domain().slice(),
        yD = y.domain().slice();
    var xR = x.range(),
        yR = y.range();
    if (!x.invert && x.padding) discreteBuffer(x, data, this._discrete);
    if (!y.invert && y.padding) discreteBuffer(y, data, this._discrete);
    data.forEach(function (d) {
      var s = buffer ? buffer : config.r(d.data, d.i) * 2;

      if (x.invert && x(d[xKey]) - xR[0] < s) {
        var v = x.invert(x(d[xKey]) - s);
        if (v < xD[0]) xD[0] = v;
      }

      if (x.invert && xR[1] - x(d[xKey]) < s) {
        var _v = x.invert(x(d[xKey]) + s);

        if (_v > xD[1]) xD[1] = _v;
      }

      if (y.invert && y(d[yKey]) - yR[0] < s) {
        var _v2 = y.invert(y(d[yKey]) - s);

        if (_v2 > yD[0]) yD[0] = _v2;
      }

      if (y.invert && yR[1] - y(d[yKey]) < s) {
        var _v3 = y.invert(y(d[yKey]) + s);

        if (_v3 < yD[1]) yD[1] = _v3;
      }
    });
    x.domain(xD).range(xR);
    y.domain(yD).range(yR);
    return [x, y];
  }

  /**
      Adds a buffer to either side of the non-discrete axis.
      @param {Array} data
      @param {D3Scale} x
      @param {D3Scale} y
      @param {Object} [config]
      @param {Number} [buffer] Defaults to the radius of the largest Circle.
      @private
  */

  function LineBuffer (_ref) {
    var _this = this;

    var data = _ref.data,
        x = _ref.x,
        y = _ref.y,
        x2 = _ref.x2,
        y2 = _ref.y2;
    var xKey = x2 ? "x2" : "x";
    var yKey = y2 ? "y2" : "y";
    var s = this._discrete === "x" ? y : x;
    var d = s.domain().slice();
    if (this._discrete === "x") d.reverse();
    var vals = data.map(function (d) {
      return d[_this._discrete === "x" ? yKey : xKey];
    });
    var b = s.invert(s(max(vals)) + (this._discrete === "x" ? -10 : 10));
    if (b > d[1]) d[1] = b;
    if (this._discrete === "x") d.reverse();
    s.domain(d);
    return [x, y];
  }

  /**
      Adds a buffer to either side of the non-discrete axis.
      @param {Array} data
      @param {D3Scale} x
      @param {D3Scale} y
      @param {Object} [config]
      @param {Number} [buffer] Defaults to the radius of the largest Circle.
      @private
  */

  function RectBuffer (_ref) {
    var data = _ref.data,
        x = _ref.x,
        y = _ref.y,
        x2 = _ref.x2,
        y2 = _ref.y2,
        config = _ref.config;
    var xKey = x2 ? "x2" : "x";
    var yKey = y2 ? "y2" : "y";
    var xD = x.domain().slice(),
        yD = y.domain().slice();
    var xR = x.range(),
        yR = y.range();
    if (!x.invert && x.padding) discreteBuffer(x, data, this._discrete);
    if (!y.invert && y.padding) discreteBuffer(y, data, this._discrete);
    data.forEach(function (d) {
      var h = config.height(d.data, d.i),
          w = config.width(d.data, d.i);

      if (x.invert && x(d[xKey]) - xR[0] < w) {
        var v = x.invert(x(d[xKey]) - w);
        if (v < xD[0]) xD[0] = v;
      }

      if (x.invert && xR[1] - x(d[xKey]) < w) {
        var _v = x.invert(x(d[xKey]) + w);

        if (_v > xD[1]) xD[1] = _v;
      }

      if (y.invert && y(d[yKey]) - yR[0] < h) {
        var _v2 = y.invert(y(d[yKey]) - h);

        if (_v2 > yD[0]) yD[0] = _v2;
      }

      if (y.invert && yR[1] - y(d[yKey]) < h) {
        var _v3 = y.invert(y(d[yKey]) + h);

        if (_v3 < yD[1]) yD[1] = _v3;
      }
    });
    x.domain(xD);
    y.domain(yD);
    return [x, y];
  }

  function _typeof$A(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$A = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$A = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$A(obj);
  }

  function _defineProperty$5(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function _classCallCheck$z(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$u(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$u(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$u(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$u(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$w(self, call) {
    if (call && (_typeof$A(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$w(self);
  }

  function _assertThisInitialized$w(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$f(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$f = Reflect.get;
    } else {
      _get$f = function _get(target, property, receiver) {
        var base = _superPropBase$f(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$f(target, property, receiver || target);
  }

  function _superPropBase$f(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$w(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$w(o) {
    _getPrototypeOf$w = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$w(o);
  }

  function _inherits$w(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$w(subClass, superClass);
  }

  function _setPrototypeOf$w(o, p) {
    _setPrototypeOf$w = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$w(o, p);
  }
  /**
      @desc Logic for determining default sizes of shapes using the sizeScaleD3 internal function.
      @private
  */

  function defaultSize(d) {
    return this._sizeScaleD3(this._size ? this._size(d) : null);
  }
  /**
      @desc Logic for determining stackOrder ascending using groups.
      @private
  */


  function stackOrderAscending(series) {
    var sums = series.map(stackSum);
    var keys = series.map(function (d) {
      return d.key.split("_")[0];
    });
    return none$2(series).sort(function (a, b) {
      return keys[b].localeCompare(keys[a]) || sums[a] - sums[b];
    });
  }
  /**
      @desc Logic for determining stackOrder descending using groups.
      @private
  */


  function stackOrderDescending(series) {
    return stackOrderAscending(series).reverse();
  }
  /**
      @desc Logic for determining default sum of shapes using the stackSum function used in d3Shape.
      @private
  */


  function stackSum(series) {
    var i = -1,
        s = 0,
        v;
    var n = series.length;

    while (++i < n) {
      if (v = +series[i][1]) s += v;
    }

    return s;
  }
  /**
      @class Plot
      @extends Viz
      @desc Creates an x/y plot based on an array of data.
  */


  var Plot =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$w(Plot, _Viz);
    /**
        @memberof Plot
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Plot() {
      var _this;

      _classCallCheck$z(this, Plot);

      _this = _possibleConstructorReturn$w(this, _getPrototypeOf$w(Plot).call(this));
      _this._annotations = [];
      _this._backgroundConfig = {
        duration: 0,
        fill: "transparent"
      };
      _this._barPadding = 0;
      _this._buffer = {
        Bar: BarBuffer,
        Box: BoxBuffer,
        Circle: CircleBuffer,
        Line: LineBuffer,
        Rect: RectBuffer
      };
      _this._confidenceConfig = {
        fillOpacity: constant$3(0.5)
      };
      _this._discreteCutoff = 100;
      _this._groupPadding = 5;
      _this._shape = constant$3("Circle");
      _this._shapeConfig = assign(_this._shapeConfig, {
        Area: {
          label: function label(d, i) {
            return _this._stacked ? _this._drawLabel(d, i) : false;
          },
          labelConfig: {
            fontResize: true
          }
        },
        ariaLabel: function ariaLabel(d, i) {
          var ariaLabelStr = "";
          if (d.nested) ariaLabelStr = "".concat(_this._drawLabel(d.data, d.i));else {
            ariaLabelStr = "".concat(_this._drawLabel(d, i));
            if (_this._x(d, i) !== undefined) ariaLabelStr += ", x: ".concat(_this._x(d, i));
            if (_this._y(d, i) !== undefined) ariaLabelStr += ", y: ".concat(_this._y(d, i));
            if (_this._x2(d, i) !== undefined) ariaLabelStr += ", x2: ".concat(_this._x2(d, i));
            if (_this._y2(d, i) !== undefined) ariaLabelStr += ", y2: ".concat(_this._y2(d, i));
          }
          return "".concat(ariaLabelStr, ".");
        },
        Bar: {
          labelConfig: {
            textAnchor: function textAnchor() {
              return _this._discrete === "x" ? "middle" : "end";
            },
            verticalAlign: function verticalAlign() {
              return _this._discrete === "x" ? "top" : "middle";
            }
          }
        },
        Circle: {
          r: defaultSize.bind(_assertThisInitialized$w(_this))
        },
        Line: {
          fill: constant$3("none"),
          label: false,
          stroke: function stroke(d, i) {
            return colorAssign(_this._id(d, i));
          },
          strokeWidth: constant$3(1)
        },
        Rect: {
          height: function height(d) {
            return defaultSize.bind(_assertThisInitialized$w(_this))(d) * 2;
          },
          width: function width(d) {
            return defaultSize.bind(_assertThisInitialized$w(_this))(d) * 2;
          }
        }
      });
      _this._shapeOrder = ["Area", "Path", "Bar", "Box", "Line", "Rect", "Circle"];

      _this._shapeSort = function (a, b) {
        return _this._shapeOrder.indexOf(a) - _this._shapeOrder.indexOf(b);
      };

      _this._sizeMax = 20;
      _this._sizeMin = 5;
      _this._sizeScale = "sqrt";
      _this._stackOffset = diverging$1;
      _this._stackOrder = stackOrderDescending;
      _this._timelineConfig = assign(_this._timelineConfig, {
        brushing: true
      });
      _this._x = accessor("x");
      _this._xAxis = new AxisBottom().align("end");
      _this._xTest = new AxisBottom().align("end").gridSize(0);
      _this._xConfig = {};
      _this._xCutoff = 150;
      _this._x2 = accessor("x2");
      _this._x2Axis = new AxisTop().align("start");
      _this._x2Test = new AxisTop().align("start").gridSize(0);
      _this._x2Config = {
        padding: 0
      };
      _this._y = accessor("y");
      _this._yAxis = new AxisLeft().align("start");
      _this._yTest = new AxisLeft().align("start").gridSize(0);
      _this._yConfig = {
        gridConfig: {
          stroke: function stroke(d) {
            var domain = _this._yAxis.domain();

            return domain[domain.length - 1] === d.id ? "transparent" : "#ccc";
          }
        }
      };
      _this._yCutoff = 150;
      _this._y2 = accessor("y2");
      _this._y2Axis = new AxisRight().align("end");
      _this._y2Test = new AxisLeft().align("end").gridSize(0);
      _this._y2Config = {};
      return _this;
    }
    /**
        Extends the draw behavior of the abstract Viz class.
        @private
    */


    _createClass$u(Plot, [{
      key: "_draw",
      value: function _draw(callback) {
        var _this2 = this;

        if (!this._filteredData.length) return this;

        var stackGroup = function stackGroup(d, i) {
          return _this2._stacked ? "".concat(_this2._groupBy.length > 1 ? _this2._ids(d, i).slice(0, -1).join("_") : "group") : "".concat(_this2._ids(d, i).join("_"));
        };

        var data = this._filteredData.map(function (d, i) {
          return {
            __d3plus__: true,
            data: d,
            group: stackGroup(d, i),
            i: i,
            hci: _this2._confidence && _this2._confidence[1] && _this2._confidence[1](d, i),
            id: _this2._ids(d, i).slice(0, _this2._drawDepth + 1).join("_"),
            lci: _this2._confidence && _this2._confidence[0] && _this2._confidence[0](d, i),
            shape: _this2._shape(d, i),
            x: _this2._x(d, i),
            x2: _this2._x2(d, i),
            y: _this2._y(d, i),
            y2: _this2._y2(d, i)
          };
        });

        this._formattedData = data;

        if (this._size) {
          var rExtent = extent(data, function (d) {
            return _this2._size(d.data);
          });

          this._sizeScaleD3 = function () {
            return _this2._sizeMin;
          };

          this._sizeScaleD3 = scales["scale".concat(this._sizeScale.charAt(0).toUpperCase()).concat(this._sizeScale.slice(1))]().domain(rExtent).range([rExtent[0] === rExtent[1] ? this._sizeMax : min([this._sizeMax / 2, this._sizeMin]), this._sizeMax]);
        } else {
          this._sizeScaleD3 = function () {
            return _this2._sizeMin;
          };
        }

        var x2Exists = data.some(function (d) {
          return d.x2 !== undefined;
        }),
            y2Exists = data.some(function (d) {
          return d.y2 !== undefined;
        });
        var height = this._height - this._margin.top - this._margin.bottom,
            opp = this._discrete ? this._discrete === "x" ? "y" : "x" : undefined,
            opp2 = this._discrete ? this._discrete === "x" ? "y2" : "x2" : undefined,
            opps = [opp, opp2].filter(function (d) {
          return d;
        }),
            parent = this._select,
            transition = this._transition,
            width = this._width - this._margin.left - this._margin.right;

        var x2Time = this._time && data[0].x2 === this._time(data[0].data, data[0].i),
            xTime = this._time && data[0].x === this._time(data[0].data, data[0].i),
            y2Time = this._time && data[0].y2 === this._time(data[0].data, data[0].i),
            yTime = this._time && data[0].y === this._time(data[0].data, data[0].i);

        for (var i = 0; i < data.length; i++) {
          var d = data[i];
          if (xTime) d.x = date$2(d.x);
          if (x2Time) d.x2 = date$2(d.x2);
          if (yTime) d.y = date$2(d.y);
          if (y2Time) d.y2 = date$2(d.y2);
          d.discrete = d.shape === "Bar" ? "".concat(d[this._discrete], "_").concat(d.group) : "".concat(d[this._discrete]);
        }

        var discreteKeys, domains, stackData, stackKeys;

        if (this._stacked) {
          var _domains;

          var groupValues = nest().key(function (d) {
            return d.group;
          }).entries(data).reduce(function (obj, d) {
            if (!obj[d.key]) obj[d.key] = 0;
            obj[d.key] += sum(d.values, function (dd) {
              return dd[opp];
            });
            return obj;
          }, {});
          data = data.sort(function (a, b) {
            if (_this2["_".concat(_this2._discrete, "Sort")]) return _this2["_".concat(_this2._discrete, "Sort")](a.data, b.data);
            var a1 = a[_this2._discrete],
                b1 = b[_this2._discrete];
            if (a1 - b1 !== 0) return a1 - b1;
            if (a.group !== b.group) return groupValues[b.group] - groupValues[a.group];
            return b[opp] - a[opp];
          });
          discreteKeys = Array.from(new Set(data.map(function (d) {
            return d.discrete;
          })));
          stackKeys = Array.from(new Set(data.map(function (d) {
            return d.id;
          })));
          stackData = nest().key(function (d) {
            return d.discrete;
          }).entries(data).map(function (d) {
            return d.values;
          });
          stackData.forEach(function (g) {
            var ids = Array.from(new Set(g.map(function (d) {
              return d.id;
            })));

            if (ids.length < stackKeys.length) {
              stackKeys.forEach(function (k) {
                if (!ids.includes(k)) {
                  var _d = data.filter(function (d) {
                    return d.id === k;
                  })[0];

                  if (_d.shape === "Area") {
                    var _fillerPoint;

                    var group = stackGroup(_d.data, _d.i);
                    var fillerPoint = (_fillerPoint = {
                      __d3plus__: true,
                      data: _d.data,
                      discrete: _d.shape === "Bar" ? "".concat(g[0][_this2._discrete], "_").concat(group) : "".concat(g[0][_this2._discrete]),
                      group: group,
                      id: k,
                      shape: _d.shape
                    }, _defineProperty$5(_fillerPoint, _this2._discrete, g[0][_this2._discrete]), _defineProperty$5(_fillerPoint, opp, 0), _fillerPoint);
                    data.push(fillerPoint);
                  }
                }
              });
            }
          });

          if (this["_".concat(this._discrete, "Sort")]) {
            data.sort(function (a, b) {
              return _this2["_".concat(_this2._discrete, "Sort")](a.data, b.data);
            });
          } else {
            data.sort(function (a, b) {
              return a[_this2._discrete] - b[_this2._discrete];
            });
          }

          var order = this._stackOrder;
          if (order instanceof Array) stackKeys.sort(function (a, b) {
            return order.indexOf(a) - order.indexOf(b);
          });else if (order === none$2) stackKeys.sort(function (a, b) {
            return a.localeCompare(b);
          });
          stackData = stack().keys(stackKeys).offset(this._stackOffset).order(order instanceof Array ? none$2 : order).value(function (group, key) {
            var d = group.filter(function (g) {
              return g.id === key;
            });
            return d.length ? d[0][opp] : 0;
          })(stackData);
          domains = (_domains = {}, _defineProperty$5(_domains, this._discrete, extent(data, function (d) {
            return d[_this2._discrete];
          })), _defineProperty$5(_domains, opp, [min(stackData.map(function (g) {
            return min(g.map(function (p) {
              return p[0];
            }));
          })), max(stackData.map(function (g) {
            return max(g.map(function (p) {
              return p[1];
            }));
          }))]), _domains);
        } else {
          var _discrete = this._discrete || "x";

          if (this["_".concat(this._discrete, "Sort")]) {
            data.sort(function (a, b) {
              return _this2["_".concat(_this2._discrete, "Sort")](a.data, b.data);
            });
          } else {
            data.sort(function (a, b) {
              return a[_discrete] - b[_discrete];
            });
          }

          var xData = _discrete === "x" ? data.map(function (d) {
            return d.x;
          }) : data.map(function (d) {
            return d.x;
          }).concat(this._confidence && this._confidence[0] ? data.map(function (d) {
            return d.lci;
          }) : []).concat(this._confidence && this._confidence[1] ? data.map(function (d) {
            return d.hci;
          }) : []);
          var x2Data = _discrete === "x" ? data.map(function (d) {
            return d.x2;
          }) : data.map(function (d) {
            return d.x2;
          }).concat(this._confidence && this._confidence[0] ? data.map(function (d) {
            return d.lci;
          }) : []).concat(this._confidence && this._confidence[1] ? data.map(function (d) {
            return d.hci;
          }) : []);
          var yData = _discrete === "y" ? data.map(function (d) {
            return d.y;
          }) : data.map(function (d) {
            return d.y;
          }).concat(this._confidence && this._confidence[0] ? data.map(function (d) {
            return d.lci;
          }) : []).concat(this._confidence && this._confidence[1] ? data.map(function (d) {
            return d.hci;
          }) : []);
          var y2Data = _discrete === "y" ? data.map(function (d) {
            return d.y2;
          }) : data.map(function (d) {
            return d.y2;
          }).concat(this._confidence && this._confidence[0] ? data.map(function (d) {
            return d.lci;
          }) : []).concat(this._confidence && this._confidence[1] ? data.map(function (d) {
            return d.hci;
          }) : []);
          domains = {
            x: this._xSort ? Array.from(new Set(data.filter(function (d) {
              return d.x;
            }).sort(function (a, b) {
              return _this2._xSort(a.data, b.data);
            }).map(function (d) {
              return d.x;
            }))) : extent(xData, function (d) {
              return d;
            }),
            x2: this._x2Sort ? Array.from(new Set(data.filter(function (d) {
              return d.x2;
            }).sort(function (a, b) {
              return _this2._x2Sort(a.data, b.data);
            }).map(function (d) {
              return d.x2;
            }))) : extent(x2Data, function (d) {
              return d;
            }),
            y: this._ySort ? Array.from(new Set(data.filter(function (d) {
              return d.y;
            }).sort(function (a, b) {
              return _this2._ySort(a.data, b.data);
            }).map(function (d) {
              return d.y;
            }))) : extent(yData, function (d) {
              return d;
            }),
            y2: this._y2Sort ? Array.from(new Set(data.filter(function (d) {
              return d.y2;
            }).sort(function (a, b) {
              return _this2._y2Sort(a.data, b.data);
            }).map(function (d) {
              return d.y2;
            }))) : extent(y2Data, function (d) {
              return d;
            })
          };
        }

        var xDomain = this._xDomain ? this._xDomain.slice() : domains.x,
            xScale = this._xSort ? "Point" : "Linear";
        if (xDomain[0] === void 0) xDomain[0] = domains.x[0];
        if (xDomain[1] === void 0) xDomain[1] = domains.x[1];

        if (xTime) {
          xDomain = xDomain.map(date$2);
          xScale = "Time";
        } else if (this._discrete === "x") {
          xDomain = Array.from(new Set(data.filter(function (d) {
            return ["number", "string"].includes(_typeof$A(d.x));
          }).sort(function (a, b) {
            return _this2._xSort ? _this2._xSort(a.data, b.data) : a.x - b.x;
          }).map(function (d) {
            return d.x;
          })));
          xScale = "Point";
        }

        var x2Domain = this._x2Domain ? this._x2Domain.slice() : domains.x2,
            x2Scale = this._x2Sort ? "Point" : "Linear";
        if (x2Domain && x2Domain[0] === void 0) x2Domain[0] = domains.x2[0];
        if (x2Domain && x2Domain[1] === void 0) x2Domain[1] = domains.x2[1];

        if (x2Time) {
          x2Domain = x2Domain.map(date$2);
          x2Scale = "Time";
        } else if (this._discrete === "x") {
          x2Domain = Array.from(new Set(data.filter(function (d) {
            return ["number", "string"].includes(_typeof$A(d.x2));
          }).sort(function (a, b) {
            return _this2._x2Sort ? _this2._x2Sort(a.data, b.data) : a.x2 - b.x2;
          }).map(function (d) {
            return d.x2;
          })));
          x2Scale = "Point";
        }

        var yDomain = this._yDomain ? this._yDomain.slice() : domains.y,
            yScale = this._ySort ? "Point" : "Linear";
        if (yDomain[0] === void 0) yDomain[0] = domains.y[0];
        if (yDomain[1] === void 0) yDomain[1] = domains.y[1];
        var y2Domain = this._y2Domain ? this._y2Domain.slice() : domains.y2,
            y2Scale = this._y2Sort ? "Point" : "Linear";
        if (y2Domain && y2Domain[0] === void 0) y2Domain[0] = domains.y2[0];
        if (y2Domain && y2Domain[1] === void 0) y2Domain[1] = domains.y2[1];

        if (yTime) {
          yDomain = yDomain.map(date$2);
          yScale = "Time";
        } else if (this._discrete === "y") {
          yDomain = Array.from(new Set(data.filter(function (d) {
            return ["number", "string"].includes(_typeof$A(d.y));
          }).sort(function (a, b) {
            return _this2._ySort ? _this2._ySort(a.data, b.data) : a.y - b.y;
          }).map(function (d) {
            return d.y;
          })));
          yScale = "Point";
          y2Domain = Array.from(new Set(data.filter(function (d) {
            return ["number", "string"].includes(_typeof$A(d.y2));
          }).sort(function (a, b) {
            return _this2._y2Sort ? _this2._y2Sort(a.data, b.data) : a.y2 - b.y2;
          }).map(function (d) {
            return d.y2;
          })));
          y2Scale = "Point";
        }

        if (y2Time) {
          y2Domain = y2Domain.map(date$2);
          y2Scale = "Time";
        }

        domains = {
          x: xDomain,
          x2: x2Domain || xDomain,
          y: yDomain,
          y2: y2Domain || yDomain
        };
        opps.forEach(function (opp) {
          if (_this2["_".concat(opp, "Config")].domain) {
            var _d2 = _this2["_".concat(opp, "Config")].domain;

            if (_this2._discrete === "x") _d2.reverse();
            domains[opp] = _d2;
          } else if (opp && _this2._baseline !== void 0) {
            var b = _this2._baseline;
            if (domains[opp] && domains[opp][0] > b) domains[opp][0] = b;else if (domains[opp] && domains[opp][1] < b) domains[opp][1] = b;
          }
        });

        var _x2 = scales["scale".concat(xScale)]().domain(domains.x).range(range(0, width + 1, width / (domains.x.length - 1))),
            x2 = scales["scale".concat(x2Scale)]().domain(domains.x2).range(range(0, width + 1, width / (domains.x2.length - 1))),
            _y2 = scales["scale".concat(yScale)]().domain(domains.y.reverse()).range(range(0, height + 1, height / (domains.y.length - 1))),
            y2 = scales["scale".concat(y2Scale)]().domain(domains.y2.reverse()).range(range(0, height + 1, height / (domains.y2.length - 1)));

        var shapeData = nest().key(function (d) {
          return d.shape;
        }).entries(data).sort(function (a, b) {
          return _this2._shapeSort(a.key, b.key);
        });
        var oppScale = this._discrete === "x" ? yScale : xScale;

        if (this._xConfig.scale !== "log" && this._yConfig.scale !== "log" && oppScale !== "Point") {
          shapeData.forEach(function (d) {
            if (_this2._buffer[d.key]) {
              var res = _this2._buffer[d.key].bind(_this2)({
                data: d.values,
                x: _x2,
                y: _y2,
                config: _this2._shapeConfig[d.key]
              });

              if (_this2._xConfig.scale !== "log") _x2 = res[0];
              if (_this2._yConfig.scale !== "log") _y2 = res[1];

              var res2 = _this2._buffer[d.key].bind(_this2)({
                data: d.values,
                x: x2,
                y: y2,
                x2: true,
                y2: true,
                config: _this2._shapeConfig[d.key]
              });

              if (_this2._x2Config.scale !== "log") x2 = res2[0];
              if (_this2._y2Config.scale !== "log") y2 = res2[1];
            }
          });
        }

        xDomain = _x2.domain();
        x2Domain = x2.domain();
        yDomain = _y2.domain();
        y2Domain = y2.domain();
        var defaultConfig = {
          barConfig: {
            "stroke-width": 0
          },
          gridSize: 0,
          labels: [],
          title: false,
          tickSize: 0
        };
        var defaultX2Config = x2Exists ? {} : defaultConfig;
        var defaultY2Config = y2Exists ? {} : defaultConfig;
        var showX = this._discrete === "x" && this._width > this._discreteCutoff || this._width > this._xCutoff;
        var showY = this._discrete === "y" && this._height > this._discreteCutoff || this._height > this._yCutoff;
        var yC = {
          gridConfig: {
            stroke: !this._discrete || this._discrete === "x" ? this._yTest.gridConfig().stroke : "transparent"
          },
          locale: this._locale,
          scalePadding: _y2.padding ? _y2.padding() : 0
        };

        if (!showX) {
          yC.barConfig = {
            stroke: "transparent"
          };
          yC.tickSize = 0;
          yC.shapeConfig = {
            labelBounds: function labelBounds(d, i) {
              var _d$labelBounds = d.labelBounds,
                  width = _d$labelBounds.width,
                  y = _d$labelBounds.y;
              var height = _this2._height / 2;
              var x = i ? -height : 0;
              return {
                x: x,
                y: y,
                width: width,
                height: height
              };
            },
            labelConfig: {
              padding: 0,
              rotate: 0,
              verticalAlign: function verticalAlign(d) {
                return d.id === yTicks[0] ? "top" : "bottom";
              }
            },
            labelRotation: false
          };
        }

        var testGroup = elem("g.d3plus-plot-test", {
          enter: {
            opacity: 0
          },
          parent: this._select
        }),
            x2Ticks = this._discrete === "x" && !x2Time ? domains.x2 : undefined,
            xTicks = !showY ? extent(domains.x) : this._discrete === "x" && !xTime ? domains.x : undefined,
            y2Ticks = this._discrete === "y" && !y2Time ? domains.y2 : undefined,
            yTicks = !showX ? extent(domains.y) : this._discrete === "y" && !yTime ? domains.y : undefined;

        if (showY) {
          this._yTest.domain(yDomain).height(height).maxSize(width / 2).range([undefined, undefined]).scale(yScale.toLowerCase()).select(testGroup.node()).ticks(yTicks).width(width).config(yC).config(this._yConfig).render();
        }

        var yBounds = this._yTest.outerBounds();

        var yWidth = yBounds.width ? yBounds.width + this._yTest.padding() : undefined;

        if (y2Exists) {
          this._y2Test.domain(y2Domain).height(height).range([undefined, undefined]).scale(y2Scale.toLowerCase()).select(testGroup.node()).ticks(y2Ticks).width(width).config(yC).config(defaultY2Config).config(this._y2Config).render();
        }

        var y2Bounds = this._y2Test.outerBounds();

        var y2Width = y2Bounds.width ? y2Bounds.width + this._y2Test.padding() : undefined;
        var xC = {
          gridConfig: {
            stroke: !this._discrete || this._discrete === "y" ? this._xTest.gridConfig().stroke : "transparent"
          },
          locale: this._locale,
          scalePadding: _x2.padding ? _x2.padding() : 0
        };

        if (!showY) {
          xC.barConfig = {
            stroke: "transparent"
          };
          xC.tickSize = 0;
          xC.shapeConfig = {
            labelBounds: function labelBounds(d, i) {
              var _d$labelBounds2 = d.labelBounds,
                  height = _d$labelBounds2.height,
                  y = _d$labelBounds2.y;
              var width = _this2._width / 2;
              var x = i ? -width : 0;
              return {
                x: x,
                y: y,
                width: width,
                height: height
              };
            },
            labelConfig: {
              padding: 0,
              rotate: 0,
              textAnchor: function textAnchor(d) {
                return d.id === xTicks[0] ? "start" : "end";
              }
            },
            labelRotation: false
          };
        }

        if (showX) {
          this._xTest.domain(xDomain).height(height).maxSize(height / 2).range([undefined, undefined]).scale(xScale.toLowerCase()).select(testGroup.node()).ticks(xTicks).width(width).config(xC).config(this._xConfig).render();
        }

        if (x2Exists) {
          this._x2Test.domain(x2Domain).height(height).range([undefined, undefined]).scale(x2Scale.toLowerCase()).select(testGroup.node()).ticks(x2Ticks).width(width).config(xC).tickSize(0).config(defaultX2Config).config(this._x2Config).render();
        }

        var xTestRange = this._xTest._getRange();

        var x2TestRange = this._x2Test._getRange();

        var x2Bounds = this._x2Test.outerBounds();

        var x2Height = x2Exists ? x2Bounds.height + this._x2Test.padding() : 0;
        var xOffsetLeft = max([yWidth, xTestRange[0], x2TestRange[0]]);

        if (showX) {
          this._xTest.range([xOffsetLeft, undefined]).render();
        }

        var topOffset = showY ? this._yTest.shapeConfig().labelConfig.fontSize() / 2 : 0;
        var xOffsetRight = max([y2Width, width - xTestRange[1], width - x2TestRange[1]]);

        var xBounds = this._xTest.outerBounds();

        var xHeight = xBounds.height + (showY ? this._xTest.padding() : 0);
        this._padding.left += xOffsetLeft;
        this._padding.right += xOffsetRight;
        this._padding.bottom += xHeight;
        this._padding.top += x2Height + topOffset;

        _get$f(_getPrototypeOf$w(Plot.prototype), "_draw", this).call(this, callback);

        var horizontalMargin = this._margin.left + this._margin.right;
        var verticalMargin = this._margin.top + this._margin.bottom;
        var yRange = [x2Height, height - (xHeight + topOffset + verticalMargin)];

        if (showY) {
          this._yTest.domain(yDomain).height(height).maxSize(width / 2).range(yRange).scale(yScale.toLowerCase()).select(testGroup.node()).ticks(yTicks).width(width).config(yC).config(this._yConfig).render();
        }

        yBounds = this._yTest.outerBounds();
        yWidth = yBounds.width ? yBounds.width + this._yTest.padding() : undefined;
        xOffsetLeft = max([yWidth, xTestRange[0], x2TestRange[0]]);

        if (y2Exists) {
          this._y2Test.config(yC).domain(y2Domain).gridSize(0).height(height).range(yRange).scale(y2Scale.toLowerCase()).select(testGroup.node()).width(width - max([0, xOffsetRight - y2Width])).title(false).config(this._y2Config).config(defaultY2Config).render();
        }

        y2Bounds = this._y2Test.outerBounds();
        y2Width = y2Bounds.width ? y2Bounds.width + this._y2Test.padding() : undefined;
        xOffsetRight = max([0, y2Width, width - xTestRange[1], width - x2TestRange[1]]);
        var xRange = [xOffsetLeft, width - (xOffsetRight + horizontalMargin)];
        var rectGroup = elem("g.d3plus-plot-background", {
          parent: parent,
          transition: transition
        });
        var transform = "translate(".concat(this._margin.left, ", ").concat(this._margin.top + x2Height + topOffset, ")");
        var x2Transform = "translate(".concat(this._margin.left, ", ").concat(this._margin.top + topOffset, ")");
        var xGroup = showX && elem("g.d3plus-plot-x-axis", {
          parent: parent,
          transition: transition,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        });
        var x2Group = x2Exists && elem("g.d3plus-plot-x2-axis", {
          parent: parent,
          transition: transition,
          enter: {
            transform: x2Transform
          },
          update: {
            transform: x2Transform
          }
        });
        var xTrans = xOffsetLeft > yWidth ? xOffsetLeft - yWidth : 0;
        var yTransform = "translate(".concat(this._margin.left + xTrans, ", ").concat(this._margin.top + topOffset, ")");
        var yGroup = showY && elem("g.d3plus-plot-y-axis", {
          parent: parent,
          transition: transition,
          enter: {
            transform: yTransform
          },
          update: {
            transform: yTransform
          }
        });
        var y2Transform = "translate(-".concat(this._margin.right, ", ").concat(this._margin.top + topOffset, ")");
        var y2Group = y2Exists && elem("g.d3plus-plot-y2-axis", {
          parent: parent,
          transition: transition,
          enter: {
            transform: y2Transform
          },
          update: {
            transform: y2Transform
          }
        });

        this._xAxis.domain(xDomain).height(height - (x2Height + topOffset + verticalMargin)).maxSize(height / 2).range(xRange).scale(xScale.toLowerCase()).select(showX ? xGroup.node() : undefined).ticks(xTicks).width(width).config(xC).config(this._xConfig).render();

        if (x2Exists) {
          this._x2Axis.domain(x2Domain).height(height - (xHeight + topOffset + verticalMargin)).range(xRange).scale(x2Scale.toLowerCase()).select(x2Group.node()).ticks(x2Ticks).width(width).config(xC).config(defaultX2Config).config(this._x2Config).render();
        }

        _x2 = function x(d, _x) {
          if (_x === "x2") {
            if (_this2._x2Config.scale === "log" && d === 0) d = x2Domain[0] < 0 ? -1 : 1;
            return _this2._x2Axis._getPosition.bind(_this2._x2Axis)(d);
          } else {
            if (_this2._xConfig.scale === "log" && d === 0) d = xDomain[0] < 0 ? -1 : 1;
            return _this2._xAxis._getPosition.bind(_this2._xAxis)(d);
          }
        };

        yRange = [this._xAxis.outerBounds().y + x2Height, height - (xHeight + topOffset + verticalMargin)];

        this._yAxis.domain(yDomain).height(height).maxSize(width / 2).range(yRange).scale(yScale.toLowerCase()).select(showY ? yGroup.node() : undefined).ticks(yTicks).width(xRange[xRange.length - 1]).config(yC).config(this._yConfig).render();

        if (y2Exists) {
          this._y2Axis.config(yC).domain(y2Exists ? y2Domain : yDomain).gridSize(0).height(height).range(yRange).scale(y2Exists ? y2Scale.toLowerCase() : yScale.toLowerCase()).select(y2Group.node()).width(width - max([0, xOffsetRight - y2Width])).title(false).config(this._y2Config).config(defaultY2Config).render();
        }

        _y2 = function y(d, _y) {
          if (_y === "y2") {
            if (_this2._y2Config.scale === "log" && d === 0) d = y2Domain[0] < 0 ? -1 : 1;
            return _this2._y2Axis._getPosition.bind(_this2._y2Axis)(d) - x2Height;
          } else {
            if (_this2._yConfig.scale === "log" && d === 0) d = yDomain[0] < 0 ? -1 : 1;
            return _this2._yAxis._getPosition.bind(_this2._yAxis)(d) - x2Height;
          }
        };

        new Rect().data([{}]).select(rectGroup.node()).x(xRange[0] + (xRange[1] - xRange[0]) / 2).width(xRange[1] - xRange[0]).y(this._margin.top + topOffset + yRange[0] + (yRange[1] - yRange[0]) / 2).height(yRange[1] - yRange[0]).config(this._backgroundConfig).render();
        var annotationGroup = elem("g.d3plus-plot-annotations", {
          parent: parent,
          transition: transition,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        }).node();

        this._annotations.forEach(function (annotation) {
          new shapes$2[annotation.shape]().config(annotation).config({
            x: function x(d) {
              return d.x2 ? _x2(d.x2, "x2") : _x2(d.x);
            },
            x0: _this2._discrete === "x" ? function (d) {
              return d.x2 ? _x2(d.x2, "x2") : _x2(d.x);
            } : _x2(domains.x[0]),
            x1: _this2._discrete === "x" ? null : function (d) {
              return d.x2 ? _x2(d.x2, "x2") : _x2(d.x);
            },
            y: function y(d) {
              return d.y2 ? _y2(d.y2, "y2") : _y2(d.y);
            },
            y0: _this2._discrete === "y" ? function (d) {
              return d.y2 ? _y2(d.y2, "y2") : _y2(d.y);
            } : _y2(domains.y[1]) - yOffset,
            y1: _this2._discrete === "y" ? null : function (d) {
              return d.y2 ? _y2(d.y2, "y2") : _y2(d.y) - yOffset;
            }
          }).select(annotationGroup).render();
        });

        var yOffset = this._xAxis.barConfig()["stroke-width"];

        if (yOffset) yOffset /= 2;
        var discrete = this._discrete || "x";
        var shapeConfig = {
          duration: this._duration,
          label: function label(d) {
            return _this2._drawLabel(d.data, d.i);
          },
          select: elem("g.d3plus-plot-shapes", {
            parent: parent,
            transition: transition,
            enter: {
              transform: transform
            },
            update: {
              transform: transform
            }
          }).node(),
          x: function x(d) {
            return d.x2 ? _x2(d.x2, "x2") : _x2(d.x);
          },
          x0: discrete === "x" ? function (d) {
            return d.x2 ? _x2(d.x2, "x2") : _x2(d.x);
          } : _x2(typeof this._baseline === "number" ? this._baseline : domains.x[0]),
          x1: discrete === "x" ? null : function (d) {
            return d.x2 ? _x2(d.x2, "x2") : _x2(d.x);
          },
          y: function y(d) {
            return d.y2 ? _y2(d.y2, "y2") : _y2(d.y);
          },
          y0: discrete === "y" ? function (d) {
            return d.y2 ? _y2(d.y2, "y2") : _y2(d.y);
          } : _y2(typeof this._baseline === "number" ? this._baseline : domains.y[1]) - yOffset,
          y1: discrete === "y" ? null : function (d) {
            return d.y2 ? _y2(d.y2, "y2") : _y2(d.y) - yOffset;
          }
        };

        if (this._stacked) {
          var scale = opp === "x" ? _x2 : _y2;

          shapeConfig["".concat(opp)] = shapeConfig["".concat(opp, "0")] = function (d) {
            var dataIndex = stackKeys.indexOf(d.id),
                discreteIndex = discreteKeys.indexOf(d.discrete);
            return dataIndex >= 0 ? scale(stackData[dataIndex][discreteIndex][0]) : scale(domains[opp][opp === "x" ? 0 : 1]);
          };

          shapeConfig["".concat(opp, "1")] = function (d) {
            var dataIndex = stackKeys.indexOf(d.id),
                discreteIndex = discreteKeys.indexOf(d.discrete);
            return dataIndex >= 0 ? scale(stackData[dataIndex][discreteIndex][1]) : scale(domains[opp][opp === "x" ? 0 : 1]);
          };
        }

        var events = Object.keys(this._on);
        shapeData.forEach(function (d) {
          var s = new shapes$2[d.key]().config(shapeConfig).data(d.values);

          if (d.key === "Bar") {
            var space;

            var _scale = _this2._discrete === "x" ? _x2 : _y2;

            var scaleType = _this2._discrete === "x" ? xScale : yScale;
            var vals = _this2._discrete === "x" ? xDomain : yDomain;

            var _range = _this2._discrete === "x" ? xRange : yRange;

            if (scaleType !== "Point" && vals.length === 2) {
              space = (_scale(d.values[_this2._discrete === "x" ? 0 : d.values.length - 1][_this2._discrete]) - _scale(vals[0])) * 2;
            } else if (vals.length > 1) space = _scale(vals[1]) - _scale(vals[0]);else space = _range[_range.length - 1] - _range[0];

            if (_this2._groupPadding < space) space -= _this2._groupPadding;
            var barSize = space || 1;
            var groups = nest().key(function (d) {
              return d[_this2._discrete];
            }).key(function (d) {
              return d.group;
            }).entries(d.values);
            var ids = merge(groups.map(function (d) {
              return d.values.map(function (v) {
                return v.key;
              });
            }));
            var uniqueIds = Array.from(new Set(ids));

            if (max(groups.map(function (d) {
              return d.values.length;
            })) === 1) {
              s[_this2._discrete](function (d, i) {
                return shapeConfig[_this2._discrete](d, i);
              });
            } else {
              barSize = (barSize - _this2._barPadding * uniqueIds.length - 1) / uniqueIds.length;
              var offset = space / 2 - barSize / 2;
              var xMod = linear$1().domain([0, uniqueIds.length - 1]).range([-offset, offset]);

              s[_this2._discrete](function (d, i) {
                return shapeConfig[_this2._discrete](d, i) + xMod(uniqueIds.indexOf(d.group));
              });
            }

            s.width(barSize);
            s.height(barSize);
          } else if (d.key === "Line") {
            s.duration(width * 1.5);

            if (_this2._confidence) {
              var areaConfig = Object.assign({}, shapeConfig);

              var _discrete2 = _this2._discrete || "x";

              var key = _discrete2 === "x" ? "y" : "x";
              var scaleFunction = _discrete2 === "x" ? _y2 : _x2;

              areaConfig["".concat(key, "0")] = function (d) {
                return scaleFunction(_this2._confidence[0] ? d.lci : d[key]);
              };

              areaConfig["".concat(key, "1")] = function (d) {
                return scaleFunction(_this2._confidence[1] ? d.hci : d[key]);
              };

              var area = new Area().config(areaConfig).data(d.values);
              var confidenceConfig = Object.assign(_this2._shapeConfig, _this2._confidenceConfig);
              area.config(configPrep.bind(_this2)(confidenceConfig, "shape", "Area")).render();

              _this2._shapes.push(area);
            }
          }

          var classEvents = events.filter(function (e) {
            return e.includes(".".concat(d.key));
          }),
              globalEvents = events.filter(function (e) {
            return !e.includes(".");
          }),
              shapeEvents = events.filter(function (e) {
            return e.includes(".shape");
          });

          var _loop = function _loop(e) {
            s.on(globalEvents[e], function (d) {
              return _this2._on[globalEvents[e]](d.data, d.i);
            });
          };

          for (var e = 0; e < globalEvents.length; e++) {
            _loop(e);
          }

          var _loop2 = function _loop2(e) {
            s.on(shapeEvents[e], function (d) {
              return _this2._on[shapeEvents[e]](d.data, d.i);
            });
          };

          for (var e = 0; e < shapeEvents.length; e++) {
            _loop2(e);
          }

          var _loop3 = function _loop3(e) {
            s.on(classEvents[e], function (d) {
              return _this2._on[classEvents[e]](d.data, d.i);
            });
          };

          for (var e = 0; e < classEvents.length; e++) {
            _loop3(e);
          }

          var userConfig = configPrep.bind(_this2)(_this2._shapeConfig, "shape", d.key);
          if (_this2._shapeConfig.duration === undefined) delete userConfig.duration;
          s.config(userConfig).render();

          _this2._shapes.push(s);
        });
        return this;
      }
      /**
          @memberof Plot
          @desc Allows drawing custom shapes to be used as annotations in the provided x/y plot. This method accepts custom config objects for the [Shape](http://d3plus.org/docs/#Shape) class, either a single config object or an array of config objects. Each config object requires an additional parameter, the "shape", which denotes which [Shape](http://d3plus.org/docs/#Shape) sub-class to use ([Rect](http://d3plus.org/docs/#Rect), [Line](http://d3plus.org/docs/#Line), etc). Annotations will be drawn underneath the data to be displayed.
          @param {Array|Object} *annotations* = []
          @chainable
      */

    }, {
      key: "annotations",
      value: function annotations(_) {
        return arguments.length ? (this._annotations = _ instanceof Array ? _ : [_], this) : this._annotations;
      }
      /**
           @memberof Plot
           @desc A d3plus-shape configuration Object used for styling the background rectangle of the inner x/y plot (behind all of the shapes and gridlines).
           @param {Object} [*value*]
           @chainable
       */

    }, {
      key: "backgroundConfig",
      value: function backgroundConfig(_) {
        return arguments.length ? (this._backgroundConfig = assign(this._backgroundConfig, _), this) : this._backgroundConfig;
      }
      /**
          @memberof Plot
          @desc Sets the pixel space between each bar in a group of bars.
          @param {Number} *value* = 0
          @chainable
      */

    }, {
      key: "barPadding",
      value: function barPadding(_) {
        return arguments.length ? (this._barPadding = _, this) : this._barPadding;
      }
      /**
          @memberof Plot
          @desc Sets the baseline for the x/y plot. If *value* is not specified, returns the current baseline.
          @param {Number} *value*
          @chainable
      */

    }, {
      key: "baseline",
      value: function baseline(_) {
        return arguments.length ? (this._baseline = _, this) : this._baseline;
      }
      /**
           @memberof Plot
           @desc Sets the confidence to the specified array of lower and upper bounds.
           @param {String[]|Function[]} *value*
           @chainable
           @example <caption>Can be called with accessor functions or static keys:</caption>
           var data = {id: "alpha", value: 10, lci: 9, hci: 11};
           ...
           // Accessor functions
           .confidence([function(d) { return d.lci }, function(d) { return d.hci }])
            // Or static keys
           .confidence(["lci", "hci"])
       */

    }, {
      key: "confidence",
      value: function confidence(_) {
        if (arguments.length && _ instanceof Array) {
          this._confidence = [];
          var lower = _[0];
          this._confidence[0] = typeof lower === "function" || !lower ? lower : accessor(lower);
          var upper = _[1];
          this._confidence[1] = typeof upper === "function" || !upper ? upper : accessor(upper);
          return this;
        } else return this._confidence;
      }
      /**
           @memberof Plot
           @desc If *value* is specified, sets the config method for each shape rendered as a confidence interval and returns the current class instance.
           @param {Object} [*value*]
           @chainable
       */

    }, {
      key: "confidenceConfig",
      value: function confidenceConfig(_) {
        return arguments.length ? (this._confidenceConfig = assign(this._confidenceConfig, _), this) : this._confidenceConfig;
      }
      /**
          @memberof Plot
          @desc Sets the discrete axis to the specified string. If *value* is not specified, returns the current discrete axis.
          @param {String} *value*
          @chainable
      */

    }, {
      key: "discrete",
      value: function discrete(_) {
        return arguments.length ? (this._discrete = _, this) : this._discrete;
      }
      /**
          @memberof Plot
          @desc When the width or height of the chart is less than or equal to this pixel value, the discrete axis will not be shown. This helps produce slick sparklines. Set this value to `0` to disable the behavior entirely.
          @param {Number} *value*
          @chainable
      */

    }, {
      key: "discreteCutoff",
      value: function discreteCutoff(_) {
        return arguments.length ? (this._discreteCutoff = _, this) : this._discreteCutoff;
      }
      /**
          @memberof Plot
          @desc Sets the pixel space between groups of bars.
          @param {Number} [*value* = 5]
          @chainable
      */

    }, {
      key: "groupPadding",
      value: function groupPadding(_) {
        return arguments.length ? (this._groupPadding = _, this) : this._groupPadding;
      }
      /**
          @memberof Plot
          @desc A JavaScript [sort comparator function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort) that receives each shape Class (ie. "Circle", "Line", etc) as it's comparator arguments. Shapes are drawn in groups based on their type, so you are defining the layering order for all shapes of said type.
          @param {Function} *value*
          @chainable
      */

    }, {
      key: "shapeSort",
      value: function shapeSort(_) {
        return arguments.length ? (this._shapeSort = _, this) : this._shapeSort;
      }
      /**
          @memberof Plot
          @desc Sets the size of bubbles to the given Number, data key, or function.
          @param {Function|Number|String} *value* = 10
          @chainable
      */

    }, {
      key: "size",
      value: function size(_) {
        return arguments.length ? (this._size = typeof _ === "function" || !_ ? _ : accessor(_), this) : this._size;
      }
      /**
          @memberof Plot
          @desc Sets the size scale maximum to the specified number.
          @param {Number} *value* = 20
          @chainable
      */

    }, {
      key: "sizeMax",
      value: function sizeMax(_) {
        return arguments.length ? (this._sizeMax = _, this) : this._sizeMax;
      }
      /**
          @memberof Plot
          @desc Sets the size scale minimum to the specified number.
          @param {Number} *value* = 5
          @chainable
      */

    }, {
      key: "sizeMin",
      value: function sizeMin(_) {
        return arguments.length ? (this._sizeMin = _, this) : this._sizeMin;
      }
      /**
          @memberof Plot
          @desc Sets the size scale to the specified string.
          @param {String} *value* = "sqrt"
          @chainable
      */

    }, {
      key: "sizeScale",
      value: function sizeScale(_) {
        return arguments.length ? (this._sizeScale = _, this) : this._sizeScale;
      }
      /**
          @memberof Plot
          @desc If *value* is specified, toggles shape stacking. If *value* is not specified, returns the current stack value.
          @param {Boolean} *value* = false
          @chainable
      */

    }, {
      key: "stacked",
      value: function stacked(_) {
        return arguments.length ? (this._stacked = _, this) : this._stacked;
      }
      /**
          @memberof Plot
          @desc Sets the stack offset. If *value* is not specified, returns the current stack offset function.
          @param {Function|String} *value* = "descending"
          @chainable
      */

    }, {
      key: "stackOffset",
      value: function stackOffset(_) {
        return arguments.length ? (this._stackOffset = typeof _ === "function" ? _ : d3Shape["stackOffset".concat(_.charAt(0).toUpperCase() + _.slice(1))], this) : this._stackOffset;
      }
      /**
          @memberof Plot
          @desc Sets the stack order. If *value* is not specified, returns the current stack order function.
          @param {Function|String|Array} *value* = "none"
          @chainable
      */

    }, {
      key: "stackOrder",
      value: function stackOrder(_) {
        if (arguments.length) {
          if (typeof _ === "string") this._stackOrder = _ === "ascending" ? stackOrderAscending : _ === "descending" ? stackOrderDescending : d3Shape["stackOrder".concat(_.charAt(0).toUpperCase() + _.slice(1))];else this._stackOrder = _;
          return this;
        } else return this._stackOrder;
      }
      /**
          @memberof Plot
          @desc Sets the x accessor to the specified function or number. If *value* is not specified, returns the current x accessor.
          @param {Function|Number} *value*
          @chainable
      */

    }, {
      key: "x",
      value: function x(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._x = _;else {
            this._x = accessor(_);

            if (!this._aggs[_] && this._discrete === "x") {
              this._aggs[_] = function (a) {
                var v = Array.from(new Set(a));
                return v.length === 1 ? v[0] : v;
              };
            }
          }
          return this;
        } else return this._x;
      }
      /**
           @memberof Plot
           @desc Sets the x2 accessor to the specified function or number. If *value* is not specified, returns the current x2 accessor.
           @param {Function|Number} *value*
           @chainable
       */

    }, {
      key: "x2",
      value: function x2(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._x2 = _;else {
            this._x2 = accessor(_);

            if (!this._aggs[_] && this._discrete === "x") {
              this._aggs[_] = function (a) {
                var v = Array.from(new Set(a));
                return v.length === 1 ? v[0] : v;
              };
            }
          }
          return this;
        } else return this._x2;
      }
      /**
          @memberof Plot
          @desc Sets the config method for the x-axis. If *value* is not specified, returns the current x-axis configuration.
          @param {Object} *value*
          @chainable
      */

    }, {
      key: "xConfig",
      value: function xConfig(_) {
        return arguments.length ? (this._xConfig = assign(this._xConfig, _), this) : this._xConfig;
      }
      /**
          @memberof Plot
          @desc When the width of the chart is less than or equal to this pixel value, and the x-axis is not the discrete axis, it will not be shown. This helps produce slick sparklines. Set this value to `0` to disable the behavior entirely.
          @param {Number} *value*
          @chainable
      */

    }, {
      key: "xCutoff",
      value: function xCutoff(_) {
        return arguments.length ? (this._xCutoff = _, this) : this._xCutoff;
      }
      /**
          @memberof Plot
          @desc Sets the config method for the secondary x-axis. If *value* is not specified, returns the current secondary x-axis configuration.
          @param {Object} *value*
          @chainable
      */

    }, {
      key: "x2Config",
      value: function x2Config(_) {
        return arguments.length ? (this._x2Config = assign(this._x2Config, _), this) : this._x2Config;
      }
      /**
          @memberof Plot
          @desc Sets the x domain to the specified array. If *value* is not specified, returns the current x domain. Additionally, if either value of the array is undefined, it will be calculated from the data.
          @param {Array} *value*
          @chainable
      */

    }, {
      key: "xDomain",
      value: function xDomain(_) {
        return arguments.length ? (this._xDomain = _, this) : this._xDomain;
      }
      /**
           @memberof Plot
           @desc Sets the x2 domain to the specified array. If *value* is not specified, returns the current x2 domain. Additionally, if either value of the array is undefined, it will be calculated from the data.
           @param {Array} *value*
           @chainable
       */

    }, {
      key: "x2Domain",
      value: function x2Domain(_) {
        return arguments.length ? (this._x2Domain = _, this) : this._x2Domain;
      }
      /**
          @memberof Plot
          @desc Defines a custom sorting comparitor function to be used for discrete x axes.
          @param {Function} *value*
          @chainable
      */

    }, {
      key: "xSort",
      value: function xSort(_) {
        return arguments.length ? (this._xSort = _, this) : this._xSort;
      }
      /**
           @memberof Plot
           @desc Defines a custom sorting comparitor function to be used for discrete x2 axes.
           @param {Function} *value*
           @chainable
       */

    }, {
      key: "x2Sort",
      value: function x2Sort(_) {
        return arguments.length ? (this._x2Sort = _, this) : this._x2Sort;
      }
      /**
          @memberof Plot
          @desc Sets the y accessor to the specified function or number. If *value* is not specified, returns the current y accessor.
          @param {Function|Number} *value*
          @chainable
      */

    }, {
      key: "y",
      value: function y(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._y = _;else {
            this._y = accessor(_);

            if (!this._aggs[_] && this._discrete === "y") {
              this._aggs[_] = function (a) {
                var v = Array.from(new Set(a));
                return v.length === 1 ? v[0] : v;
              };
            }
          }
          return this;
        } else return this._y;
      }
      /**
           @memberof Plot
           @desc Sets the y2 accessor to the specified function or number. If *value* is not specified, returns the current y2 accessor.
           @param {Function|Number} *value*
           @chainable
       */

    }, {
      key: "y2",
      value: function y2(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._y2 = _;else {
            this._y2 = accessor(_);

            if (!this._aggs[_] && this._discrete === "y2") {
              this._aggs[_] = function (a) {
                var v = Array.from(new Set(a));
                return v.length === 1 ? v[0] : v;
              };
            }
          }
          return this;
        } else return this._y2;
      }
      /**
          @memberof Plot
          @desc Sets the config method for the y-axis. If *value* is not specified, returns the current y-axis configuration.
      *Note:* If a "domain" array is passed to the y-axis config, it will be reversed.
          @param {Object} *value*
          @chainable
      */

    }, {
      key: "yConfig",
      value: function yConfig(_) {
        if (arguments.length) {
          if (_.domain) _.domain = _.domain.slice().reverse();
          this._yConfig = assign(this._yConfig, _);
          return this;
        }

        return this._yConfig;
      }
      /**
          @memberof Plot
          @desc When the height of the chart is less than or equal to this pixel value, and the y-axis is not the discrete axis, it will not be shown. This helps produce slick sparklines. Set this value to `0` to disable the behavior entirely.
          @param {Number} *value*
          @chainable
      */

    }, {
      key: "yCutoff",
      value: function yCutoff(_) {
        return arguments.length ? (this._yCutoff = _, this) : this._yCutoff;
      }
      /**
          @memberof Plot
          @desc Sets the config method for the secondary y-axis. If *value* is not specified, returns the current secondary y-axis configuration.
          @param {Object} *value*
          @chainable
      */

    }, {
      key: "y2Config",
      value: function y2Config(_) {
        return arguments.length ? (this._y2Config = assign(this._y2Config, _), this) : this._y2Config;
      }
      /**
          @memberof Plot
          @desc Sets the y domain to the specified array. If *value* is not specified, returns the current y domain. Additionally, if either value of the array is undefined, it will be calculated from the data.
          @param {Array} *value*
          @chainable
      */

    }, {
      key: "yDomain",
      value: function yDomain(_) {
        return arguments.length ? (this._yDomain = _, this) : this._yDomain;
      }
      /**
           @memberof Plot
           @desc Sets the y2 domain to the specified array. If *value* is not specified, returns the current y2 domain. Additionally, if either value of the array is undefined, it will be calculated from the data.
           @param {Array} *value*
           @chainable
       */

    }, {
      key: "y2Domain",
      value: function y2Domain(_) {
        return arguments.length ? (this._y2Domain = _, this) : this._y2Domain;
      }
      /**
          @memberof Plot
          @desc Defines a custom sorting comparitor function to be used for discrete y axes.
          @param {Function} *value*
          @chainable
      */

    }, {
      key: "ySort",
      value: function ySort(_) {
        return arguments.length ? (this._ySort = _, this) : this._ySort;
      }
      /**
           @memberof Plot
           @desc Defines a custom sorting comparitor function to be used for discrete y2 axes.
           @param {Function} *value*
           @chainable
       */

    }, {
      key: "y2Sort",
      value: function y2Sort(_) {
        return arguments.length ? (this._y2Sort = _, this) : this._y2Sort;
      }
    }]);

    return Plot;
  }(Viz);

  function _typeof$B(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$B = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$B = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$B(obj);
  }

  function _classCallCheck$A(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$x(self, call) {
    if (call && (_typeof$B(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$x(self);
  }

  function _assertThisInitialized$x(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$x(o) {
    _getPrototypeOf$x = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$x(o);
  }

  function _inherits$x(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$x(subClass, superClass);
  }

  function _setPrototypeOf$x(o, p) {
    _setPrototypeOf$x = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$x(o, p);
  }
  /**
      @class AreaPlot
      @extends Plot
      @desc Creates an area plot based on an array of data.
      @example <caption>the equivalent of calling:</caption>
  new d3plus.Plot()
    .baseline(0)
    .discrete("x")
    .shape("Area")
  */

  var AreaPlot =
  /*#__PURE__*/
  function (_Plot) {
    _inherits$x(AreaPlot, _Plot);
    /**
        @memberof AreaPlot
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Plot.
        @private
    */


    function AreaPlot() {
      var _this;

      _classCallCheck$A(this, AreaPlot);

      _this = _possibleConstructorReturn$x(this, _getPrototypeOf$x(AreaPlot).call(this));
      _this._baseline = 0;
      _this._discrete = "x";
      _this._shape = constant$3("Area");

      _this.x("x");

      return _this;
    }

    return AreaPlot;
  }(Plot);

  function _typeof$C(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$C = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$C = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$C(obj);
  }

  function _classCallCheck$B(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$y(self, call) {
    if (call && (_typeof$C(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$y(self);
  }

  function _assertThisInitialized$y(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$y(o) {
    _getPrototypeOf$y = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$y(o);
  }

  function _inherits$y(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$y(subClass, superClass);
  }

  function _setPrototypeOf$y(o, p) {
    _setPrototypeOf$y = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$y(o, p);
  }
  /**
      @class BarChart
      @extends Plot
      @desc Creates a bar chart based on an array of data.
      @example <caption>the equivalent of calling:</caption>
  new d3plus.Plot()
    .baseline(0)
    .discrete("x")
    .shape("Bar")
  */

  var BarChart =
  /*#__PURE__*/
  function (_Plot) {
    _inherits$y(BarChart, _Plot);
    /**
        @memberof BarChart
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Plot.
        @private
    */


    function BarChart() {
      var _this;

      _classCallCheck$B(this, BarChart);

      _this = _possibleConstructorReturn$y(this, _getPrototypeOf$y(BarChart).call(this));
      _this._baseline = 0;
      _this._discrete = "x";
      _this._shape = constant$3("Bar");

      _this.x("x");

      return _this;
    }

    return BarChart;
  }(Plot);

  function _typeof$D(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$D = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$D = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$D(obj);
  }

  function _classCallCheck$C(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$z(self, call) {
    if (call && (_typeof$D(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$z(self);
  }

  function _assertThisInitialized$z(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$z(o) {
    _getPrototypeOf$z = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$z(o);
  }

  function _inherits$z(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$z(subClass, superClass);
  }

  function _setPrototypeOf$z(o, p) {
    _setPrototypeOf$z = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$z(o, p);
  }
  /**
      @class LinePlot
      @extends Plot
      @desc Creates a line plot based on an array of data.
      @example <caption>the equivalent of calling:</caption>
  new d3plus.Plot()
    .discrete("x")
    .shape("Line")
  */

  var LinePlot =
  /*#__PURE__*/
  function (_Plot) {
    _inherits$z(LinePlot, _Plot);
    /**
        @memberof LinePlot
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Plot.
        @private
    */


    function LinePlot() {
      var _this;

      _classCallCheck$C(this, LinePlot);

      _this = _possibleConstructorReturn$z(this, _getPrototypeOf$z(LinePlot).call(this));
      _this._shape = constant$3("Line");
      return _this;
    }

    return LinePlot;
  }(Plot);

  function _typeof$E(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$E = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$E = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$E(obj);
  }

  function _classCallCheck$D(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _possibleConstructorReturn$A(self, call) {
    if (call && (_typeof$E(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$A(self);
  }

  function _assertThisInitialized$A(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _getPrototypeOf$A(o) {
    _getPrototypeOf$A = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$A(o);
  }

  function _inherits$A(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$A(subClass, superClass);
  }

  function _setPrototypeOf$A(o, p) {
    _setPrototypeOf$A = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$A(o, p);
  }
  /**
      @class StackedArea
      @extends Area
      @desc Creates a stacked area plot based on an array of data.
      @example <caption>the equivalent of calling:</caption>
  new d3plus.AreaPlot()
    .stacked(true)
  */

  var StackedArea =
  /*#__PURE__*/
  function (_AreaPlot) {
    _inherits$A(StackedArea, _AreaPlot);
    /**
        @memberof StackedArea
        @desc Invoked when creating a new class instance, and overrides any default parameters inherited from Plot.
        @private
    */


    function StackedArea() {
      var _this;

      _classCallCheck$D(this, StackedArea);

      _this = _possibleConstructorReturn$A(this, _getPrototypeOf$A(StackedArea).call(this));
      _this._stacked = true;
      return _this;
    }

    return StackedArea;
  }(AreaPlot);

  function _typeof$F(obj) {
    if (typeof Symbol === "function" && _typeof(Symbol.iterator) === "symbol") {
      _typeof$F = function _typeof$1(obj) {
        return _typeof(obj);
      };
    } else {
      _typeof$F = function _typeof$1(obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof(obj);
      };
    }

    return _typeof$F(obj);
  }

  function _classCallCheck$E(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$v(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$v(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$v(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$v(Constructor, staticProps);
    return Constructor;
  }

  function _possibleConstructorReturn$B(self, call) {
    if (call && (_typeof$F(call) === "object" || typeof call === "function")) {
      return call;
    }

    return _assertThisInitialized$B(self);
  }

  function _assertThisInitialized$B(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _get$g(target, property, receiver) {
    if (typeof Reflect !== "undefined" && Reflect.get) {
      _get$g = Reflect.get;
    } else {
      _get$g = function _get(target, property, receiver) {
        var base = _superPropBase$g(target, property);

        if (!base) return;
        var desc = Object.getOwnPropertyDescriptor(base, property);

        if (desc.get) {
          return desc.get.call(receiver);
        }

        return desc.value;
      };
    }

    return _get$g(target, property, receiver || target);
  }

  function _superPropBase$g(object, property) {
    while (!Object.prototype.hasOwnProperty.call(object, property)) {
      object = _getPrototypeOf$B(object);
      if (object === null) break;
    }

    return object;
  }

  function _getPrototypeOf$B(o) {
    _getPrototypeOf$B = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$B(o);
  }

  function _inherits$B(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    if (superClass) _setPrototypeOf$B(subClass, superClass);
  }

  function _setPrototypeOf$B(o, p) {
    _setPrototypeOf$B = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$B(o, p);
  }
  /**
      @class Priestley
      @extends external:Viz
      @desc Creates a priestley timeline based on an array of data.
  */

  var Priestley =
  /*#__PURE__*/
  function (_Viz) {
    _inherits$B(Priestley, _Viz);
    /**
        @memberof Priestley
        @desc Invoked when creating a new class instance, and sets any default parameters.
        @private
    */


    function Priestley() {
      var _this;

      _classCallCheck$E(this, Priestley);

      _this = _possibleConstructorReturn$B(this, _getPrototypeOf$B(Priestley).call(this));
      _this._axis = new Axis().align("end").orient("bottom");
      _this._axisConfig = {
        scale: "time"
      };
      _this._axisTest = new Axis().align("end").gridSize(0).orient("bottom");

      _this.end("end");

      _this._shapeConfig = assign({}, _this._shapeConfig, {
        ariaLabel: function ariaLabel(d, i) {
          return "".concat(_this._drawLabel(d, i), ", ").concat(_this._start(d, i), " - ").concat(_this._end(d, i), ".");
        }
      });

      _this.start("start");

      return _this;
    }
    /**
        @memberof Priestley
        @desc Extends the render behavior of the abstract Viz class.
        @private
    */


    _createClass$v(Priestley, [{
      key: "render",
      value: function render(callback) {
        var _this2 = this;

        _get$g(_getPrototypeOf$B(Priestley.prototype), "render", this).call(this, callback);

        if (!this._filteredData) return this;

        var data = this._filteredData.map(function (data, i) {
          return {
            __d3plus__: true,
            data: data,
            end: _this2._axisConfig.scale === "time" ? date$2(_this2._end(data, i)) : _this2._end(data, i),
            i: i,
            id: _this2._id(data, i),
            start: _this2._axisConfig.scale === "time" ? date$2(_this2._start(data, i)) : _this2._start(data, i)
          };
        }).filter(function (d) {
          return d.end - d.start > 0;
        }).sort(function (a, b) {
          return a.start - b.start;
        });

        var nestedData;

        if (this._groupBy.length > 1 && this._drawDepth > 0) {
          var dataNest = nest();

          var _loop = function _loop(i) {
            dataNest.key(function (d) {
              return _this2._groupBy[i](d.data, d.i);
            });
          };

          for (var i = 0; i < this._drawDepth; i++) {
            _loop(i);
          }

          nestedData = dataNest.entries(data);
        } else nestedData = [{
          values: data
        }];

        var maxLane = 0;
        nestedData.forEach(function (g) {
          var track = [];
          g.values.forEach(function (d) {
            track = track.map(function (t) {
              return t <= d.start ? false : t;
            });
            var i = track.indexOf(false);

            if (i < 0) {
              d.lane = maxLane + track.length;
              track.push(d.end);
            } else {
              track[i] = d.end;
              d.lane = maxLane + i;
            }
          });
          maxLane += track.length;
        });
        var axisConfig = {
          domain: [min(data, function (d) {
            return d.start;
          }) || 0, max(data, function (d) {
            return d.end;
          }) || 0],
          height: this._height - this._margin.top - this._margin.bottom,
          width: this._width - this._margin.left - this._margin.right
        };
        var transform = "translate(".concat(this._margin.left, ", ").concat(this._margin.top, ")");

        this._axisTest.config(axisConfig).config(this._axisConfig).select(elem("g.d3plus-priestley-axis-test", {
          parent: this._select,
          enter: {
            opacity: 0
          }
        }).node()).render();

        this._axis.config(axisConfig).config(this._axisConfig).select(elem("g.d3plus-priestley-axis", {
          parent: this._select,
          enter: {
            transform: transform
          },
          update: {
            transform: transform
          }
        }).node()).render();

        var axisPad = this._axisTest._padding;
        var xScale = this._axis._d3Scale;
        var yScale = point().domain(range(0, maxLane, 1)).padding(0.5).rangeRound([this._height - this._margin.bottom - this._axisTest.outerBounds().height - axisPad, this._margin.top + axisPad]);
        var step = yScale.step();

        this._shapes.push(new Rect().data(data).duration(this._duration).height(step >= this._padding * 2 ? step - this._padding : step > 2 ? step - 2 : step).label(function (d, i) {
          return _this2._drawLabel(d.data, i);
        }).select(elem("g.d3plus-priestley-shapes", {
          parent: this._select
        }).node()).width(function (d) {
          var w = Math.abs(xScale(d.end) - xScale(d.start));
          return w > 2 ? w - 2 : w;
        }).x(function (d) {
          return xScale(d.start) + (xScale(d.end) - xScale(d.start)) / 2;
        }).y(function (d) {
          return yScale(d.lane);
        }).config(configPrep.bind(this)(this._shapeConfig, "shape", "Rect")).render());

        return this;
      }
      /**
          @memberof Priestley
          @desc If *value* is specified, sets the config method for the axis and returns the current class instance. If *value* is not specified, returns the current axis configuration.
          @param {Object} [*value*]
          @chainable
      */

    }, {
      key: "axisConfig",
      value: function axisConfig(_) {
        return arguments.length ? (this._axisConfig = assign(this._axisConfig, _), this) : this._axisConfig;
      }
      /**
          @memberof Priestley
          @desc If *value* is specified, sets the end accessor to the specified function or key and returns the current class instance. If *value* is not specified, returns the current end accessor.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "end",
      value: function end(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._end = _;else {
            this._end = accessor(_);
            if (!this._aggs[_]) this._aggs[_] = function (a) {
              return max(a);
            };
          }
          return this;
        } else return this._end;
      }
      /**
          @memberof Priestley
          @desc If *value* is specified, sets the start accessor to the specified function or key and returns the current class instance. If *value* is not specified, returns the current start accessor.
          @param {Function|String} [*value*]
          @chainable
      */

    }, {
      key: "start",
      value: function start(_) {
        if (arguments.length) {
          if (typeof _ === "function") this._start = _;else {
            this._start = accessor(_);
            if (!this._aggs[_]) this._aggs[_] = function (a) {
              return min(a);
            };
          }
          return this;
        } else return this._start;
      }
    }]);

    return Priestley;
  }(Viz);

  exports.Area = Area;
  exports.AreaPlot = AreaPlot;
  exports.Axis = Axis;
  exports.AxisBottom = AxisBottom;
  exports.AxisLeft = AxisLeft;
  exports.AxisRight = AxisRight;
  exports.AxisTop = AxisTop;
  exports.Bar = Bar;
  exports.BarChart = BarChart;
  exports.BaseClass = BaseClass;
  exports.Box = Box;
  exports.Circle = Circle;
  exports.ColorScale = ColorScale;
  exports.Donut = Donut;
  exports.Geomap = Geomap;
  exports.Image = Image$1;
  exports.Legend = Legend;
  exports.Line = Line;
  exports.LinePlot = LinePlot;
  exports.Network = Network;
  exports.Pack = Pack;
  exports.Path = Path$1;
  exports.Pie = Pie;
  exports.Plot = Plot;
  exports.Priestley = Priestley;
  exports.Rect = Rect;
  exports.Rings = Rings;
  exports.Sankey = Sankey;
  exports.Shape = Shape;
  exports.StackedArea = StackedArea;
  exports.TextBox = TextBox;
  exports.Timeline = Timeline;
  exports.Tooltip = Tooltip;
  exports.Tree = Tree;
  exports.Treemap = Treemap;
  exports.Viz = Viz;
  exports.Whisker = Whisker;
  exports.accessor = accessor;
  exports.assign = assign;
  exports.attrize = attrize;
  exports.ckmeans = ckmeans;
  exports.closest = closest;
  exports.colorAdd = add;
  exports.colorAssign = colorAssign;
  exports.colorContrast = colorContrast;
  exports.colorDefaults = defaults;
  exports.colorLegible = colorLegible;
  exports.colorLighter = colorLighter;
  exports.colorSubtract = subtract;
  exports.configPrep = configPrep;
  exports.constant = constant$3;
  exports.dataFold = fold;
  exports.dataLoad = load;
  exports.date = date$2;
  exports.elem = elem;
  exports.fontExists = fontExists;
  exports.formatAbbreviate = formatAbbreviate;
  exports.formatLocale = formatLocale$2;
  exports.isObject = isObject;
  exports.largestRect = largestRect;
  exports.lineIntersection = lineIntersection;
  exports.merge = objectMerge;
  exports.parseSides = parseSides;
  exports.path2polygon = path2polygon;
  exports.pointDistance = pointDistance;
  exports.pointDistanceSquared = pointDistanceSquared;
  exports.pointRotate = pointRotate;
  exports.polygonInside = polygonInside;
  exports.polygonRayCast = polygonRayCast;
  exports.polygonRotate = polygonRotate;
  exports.prefix = prefix$1;
  exports.rtl = detectRTL;
  exports.segmentBoxContains = segmentBoxContains;
  exports.segmentsIntersect = segmentsIntersect;
  exports.shapeEdgePoint = shapeEdgePoint;
  exports.simplify = simplify;
  exports.stringify = stringify;
  exports.strip = strip;
  exports.stylize = stylize;
  exports.textSplit = textSplit;
  exports.textWidth = textWidth;
  exports.textWrap = textWrap;
  exports.titleCase = titleCase;
  exports.trim = trim;
  exports.trimLeft = trimLeft;
  exports.trimRight = trimRight;
  exports.uuid = uuid;
  exports.version = version;

  Object.defineProperty(exports, '__esModule', { value: true });

})));
//# sourceMappingURL=d3plus.full.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./src/app/data-transfer.service.ts":
/*!******************************************!*\
  !*** ./src/app/data-transfer.service.ts ***!
  \******************************************/
/*! exports provided: DataTransferService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DataTransferService", function() { return DataTransferService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm5/index.js");



var DataTransferService = /** @class */ (function () {
    function DataTransferService() {
        this.content = new rxjs__WEBPACK_IMPORTED_MODULE_2__["BehaviorSubject"]("");
        this.locationcontent = new rxjs__WEBPACK_IMPORTED_MODULE_2__["BehaviorSubject"]("");
        this.share = this.content.asObservable();
        this.locationshare = this.locationcontent.asObservable();
        //sharing sentiment bifurcation data to chart component
        this.clickedItem = new rxjs__WEBPACK_IMPORTED_MODULE_2__["BehaviorSubject"]("");
        this.sharedData = this.clickedItem.asObservable();
    }
    DataTransferService.prototype.updateData = function (text) {
        this.content.next(text);
    };
    DataTransferService.prototype.updatelocation = function (locText) {
        this.locationcontent.next(locText);
    };
    DataTransferService.prototype.updateClickedData = function (selectedData) {
        this.clickedItem.next(selectedData);
    };
    DataTransferService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])({
            providedIn: 'root'
        })
    ], DataTransferService);
    return DataTransferService;
}());



/***/ }),

/***/ "./src/app/graphql.module.ts":
/*!***********************************!*\
  !*** ./src/app/graphql.module.ts ***!
  \***********************************/
/*! exports provided: createApollo, GraphQLModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createApollo", function() { return createApollo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphQLModule", function() { return GraphQLModule; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var apollo_angular__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! apollo-angular */ "./node_modules/apollo-angular/fesm5/ngApollo.js");
/* harmony import */ var apollo_angular_link_http__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! apollo-angular-link-http */ "./node_modules/apollo-angular-link-http/fesm5/ngApolloLinkHttp.js");
/* harmony import */ var apollo_cache_inmemory__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! apollo-cache-inmemory */ "./node_modules/apollo-cache-inmemory/lib/bundle.esm.js");
/* harmony import */ var apollo_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! apollo-env */ "./node_modules/apollo-env/lib/index.js");
/* harmony import */ var apollo_env__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(apollo_env__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var aws_amplify__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aws-amplify */ "./node_modules/aws-amplify/lib-esm/index.js");
/* harmony import */ var _aws_exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../aws-exports */ "./src/aws-exports.js");
/* harmony import */ var apollo_boost__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! apollo-boost */ "./node_modules/apollo-boost/lib/index.js");








aws_amplify__WEBPACK_IMPORTED_MODULE_6__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_7__["default"]);

var uri = 'https://a4kfqfeqkfgxhaad2777qxhiy4.appsync-api.us-west-2.amazonaws.com/graphql';
function createApollo(httpLink) {
    var http = httpLink.create({ uri: uri });
    var authLink = new apollo_boost__WEBPACK_IMPORTED_MODULE_8__["ApolloLink"](function (operation, forward) {
        // Use the setContext method to set the HTTP headers.
        operation.setContext({
            headers: {
                "X-Api-Key": "da2-dq52cxdnxzcx7pyuqfjdswijkm"
            },
            fetch: apollo_env__WEBPACK_IMPORTED_MODULE_5__["fetch"]
        });
        return forward(operation);
    });
    return {
        link: authLink.concat(http),
        cache: new apollo_cache_inmemory__WEBPACK_IMPORTED_MODULE_4__["InMemoryCache"]()
    };
}
var GraphQLModule = /** @class */ (function () {
    function GraphQLModule() {
    }
    GraphQLModule = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({
            exports: [apollo_angular__WEBPACK_IMPORTED_MODULE_2__["ApolloModule"], apollo_angular_link_http__WEBPACK_IMPORTED_MODULE_3__["HttpLinkModule"]],
            providers: [
                {
                    provide: apollo_angular__WEBPACK_IMPORTED_MODULE_2__["APOLLO_OPTIONS"],
                    useFactory: createApollo,
                    deps: [apollo_angular_link_http__WEBPACK_IMPORTED_MODULE_3__["HttpLink"]],
                },
            ],
        })
    ], GraphQLModule);
    return GraphQLModule;
}());



/***/ }),

/***/ "./src/app/header/header.component.css":
/*!*********************************************!*\
  !*** ./src/app/header/header.component.css ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "body {\r\n  margin: 0;\r\n}\r\n\r\n#top-nav {\r\n  background-color: #2098d1;\r\n  position: fixed;\r\n  padding: 14px 0px 7px 0px;\r\n  z-index: 1000;\r\n}\r\n\r\n.navbar {\r\n  overflow: hidden;\r\n  width: 100%;\r\n  background-color: #414243;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 70px;\r\n  z-index: 100;\r\n  padding: 0px 80px;\r\n}\r\n\r\n.navbar a {\r\n  float: left;\r\n  display: block;\r\n  color: #f2f2f2;\r\n  text-align: center;\r\n  padding: 14px 16px;\r\n  text-decoration: none;\r\n  font-size: 17px;\r\n}\r\n\r\n.navbar a:hover {\r\n  background: #ddd;\r\n  color: black;\r\n}\r\n\r\n.wrapper {\r\n  margin-top: 60px;\r\n}\r\n\r\n.nav.nav-tabs {\r\n    position: relative;\r\n}\r\n\r\n.nav-item a{\r\n    padding-left: 0px;\r\n}\r\n\r\n/*DateTimePopup Css Starts*/\r\n\r\n.custom-day {\r\n  text-align: center;\r\n  padding: 0.185rem 0.25rem;\r\n  display: inline-block;\r\n  height: 2rem;\r\n  width: 2rem;\r\n}\r\n\r\n.custom-day.focused {\r\n    background-color: #e6e6e6;\r\n  }\r\n\r\n.custom-day.range, .custom-day:hover {\r\n    background-color: rgb(2, 117, 216);\r\n    color: white;\r\n  }\r\n\r\n.custom-day.faded {\r\n    background-color: rgba(2, 117, 216, 0.5);\r\n  }\r\n\r\n/*DateTimePopup CSS ends*/\r\n\r\n@media (min-width: 1200px) {\r\n  .container-fluid {\r\n    max-width: 90%;\r\n  }\r\n}\r\n\r\nimg.logo {\r\n  width: 28em;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  img.logo {\r\n    width: 20em;\r\n  }\r\n}\r\n\r\n.tabIcons {\r\n  width: 26px;\r\n  height: 22px;\r\n  margin: auto;\r\n  display: block;\r\n  position: relative!important;\r\n  background-size: cover;\r\n  margin-bottom: 3px;\r\n  background-image: url(\"/assets/dark_icons.png\");\r\n  background-repeat: no-repeat;\r\n}\r\n\r\n.trending-icon {\r\n  background-position: -53px 0px;\r\n}\r\n\r\n.verbatim-icon {\r\n  background-position: -22px 0px;\r\n}\r\n\r\n.about-icon {\r\n  background-position: 6px 0px;\r\n}\r\n\r\n\r\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvaGVhZGVyL2hlYWRlci5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsU0FBUztBQUNYOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLGVBQWU7RUFDZix5QkFBeUI7RUFDekIsYUFBYTtBQUNmOztBQUNBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFdBQVc7RUFDWCx5QkFBeUI7RUFDekIsZUFBZTtFQUNmLE1BQU07RUFDTixPQUFPO0VBQ1AsUUFBUTtFQUNSLFlBQVk7RUFDWixZQUFZO0VBQ1osaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsV0FBVztFQUNYLGNBQWM7RUFDZCxjQUFjO0VBQ2Qsa0JBQWtCO0VBQ2xCLGtCQUFrQjtFQUNsQixxQkFBcUI7RUFDckIsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEI7O0FBRUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxpQkFBaUI7QUFDckI7O0FBRUEsMkJBQTJCOztBQUMzQjtFQUNFLGtCQUFrQjtFQUNsQix5QkFBeUI7RUFDekIscUJBQXFCO0VBQ3JCLFlBQVk7RUFDWixXQUFXO0FBQ2I7O0FBRUU7SUFDRSx5QkFBeUI7RUFDM0I7O0FBRUE7SUFDRSxrQ0FBa0M7SUFDbEMsWUFBWTtFQUNkOztBQUVBO0lBQ0Usd0NBQXdDO0VBQzFDOztBQUVGLHlCQUF5Qjs7QUFFekI7RUFDRTtJQUNFLGNBQWM7RUFDaEI7QUFDRjs7QUFFQTtFQUNFLFdBQVc7QUFDYjs7QUFFQTtFQUNFO0lBQ0UsV0FBVztFQUNiO0FBQ0Y7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsWUFBWTtFQUNaLFlBQVk7RUFDWixjQUFjO0VBQ2QsNEJBQTRCO0VBQzVCLHNCQUFzQjtFQUN0QixrQkFBa0I7RUFDbEIsK0NBQStDO0VBQy9DLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDhCQUE4QjtBQUNoQzs7QUFDQTtFQUNFLDhCQUE4QjtBQUNoQzs7QUFDQTtFQUNFLDRCQUE0QjtBQUM5QiIsImZpbGUiOiJzcmMvYXBwL2hlYWRlci9oZWFkZXIuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbImJvZHkge1xyXG4gIG1hcmdpbjogMDtcclxufVxyXG5cclxuI3RvcC1uYXYge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICMyMDk4ZDE7XHJcbiAgcG9zaXRpb246IGZpeGVkO1xyXG4gIHBhZGRpbmc6IDE0cHggMHB4IDdweCAwcHg7XHJcbiAgei1pbmRleDogMTAwMDtcclxufVxyXG4ubmF2YmFyIHtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gIHdpZHRoOiAxMDAlO1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICM0MTQyNDM7XHJcbiAgcG9zaXRpb246IGZpeGVkO1xyXG4gIHRvcDogMDtcclxuICBsZWZ0OiAwO1xyXG4gIHJpZ2h0OiAwO1xyXG4gIGhlaWdodDogNzBweDtcclxuICB6LWluZGV4OiAxMDA7XHJcbiAgcGFkZGluZzogMHB4IDgwcHg7XHJcbn1cclxuXHJcbi5uYXZiYXIgYSB7XHJcbiAgZmxvYXQ6IGxlZnQ7XHJcbiAgZGlzcGxheTogYmxvY2s7XHJcbiAgY29sb3I6ICNmMmYyZjI7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gIHBhZGRpbmc6IDE0cHggMTZweDtcclxuICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XHJcbiAgZm9udC1zaXplOiAxN3B4O1xyXG59XHJcblxyXG4ubmF2YmFyIGE6aG92ZXIge1xyXG4gIGJhY2tncm91bmQ6ICNkZGQ7XHJcbiAgY29sb3I6IGJsYWNrO1xyXG59XHJcblxyXG4ud3JhcHBlciB7XHJcbiAgbWFyZ2luLXRvcDogNjBweDtcclxufVxyXG5cclxuLm5hdi5uYXYtdGFicyB7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbn1cclxuXHJcbi5uYXYtaXRlbSBhe1xyXG4gICAgcGFkZGluZy1sZWZ0OiAwcHg7XHJcbn1cclxuXHJcbi8qRGF0ZVRpbWVQb3B1cCBDc3MgU3RhcnRzKi9cclxuLmN1c3RvbS1kYXkge1xyXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICBwYWRkaW5nOiAwLjE4NXJlbSAwLjI1cmVtO1xyXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcclxuICBoZWlnaHQ6IDJyZW07XHJcbiAgd2lkdGg6IDJyZW07XHJcbn1cclxuXHJcbiAgLmN1c3RvbS1kYXkuZm9jdXNlZCB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZTZlNmU2O1xyXG4gIH1cclxuXHJcbiAgLmN1c3RvbS1kYXkucmFuZ2UsIC5jdXN0b20tZGF5OmhvdmVyIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyLCAxMTcsIDIxNik7XHJcbiAgICBjb2xvcjogd2hpdGU7XHJcbiAgfVxyXG5cclxuICAuY3VzdG9tLWRheS5mYWRlZCB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDIsIDExNywgMjE2LCAwLjUpO1xyXG4gIH1cclxuXHJcbi8qRGF0ZVRpbWVQb3B1cCBDU1MgZW5kcyovXHJcblxyXG5AbWVkaWEgKG1pbi13aWR0aDogMTIwMHB4KSB7XHJcbiAgLmNvbnRhaW5lci1mbHVpZCB7XHJcbiAgICBtYXgtd2lkdGg6IDkwJTtcclxuICB9XHJcbn1cclxuXHJcbmltZy5sb2dvIHtcclxuICB3aWR0aDogMjhlbTtcclxufVxyXG5cclxuQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7XHJcbiAgaW1nLmxvZ28ge1xyXG4gICAgd2lkdGg6IDIwZW07XHJcbiAgfVxyXG59XHJcblxyXG4udGFiSWNvbnMge1xyXG4gIHdpZHRoOiAyNnB4O1xyXG4gIGhlaWdodDogMjJweDtcclxuICBtYXJnaW46IGF1dG87XHJcbiAgZGlzcGxheTogYmxvY2s7XHJcbiAgcG9zaXRpb246IHJlbGF0aXZlIWltcG9ydGFudDtcclxuICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyO1xyXG4gIG1hcmdpbi1ib3R0b206IDNweDtcclxuICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIvYXNzZXRzL2RhcmtfaWNvbnMucG5nXCIpO1xyXG4gIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XHJcbn1cclxuXHJcbi50cmVuZGluZy1pY29uIHtcclxuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNTNweCAwcHg7XHJcbn1cclxuLnZlcmJhdGltLWljb24ge1xyXG4gIGJhY2tncm91bmQtcG9zaXRpb246IC0yMnB4IDBweDtcclxufVxyXG4uYWJvdXQtaWNvbiB7XHJcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogNnB4IDBweDtcclxufVxyXG5cclxuIl19 */"

/***/ }),

/***/ "./src/app/header/header.component.ts":
/*!********************************************!*\
  !*** ./src/app/header/header.component.ts ***!
  \********************************************/
/*! exports provided: HeaderComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HeaderComponent", function() { return HeaderComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ng-bootstrap/ng-bootstrap */ "./node_modules/@ng-bootstrap/ng-bootstrap/fesm5/ng-bootstrap.js");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/forms */ "./node_modules/@angular/forms/fesm5/forms.js");
/* harmony import */ var _data_transfer_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! .././data-transfer.service */ "./src/app/data-transfer.service.ts");
/* harmony import */ var apollo_angular__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! apollo-angular */ "./node_modules/apollo-angular/fesm5/ngApollo.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! graphql-tag */ "./node_modules/graphql-tag/src/index.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(graphql_tag__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @aws-amplify/pubsub */ "./node_modules/@aws-amplify/pubsub/lib-esm/index.js");
/* harmony import */ var _aws_exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../aws-exports */ "./src/aws-exports.js");
/* harmony import */ var aws_amplify__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! aws-amplify */ "./node_modules/aws-amplify/lib-esm/index.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm5/router.js");









aws_amplify__WEBPACK_IMPORTED_MODULE_9__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_8__["default"]);
_aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_7__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_8__["default"]);


var now = new Date();
var equals = function (one, two) {
    return one && two && two.year === one.year && two.month === one.month && two.day === one.day;
};
var before = function (one, two) {
    return !one || !two ? false : one.year === two.year ? one.month === two.month ? one.day === two.day
        ? false : one.day < two.day : one.month < two.month : one.year < two.year;
};
var after = function (one, two) {
    return !one || !two ? false : one.year === two.year ? one.month === two.month ? one.day === two.day
        ? false : one.day > two.day : one.month > two.month : one.year > two.year;
};
var HeaderComponent = /** @class */ (function () {
    function HeaderComponent(config, data, element, renderer, _parserFormatter, calendar, apollo, router) {
        var _this = this;
        this.config = config;
        this.data = data;
        this.renderer = renderer;
        this._parserFormatter = _parserFormatter;
        this.calendar = calendar;
        this.apollo = apollo;
        this.router = router;
        this.loading = true;
        this.locText = ['King County - Washington'];
        this.locations = [];
        this.loc = [];
        this.today = this.calendar.getToday();
        this.isHovered = function (date) {
            return _this.fromDate && !_this.toDate && _this.hoveredDate && after(date, _this.fromDate) && before(date, _this.hoveredDate);
        };
        this.isInside = function (date) { return after(date, _this.fromDate) && before(date, _this.toDate); };
        this.isFrom = function (date) { return equals(date, _this.fromDate); };
        this.isTo = function (date) { return equals(date, _this.toDate); };
        this.activeTabUrl = "";
        this.disabled = false;
        var current = new Date();
        config.minDate = { year: 2000, month: 1, day: 1 };
        this.maxDate = { year: current.getFullYear(), month: current.getMonth() + 1, day: current.getDate() };
        config.outsideDays = "hidden";
    }
    Object.defineProperty(HeaderComponent.prototype, "week", {
        set: function (value) {
            this.onChange({ year: this.fromDate.year, week: value });
        },
        enumerable: true,
        configurable: true
    });
    HeaderComponent.prototype.ngAfterContentInit = function () {
        this.text = this.calendar.getToday();
        this.getToday(this.text, 'getinitialdate');
        this.text = this.initialDate;
        this.updateText(this.text);
        this.updateLocation(this.locText);
    };
    HeaderComponent.prototype.ngOnInit = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                this.apollo
                    .query({
                    query: graphql_tag__WEBPACK_IMPORTED_MODULE_6___default()(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n      query location{\n          location{\n            location\n          }\n        }\n      "], ["\n      query location{\n          location{\n            location\n          }\n        }\n      "])))
                })
                    .subscribe(function (_a) {
                    var data = _a.data, loading = _a.loading;
                    _this.locations = data && data.location;
                    _this.locations = _this.locations.filter(function (el) {
                        return el.location != null;
                    });
                    for (var i = 0; i < _this.locations.length; i++) {
                        _this.loc.push(_this.locations[i].location);
                    }
                    _this.loading = false;
                }, function (error) {
                    _this.error = error;
                    console.log("error is: ", error);
                }).add(function () {
                });
                return [2 /*return*/];
            });
        });
    };
    HeaderComponent.prototype.onSelectedLocation = function (locChoice) {
        this.locText = [locChoice.location];
    };
    HeaderComponent.prototype.updateText = function (text) {
        this.data.updateData(text);
    };
    HeaderComponent.prototype.updateLocation = function (locText) {
        this.data.updatelocation(locText);
    };
    HeaderComponent.prototype.onTabChange = function ($event) {
        if ($event.nextId === 'first') {
            this.router.navigateByUrl('');
        }
        else if ($event.nextId === 'second') {
            this.router.navigateByUrl('/verbatim');
        }
        else if ($event.nextId === 'third') {
            this.router.navigateByUrl('/about');
        }
    };
    HeaderComponent.prototype.getToday = function (date, initialData) {
        var parsed = '';
        var currentDate = new Date(date.year + "-" + date.month + "-" + date.day);
        var currentTime = currentDate.getDay() ? currentDate.getDay() - 2 : 6;
        var fromDate = new Date(currentDate.getTime() - 5 * 24 * 60 * 60 * 1000);
        this.fromDate = new _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__["NgbDate"](fromDate.getFullYear(), fromDate.getMonth() + 1, fromDate.getDate());
        var toDate = new Date(fromDate.getTime() + 5 * 24 * 60 * 60 * 1000);
        this.toDate = new _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__["NgbDate"](toDate.getFullYear(), toDate.getMonth() + 1, toDate.getDate());
        if (initialData != '') {
            parsed += this._parserFormatter.format(this.fromDate) + ' to ' + this._parserFormatter.format(this.toDate);
            this.initialDate = parsed;
        }
        else {
            this.fromDate = this.toDate;
            parsed += this._parserFormatter.format(this.fromDate) + ' to ' + this._parserFormatter.format(this.toDate);
            this.renderer.setProperty(this.myRangeInput.nativeElement, 'value', parsed);
        }
    };
    HeaderComponent.prototype.getWeek = function (date) {
        var currentDate = new Date(date.year + "-" + date.month + "-" + date.day);
        var currentTime = currentDate.getDay() ? currentDate.getDay() - 1 : 6;
        var fromDate = new Date(currentDate.getTime() - 6 * 24 * 60 * 60 * 1000);
        this.fromDate = new _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__["NgbDate"](fromDate.getFullYear(), fromDate.getMonth() + 1, fromDate.getDate());
        var toDate = new Date(fromDate.getTime() + 6 * 24 * 60 * 60 * 1000);
        this.toDate = new _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__["NgbDate"](toDate.getFullYear(), toDate.getMonth() + 1, toDate.getDate());
        var weekparsed = '';
        weekparsed += this._parserFormatter.format(this.fromDate);
        weekparsed += ' to ' + this._parserFormatter.format(this.toDate);
        this.renderer.setProperty(this.myRangeInput.nativeElement, 'value', weekparsed);
    };
    HeaderComponent.prototype.onDateSelection = function (date) {
        var parsed = '';
        if (!this.fromDate && !this.toDate) {
            this.fromDate = date;
        }
        else if (this.fromDate && !this.toDate && date.after(this.fromDate)) {
            this.toDate = date;
            this.input.close();
            this.input.open();
        }
        else {
            this.toDate = null;
            this.fromDate = date;
        }
        if (this.fromDate) {
            // if fromDate is set: add the first date
            parsed += this._parserFormatter.format(this.fromDate);
        }
        if (this.toDate != null) {
            // if toDate is set: add the second date with separator
            parsed += ' to ' + this._parserFormatter.format(this.toDate);
        }
        else if (this.toDate === null) {
            parsed += ' to ' + this._parserFormatter.format(this.fromDate);
        }
        // here we update the input value with the new parsed value
        this.renderer.setProperty(this.myRangeInput.nativeElement, 'value', parsed);
    };
    HeaderComponent.prototype.cancelSelection = function () {
    };
    HeaderComponent.ctorParameters = function () { return [
        { type: _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__["NgbDatepickerConfig"] },
        { type: _data_transfer_service__WEBPACK_IMPORTED_MODULE_4__["DataTransferService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["Renderer2"] },
        { type: _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__["NgbDateParserFormatter"] },
        { type: _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__["NgbCalendar"] },
        { type: apollo_angular__WEBPACK_IMPORTED_MODULE_5__["Apollo"] },
        { type: _angular_router__WEBPACK_IMPORTED_MODULE_10__["Router"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])("d", { static: false })
    ], HeaderComponent.prototype, "input", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])(_angular_forms__WEBPACK_IMPORTED_MODULE_3__["NgModel"], { static: false })
    ], HeaderComponent.prototype, "datePick", void 0);
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('myRangeInput', { static: false })
    ], HeaderComponent.prototype, "myRangeInput", void 0);
    HeaderComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-header',
            template: __webpack_require__(/*! raw-loader!./header.component.html */ "./node_modules/raw-loader/index.js!./src/app/header/header.component.html"),
            styles: [__webpack_require__(/*! ./header.component.css */ "./src/app/header/header.component.css")]
        })
    ], HeaderComponent);
    return HeaderComponent;
}());

var templateObject_1;


/***/ }),

/***/ "./src/app/ngb-UTC-string-adapter.ts":
/*!*******************************************!*\
  !*** ./src/app/ngb-UTC-string-adapter.ts ***!
  \*******************************************/
/*! exports provided: NgbDateAdapter, NgbUTCStringAdapter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NgbDateAdapter", function() { return NgbDateAdapter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NgbUTCStringAdapter", function() { return NgbUTCStringAdapter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");


/**
 * Abstract type serving as a DI token for the service converting from your application Date model to internal
 * NgbDateStruct model.
 * A default implementation converting from and to NgbDateStruct is provided for retro-compatibility,
 * but you can provide another implementation to use an alternative format, ie for using with native Date Object.
 */
var NgbDateAdapter = /** @class */ (function () {
    function NgbDateAdapter() {
    }
    NgbDateAdapter = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], NgbDateAdapter);
    return NgbDateAdapter;
}());

var NgbUTCStringAdapter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](NgbUTCStringAdapter, _super);
    function NgbUTCStringAdapter() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Converts a NgbDateStruct value into NgbDateStruct value
     * @param  {NgbDateStruct} value
     * @return {NgbDateStruct}
     */
    NgbUTCStringAdapter.prototype.fromModel = function (date) {
        return (date && date.year && date.month && date.day) ? { year: date.year, month: date.month, day: date.day } : null;
    };
    /**
     * Converts a NgbDateStruct value into NgbDateStruct value
     * @param  {NgbDateStruct} value
     * @return {NgbDateStruct}
     */
    NgbUTCStringAdapter.prototype.toModel = function (date) {
        return (date && date.year && date.month && date.day) ? { year: date.year, month: date.month, day: date.day } : null;
    };
    NgbUTCStringAdapter = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], NgbUTCStringAdapter);
    return NgbUTCStringAdapter;
}(NgbDateAdapter));



/***/ }),

/***/ "./src/app/ngb-date-fr-parser-formatter.ts":
/*!*************************************************!*\
  !*** ./src/app/ngb-date-fr-parser-formatter.ts ***!
  \*************************************************/
/*! exports provided: NgbDateFRParserFormatter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NgbDateFRParserFormatter", function() { return NgbDateFRParserFormatter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ng-bootstrap/ng-bootstrap */ "./node_modules/@ng-bootstrap/ng-bootstrap/fesm5/ng-bootstrap.js");



function padNumber(value) {
    if (isNumber(value)) {
        return ("0" + value).slice(-2);
    }
    else {
        return "";
    }
}
function isNumber(value) {
    return !isNaN(toInteger(value));
}
function toInteger(value) {
    return parseInt("" + value, 10);
}
var NgbDateFRParserFormatter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](NgbDateFRParserFormatter, _super);
    function NgbDateFRParserFormatter() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NgbDateFRParserFormatter.prototype.parse = function (value) {
        if (value) {
            var dateParts = value.trim().split("/");
            if (dateParts.length === 1 && isNumber(dateParts[0])) {
                return { year: toInteger(dateParts[0]), month: null, day: null };
            }
            else if (dateParts.length === 2 && isNumber(dateParts[0]) && isNumber(dateParts[1])) {
                return { year: toInteger(dateParts[1]), month: toInteger(dateParts[0]), day: null };
            }
            else if (dateParts.length === 3 && isNumber(dateParts[0]) && isNumber(dateParts[1]) && isNumber(dateParts[2])) {
                return { year: toInteger(dateParts[2]), month: toInteger(dateParts[1]), day: toInteger(dateParts[0]) };
            }
        }
        return null;
    };
    NgbDateFRParserFormatter.prototype.format = function (date) {
        var stringDate = "";
        if (date) {
            stringDate += date.year + "-";
            stringDate += isNumber(date.month) ? padNumber(date.month) + "-" : "";
            stringDate += isNumber(date.day) ? padNumber(date.day) : "";
        }
        return stringDate;
    };
    NgbDateFRParserFormatter = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
    ], NgbDateFRParserFormatter);
    return NgbDateFRParserFormatter;
}(_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__["NgbDateParserFormatter"]));



/***/ }),

/***/ "./src/app/tree-map/tree-map.component.css":
/*!*************************************************!*\
  !*** ./src/app/tree-map/tree-map.component.css ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "#container {\r\n    position: relative;\r\n    height: 350px;\r\n    margin-bottom: 10px;\r\n    padding-bottom: 10px;\r\n}\r\n\r\n#treemap {\r\n    margin-bottom: 0px;\r\n}\r\n\r\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdHJlZS1tYXAvdHJlZS1tYXAuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGtCQUFrQjtJQUNsQixhQUFhO0lBQ2IsbUJBQW1CO0lBQ25CLG9CQUFvQjtBQUN4Qjs7QUFFQTtJQUNJLGtCQUFrQjtBQUN0QiIsImZpbGUiOiJzcmMvYXBwL3RyZWUtbWFwL3RyZWUtbWFwLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjY29udGFpbmVyIHtcclxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAgIGhlaWdodDogMzUwcHg7XHJcbiAgICBtYXJnaW4tYm90dG9tOiAxMHB4O1xyXG4gICAgcGFkZGluZy1ib3R0b206IDEwcHg7XHJcbn1cclxuXHJcbiN0cmVlbWFwIHtcclxuICAgIG1hcmdpbi1ib3R0b206IDBweDtcclxufVxyXG4iXX0= */"

/***/ }),

/***/ "./src/app/tree-map/tree-map.component.ts":
/*!************************************************!*\
  !*** ./src/app/tree-map/tree-map.component.ts ***!
  \************************************************/
/*! exports provided: TreeMapComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TreeMapComponent", function() { return TreeMapComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _d3plus__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./../d3plus */ "./src/app/d3plus.js");
/* harmony import */ var _d3plus__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_d3plus__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var apollo_angular__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! apollo-angular */ "./node_modules/apollo-angular/fesm5/ngApollo.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! graphql-tag */ "./node_modules/graphql-tag/src/index.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(graphql_tag__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aws-amplify/pubsub */ "./node_modules/@aws-amplify/pubsub/lib-esm/index.js");
/* harmony import */ var _aws_exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../aws-exports */ "./src/aws-exports.js");
/* harmony import */ var aws_amplify__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aws-amplify */ "./node_modules/aws-amplify/lib-esm/index.js");
/* harmony import */ var _data_transfer_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! .././data-transfer.service */ "./src/app/data-transfer.service.ts");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm5/index.js");








aws_amplify__WEBPACK_IMPORTED_MODULE_7__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_6__["default"]);
_aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_5__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_6__["default"]);



var TreeMapComponent = /** @class */ (function () {
    function TreeMapComponent(apollo, data) {
        this.apollo = apollo;
        this.data = data;
        this.impactTreeData = [];
        this.load = true;
        this.empty = false;
        this.start = String;
        this.end = String;
        this.region = String;
        this.parent_region = String;
        this.text = '';
        this.dates = [];
        this.regiondata = [];
        this.finalDates = [];
        this.hierarchy = [];
        this.impactTypes = [];
        this.depthOption = 2;
        this.filterTypes = [];
    }
    TreeMapComponent.prototype.buildTreemap = function () {
        var _this = this;
        this.filterTypes = [
            { value: 0 },
            { value: 1 },
            { value: 2 },
            { value: 3 }
        ];
        this.treemapdata = [];
        this.apollo
            .query({
            query: graphql_tag__WEBPACK_IMPORTED_MODULE_4___default()(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n          query treemapMaster($start: String!, $end: String!, $region: String!, $parent : String!) {\n            treemapMaster(start: $start, end: $end, region: $region, parent: $parent){\n             impact_area_id\n             value\n            }\n          }\n        "], ["\n          query treemapMaster($start: String!, $end: String!, $region: String!, $parent : String!) {\n            treemapMaster(start: $start, end: $end, region: $region, parent: $parent){\n             impact_area_id\n             value\n            }\n          }\n        "]))),
            variables: {
                start: this.start,
                end: this.end,
                region: this.region,
                parent: this.parent_region
            }
        })
            .subscribe(function (_a) {
            var data = _a.data, loading = _a.loading;
            _this.treemapdata = data && data.treemapMaster;
            _this.load = false;
            $('#treemap').find('svg').remove();
            if (_this.treemapdata.length != 0) {
                _this.empty = false;
                // this.impactTypes = [...new Set(data.listImpactTree.map(item => item.source_ontology))];
                _this.impactTypes = ['NewImpact', 'SDG', 'SPI', 'TSF'];
                //  this.impactTypes.splice(0, 0,'NewImpact');
                _this.treeFramework(_this.treemapdata);
            }
            else
                _this.empty = true;
        }, function (error) {
            _this.load = false;
            _this.error = error;
            console.log("error is: ", error);
        });
    };
    TreeMapComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.subscription = Object(rxjs__WEBPACK_IMPORTED_MODULE_9__["combineLatest"])(this.data.share, this.data.locationshare).subscribe(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), text = _b[0], location = _b[1];
            _this.dates = text.split(' to ');
            _this.start = _this.dates[0];
            _this.end = _this.dates[1];
            _this.regiondata = location[0].split(' - ');
            _this.region = _this.regiondata[0];
            _this.parent_region = _this.regiondata[1];
            _this.buildTreemap();
        });
    };
    TreeMapComponent.prototype.mappingData = function (impactAreaIds, frameworkQueries) {
        var _this = this;
        this.impactTreeData = [];
        impactAreaIds.forEach(function (x) {
            for (var i = 0; i < frameworkQueries.length; i++) {
                if (x.impact_area_id === frameworkQueries[i].impact_area_id) {
                    _this.impactTreeData.push(Object.assign({}, x, frameworkQueries[i]));
                }
            }
        });
        return this.impactTreeData;
    };
    TreeMapComponent.prototype.treeFramework = function (impactAreaIds) {
        var _this = this;
        //will call query for populating NewImpact Framework Treemap data
        this.apollo
            .query({
            query: graphql_tag__WEBPACK_IMPORTED_MODULE_4___default()(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n          query listImpactTree {\n            listImpactTree{\n              impact_area_id\n              source_ontology\n              tag\n              level0\n              level1\n              level2\n              color\n            }\n          }\n        "], ["\n          query listImpactTree {\n            listImpactTree{\n              impact_area_id\n              source_ontology\n              tag\n              level0\n              level1\n              level2\n              color\n            }\n          }\n        "])))
        })
            .subscribe(function (_a) {
            var data = _a.data, loading = _a.loading;
            _this.treemapdatanewimpact = data && data.listImpactTree;
            var ni = _this.mappingData(impactAreaIds, _this.treemapdatanewimpact);
            $('#treemap').find('svg').remove();
            _this.empty = false;
            _this.hierarchy = ["level0", "level1", "level2", "tag"];
            _this.depthOption = 2;
            setTimeout(function () { return _this.makevisualization(ni, 2, "NI"); }, 0);
        }, function (error) {
            _this.error = error;
            console.log("error is: ", error);
        });
    };
    TreeMapComponent.prototype.filterImpactArea = function (event) {
        if (event === 'NewImpact') {
            $('#treemap').find('svg').remove();
            this.filterTypes = [
                { value: 0 },
                { value: 1 },
                { value: 2 },
                { value: 3 }
            ];
            this.buildTreemap();
        }
        else {
            this.filterX(event);
        }
    };
    TreeMapComponent.prototype.filterX = function (event) {
        var _this = this;
        if (event === 'SDG') {
            this.filterTypes = [
                { value: 0 },
                { value: 1 }
            ];
            this.apollo
                .query({
                query: graphql_tag__WEBPACK_IMPORTED_MODULE_4___default()(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n          query ListImpactSDG{\n            listImpactSGD{\n              impact_area_id\n              source_ontology\n              tag\n              level0\n              color\n            }\n          }\n        "], ["\n          query ListImpactSDG{\n            listImpactSGD{\n              impact_area_id\n              source_ontology\n              tag\n              level0\n              color\n            }\n          }\n        "])))
            })
                .subscribe(function (_a) {
                var data = _a.data, loading = _a.loading;
                _this.treemapdatasdg = data && data.listImpactSGD;
                var ni = _this.mappingData(_this.treemapdata, _this.treemapdatasdg);
                $('#treemap').find('svg').remove();
                _this.empty = false;
                _this.hierarchy = ["level0", "tag"];
                _this.depthOption = 0;
                setTimeout(function () { return _this.makevisualization(ni, 0, "SDG"); }, 0);
            }, function (error) {
                _this.error = error;
                console.log("error is: ", error);
            });
        }
        else if (event === 'SPI') {
            this.filterTypes = [
                { value: 0 },
                { value: 1 },
                { value: 2 }
            ];
            this.apollo
                .query({
                query: graphql_tag__WEBPACK_IMPORTED_MODULE_4___default()(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n          query listImpactSPI{\n            listImpactSPI{\n              impact_area_id\n              source_ontology\n              tag\n              level1\n              level0\n              color\n            }\n          }\n         "], ["\n          query listImpactSPI{\n            listImpactSPI{\n              impact_area_id\n              source_ontology\n              tag\n              level1\n              level0\n              color\n            }\n          }\n         "])))
            })
                .subscribe(function (_a) {
                var data = _a.data, loading = _a.loading;
                _this.treemapdataspi = data && data.listImpactSPI;
                var ni = _this.mappingData(_this.treemapdata, _this.treemapdataspi);
                $('#treemap').find('svg').remove();
                _this.empty = false;
                _this.hierarchy = ["level0", "level1", "tag"];
                _this.depthOption = 1;
                setTimeout(function () { return _this.makevisualization(ni, 1, "SPI"); }, 0);
            }, function (error) {
                _this.load = false;
                _this.error = error;
                console.log("error is: ", error);
            });
        }
        else if (event === 'TSF') {
            this.filterTypes = [
                { value: 0 },
                { value: 1 },
                { value: 2 }
            ];
            this.apollo
                .query({
                query: graphql_tag__WEBPACK_IMPORTED_MODULE_4___default()(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n          query listImpactTSF{\n            listImpactTSF{\n              impact_area_id\n              source_ontology\n              tag\n              level1\n              level0\n              color  \n            }\n          }\n        "], ["\n          query listImpactTSF{\n            listImpactTSF{\n              impact_area_id\n              source_ontology\n              tag\n              level1\n              level0\n              color  \n            }\n          }\n        "])))
            })
                .subscribe(function (_a) {
                var data = _a.data, loading = _a.loading;
                _this.treemapdatatsf = data && data.listImpactTSF;
                _this.load = false;
                var ni = _this.mappingData(_this.treemapdata, _this.treemapdatatsf);
                $('#treemap').find('svg').remove();
                _this.empty = false;
                _this.hierarchy = ["level0", "level1", "tag"];
                _this.depthOption = 1;
                setTimeout(function () { return _this.makevisualization(ni, 1, "TSF"); }, 0);
            }, function (error) {
                _this.load = false;
                _this.error = error;
                console.log("error is: ", error);
            });
        }
    };
    TreeMapComponent.prototype.makevisualization = function (visualizationData, depthOption, type) {
        depthOption = parseInt(depthOption);
        var element = document.getElementById('treemap');
        if (element) {
            element.innerHTML = '';
            var width = document.getElementById('treemap') != null ? document.getElementById('treemap').getBoundingClientRect().width : '';
            var visualization = new _d3plus__WEBPACK_IMPORTED_MODULE_2__["Treemap"]()
                .data(visualizationData)
                .select("#treemap")
                .groupBy(this.hierarchy)
                .depth(depthOption)
                .legend(false)
                .height(350)
                .width(width)
                .shapeConfig({
                fill: function (d) {
                    return d.color;
                }
            });
            setTimeout(function () { return visualization.render(); }, 10);
            if (depthOption == 2 && type === 'NI') {
                visualization.shapeConfig({
                    label: function (d) {
                        var table = d.level1 + " - " + d.level2;
                        return table;
                    },
                    share: "true"
                });
                setTimeout(function () { return visualization.render(); }, 20);
            }
            this.filterChanged = function (event) {
                depthOption = parseInt(event);
                if (depthOption === 2 && type === 'NI') {
                    visualization.shapeConfig({
                        label: function (d) {
                            var table = d.level1 + " - " + d.level2;
                            return table;
                        },
                    })
                        .depth(depthOption)
                        .render();
                }
                else {
                    $('#treemap').find('svg').remove();
                    visualization = new _d3plus__WEBPACK_IMPORTED_MODULE_2__["Treemap"]()
                        .data(visualizationData)
                        .select("#treemap")
                        .groupBy(this.hierarchy)
                        .depth(depthOption)
                        .legend(false)
                        .height(350)
                        .width(width)
                        .shapeConfig({
                        fill: function (d) {
                            return d.color;
                        }
                    })
                        .render();
                }
            };
        }
    };
    TreeMapComponent.prototype.ngOnDestroy = function () {
        this.subscription.unsubscribe();
    };
    TreeMapComponent.ctorParameters = function () { return [
        { type: apollo_angular__WEBPACK_IMPORTED_MODULE_3__["Apollo"] },
        { type: _data_transfer_service__WEBPACK_IMPORTED_MODULE_8__["DataTransferService"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('test', { static: false })
    ], TreeMapComponent.prototype, "test", void 0);
    TreeMapComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-tree-map',
            template: __webpack_require__(/*! raw-loader!./tree-map.component.html */ "./node_modules/raw-loader/index.js!./src/app/tree-map/tree-map.component.html"),
            styles: [__webpack_require__(/*! ./tree-map.component.css */ "./src/app/tree-map/tree-map.component.css")]
        })
    ], TreeMapComponent);
    return TreeMapComponent;
}());

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/app/trending/trending.component.css":
/*!*************************************************!*\
  !*** ./src/app/trending/trending.component.css ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".sentiment-table td, .sentiment-table th {\r\n  padding: 10px 0px;\r\n  vertical-align: top;\r\n  border-top: 1px solid #dee2e6;\r\n  font-size: 12px;\r\n  vertical-align:middle;\r\n}\r\n.progress{\r\n    height: 10px;\r\n}\r\n.icon-sm {\r\n  font-size: 15px;\r\n}\r\n.switchView {\r\n    display: inline-block;\r\n    padding: 3px 12px;\r\n    margin-bottom: 0;\r\n    font-size: 12px;\r\n    line-height: 24px;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n    cursor: pointer;\r\n    text-transform: uppercase;\r\n    font-weight: bold;\r\n    border: 1px solid transparent;\r\n    background-color: #ffffff;\r\n    color: #b3a7a7;\r\n    border-color: #cccccc;\r\n    *border: 0;\r\n    *background: #e6e6e6;\r\n    border-radius: 4px;\r\n    *margin-left: .3em;\r\n    box-shadow: inset 0 -2px 0px rgba(0,0,0,.15), inset 0 1px 0 rgba(255,255,255,.5);\r\n  }\r\n.switchView.selected {\r\n    outline: none !important;\r\n    color: #666666;\r\n    background-image: none;\r\n    box-shadow: inset 0 3px 5px rgba(0,0,0,0.125);\r\n}\r\n.switchView.btn:hover{\r\n  outline: none !important;\r\n  color: #666666;\r\n  background-image: none;\r\n  box-shadow: inset 0 3px 5px rgba(0,0,0,0.125);\r\n}\r\n#emptySearch {\r\n  color: #000;\r\n  font-size: 15px;\r\n  padding: 2px 10px;\r\n  margin: 10px;\r\n}\r\n.smalltooltip .tooltip-inner {\r\n  font-size: 10px !important;\r\n}\r\n#trending-topics {\r\n  position: relative;\r\n}\r\n.zoom-btn {\r\n  position: absolute;\r\n  right: 25px;\r\n  top: 65px;\r\n}\r\n.sentiment-table tr.active {\r\n  box-shadow: 0px 3px 21px 0 rgba(44, 41, 84, .48);\r\n}\r\n.bg-negative {\r\n  background-color: #676767;\r\n}\r\n.bg-neutral {\r\n  background-color: #ffc000;\r\n}\r\n.bg-positive {\r\n  background-color: #2aa7d7;\r\n}\r\n.box{\r\n  width: 10px;\r\n  height: 10px;\r\n}\r\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdHJlbmRpbmcvdHJlbmRpbmcuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGlCQUFpQjtFQUNqQixtQkFBbUI7RUFDbkIsNkJBQTZCO0VBQzdCLGVBQWU7RUFDZixxQkFBcUI7QUFDdkI7QUFDQTtJQUNJLFlBQVk7QUFDaEI7QUFFQTtFQUNFLGVBQWU7QUFDakI7QUFDRTtJQUNFLHFCQUFxQjtJQUNyQixpQkFBaUI7SUFDakIsZ0JBQWdCO0lBQ2hCLGVBQWU7SUFDZixpQkFBaUI7SUFDakIsa0JBQWtCO0lBQ2xCLHNCQUFzQjtJQUN0QixlQUFlO0lBQ2YseUJBQXlCO0lBQ3pCLGlCQUFpQjtJQUNqQiw2QkFBNkI7SUFDN0IseUJBQXlCO0lBQ3pCLGNBQWM7SUFDZCxxQkFBcUI7S0FDckIsU0FBVTtLQUNWLG1CQUFvQjtJQUdwQixrQkFBa0I7S0FDbEIsaUJBQWtCO0lBR2xCLGdGQUFnRjtFQUNsRjtBQUVBO0lBQ0Usd0JBQXdCO0lBQ3hCLGNBQWM7SUFDZCxzQkFBc0I7SUFDdEIsNkNBQTZDO0FBQ2pEO0FBRUE7RUFDRSx3QkFBd0I7RUFDeEIsY0FBYztFQUNkLHNCQUFzQjtFQUN0Qiw2Q0FBNkM7QUFDL0M7QUFDQTtFQUNFLFdBQVc7RUFDWCxlQUFlO0VBQ2YsaUJBQWlCO0VBQ2pCLFlBQVk7QUFDZDtBQUVBO0VBQ0UsMEJBQTBCO0FBQzVCO0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsU0FBUztBQUNYO0FBRUE7RUFDRSxnREFBZ0Q7QUFDbEQ7QUFFQTtFQUNFLHlCQUF5QjtBQUMzQjtBQUVBO0VBQ0UseUJBQXlCO0FBQzNCO0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7QUFDQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0FBQ2QiLCJmaWxlIjoic3JjL2FwcC90cmVuZGluZy90cmVuZGluZy5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnNlbnRpbWVudC10YWJsZSB0ZCwgLnNlbnRpbWVudC10YWJsZSB0aCB7XHJcbiAgcGFkZGluZzogMTBweCAwcHg7XHJcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcclxuICBib3JkZXItdG9wOiAxcHggc29saWQgI2RlZTJlNjtcclxuICBmb250LXNpemU6IDEycHg7XHJcbiAgdmVydGljYWwtYWxpZ246bWlkZGxlO1xyXG59XHJcbi5wcm9ncmVzc3tcclxuICAgIGhlaWdodDogMTBweDtcclxufVxyXG5cclxuLmljb24tc20ge1xyXG4gIGZvbnQtc2l6ZTogMTVweDtcclxufVxyXG4gIC5zd2l0Y2hWaWV3IHtcclxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcclxuICAgIHBhZGRpbmc6IDNweCAxMnB4O1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMDtcclxuICAgIGZvbnQtc2l6ZTogMTJweDtcclxuICAgIGxpbmUtaGVpZ2h0OiAyNHB4O1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XHJcbiAgICBmb250LXdlaWdodDogYm9sZDtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkIHRyYW5zcGFyZW50O1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjtcclxuICAgIGNvbG9yOiAjYjNhN2E3O1xyXG4gICAgYm9yZGVyLWNvbG9yOiAjY2NjY2NjO1xyXG4gICAgKmJvcmRlcjogMDtcclxuICAgICpiYWNrZ3JvdW5kOiAjZTZlNmU2O1xyXG4gICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAtbW96LWJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICptYXJnaW4tbGVmdDogLjNlbTtcclxuICAgIC13ZWJraXQtYm94LXNoYWRvdzogaW5zZXQgMCAtMnB4IDBweCByZ2JhKDAsMCwwLC4xNSksIGluc2V0IDAgMXB4IDAgcmdiYSgyNTUsMjU1LDI1NSwuNSk7XHJcbiAgICAtbW96LWJveC1zaGFkb3c6IGluc2V0IDAgLTJweCAwcHggcmdiYSgwLDAsMCwuMTUpLCBpbnNldCAwIDFweCAwIHJnYmEoMjU1LDI1NSwyNTUsLjUpO1xyXG4gICAgYm94LXNoYWRvdzogaW5zZXQgMCAtMnB4IDBweCByZ2JhKDAsMCwwLC4xNSksIGluc2V0IDAgMXB4IDAgcmdiYSgyNTUsMjU1LDI1NSwuNSk7XHJcbiAgfVxyXG5cclxuICAuc3dpdGNoVmlldy5zZWxlY3RlZCB7XHJcbiAgICBvdXRsaW5lOiBub25lICFpbXBvcnRhbnQ7XHJcbiAgICBjb2xvcjogIzY2NjY2NjtcclxuICAgIGJhY2tncm91bmQtaW1hZ2U6IG5vbmU7XHJcbiAgICBib3gtc2hhZG93OiBpbnNldCAwIDNweCA1cHggcmdiYSgwLDAsMCwwLjEyNSk7XHJcbn1cclxuICBcclxuLnN3aXRjaFZpZXcuYnRuOmhvdmVye1xyXG4gIG91dGxpbmU6IG5vbmUgIWltcG9ydGFudDtcclxuICBjb2xvcjogIzY2NjY2NjtcclxuICBiYWNrZ3JvdW5kLWltYWdlOiBub25lO1xyXG4gIGJveC1zaGFkb3c6IGluc2V0IDAgM3B4IDVweCByZ2JhKDAsMCwwLDAuMTI1KTtcclxufVxyXG4jZW1wdHlTZWFyY2gge1xyXG4gIGNvbG9yOiAjMDAwO1xyXG4gIGZvbnQtc2l6ZTogMTVweDtcclxuICBwYWRkaW5nOiAycHggMTBweDtcclxuICBtYXJnaW46IDEwcHg7XHJcbn1cclxuXHJcbi5zbWFsbHRvb2x0aXAgLnRvb2x0aXAtaW5uZXIge1xyXG4gIGZvbnQtc2l6ZTogMTBweCAhaW1wb3J0YW50O1xyXG59XHJcblxyXG4jdHJlbmRpbmctdG9waWNzIHtcclxuICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbn1cclxuXHJcbi56b29tLWJ0biB7XHJcbiAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gIHJpZ2h0OiAyNXB4O1xyXG4gIHRvcDogNjVweDtcclxufVxyXG5cclxuLnNlbnRpbWVudC10YWJsZSB0ci5hY3RpdmUge1xyXG4gIGJveC1zaGFkb3c6IDBweCAzcHggMjFweCAwIHJnYmEoNDQsIDQxLCA4NCwgLjQ4KTtcclxufVxyXG5cclxuLmJnLW5lZ2F0aXZlIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNjc2NzY3O1xyXG59XHJcblxyXG4uYmctbmV1dHJhbCB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmYzAwMDtcclxufVxyXG5cclxuLmJnLXBvc2l0aXZlIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmFhN2Q3O1xyXG59XHJcbi5ib3h7XHJcbiAgd2lkdGg6IDEwcHg7XHJcbiAgaGVpZ2h0OiAxMHB4O1xyXG59Il19 */"

/***/ }),

/***/ "./src/app/trending/trending.component.ts":
/*!************************************************!*\
  !*** ./src/app/trending/trending.component.ts ***!
  \************************************************/
/*! exports provided: TrendingComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TrendingComponent", function() { return TrendingComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _data_transfer_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! .././data-transfer.service */ "./src/app/data-transfer.service.ts");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm5/index.js");
/* harmony import */ var apollo_angular__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! apollo-angular */ "./node_modules/apollo-angular/fesm5/ngApollo.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! graphql-tag */ "./node_modules/graphql-tag/src/index.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(graphql_tag__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @aws-amplify/pubsub */ "./node_modules/@aws-amplify/pubsub/lib-esm/index.js");
/* harmony import */ var _aws_exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../aws-exports */ "./src/aws-exports.js");
/* harmony import */ var aws_amplify__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! aws-amplify */ "./node_modules/aws-amplify/lib-esm/index.js");








aws_amplify__WEBPACK_IMPORTED_MODULE_8__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_7__["default"]);
_aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_6__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_7__["default"]);

var TrendingComponent = /** @class */ (function () {
    function TrendingComponent(data, element, renderer, apollo) {
        this.data = data;
        this.renderer = renderer;
        this.apollo = apollo;
        this.loading = true;
        this.topics = [];
        this.selectedTopics = true;
        this.selectedRow = 0;
        this.changedObjtext = '';
        this.changedObjLocation = '';
        this.start = String;
        this.end = String;
        this.region = String;
        this.parent_region = String;
        this.listHashtags = [];
        this.listTrendingTopics = [];
        this.currentZoom = 3;
        this.hideZoomOut = false;
        this.hideZoomIn = false;
        this.p = 1;
        this.empty = false;
        //Variables for assigning weight to tag cloud:
        this.minWeight = 1;
        this.maxWeight = 20;
        this.text = '';
        this.location = '';
        this.dates = [];
        this.regiondata = [];
        this.finalDates = [];
        this.setClickedRow = function (index) {
            this.selectedRow = index;
        };
    }
    TrendingComponent.prototype.functionGetTrendingData = function (topicHashtag) {
        var finalTrending = [];
        var length = topicHashtag.length;
        var MaxViewed = topicHashtag[0].counts;
        var MinViewed = topicHashtag[length - 1].counts;
        if (MaxViewed != MinViewed) {
            for (var counts in topicHashtag) {
                var fontsize = (this.minWeight + ((topicHashtag[counts].counts - MinViewed) * (this.maxWeight - this.minWeight) / (MaxViewed - MinViewed)));
                if (topicHashtag[0].hasOwnProperty("hashtag")) {
                    finalTrending.push({
                        text: topicHashtag[counts].hashtag,
                        weight: Math.round(fontsize),
                    });
                }
                else {
                    finalTrending.push({
                        text: topicHashtag[counts].topic,
                        weight: Math.round(fontsize),
                    });
                }
            }
        }
        setTimeout(function () {
            this.loading = false;
            $('#trending-topics').find('span').remove();
            document.getElementById('trending-topics').innerHTML = '';
            $("#trending-topics").jQCloud(finalTrending);
            0;
        });
    };
    TrendingComponent.prototype.getTrendingTopics = function () {
        var _this = this;
        this.loading = true;
        $("#trending-topics").find('span').remove();
        this.listTrendingTopics = [];
        this.selectedTopics = true;
        this.apollo
            .query({
            query: graphql_tag__WEBPACK_IMPORTED_MODULE_5___default()(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n        query listTrendingTopicsMaster($start: String!, $end: String!, $region: String!, $parent : String!) {\n            listTrendingTopicsMaster(start: $start, end: $end, region: $region, parent: $parent){\n              topic\n              counts\n              sentiment\n              positive\n              negative\n              neutral\n            }\n          }\n        "], ["\n        query listTrendingTopicsMaster($start: String!, $end: String!, $region: String!, $parent : String!) {\n            listTrendingTopicsMaster(start: $start, end: $end, region: $region, parent: $parent){\n              topic\n              counts\n              sentiment\n              positive\n              negative\n              neutral\n            }\n          }\n        "]))),
            variables: {
                start: this.start,
                end: this.end,
                region: this.region,
                parent: this.parent_region
            }
        })
            .subscribe(function (_a) {
            var data = _a.data, loading = _a.loading;
            _this.listTrendingTopics = data && data.listTrendingTopicsMaster;
            _this.listTrendingTopics.length === 0 ? _this.empty = true : _this.empty = false;
            _this.loading = false;
        }, function (error) {
            _this.error = error;
            console.log("error is: ", error);
        }).add(function () {
            if (_this.listTrendingTopics.length != 0) {
                _this.empty = false;
                _this.data.updateClickedData(_this.listTrendingTopics[0].topic + ' topic');
                _this.functionGetTrendingData(_this.listTrendingTopics);
            }
        });
    };
    TrendingComponent.prototype.getHashtags = function () {
        var _this = this;
        this.loading = true;
        $("#trending-topics").find('span').remove();
        this.selectedTopics = false;
        this.listHashtags = [];
        this.apollo
            .query({
            query: graphql_tag__WEBPACK_IMPORTED_MODULE_5___default()(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n            query listTrendingHashtags($start: String!, $end: String!, $region: String!, $parent: String!) {\n              listTrendingHashtags (start: $start, end: $end, region: $region, parent: $parent){\n              counts\n              sentiment\n              negative\n              neutral\n              positive\n              hashtag\n              start_date\n            }\n          }\n        "], ["\n            query listTrendingHashtags($start: String!, $end: String!, $region: String!, $parent: String!) {\n              listTrendingHashtags (start: $start, end: $end, region: $region, parent: $parent){\n              counts\n              sentiment\n              negative\n              neutral\n              positive\n              hashtag\n              start_date\n            }\n          }\n        "]))),
            variables: {
                start: this.start,
                end: this.end,
                region: this.region,
                parent: this.parent_region
            }
        })
            .subscribe(function (_a) {
            var data = _a.data, loading = _a.loading;
            _this.listHashtags = data && data.listTrendingHashtags;
            _this.listTrendingTopics.length === 0 ? _this.empty = true : _this.empty = false;
            _this.loading = false;
        }, function (error) {
            _this.error = error;
            console.log("error is: ", error);
        }).add(function () {
            if (_this.listHashtags.length != 0) {
                _this.empty = false;
                _this.data.updateClickedData(_this.listHashtags[0].hashtag + ' hashtag');
                _this.functionGetTrendingData(_this.listHashtags);
            }
        });
    };
    TrendingComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.subscription = Object(rxjs__WEBPACK_IMPORTED_MODULE_3__["combineLatest"])(this.data.share, this.data.locationshare).subscribe(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), text = _b[0], location = _b[1];
            if (_this.changedObjtext != text || _this.changedObjLocation != location[0]) {
                _this.changedObjtext = text;
                _this.changedObjLocation = location[0];
                _this.dates = text.split(' to ');
                _this.start = _this.dates[0];
                _this.end = _this.dates[1];
                _this.regiondata = location[0].split(' - ');
                _this.region = _this.regiondata[0];
                _this.parent_region = _this.regiondata[1];
                _this.selectedTopics ? _this.getTrendingTopics() : _this.getHashtags();
            }
        });
    };
    TrendingComponent.prototype.ngOnDestroy = function () {
        this.subscription.unsubscribe();
    };
    TrendingComponent.prototype.updateClicked = function (selectedData) {
        this.data.updateClickedData(selectedData);
    };
    TrendingComponent.prototype.zoom = function (zoomType) {
        var element = document.getElementById('trending-topics');
        var zoomArr = [0.75, 0.85, 0.9, 1, 1.2, 1.5, 1.75];
        if (this.currentZoom >= 0 && this.currentZoom <= 6) {
            zoomType === 'in' ? this.currentZoom++ : this.currentZoom--;
            if (this.currentZoom == 0) {
                this.hideZoomOut = true;
                this.currentZoom = 0;
            }
            else
                this.hideZoomOut = false;
            if (this.currentZoom == 6) {
                this.hideZoomIn = true;
                this.currentZoom = 6;
            }
            else
                this.hideZoomIn = false;
            element.style['transform'] = "scale(" + zoomArr[this.currentZoom] + ")";
        }
    };
    TrendingComponent.ctorParameters = function () { return [
        { type: _data_transfer_service__WEBPACK_IMPORTED_MODULE_2__["DataTransferService"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ElementRef"] },
        { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["Renderer2"] },
        { type: apollo_angular__WEBPACK_IMPORTED_MODULE_4__["Apollo"] }
    ]; };
    TrendingComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-trending',
            template: __webpack_require__(/*! raw-loader!./trending.component.html */ "./node_modules/raw-loader/index.js!./src/app/trending/trending.component.html"),
            styles: [__webpack_require__(/*! ./trending.component.css */ "./src/app/trending/trending.component.css")]
        })
    ], TrendingComponent);
    return TrendingComponent;
}());

var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/app/verbatim/verbatim.component.css":
/*!*************************************************!*\
  !*** ./src/app/verbatim/verbatim.component.css ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "@-webkit-keyframes swing {\r\n  0% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n\r\n  10% {\r\n    -webkit-transform: rotate(10deg);\r\n            transform: rotate(10deg);\r\n  }\r\n\r\n  30% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n\r\n  40% {\r\n    -webkit-transform: rotate(-10deg);\r\n            transform: rotate(-10deg);\r\n  }\r\n\r\n  50% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n\r\n  60% {\r\n    -webkit-transform: rotate(5deg);\r\n            transform: rotate(5deg);\r\n  }\r\n\r\n  70% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n\r\n  80% {\r\n    -webkit-transform: rotate(-5deg);\r\n            transform: rotate(-5deg);\r\n  }\r\n\r\n  100% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n}\r\n\r\n@keyframes swing {\r\n  0% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n\r\n  10% {\r\n    -webkit-transform: rotate(10deg);\r\n            transform: rotate(10deg);\r\n  }\r\n\r\n  30% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n\r\n  40% {\r\n    -webkit-transform: rotate(-10deg);\r\n            transform: rotate(-10deg);\r\n  }\r\n\r\n  50% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n\r\n  60% {\r\n    -webkit-transform: rotate(5deg);\r\n            transform: rotate(5deg);\r\n  }\r\n\r\n  70% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n\r\n  80% {\r\n    -webkit-transform: rotate(-5deg);\r\n            transform: rotate(-5deg);\r\n  }\r\n\r\n  100% {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n  }\r\n}\r\n\r\n@-webkit-keyframes sonar {\r\n  0% {\r\n    -webkit-transform: scale(0.9);\r\n            transform: scale(0.9);\r\n    opacity: 1;\r\n  }\r\n\r\n  100% {\r\n    -webkit-transform: scale(2);\r\n            transform: scale(2);\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n@keyframes sonar {\r\n  0% {\r\n    -webkit-transform: scale(0.9);\r\n            transform: scale(0.9);\r\n    opacity: 1;\r\n  }\r\n\r\n  100% {\r\n    -webkit-transform: scale(2);\r\n            transform: scale(2);\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\nbody {\r\n  font-size: 0.9rem;\r\n  font-family: lato;\r\n}\r\n\r\n.page-wrapper .sidebar-wrapper,\r\n.sidebar-wrapper .sidebar-brand > a,\r\n.sidebar-wrapper .sidebar-dropdown > a:after,\r\n.sidebar-wrapper .sidebar-menu .sidebar-dropdown .sidebar-submenu li a:before,\r\n.sidebar-wrapper ul li a i,\r\n.page-wrapper .page-content,\r\n.sidebar-wrapper .sidebar-search input.search-menu,\r\n.sidebar-wrapper .sidebar-search .input-group-text,\r\n.sidebar-wrapper .sidebar-menu ul li a,\r\n#show-sidebar,\r\n#close-sidebar {\r\n  -webkit-transition: all 0.3s ease;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n/*----------------page-wrapper----------------*/\r\n\r\n.page-wrapper {\r\nposition:relative;\r\n}\r\n\r\n.page-wrapper .theme {\r\n    width: 40px;\r\n    height: 40px;\r\n    display: inline-block;\r\n    border-radius: 4px;\r\n    margin: 2px;\r\n  }\r\n\r\n.page-wrapper .theme.chiller-theme {\r\n      background: #1e2229;\r\n    }\r\n\r\n/*----------------toggeled sidebar----------------*/\r\n\r\n.page-wrapper.toggled .sidebar-wrapper {\r\n    left: 0px;\r\n    top: auto;\r\n    position: absolute;\r\n  }\r\n\r\n@media screen and (min-width: 768px) {\r\n  .page-wrapper.toggled .page-content {\r\n    padding-left: 300px;\r\n  }\r\n}\r\n\r\n/*----------------show sidebar button----------------*/\r\n\r\n#show-sidebar {\r\n  left: 0;\r\n  top: 0px;\r\n  border-radius: 0 4px 4px 0px;\r\n  width: 35px;\r\n  -webkit-transition-delay: 0.3s;\r\n          transition-delay: 0.3s;\r\n  position: absolute;\r\n}\r\n\r\n.page-wrapper.toggled #show-sidebar {\r\n  left: 20%;\r\n  top: 0%;\r\n}\r\n\r\n/*----------------sidebar-wrapper----------------*/\r\n\r\n.sidebar-wrapper {\r\n  width: 260px;\r\n  height: 100%;\r\n  max-height: 100%;\r\n  position: fixed;\r\n  top: 0;\r\n  left: -300px;\r\n  z-index: 999;\r\n}\r\n\r\n.sidebar-wrapper ul {\r\n    list-style-type: none;\r\n    padding: 0;\r\n    margin: 0;\r\n  }\r\n\r\n.sidebar-wrapper a {\r\n    text-decoration: none;\r\n  }\r\n\r\n/*----------------sidebar-content----------------*/\r\n\r\n.sidebar-content {\r\n  max-height: calc(100% - 30px);\r\n  height: calc(100% - 30px);\r\n  overflow-y: auto;\r\n  position: relative;\r\n}\r\n\r\n.sidebar-content.desktop {\r\n    overflow-y: hidden;\r\n  }\r\n\r\n/*--------------------sidebar-brand----------------------*/\r\n\r\n.sidebar-wrapper .sidebar-brand {\r\n  padding: 10px 20px;\r\n  display: -webkit-box;\r\n  display: flex;\r\n  -webkit-box-align: center;\r\n          align-items: center;\r\n}\r\n\r\n.sidebar-wrapper .sidebar-brand > a {\r\n    text-transform: uppercase;\r\n    font-weight: bold;\r\n    -webkit-box-flex: 1;\r\n            flex-grow: 1;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-brand #close-sidebar {\r\n    cursor: pointer;\r\n    font-size: 20px;\r\n  }\r\n\r\n/*-----------------------sidebar-search------------------------*/\r\n\r\n.sidebar-wrapper .sidebar-search > div {\r\n  padding: 10px 20px;\r\n}\r\n\r\n/*----------------------sidebar-menu-------------------------*/\r\n\r\n.sidebar-wrapper .sidebar-menu {\r\n  padding-bottom: 10px;\r\n}\r\n\r\n.sidebar-wrapper .sidebar-menu .header-menu span {\r\n    font-weight: bold;\r\n    font-size: 14px;\r\n    padding: 15px 20px 5px 20px;\r\n    display: inline-block;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-menu ul li a {\r\n    display: inline-block;\r\n    width: 100%;\r\n    text-decoration: none;\r\n    position: relative;\r\n    padding: 8px 30px 8px 20px;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-menu ul li a i {\r\n      margin-right: 10px;\r\n      font-size: 12px;\r\n      width: 30px;\r\n      height: 30px;\r\n      line-height: 30px;\r\n      text-align: center;\r\n      border-radius: 4px;\r\n    }\r\n\r\n.sidebar-wrapper .sidebar-menu ul li a:hover > i::before {\r\n      display: inline-block;\r\n      -webkit-animation: swing ease-in-out 0.5s 1 alternate;\r\n              animation: swing ease-in-out 0.5s 1 alternate;\r\n    }\r\n\r\n.sidebar-wrapper .sidebar-menu .sidebar-dropdown > a:after {\r\n    font-family: \"Font Awesome 5 Free\";\r\n    font-weight: 900;\r\n    content: \"\\f105\";\r\n    font-style: normal;\r\n    display: inline-block;\r\n    font-style: normal;\r\n    font-variant: normal;\r\n    text-rendering: auto;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n    text-align: center;\r\n    background: 0 0;\r\n    position: absolute;\r\n    right: 15px;\r\n    top: 14px;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-menu .sidebar-dropdown .sidebar-submenu ul {\r\n    padding: 5px 0;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-menu .sidebar-dropdown .sidebar-submenu li {\r\n    padding-left: 25px;\r\n    font-size: 13px;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-menu .sidebar-dropdown .sidebar-submenu li a:before {\r\n      content: \"\\f111\";\r\n      font-family: \"Font Awesome 5 Free\";\r\n      font-weight: 400;\r\n      font-style: normal;\r\n      display: inline-block;\r\n      text-align: center;\r\n      text-decoration: none;\r\n      -webkit-font-smoothing: antialiased;\r\n      -moz-osx-font-smoothing: grayscale;\r\n      margin-right: 10px;\r\n      font-size: 8px;\r\n    }\r\n\r\n.sidebar-wrapper .sidebar-menu ul li a span.label,\r\n  .sidebar-wrapper .sidebar-menu ul li a span.badge {\r\n    float: right;\r\n    margin-top: 8px;\r\n    margin-left: 5px;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-menu .sidebar-dropdown .sidebar-submenu li a .badge,\r\n  .sidebar-wrapper .sidebar-menu .sidebar-dropdown .sidebar-submenu li a .label {\r\n    float: right;\r\n    margin-top: 0px;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-menu .sidebar-submenu {\r\n    display: none;\r\n  }\r\n\r\n.sidebar-wrapper .sidebar-menu .sidebar-dropdown.active > a:after {\r\n    -webkit-transform: rotate(90deg);\r\n            transform: rotate(90deg);\r\n    right: 17px;\r\n  }\r\n\r\n/*--------------------------page-content-----------------------------*/\r\n\r\n.page-wrapper .page-content {\r\n  display: inline-block;\r\n  width: 100%;\r\n  padding-left: 30px;\r\n  padding-top: 20px;\r\n  padding-right: 30px;\r\n  z-index: -1;\r\n}\r\n\r\n.page-wrapper .page-content {\r\n  overflow-x: hidden;\r\n}\r\n\r\n/*------scroll bar---------------------*/\r\n\r\n::-webkit-scrollbar {\r\n  width: 5px;\r\n  height: 7px;\r\n}\r\n\r\n::-webkit-scrollbar-button {\r\n  width: 0px;\r\n  height: 0px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n  background: #525965;\r\n  border: 0px none #ffffff;\r\n  border-radius: 0px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: #525965;\r\n  }\r\n\r\n::-webkit-scrollbar-thumb:active {\r\n    background: #525965;\r\n  }\r\n\r\n::-webkit-scrollbar-track {\r\n  background: transparent;\r\n  border: 0px none #ffffff;\r\n  border-radius: 50px;\r\n}\r\n\r\n::-webkit-scrollbar-track:hover {\r\n    background: transparent;\r\n  }\r\n\r\n::-webkit-scrollbar-track:active {\r\n    background: transparent;\r\n  }\r\n\r\n::-webkit-scrollbar-corner {\r\n  background: transparent;\r\n}\r\n\r\n/*-----------------------------chiller-theme-------------------------------------------------*/\r\n\r\n.chiller-theme .sidebar-wrapper {\r\n  background: #31353D;\r\n}\r\n\r\n.chiller-theme .sidebar-wrapper,\r\n  .chiller-theme .sidebar-wrapper .sidebar-search,\r\n  .chiller-theme .sidebar-wrapper .sidebar-menu {\r\n    border-top: 1px solid #3a3f48;\r\n  }\r\n\r\n.chiller-theme .sidebar-wrapper .sidebar-search input.search-menu,\r\n    .chiller-theme .sidebar-wrapper .sidebar-search .input-group-text {\r\n      border-color: transparent;\r\n      box-shadow: none;\r\n    }\r\n\r\n.chiller-theme .sidebar-wrapper .sidebar-search input.search-menu,\r\n    .chiller-theme .sidebar-wrapper .sidebar-search .input-group-text,\r\n    .chiller-theme .sidebar-wrapper .sidebar-brand > a,\r\n    .chiller-theme .sidebar-wrapper .sidebar-menu ul li a {\r\n      color: #818896;\r\n    }\r\n\r\n.chiller-theme .sidebar-wrapper .sidebar-menu ul li:hover > a,\r\n      .chiller-theme .sidebar-wrapper .sidebar-menu .sidebar-dropdown.active > a,\r\n      .chiller-theme .sidebar-wrapper .sidebar-brand > a:hover {\r\n        color: #b8bfce;\r\n      }\r\n\r\n.page-wrapper.chiller-theme.toggled #close-sidebar {\r\n  color: #bdbdbd;\r\n}\r\n\r\n.page-wrapper.chiller-theme.toggled #close-sidebar:hover {\r\n    color: #ffffff;\r\n  }\r\n\r\n.chiller-theme .sidebar-wrapper ul li:hover a i,\r\n.chiller-theme .sidebar-wrapper .sidebar-dropdown .sidebar-submenu li a:hover:before,\r\n.chiller-theme .sidebar-wrapper .sidebar-search input.search-menu:focus + span,\r\n.chiller-theme .sidebar-wrapper .sidebar-menu .sidebar-dropdown.active a i {\r\n  color: #16c7ff;\r\n  text-shadow: 0px 0px 10px rgba(22, 199, 255, 0.5);\r\n}\r\n\r\n.chiller-theme .sidebar-wrapper .sidebar-menu ul li a i,\r\n.chiller-theme .sidebar-wrapper .sidebar-menu .sidebar-dropdown div,\r\n.chiller-theme .sidebar-wrapper .sidebar-search input.search-menu,\r\n.chiller-theme .sidebar-wrapper .sidebar-search .input-group-text {\r\n  background: #3a3f48;\r\n}\r\n\r\n.chiller-theme .sidebar-wrapper .sidebar-menu .header-menu span {\r\n  color: #6c7b88;\r\n}\r\n\r\n.sub-details {\r\n  box-shadow: hsl(0, 0%, 84%) 0 0 8px;\r\n    position: relative;\r\n    margin: 20px 0px;\r\n}\r\n\r\n.topics span {\r\n  display: inline-block;\r\n  padding: 4px 4px;\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  line-height: 14px;\r\n  color: #ffffff;\r\n  vertical-align: baseline;\r\n  white-space: nowrap;\r\n  border-radius: 3px;\r\n  margin: 0px 5px;\r\n}\r\n\r\n.pink {\r\n  background-color: #ea4ca0;\r\n}\r\n\r\n.blue {\r\n  background-color: #00accd;\r\n}\r\n\r\n.green {\r\n  background-color: #25a01a;\r\n}\r\n\r\n.red {\r\n  background-color: #cc1a1a;\r\n}\r\n\r\n@media (max-width: 767px) {\r\n  .smiley {\r\n    position: absolute;\r\n    top: 10px;\r\n    right: 25px;\r\n  }\r\n\r\n}\r\n\r\n.threaded {\r\n  margin-left: 40px;\r\n}\r\n\r\n.threaded::before {\r\n  border-top: 1px dashed #ddd;\r\n  height: 0.5px;\r\n  content: \" \";\r\n  width: 3.5%;\r\n  position: absolute;\r\n  left: -31px;\r\n  top: 3.0em;\r\n}\r\n\r\n.threaded::after {\r\n  content: \"\";\r\n  border-color: #ddd;\r\n  position: absolute;\r\n  left: -30px;\r\n  height: 120%;\r\n  border-right: 0;\r\n  border-style: solid;\r\n  top: -22px;\r\n}\r\n\r\n.viewType.selected {\r\n  border: 2px solid black;\r\n}\r\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdmVyYmF0aW0vdmVyYmF0aW0uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFO0lBQ0UsK0JBQXVCO1lBQXZCLHVCQUF1QjtFQUN6Qjs7RUFFQTtJQUNFLGdDQUF3QjtZQUF4Qix3QkFBd0I7RUFDMUI7O0VBRUE7SUFDRSwrQkFBdUI7WUFBdkIsdUJBQXVCO0VBQ3pCOztFQUVBO0lBQ0UsaUNBQXlCO1lBQXpCLHlCQUF5QjtFQUMzQjs7RUFFQTtJQUNFLCtCQUF1QjtZQUF2Qix1QkFBdUI7RUFDekI7O0VBRUE7SUFDRSwrQkFBdUI7WUFBdkIsdUJBQXVCO0VBQ3pCOztFQUVBO0lBQ0UsK0JBQXVCO1lBQXZCLHVCQUF1QjtFQUN6Qjs7RUFFQTtJQUNFLGdDQUF3QjtZQUF4Qix3QkFBd0I7RUFDMUI7O0VBRUE7SUFDRSwrQkFBdUI7WUFBdkIsdUJBQXVCO0VBQ3pCO0FBQ0Y7O0FBcENBO0VBQ0U7SUFDRSwrQkFBdUI7WUFBdkIsdUJBQXVCO0VBQ3pCOztFQUVBO0lBQ0UsZ0NBQXdCO1lBQXhCLHdCQUF3QjtFQUMxQjs7RUFFQTtJQUNFLCtCQUF1QjtZQUF2Qix1QkFBdUI7RUFDekI7O0VBRUE7SUFDRSxpQ0FBeUI7WUFBekIseUJBQXlCO0VBQzNCOztFQUVBO0lBQ0UsK0JBQXVCO1lBQXZCLHVCQUF1QjtFQUN6Qjs7RUFFQTtJQUNFLCtCQUF1QjtZQUF2Qix1QkFBdUI7RUFDekI7O0VBRUE7SUFDRSwrQkFBdUI7WUFBdkIsdUJBQXVCO0VBQ3pCOztFQUVBO0lBQ0UsZ0NBQXdCO1lBQXhCLHdCQUF3QjtFQUMxQjs7RUFFQTtJQUNFLCtCQUF1QjtZQUF2Qix1QkFBdUI7RUFDekI7QUFDRjs7QUFFQTtFQUNFO0lBQ0UsNkJBQXFCO1lBQXJCLHFCQUFxQjtJQUNyQixVQUFVO0VBQ1o7O0VBRUE7SUFDRSwyQkFBbUI7WUFBbkIsbUJBQW1CO0lBQ25CLFVBQVU7RUFDWjtBQUNGOztBQVZBO0VBQ0U7SUFDRSw2QkFBcUI7WUFBckIscUJBQXFCO0lBQ3JCLFVBQVU7RUFDWjs7RUFFQTtJQUNFLDJCQUFtQjtZQUFuQixtQkFBbUI7SUFDbkIsVUFBVTtFQUNaO0FBQ0Y7O0FBRUE7RUFDRSxpQkFBaUI7RUFDakIsaUJBQWlCO0FBQ25COztBQUVBOzs7Ozs7Ozs7OztFQVdFLGlDQUFpQztFQUlqQyx5QkFBeUI7QUFDM0I7O0FBRUEsK0NBQStDOztBQUUvQztBQUNBLGlCQUFpQjtBQUNqQjs7QUFFRTtJQUNFLFdBQVc7SUFDWCxZQUFZO0lBQ1oscUJBQXFCO0lBQ3JCLGtCQUFrQjtJQUNsQixXQUFXO0VBQ2I7O0FBRUU7TUFDRSxtQkFBbUI7SUFDckI7O0FBRUYsbURBQW1EOztBQUVuRDtJQUNFLFNBQVM7SUFDVCxTQUFTO0lBQ1Qsa0JBQWtCO0VBQ3BCOztBQUVGO0VBQ0U7SUFDRSxtQkFBbUI7RUFDckI7QUFDRjs7QUFDQSxzREFBc0Q7O0FBQ3REO0VBQ0UsT0FBTztFQUNQLFFBQVE7RUFDUiw0QkFBNEI7RUFDNUIsV0FBVztFQUNYLDhCQUFzQjtVQUF0QixzQkFBc0I7RUFDdEIsa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsU0FBUztFQUNULE9BQU87QUFDVDs7QUFDQSxrREFBa0Q7O0FBRWxEO0VBQ0UsWUFBWTtFQUNaLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsZUFBZTtFQUNmLE1BQU07RUFDTixZQUFZO0VBQ1osWUFBWTtBQUNkOztBQUVFO0lBQ0UscUJBQXFCO0lBQ3JCLFVBQVU7SUFDVixTQUFTO0VBQ1g7O0FBRUE7SUFDRSxxQkFBcUI7RUFDdkI7O0FBRUYsa0RBQWtEOztBQUVsRDtFQUNFLDZCQUE2QjtFQUM3Qix5QkFBeUI7RUFDekIsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtBQUNwQjs7QUFFRTtJQUNFLGtCQUFrQjtFQUNwQjs7QUFFRiwwREFBMEQ7O0FBRTFEO0VBQ0Usa0JBQWtCO0VBQ2xCLG9CQUFhO0VBQWIsYUFBYTtFQUNiLHlCQUFtQjtVQUFuQixtQkFBbUI7QUFDckI7O0FBRUU7SUFDRSx5QkFBeUI7SUFDekIsaUJBQWlCO0lBQ2pCLG1CQUFZO1lBQVosWUFBWTtFQUNkOztBQUVBO0lBQ0UsZUFBZTtJQUNmLGVBQWU7RUFDakI7O0FBR0YsZ0VBQWdFOztBQUVoRTtFQUNFLGtCQUFrQjtBQUNwQjs7QUFFQSw4REFBOEQ7O0FBRTlEO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVFO0lBQ0UsaUJBQWlCO0lBQ2pCLGVBQWU7SUFDZiwyQkFBMkI7SUFDM0IscUJBQXFCO0VBQ3ZCOztBQUVBO0lBQ0UscUJBQXFCO0lBQ3JCLFdBQVc7SUFDWCxxQkFBcUI7SUFDckIsa0JBQWtCO0lBQ2xCLDBCQUEwQjtFQUM1Qjs7QUFFRTtNQUNFLGtCQUFrQjtNQUNsQixlQUFlO01BQ2YsV0FBVztNQUNYLFlBQVk7TUFDWixpQkFBaUI7TUFDakIsa0JBQWtCO01BQ2xCLGtCQUFrQjtJQUNwQjs7QUFFQTtNQUNFLHFCQUFxQjtNQUNyQixxREFBNkM7Y0FBN0MsNkNBQTZDO0lBQy9DOztBQUVGO0lBQ0Usa0NBQWtDO0lBQ2xDLGdCQUFnQjtJQUNoQixnQkFBZ0I7SUFDaEIsa0JBQWtCO0lBQ2xCLHFCQUFxQjtJQUNyQixrQkFBa0I7SUFDbEIsb0JBQW9CO0lBQ3BCLG9CQUFvQjtJQUNwQixtQ0FBbUM7SUFDbkMsa0NBQWtDO0lBQ2xDLGtCQUFrQjtJQUNsQixlQUFlO0lBQ2Ysa0JBQWtCO0lBQ2xCLFdBQVc7SUFDWCxTQUFTO0VBQ1g7O0FBRUE7SUFDRSxjQUFjO0VBQ2hCOztBQUVBO0lBQ0Usa0JBQWtCO0lBQ2xCLGVBQWU7RUFDakI7O0FBRUU7TUFDRSxnQkFBZ0I7TUFDaEIsa0NBQWtDO01BQ2xDLGdCQUFnQjtNQUNoQixrQkFBa0I7TUFDbEIscUJBQXFCO01BQ3JCLGtCQUFrQjtNQUNsQixxQkFBcUI7TUFDckIsbUNBQW1DO01BQ25DLGtDQUFrQztNQUNsQyxrQkFBa0I7TUFDbEIsY0FBYztJQUNoQjs7QUFFRjs7SUFFRSxZQUFZO0lBQ1osZUFBZTtJQUNmLGdCQUFnQjtFQUNsQjs7QUFFQTs7SUFFRSxZQUFZO0lBQ1osZUFBZTtFQUNqQjs7QUFFQTtJQUNFLGFBQWE7RUFDZjs7QUFFQTtJQUNFLGdDQUF3QjtZQUF4Qix3QkFBd0I7SUFDeEIsV0FBVztFQUNiOztBQUdGLHNFQUFzRTs7QUFFdEU7RUFDRSxxQkFBcUI7RUFDckIsV0FBVztFQUNYLGtCQUFrQjtFQUNsQixpQkFBaUI7RUFDakIsbUJBQW1CO0VBQ25CLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGtCQUFrQjtBQUNwQjs7QUFFQSx3Q0FBd0M7O0FBRXhDO0VBQ0UsVUFBVTtFQUNWLFdBQVc7QUFDYjs7QUFFQTtFQUNFLFVBQVU7RUFDVixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxtQkFBbUI7RUFDbkIsd0JBQXdCO0VBQ3hCLGtCQUFrQjtBQUNwQjs7QUFFRTtJQUNFLG1CQUFtQjtFQUNyQjs7QUFFQTtJQUNFLG1CQUFtQjtFQUNyQjs7QUFFRjtFQUNFLHVCQUF1QjtFQUN2Qix3QkFBd0I7RUFDeEIsbUJBQW1CO0FBQ3JCOztBQUVFO0lBQ0UsdUJBQXVCO0VBQ3pCOztBQUVBO0lBQ0UsdUJBQXVCO0VBQ3pCOztBQUVGO0VBQ0UsdUJBQXVCO0FBQ3pCOztBQUdBLDhGQUE4Rjs7QUFFOUY7RUFDRSxtQkFBbUI7QUFDckI7O0FBRUU7OztJQUdFLDZCQUE2QjtFQUMvQjs7QUFFRTs7TUFFRSx5QkFBeUI7TUFDekIsZ0JBQWdCO0lBQ2xCOztBQUVBOzs7O01BSUUsY0FBYztJQUNoQjs7QUFFRTs7O1FBR0UsY0FBYztNQUNoQjs7QUFFTjtFQUNFLGNBQWM7QUFDaEI7O0FBRUU7SUFDRSxjQUFjO0VBQ2hCOztBQUVGOzs7O0VBSUUsY0FBYztFQUNkLGlEQUFpRDtBQUNuRDs7QUFFQTs7OztFQUlFLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBR0E7RUFHSSxtQ0FBbUM7SUFDbkMsa0JBQWtCO0lBQ2xCLGdCQUFnQjtBQUNwQjs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQixnQkFBZ0I7RUFDaEIsZUFBZTtFQUNmLGdCQUFnQjtFQUNoQixpQkFBaUI7RUFDakIsY0FBYztFQUNkLHdCQUF3QjtFQUN4QixtQkFBbUI7RUFDbkIsa0JBQWtCO0VBQ2xCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7O0FBS0E7RUFDRTtJQUNFLGtCQUFrQjtJQUNsQixTQUFTO0lBQ1QsV0FBVztFQUNiOztBQUVGOztBQUVBO0VBQ0UsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsMkJBQTJCO0VBQzNCLGFBQWE7RUFDYixZQUFZO0VBQ1osV0FBVztFQUNYLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsVUFBVTtBQUNaOztBQUVBO0VBQ0UsV0FBVztFQUNYLGtCQUFrQjtFQUNsQixrQkFBa0I7RUFDbEIsV0FBVztFQUNYLFlBQVk7RUFDWixlQUFlO0VBQ2YsbUJBQW1CO0VBQ25CLFVBQVU7QUFDWjs7QUFFQTtFQUNFLHVCQUF1QjtBQUN6QiIsImZpbGUiOiJzcmMvYXBwL3ZlcmJhdGltL3ZlcmJhdGltLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyJAa2V5ZnJhbWVzIHN3aW5nIHtcclxuICAwJSB7XHJcbiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTtcclxuICB9XHJcblxyXG4gIDEwJSB7XHJcbiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgxMGRlZyk7XHJcbiAgfVxyXG5cclxuICAzMCUge1xyXG4gICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XHJcbiAgfVxyXG5cclxuICA0MCUge1xyXG4gICAgdHJhbnNmb3JtOiByb3RhdGUoLTEwZGVnKTtcclxuICB9XHJcblxyXG4gIDUwJSB7XHJcbiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTtcclxuICB9XHJcblxyXG4gIDYwJSB7XHJcbiAgICB0cmFuc2Zvcm06IHJvdGF0ZSg1ZGVnKTtcclxuICB9XHJcblxyXG4gIDcwJSB7XHJcbiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTtcclxuICB9XHJcblxyXG4gIDgwJSB7XHJcbiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgtNWRlZyk7XHJcbiAgfVxyXG5cclxuICAxMDAlIHtcclxuICAgIHRyYW5zZm9ybTogcm90YXRlKDBkZWcpO1xyXG4gIH1cclxufVxyXG5cclxuQGtleWZyYW1lcyBzb25hciB7XHJcbiAgMCUge1xyXG4gICAgdHJhbnNmb3JtOiBzY2FsZSgwLjkpO1xyXG4gICAgb3BhY2l0eTogMTtcclxuICB9XHJcblxyXG4gIDEwMCUge1xyXG4gICAgdHJhbnNmb3JtOiBzY2FsZSgyKTtcclxuICAgIG9wYWNpdHk6IDA7XHJcbiAgfVxyXG59XHJcblxyXG5ib2R5IHtcclxuICBmb250LXNpemU6IDAuOXJlbTtcclxuICBmb250LWZhbWlseTogbGF0bztcclxufVxyXG5cclxuLnBhZ2Utd3JhcHBlciAuc2lkZWJhci13cmFwcGVyLFxyXG4uc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLWJyYW5kID4gYSxcclxuLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1kcm9wZG93biA+IGE6YWZ0ZXIsXHJcbi5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItbWVudSAuc2lkZWJhci1kcm9wZG93biAuc2lkZWJhci1zdWJtZW51IGxpIGE6YmVmb3JlLFxyXG4uc2lkZWJhci13cmFwcGVyIHVsIGxpIGEgaSxcclxuLnBhZ2Utd3JhcHBlciAucGFnZS1jb250ZW50LFxyXG4uc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLXNlYXJjaCBpbnB1dC5zZWFyY2gtbWVudSxcclxuLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1zZWFyY2ggLmlucHV0LWdyb3VwLXRleHQsXHJcbi5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItbWVudSB1bCBsaSBhLFxyXG4jc2hvdy1zaWRlYmFyLFxyXG4jY2xvc2Utc2lkZWJhciB7XHJcbiAgLXdlYmtpdC10cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlO1xyXG4gIC1tb3otdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTtcclxuICAtbXMtdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTtcclxuICAtby10cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlO1xyXG4gIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7XHJcbn1cclxuXHJcbi8qLS0tLS0tLS0tLS0tLS0tLXBhZ2Utd3JhcHBlci0tLS0tLS0tLS0tLS0tLS0qL1xyXG5cclxuLnBhZ2Utd3JhcHBlciB7XHJcbnBvc2l0aW9uOnJlbGF0aXZlO1xyXG59XHJcblxyXG4gIC5wYWdlLXdyYXBwZXIgLnRoZW1lIHtcclxuICAgIHdpZHRoOiA0MHB4O1xyXG4gICAgaGVpZ2h0OiA0MHB4O1xyXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gICAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gICAgbWFyZ2luOiAycHg7XHJcbiAgfVxyXG5cclxuICAgIC5wYWdlLXdyYXBwZXIgLnRoZW1lLmNoaWxsZXItdGhlbWUge1xyXG4gICAgICBiYWNrZ3JvdW5kOiAjMWUyMjI5O1xyXG4gICAgfVxyXG5cclxuICAvKi0tLS0tLS0tLS0tLS0tLS10b2dnZWxlZCBzaWRlYmFyLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG4gIC5wYWdlLXdyYXBwZXIudG9nZ2xlZCAuc2lkZWJhci13cmFwcGVyIHtcclxuICAgIGxlZnQ6IDBweDtcclxuICAgIHRvcDogYXV0bztcclxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICB9XHJcblxyXG5AbWVkaWEgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA3NjhweCkge1xyXG4gIC5wYWdlLXdyYXBwZXIudG9nZ2xlZCAucGFnZS1jb250ZW50IHtcclxuICAgIHBhZGRpbmctbGVmdDogMzAwcHg7XHJcbiAgfVxyXG59XHJcbi8qLS0tLS0tLS0tLS0tLS0tLXNob3cgc2lkZWJhciBidXR0b24tLS0tLS0tLS0tLS0tLS0tKi9cclxuI3Nob3ctc2lkZWJhciB7XHJcbiAgbGVmdDogMDtcclxuICB0b3A6IDBweDtcclxuICBib3JkZXItcmFkaXVzOiAwIDRweCA0cHggMHB4O1xyXG4gIHdpZHRoOiAzNXB4O1xyXG4gIHRyYW5zaXRpb24tZGVsYXk6IDAuM3M7XHJcbiAgcG9zaXRpb246IGFic29sdXRlO1xyXG59XHJcblxyXG4ucGFnZS13cmFwcGVyLnRvZ2dsZWQgI3Nob3ctc2lkZWJhciB7XHJcbiAgbGVmdDogMjAlO1xyXG4gIHRvcDogMCU7XHJcbn1cclxuLyotLS0tLS0tLS0tLS0tLS0tc2lkZWJhci13cmFwcGVyLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG4uc2lkZWJhci13cmFwcGVyIHtcclxuICB3aWR0aDogMjYwcHg7XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG4gIG1heC1oZWlnaHQ6IDEwMCU7XHJcbiAgcG9zaXRpb246IGZpeGVkO1xyXG4gIHRvcDogMDtcclxuICBsZWZ0OiAtMzAwcHg7XHJcbiAgei1pbmRleDogOTk5O1xyXG59XHJcblxyXG4gIC5zaWRlYmFyLXdyYXBwZXIgdWwge1xyXG4gICAgbGlzdC1zdHlsZS10eXBlOiBub25lO1xyXG4gICAgcGFkZGluZzogMDtcclxuICAgIG1hcmdpbjogMDtcclxuICB9XHJcblxyXG4gIC5zaWRlYmFyLXdyYXBwZXIgYSB7XHJcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XHJcbiAgfVxyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tc2lkZWJhci1jb250ZW50LS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG4uc2lkZWJhci1jb250ZW50IHtcclxuICBtYXgtaGVpZ2h0OiBjYWxjKDEwMCUgLSAzMHB4KTtcclxuICBoZWlnaHQ6IGNhbGMoMTAwJSAtIDMwcHgpO1xyXG4gIG92ZXJmbG93LXk6IGF1dG87XHJcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG59XHJcblxyXG4gIC5zaWRlYmFyLWNvbnRlbnQuZGVza3RvcCB7XHJcbiAgICBvdmVyZmxvdy15OiBoaWRkZW47XHJcbiAgfVxyXG5cclxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLXNpZGViYXItYnJhbmQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cclxuXHJcbi5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItYnJhbmQge1xyXG4gIHBhZGRpbmc6IDEwcHggMjBweDtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbn1cclxuXHJcbiAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1icmFuZCA+IGEge1xyXG4gICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcclxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgZmxleC1ncm93OiAxO1xyXG4gIH1cclxuXHJcbiAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1icmFuZCAjY2xvc2Utc2lkZWJhciB7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgICBmb250LXNpemU6IDIwcHg7XHJcbiAgfVxyXG5cclxuXHJcbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1zaWRlYmFyLXNlYXJjaC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG4uc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLXNlYXJjaCA+IGRpdiB7XHJcbiAgcGFkZGluZzogMTBweCAyMHB4O1xyXG59XHJcblxyXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS1zaWRlYmFyLW1lbnUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cclxuXHJcbi5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItbWVudSB7XHJcbiAgcGFkZGluZy1ib3R0b206IDEwcHg7XHJcbn1cclxuXHJcbiAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IC5oZWFkZXItbWVudSBzcGFuIHtcclxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgZm9udC1zaXplOiAxNHB4O1xyXG4gICAgcGFkZGluZzogMTVweCAyMHB4IDVweCAyMHB4O1xyXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gIH1cclxuXHJcbiAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IHVsIGxpIGEge1xyXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICBwYWRkaW5nOiA4cHggMzBweCA4cHggMjBweDtcclxuICB9XHJcblxyXG4gICAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IHVsIGxpIGEgaSB7XHJcbiAgICAgIG1hcmdpbi1yaWdodDogMTBweDtcclxuICAgICAgZm9udC1zaXplOiAxMnB4O1xyXG4gICAgICB3aWR0aDogMzBweDtcclxuICAgICAgaGVpZ2h0OiAzMHB4O1xyXG4gICAgICBsaW5lLWhlaWdodDogMzBweDtcclxuICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICB9XHJcblxyXG4gICAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IHVsIGxpIGE6aG92ZXIgPiBpOjpiZWZvcmUge1xyXG4gICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICAgIGFuaW1hdGlvbjogc3dpbmcgZWFzZS1pbi1vdXQgMC41cyAxIGFsdGVybmF0ZTtcclxuICAgIH1cclxuXHJcbiAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IC5zaWRlYmFyLWRyb3Bkb3duID4gYTphZnRlciB7XHJcbiAgICBmb250LWZhbWlseTogXCJGb250IEF3ZXNvbWUgNSBGcmVlXCI7XHJcbiAgICBmb250LXdlaWdodDogOTAwO1xyXG4gICAgY29udGVudDogXCJcXGYxMDVcIjtcclxuICAgIGZvbnQtc3R5bGU6IG5vcm1hbDtcclxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcclxuICAgIGZvbnQtc3R5bGU6IG5vcm1hbDtcclxuICAgIGZvbnQtdmFyaWFudDogbm9ybWFsO1xyXG4gICAgdGV4dC1yZW5kZXJpbmc6IGF1dG87XHJcbiAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDtcclxuICAgIC1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBiYWNrZ3JvdW5kOiAwIDA7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICByaWdodDogMTVweDtcclxuICAgIHRvcDogMTRweDtcclxuICB9XHJcblxyXG4gIC5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItbWVudSAuc2lkZWJhci1kcm9wZG93biAuc2lkZWJhci1zdWJtZW51IHVsIHtcclxuICAgIHBhZGRpbmc6IDVweCAwO1xyXG4gIH1cclxuXHJcbiAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IC5zaWRlYmFyLWRyb3Bkb3duIC5zaWRlYmFyLXN1Ym1lbnUgbGkge1xyXG4gICAgcGFkZGluZy1sZWZ0OiAyNXB4O1xyXG4gICAgZm9udC1zaXplOiAxM3B4O1xyXG4gIH1cclxuXHJcbiAgICAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLW1lbnUgLnNpZGViYXItZHJvcGRvd24gLnNpZGViYXItc3VibWVudSBsaSBhOmJlZm9yZSB7XHJcbiAgICAgIGNvbnRlbnQ6IFwiXFxmMTExXCI7XHJcbiAgICAgIGZvbnQtZmFtaWx5OiBcIkZvbnQgQXdlc29tZSA1IEZyZWVcIjtcclxuICAgICAgZm9udC13ZWlnaHQ6IDQwMDtcclxuICAgICAgZm9udC1zdHlsZTogbm9ybWFsO1xyXG4gICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gICAgICAtd2Via2l0LWZvbnQtc21vb3RoaW5nOiBhbnRpYWxpYXNlZDtcclxuICAgICAgLW1vei1vc3gtZm9udC1zbW9vdGhpbmc6IGdyYXlzY2FsZTtcclxuICAgICAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xyXG4gICAgICBmb250LXNpemU6IDhweDtcclxuICAgIH1cclxuXHJcbiAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IHVsIGxpIGEgc3Bhbi5sYWJlbCxcclxuICAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLW1lbnUgdWwgbGkgYSBzcGFuLmJhZGdlIHtcclxuICAgIGZsb2F0OiByaWdodDtcclxuICAgIG1hcmdpbi10b3A6IDhweDtcclxuICAgIG1hcmdpbi1sZWZ0OiA1cHg7XHJcbiAgfVxyXG5cclxuICAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLW1lbnUgLnNpZGViYXItZHJvcGRvd24gLnNpZGViYXItc3VibWVudSBsaSBhIC5iYWRnZSxcclxuICAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLW1lbnUgLnNpZGViYXItZHJvcGRvd24gLnNpZGViYXItc3VibWVudSBsaSBhIC5sYWJlbCB7XHJcbiAgICBmbG9hdDogcmlnaHQ7XHJcbiAgICBtYXJnaW4tdG9wOiAwcHg7XHJcbiAgfVxyXG5cclxuICAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLW1lbnUgLnNpZGViYXItc3VibWVudSB7XHJcbiAgICBkaXNwbGF5OiBub25lO1xyXG4gIH1cclxuXHJcbiAgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IC5zaWRlYmFyLWRyb3Bkb3duLmFjdGl2ZSA+IGE6YWZ0ZXIge1xyXG4gICAgdHJhbnNmb3JtOiByb3RhdGUoOTBkZWcpO1xyXG4gICAgcmlnaHQ6IDE3cHg7XHJcbiAgfVxyXG5cclxuXHJcbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1wYWdlLWNvbnRlbnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG4ucGFnZS13cmFwcGVyIC5wYWdlLWNvbnRlbnQge1xyXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcclxuICB3aWR0aDogMTAwJTtcclxuICBwYWRkaW5nLWxlZnQ6IDMwcHg7XHJcbiAgcGFkZGluZy10b3A6IDIwcHg7XHJcbiAgcGFkZGluZy1yaWdodDogMzBweDtcclxuICB6LWluZGV4OiAtMTtcclxufVxyXG5cclxuLnBhZ2Utd3JhcHBlciAucGFnZS1jb250ZW50IHtcclxuICBvdmVyZmxvdy14OiBoaWRkZW47XHJcbn1cclxuXHJcbi8qLS0tLS0tc2Nyb2xsIGJhci0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG46Oi13ZWJraXQtc2Nyb2xsYmFyIHtcclxuICB3aWR0aDogNXB4O1xyXG4gIGhlaWdodDogN3B4O1xyXG59XHJcblxyXG46Oi13ZWJraXQtc2Nyb2xsYmFyLWJ1dHRvbiB7XHJcbiAgd2lkdGg6IDBweDtcclxuICBoZWlnaHQ6IDBweDtcclxufVxyXG5cclxuOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7XHJcbiAgYmFja2dyb3VuZDogIzUyNTk2NTtcclxuICBib3JkZXI6IDBweCBub25lICNmZmZmZmY7XHJcbiAgYm9yZGVyLXJhZGl1czogMHB4O1xyXG59XHJcblxyXG4gIDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIge1xyXG4gICAgYmFja2dyb3VuZDogIzUyNTk2NTtcclxuICB9XHJcblxyXG4gIDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6YWN0aXZlIHtcclxuICAgIGJhY2tncm91bmQ6ICM1MjU5NjU7XHJcbiAgfVxyXG5cclxuOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7XHJcbiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XHJcbiAgYm9yZGVyOiAwcHggbm9uZSAjZmZmZmZmO1xyXG4gIGJvcmRlci1yYWRpdXM6IDUwcHg7XHJcbn1cclxuXHJcbiAgOjotd2Via2l0LXNjcm9sbGJhci10cmFjazpob3ZlciB7XHJcbiAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcclxuICB9XHJcblxyXG4gIDo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2s6YWN0aXZlIHtcclxuICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xyXG4gIH1cclxuXHJcbjo6LXdlYmtpdC1zY3JvbGxiYXItY29ybmVyIHtcclxuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcclxufVxyXG5cclxuXHJcbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1jaGlsbGVyLXRoZW1lLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcblxyXG4uY2hpbGxlci10aGVtZSAuc2lkZWJhci13cmFwcGVyIHtcclxuICBiYWNrZ3JvdW5kOiAjMzEzNTNEO1xyXG59XHJcblxyXG4gIC5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIsXHJcbiAgLmNoaWxsZXItdGhlbWUgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1zZWFyY2gsXHJcbiAgLmNoaWxsZXItdGhlbWUgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IHtcclxuICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjM2EzZjQ4O1xyXG4gIH1cclxuXHJcbiAgICAuY2hpbGxlci10aGVtZSAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLXNlYXJjaCBpbnB1dC5zZWFyY2gtbWVudSxcclxuICAgIC5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItc2VhcmNoIC5pbnB1dC1ncm91cC10ZXh0IHtcclxuICAgICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDtcclxuICAgICAgYm94LXNoYWRvdzogbm9uZTtcclxuICAgIH1cclxuXHJcbiAgICAuY2hpbGxlci10aGVtZSAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLXNlYXJjaCBpbnB1dC5zZWFyY2gtbWVudSxcclxuICAgIC5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItc2VhcmNoIC5pbnB1dC1ncm91cC10ZXh0LFxyXG4gICAgLmNoaWxsZXItdGhlbWUgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1icmFuZCA+IGEsXHJcbiAgICAuY2hpbGxlci10aGVtZSAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLW1lbnUgdWwgbGkgYSB7XHJcbiAgICAgIGNvbG9yOiAjODE4ODk2O1xyXG4gICAgfVxyXG5cclxuICAgICAgLmNoaWxsZXItdGhlbWUgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IHVsIGxpOmhvdmVyID4gYSxcclxuICAgICAgLmNoaWxsZXItdGhlbWUgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IC5zaWRlYmFyLWRyb3Bkb3duLmFjdGl2ZSA+IGEsXHJcbiAgICAgIC5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItYnJhbmQgPiBhOmhvdmVyIHtcclxuICAgICAgICBjb2xvcjogI2I4YmZjZTtcclxuICAgICAgfVxyXG5cclxuLnBhZ2Utd3JhcHBlci5jaGlsbGVyLXRoZW1lLnRvZ2dsZWQgI2Nsb3NlLXNpZGViYXIge1xyXG4gIGNvbG9yOiAjYmRiZGJkO1xyXG59XHJcblxyXG4gIC5wYWdlLXdyYXBwZXIuY2hpbGxlci10aGVtZS50b2dnbGVkICNjbG9zZS1zaWRlYmFyOmhvdmVyIHtcclxuICAgIGNvbG9yOiAjZmZmZmZmO1xyXG4gIH1cclxuXHJcbi5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIgdWwgbGk6aG92ZXIgYSBpLFxyXG4uY2hpbGxlci10aGVtZSAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLWRyb3Bkb3duIC5zaWRlYmFyLXN1Ym1lbnUgbGkgYTpob3ZlcjpiZWZvcmUsXHJcbi5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItc2VhcmNoIGlucHV0LnNlYXJjaC1tZW51OmZvY3VzICsgc3BhbixcclxuLmNoaWxsZXItdGhlbWUgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IC5zaWRlYmFyLWRyb3Bkb3duLmFjdGl2ZSBhIGkge1xyXG4gIGNvbG9yOiAjMTZjN2ZmO1xyXG4gIHRleHQtc2hhZG93OiAwcHggMHB4IDEwcHggcmdiYSgyMiwgMTk5LCAyNTUsIDAuNSk7XHJcbn1cclxuXHJcbi5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItbWVudSB1bCBsaSBhIGksXHJcbi5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItbWVudSAuc2lkZWJhci1kcm9wZG93biBkaXYsXHJcbi5jaGlsbGVyLXRoZW1lIC5zaWRlYmFyLXdyYXBwZXIgLnNpZGViYXItc2VhcmNoIGlucHV0LnNlYXJjaC1tZW51LFxyXG4uY2hpbGxlci10aGVtZSAuc2lkZWJhci13cmFwcGVyIC5zaWRlYmFyLXNlYXJjaCAuaW5wdXQtZ3JvdXAtdGV4dCB7XHJcbiAgYmFja2dyb3VuZDogIzNhM2Y0ODtcclxufVxyXG5cclxuLmNoaWxsZXItdGhlbWUgLnNpZGViYXItd3JhcHBlciAuc2lkZWJhci1tZW51IC5oZWFkZXItbWVudSBzcGFuIHtcclxuICBjb2xvcjogIzZjN2I4ODtcclxufVxyXG5cclxuXHJcbi5zdWItZGV0YWlscyB7XHJcbiAgLXdlYmtpdC1ib3gtc2hhZG93OiBoc2woMCwgMCUsIDg0JSkgMCAwIDhweDtcclxuICAgIC1tb3otYm94LXNoYWRvdzogaHNsKDAsIDAlLCA4NCUpIDAgMCA4cHg7XHJcbiAgICBib3gtc2hhZG93OiBoc2woMCwgMCUsIDg0JSkgMCAwIDhweDtcclxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAgIG1hcmdpbjogMjBweCAwcHg7XHJcbn1cclxuXHJcbi50b3BpY3Mgc3BhbiB7XHJcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gIHBhZGRpbmc6IDRweCA0cHg7XHJcbiAgZm9udC1zaXplOiAxMnB4O1xyXG4gIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbiAgbGluZS1oZWlnaHQ6IDE0cHg7XHJcbiAgY29sb3I6ICNmZmZmZmY7XHJcbiAgdmVydGljYWwtYWxpZ246IGJhc2VsaW5lO1xyXG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XHJcbiAgYm9yZGVyLXJhZGl1czogM3B4O1xyXG4gIG1hcmdpbjogMHB4IDVweDtcclxufVxyXG5cclxuLnBpbmsge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICNlYTRjYTA7XHJcbn1cclxuXHJcbi5ibHVlIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDBhY2NkO1xyXG59XHJcblxyXG4uZ3JlZW4ge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICMyNWEwMWE7XHJcbn1cclxuXHJcbi5yZWQge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICNjYzFhMWE7XHJcbn1cclxuXHJcblxyXG5cclxuXHJcbkBtZWRpYSAobWF4LXdpZHRoOiA3NjdweCkge1xyXG4gIC5zbWlsZXkge1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgdG9wOiAxMHB4O1xyXG4gICAgcmlnaHQ6IDI1cHg7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuLnRocmVhZGVkIHtcclxuICBtYXJnaW4tbGVmdDogNDBweDtcclxufVxyXG5cclxuLnRocmVhZGVkOjpiZWZvcmUge1xyXG4gIGJvcmRlci10b3A6IDFweCBkYXNoZWQgI2RkZDtcclxuICBoZWlnaHQ6IDAuNXB4O1xyXG4gIGNvbnRlbnQ6IFwiIFwiO1xyXG4gIHdpZHRoOiAzLjUlO1xyXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICBsZWZ0OiAtMzFweDtcclxuICB0b3A6IDMuMGVtO1xyXG59XHJcblxyXG4udGhyZWFkZWQ6OmFmdGVyIHtcclxuICBjb250ZW50OiBcIlwiO1xyXG4gIGJvcmRlci1jb2xvcjogI2RkZDtcclxuICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgbGVmdDogLTMwcHg7XHJcbiAgaGVpZ2h0OiAxMjAlO1xyXG4gIGJvcmRlci1yaWdodDogMDtcclxuICBib3JkZXItc3R5bGU6IHNvbGlkO1xyXG4gIHRvcDogLTIycHg7XHJcbn1cclxuXHJcbi52aWV3VHlwZS5zZWxlY3RlZCB7XHJcbiAgYm9yZGVyOiAycHggc29saWQgYmxhY2s7XHJcbn0iXX0= */"

/***/ }),

/***/ "./src/app/verbatim/verbatim.component.ts":
/*!************************************************!*\
  !*** ./src/app/verbatim/verbatim.component.ts ***!
  \************************************************/
/*! exports provided: VerbatimComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VerbatimComponent", function() { return VerbatimComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _data_transfer_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! .././data-transfer.service */ "./src/app/data-transfer.service.ts");
/* harmony import */ var apollo_angular__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! apollo-angular */ "./node_modules/apollo-angular/fesm5/ngApollo.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! graphql-tag */ "./node_modules/graphql-tag/src/index.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(graphql_tag__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aws-amplify/pubsub */ "./node_modules/@aws-amplify/pubsub/lib-esm/index.js");
/* harmony import */ var _aws_exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../aws-exports */ "./src/aws-exports.js");
/* harmony import */ var aws_amplify__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aws-amplify */ "./node_modules/aws-amplify/lib-esm/index.js");







aws_amplify__WEBPACK_IMPORTED_MODULE_7__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_6__["default"]);
_aws_amplify_pubsub__WEBPACK_IMPORTED_MODULE_5__["default"].configure(_aws_exports__WEBPACK_IMPORTED_MODULE_6__["default"]);

var VerbatimComponent = /** @class */ (function () {
    function VerbatimComponent(data, apollo) {
        this.data = data;
        this.apollo = apollo;
        this.loading = true;
        this.empty = false;
        this.start = String;
        this.end = String;
        this.text = '';
        this.dates = [];
        this.finalDates = [];
        this.discourseDetails = [];
        this.impactFilter = [];
        this.getTopics = [];
        this.p = 1;
        this.flatView = true;
        this.otherComments = [];
    }
    VerbatimComponent.prototype.getFilterObjects = function () {
        var _this = this;
        this.loading = true;
        this.discourseDetails = [];
        this.apollo
            .query({
            query: graphql_tag__WEBPACK_IMPORTED_MODULE_4___default()(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n            query impactFilter($start: String!, $end: String!, $region: String!, $parent: String!) {\n              listDiscourseData (start: $start, end: $end, region: $region, parent: $parent){\n              counts\n              tag\n              source_ontology\n            }\n          }\n        "], ["\n            query impactFilter($start: String!, $end: String!, $region: String!, $parent: String!) {\n              listDiscourseData (start: $start, end: $end, region: $region, parent: $parent){\n              counts\n              tag\n              source_ontology\n            }\n          }\n        "]))),
            variables: {
                start: this.start,
                end: this.end,
                region: "King County"
            }
        })
            .subscribe(function (_a) {
            var data = _a.data, loading = _a.loading;
            _this.impactFilter = data && data.impactFilter;
            _this.items = new Map();
            _this.fetchPostFromResponse(_this.discourseDetails);
            _this.populateComments(_this.discourseDetails);
            _this.keys = Array.from(_this.items.keys());
        }, function (error) {
            _this.error = error;
            console.log("error is: ", error);
        }).add(function () {
            if (_this.discourseDetails.length != 0) {
                _this.empty = false;
            }
            else {
                _this.empty = true;
                _this.loading = false;
            }
        });
    };
    VerbatimComponent.prototype.createVerbatimView = function () {
        var _this = this;
        this.loading = true;
        this.discourseDetails = [];
        this.apollo
            .query({
            query: graphql_tag__WEBPACK_IMPORTED_MODULE_4___default()(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\n            query listDiscourseData($start: String!, $end: String!, $region: String!) {\n              listDiscourseData (start: $start, end: $end, region: $region){\n              discourse_id\n              comment\n              region\n              sentiment\n              platform_name\n              created_time\n              impact_area_id\n              isPost\n              post_id\n            }\n          }\n        "], ["\n            query listDiscourseData($start: String!, $end: String!, $region: String!) {\n              listDiscourseData (start: $start, end: $end, region: $region){\n              discourse_id\n              comment\n              region\n              sentiment\n              platform_name\n              created_time\n              impact_area_id\n              isPost\n              post_id\n            }\n          }\n        "]))),
            variables: {
                start: this.start,
                end: this.end,
                region: "King County"
            }
        })
            .subscribe(function (_a) {
            var data = _a.data, loading = _a.loading;
            _this.discourseDetails = data && data.listDiscourseData;
            _this.items = new Map();
            _this.fetchPostFromResponse(_this.discourseDetails);
            _this.populateComments(_this.discourseDetails);
            _this.keys = Array.from(_this.items.keys());
        }, function (error) {
            _this.error = error;
            console.log("error is: ", error);
        }).add(function () {
            if (_this.discourseDetails.length != 0) {
                _this.empty = false;
            }
            else {
                _this.empty = true;
                _this.loading = false;
            }
        });
    };
    VerbatimComponent.prototype.populateComments = function (verbatimData) {
        this.otherComments = [];
        for (var i = 0; i < verbatimData.length; i++) {
            if (verbatimData[i].isPost == false) {
                var comment_1 = {
                    comment_id: 0, created_time: "", content: "", platform_name: "", region: "", impact_area_id: "", topics: "", sentiment: 0
                };
                comment_1.comment_id = verbatimData[i].discourse_id;
                comment_1.created_time = verbatimData[i].created_time;
                comment_1.platform_name = verbatimData[i].platform_name;
                comment_1.content = verbatimData[i].comment;
                comment_1.region = verbatimData[i].region;
                comment_1.impact_area_id = verbatimData[i].impact_area_id;
                comment_1.topics = verbatimData[i].topics;
                comment_1.sentiment = verbatimData[i].sentiment;
                if (this.items.get(verbatimData[i].post_id)) {
                    var currentPost = this.items.get(verbatimData[i].post_id);
                    currentPost.comments.push(comment_1);
                    this.items.set(verbatimData[i].post_id, currentPost);
                }
                else
                    this.otherComments.push(comment_1);
            }
        }
    };
    VerbatimComponent.prototype.fetchPostFromResponse = function (verbatimData) {
        for (var i = 0; i < verbatimData.length; i++) {
            if (verbatimData[i].isPost == true) {
                var post_1 = {
                    post_id: 0, comments: [], content: "", platform_name: "", created_time: "", region: "", impact_area_id: "", sentiment: 0, topics: ""
                };
                post_1.post_id = verbatimData[i].discourse_id;
                post_1.comments = [];
                post_1.content = verbatimData[i].comment;
                post_1.platform_name = verbatimData[i].platform_name;
                post_1.created_time = verbatimData[i].created_time;
                post_1.region = verbatimData[i].region;
                post_1.impact_area_id = verbatimData[i].impact_area_id;
                post_1.sentiment = verbatimData[i].sentiment;
                this.items.set(verbatimData[i].discourse_id, post_1);
            }
        }
    };
    VerbatimComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.isOn = true;
        this.data.share.subscribe(function (x) {
            if (_this.text != x) {
                _this.loading = true;
                _this.text = x;
                _this.dates = _this.text.split(' to ');
                _this.start = _this.dates[0];
                _this.end = _this.dates[1];
                _this.createVerbatimView();
            }
        });
    };
    VerbatimComponent.prototype.beforeChange = function ($event) {
        console.log($event.panelId);
        if ($event.panelId === 'panelOne') {
            $event.preventDefault();
        }
        if ($event.panelId === 'panelTwo' && $event.nextState === false) {
            $event.preventDefault();
        }
    };
    VerbatimComponent.ctorParameters = function () { return [
        { type: _data_transfer_service__WEBPACK_IMPORTED_MODULE_2__["DataTransferService"] },
        { type: apollo_angular__WEBPACK_IMPORTED_MODULE_3__["Apollo"] }
    ]; };
    tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('myaccordion', { static: true })
    ], VerbatimComponent.prototype, "accordion", void 0);
    VerbatimComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
        Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
            selector: 'app-verbatim',
            template: __webpack_require__(/*! raw-loader!./verbatim.component.html */ "./node_modules/raw-loader/index.js!./src/app/verbatim/verbatim.component.html"),
            styles: [__webpack_require__(/*! ./verbatim.component.css */ "./src/app/verbatim/verbatim.component.css")]
        })
    ], VerbatimComponent);
    return VerbatimComponent;
}());

var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/aws-exports.js":
/*!****************************!*\
  !*** ./src/aws-exports.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* eslint-disable */
// WARNING: DO NOT EDIT. This file is automatically generated by AWS Amplify. It will be overwritten.

const awsmobile = {
    "aws_project_region": "us-west-2",
    "aws_appsync_graphqlEndpoint": "https://a4kfqfeqkfgxhaad2777qxhiy4.appsync-api.us-west-2.amazonaws.com/graphql",
    "aws_appsync_region": "us-west-2",
    "aws_appsync_authenticationType": "API_KEY",
    "aws_appsync_apiKey": "da2-dq52cxdnxzcx7pyuqfjdswijkm",
    "aws_content_delivery_bucket": "newbucketdata-newbucket",
    "aws_content_delivery_bucket_region": "us-west-2",
    "aws_content_delivery_url": "https://di29v87uyt67h.cloudfront.net"
};


/* harmony default export */ __webpack_exports__["default"] = (awsmobile);


/***/ }),

/***/ "./src/environments/environment.ts":
/*!*****************************************!*\
  !*** ./src/environments/environment.ts ***!
  \*****************************************/
/*! exports provided: environment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "environment", function() { return environment; });
// This file can be replaced during build by using the `fileReplacements` array.
// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.
// The list of file replacements can be found in `angular.json`.
var environment = {
    production: false
};
/*
 * For easier debugging in development mode, you can import the following file
 * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.
 *
 * This import should be commented out in production mode because it will have a negative impact
 * on performance if an error is thrown.
 */
// import 'zone.js/dist/zone-error';  // Included with Angular CLI.


/***/ }),

/***/ "./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm5/core.js");
/* harmony import */ var _angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser-dynamic */ "./node_modules/@angular/platform-browser-dynamic/fesm5/platform-browser-dynamic.js");
/* harmony import */ var _app_app_module__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app/app.module */ "./src/app/app.module.ts");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./environments/environment */ "./src/environments/environment.ts");




if (_environments_environment__WEBPACK_IMPORTED_MODULE_3__["environment"].production) {
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["enableProdMode"])();
}
Object(_angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_1__["platformBrowserDynamic"])().bootstrapModule(_app_app_module__WEBPACK_IMPORTED_MODULE_2__["AppModule"])
    .catch(function (err) { return console.error(err); });


/***/ }),

/***/ 0:
/*!***************************!*\
  !*** multi ./src/main.ts ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! C:\Users\akrit\Desktop\WinWin\NI\NewImpact\src\main.ts */"./src/main.ts");


/***/ }),

/***/ 1:
/*!********************!*\
  !*** fs (ignored) ***!
  \********************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 10:
/*!**********************!*\
  !*** util (ignored) ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 11:
/*!************************!*\
  !*** buffer (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 12:
/*!************************!*\
  !*** buffer (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 13:
/*!************************!*\
  !*** buffer (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 14:
/*!************************!*\
  !*** buffer (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 15:
/*!************************!*\
  !*** buffer (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 16:
/*!************************!*\
  !*** buffer (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 2:
/*!**********************!*\
  !*** util (ignored) ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 3:
/*!**********************!*\
  !*** util (ignored) ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 4:
/*!**********************!*\
  !*** util (ignored) ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 5:
/*!**********************!*\
  !*** util (ignored) ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 6:
/*!************************!*\
  !*** buffer (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 7:
/*!************************!*\
  !*** buffer (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 8:
/*!************************!*\
  !*** crypto (ignored) ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 9:
/*!**********************!*\
  !*** util (ignored) ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ })

},[[0,"runtime","vendor"]]]);
//# sourceMappingURL=main-es5.js.map
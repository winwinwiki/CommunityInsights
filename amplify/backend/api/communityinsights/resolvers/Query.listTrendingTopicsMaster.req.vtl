#**
  Select statement for a relational database data source
*#
{
    "version": "2018-05-29",
    "statements": [
        "select topic, counts, negative, neutral, positive from ((select topic, count(*) as counts, sum(case when sentiment < 0 then 1 else 0 end) as negative,  sum(case when sentiment = 0 then 1 else 0 end) as neutral,  sum(case when sentiment > 0 then 1 else 0 end) as positive from DiscourseTrendingTopics where created_time between '$ctx.args.start' and '$ctx.args.end' and region='$ctx.args.region' and parent_region = '$ctx.args.parent' group by topic order by counts desc limit 100) union (select topic, count(*) as counts, sum(case when sentiment < 0 then 1 else 0 end) as negative,  sum(case when sentiment = 0 then 1 else 0 end) as neutral,  sum(case when sentiment > 0 then 1 else 0 end) as positive from DiscourseTrendingTopics where created_time between '$ctx.args.start' and '$ctx.args.end' and region='$ctx.args.region' and parent_region = '$ctx.args.parent' and topic in ('Vaccine','Antivax','Covid Vaccine','Masks','Mask','Wear a mask','Mask up','Open schools','Schools','Small business','Small businesses','Eviction','Restaurants') group by topic)) as A order by counts DESC"
        ]
}